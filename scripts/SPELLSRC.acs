#Library "SpellLib"
#include "zcommon.acs"

#define NULLSTR 0

/*

Script Reference

Used Tags and Scripts
Thing Tags:
	1-999		-	Assume used in standard levels
	1000		-	Friendly Monsters
	1001		-	The Main Player [set "Player1TID" to this or whatever ID you plan to use if you decide to change it]
	1002-1014	-	Temporary ThingIDs
	
	1123		-	Main Sauron Eye's TID [Boss Lifemeters]
	1124		-	Sauravatar's TID [Boss Lifemeters]

    1222		-	General Demonic Boss TIDs

	1537		-	TID for Seed Spawn system

	1501			Main Player's Tension Aura
	1502			Main Player's Tension Aura Light
	
    2001		-	Spawned Spell Projectiles start with this TID
	4443		-   Final TID for Healing Projectiles
	4444		-	Spawned Spell Projectiles ultimately end up with this TID
*/

/*	
HudMessage ID Tags:
		1		-	HP Gained/Lost [for damage counts]
		2		-	YOU DIED text
		3		-	Tunnel Vision Display [death]
		4		-	Tunnel Vision Display [badly injured and/or dead]
		...
		106-108 -   Bonus Text
		...
		111		-	Reserved? [TCOTD:A uses it for Note displays. :V]
		...
		196		-	Debug Display for Lifebars
		197		-	Level Display for Lifebars
		198		-	Name of Creature for Lifebars
		199		-	HP/MaxHP display for Lifebars
		201		-	Actor Lifebar [Frame]
		202-302	-	Lifebar Notches [100 total]
		...
		901		-	Main List for Armor Display Menu
		902		-	Top Line for Armor Display Menu
		903		-	Armor Icon
		904		-	Background Tint for Menus/Armor-Display
		...
 // MENU SYSTEM
		1000-2000   - General Reserved for Menu System

 // OLD HUD STYLE
		2001-2010	-	Readied Spells [QuickCast]
		...
		2198		-	EXP Combo Total
		2199		-	EXP Combo Multiplier
		2200		-	EXP Combo Kill Count
		2201-2302	-	EXP Combo Bar
		2303-2404	-	Tension Charge Bar
		2405-2506	-	Tension Timer Bar
		2507-2608	-	Tension Timer Bar
		2609		-	Tension Type Icon
		...
		3202-3303	-	Mana Bar
		3304-3405	-	Exp Bar
		3406-3407	-	Spell Name, Spell Description
		3413		-	Level Display
		...
		3415		-	Mana Points Display
		3416-3417	-	Stats Display Text
		3418		-	EXP Display
		3419		-	Mana Regeneration Display
		3420		-	Aeon Points Display
		3421		-	EXP "OVERKILL!" Display
		3422		-	Player Damage/Healing Amount [uses interpolation to gauge]
		...
		3432		-	Level Up/Aeon Points Up Text.
		3433-3443	-	Buff Timers
		3442		-	Spell Category Display [goes with 3406-3407]
		...
		3500		-	Boss HP Readous [for bottom of the screen]
		3501		-	"BOSS" text [when fighting a boss]
		3502-3759	-	Boss Lifebar [roughly] (257)
// END OLD STYLE HUD
      
Functions
	{-1-}		-	Checks Spell Costs Across the Board [used at least on four occasions in the code]

--Script #s and their functions--:
	{-24-}		-	***LINETRIGGER-EVENT*** Changes Music back when exiting the Fishmouth Temple in MAP04 [DVI-DS] or MAP12 [DVII-DS] ***LINETRIGGER-EVENT***
	{-25-}		-	***LINETRIGGER-EVENT*** Changes Music for Entering the Fishmouth Temple in MAP04 [DVI-DS] or MAP12 [DVII-DS] ***LINETRIGGER-EVENT***


--NAMED Scripts and their functions--:
	["CENTRALSCRIPTOFEVERYTHING"]	-	******MANDATORY****** Check Player Stuff Consistantly And Startup Stats. ******MANDATORY******
	["CheckBuffTimers"]				-	******MANDATORY****** Redone Buff Checker ******MANDATORY******

	["GiveBuffsPowerup"]			-	***DEBUG*** Enforces Giving or Removing Buffs when certain powerup timers are on/off.
	["DMV"]							-	***DEBUG*** Prints out or changes the number for the "MiscellaneousVars[#]" vars.
	["GiveStats"]					-	***DEBUG*** Cheat to set stats ("pukename GiveStats [type] [value]")
	["EXPCheat"]					-	***DEBUG*** Adds EXP equal to the Amount Inputted ("Pukename EXPCheat [number of experience to add] [EXP type] [EXP Increment Type]" in console) ***DEBUG***
	["TestHudSize"]					-	***DEBUG*** Used for testing SetHudSize customization in-game.
	["TestHudAlign"]				-	***DEBUG*** Used for testing coordinate/alignments on specfic "HudMessage" usages in-game.
	["BuffTimer"]					-	***DEBUG*** Gives a specfic buff/debuff for x amount of seconds.
	["PrintArmorValues"]			-	***DEBUG*** Debugging for Printing Armor Amounts on Screen ***DEBUG***
	["SetManaAmount"]				-	***DEBUG*** Sets Mana to the Current Amount (in console) ***DEBUG***
	["PrintTest"]					-	***DEBUG*** Prints whatever is defined in the script. ***DEBUG***
	["DamagePrintout"]				-	***DEBUG*** Prints out damage on screen for a projectile attached to this script ***DEBUG***
	["SetLevelCap"]					-	***DEBUG*** Set Levelcap Manually ***DEBUG***
	["SetTensionLevel"]				-	***DEBUG*** Sets Tension level to the specfied amount
	
	["GetSceptreLevel"]				-	***WEAPON*** Returns the Sceptre's Level [for A_JumpIf checks in DECORATE]
	["GetSceptreRange"]				-	***WEAPON*** Returns the reach for the Sceptre [mandatory for DECORATE]
	["MeleeImpactRadius"]			-	***WEAPON*** Determines the radius area for melee impacts [Sceptre, Fist-Punches, Gauntlet-Punches]
	["QuakeMeleeIntensity"]			-	***WEAPON*** Determines the strength of the quaking from melee impacts [Sceptre, Fist-Punches, Gauntlet-Punches]
	["QuakeMeleeDuration"]			-	***WEAPON*** Determines the duration of quaking from melee impacts [Sceptre, Fist-Punches, Gauntlet-Punches]
	["QuakeMeleeTremrad"]			-	***WEAPON*** Determines the tremor-radius of quaking from melee impacts [Sceptre, Fist-Punches, Gauntlet-Punches]
	["GetPunchDamage"]				-	***WEAPON*** Returns Punch Damage (including Gauntlets) [including w/ berserk/other amplication items]
	["GetChainsawDamage"]			-	***WEAPON*** Returns Chainsaw Damage [including w/ berserk/other amplication items]
	["GetSceptreDamage"]			-	***WEAPON*** Returns Sceptre Damage [including w/ berserk/other amplication items]
	["GetSigilDamage"]				-	***WEAPON*** Returns Sigil Damage
	["CheckWeaponFlash"]			-	***WEAPON*** Used for the revised Plasma Rifle to assure proper muzzle-flash animations w/ Spreader Aura
	["CheckBFG2704"]				-	***WEAPON*** Used to check the option for BFG2704 usage by both players and BFG-Commandos.
	["CheckShotgunnerSpreads"]		-	***WEAPON*** Used to check the option for what kind of shotgun spreads are used by the Zombies.
	["CheckCrisisAttackType"]		-	***WEAPON*** Used to determine what type of 'crisis' attacks monsters/hellcore-weapons use, if any.

	["DV1M04-Music1"]				-	***EVENT*** Changes Music for Entering the Fishmouth Temple in MAP04 [DVI-DS] or MAP12 [DVII-DS] ***EVENT***
	["DVI-M02EyeDead"]				-	***EVENT*** Killed MAP02 Eye [DVI-DS] / MAP12 First Eye [DVII-DS] ***EVENT***
	["DV1-M04Eye1Dead"]				-	***EVENT*** Killed MAP04 Eye #1 [DVI-DS] / MAP12 Second Eye [DVII-DS] ***EVENT***
	["DV1-M04Eye2Dead"]				-	***EVENT*** Killed MAP04 Eye #2 [DVI-DS] / MAP12 Third Eye [DVII-DS] ***EVENT***
	["DVI-M04MonsterTags"]			-	***EVENT*** Makes Monsters in MAP04 [DVI-DS] or MAP12 [DVII-DS] have a TID of 666 ***EVENT***
	["DVI-MainEyeDeath1"]			-	***EVENT*** Killed MAP04 Main Eye [DVI-DS] / MAP12 Fourth Eye [DVII-DS] ***EVENT***
	["DVI-MainEyeDeath2"]			-	***EVENT*** Defines the Buildup to Sauravatar's appearance [DVI-DS & DVII-DS] ***EVENT***
	["DVI-AwakenSauravatar"]		-	***EVENT*** Awakens the Stone Cyberdemon that becomes Sauravatar [DVI-DS & DVII-DS] ***EVENT***
	["SauravatarRegenMode"]			-	***EVENT*** Health Regeneration for Main Sauravatar [only runs when it walks around] [DVI-DS & DVII-DS] ***EVENT***
	["SauravatarDeath"]				-	***EVENT*** Sauravatar's Death [DVI-DS specific version] ***EVENT***

	["Initializer"]					-	Exp Table Setup (& Initial Startup Process [added for DVI/DVII-DS])
	["ManaRegenerationStuff"]		-	Mana Regeneration
	["CheckManaLevels"]				-	Mana Recovery Items **new for DV-DS and beyond**
	["CreateTranslationTables"]		-	Color Translation Tables **new for DV-DS and beyond**
	["HUDDisplay"]					-	HUD Display
	["ClassicDoom2ArmorCheck"]		-	Makes Armor Bonuses check for Flora's presense in the game in order to change them over to other items [this version is for when playing classic Doom 1/2]
	["MonsterStatsHP_ATK_DEF_SPD"]	-	Determines Attack/Defense/Speed Bonuses for Monsters [depending on difficulty level and maps and game mode]
	["DamageDisplays"]				-	Controls DamageIndicators for Non-Players
	["DoomMonsterDeathEmulation"]	-	Emulates the various special scripts in Doom 1/2 mode [E1M8, MAP07, etc]
	["SauronGauntletsHit"]			-	Controls the Primary Effect of Sauron's Gauntlets when hitting someone [also calls scripts 20, 30 and 49]
	["CheckSceptreAltFire"] 		-	Check if to perform Sceptre's downswing alternate attack while falling.
	["IncreaseHellcoreLevel"]		-	Increasing the Level of Hellcore Weapons when one is picked up
	["LifebarDisplayClientSide"]	-	Controls Lifebar Displays [CLIENTSIDE only]
	["LifebarOptionChecker"]		-	Event Linked to call "LifebarDisplayClientSide" Event
	["GetEvolveChance"] 			-	Checks the mapnumber and gametype for Monster Spawners (evolve chance amount [out of 256])
	["GetStealthChance"]	 		-	Checks the mapnumber and gametype for Monster Spawners (stealth chance amount [out of 256])
	["TunnelVisionControl"]			-	Red Tunnel Vision/Heartbeat Effect when badly injured
	["DeathTunnelVision"]			-	(related to the tunnel vision effect in death >.>)
	["CalculateSpellBaseAngles"]	-	Works for auto-determining spreads for Glyph-type spells and Raging Spirits [for now]
	["IncreaseHellcoreHeat"]		-	Hellcore Overheating/Damage Script [ran with shooting Hellcore-class weapons]
	["SeedLimitChecker"] 			-	Checks to Remove Seeds on the Map if too many have been picked up already.
	["HellcoreWeaponCheckCharacter"]-	Checks and Removes Hellcore weapons when Deggaris or Illucia are detected as the current character
	["GauntletsCheckCharacter"]		-	Checks to see if you already possess Sauron's Gauntlets so they cannot appear more than once.
	["GauntletFlashEffect"]			-	Creates the Screen Flash Effect when Hitting Someone with Sauron's Gauntlets
	["SceptreTwirlManaCheck"]		-	Sceptre Spinning Mana/MP Check
	["SceptreTwirlFrameCheck"]		-	Controls the Timer for both Sceptre Twirl sprite animation and for when to make the swinging noise. [Flora Only]
	["MaxHPBonusPickup"]			-	Max Health Bonus Pickup Script
	["CheckModType"]				-	Checks the gametype for spawns to determine various drops/monster spawns.
	["MagicEffects"]				-	Spell Effects // SCRIPT 8'S POSITION IS BEING ERROR-RIDDEN AT THE MOMENT >_<
	["CursedShieldPain"]			-	Increases the number of points towards uncursing a Ruinous Shield into a Divine Shield
	["GrabLifeManaSeed"]			-	Runs the "Grabbed a Seed of Life/Magic" script
	["GrabSeedOther"]				-	Runs the "Grabbed a Seed of [Bleh]" script
	["SeedDrop"]					-	Checks Seed amounts and will randomize dropped seeds.
	["AeonPointKey"]				-	Overall Aeon Point Handling [combines three once seperated scripts]
	["ShowArmorStats"]				-	Shows Stats for Armor items
	["ChangeArmorPage"]				-	Test Script for Toggling pages for armor display lists
	["SpellSelection"]				-	Spell Selection
	["SpellQuickAssign"]	 		-	Spell Readying
	["SpellCasting"]				-	Spell Casting
	["EmulateGiveHealthBonus"]		-	Health Bonus Pickup Script (also one part of the Sauron's Gauntlet hit effect)
	["EmulateGiveArmorBonus"]		-	Emulates Armor Bonuses for all four types of normal armor in DVI[I]-DS. [Applies Only to Deggaris and Illucia] (also one part of the Sauron's Gauntlet hit effect)
	["SauronItemSpawnerCheck"]		-	Calculates the occurance rate of Sauron's Gauntlets and Sauron's Helmet Dropping.
	["FloraRandomArmorDrop"] 		-	Spawn a Randomized Armor Item for Flora in "DVI" mode [used with "FloraRandomArmor" thing]
	["GrabSoulsphere"]				-	Soulsphere Pickup Script
	["MegaSphereHealth"]			-	Megasphere Pickup Script [for health half]
	["MegaSphereArmor"]				-	MegaSphere Armor [Deggaris & Illucia Only] or Mana [Flora Only]
	["ArmorBonusEyeGlow"]			-	Sets the "glowing eyes" in the "Armor Bonus" items to a specfic color dependant on the current Armor Class of Deggaris/Illucia [does not apply to Flora].
	["CheckFloraArmorCopies"] 		-	Checks and Removes "Copies" of Flora's armor items on maps [when she already has these items]
	["OneRingCopyCheck"]			-	Checks to see if you already possess The One Ring so it cannot appear more than once.
	["HelmetCopyCheck"]				-	Checks to see if you already possess Sauron's Helmet so it cannot appear more than once.
	["SetSauravatarHealth"]			-	Configures the full max health of the Sauravatar and sets it to its proper Health to start the fight [DVI-DS & DVII-DS]
	["DiabloistGravityLock"]		-	Prevents the Diabolist from turning his wrath on a non-player target in order to maintain use of his Gravity attack properly.
	["DiabloistGravityFlash"]		-	Screen Flash for Diabloist's Gravity Attack.
	["DiabloistGravity"]			-	Screen Flash for Diabloist's Gravity Attack.
	["AddSceptreEXP"]				-	Accmulate EXP for Sceptre of Empyrea [Flora only]
	["Hand-GravityAttack"]			-	Using a Diabloist's Hands' HP Gravity attack-projectile on an enemy.
	["DivineShieldChecker"]			-	Checks for DivineShield in inventory for the Ruinous Shield PICKUP.
	["GrabBackpack"]				-	Backpack Pickup Script
	["CheckHealthLevels"]			-	Check if Health is above or below normal max [for customized "normal" health item checks] (All games)
	["PickupMedicalItem"]			-	Stimpack / Medikit / Berserk Pack Pickups (All games)
	["CheckArmorLevels"]			-	Checks Whether a Full Armor Item can be picked up or not
	["PickupArmorMain"]				-	Emulates Main Armor Item Pickups [Applies Only to Deggaris and Illucia]
	["GetMiscellaneousVar"]			-	Returns the value of the index of "MiscellaneousVars[#]" that is referenced [for A_JumpIf checks in DECORATE]
	["GetPlayerLevel"]				-	Returns the Player's Level [for A_JumpIf checks in DECORATE]
	["GetUltraMagicMissileFuse"]	-	Extends the 'lifespan' of Ultra Magic Missiles based on both Sorcery and Therapeusis stats
	["WeaponAngleLoop"]				-	For the Sceptre's Spin Attack & HellCore Weapons (used as a replacement for uservars in weapons)
	["WeaponAngleLoopSecondary"]	-	For the Sceptre's Spin Attack & HellCore Weapons [secondary level] (used as a replacement for uservars in weapons)
	["HellcoreFireMode"]			-	Determines the mode selected for a Hellcore weapon using multiple types of attacks
	["BowAntics"]					-	Determines whether the player is holding down a primed arrow, shooting it, or unarming it.
	["UseStaminaAttack"]			-	Consumes a set amount of Stamina when called [1 = 0.01% stamina consumed, etc] or checks for that much for an A_JumpIf call
	["MaxHPDropChance"]				-	Checks the chance a "MaxHealthBonus" will actually spawn, or turn into multiple HealthBonuses instead.
	["CheckPlayerIfDead"]			-	Used with Sauron Items and Flora's unique armor to prevent an endless repeat of their 'equipped' sounds if a player dies [due to changes made to support death-exit options]
	["TensionAuraCheckVisual"]		-	Checks and Removes Tension Aura-generators that are at level 0
	["CheckTensionLevel"]			-	Check Tension Type for Aura Settings on Aura Actors
	["StartTensionCountDown"]		-	When an attack or a healing ability is activated while Tension is active, starts the countdown for it to fade.
	["TensionParticleSpawnChance"]	-	Checks the Tension Level to determine the chance for aura particle to spawn while charging tension [x / 256]
	["SetKillCount"]				-	Sets the player's amount of kills [or if a negative value is entered, will print the current amount of their kills]
	["AddEXP"]						-	New Method of adding EXP when certain kills or actions are performed, and searches for specfic things like +FRIENDLY of if the player killed said enemy, etc
	["UseWhistle"]					-	Activate's the player's whistle ability, which will awaken as many monsters as possible in a certain area
	["CheckDoomType"]				-	Gets the Type of Classic Doom mode being used
	["GetRagingSpiritDMG"]			-	Returns Damage inflicted by Raging Spirit ghosts.
	["GetPoisonCloudDMG"]			-	Returns Damage inflicted by Poison Clouds.
	["SawCheckSceptre"]				-	Checks the first Chainsaw to become the Sceptre of Empyrea if playing on a Sceptre-less start mode.
	["BerserkCheckSceptre"]			-	Checks Berserk Packs to become the Sceptre of Empyrea if playing on a Sceptre-less start mode.
	["UseCustomInventoryItem"]		-	For actual items that are stored in the inventory
	["CheckCharacterClass"]			-	Returns the Character ID

// Petra Specific Scripts
	["CheckAChristinaCheck"]		-	Script that checks when certain keys are pressed while Alexandra Christina is selected. (Dodge, Bouncing Beams, Heel Kick, Reloading)
	
// Scripts imported from others [and possibly modified]

//******************************************************************
//*Ryan Cordell, SolarSnowfall, HotWax, and Kate's FootSteps System*
//******************************************************************
	["FootSteps_PlayerEntersLevel"]	-	Activates SoundTables, GetVelocity & DoTheMaths on Level Start
	["FootSteps_PlayerRespawning"]	-	Activates SoundTables, GetVelocity & DoTheMaths on Player Respawn
	["FootSteps_GetVelocity"]		-	Gets Player's Movement for footstep assessment
	["FootSteps_DoTheMaths"]		-	Does most of the heavy lifting for calculations on the footsteps script.
	["FootSteps_SoundTables"]		-	Used for determining what flat-groups make specfic sound-sets play.
	["FootSteps_PlayerDeath"]		-	UnSets the Main Scripts

//****************************************************************************************************************************************
//*KeksDose's Dash/Air-Dash System [used also in "The Trailblazer" by PillowBlaster @ http://forum.zdoom.org/viewtopic.php?f=19&t=47494 ]*
//****************************************************************************************************************************************
	["KD-SideDodge"]				-	The Main Script that keeps things in check.
	["KD-ResurrectSideDodge"]		-	Holds the previous script in reserve for temporary deaths [maybe? o.o]
	["KD-ReactivateSideDodge"]		-	Reenables the Dash if a player resurrects.

*/



// TODO: Reduce # of Global Vars >________>; [stupid 64 global var limit]

// Global Vars NOT YET USED AT ALL [26/64]
//-------------------------------------

/*
		global int 0:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
		global int 24:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V 
		global int 25:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
		global int 32:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
		global int 56:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
						--- [KDIZD'S intermap.acs uses it]
		global int 57:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
						--- [KDIZD'S intermap.acs uses it]
		global int 58:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
						--- [KDIZD'S intermap.acs uses it]
		global int 59:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
						--- [KDIZD'S intermap.acs uses it]
		global int 60:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V
						--- [KDIZD'S intermap.acs uses it]
		global int 61:?; // RESERVED FOR MOD GLOBAL VAR USAGE. :V 
						--- [TUTNT'S TNT03A1 uses it]
						--- [TUTNT'S TNT03A2 uses it]
*/

//		global int 9:?;
//      global int 13:?;
//		global int 14:?;
//      global int 15:?;
//		global int 17:?;


//		global int 35:?;
//		global int 39:?;

//		global int 41:?;
//		global int 44:?;
//		global int 47:?;
//		global int 48:?;
//		global int 49:?;

//		global int 51:?;
//		global int 52:?;
//		global int 53:?;


// Global Vars Used by SBARINFO/other lumps, or other vars that can't be changed [13/64]
//-----------------------------------------------------------------------------------
		global int 8:MaxHealthTrue; // USED BY SBARINFO

		global int 20:HellcorePercentFull; // For HUD Displays -- USED BY SBARINFO

		global int 29:HPInterpolationDisplay; // USED BY SBARINFO
		global int 30:CurrentMaxArmor; // All Games -- USED BY SBARINFO

		global int 36:SurvivalWhole; // All Games -- USED BY SBARINFO

		global int 42:StaminaPercent; // USED BY SBARINFO
		global int 43:SavePercent; // USED BY SBARINFO

		global int 45:EvadeWhole; // All Games -- USED BY SBARINFO

		global int 54:SceptreLevelEXP; // For Determining the level of sceptre capabilities and allows it to grow stronger as it's used (Base level plus 16 more levels). -- USED BY SBARINFO
		global int 55:SceptreActualLevel; // USED BY SBARINFO

		global int 61:RuinousShieldPercentF; // USED BY SBARINFO
		global int 62:RuinousShieldPercent; // USED BY SBARINFO
		global int 63:FloraArmorClass; // USED BY SBARINFO

// Global Vars NOT used by SBARINFO/other lumps [and thus can be converted]
//-----------------------------------------------------------------------------
global int 1:Player1TID;
global int 2:CurrentMana;
global int 3:MaxMana;
global int 4:PlayerLevel;
global int 5:SelectedSpell;
global int 6:ReadiedSpells[];

global int 7:DVDSSpecialArrayValue[];
// [0] = Unconsciousness Toggle

global int 9:Experience;
global int 10:ExpTable[]; // Note To Self: NECESSARY TO BE "GLOBAL INT" TO RUN WITH HUB-BASED LEVELS LIKE IN HEXEN OR STRIFE, MISFIT YOU DINGUS-FACE. :V
global int 11:BaseEXPRequirement;

global int 12:ModType; 
// 0 = "Normal" Doom 1/2/Heretic/Hexen/Strife
// 1 = Deus Vult
// 2 = Deus Vult 2

// Powerup Timers [moved to global to allow timers to transition between levels]
global int 16:PowerupTimer[];
// [0] - Light
// [1] - Invisibility
// [2] - Flight
// [3] - Stealth
// [4] - Invulnerability
// [5] - Time Freeze
// [6] - Fear/Terror Aura
// [7] - Divine Avatar
// [8] - Spreader Aura Lv. 1
// [9] - Spreader Aura Lv. 2
// [10] - Oomph [aka Bikill] (2x damage, up to +8% crit rate)
// [11] - Buff (2x defense, up to +10% survival rate, 2x balance)
// [12] - Accelerate (1.33x Speed, up to +10% evade rate, 1.25x jumping)

// [13] - Blunt (0.5x damage, down to -8% crit rate) [not implemented yet]
// [14] - Sap (0.5x defense, down to -10% survival rate, 0.75x balance) [not implemented yet]
// [15] - Decelerate (0.66x Speed, down to -10% evade rate, 0.875x jumping) [not implemented yet]
// [16] - Poison (HP/Health is damaged every so many tics, down to as low as 1 [cannot kill the player]) [not implemented yet]
// [17] - Corrosion (AP/Armor is damaged every so many tics, down to as low as 0) [not implemented yet]
// [18] - Fatigue (HP/Mana/Stamina Regeneration and Hellcore Cooldown are drastically reduced in speed) [not implemented yet]
// [19] - Blind (exactly as on the tin :V) [not implemented yet]
// [20] - Sleep (can't move, see or perform actions, 1.25x more damage from attacks, however HP/MP/Stamina regeneration rates are 5x) [not implemented yet]
// [21] - Silence/Mute (spells are locked out) [not implemented yet]
// [22] - RadSuit (mostly a proper timer for the radsuit)
// [23] - Berserk (mostly a proper timer for the berserk powerup)

// [129] - ??????

global int 18:MiscFixedVars[]; // ***ARRAY*** For various permenant fixed-point vars in scripts
// [1] HUD X Position #1 [Debugger, for easily setting coordinates with HUD testing]
// [2] HUD Y Position #1 [Debugger, for easily setting coordinates with HUD testing
// [3] HUD X Position #2 [Debugger, for easily setting coordinates with HUD testing
// [4] HUD Y Position #2 [Debugger, for easily setting coordinates with HUD testing
// [5] HUD X Position #3 [Debugger, for easily setting coordinates with HUD testing
// [6] HUD Y Position #3 [Debugger, for easily setting coordinates with HUD testing
// [7] HUD X Position #4 [Debugger, for easily setting coordinates with HUD testing
// [8] HUD Y Position #4 [Debugger, for easily setting coordinates with HUD testing
// [9] HUD X Position #5 [Debugger, for easily setting coordinates with HUD testing
// [10] HUD Y Position #5 [Debugger, for easily setting coordinates with HUD testing
// [11] HUD X Position #6 [Debugger, for easily setting coordinates with HUD testing
// [12] HUD Y Position #6 [Debugger, for easily setting coordinates with HUD testing
// [13] HUD X Position #7 [Debugger, for easily setting coordinates with HUD testing
// [14] HUD Y Position #7 [Debugger, for easily setting coordinates with HUD testing
// [15] HUD X Position #8 [Debugger, for easily setting coordinates with HUD testing
// [16] HUD Y Position #8 [Debugger, for easily setting coordinates with HUD testing
// [17] HUD X Position #9 [Debugger, for easily setting coordinates with HUD testing
// [18] HUD Y Position #9 [Debugger, for easily setting coordinates with HUD testing
// [19] HUD X Position #10 [Debugger, for easily setting coordinates with HUD testing
// [20] HUD Y Position #10 [Debugger, for easily setting coordinates with HUD testing
// [101] Invisibility Pulse Level

// Hellcore Energy and Heating
global int 19:HellcoreOverheatLevel; // Every 1% is times 25 tics [1 tics of time equals 4 units]

global int 21:MiscellaneousVars[]; // ***ARRAY*** For various permenant vars in scripts
// [0] is for Base Survival Rate
// [1] is for checking Flora's Armor Bitfield so it doesn't have to run EVERY tic and lag the game too badly.
// [2] is for checking Levels for level specfic boosts so it doesn't have to run EVERY tic and lag the game too badly.
// [3] is for checking Sceptre Levels so it doesn't have to run EVERY tic and lag the game too badly.
// [4] is for saving health ratio for giving Low or Critical Health Inventory items [for Status Bar Displays and using Crisis attacks with Flora's Hellcore weapons]
// [5] is the interpolation timer (how many HP count down/up per tic) [8 is the default for a game like Heretic or Hexen]
// [6] is the Fygg Drop Identification number (out of [7])
// [7] is the highest number for the Fygg chance drop
// [8] is for saving the bow proficency level
// [9] is for the category of spells you're using [for revised Spell Selecting]
// [10] is for the subspell within the current category of spells you're using [for revised Spell Selecting]
// [11] is a "casual" timer for the Ruinous Shield, allowing it to slowly uncurse by 1 point every 2 seconds [30% chance of success each interval].
// [12] is for the death time counter, to fade the screen to blackish-red when the player dies.
// [13] is for how far along the regeneration timer is.
// [14] is the base regeneration interval for the character
// [15] is for the Ruinous Shield's "Degeneration" timer
// [16] is the sceptre timer for mana consumption
// [17] is the sceptre timer limit for mana consumption
// [18] is the amount of raw armor points you have
// [19] is number of times Hellcore Death Obituary has Played
// [20] is the timer for the spinning attack [for weapon checks]
// [21] is current Stamina points
// [22] is maximum Stamina points
// [23] is a character's 'Evasion' chance [out of 100.0%]
// [24] is for the menu position for using Aeon Points [0 = No Selection, 1 = Agility, 2 = Defense, 3 = Deftness, 4 = Sorcery, 5 = Strength, 6 = Therapeusis]
// [25] is for the number of unused Aeon Points [extra points to allocate to stats]
// [26] is the Fygg limit [skill dependant]
// [27] is for the number of Fyggs found [limit is skill dependant]
// [28] is for the Seed of Skill limit amount [to be used in more than one script]
// [29] is for the Seed limit amount [to be used in more than one script]
// [30] is for the total number of seeds of types 31-36 carried by your character [to enforce a limit of seeds found in the game to prevent total game breakage]
// [31] is for the number of Seeds of Agility carried by your character [Speed/Jumping Strength]
// [32] is for the number of Seeds of Defense carried by your character [Overall Defense]
// [33] is for the number of Seeds of Deftness carried by your character [EXP Gains]
// [34] is for the number of Seeds of Sorcery carried by your character [Magic Damage]
// [35] is for the number of Seeds of Strength carried by your character [Overall Damage]
// [36] is for the number of Seeds of Therapeusis carried by your character [Magic Defense]
// [37] is for the number of Seeds of Skill carried by your character [will raise a random type [31-36] by one seed level, even if you have reached your seed limit]
// [38] is for the number of Seeds of Life carried by your character [HP Increases]
// [39] is for the number of Seeds of Magic carried by your character [MP Increases]
// [40] is for a seed of deftness EXP multiplier [x.x% format]
// [41] is the previous number of seeds of Agility so it doesn't have to run EVERY tic and lag the game too badly.
// [42] is the previous number of seeds of Defense so it doesn't have to run EVERY tic and lag the game too badly.
// [43] is the previous number of seeds of Deftness so it doesn't have to run EVERY tic and lag the game too badly.
// [44] is the previous number of seeds of Sorcery so it doesn't have to run EVERY tic and lag the game too badly.
// [45] is the previous number of seeds of Strength so it doesn't have to run EVERY tic and lag the game too badly.
// [46] is the previous number of seeds of Therapeusis so it doesn't have to run EVERY tic and lag the game too badly.
// [47] is for 'stepping' [converted from a global var]
// [48] is for "Experience Needed"
// [49] is for the Gauntlet Flash Effect
// [50] is the Spell-Use Cooldown Timer [possible for future version so spells aren't always tied to how fast you can mash the 'cast spell' buttons :P]
// [51] is for GunFlash uses
// [52] is for Artificial Map Inflation (EXP) [to increase the difficulty of levels by a number of maps]
// [53] is for Artificial Map Inflation (Stats) [to increase the difficulty of levels by a number of maps]
// [54] is for Artificial Map Inflation (Spawn/Stealth) [to increase the difficulty of levels by a number of maps]
// [55] is the Weapon Page number
// [56] is the total number of items so far
// [57] is how many Aeon Points are given from items found so far
// [58] is how many Aeon Points should be given TOTAL from items found so far
// [59] is how many Aeon Points are given from secrets found so far
// [60] is how many Aeon Points should be given TOTAL from secrets found so far
// [61] is how many Aeon Points are given from kills so far
// [62] is how many Aeon Points should be given TOTAL from kills made so far
// [63] is the total number of kills so far
// [64] is the total number of secrets found so far
// [65] is the main storage value for a character's JumpZ height.
// [66] is storage for the level-based multiplier for JumpZ height.
// [67] is storage for the AGLSeed-based multiplier for JumpZ height.
// [68] is storage for bonuses/penalities from armor or other items for JumpZ height.
// [69] is storage for Sceptre for JumpZ height.
// [70] is storage for the Spell# under the "Offense" spell category
// [71] is storage for the Spell# under the "Restorative" spell category
// [72] is storage for the Spell# under the "Status" spell category
// [73] is storage for the Spell# under the "Conjure" spell category
// [74] is storage for a temporary var for helping in-game determination of X-coordinates
// [75] is storage for a temporary var for helping in-game determination of Y-coordinates
// [76] is storage for a temporary var for helping in-game determination of misc elements 1
// [77] is storage for a temporary var for helping in-game determination of misc elements 2
// [78] is storage for a temporary var for helping in-game determination of misc elements 3
// [79] is storage for a temporary var for helping in-game determination of misc elements 4
// [80] is the number of backpacks grabbed.
// [81] is storage for the current Clip maximum. // 1 STRSeed = 5 Bullets, 1 STRLevel = 10 Bullets [need backpacks to maximize use of this] [(Base) + 2560 + 2000 = 4560+]
// [82] is storage for the current Shell maximum. // 1 STRSeed = 2 Shells, 1 STRLevel = 4 Shells [need backpacks to maximize use of this] [(Base) + 1024 + 800 = 1824+]
// [83] is storage for the current Rocket maximum. // 1 STRSeed = 1 Rocket, 1 STRLevel = 2 Rockets [need backpacks to maximize use of this] [(Base) + 512 + 400 = 912+]
// [84] is storage for the current Cell maximum. // 1 STRSeed = 20 Cells, 1 STRLevel = 40 Cells [need backpacks to maximize use of this] [(Base) + 10240 + 8000 = 18240+]
// [85] is storage for the current DiarisArrow maximum. // 1 STRSeed = 3 Arrows, 1 STRLevel = 6 Arrows [need backpacks to maximize use of this] [(Base) + 1536 + 1200 = 2736+]
// [86] is storage for Aeon Points Multiplier [Menu CVar]
// [87] is storage for Seed Multiplier [Menu CVar]
// [88] is storage for SceptreXP Multiplier [Menu CVar]
// [89] is storage for Shield Uncurse Rate [Menu CVar]
// [90] is storage for Base EXP Multiplier [Menu CVar]
// [91] is storage for the ultimate Clip maximum.
// [92] is storage for the ultimate Shell maximum.
// [93] is storage for the ultimate Rocket maximum.
// [94] is storage for the ultimate Cell maximum.
// [95] is storage for the ultimate DiarisArrow maximum.
// [96] is the Current Level of the Imp's Claw
// [97] is the Current Level of the Dark Imp's Claw
// [98] is the Current Level of the Cacodemon's Eye
// [99] is the Current Level of the Cacolantern's Eye
// [100] is the Current Level of the Abaddon's Eye
// [101] is the Current Level of the Hell Knight's Fist
// [102] is the Current Level of the Baron of Hell's Fist
// [103] is the Current Level of the Belphegor's Fist
// [104] is the Current Level of the Bruiser Demon's Fist
// [105] is the Current Level of the Archon of Hell's Fist
// [106] is the Current Level of the Pyro Demon's Fist
// [107] is the Current Level of the Death Incarnate's Skull
// [108] is the Current Level of the Archvile's Hand
// [109] is the Current Level of the Diabloist's Hand
// [110] is the Current Level of the Flying Balrog's Fist
// [111] is the Current Level of the Hades Elemental's Eye [?]
// [112] is the Current Level of the Hades Overlord's Eye [?]
// [113] is the Previous Level of the Imp's Claw
// [114] is the Previous Level of the Dark Imp's Claw
// [115] is the Previous Level of the Cacodemon's Eye
// [116] is the Previous Level of the Cacolantern's Eye
// [117] is the Previous Level of the Abaddon's Eye
// [118] is the Previous Level of the Hell Knight's Fist
// [119] is the Previous Level of the Baron of Hell's Fist
// [120] is the Previous Level of the Belphegor's Fist
// [121] is the Previous Level of the Bruiser Demon's Fist
// [122] is the Previous Level of the Archon of Hell's Fist
// [123] is the Previous Level of the Pyro Demon's Fist
// [124] is the Previous Level of the Death Incarnate's Skull
// [125] is the Previous Level of the Archvile's Hand
// [126] is the Previous Level of the Diabloist's Hand
// [127] is the Previous Level of the Flying Balrog's Fist
// [128] is the Previous Level of the Hades Elemental's Eye [?]
// [129] is the Previous Level of the Hades Overlord's Eye [?]
// [130] is storage for Hellcore Heat Rate [Menu CVar]
// [131] is storage for Hellcore Cool Rate [Menu CVar]
// [132] is the Current Mode for the Bruiser Demon's Fist [0 = Spread Wave, 1 = Larger Fireball, 2 = Ground Wave]
// [133] is the Current Mode for the Archon of Hell's Fist [0 = Three-Shot Spread, 1 = Seven-Shot Spread, 2 = Comet Blast]
// [134] is the Current Mode for the Pyro Demon's Fist [0 = FireShot Wave, 1 = PyroBall, 2 = Firebomb, 3 = Teleport Explosions]
// [135] is the Current Mode for the Diabloist's Hand [0 = Gravity Glare, 1 = Immolation Glare, 2 = Fireblast Volley, 3 = Ground Snakes]
// [136] is Buff Timer Overlay Position [for Portraits]
// [137] is Buff Timer Overlay Transperancy Timer [for Portraits]
// [138] is Buff Timer Overlay Type [for Portraits]
// [139] is Buff Type to show [for portraits]
// [140] is storage for Starting Sceptre Level [Menu CVar]
// [141] is invisibility pulse timer [for portraits]
// [142] is EXP Combo Color Flash Timer
// [143] is for how far along the degeneration timer is.
// [144] is the base degeneration interval for the character
// [145] is the Night Vision Eyeglow Pulse timer [portraits]
// [146] is Level Stat Multiplier [Menu CVar]
// [147] is the Fear/Terror Aura frame timer [portraits]
// [148] is other Stats starting factor [Menu CVar]
// [149] checks if health is 0 after an initial start [for certain situations done by wads like resurgance >___>;]
// [150] saves armor bits [Flora]
// [151] save weapon bits [any character]
// [152] stored Bullets [for Deg/Illu for Forced Pistol Restarts]
// [153] stored Shells [for Deg/Illu for Forced Pistol Restarts]
// [154] stored Rockets [for Deg/Illu for Forced Pistol Restarts]
// [155] stored Cells [for Deg/Illu for Forced Pistol Restarts]
// [156] stored Arrows [for Flora for Forced Pistol Restarts]
// [157] EXP Combo Timer
// [158] EXP Combo Kills
// [159] Combo Multiplier
// [160] Combo EXP Total
// [161] Exp Combo Timer Multiplier
// [162] Exp Combo Base Multipler
// [163] Secondary Spinning Timer
// [164] 5x Stamina Limit
// [165] True Stamina Gain/Cost
// [166] Dash Timer
// [167] Total Monsters Killed by the Player
// [168] Whistle Cooldown Timer
// [169] is for Artificial Map Inflation (OVERALL) [to increase the difficulty of levels by a number of maps]
// [170] Toggle HUD reference image on or off.
// [171] Indicates the player just leveled up [for the new hud] and is the time for the "Level Up!!" and "Stat Up" indicator[s]
// [172] Used for the "glow/fade" of the "Level Up" and "Stat Up" indicators
// [173] Shows "HealthDifference" in the new HUD for Player's "Damage/Healing" bursts.
// [174] Shows "HealthDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
// [175] Shows "NewHealthValue" in the new HUD for the Player's "Damage/Healing" bursts. 
// [176] Shows "ArmorDifference" in the new HUD for Player's "Damage/Healing" bursts.
// [177] Shows "ArmorDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
// [178] Shows "NewArmorValue" in the new HUD for the Player's "Damage/Healing" bursts. 
// [179] Shows "You Died" animation after dying... :V
// [180] is for level up dialouge timer
// [181] Tension Level
// [182] Tension Level Compare
// [183] Tension Timer
// [184] Tension Timer Counts Down
// [185] Tension Warmup Meter [you must hold down for this long for tension to go up a level]
// [186] Tension Cooldown Timer [when Tension levels change, or run out, this decides how long to wait before you can do so again]
// [187] Tension Charge Multiplier [CVAR]
// [188] Tension Max Cooldown Timer [for bar displays]
// [189] Tension Sound Charge Loop Timer
// [190] Active-Tension Pulse Timer
// [191] Saves Minigun heat divisor
// [192] Railgun Charge Level [%]
// [193] Tension Speed Central Multiplier [CVAR]
// [194] Mercy Invincibility "Flag"
// [195] Mercy Invincibility Timer
// [196] Mercy Invincibility 'Modulus/Remainder'
// [197] Aeon Point Start Level (based on the menu option)
// [198] Sceptre's Twirl Timer
// [199] Very-First-Run
// [200] Player's Jump Height
// [201] Player's Balance [or Mass] - for various abilities that make it harder to toss a character around by increasing their mass
// [202] # of Uncurse Points for when holding the Ruinous Shield - For Determining how many points is needed to turn the Ruinous Shield into the Divine Shield.
// [203] Sceptre EXP Fragments [out of 16] - For whiffing with the staff without hitting enemies to slowly increment exp.
// [204] # of Aeon Points gained during a level up [for displays]
// [205] # of Agility Points gained during a level up [for displays]
// [206] # of Defense Points gained during a level up [for displays]
// [207] # of Deftness Points gained during a level up [for displays]
// [208] # of Sorcery Points gained during a level up [for displays]
// [209] # of Strength Points gained during a level up [for displays]
// [210] # of Therapeusis Points gained during a level up [for displays]
// [211] Current Value of Mana Regen Timer
// [212] 'Focus' is in use?
// [213] - ?
// [214] # of Medicinal Herbs [for death-exit checks]
// [215] # of Strong Medicinal Herbs [for death-exit checks]
// [216] # of Special Medicinal Herbs [for death-exit checks]
// [217] # of Yggdrasil Dews [for death-exit checks]
// [218] # of Paxa Punches [for death-exit checks]
// [219] # of Lesser Vimstones [for death-exit checks]
// [220] # of Greater Vimstones [for death-exit checks]
// [221] # of Mercury Bandanas [for death-exit checks]
// [222] # of TOTAL Max HP gained during multiple level ups [for displays]
// [223] # of TOTAL Max MP gained during multiple level ups [for displays]
// [224] # of TOTAL Aeon Points gained during multiple level ups [for displays]
// [225] # of TOTAL Agility Points gained during multiple level ups [for displays]
// [226] # of TOTAL Defense Points gained during multiple level ups [for displays]
// [227] # of TOTAL Deftness Points gained during multiple level ups [for displays]
// [228] # of TOTAL Sorcery Points gained during multiple level ups [for displays]
// [229] # of TOTAL Strength Points gained during multiple level ups [for displays]
// [230] # of TOTAL Therapeusis Points gained during multiple level ups [for displays]
// [231] Focus Timer
// [232] Full Survival Amount # [before being rounded down to a whole number]
// [233] Full Armor Absorbsion # [before being rounded down to a whole number]
// [234] Evasion Amount # [before being rounded down to a whole number]
// [235] Critical Hit Rate %
// [236] Shows "ManaDifference" in the new HUD for Player's "Damage/Healing" bursts.
// [237] Shows "ManaDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
// [238] Shows "NewManaValue" in the new HUD for the Player's "Damage/Healing" bursts. 
// [241] Shows "LastHealthValue" in the new HUD for the Player's "Damage/Healing" bursts.  
// [242] Shows "LastArmorValue" in the new HUD for the Player's "Damage/Healing" bursts.  
// [243] Shows "LastManaValue" in the new HUD for the Player's "Damage/Healing" bursts.  
// [244] Checks for if the player can use the Sceptre's Spin Attack
// [245] Timer for allowing the player to make a Tension Charging Kiai
// [246] Tension Background Aura Timer
// [247] Levelup Speech Timer
// [248] Blind Timer
// [249] Sleep Timer
// [250] Tension Duration Timer
// [251] Tension OverPsyche Timer [Current]
// [252] stored GoldWandAmmo [for Flora for Forced Pistol Restarts]
// [253] stored CrossbowAmmo [for Flora for Forced Pistol Restarts]
// [254] stored BlasterAmmo [for Flora for Forced Pistol Restarts]
// [255] stored SkullRodAmmo [for Deg/Illu for Forced Pistol Restarts]
// [256] stored PhoenixRodAmmo [for Flora for Forced Pistol Restarts]
// [257] stored MaceAmmo [for Flora for Forced Pistol Restarts]
	// [258 to 260] are undefined so far :P
// [261] Tension OverPsyche Timer [Max]
// [262] Tension Duration Timer [Max]
	// [263 to 269] are undefined so far :P
// [270] Seal Timer
// [271] Saves player's XVel when using the menus
// [272] Saves player's YVel when using the menus
// [273] Saves player's ZVel when using the menus
// [274] hold the "jump" var
// [275] hold the "crouch" var
// [276] hold the "jiggle left" var
// [277] hold the "jiggle right" var
// [278] hold the "jiggle up" var
// [279] hold the "jiggle down" var
// [280] is storage for Base Perk Cost Multiplier [Menu CVar]
// [281] is storage for the current GoldWandAmmo maximum.
// [282] is storage for the current CrossbowAmmo maximum.
// [283] is storage for the current BlasterAmmo maximum.
// [284] is storage for the current PhoenixRodAmmo maximum.
// [285] is storage for the current SkullRodAmmo maximum.
// [286] is storage for the current MaceAmmo maximum.
// [287] # of Magic Waters [for death-exit checks]
// [288] # of Sage Elixirs [for death-exit checks]
// [289] # of Elfin Elixirs [for death-exit checks]
// [290] # of Monster Munchies' [for death-exit checks]
// [291] is storage for the ultimate GoldWandAmmo maximum.
// [292] is storage for the ultimate CrossbowAmmo maximum.
// [293] is storage for the ultimate BlasterAmmo maximum.
// [294] is storage for the ultimate PhoenixRodAmmo maximum.
// [295] is storage for the ultimate SkullRodAmmo maximum.
// [296] is storage for the ultimate MaceAmmo maximum.
// [297] Phoenix Rod "FlameCount"
// [298] Initial Max HP [for Strife mode to help calculate extra Sigil damage]
// [299] Checks Ascendant Entity Kill Count
// [300] Bitcheck Reset Timer
// [301] Total Sceptre EXP Required for Level 1
// [302] Total Sceptre EXP Required for Level 2
// [303] Total Sceptre EXP Required for Level 3
// [304] Total Sceptre EXP Required for Level 4
// [305] Total Sceptre EXP Required for Level 5
// [306] Total Sceptre EXP Required for Level 6
// [307] Total Sceptre EXP Required for Level 7
// [308] Total Sceptre EXP Required for Level 8
// [309] Total Sceptre EXP Required for Level 9
// [310] Total Sceptre EXP Required for Level 10
// [311] Total Sceptre EXP Required for Level 11
// [312] Total Sceptre EXP Required for Level 12
// [313] Total Sceptre EXP Required for Level 13
// [314] Total Sceptre EXP Required for Level 14
// [315] Total Sceptre EXP Required for Level 15
// [316] Total Sceptre EXP Required for Level 16
// [317] [STRIFE-Compatibility] Times "Stamina Upgraded"
// [318] [STRIFE-Compatibility] Times "Accuracy Upgraded"
// [319] [STRIFE-Compatibility] Stamina Upgrade Checker
// [320] [STRIFE-Compatibility] Accuracy Upgrade Checker
// [321] is storage for the current ElectricBolts maximum.
// [322] is storage for the current PoisonBolts maximum.
// [323] is storage for the current ClipOfBullets maximum.
// [324] is storage for the current MiniMissiles maximum.
// [325] is storage for the current EnergyPod maximum.
// [326] is storage for the current HEGrenadeRounds maximum.
// [327] is storage for the current PhosphorusGrenadeRounds maximum.
// [328] is storage for the current RifleAmmo maximum.
	// [329 to 330] are undefined so far :P
// [331] is storage for the ultimate ElectricBolts maximum.
// [332] is storage for the ultimate PoisonBolts maximum.
// [333] is storage for the ultimate ClipOfBullets maximum.
// [334] is storage for the ultimate MiniMissiles maximum.
// [335] is storage for the ultimate EnergyPod maximum.
// [336] is storage for the ultimate HEGrenadeRounds maximum.
// [337] is storage for the ultimate PhosphorusGrenadeRounds maximum.
// [338] is storage for the ultimate RifleAmmo maximum.
	// [339 to 396] are undefined so far :P
// [397] Value for SceptreShieldLevel
// [398] Value for BowLevel
// [399] Value for Friction
// [400] Value for AirControl
// [401] # of RockBomb Shards [for death-exit checks]
	// [402 to 448] are undefined so far :P
// [448] is Curse Transperancy Timer [for Portraits]
// [449] is Curse Outline Timer [for Portraits]
// [450] is Curse Overlay Timer [for Portraits]
// [451] is Poison Overlay Timer [for Portraits]
// [452] is Poison Alpha Timer [for Portraits]
// [453] is Tension Fire Timer [for Portraits]
// [454] is Tension Glow Portrait Timer [for Portraits]
// [455] is Berserk Vein Timer [for Portraits]
// [456] is Divine Avatar Glow Timer [for Portraits]
// [457] is Spread Aura Pulse Timer [for Portraits]
// [458] is Blindness Timer [for Portraits]
	// [459 to 500] are undefined so far :P
// [501] is to make sure Flag 1 is set [Strife]
// [502] is to make sure Flag 2 is set [Strife]
// [503] is to make sure Flag 3 is set [Strife]
// [504] is to make sure Flag 4 is set [Strife]
// [505] is to make sure Flag 5 is set [Strife]
// [506] is to make sure Flag 6 is set [Strife]
// [507] is to make sure Flag 7 is set [Strife]
// [508] is to make sure Flag 8 is set [Strife]
// [509] is to make sure Flag 9 is set [Strife]
// [510] is to make sure Flag 10 is set [Strife]
// [511] is to make sure Flag 11 is set [Strife]
// [512] is to make sure Flag 12 is set [Strife]
// [513] is to make sure Flag 13 is set [Strife]
// [514] is to make sure Flag 14 is set [Strife]
// [515] is to make sure Flag 15 is set [Strife]
// [516] is to make sure Flag 16 is set [Strife]
// [517] is to make sure Flag 17 is set [Strife]
// [518] is to make sure Flag 18 is set [Strife]
// [519] is to make sure Flag 19 is set [Strife]
// [520] is to make sure Flag 20 is set [Strife]
// [521] is to make sure Flag 21 is set [Strife]
// [522] is to make sure Flag 22 is set [Strife]
// [523] is to make sure Flag 23 is set [Strife]
// [524] is to make sure Flag 24 is set [Strife]
// [525] is to make sure Flag 25 is set [Strife]
// [526] is to make sure Flag 26 is set [Strife]
// [527] is to make sure Flag 27 is set [Strife]
// [528] is to make sure Flag 28 is set [Strife]
// [529] is to make sure Flag 29 is set [Strife]
// [530] is to make sure Flag 30 is set [Strife]
// [531] is to make sure Flag 31 is set [Strife]
	// [532 to 554] are undefined so far :P
// [555] Gets spell cost into a global array [if needed to give it back for a failed summon :V]
	// [556 to 1998] are undefined so far :P
// [1999] Save Old HUD Toggle [for times where the HUD needs to be turned off fully]
// [2000] HUD mod toggle >.>
// [2001] HUD X Size
// [2002] HUD Y Size
// [2003] HP "Critical" Glow Timer
// [2004] MP "Focus" Glow Timer
// [2005] HLCR "Overheat" Glow Timer
// [2006] STAM "Focus Drain" Glow Timer
// [2007] STAM "Tension Drain" Glow Timer
// [2008] Tension Cooldown Glow Timer
// [2009] Tension Level Glow Timer
// [2010] "Can't Use Spell" Glow Timer
// [2011] QuickSpell Slot 1's "Can't Use Spell" Glow Timer
// [2012] QuickSpell Slot 2's "Can't Use Spell" Glow Timer
// [2013] QuickSpell Slot 3's "Can't Use Spell" Glow Timer
// [2014] QuickSpell Slot 4's "Can't Use Spell" Glow Timer
// [2015] QuickSpell Slot 5's "Can't Use Spell" Glow Timer
// [2016] QuickSpell Slot 6's "Can't Use Spell" Glow Timer
// [2017] QuickSpell Slot 7's "Can't Use Spell" Glow Timer
// [2018] QuickSpell Slot 8's "Can't Use Spell" Glow Timer
// [2019] QuickSpell Slot 9's "Can't Use Spell" Glow Timer
// [2020] QuickSpell Slot (1)0's "Can't Use Spell" Glow Timer
// [2021] Kill Meter's Glow Timer
// [2022] Used to indicate if a specfic type of "OVERKILL" has occured [for the new hud]
// [2023] Used for the "OVERKILL" display timer
// [2024] Shows total EXP for current kill
// [2025] Shows EXP gained only from the combo for current kill
// [2026] EXP Gain Display Timer [new HUD]
// [2027] Current BOSS Meter TID in use
// [2031] MaxHP Gains Timer
// [2032] MaxMP Gains Timer
// [2033] AeonPts Gains Timer
// [2034] Strength Gains Timer
// [2035] Defense Gains Timer
// [2036] Sorcery Gains Timer
// [2037] Therapeusis Gains Timer
// [2038] Agility Gains Timer
// [2039] Deftness Gains Timer
// [2040] Buff/Debuff Message #1 Timer
// [2041] Buff/Debuff Message #2 Timer
// [2042] Buff/Debuff Message #3 Timer
// [2043] Buff/Debuff Message #4 Timer
// [2044] Buff/Debuff Message #5 Timer
// [2045] Buff/Debuff Message #1 TYPE
// [2046] Buff/Debuff Message #2 TYPE
// [2047] Buff/Debuff Message #3 TYPE
// [2048] Buff/Debuff Message #4 TYPE
// [2049] Buff/Debuff Message #5 TYPE
	// [2050] is undefined
// [2051] Tension OverPsyche Glow Timer
// [2052 to 2091] Buff/Debuff Icon/Timer Alpha Timers
	// [2092 to 2499] are undefined so far :P
// [2500] Menu mode toggle. 0 = Off, 1 = On
// [2501] Player should be frozen
// [2502] Unfreeze Player

// [5001] Arcana Points [Petra]

// [5501] Spirit Strike Points [Ailish]

// [9043] "Death Rage" Timer
// [9044] "Death Rage" COOLDOWN Timer

// [9801] is for checking LifeUp BitFields
// [9802] is for checking MagiUp BitFields
// [9803] is for checking StamUp BitFields
// [9804] is for checking NOTHRUST checks

// [9901] LifeUp Perk ComboLevel Check
// [9902] LifeUp Perk PerkFactor
// [9903] LifeUp Perk Base PerkFactor
// [9904] MagiUp Perk ComboLevel Check
// [9905] MagiUp Perk PerkFactor
// [9906] MagiUp Perk Base PerkFactor
// [9907] [STRIFE] Stamina Upgrade [HP] ComboLevel Check
// [9908] [STRIFE] Stamina Upgrade [HP] PerkFactor
// [9909] [STRIFE] Stamina Upgrade [HP] Base PerkFactor
// [9910] [STRIFE] Stamina Upgrade [MP] ComboLevel Check
// [9911] [STRIFE] Stamina Upgrade [MP] PerkFactor
// [9912] [STRIFE] Stamina Upgrade [MP] Base PerkFactor

// [10001] "LifeUp" Perk Level
// [10002] "LifeUp EX" Perk Level
// [10003] "MagiUp" Perk Level
// [10004] "MagiUp EX" Perk Level
// [10005] "StamUp" Perk Level
// [10006] "StamUp EX" Perk Level
// [10007] "DodgeMore" Perk Level
// [10008] "DodgeMore EX" Perk Level
// [10009] "JumpMore" Perk Level
// [10010] "JumpMore EX" Perk Level
// [10011] "PsycheFast" Perk Level
// [10012] "PsycheFast EX" Perk Level
// [10013] "RegenHPFast" Perk Level
// [10014] "RegenHPFast EX" Perk Level
// [10015] "RegenMPFast" Perk Level
// [10016] "RegenMPFast EX" Perk Level
// [10017] "RegenStamFast" Perk Level
// [10018] "RegenStamFast EX" Perk Level
// [10019] "Bullet Accuracy" Perk Level
// [10020] "Bullet Accuracy EX" Perk Level
// [10021] "Pellet Accuracy" Perk Level
// [10022] "Pellet Accuracy EX" Perk Level
// [10023] "Plasma Accuracy" Perk Level
// [10024] "Plasma Accuracy EX" Perk Level
// [10025] "Demolitions Expert" Perk Level
// [10026] "Demolitions Expert EX" Perk Level
// [10027] "Karasawa Attunement" Perk Level
// [10028] "Karasawa Attunement EX" Perk Level
// [10029] "BFG Attunement" Perk Level
// [10030] "BFG Attunement EX" Perk Level
// [10031] "Archery Mastery" Perk Level
// [10032] "Archery Mastery EX" Perk Level
// [10033] "Soul Mastery" Perk Level
// [10034] "Soul Mastery EX" Perk Level
// [10035] "Martial Arts Mastery" Perk Level
// [10036] "Martial Arts Mastery EX" Perk Level
// [10037] "Mortal Hit Survivability Psyche Up" Perk Level
// [10038] "Mortal Hit Survivability Psyche Up EX" Perk Level
// [10039] "Mortal Hit Survivability Mana Recovery" Perk Level
// [10040] "Mortal Hit Survivability Mana Recovery EX" Perk Level
// [10041] "Mortal Hit Survivability Blast Wave" Perk Level
// [10042] "Mortal Hit Survivability Blast Wave EX" Perk Level
// [10043] "Mortal Hit Survivability 'Death Rage'" Perk Level
// [10044] "Mortal Hit Survivability 'Death Rage' EX" Perk Level
// [10045] "On The Move" Perk Level
// [10046] "On The Move EX" Perk Level
// [10047] "Bottomless Magazines" Perk Level
// [10048] "Bottomless Magazines EX" Perk Level
// [10049] "Medical/Medicinal Prowess" Perk Level
// [10050] "Powerup Powerhouse" Perk Level
// [10051] "Berserker Fit" Perk Level
// [10052] "Berserker Fit EX" Perk Level
// [10053] "Wand/Staff Mastery" Perk Level
// [10054] "Wand/Staff Mastery EX" Perk Level
// [10055] "Cleared of Mind" Perk Level
// [10056] "Cleared of Mind EX" Perk Level
// [11001] "Higher Learning" Grand Mastery Perk Level

global int 22:MenuSystemVars[]; // Goto "MENUKEY" for array list.

global int 23:SpecialGameFlags[]; // ***ARRAY***
						// [0 to 999] = DVII related story/game flags
// [0] = Checks for DV2M01 armor item [Safe Tea Shoes]
// [1] = Checks for DV2M02 armor item [Pearly Corset]
// [2] = Checks for DV2M03 armor item [Water Flying Dress]
// [3] = Checks for DV2M04 armor item [Evenstar Necklace]
// [4] = Checks for DV2M05 armor item [Cloak of Evasion]
// [5] = Checks for DV2M05S armor item [Falcon Knife Earrings]
// [6] = Checks for DV2M06 armor item [Anubis Cufflinks]
// [7] = Checks for DV2M07 armor item [Kissa's Brassire]
// [8] = Checks for DV2M08 armor item [Ruinous Shield/Divine Shield]
// [9] = Checks for DV2M09 armor item [Balrog Ring]
// [10] = Checks for DV2M10 armor item [Dove's Ribbon]

						// [1000 to 1999] = DVI related story/game flags
// [10000] = Checks for Sauravatar's activation [DVI]
// [10001] = Final Health Value for the Sauravatar [DVI]
// [10002] = Base Health Value for the Sauravatar [DVI]
// [10003] = Sauravatar's "Moderate" Health Level (will use his Gold BFG attack when below this value) [DVI]
// [10004] = Sauravatar's "Low" Health Level (will use his White BFG attack when below this value) [DVI]

global int 26:MonstersAlive[]; // ***ARRAY*** Array to Replace "MonstersAliveMAPXX" vars.
global int 27:MonstersKilled[]; // ***ARRAY*** Array to Replace "MonstersKilledMAPXX" vars.
global int 28:SecretsFound[]; // ***ARRAY*** Array to Replace "SecretsFoundMAPXX" vars.
// Table Definitions for all Level Held Stat-arrays
// [0] = MAP00 (DVI's Prolouge Level)
// [1] = MAP01 (All Games)
// [2] = MAP02 (All Games)
// [3] = MAP03 (All Games)
// [4] = MAP04 (All Games) // DVI-DS MAP04 (End of Days) & DVII-DS MAP04 (Minas Morgul)
// [5] = MAP05 (All Games) // DVII-DS MAP05 (Eagle's Nest)
// [6] = MAP06 (All Games) // DVII-DS MAP06 (Stargate)
// [7] = MAP07 (All Games) // DVII-DS MAP07 (The Desert Temple)
// [8] = MAP08 (All Games) // DVII-DS MAP08 (The Unholy Cathedral)
// [9] = MAP09 (All Games) // DVII-DS MAP09 (You Shall Not Pass!)
// [10] = MAP10 (All Games) // DVII-DS MAP10 (Hell's Vendetta)
// [11] = MAP11 (All Games) // DVII-DS MAP11 (St. Peter's Gate)
// [12] = MAP12 (All Games) // DVII-DS MAP12 (The Wings of the Maiar)
// [13] = MAP13 (All Games)
// [14] = MAP14 (All Games)
// [15] = MAP15 (All Games)
// [16] = MAP16 (All Games)
// [17] = MAP17 (All Games)
// [18] = MAP18 (All Games)
// [19] = MAP19 (All Games)
// [20] = MAP20 (All Games)
// [21] = MAP21 (All Games)
// [22] = MAP22 (All Games)
// [23] = MAP23 (All Games)
// [24] = MAP24 (All Games)
// [25] = MAP25 (All Games)
// [26] = MAP26 (All Games)
// [27] = MAP27 (All Games)
// [28] = MAP28 (All Games)
// [29] = MAP29 (All Games)
// [30] = MAP30 (All Games)
// [31] = MAP31 (All Games)
// [32] = MAP32 (All Games)
// [33] = MAP05B DVII Only) // DVII-DS MAP05B (The Manliest Level Ever)
// [34] = MAP10B (DVII Only) // DVII-DS MAP10B (AttedneV s'lleH)
// [35] = MAP10C (DVII Only) // DVII-DS MAP10C (attedneV s'lleH: The True End of All Things...)
// [63] = MAP00 (DVII's Prolouge Level)

global int 31:CurrentArmorClass; // All Games

global int 33:CharacterClass; // All Games
// 0 = Deggaris [Doom]
// 1 = Illucia [Doom]
// 2 = Flora [All]
// 3 = Corvus [Heretic]
// 4 = Baratus [Hexen]
// 5 = Parias [Hexen]
// 6 = Daedolon [Hexen]
// 7 = StrifeGuy (Aka. the Mercenary) [Strife]
// 8 = Ailish [All]
// 9 = Petra [All]

global int 34:ClassCheck; // All Games

// New Vars for DVII-DS and the remade DVI-DS. :P

global int 37:LevelCap; // Applies to all games, however Flora's the only character legally able to extend her level cap from 100 to 200.
global int 38:SpellIDLimit; // Defines the total number of spells allowed for quick var references
global int 40:ItemsFound[];
global int 46:ClassicDoomType;
// 0 = Doom 2
// 1 = Doom 1
// 2 = Heretic
// 3 = Hexen
// 4 = Strife
// 5 = Doom64

global int 50:GameScriptEvents[]; // ***ARRAY*** Array for Controlling in-game scripts and story events
// [1401] = MAP04, Damage inflicted by Helltoxins in Minas Morgul
// [1402] = MAP04, Damage timer for Helltoxins in Minas Morgul
// [1403] = MAP04, Checks for the player having Iron Feet powerup or Flora's Safe Passage spells in effect to determine exposure to Hell-Toxins.
// [1801] = MAP08, Spawns all AmbientSound Actors in places meant to be high off the ground.

global int 51:SpiritStrikePoints; //Ailish specific points for Spirit Strike usage

// 0 = Normal, 1 = Other

int FirstRun, KillBonusApplied, ItemBonusApplied, SecretBonusApplied;


str FriendIDHeretic[15] = 
{ 
                    "FHereticImp", "FHereticImpLeader", // 2
                    "FMummy", "FMummyLeader", "FMummyGhost", "FMummyLeaderGhost", // 4
                    "FKnight", "FKnightGhost", // 2
                    // Weak 0-7 [8]

                    "FWizard", // 1
                    "FClink", // 1
                    "FBeast", // 1
                    "FSnake", // 1
                    // Normal 8-12 [4]

                    "FIronLich", // 1
                    // Strong 13 [1]

                    "FMaulotaur" // 1
                    // Cyber-class 14 [1]
};
str FriendIDHexen[14] = 
{ 
                    "FFireDemon", // 1
                    "FEttin", // 1
                    "FIceGuy", // 1
                    // Weak 0-2 [3]

                    "FCentaur", // 1
                    "FWraith", // 1
                    "FBishop", // 1
                    "FStalker", // 1
                    "FEttinCommander", // 1
                    // Normal 3-7 [5]

                    "FVampire", // 1
                    "FSlaughtaur", // 1
                    "FGreenChaosSerpent", "FBrownChaosSerpent", // 2
                    "FStalkerLeader", // 1
                    // Strong 8-12 [5]

                    "FHeresiarch" // 1
                    // Cyber-class 13 [1]
};
/*
str FriendIDStrife[0] = 
{ 
};
*/
str FriendIDDoom[55] = 
{
                    "FZombieman", "FPlasmaGuy", "FRocketLauncherGuy", "FRepeaterZombie", "FKarasawaGuy", // 5
                    "FShotgunGuy", "FSuperShotgunGuy", // 2
                    "FDoomImp", "FDarkImp", "FSTDarkImp", "VoidFDarkImp", // 4
                    "FDemon", "FBloodDemon", // 2
                    "FWolfensteinSS", "FChaingunDemon", // 2
                    "FLostSoul", "FHadesSphere", "FHSOverlord", // 3
                    // Weak 0-17 [18]

                    "FHellCleric", // 1
                    "FSpectre", "FBloodSpectre", // 2
                    "FChaingunGuy", "FBFGGuy", "FChaingunSpectre", // 3
                    "FCacodemon", "FCacolantern", "FAbaddon", "FHadesElemental", // 4
                    "FHellKnight", "FBaronOfHell", // 2
                    // Moderate 18-29 [12]
                    
                    "FFlyingBalrog", // 1
                    "FBaronOfHell", "FBelphegor", "FBruiserDemon", "FCyBruiser", "FArchonOfHell", "FPyroDemon", // 6
                    "FHadesElemental", "FHadesOverlord", // 2
                    "FRevenant", "FDeathIncarnate", // 2
                    "FFatso", "FHectebus", "FDaedabus", // 3
                    "FArachnotron", "FRailArachnotron", "FArachnotronMK2", "FFusionArachnotron", // 3
                    "FHierophant", // 3
                    // Strong 30-48 [18]

                    "FArchvile", "FDiabloist", 
                    // Vile 49-50 [2]

                    "FCyberdemon", "FAnnihilator", 
                    // Cyberdemon 51-52 [2]

                    "FSpiderMastermind", "FDemolisher"
                    // Spider Mastermind 53-54 [2]
};

//*****************************************
//***Deggaris and Illucia's Spell Tables***
//*****************************************
int SpellsLearned[57] = 
{
 1, 					// +1  (Level 0)
 3, 5, 6, 7, 8,			// +2, +2, +2, +1, +1  (Levels 1-5)
 9, 11, 12, 14, 15,		// +1, +1, +2, +1, +2  (Levels 6-10)
 18, 20, 22, 23, 24, 	// +1, +3, +2, +2, +1  (Levels 11-15)
 26, 27, 29, 30, 33, 	// +1, +2, +1, +2, +1  (Levels 16-20)
 37, 38, 39, 40, 44, 	// +3, +4, +1, +1, +1  (Levels 21-25)
 46, 47, 48, 49, 51, 	// +4, +2, +1, +1, +1  (Levels 26-30)
 54, 54, 54, 54, 54,	// +2, +0, +0, +0, +0  (Levels 31-35)
 54, 54, 54, 54, 54,	// +0, +0, +0, +0, +0  (Levels 36-40)
 54, 54, 54, 54, 54,	// +0, +0, +0, +0, +0  (Levels 41-45)
 54, 54, 54, 54, 54,	// +0, +0, +0, +0, +0  (Levels 46-50)
 54, 54, 54, 54, 54,	// +0, +0, +0, +0, +0  (Levels 51-55)
 55						// +1  (Levels 56+)
};

int SpellCastTypes[58] = {
                           0, 1, 2, 0, 3,
                           4,10, 0, 5, 0, 
                           6, 0, 0, 0, 1,
                           7, 8, 9, 3, 0,
                           0, 2, 4, 0, 6,
                           7,10, 0,11, 1,
                           2, 0,12, 7, 8,
                           9, 3, 4, 0, 6,
                          11, 0, 0,10, 0,
                           9, 8, 0, 6, 0,
                          13,14,15,16, 6,
                          18,19,20};
int SpellCastStrength[58] = {
                                0,   2,  10,   1,  10,
                               10,   0,   2,  15,   3, 
                                0,   4,   5,   6,   5,
                                0,  10,  10,  30,   7,
                                8,  30,  30,   9,   1,
                                1,   1,  10,   0,  10,
                               60,  11,   0,   2,  30,
                               30,  60,  60,  12,   2,
                                1,  13,  14,   2,  15,
                               60,  60,  16,   3,  17,
                               15,  30,   0,  30,   4,
                               30,  30,  30
                            };                     
str SpellCategory[4] = {
                         "\cdOffense Magic\c-",		//[0] (23) 0, 3, 6, 7, 9, 11, 12, 13, 15, 19, 20, 23, 25, 26, 27, 31, 33, 38, 41, 42, 43, 44, 49
                         "\cnRestorative Magic\c-",	//[1] (5)  1, 14, 28, 29, 40
                         "\cfStatus Magic\c-",		//[2] (20) 2, 4, 5, 8, 16, 17, 18, 21, 22, 30, 32, 34, 35, 36, 37, 45, 46, 50, 51, 53
                         "\ceConjure Magic\c-"		//[3] (7)  10, 24, 39, 47, 48, 52, 54
                       };
str SpellTable[59] = {                               //[id] (deg?), (ill?), (flo?)
                      "\cdMinor Magic Missile\c-",	  //[0] O, O, O  [Offense]		[Level 0]
                      "\cnMinor Healing\c-", 	 	  //[1] O, O, O  [Restorative]	[Level 0]
                      "\cfMinor Night-Vision\c-", 	  //[2] O, O, O  [Status]		[Level 1]
                      "\cdChill Touch\c-", 	 	 	  //[3] O, O, O  [Offense]		
                      "\cfMinor Invisibility\c-",	  //[4] O, O, O  [Status]
                      "\cfMinor Flight\c-", 	 	  //[5] O, O, O  [Status]
                      "\cdMinor Poison Cloud\c-", 	  //[6] O, X, O  [Offense]
                      "\cdMinor Fireball\c-", 	 	  //[7] O, O, O  [Offense]
                      "\cfEnhanced Strength\c-", 	  //[8] O, O, O  [Status]
                      "\cdMinor Ice Blast\c-", 		  //[9] O, O, O  [Offense]
                      "\ceSummon Weak Monster\c-", 	 //[10] O, O, O  [Conjure]
                      "\cdMagic Missile\c-", 	 	 //[11] O, O, O  [Offense]
                      "\cdFireball\c-", 		 	 //[12] O, O, O  [Offense]
                      "\cdExplosive Glyph\c-", 		 //[13] O, O, O  [Offense]
                      "\cnHealing\c-",	 	 		 //[14] O, O, O  [Restorative]
                      "\cdFireball Nova\c-", 	 	 //[15] X, O, O  [Offense]
                      "\cfMinor Stealth\c-", 		 //[16] O, O, O  [Status]
                      "\cfMinor Invulnerability\c-", //[17] O, O, O  [Status]
                      "\cfInvisibility\c-", 		 //[18] O, O, O  [Status]
                      "\cdAcid Rain\c-",			 //[19] O, O, O  [Offense]
                      "\cdFreezing Glyph\c-", 		 //[20] X, O, O  [Offense]
                      "\cfNight-Vision\c-",  		 //[21] O, O, O  [Status]
                      "\cfFlight\c-",  		 		 //[22] O, O, O  [Status]
                      "\cdMajor Magic Missile\c-", 	 //[23] X, O, O  [Offense]
                      "\ceSummon Monster\c-", 	 	 //[24] O, O, O  [Conjure]
                      "\cdIcy Nova\c-", 			 //[25] O, O, O  [Offense]
                      "\cdPoison Cloud\c-", 		 //[26] O, X, O  [Offense]
                      "\cdMinor Lightning\c-", 		 //[27] O, O, O  [Offense]
                      "\cnStone Skin\c-", 			 //[28] O, O, X  [Restorative]
                      "\cnMajor Healing\c-",		 //[29] X, O, O  [Restorative]
                      "\cfMajor Night-Vision\c-", 	 //[30] X, O, O  [Status]
                      "\cdIce Blast\c-", 			 //[31] O, O, O  [Offense]
                      "\cfFarsight\c-", 			 //[32] O, O, O  [Status]
                      "\cdLightning Nova\c-", 		 //[33] X, O, O  [Offense]
                      "\cfStealth\c-",		 		 //[34] X, O, O  [Status]
                      "\cfInvulnerability\c-",		 //[35] O, O, O  [Status]
                      "\cfMajor Invisibility\c-",	 //[36] X, O, O  [Status]
                      "\cfMajor Flight\c-",			 //[37] X, O, O  [Status]
                      "\cdLightning\c-",			 //[38] O, O, O  [Offense]
                      "\ceSummon Strong Monster\c-", //[39] O, O, O  [Conjure]
                      "\cnDiamond Skin\c-",			 //[40] O, O, X  [Restorative]
                      "\cdMajor Fireball\c-",		 //[41] X, O, O  [Offense]
                      "\cdMajor Ice Blast\c-",		 //[42] X, O, O  [Offense]
                      "\cdMajor Poison Cloud\c-",	 //[43] O, X, O  [Offense]
                      "\cdMajor Lightning\c-",		 //[44] X, O, O  [Offense]
                      "\cfMajor Invulnerability\c-", //[45] X, O, O  [Status]
                      "\cfMajor Stealth\c-",		 //[46] X, O, O  [Status]
                      "\ceRaging Spirits\c-",		 //[47] O, O, O  [Conjure]
                      "\ceSummon Arch-Vile\c-",		 //[48] X, O, O  [Conjure]
                      "\cdUltra Magic Missile\c-",	 //[49] X, X, O  [Offense]
                      "\cfTime Freezer\c-",			 //[50] X, O, O  [Status]
                      "\cfTerrorization Aura\c-",	 //[51] O, X, O  [Status]
                      "\ceCreate Lotso' Ammo\c-",	 //[52] O, O, X  [Conjure]
                      "\cfDivine Avatar\c-",		 //[53] O, O, O  [Status]
                      "\ceSummon Cyberdemon\c-",	 //[54] X, O, O  [Conjure]
                      "\cfSpreader Aura Lv. 2\c-",	 //[55] X, X, O  [Status]
                      "\cfOomph\c-",				 //[56] X, X, O  [Status]
                      "\cfBuff\c-",					 //[57] X, X, O  [Status]
					  "\cfDesperado Damsel\c-"          //[58] X, X, X  [Status]
                     };
// 15, 20, 23, 29, 30, 33, 34, 36, 37, 41, 42, 44, 45, 46, 48, 49, 50, 54, 55, 56, 57, 58 = Deggaris Cannot use these Spell IDs in final version
// 6, 26, 43, 49, 51, 55, 56, 57, 58 = Illucia Cannot use these Spell IDs in final version
// 28, 40, 52, 58 = Flora Cannot use these Spell IDs in final version

str SpellDesc[59] =  {
                      "Shoots an aetherbolt that does minimal damage",				// Minor Magic Missile
                      "Heals 2-4 health points up to ",						// Minor Healing
                      "See as if it were daylight for 10 seconds",					// Minor Night Vision
                      "Send a cold chill into whatever you touch",					// Chill Touch
                      "Become harder to see [and +1/3 Evasion] for 10 seconds",					// Minor Invisibility
                      "Leave the forces of gravity behind for 10 seconds",				// Minor Flight
                      "Creates a stationary cloud of poison",					// Minor Poison Cloud
                      "Shoots a fireball that does low damage",					// Minor Fireball
                      "Multiplies Melee damage by 10x for 15 seconds",				// Enchanced Strength
                      "Fires a few ice shards", 							// Minor Ice Blast
                      "Summons a weak allied monster. 25% chance to spawn two.",	// Summon Weak Monster
                      "A more powerful magic missile",				// Magic Missile
                      "A medium-damage fireball",							// Fireball
                      "Creates a magical proximity mine.",		// Explosive Glyph
                      "Heals 4-9 health points up to ",						// Healing
                      "Creates a ring of fireballs",							// Fireball Nova
                      "Monsters cannot see/hear you for 10 seconds",
                      "Monsters cannot damage you for 10 seconds",
                      "Become harder to see [and +1/3 Evasion] for 30 seconds",
                      "Summons rain from the ceiling down upon your enemies",
                      "Summons an ice-elemental magic proximity mine.",
                      "Darkness will be no problem for 30 seconds",
                      "Bend gravity to your will for 30 seconds",
                      "A very powerful magic missile shot",						// Major Magic Missile
                      "Summons a moderately powerful ally. 25% chance to spawn two.",
                      "Emits a ring of ice shards.",
                      "A stationary poison cloud.  This one has a larger radius",
                      "Give your enemies a nasty shock with this spell",
                      "Fortify yourself with 500 armor, 66% protection",
                      "Heals 8-18 health points up to ",
                      "Makes everything bright for a full minute",
                      "Shoots several ice shards",
                      "Allow you to see the entire map.",
                      "A ring of lightning",
                      "Enemies won't be able to hear/see you for 30 seconds",
                      "Shrug of all damage for 30 seconds",
                      "Become harder to see [and +1/3 Evasion] for a full minute",
                      "Defy gravity for a full minute",
                      "Shoots three lightning blasts",
                      "Summons a powerful allied monster. 25% chance to spawn two.",
                      "Fortify yourself with 1250 armor, 90% protection",				// Diamond Skin
                      "Shoot a highly damaging fireball",						// Major Fireball
                      "Fires lots of ice shards",							// Major Ice Blast
                      "Fill an entire small room with poison",					// Major Poison Cloud
                      "This shoots a shocking 5 lightning blasts",					// Major Lightning
                      "You cannot be damaged for a full minute",					// Major Invulnerability
                      "Hide from your enemies' senses for a full minute",				// Major Stealth
                      "Summon Holy spirits to tear apart your foes.",			// Raging Spirits
                      "Summon an Archvile to turn slain foes to your side.",	// Summon Archvile
                      "The most powerful Magic Missile spell.",				// Ultra Magic Missile
                      "Freeze Time for 15 seconds, rendering all but you frozen.",		// Time Freezer
                      "Makes enemies flee from you in terror for 30 seconds.",			// Terror Aura
                      "Creates a lot of ammo for your weapons.",					// Create Lotso Ammo
                      "Grants you access to your fullest potential in combat!",			// Divine Avatar
                      "Summon a Cyberdemon to destroy your enemies.",		// Summon Cyberdemon
                      "Allows You to Create 6 Extra Copies of Most Attacks/Spells.",	// Spreader Aura Lv. 2
                      "Doubles your damage output for a short time.",	// Oomph
                      "Cut Damage in Half and slightly increase survive rate.",		// Buff
                      "Temporary damage boost for A. Christina (non-enemy fire modes) and hitscan weaponry."		// Desperado Damsel
                     };
int SpellCosts[59] = {
                        1,		// Minor Magic Missile
                        5,		// Minor Healing
                        5,		// Minor Night Vision
                        5,		// Chill Touch
                       15,		// Minor Invisibility
                       10,		// Minor Flight
                       15,		// Minor Poison Cloud
                       10,		// Minor Fireball
                       50,		// Enhanced Strength
                       15,		// Minor Ice Blast
                       50,		// Summon Weak Monster
                       20,		// Magic Missile
                       20,		// Fireball
                       30,		// Explosive Glyph
                       15,		// Healing
                       40,		// Fireball Nova
                       50,		// Minor Stealth
                      100,		// Minor Invulnerability
                       75,		// Invisibility
                       25,		// Acid Rain
                       50,		// Freezing Glyph
                       40,		// Night-Vision
                       75,		// Flight
                       50,		// Major Magic Missile
                      125,		// Summon Monster
                      100,		// Ice Nova
                       75,		// Poison Cloud
                       75,		// Minor Lightning
                      100,		// Stone Skin
                       55,		// Major Healing
                      100,		// Major Night-Vision
                       50,		// Ice Blast
                      150,		// Farsight
                      150,		// Lightning Nova
                      150,		// Stealth
                      200,		// Invulnerability
                      150,		// Major Invisibility
                      150,		// Major Flight
                      125,		// Lightning
                      220,		// Summon Strong Monster
                      200,		// Diamond Skin
                       50,		// Major Fireball
                       75,		// Major Ice Blast
                      130,		// Major Poison Cloud
                      175,		// Major Lightning
                      250,		// Major Invulnerability
                      200,		// Major Stealth
                      150,		// Raging Spirits
                      250,		// Summon Archvile
                      160,		// Ultra Magic Missile
                      325,		// Time Freezer
                      225,		// Terror Aura
                      300,		// Create Lotso Ammo
                        0, 	// Divine Avatar [value doesn't matter since it auto-calculates based on max MP]
                      500,		// Summon Cyberdemon
                     1025,		// Spreader Aura Lv. 2
                       80,		// Oomph
                       30,		// Buff
					   80       // Desperato Damsel
                     };

//***********************************
//***Flora's Spell Table [DVII-DS]***
//***********************************
/*

//***********************************************************
// GuideList of Numbers for Flora's Spells [Doomspell-Style]*
//***********************************************************
// TODO later :P
1. Minor Magic Missile (2)
2. Minor Farsight (4)
3. Summon Imp (6)
4. Minor Flight (7)
5. Minor Polymorphosis (9)
6. Magic Missile (10)
7. Summon Pinky (11)
8. Minor Stealth (13)
9. Farsight (14)
10. Enhanced Strength (15)
11. Summon Cacodemon (16)
12. Major Magic Missile (17)
13. Minor Invulnerability (18)
14. Flight (19)
15. Spiritual Exoskin (20)
16. Minor Revenger (22)
17. Summon Hell Noble (23)
18. Major Farsight (24)
19. Minor Charm (24)
20. Stealth (26)
21. Invulnerability (28)
22. Summon Archvile (29)
23. Ultra Magic Missile (30)
24. Polymorphosis (30)
25. Major Flight (32)
26. Summon Cyberdemon (36)
27. Major Stealth (37)
28. Major Invulnerability (39)
29. Greater Spiritual Exoskin (40)
30. Charm (42)
31. Revenger (43)
32. Aura of Anubis (45)
33. Create Ammo (48)
34. Spreader Aura Lv. 2 (56)
35. Major Polymorphosis (62)
36. Dyspersion (64)
37. Major Charm (66)
38. Divine Avatar (69)
39. Light Haze Smite (77)
40. Major Revenger (84)
41. Perfected Spiritual Exoskin (92)
42. Shielding of the Larries (132)

//*************************************************************
// GuideList of Numbers for Flora's Spells [DragonQuest-Style]*
//*************************************************************
// TODO later :P
1. MidHeal (1)
2. Appraise (3)
3. KaBuff (11)
4. Dazzle (12)
5. Oomph (13)
6. Snooze (14)
7. Safe Passage (15)
8. Sizzle (16)
9. Tick-Tock (17)
10. Bounce (18)
11. Frizzle (20)
12. Crackle (21)
13. Kasap (22)
14. Thwack (23)
15. KaDazzle (25)
16. Zap (25)
17. Insulatle (26)
18. KaSizzle (27)
19. HighHeal (31)
20. KaFrizzle (33)
21. Tickety-Tockety (34)
22. Kazap (35)
23. KaClang (36)
24. KaBoom (37)
25. AbsMagic (41)
26. Crackle (45)
27. StopSpell (48)
28. MegaHeal (52)
29. DeMagic (63)
30. Kaboomle (66)
31. ?
32. ?
33. ?

// 43 Doomspell-Style Spells
int FloraSpellsLearnedDoomspell[201] = 
{
 // Add Here Later
 0,						// Level 0
 0, 1, 1, 2, 2,			// Levels 1-5
 3, 4, 4, 5, 6,			// Levels 6-10
 7, 7, 8, 9, 10,		// Levels 11-15
 11, 12, 13, 14, 15,	// Levels 16-20
 15, 16, 17, 19, 19,	// Levels 21-25
 20, 20, 21, 22, 24,	// Levels 26-30
 24, 25, 25, 25, 25,	// Levels 31-35
 26, 27, 27, 28, 29,	// Levels 36-40
 29, 30, 31, 31, 32,	// Levels 41-45
 32, 32, 33, 33, 33,	// Levels 46-50
 33, 33, 33, 33, 33,	// Levels 51-55
 34, 34, 34, 34, 34,	// Levels 56-60
 34, 35, 35, 36, 36,	// Levels 61-65
 37, 37, 37, 38, 38,	// Levels 66-70
 38, 38, 38, 38, 38,	// Levels 71-75
 38, 39, 39, 39, 39,	// Levels 76-80
 39, 39, 39, 40, 40,	// Levels 81-85
 40, 40, 40, 40, 40,	// Levels 86-90
 40, 41, 41, 41, 41,	// Levels 91-95
 41, 41, 41, 41, 41,	// Levels 96-100
};

// 33 DragonQuest-Style Spells
int FloraSpellsLearnedDQ5Style[201] = 
{
 // Add Here Later
 0,						// Level 0
 1, 1, 2, 2, 2,			// Levels 1-5
 2, 2, 2, 2, 2,			// Levels 6-10
 3, 4, 5, 6, 7,			// Levels 11-15
 8, 9, 10, 10, 11,		// Levels 16-20
 12, 13, 14, 14, 16,	// Levels 21-25
 17, 18, 18, 18, 18,	// Levels 26-30
 19, 19, 20, 21, 22,	// Levels 31-35
 23, 24, 24, 24, 24,	// Levels 36-40
 25, 25, 25, 25, 26,	// Levels 41-45
 26, 26, 27, 27, 27,	// Levels 46-50
 27, 28, 28, 28, 28,	// Levels 51-55
 28, 28, 28, 28, 28,	// Levels 56-60
 28, 28, 29, 29, 29,	// Levels 61-65
 30, 30, 30, 30, 30,	// Levels 66-70
 30, 30, 30, 30, 30,	// Levels 71-75
 30, 30, 30, 30, 30,	// Levels 76-80
 30, 30, 30, 30, 30,	// Levels 81-85
 30, 30, 30, 30, 30,	// Levels 86-90
 30, 30, 30, 30, 30,	// Levels 91-95
 30, 30, 30, 30, 30,	// Levels 96-100
};


// Doomspell-Style Types
int FloraSpellCastTypesDS[43] = 
{
 // Add Here Later
};
// DragonQuest-Style Types
int FloraSpellCastTypesDQ[33] = 
{
 // Add Here Later
};


// Doomspell-Style Types
int FloraSpellCastStrengthDS[43] = 
{
 // Add Here Later
};
// DragonQuest-Style Types
int FloraSpellCastStrengthDQ[33] = 
{
 // Add Here Later
};

// Doomspell-Style Names
str FloraSpellNameTableDS[43] =
{
 // Add Here Later
};
// DragonQuest-Style Names
str FloraSpellNameTableDQ[33] =
{
 // Add Here Later
};


// Doomspell-Style Descriptions
str FloraSpellDescDS[43] =
{
 // Add Here Later
};
// DragonQuest-Style Descriptions
str FloraSpellDescDQ[33] =
{
 // Add Here Later
};

// Doomspell-Style Spell Costs [Exact Values, not %ages]
int FloraSpellCostsDS[43] =
{
 // Add Here Later
};
// Doomspell-Style Spell Costs [Usually in %ages, not exact values]
int FloraSpellCostsDQ[33] =
{
 0, // No Spell
 5, 3, 6, 4, 6,	// 1-5
 3, 2, 6, 4, 4,	// 6-10
};

*/

//***TO BE ADDED IN THE FUTURE***

//*********************
//*********************
//******FUNCTIONS******
//*********************
//*********************

// SetActorPositionForced
function bool SetActorPositionForced(int tid, int x, int y, int z, bool fog)
{
   Warp(tid, x, y, z, 0, WARPF_MOVEPTR|WARPF_ABSOLUTEPOSITION|WARPF_NOCHECKPOSITION);
   if (fog)
      SpawnForced("TeleportFog", x, y, z);
   return true;
}

// Healing Formula [for displays and actual calculations]
function int GetHealingValue (int type, int MinOrMax)
{
 int HealSorcRatio, value;

 if (type == 0) // Minor Healing
 {
  if (MinOrMax == 0) // Min
  {
   value = 1;
   value += (PlayerLevel / 6);
  }
  if (MinOrMax == 1) // Max
  {
   value = 3;
   value += (PlayerLevel / 6);
  }
  if (CharacterClass == 2) value = value * 7 / 4;
 }


 if (type == 1) // Healing
 {
  if (MinOrMax == 0) // Min
  {
   value = 7; 
   value += (PlayerLevel / 5);
  }
  if (MinOrMax == 1) // Max
  {
   value = 12; 
   value += (PlayerLevel / 5);
  }
  if (CharacterClass == 2) value = value * 5 / 2;
 }


 if (type == 2) // Major Healing
 {
  if (MinOrMax == 0) // Min
  {
   value = 15; 
   value += (PlayerLevel / 4);
  }
  if (MinOrMax == 1) // Max
  {
   value = 25; 
   value += (PlayerLevel / 4);
  }
  if (CharacterClass == 2) value = value * 7 / 2;
 }

 if (type == 3) // Heal [DQ]
 {
  if (MinOrMax == 0) // Min
  {
   value = 24; 
   value += (PlayerLevel / 5);
  }
  if (MinOrMax == 1) // Max
  {
   value = 36; 
   value += (PlayerLevel / 5);
  }
 }
 
 if (type == 4) // MidHeal [DQ]
 {
  if (MinOrMax == 0) // Min
  {
   value = 60; 
   value += (PlayerLevel / 4);
  }
  if (MinOrMax == 1) // Max
  {
   value = 90; 
   value += (PlayerLevel / 4);
  }
 }
 
 if (type == 5) // MoreHeal [DQ]
 {
  if (MinOrMax == 0) // Min
  {
   value = 135; 
   value += (PlayerLevel / 4);
  }
  if (MinOrMax == 1) // Max
  {
   value = 210; 
   value += (PlayerLevel / 4);
  }
 }
 
 if (type == 6) // FullHeal [DQ]
 {
  value = MaxHealthTrue; 
 }
 
 // Stat Alternations
 value = value * (10 + (PlayerLevel / 25)) / 10;
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) value = value * 9 / 8;
 if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0) value = value * 9 / 8; // Deggaris w/ Gauntlets
 if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) value = value * 9 / 8; // Illucia w/ Gauntlets
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) value = value * 9 / 8; // Flora w/ Gauntlets
 if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) value = value * 9 / 8; // Ailish w/ Gauntlets
 if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) value = value * 9 / 8; // Petra w/ Gauntlets
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) value = value * 5 / 2;

 // Divine Avatar
 if (PowerupTimer[7] > 0) value *= 4;

 // ???
 if (PowerupTimer[129] > 0) value *= 10;

 // Healing Strength is increased based on Sorcery stat
 if (CharacterClass == 0) HealSorcRatio = (MiscellaneousVars[34] * 75) / 300;
 if (CharacterClass == 1) HealSorcRatio = (MiscellaneousVars[34] * 75) / 200;
 if (CharacterClass == 2) HealSorcRatio = (MiscellaneousVars[34] * 75) / 150;
 if (CharacterClass == 8) HealSorcRatio = (MiscellaneousVars[34] * 75) / 175;
 if (CharacterClass == 9) HealSorcRatio = (MiscellaneousVars[34] * 75) / 200;
 HealSorcRatio += 100;
 value = (value * HealSorcRatio) / 100;
 // Healing Strength is also increased based on Thrapeusis stat
 if (CharacterClass == 0) HealSorcRatio = (MiscellaneousVars[36] * 225) / 300;
 if (CharacterClass == 1) HealSorcRatio = (MiscellaneousVars[36] * 225) / 200;
 if (CharacterClass == 2) HealSorcRatio = (MiscellaneousVars[36] * 225) / 150;
 if (CharacterClass == 8) HealSorcRatio = (MiscellaneousVars[36] * 225) / 175;
 if (CharacterClass == 9) HealSorcRatio = (MiscellaneousVars[36] * 225) / 200;
 HealSorcRatio += 100;
 value = (value * HealSorcRatio) / 100;

 str TensionItem;
 if (MiscellaneousVars[181] == 0) TensionItem = "0";
 if (MiscellaneousVars[181] == 1) TensionItem = "5";
 if (MiscellaneousVars[181] == 2) TensionItem = "20";
 if (MiscellaneousVars[181] == 3) TensionItem = "50";
 if (MiscellaneousVars[181] == 4) TensionItem = "100";
 if (MiscellaneousVars[181] == 5) TensionItem = "250";
 if (MiscellaneousVars[181] == 6) TensionItem = "500";
 if (MiscellaneousVars[181] == 7) TensionItem = "1000";
 //PrintBold(s:"Pre-Tension [Heal] (",s:TensionItem,s:"): ",d:value);
 if (MiscellaneousVars[181] == 1) value = value * 17 / 10; // 1.7x
 if (MiscellaneousVars[181] == 2) value = value * 3; // 3x
 if (MiscellaneousVars[181] == 3) value = value * 5; // 5x
 if (MiscellaneousVars[181] == 4)  value = value * 15 / 2; // 7.5x
 if (MiscellaneousVars[181] == 5)  value = value * 45 / 4; // 11.25x
 if (MiscellaneousVars[181] == 6)  value = value * 35 / 2; // 17.5x
 if (MiscellaneousVars[181] == 7)  value = value * 25; // 25x
 //PrintBold(s:"Post-Tension [Heal] (",s:TensionItem,s:"): ",d:value);

 return value;
}

function int SetInventory (str item, int count) 
{
 int n = count - CheckInventory (item);
 if (n > 0)
  GiveInventory (item, n);
 else if (n < 0)
  TakeInventory (item, -n);

 return n;
}

function int SetActorInventory (int tid, str item, int count) 
{
 int n = count - CheckActorInventory (tid, item);
 if (n > 0)
  GiveActorInventory (tid, item, n);
 else if (n < 0)
  TakeActorInventory (tid, item, -n);

 return n;
}

// This function will place text or a sprite (depending on parameters passed) at the onscreen position of an actor with the specified tid, as long as it's in range (fixed mapunits). 


function void hudmessageonactor(int tid, int range, str sprite, str text)
{
 int dist, ang, vang, pitch, x, y;
 int HUDX = 640;
 int HUDY = 400;
 int offset = 0;

 if(sprite != NULLSTR)
 {
  setfont(sprite);
  text = "A";
  offset = 0.1;
 }

 sethudsize(HUDX, HUDY, 1);
 x = getactorx(tid) - getactorx(0);
 y = getactory(tid) - getactory(0); 

 vang = vectorangle(x,y);
 ang = (vang - GetActorAngle(0) + 1.0) % 1.0;

 if(((vang+0.125)%0.5) > 0.25) dist = fixeddiv(y, sin(vang));
 else dist = fixeddiv(x, cos(vang));

 if ((ang < 0.2 || ang > 0.8) && dist < range)
 {
  pitch = vectorangle(dist, getactorz(tid) - (getactorz(0) + 41.0));
  pitch = (pitch + GetActorPitch(0) + 1.0) % 1.0;

  x = HUDX/2 - ((HUDX/2) * sin(ang) / cos(ang));
  y = HUDY/2 - ((HUDX/2) * sin(pitch) / cos(pitch));

  hudmessage(s:text; 0, 1, CR_UNTRANSLATED, (x<<16)+offset, (y<<16)+offset, 0);
 }
 else
 hudmessage(s:" "; 0, 1, CR_UNTRANSLATED, 0, 0, 0);
}

// This Function will be used to check Spell Costs, all wrapped up in one place and easier to edit. :P
function int SpellCostCheck(int checktype)
{
 int SpellIsSelected, FinalSpellCost, DivineAvatarPercentCost, SpellCostDeclineLevelsNeeded, LevelSpellCostReductionFactor, LvlSpellCostReducePercent, SecretSplCostReduceBonus, Check1, Check2;
 int OriginalSpellCost, StatManaCostReduction;

 // G1 = FinalSpellCost
 SpellIsSelected = checktype;

 // G4 = DivineAvatarPercentCost
 if (SpellIsSelected == 53) // Divine Avatar Costs at most 90% of Mana Supply by Default
 {
  if (GameSkill() == SKILL_VERY_EASY) DivineAvatarPercentCost = 80;
  else if (GameSkill() == SKILL_EASY) DivineAvatarPercentCost = 90;
  else if (GameSkill() == SKILL_NORMAL) DivineAvatarPercentCost = 92;
  else if (GameSkill() == SKILL_HARD) DivineAvatarPercentCost = 95;
  else if (GameSkill() == SKILL_VERY_HARD) DivineAvatarPercentCost = 100;

  FinalSpellCost = MaxMana * DivineAvatarPercentCost / 100;
  OriginalSpellCost = MaxMana * DivineAvatarPercentCost / 100;
 }
 else
 if (SpellIsSelected == 40) // Diamond Skin / Spreader Aura Lv. 1
 {
  if (CharacterClass == 2) // If Flora is in use, it'll be Spreader Aura Lv. 1
  {
   FinalSpellCost = 575;
   OriginalSpellCost = 575;
  }
  else // Otherwise, it's DiamondSkin and uses the usual costs
  {
   FinalSpellCost = SpellCosts[SpellIsSelected];
   OriginalSpellCost = SpellCosts[SpellIsSelected];
  }
 }
 else
 if (SpellIsSelected == 15)
 {
  if (CharacterClass == 9) //If Petra is in use, it will be Desperado Damsel
  {
   FinalSpellCost = SpellCosts[58];
   OriginalSpellCost = SpellCosts[58];  
  }
  else
  {
   FinalSpellCost = SpellCosts[15];
   OriginalSpellCost = SpellCosts[15];
  }
 }
 else
 {
  FinalSpellCost = SpellCosts[SpellIsSelected];
  OriginalSpellCost = SpellCosts[SpellIsSelected];
 }
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [Original Base]");

  // SpellCostDeclineLevelsNeeded = Number of Levels needed to be gained before the spell begins to decline in cost at every level up
  if (SpellIsSelected == 0) SpellCostDeclineLevelsNeeded = 12; // (Minor Magic Missile) Level 0
  if (SpellIsSelected == 1) SpellCostDeclineLevelsNeeded = 12; // (Minor Healing) Level 0
  if (SpellIsSelected == 2) SpellCostDeclineLevelsNeeded = 13; // (Minor Night Vision) Level 1
  if (SpellIsSelected == 3) SpellCostDeclineLevelsNeeded = 13; // (Chill Touch) Level 1
  if (SpellIsSelected == 4) SpellCostDeclineLevelsNeeded = 14; // (Minor Invisibility) Level 2
  if (SpellIsSelected == 5) SpellCostDeclineLevelsNeeded = 14; // (Minor Flight) Level 2
  if (SpellIsSelected == 6) SpellCostDeclineLevelsNeeded = 15; // (Minor Poison Cloud) Level 3
  if (SpellIsSelected == 7) SpellCostDeclineLevelsNeeded = 16; // (Minor Fireball) Level 4
  if (SpellIsSelected == 8) SpellCostDeclineLevelsNeeded = 17; // (Enhanced Strength) Level 5
  if (SpellIsSelected == 9) SpellCostDeclineLevelsNeeded = 18; // (Minor Ice Blast) Level 6
  if (SpellIsSelected == 10) SpellCostDeclineLevelsNeeded = 19; // (Summon Weak Monster) Level 7
  if (SpellIsSelected == 11) SpellCostDeclineLevelsNeeded = 19; // (Magic Missile) Level 7
  if (SpellIsSelected == 12) SpellCostDeclineLevelsNeeded = 20; // (Fireball) Level 8
  if (SpellIsSelected == 13) SpellCostDeclineLevelsNeeded = 21; // (Explosive Glyph) Level 9
  if (SpellIsSelected == 14) SpellCostDeclineLevelsNeeded = 21; // (Healing) Level 9
  if (SpellIsSelected == 15) SpellCostDeclineLevelsNeeded = 22; // (Fireball Nova) or (Desperado Damsel) [Petra] Level 10
  if (SpellIsSelected == 16) SpellCostDeclineLevelsNeeded = 23; // (Minor Stealth) Level 11
  if (SpellIsSelected == 17) SpellCostDeclineLevelsNeeded = 23; // (Minor Invulnerability) Level 11
  if (SpellIsSelected == 18) SpellCostDeclineLevelsNeeded = 23; // (Invisibility) Level 11
  if (SpellIsSelected == 19) SpellCostDeclineLevelsNeeded = 24; // (Acid Rain) Level 12
  if (SpellIsSelected == 20) SpellCostDeclineLevelsNeeded = 24; // (Freezing Glyph) Level 12
  if (SpellIsSelected == 21) SpellCostDeclineLevelsNeeded = 25; // (Night-Vision) Level 13
  if (SpellIsSelected == 22) SpellCostDeclineLevelsNeeded = 25; // (Flight) Level 13
  if (SpellIsSelected == 23) SpellCostDeclineLevelsNeeded = 26; // (Major Magic Missile) Level 14
  if (SpellIsSelected == 24) SpellCostDeclineLevelsNeeded = 27; // (Summon Monster) Level 15
  if (SpellIsSelected == 25) SpellCostDeclineLevelsNeeded = 28; // (Icy Nova) Level 16
  if (SpellIsSelected == 26) SpellCostDeclineLevelsNeeded = 28; // (Poison Cloud) Level 16
  if (SpellIsSelected == 27) SpellCostDeclineLevelsNeeded = 29; // (Minor Lightning) Level 17
  if (SpellIsSelected == 28) SpellCostDeclineLevelsNeeded = 30; // (Stone Skin) Level 18
  if (SpellIsSelected == 29) SpellCostDeclineLevelsNeeded = 30; // (Major Healing) Level 18
  if (SpellIsSelected == 30) SpellCostDeclineLevelsNeeded = 31; // (Major Night-Vision) Level 19
  if (SpellIsSelected == 31) SpellCostDeclineLevelsNeeded = 32; // (Ice Blast) Level 20
  if (SpellIsSelected == 32) SpellCostDeclineLevelsNeeded = 32; // (Farsight) Level 20
  if (SpellIsSelected == 33) SpellCostDeclineLevelsNeeded = 32; // (Lightning Nova) Level 20
  if (SpellIsSelected == 34) SpellCostDeclineLevelsNeeded = 33; // (Stealth) Level 21
  if (SpellIsSelected == 35) SpellCostDeclineLevelsNeeded = 33; // (Invulnerability) Level 21
  if (SpellIsSelected == 36) SpellCostDeclineLevelsNeeded = 33; // (Major Invisibility) Level 21
  if (SpellIsSelected == 37) SpellCostDeclineLevelsNeeded = 33; // (Major Flight) Level 21
  if (SpellIsSelected == 38) SpellCostDeclineLevelsNeeded = 34; // (Lightning) Level 22
  if (SpellIsSelected == 39) SpellCostDeclineLevelsNeeded = 35; // (Summon Strong Monster) Level 23
  if (SpellIsSelected == 40) SpellCostDeclineLevelsNeeded = 36; // (Diamond Skin) [Deggaris/Illucia] or (Spreader Aura Lv. 1) [Flora] Level 24
  if (SpellIsSelected == 41) SpellCostDeclineLevelsNeeded = 37; // (Major Fireball) Level 25
  if (SpellIsSelected == 42) SpellCostDeclineLevelsNeeded = 37; // (Major Ice Blast) Level 25
  if (SpellIsSelected == 43) SpellCostDeclineLevelsNeeded = 37; // (Major Poison Cloud) Level 25
  if (SpellIsSelected == 44) SpellCostDeclineLevelsNeeded = 37; // (Major Lightning) Level 25
  if (SpellIsSelected == 45) SpellCostDeclineLevelsNeeded = 38; // (Major Invulnerability) Level 26
  if (SpellIsSelected == 46) SpellCostDeclineLevelsNeeded = 38; // (Major Stealth) Level 26 
  if (SpellIsSelected == 47) SpellCostDeclineLevelsNeeded = 39; // (Raging Spirits) Level 27
  if (SpellIsSelected == 48) SpellCostDeclineLevelsNeeded = 40; // (Summon Arch-Vile) Level 28
  if (SpellIsSelected == 49) SpellCostDeclineLevelsNeeded = 41; // (Ultra Magic Missile) Level 29
  if (SpellIsSelected == 50) SpellCostDeclineLevelsNeeded = 42; // (Time Freezer) Level 30
  if (SpellIsSelected == 51) SpellCostDeclineLevelsNeeded = 42; // (Terrorization Aura) Level 30
  if (SpellIsSelected == 52) SpellCostDeclineLevelsNeeded = 42; // (Create Lotso Ammo) Level 30
  if (SpellIsSelected == 53) SpellCostDeclineLevelsNeeded = 43; // (Divine Avatar) Level 31
  if (SpellIsSelected == 54) SpellCostDeclineLevelsNeeded = 43; // (Summon Cyberdemon) Level 31
  if (SpellIsSelected == 55) SpellCostDeclineLevelsNeeded = 68; // (Spreader Aura Lv. 2) Level 56 [Flora Only]

  // Base Spell Cost Reduction Factor [level-based] 
  LevelSpellCostReductionFactor = PlayerLevel - SpellCostDeclineLevelsNeeded;
  if (LevelSpellCostReductionFactor < 0) LevelSpellCostReductionFactor = 0;

  LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 2 / 30; // This is for any class that is not one of the below otherwise ignore this line
  if (CharacterClass == 0) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 1 / 18; // 5.55% [Deggaris]
  else if (CharacterClass == 1) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 1 / 16; // 6.25% [Illucia]
  else if (CharacterClass == 2) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 2 / 18; // 11.1% [Flora]
  else if (CharacterClass == 8) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 2 / 20; // 10% [Ailish]
  else if (CharacterClass == 9) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 1 / 12; // 8.33% [Petra]

  LvlSpellCostReducePercent = 100;
  LvlSpellCostReducePercent -= LevelSpellCostReductionFactor;
  FinalSpellCost = FinalSpellCost * LvlSpellCostReducePercent / 100;
  if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [LevelCostReduce]");

  if (SpellIsSelected == 50) // Time Freezer Costs at least 25% of Mana Supply by Default (Deggaris and Illucia Only)
  {
   LevelSpellCostReductionFactor = MaxMana / 4;
   FinalSpellCost += LevelSpellCostReductionFactor;
   if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [TimeFreezerCheck]");
  }

  // Z1 = SecretSplCostReduceBonus
  // Secret Tally Affects Mana Consumption
  SecretSplCostReduceBonus = 0;
  int i;
  for (i = 1; i < 101; i++) { SecretSplCostReduceBonus += SecretsFound[i]; }
  if (GameSkill() == SKILL_VERY_EASY) SecretSplCostReduceBonus = SecretSplCostReduceBonus * 7 / 60; // 11.67% of the total secrets found accumulate to the percentage
  if (GameSkill() == SKILL_EASY)  SecretSplCostReduceBonus = SecretSplCostReduceBonus * 3 / 30; // 10% of the total secrets found accumulate to the percentage
  if (GameSkill() == SKILL_NORMAL) SecretSplCostReduceBonus = SecretSplCostReduceBonus * 1 / 12; // 8.33% of the total secrets found accumulate to the percentage
  if (GameSkill() == SKILL_HARD) SecretSplCostReduceBonus = SecretSplCostReduceBonus * 2 / 30; // 6.67% of the total secrets found accumulate to the percentage
  if (GameSkill() == SKILL_VERY_HARD) SecretSplCostReduceBonus = SecretSplCostReduceBonus * 3 / 60; // 5% of the total secrets found accumulate to the percentage
  SecretSplCostReduceBonus *= -1; // Inverts the number to a "cost"
  SecretSplCostReduceBonus += 100; // Then adds 100 to it for the actual percentage factor

  if (SecretSplCostReduceBonus > 100) SecretSplCostReduceBonus = 100;
  if (CharacterClass == 2 || CharacterClass == 8 || CharacterClass == 9)
  {
   if (SecretSplCostReduceBonus < 50) SecretSplCostReduceBonus = 50; // Flora, Ailish or Petra
  }
  else
  {
   if (SecretSplCostReduceBonus < 63) SecretSplCostReduceBonus = 63; // Deggaris/Illucia
  }
  FinalSpellCost = FinalSpellCost * SecretSplCostReduceBonus / 100;
  if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [CostReduceBonus]");
 

 // Check for having The Ring in you inventory
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
 {  
  if (CharacterClass == 2) FinalSpellCost = FinalSpellCost * 13 / 16; // 81.25% MP Cost (Flora is the only one who doesn't have her MP Costs increased by the One Ring)
  else FinalSpellCost = FinalSpellCost * 5 / 4; // 125% MP Cost (Deggaris and Illucia)
  if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [Ring]");
 } 
 
 int SpellCostMinimum;

 if (CharacterClass == 2)
 {
  Check1 = 0; // Check1 is an exact value
  Check2 = 100; // Check2 is a % value
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { Check1 += 10; Check2 -= 10; } // Evenstar Necklace [MP reduction of 10 + 10%]
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { Check1 += 2; Check2 -= 2; } // Anubis Cufflinks [MP reduction of 2 + 2%]
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { Check1 += 5; Check2 -= 5; } // Balrog's Ring [MP reduction of 5 + 5%]

  FinalSpellCost -= Check1;
  FinalSpellCost = FinalSpellCost * Check2 / 100;

  // Ruinous Shield = +50% MP Consumption
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) FinalSpellCost = FinalSpellCost * 3 / 2;
  if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [FloraArmors]");
 }

 if (FinalSpellCost > MaxMana) FinalSpellCost = MaxMana;
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [MaxManaClamp]");

 if (GameSkill() == SKILL_VERY_EASY) SpellCostMinimum = OriginalSpellCost * 33 / 100;
 if (GameSkill() == SKILL_EASY) SpellCostMinimum =  OriginalSpellCost * 38 / 100;
 if (GameSkill() == SKILL_NORMAL) SpellCostMinimum =  OriginalSpellCost * 43 / 100;
 if (GameSkill() == SKILL_HARD) SpellCostMinimum =  OriginalSpellCost * 49 / 100;
 if (GameSkill() == SKILL_VERY_HARD) SpellCostMinimum = OriginalSpellCost * 55 / 100;

 // Clamp Minimum Mana Cost
 if (FinalSpellCost < SpellCostMinimum) FinalSpellCost = SpellCostMinimum;
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [CostMinimumClamp]");

 int SpellCostMinimum2 = 0;
 // Clearer of Mind Perk
 if (MiscellaneousVars[10055] > 0)
 {
  SpellCostMinimum2 = (MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5);
  if (MiscellaneousVars[10055] >= 2) SpellCostMinimum2 += 1;
  if (MiscellaneousVars[10055] >= 4) SpellCostMinimum2 += 2;
  if (MiscellaneousVars[10056] >= 2) SpellCostMinimum2 += 5;
  FinalSpellCost = FinalSpellCost * (100 - SpellCostMinimum2) / 100;
  if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [ClearMindChecks]");
 }
 
 // ((Sorcery + Therapeusis) / 2) = -0.1% Final Mana Cost [circumvents Clamp]
 StatManaCostReduction = 100 - ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 20);
 if (StatManaCostReduction < 50) StatManaCostReduction = 50;
 FinalSpellCost = FinalSpellCost * StatManaCostReduction / 100;
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [SorcTherChecks]");

 // Checks Mana Cost Rate Menu Option [circumvents Clamp]
 FinalSpellCost = FinalSpellCost * GetCVar("dvds_manacostgmultiplier") / 100;
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [CostRateOption]");

 if (FinalSpellCost < 1) FinalSpellCost = 1;
 if (FinalSpellCost > MaxMana) FinalSpellCost = MaxMana;
 if (GetCVar("dvdsdebug_showspellcoststuff") == 1) PrintBold(s:"FinalSpellCost: ",d:FinalSpellCost,s:" [FinalClamps]");

 return FinalSpellCost;
}

//*******************
//*******************
//******SCRIPTS******
//*******************
//*******************

// GRAND Initialization Script
script "Initializer" OPEN
{
 int CuLv, I1, C2, I2, C3, I3;
 
 Player1TID = 1001;
 if (MiscellaneousVars[199] == 0) // Only on the very first tic of a new game, and never on loading of new maps past the first map.
 {
  Thing_ChangeTID(0,Player1TID);
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1200) { ModType = 2; } // DVII-DS "MAP00" (Set To Deus Vult II)
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1100) { ModType = 1; } // DVI-DS "MAP00" // Set To Deus Vult I
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) >= 1036 && GetLevelInfo(LEVELINFO_LEVELNUM) <= 1038) { ModType = 0; ClassicDoomType = 5; } // "MAPD6"/"MAPD7"/"MAPD8" // Set To Doom64 Mode
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1030) { ModType = 0; ClassicDoomType = 4; } // "MAPAA" // Set To Strife Mode
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1021) { ModType = 0; ClassicDoomType = 3; } // "MAP0A" // Set To Hexen Mode [Deathkings Map]
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1020) { ModType = 0; ClassicDoomType = 3; } // "MAP0A" // Set To Hexen Mode
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1010) { ModType = 0; ClassicDoomType = 2; } // "E1MA" // Set To Heretic Mode
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1000) { ModType = 0; ClassicDoomType = 1; } // "E1M0" // Set To Classic Doom 1 Mode
  else if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1050) { ModType = 0; ClassicDoomType = 0; } // "MAP00" // Set To Classic Doom 2 Mode
  else { ModType = 0; ClassicDoomType = 0; } // Set to Normal Doom 1/2 mode
  // PrintBold(d:ModType);
  LevelCap = 200; // KEEP AT THE MAXIMUM AMOUNT FOR LEVELS OVERALL [even if not all characters normally can reach said level]
  SpellIDLimit = 55;
  MaxHealthTrue = 100; // Sets to default Max of 100 to start
  MiscellaneousVars[21] = 10000; // Current Stamina Points
  MiscellaneousVars[22] = 10000; // Maximum Stamina Points

  if (GameSkill() == SKILL_VERY_EASY)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (CharacterClass == 2) // Flora cannot wield Doom-equse guns/armor, so ammo and armor is set to zero.
   {
    SetAmmoCapacity("Clip", 0);
    SetAmmoCapacity("Shell", 0);
    SetAmmoCapacity("RocketAmmo", 0);
    SetAmmoCapacity("Cell", 0);
    SetAmmoCapacity("DiarisArrow", 30);
   }
   else // Deggaris and Illucia however use guns and armor perfectly fine.
   {
    SetAmmoCapacity("Clip", 500);
    SetAmmoCapacity("Shell", 125);
    SetAmmoCapacity("RocketAmmo", 125);
    SetAmmoCapacity("Cell", 750);
    SetAmmoCapacity("DiarisArrow", 0);
   }
   SetActivator(0); // Set back to worldly activator
  }
  if (GameSkill() == SKILL_EASY)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (CharacterClass == 2) // Flora cannot wield Doom-equse guns/armor, so ammo and armor is set to zero.
   {
    SetAmmoCapacity("Clip", 0);
    SetAmmoCapacity("Shell", 0);
    SetAmmoCapacity("RocketAmmo", 0);
    SetAmmoCapacity("Cell", 0);
    SetAmmoCapacity("DiarisArrow", 27);
   }
   else // Deggaris and Illucia however use guns and armor perfectly fine.
   {
    SetAmmoCapacity("Clip", 400);
    SetAmmoCapacity("Shell", 100);
    SetAmmoCapacity("RocketAmmo", 100);
    SetAmmoCapacity("Cell", 600);
    SetAmmoCapacity("DiarisArrow", 0);
   }
   SetActivator(0); // Set back to worldly activator
  }
  if (GameSkill() == SKILL_NORMAL)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (CharacterClass == 2) // Flora cannot wield Doom-equse guns/armor, so ammo and armor is set to zero.
   {
    SetAmmoCapacity("Clip", 0);
    SetAmmoCapacity("Shell", 0);
    SetAmmoCapacity("RocketAmmo", 0);
    SetAmmoCapacity("Cell", 0);
    SetAmmoCapacity("DiarisArrow", 24);
   }
   else // Deggaris and Illucia however use guns and armor perfectly fine.
   {
    SetAmmoCapacity("Clip", 300);
    SetAmmoCapacity("Shell", 75);
    SetAmmoCapacity("RocketAmmo", 75);
    SetAmmoCapacity("Cell", 450);
    SetAmmoCapacity("DiarisArrow", 0);
   }
   SetActivator(0); // Set back to worldly activator
  }
  if (GameSkill() == SKILL_HARD)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (CharacterClass == 2) // Flora cannot wield Doom-equse guns/armor, so ammo and armor is set to zero.
   {
    SetAmmoCapacity("Clip", 0);
    SetAmmoCapacity("Shell", 0);
    SetAmmoCapacity("RocketAmmo", 0);
    SetAmmoCapacity("Cell", 0);
    SetAmmoCapacity("DiarisArrow", 21);
   }
   else // Deggaris and Illucia however use guns and armor perfectly fine.
   {
    SetAmmoCapacity("Clip", 200);
    SetAmmoCapacity("Shell", 50);
    SetAmmoCapacity("RocketAmmo", 50);
    SetAmmoCapacity("Cell", 300);
    SetAmmoCapacity("DiarisArrow", 0);
   }
   SetActivator(0); // Set back to worldly activator
  }
  if (GameSkill() == SKILL_VERY_HARD)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (CharacterClass == 2) // Flora cannot wield Doom-equse guns/armor, so ammo and armor is set to zero.
   {
    SetAmmoCapacity("Clip", 0);
    SetAmmoCapacity("Shell", 0);
    SetAmmoCapacity("RocketAmmo", 0);
    SetAmmoCapacity("Cell", 0);
    SetAmmoCapacity("DiarisArrow", 18);
   }
   else // Deggaris and Illucia however use guns and armor perfectly fine.
   {
    SetAmmoCapacity("Clip", 100);
    SetAmmoCapacity("Shell", 25);
    SetAmmoCapacity("RocketAmmo", 25);
    SetAmmoCapacity("Cell", 150);
    SetAmmoCapacity("DiarisArrow", 0);
   }
   SetActivator(0); // Set back to worldly activator
  }
  // Starting Armor

  MiscellaneousVars[197] = GetCVAR("dvds_aeonstartlvl"); // MiscellaneousVars[197] = 32;
  if (MiscellaneousVars[197] < 0) MiscellaneousVars[197] = 0;
  if (MiscellaneousVars[197] > 200) MiscellaneousVars[197] = 200;
  MiscellaneousVars[7] = 25600; // Set this for the maximum range of the randomizer for Fygg drops.
  MiscellaneousVars[6] = random(1,MiscellaneousVars[7]);
  MiscellaneousVars[199] = 1; // Very-First-Run

  BaseEXPRequirement = GetCVar("dvds_baseexprequirement"); // Default for Skill 4
  if (BaseEXPRequirement < 500) BaseEXPRequirement = 500;
  if (BaseEXPRequirement > 5600) BaseEXPRequirement = 5600;
  if (GameSkill() == SKILL_VERY_EASY)
  {
   SpecialGameFlags[10002] = 111375; // Sauravatar [DVI-DS]

   BaseEXPRequirement = BaseEXPRequirement * 7 / 10;
  }
  if (GameSkill() == SKILL_EASY)
  {
   SpecialGameFlags[10002] = 141750; // Sauravatar [DVI-DS]

   BaseEXPRequirement = BaseEXPRequirement * 4 / 5;
  }
  if (GameSkill() == SKILL_NORMAL)
  {
   SpecialGameFlags[10002] = 162000; // Sauravatar [DVI-DS]

   BaseEXPRequirement = BaseEXPRequirement * 9 / 10;
  }
  if (GameSkill() == SKILL_HARD)
  {
   SpecialGameFlags[10002] = 182250; // Sauravatar [DVI-DS]

   BaseEXPRequirement = BaseEXPRequirement;
  }
  if (GameSkill() == SKILL_VERY_HARD)
  {
   SpecialGameFlags[10002] = 212625; // Sauravatar [DVI-DS]

   BaseEXPRequirement = BaseEXPRequirement * 6 / 5;
  }
  SpecialGameFlags[10001] = SpecialGameFlags[10002];
  MaxMana += random(10,20) + C2; // 5-25 MP
  CurrentMana = MaxMana;

 }

 int BaseExtra = GetCVAR("dvds_baseexpextra");
 if (BaseExtra < 0) BaseExtra = 0;
 if (BaseExtra > 25) BaseExtra = 25;
 int BaseAccel1 = GetCVAR("dvds_baseexpaccel1");
 if (BaseAccel1 < 0) BaseAccel1 = 0;
 if (BaseAccel1 > 25) BaseAccel1 = 25;
 int BaseAccel2 = GetCVAR("dvds_baseexpaccel2");
 if (BaseAccel2 < 0) BaseAccel2 = 0;
 if (BaseAccel2 > 500) BaseAccel2 = 500;
 // Sets up the actual EXP requirement tables based from BaseEXPRequirement above.
 for (CuLv = 0; CuLv < 201; CuLv++)
 {
  if (CuLv == 0) // Level 0 to Level 1 just use the Base Requirement
  {
   ExpTable[CuLv] = I1 + BaseEXPRequirement;
                   I1 += BaseEXPRequirement;
  }
  else // Level 1+ will use the actual formula :P
  {
   ExpTable[CuLv] = I1 + ((BaseEXPRequirement * ((CuLv * BaseExtra) + 1)) * (((CuLv * BaseAccel1) + 200)) / 200) + (BaseEXPRequirement * (CuLv * BaseAccel2) / 10000);
                   I1 += ((BaseEXPRequirement * ((CuLv * BaseExtra) + 1)) * (((CuLv * BaseAccel1) + 200)) / 200) + (BaseEXPRequirement * (CuLv * BaseAccel2) / 10000);
  }
  //PrintBold(d:CuLv,s:" - ",d:ExpTable[CuLv]);
 }
 ExpTable[200] = 2147483646;
 ExpTable[201] = 2147483647;

 MiscellaneousVars[1] = 0; // Resets Armor Bitfield Checker to 0
 MiscellaneousVars[2] = 0; // Resets Level Checker to 0
 MiscellaneousVars[3] = 0; // Resets Sceptre Level Checker to 0
 MiscellaneousVars[41] = 0; // Resets Agility Checker to 0
 MiscellaneousVars[42] = 0; // Resets Defense Checker to 0
 MiscellaneousVars[43] = 0; // Resets Deftness Checker to 0
 MiscellaneousVars[44] = 0; // Resets Sorcery Checker to 0
 MiscellaneousVars[45] = 0; // Resets Strength Checker to 0
 MiscellaneousVars[46] = 0; // Resets Therapeusis Checker to 0
 MiscellaneousVars[113] = 0; // Resets Imp Claw Checker to 0
 MiscellaneousVars[114] = 0; // Resets Dark Imp Claw Checker to 0
 MiscellaneousVars[115] = 0; // Resets Cacodemon Eye Checker to 0
 MiscellaneousVars[116] = 0; // Resets Cacolantern Eye Checker to 0
 MiscellaneousVars[117] = 0; // Resets Abaddon Eye Checker to 0
 MiscellaneousVars[118] = 0; // Resets Knight Fist Checker to 0
 MiscellaneousVars[119] = 0; // Resets Baron Fist Checker to 0
 MiscellaneousVars[120] = 0; // Resets Belphegor Fist Checker to 0
 MiscellaneousVars[121] = 0; // Resets Bruiser Fist Checker to 0
 MiscellaneousVars[122] = 0; // Resets Archon Fist Checker to 0
 MiscellaneousVars[123] = 0; // Resets Pyro Fist Checker to 0
 MiscellaneousVars[124] = 0; // Resets Incarnate Skull Checker to 0
 MiscellaneousVars[125] = 0; // Resets Archvile Hand Checker to 0
 MiscellaneousVars[126] = 0; // Resets Diabloist Checker to 0
 MiscellaneousVars[127] = 0; // Resets Flying Balrog Checker to 0
 MiscellaneousVars[128] = 0; // Resets Elemental's Eye Checker to 0
 MiscellaneousVars[129] = 0; // Resets Overlord's Eye Checker to 0
 MiscellaneousVars[9801] = 0; // Resets LifeUp BitField Checker to 0
 MiscellaneousVars[9802] = 0; // Resets MagiUp BitField Checker to 0
 MiscellaneousVars[9803] = 0; // Resets StamUp BitField Checker to 0

 // PrintBold(d:CurrentArmorClass);
}

script "playerfreeze" (int type)
{
 SetPlayerProperty(1,type,PROP_TOTALLYFROZEN);
 SetUserArray(Player1TID,"user_PlayerDVDSSpecial",9,1); // Prevents Dashing
}

script "DebugNumberedVars" (void)
{
 PrintBold(
         s:"1:Experience - ",d:Experience,
         s:"\n2:CurrentMana - ",d:CurrentMana,
         s:"\n3:MaxMana - ",d:MaxMana,
         s:"\n4:PlayerLevel - ",d:PlayerLevel,
         s:"\n5:SelectedSpell - ",d:SelectedSpell,
         s:"\n",
         s:"\n8:MaxHealthTrue - ",d:MaxHealthTrue,
         s:"\n",
         s:"\n11:BaseEXPRequirement - ",d:BaseEXPRequirement,
         s:"\n12:ModType - ",d:ModType,
         s:"\n",
         s:"\n19:HellcoreOverheatLevel - ",d:HellcoreOverheatLevel, 
         s:"\n20:HellcorePercentFull - ",d:HellcorePercentFull, 
         s:"\n",
         s:"\n29:HPInterpolationDisplay - ",d:HPInterpolationDisplay, 
         s:"\n30:CurrentMaxArmor - ",d:CurrentMaxArmor, 
         s:"\n31:CurrentArmorClass - ",d:CurrentArmorClass, 
         s:"\n",
         s:"\n33:CharacterClass - ",d:CharacterClass, 
         s:"\n34:ClassCheck - ",d:ClassCheck, 
         s:"\n",
         s:"\n36:SurvivalWhole - ",d:SurvivalWhole, 
         s:"\n37:LevelCap - ",d:LevelCap, 
         s:"\n38:SpellIDLimit - ",d:SpellIDLimit, 
         s:"\n",
         s:"\n42:StaminaPercent - ",d:StaminaPercent, 
         s:"\n43:SavePercent - ",d:SavePercent, 
         s:"\n",
         s:"\n45:EvadeWhole - ",d:EvadeWhole, 
         s:"\n46:ClassicDoomType - ",d:ClassicDoomType, 
         s:"\nInternal Map#: ",d:GetLevelInfo(LEVELINFO_LEVELNUM),
         s:"\n54:SceptreLevelEXP - ",d:SceptreLevelEXP, 
         s:"\n55:SceptreActualLevel - ",d:SceptreActualLevel, 
         s:"\n",
         s:"\n61:RuinousShieldPercentF - ",d:RuinousShieldPercentF, 
         s:"\n62:RuinousShieldPercent - ",d:RuinousShieldPercent, 
         s:"\n63:FloraArmorClass - ",d:FloraArmorClass
		 );
}

script "CheckTID" (int TID)
{
 int Amount;
 int Amount2;
 int Amount3;
 int Amount4;
 int Total;
 if (TID == Player1TID) // Player's Main TID
 {
  Amount = ThingCount(T_NONE, TID);
  Amount2 = ThingCountName("DeggarisMontegger", TID);
  Amount3 = ThingCountName("IlluciaHenderShot", TID);
  Amount4 = ThingCountName("FloraBriscoletti", TID);
  Total = Amount - (Amount2 + Amount3 + Amount4);
  if (Total == 0)
  {
   PrintBold(
             s:"\c[Green]",
			 d:TID,s:" [Total]: ",d:Total,s:"\n\n",

			 d:TID,s:" [general]: ",d:Amount,s:"\n\n",

             d:TID,s:" [Deggaris]: ",d:Amount2,s:"\n",
             d:TID,s:" [Illucia]: ",d:Amount3,s:"\n",
             d:TID,s:" [Flora]: ",d:Amount4,s:"\n"
            );
  }
  else
  {
   PrintBold(
             s:"\c[DarkRed]",
			 d:TID,s:" [Total]: ",d:Total,s:"\n\n",

			 d:TID,s:" [general]: ",d:Amount,s:"\n\n",

             d:TID,s:" [Deggaris]: ",d:Amount2,s:"\n",
             d:TID,s:" [Illucia]: ",d:Amount3,s:"\n",
             d:TID,s:" [Flora]: ",d:Amount4,s:"\n"
            );
  }
 }
 else
 {
  Amount = ThingCount(T_NONE, TID);
  PrintBold(d:TID,s:": ",d:Amount);
 }
}

function void PrintBuffMessage (int buffid)
{
/*
	  if (MiscellaneousVars[2045] == 0) buffmsg1 = "\c[red]ATTACK INCREASED!!";
	  if (MiscellaneousVars[2045] == 1) buffmsg1 = "\c[olive]DEFENSE INCREASED!!";
	  if (MiscellaneousVars[2045] == 2) buffmsg1 = "\c[lightblue]SPEED INCREASED!!";
	  if (MiscellaneousVars[2045] == 10) buffmsg1 = "\c[red]ATTACK DECREASED!!";
	  if (MiscellaneousVars[2045] == 11) buffmsg1 = "\c[olive]DEFENSE DECREASED!!";
	  if (MiscellaneousVars[2045] == 12) buffmsg1 = "\c[lightblue]SPEED DECREASED!!";
	  if (MiscellaneousVars[2045] == 13) buffmsg1 = "\c[darkgreen]POISONED!!";
	  if (MiscellaneousVars[2045] == 14) buffmsg1 = "\c[purple]BLINDED!!";
	  if (MiscellaneousVars[2045] == 15) buffmsg1 = "\c[cream]ASLEEP!!";
	  if (MiscellaneousVars[2045] == 16) buffmsg1 = "\c[green]SPELLS SEALED!!";
	  if (MiscellaneousVars[2045] == 17) buffmsg1 = "\c[brick]YOU'RE EXHAUSTED!!";
*/
 if (buffid == 10) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 0; } // Oomph
 if (buffid == 11) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 1; } // Buff
 if (buffid == 12) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 2; } // Acceleratle
 if (buffid == 13) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 10; } // Blunt
 if (buffid == 14) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 11; } // Sap
 if (buffid == 15) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 12; } // Deceleratle
 if (buffid == 16) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 13; } // Poison
 if (buffid == 17) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 18; } // Corrosion
 if (buffid == 18) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 17; } // Fatigue
 if (buffid == 19) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 14; } // Blind
 if (buffid == 20) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 15; } // Sleep
 if (buffid == 21) { MiscellaneousVars[2040] = 70; MiscellaneousVars[2045] = 16; } // Silence
}

script "BuffTimer" (int type, int buffid, int time)
{
 if (type == 0) // List
 {
  Print(s:"",
        s:"0 = Night Vision\n",
        s:"1 = Invisibility\n",
        s:"2 = Flight\n",
        s:"3 = Stealth\n",
        s:"4 = Invulnerability\n",
        s:"5 = Time Freeze\n",
        s:"6 = Fear Aura\n",
        s:"7 = Divine Avatar\n",
        s:"8 = Spreader Aura Lv. 1\n",
        s:"9 = Spreader Aura Lv. 2\n",
       s:"10 = Oomph\n",
       s:"11 = Buff\n",
       s:"12 = Acceleratle\n",
       s:"13 = Blunt\n",
       s:"14 = Sap\n",
       s:"15 = Deceleratle\n",
       s:"16 = Poison\n",
       s:"17 = Corrosion\n",
       s:"18 = Fatigue\n",
       s:"19 = Blind\n",
       s:"20 = Sleep\n",
       s:"21 = Silence\n",
       s:"22 = BioShield\n",
       s:"23 = Berserk\n",
       s:"\n",
       s:"129 = ??????\n");
 }
 int debuffsound = 0;
 if (buffid == 13 || buffid == 14 || buffid == 15 ) { debuffsound = 1; }
 if (type == 1) // Set timer [ignore all conditions like Buddha/God-Mode]
 {
  PowerupTimer[buffid] = time * 35;
  if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
  PrintBuffMessage(buffid);
 }
 if (type == 2) // Add/Subtract timer [ignore all conditions like Buddha/God-Mode]
 {
  PowerupTimer[buffid] += (time * 35);
  if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
  PrintBuffMessage(buffid);
 }
 if (type == 3) // Set timer [in tics] [ignore all conditions like Buddha/God-Mode]
 {
  PowerupTimer[buffid] = time;
  if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
  PrintBuffMessage(buffid);
 }
 if (type == 4) // Add/Subtract timer in tics] [ignore all conditions like Buddha/God-Mode]
 {
  PowerupTimer[buffid] += time;
  if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
  PrintBuffMessage(buffid);
 }

 int ignorecommand = 0;
 if (MiscellaneousVars[195] > 0) ignorecommand++; // If in mercy invincibility, no effect
 if (CheckActorInventory(Player1TID,"InvulnerabilitySpell") > 0) ignorecommand++; // if invulnerable, no effect
 if (GetActorProperty(Player1TID,APROP_INVULNERABLE) > 0) ignorecommand++; // if invulnerable, no effect
 if (ignorecommand == 0)
 { 
  if (type == 5) // Set timer [do NOT ignore conditions like Buddha/God-Mode]
  {
   PowerupTimer[buffid] = time * 35;
   if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
   PrintBuffMessage(buffid);
  }
  if (type == 6) // Add/Subtract timer [do NOT ignore conditions like Buddha/God-Mode]
  {
   PowerupTimer[buffid] += (time * 35);
   if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
   PrintBuffMessage(buffid);
  }
  if (type == 7) // Set timer [in tics] [do NOT ignore conditions like Buddha/God-Mode]
  {
   PowerupTimer[buffid] = time;
   if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
   PrintBuffMessage(buffid);
  }
  if (type == 8) // Add/Subtract timer in tics] [do NOT ignore conditions like Buddha/God-Mode]
  {
   PowerupTimer[buffid] += time;
   if (debuffsound == 1) { SetActivator(Player1TID); ActivatorSound("debuffed",127); SetActivator(0); }
   PrintBuffMessage(buffid);
  }
  if (GetCVar("dvdsdebug_showmiscdmginformation") > 0) 
  {
   if (type == 1 || type == 2 || type == 5 || type == 6)
   {
    PrintBold(s:"Time Added [Seconds]: ",d:time,
	          s:"\nBuff/Debuff Type: ",d:buffid);
   }
   if (type == 3 || type == 4 || type == 7 || type == 8)
   {
    PrintBold(s:"Time Added [Tics]: ",d:time,
	          s:"\nBuff/Debuff Type: ",d:buffid);
   }
  }
 }
 if (PowerupTimer[buffid] < 0) PowerupTimer[buffid] = 0;
 if (PowerupTimer[buffid] > 99999999) PowerupTimer[buffid] = 99999999;
}

script "StatCheck" (int type)
{
 if (type == 1) SetResultValue(MaxHealthTrue); // Max HP
 if (type == 2) SetResultValue(MaxMana); // Max MP
 if (type == 3) SetResultValue(MiscellaneousVars[31]); // Agility
 if (type == 4) SetResultValue(MiscellaneousVars[32]); // Defense
 if (type == 5) SetResultValue(MiscellaneousVars[33]); // Deftness
 if (type == 6) SetResultValue(MiscellaneousVars[34]); // Sorcery
 if (type == 7) SetResultValue(MiscellaneousVars[35]); // Strength
 if (type == 8) SetResultValue(MiscellaneousVars[36]); // Therapeusis
 if (type == 9) SetResultValue(MiscellaneousVars[200]); // Jumping
 if (type == 10) SetResultValue(MiscellaneousVars[201]); // Balance/Mass
 if (type == 11) SetResultValue(MiscellaneousVars[25]); // Aeon Points
}

// Prints out or edits a number for "MenuSystemVars[#]" vars.
script "MSV" (int index, int type, int value)
{
 int oldvalue = 0;
 int newvalue = 0;

 int printidx0, printidx1, printidx2, printidx3, printidx4, printidx5, printidx6, printidx7, printidx8, printidx9;
 int printidx10, printidx11, printidx12, printidx13, printidx14, printidx15, printidx16, printidx17, printidx18, printidx19;
 int printidx20, printidx21, printidx22, printidx23, printidx24, printidx25, printidx26, printidx27, printidx28, printidx29;
 int printidx30, printidx31, printidx32, printidx33, printidx34, printidx35, printidx36, printidx37, printidx38, printidx39;

 if (index >= 0)
 {
  oldvalue = MenuSystemVars[index];
  if (type == 1) MenuSystemVars[index] += value; // adds to the value
  if (type == 2) MenuSystemVars[index] = value; // sets the value
  newvalue = MenuSystemVars[index];
  if (type == 0)
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nValue: ",f:newvalue);
  }
  else
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nOldValue: ",f:oldvalue,
             s:"\nNewValue: ",f:newvalue);
  }
 }
 else
 {
  // Prints the entire list [although you'll need to read into the console to see all the values, as it only shows 40 at a time, and only the last forty will show on your screen :P]
  printidx0 = 0; printidx1 = 1; printidx2 = 2; printidx3 = 3; printidx4 = 4; printidx5 = 5; printidx6 = 6; 
  printidx7 = 10001; printidx8 = 10002; printidx9 = 10003; printidx10 = 10004; printidx11 = 10005; printidx12 = 10006; 
  // 0 - 12
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MenuSystemVars[printidx0],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MenuSystemVars[printidx1],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MenuSystemVars[printidx2],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MenuSystemVars[printidx3],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MenuSystemVars[printidx4],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MenuSystemVars[printidx5],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MenuSystemVars[printidx6],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MenuSystemVars[printidx7],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MenuSystemVars[printidx8],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MenuSystemVars[printidx9],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MenuSystemVars[printidx10],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MenuSystemVars[printidx11],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MenuSystemVars[printidx12]
           );
 }
}

// Prints out or edits a fixed number for "MiscFixedVars[#]" vars.
script "MFV" (int index, int type, int value)
{
 int oldvalue = 0.0;
 int newvalue = 0.0;

 int printidx0, printidx1, printidx2, printidx3, printidx4, printidx5, printidx6, printidx7, printidx8, printidx9;
 int printidx10, printidx11, printidx12, printidx13, printidx14, printidx15, printidx16, printidx17, printidx18, printidx19;
 int printidx20, printidx21, printidx22, printidx23, printidx24, printidx25, printidx26, printidx27, printidx28, printidx29;
 int printidx30, printidx31, printidx32, printidx33, printidx34, printidx35, printidx36, printidx37, printidx38, printidx39;

 if (index >= 0)
 {
  value *= 1.0;
  oldvalue = MiscFixedVars[index];
  if (type == 1) MiscFixedVars[index] += value; // adds to the value
  if (type == 2) MiscFixedVars[index] = value; // sets the value
  newvalue = MiscFixedVars[index];
  if (type == 0)
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nValue: ",f:newvalue);
  }
  else
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nOldValue: ",f:oldvalue,
             s:"\nNewValue: ",f:newvalue);
  }
 }
}

// Prints out or edits a fixed number for "DVDSSpecialArrayValue[#]" vars.
script "DVSV" (int index, int type, int value)
{
 int oldvalue;
 int newvalue;

 if (index >= 0)
 {
  oldvalue = DVDSSpecialArrayValue[index];
  newvalue = DVDSSpecialArrayValue[index];
  if (type == 0)
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nValue: ",d:newvalue);
  }
  else
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nOldValue: ",d:oldvalue,
             s:"\nNewValue: ",d:newvalue);
  }
  if (type == 1) 
  { 
   DVDSSpecialArrayValue[index] = value; // sets the value
   SetUserArray(Player1TID,"user_PlayerDVDSSpecial",index,value);
  }
 }
}

// Prints out the EXP Level tables for the player.
script "EXPLevelTable" (int index, int type, int value)
{
 int oldvalue;
 int newvalue;

 int printidx0, printidx1, printidx2, printidx3, printidx4, printidx5, printidx6, printidx7, printidx8, printidx9;
 int printidx10, printidx11, printidx12, printidx13, printidx14, printidx15, printidx16, printidx17, printidx18, printidx19;
 int printidx20, printidx21, printidx22, printidx23, printidx24, printidx25, printidx26, printidx27, printidx28, printidx29;
 int printidx30, printidx31, printidx32, printidx33, printidx34, printidx35, printidx36, printidx37, printidx38, printidx39;

  // Prints the entire list [although you'll need to read into the console to see all the values, as it only shows 40 at a time, and only the last forty will show on your screen :P]
  printidx0 = 0; printidx1 = 1; printidx2 = 2; printidx3 = 3; printidx4 = 4; printidx5 = 5; printidx6 = 6; printidx7 = 7; printidx8 = 8; printidx9 = 9;
  printidx10 = 10; printidx11 = 11; printidx12 = 12; printidx13 = 13; printidx14 = 14; printidx15 = 15; printidx16 = 16; printidx17 = 17; printidx18 = 18; printidx19 = 19;
  printidx20 = 20; printidx21 = 21; printidx22 = 22; printidx23 = 23; printidx24 = 24; printidx25 = 25; printidx26 = 26; printidx27 = 27; printidx28 = 28; printidx29 = 29;
  printidx30 = 30; printidx31 = 31; printidx32 = 32; printidx33 = 33; printidx34 = 34; printidx35 = 35; printidx36 = 36; printidx37 = 37; printidx38 = 38; printidx39 = 39;
  // 0 - 39
  PrintBold(
              s:"\cf Level[\cn",d:printidx0,s:"\cf]: \cd",d:ExpTable[printidx0],s:"\cf     Level[\cn",d:printidx20,s:"\cf]: \cd",d:ExpTable[printidx20],
            s:"\n\cf Level[\cn",d:printidx1,s:"\cf]: \cd",d:ExpTable[printidx1],s:"\cf     Level[\cn",d:printidx21,s:"\cf]: \cd",d:ExpTable[printidx21],
            s:"\n\cf Level[\cn",d:printidx2,s:"\cf]: \cd",d:ExpTable[printidx2],s:"\cf     Level[\cn",d:printidx22,s:"\cf]: \cd",d:ExpTable[printidx22],
            s:"\n\cf Level[\cn",d:printidx3,s:"\cf]: \cd",d:ExpTable[printidx3],s:"\cf     Level[\cn",d:printidx23,s:"\cf]: \cd",d:ExpTable[printidx23],
            s:"\n\cf Level[\cn",d:printidx4,s:"\cf]: \cd",d:ExpTable[printidx4],s:"\cf     Level[\cn",d:printidx24,s:"\cf]: \cd",d:ExpTable[printidx24],
            s:"\n\cf Level[\cn",d:printidx5,s:"\cf]: \cd",d:ExpTable[printidx5],s:"\cf     Level[\cn",d:printidx25,s:"\cf]: \cd",d:ExpTable[printidx25],
            s:"\n\cf Level[\cn",d:printidx6,s:"\cf]: \cd",d:ExpTable[printidx6],s:"\cf     Level[\cn",d:printidx26,s:"\cf]: \cd",d:ExpTable[printidx26],
            s:"\n\cf Level[\cn",d:printidx7,s:"\cf]: \cd",d:ExpTable[printidx7],s:"\cf     Level[\cn",d:printidx27,s:"\cf]: \cd",d:ExpTable[printidx27],
            s:"\n\cf Level[\cn",d:printidx8,s:"\cf]: \cd",d:ExpTable[printidx8],s:"\cf     Level[\cn",d:printidx28,s:"\cf]: \cd",d:ExpTable[printidx28],
            s:"\n\cf Level[\cn",d:printidx9,s:"\cf]: \cd",d:ExpTable[printidx9],s:"\cf     Level[\cn",d:printidx29,s:"\cf]: \cd",d:ExpTable[printidx29],
            s:"\n\cf Level[\cn",d:printidx10,s:"\cf]: \cd",d:ExpTable[printidx10],s:"\cf     Level[\cn",d:printidx30,s:"\cf]: \cd",d:ExpTable[printidx30],
            s:"\n\cf Level[\cn",d:printidx11,s:"\cf]: \cd",d:ExpTable[printidx11],s:"\cf     Level[\cn",d:printidx31,s:"\cf]: \cd",d:ExpTable[printidx31],
            s:"\n\cf Level[\cn",d:printidx12,s:"\cf]: \cd",d:ExpTable[printidx12],s:"\cf     Level[\cn",d:printidx32,s:"\cf]: \cd",d:ExpTable[printidx32],
            s:"\n\cf Level[\cn",d:printidx13,s:"\cf]: \cd",d:ExpTable[printidx13],s:"\cf     Level[\cn",d:printidx33,s:"\cf]: \cd",d:ExpTable[printidx33],
            s:"\n\cf Level[\cn",d:printidx14,s:"\cf]: \cd",d:ExpTable[printidx14],s:"\cf     Level[\cn",d:printidx34,s:"\cf]: \cd",d:ExpTable[printidx34],
            s:"\n\cf Level[\cn",d:printidx15,s:"\cf]: \cd",d:ExpTable[printidx15],s:"\cf     Level[\cn",d:printidx35,s:"\cf]: \cd",d:ExpTable[printidx35],
            s:"\n\cf Level[\cn",d:printidx16,s:"\cf]: \cd",d:ExpTable[printidx16],s:"\cf     Level[\cn",d:printidx36,s:"\cf]: \cd",d:ExpTable[printidx36],
            s:"\n\cf Level[\cn",d:printidx17,s:"\cf]: \cd",d:ExpTable[printidx17],s:"\cf     Level[\cn",d:printidx37,s:"\cf]: \cd",d:ExpTable[printidx37],
            s:"\n\cf Level[\cn",d:printidx18,s:"\cf]: \cd",d:ExpTable[printidx18],s:"\cf     Level[\cn",d:printidx38,s:"\cf]: \cd",d:ExpTable[printidx38],
            s:"\n\cf Level[\cn",d:printidx19,s:"\cf]: \cd",d:ExpTable[printidx19],s:"\cf     Level[\cn",d:printidx39,s:"\cf]: \cd",d:ExpTable[printidx39]
           );

  // 40 - 79
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Level[\cn",d:printidx0,s:"\cf]: \cd",d:ExpTable[printidx0],s:"\cf     Level[\cn",d:printidx20,s:"\cf]: \cd",d:ExpTable[printidx20],
            s:"\n\cf Level[\cn",d:printidx1,s:"\cf]: \cd",d:ExpTable[printidx1],s:"\cf     Level[\cn",d:printidx21,s:"\cf]: \cd",d:ExpTable[printidx21],
            s:"\n\cf Level[\cn",d:printidx2,s:"\cf]: \cd",d:ExpTable[printidx2],s:"\cf     Level[\cn",d:printidx22,s:"\cf]: \cd",d:ExpTable[printidx22],
            s:"\n\cf Level[\cn",d:printidx3,s:"\cf]: \cd",d:ExpTable[printidx3],s:"\cf     Level[\cn",d:printidx23,s:"\cf]: \cd",d:ExpTable[printidx23],
            s:"\n\cf Level[\cn",d:printidx4,s:"\cf]: \cd",d:ExpTable[printidx4],s:"\cf     Level[\cn",d:printidx24,s:"\cf]: \cd",d:ExpTable[printidx24],
            s:"\n\cf Level[\cn",d:printidx5,s:"\cf]: \cd",d:ExpTable[printidx5],s:"\cf     Level[\cn",d:printidx25,s:"\cf]: \cd",d:ExpTable[printidx25],
            s:"\n\cf Level[\cn",d:printidx6,s:"\cf]: \cd",d:ExpTable[printidx6],s:"\cf     Level[\cn",d:printidx26,s:"\cf]: \cd",d:ExpTable[printidx26],
            s:"\n\cf Level[\cn",d:printidx7,s:"\cf]: \cd",d:ExpTable[printidx7],s:"\cf     Level[\cn",d:printidx27,s:"\cf]: \cd",d:ExpTable[printidx27],
            s:"\n\cf Level[\cn",d:printidx8,s:"\cf]: \cd",d:ExpTable[printidx8],s:"\cf     Level[\cn",d:printidx28,s:"\cf]: \cd",d:ExpTable[printidx28],
            s:"\n\cf Level[\cn",d:printidx9,s:"\cf]: \cd",d:ExpTable[printidx9],s:"\cf     Level[\cn",d:printidx29,s:"\cf]: \cd",d:ExpTable[printidx29],
            s:"\n\cf Level[\cn",d:printidx10,s:"\cf]: \cd",d:ExpTable[printidx10],s:"\cf     Level[\cn",d:printidx30,s:"\cf]: \cd",d:ExpTable[printidx30],
            s:"\n\cf Level[\cn",d:printidx11,s:"\cf]: \cd",d:ExpTable[printidx11],s:"\cf     Level[\cn",d:printidx31,s:"\cf]: \cd",d:ExpTable[printidx31],
            s:"\n\cf Level[\cn",d:printidx12,s:"\cf]: \cd",d:ExpTable[printidx12],s:"\cf     Level[\cn",d:printidx32,s:"\cf]: \cd",d:ExpTable[printidx32],
            s:"\n\cf Level[\cn",d:printidx13,s:"\cf]: \cd",d:ExpTable[printidx13],s:"\cf     Level[\cn",d:printidx33,s:"\cf]: \cd",d:ExpTable[printidx33],
            s:"\n\cf Level[\cn",d:printidx14,s:"\cf]: \cd",d:ExpTable[printidx14],s:"\cf     Level[\cn",d:printidx34,s:"\cf]: \cd",d:ExpTable[printidx34],
            s:"\n\cf Level[\cn",d:printidx15,s:"\cf]: \cd",d:ExpTable[printidx15],s:"\cf     Level[\cn",d:printidx35,s:"\cf]: \cd",d:ExpTable[printidx35],
            s:"\n\cf Level[\cn",d:printidx16,s:"\cf]: \cd",d:ExpTable[printidx16],s:"\cf     Level[\cn",d:printidx36,s:"\cf]: \cd",d:ExpTable[printidx36],
            s:"\n\cf Level[\cn",d:printidx17,s:"\cf]: \cd",d:ExpTable[printidx17],s:"\cf     Level[\cn",d:printidx37,s:"\cf]: \cd",d:ExpTable[printidx37],
            s:"\n\cf Level[\cn",d:printidx18,s:"\cf]: \cd",d:ExpTable[printidx18],s:"\cf     Level[\cn",d:printidx38,s:"\cf]: \cd",d:ExpTable[printidx38],
            s:"\n\cf Level[\cn",d:printidx19,s:"\cf]: \cd",d:ExpTable[printidx19],s:"\cf     Level[\cn",d:printidx39,s:"\cf]: \cd",d:ExpTable[printidx39]
           );

  // 80 - 119
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Level[\cn",d:printidx0,s:"\cf]: \cd",d:ExpTable[printidx0],s:"\cf     Level[\cn",d:printidx20,s:"\cf]: \cd",d:ExpTable[printidx20],
            s:"\n\cf Level[\cn",d:printidx1,s:"\cf]: \cd",d:ExpTable[printidx1],s:"\cf     Level[\cn",d:printidx21,s:"\cf]: \cd",d:ExpTable[printidx21],
            s:"\n\cf Level[\cn",d:printidx2,s:"\cf]: \cd",d:ExpTable[printidx2],s:"\cf     Level[\cn",d:printidx22,s:"\cf]: \cd",d:ExpTable[printidx22],
            s:"\n\cf Level[\cn",d:printidx3,s:"\cf]: \cd",d:ExpTable[printidx3],s:"\cf     Level[\cn",d:printidx23,s:"\cf]: \cd",d:ExpTable[printidx23],
            s:"\n\cf Level[\cn",d:printidx4,s:"\cf]: \cd",d:ExpTable[printidx4],s:"\cf     Level[\cn",d:printidx24,s:"\cf]: \cd",d:ExpTable[printidx24],
            s:"\n\cf Level[\cn",d:printidx5,s:"\cf]: \cd",d:ExpTable[printidx5],s:"\cf     Level[\cn",d:printidx25,s:"\cf]: \cd",d:ExpTable[printidx25],
            s:"\n\cf Level[\cn",d:printidx6,s:"\cf]: \cd",d:ExpTable[printidx6],s:"\cf     Level[\cn",d:printidx26,s:"\cf]: \cd",d:ExpTable[printidx26],
            s:"\n\cf Level[\cn",d:printidx7,s:"\cf]: \cd",d:ExpTable[printidx7],s:"\cf     Level[\cn",d:printidx27,s:"\cf]: \cd",d:ExpTable[printidx27],
            s:"\n\cf Level[\cn",d:printidx8,s:"\cf]: \cd",d:ExpTable[printidx8],s:"\cf     Level[\cn",d:printidx28,s:"\cf]: \cd",d:ExpTable[printidx28],
            s:"\n\cf Level[\cn",d:printidx9,s:"\cf]: \cd",d:ExpTable[printidx9],s:"\cf     Level[\cn",d:printidx29,s:"\cf]: \cd",d:ExpTable[printidx29],
            s:"\n\cf Level[\cn",d:printidx10,s:"\cf]: \cd",d:ExpTable[printidx10],s:"\cf     Level[\cn",d:printidx30,s:"\cf]: \cd",d:ExpTable[printidx30],
            s:"\n\cf Level[\cn",d:printidx11,s:"\cf]: \cd",d:ExpTable[printidx11],s:"\cf     Level[\cn",d:printidx31,s:"\cf]: \cd",d:ExpTable[printidx31],
            s:"\n\cf Level[\cn",d:printidx12,s:"\cf]: \cd",d:ExpTable[printidx12],s:"\cf     Level[\cn",d:printidx32,s:"\cf]: \cd",d:ExpTable[printidx32],
            s:"\n\cf Level[\cn",d:printidx13,s:"\cf]: \cd",d:ExpTable[printidx13],s:"\cf     Level[\cn",d:printidx33,s:"\cf]: \cd",d:ExpTable[printidx33],
            s:"\n\cf Level[\cn",d:printidx14,s:"\cf]: \cd",d:ExpTable[printidx14],s:"\cf     Level[\cn",d:printidx34,s:"\cf]: \cd",d:ExpTable[printidx34],
            s:"\n\cf Level[\cn",d:printidx15,s:"\cf]: \cd",d:ExpTable[printidx15],s:"\cf     Level[\cn",d:printidx35,s:"\cf]: \cd",d:ExpTable[printidx35],
            s:"\n\cf Level[\cn",d:printidx16,s:"\cf]: \cd",d:ExpTable[printidx16],s:"\cf     Level[\cn",d:printidx36,s:"\cf]: \cd",d:ExpTable[printidx36],
            s:"\n\cf Level[\cn",d:printidx17,s:"\cf]: \cd",d:ExpTable[printidx17],s:"\cf     Level[\cn",d:printidx37,s:"\cf]: \cd",d:ExpTable[printidx37],
            s:"\n\cf Level[\cn",d:printidx18,s:"\cf]: \cd",d:ExpTable[printidx18],s:"\cf     Level[\cn",d:printidx38,s:"\cf]: \cd",d:ExpTable[printidx38],
            s:"\n\cf Level[\cn",d:printidx19,s:"\cf]: \cd",d:ExpTable[printidx19],s:"\cf     Level[\cn",d:printidx39,s:"\cf]: \cd",d:ExpTable[printidx39]
           );

  // 120 - 159
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Level[\cn",d:printidx0,s:"\cf]: \cd",d:ExpTable[printidx0],s:"\cf     Level[\cn",d:printidx20,s:"\cf]: \cd",d:ExpTable[printidx20],
            s:"\n\cf Level[\cn",d:printidx1,s:"\cf]: \cd",d:ExpTable[printidx1],s:"\cf     Level[\cn",d:printidx21,s:"\cf]: \cd",d:ExpTable[printidx21],
            s:"\n\cf Level[\cn",d:printidx2,s:"\cf]: \cd",d:ExpTable[printidx2],s:"\cf     Level[\cn",d:printidx22,s:"\cf]: \cd",d:ExpTable[printidx22],
            s:"\n\cf Level[\cn",d:printidx3,s:"\cf]: \cd",d:ExpTable[printidx3],s:"\cf     Level[\cn",d:printidx23,s:"\cf]: \cd",d:ExpTable[printidx23],
            s:"\n\cf Level[\cn",d:printidx4,s:"\cf]: \cd",d:ExpTable[printidx4],s:"\cf     Level[\cn",d:printidx24,s:"\cf]: \cd",d:ExpTable[printidx24],
            s:"\n\cf Level[\cn",d:printidx5,s:"\cf]: \cd",d:ExpTable[printidx5],s:"\cf     Level[\cn",d:printidx25,s:"\cf]: \cd",d:ExpTable[printidx25],
            s:"\n\cf Level[\cn",d:printidx6,s:"\cf]: \cd",d:ExpTable[printidx6],s:"\cf     Level[\cn",d:printidx26,s:"\cf]: \cd",d:ExpTable[printidx26],
            s:"\n\cf Level[\cn",d:printidx7,s:"\cf]: \cd",d:ExpTable[printidx7],s:"\cf     Level[\cn",d:printidx27,s:"\cf]: \cd",d:ExpTable[printidx27],
            s:"\n\cf Level[\cn",d:printidx8,s:"\cf]: \cd",d:ExpTable[printidx8],s:"\cf     Level[\cn",d:printidx28,s:"\cf]: \cd",d:ExpTable[printidx28],
            s:"\n\cf Level[\cn",d:printidx9,s:"\cf]: \cd",d:ExpTable[printidx9],s:"\cf     Level[\cn",d:printidx29,s:"\cf]: \cd",d:ExpTable[printidx29],
            s:"\n\cf Level[\cn",d:printidx10,s:"\cf]: \cd",d:ExpTable[printidx10],s:"\cf     Level[\cn",d:printidx30,s:"\cf]: \cd",d:ExpTable[printidx30],
            s:"\n\cf Level[\cn",d:printidx11,s:"\cf]: \cd",d:ExpTable[printidx11],s:"\cf     Level[\cn",d:printidx31,s:"\cf]: \cd",d:ExpTable[printidx31],
            s:"\n\cf Level[\cn",d:printidx12,s:"\cf]: \cd",d:ExpTable[printidx12],s:"\cf     Level[\cn",d:printidx32,s:"\cf]: \cd",d:ExpTable[printidx32],
            s:"\n\cf Level[\cn",d:printidx13,s:"\cf]: \cd",d:ExpTable[printidx13],s:"\cf     Level[\cn",d:printidx33,s:"\cf]: \cd",d:ExpTable[printidx33],
            s:"\n\cf Level[\cn",d:printidx14,s:"\cf]: \cd",d:ExpTable[printidx14],s:"\cf     Level[\cn",d:printidx34,s:"\cf]: \cd",d:ExpTable[printidx34],
            s:"\n\cf Level[\cn",d:printidx15,s:"\cf]: \cd",d:ExpTable[printidx15],s:"\cf     Level[\cn",d:printidx35,s:"\cf]: \cd",d:ExpTable[printidx35],
            s:"\n\cf Level[\cn",d:printidx16,s:"\cf]: \cd",d:ExpTable[printidx16],s:"\cf     Level[\cn",d:printidx36,s:"\cf]: \cd",d:ExpTable[printidx36],
            s:"\n\cf Level[\cn",d:printidx17,s:"\cf]: \cd",d:ExpTable[printidx17],s:"\cf     Level[\cn",d:printidx37,s:"\cf]: \cd",d:ExpTable[printidx37],
            s:"\n\cf Level[\cn",d:printidx18,s:"\cf]: \cd",d:ExpTable[printidx18],s:"\cf     Level[\cn",d:printidx38,s:"\cf]: \cd",d:ExpTable[printidx38],
            s:"\n\cf Level[\cn",d:printidx19,s:"\cf]: \cd",d:ExpTable[printidx19],s:"\cf     Level[\cn",d:printidx39,s:"\cf]: \cd",d:ExpTable[printidx39]
           );

  // 160 - 199
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Level[\cn",d:printidx0,s:"\cf]: \cd",d:ExpTable[printidx0],s:"\cf     Level[\cn",d:printidx20,s:"\cf]: \cd",d:ExpTable[printidx20],
            s:"\n\cf Level[\cn",d:printidx1,s:"\cf]: \cd",d:ExpTable[printidx1],s:"\cf     Level[\cn",d:printidx21,s:"\cf]: \cd",d:ExpTable[printidx21],
            s:"\n\cf Level[\cn",d:printidx2,s:"\cf]: \cd",d:ExpTable[printidx2],s:"\cf     Level[\cn",d:printidx22,s:"\cf]: \cd",d:ExpTable[printidx22],
            s:"\n\cf Level[\cn",d:printidx3,s:"\cf]: \cd",d:ExpTable[printidx3],s:"\cf     Level[\cn",d:printidx23,s:"\cf]: \cd",d:ExpTable[printidx23],
            s:"\n\cf Level[\cn",d:printidx4,s:"\cf]: \cd",d:ExpTable[printidx4],s:"\cf     Level[\cn",d:printidx24,s:"\cf]: \cd",d:ExpTable[printidx24],
            s:"\n\cf Level[\cn",d:printidx5,s:"\cf]: \cd",d:ExpTable[printidx5],s:"\cf     Level[\cn",d:printidx25,s:"\cf]: \cd",d:ExpTable[printidx25],
            s:"\n\cf Level[\cn",d:printidx6,s:"\cf]: \cd",d:ExpTable[printidx6],s:"\cf     Level[\cn",d:printidx26,s:"\cf]: \cd",d:ExpTable[printidx26],
            s:"\n\cf Level[\cn",d:printidx7,s:"\cf]: \cd",d:ExpTable[printidx7],s:"\cf     Level[\cn",d:printidx27,s:"\cf]: \cd",d:ExpTable[printidx27],
            s:"\n\cf Level[\cn",d:printidx8,s:"\cf]: \cd",d:ExpTable[printidx8],s:"\cf     Level[\cn",d:printidx28,s:"\cf]: \cd",d:ExpTable[printidx28],
            s:"\n\cf Level[\cn",d:printidx9,s:"\cf]: \cd",d:ExpTable[printidx9],s:"\cf     Level[\cn",d:printidx29,s:"\cf]: \cd",d:ExpTable[printidx29],
            s:"\n\cf Level[\cn",d:printidx10,s:"\cf]: \cd",d:ExpTable[printidx10],s:"\cf     Level[\cn",d:printidx30,s:"\cf]: \cd",d:ExpTable[printidx30],
            s:"\n\cf Level[\cn",d:printidx11,s:"\cf]: \cd",d:ExpTable[printidx11],s:"\cf     Level[\cn",d:printidx31,s:"\cf]: \cd",d:ExpTable[printidx31],
            s:"\n\cf Level[\cn",d:printidx12,s:"\cf]: \cd",d:ExpTable[printidx12],s:"\cf     Level[\cn",d:printidx32,s:"\cf]: \cd",d:ExpTable[printidx32],
            s:"\n\cf Level[\cn",d:printidx13,s:"\cf]: \cd",d:ExpTable[printidx13],s:"\cf     Level[\cn",d:printidx33,s:"\cf]: \cd",d:ExpTable[printidx33],
            s:"\n\cf Level[\cn",d:printidx14,s:"\cf]: \cd",d:ExpTable[printidx14],s:"\cf     Level[\cn",d:printidx34,s:"\cf]: \cd",d:ExpTable[printidx34],
            s:"\n\cf Level[\cn",d:printidx15,s:"\cf]: \cd",d:ExpTable[printidx15],s:"\cf     Level[\cn",d:printidx35,s:"\cf]: \cd",d:ExpTable[printidx35],
            s:"\n\cf Level[\cn",d:printidx16,s:"\cf]: \cd",d:ExpTable[printidx16],s:"\cf     Level[\cn",d:printidx36,s:"\cf]: \cd",d:ExpTable[printidx36],
            s:"\n\cf Level[\cn",d:printidx17,s:"\cf]: \cd",d:ExpTable[printidx17],s:"\cf     Level[\cn",d:printidx37,s:"\cf]: \cd",d:ExpTable[printidx37],
            s:"\n\cf Level[\cn",d:printidx18,s:"\cf]: \cd",d:ExpTable[printidx18],s:"\cf     Level[\cn",d:printidx38,s:"\cf]: \cd",d:ExpTable[printidx38],
            s:"\n\cf Level[\cn",d:printidx19,s:"\cf]: \cd",d:ExpTable[printidx19],s:"\cf     Level[\cn",d:printidx39,s:"\cf]: \cd",d:ExpTable[printidx39]
           );
}

// Prints out or changes the number for the "MiscellaneousVars[#]" vars.
script "DMV" (int index, int type, int value)
{
 int oldvalue;
 int newvalue;

 int printidx0, printidx1, printidx2, printidx3, printidx4, printidx5, printidx6, printidx7, printidx8, printidx9;
 int printidx10, printidx11, printidx12, printidx13, printidx14, printidx15, printidx16, printidx17, printidx18, printidx19;
 int printidx20, printidx21, printidx22, printidx23, printidx24, printidx25, printidx26, printidx27, printidx28, printidx29;
 int printidx30, printidx31, printidx32, printidx33, printidx34, printidx35, printidx36, printidx37, printidx38, printidx39;

 if (index >= 0)
 {
  oldvalue = MiscellaneousVars[index];
  if (type == 1) MiscellaneousVars[index] += value; // adds to the value
  if (type == 2) MiscellaneousVars[index] = value; // sets the value
  newvalue = MiscellaneousVars[index];
  if (type == 0)
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nValue: ",d:newvalue);
  }
  else
  {
   PrintBold(s:"Index: ",d:index,
             s:"\nOldValue: ",d:oldvalue,
             s:"\nNewValue: ",d:newvalue);
  }
 }
 else
 {
  // Prints the entire list [although you'll need to read into the console to see all the values, as it only shows 40 at a time, and only the last forty will show on your screen :P]
  printidx0 = 0; printidx1 = 1; printidx2 = 2; printidx3 = 3; printidx4 = 4; printidx5 = 5; printidx6 = 6; printidx7 = 7; printidx8 = 8; printidx9 = 9;
  printidx10 = 10; printidx11 = 11; printidx12 = 12; printidx13 = 13; printidx14 = 14; printidx15 = 15; printidx16 = 16; printidx17 = 17; printidx18 = 18; printidx19 = 19;
  printidx20 = 20; printidx21 = 21; printidx22 = 22; printidx23 = 23; printidx24 = 24; printidx25 = 25; printidx26 = 26; printidx27 = 27; printidx28 = 28; printidx29 = 29;
  printidx30 = 30; printidx31 = 31; printidx32 = 32; printidx33 = 33; printidx34 = 34; printidx35 = 35; printidx36 = 36; printidx37 = 37; printidx38 = 38; printidx39 = 39;
  // 0 - 39
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 40 - 79
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 80 - 119
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 120 - 159
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 160 - 199
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 200 - 239
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 240 - 279
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 280 - 319
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 320 - 359
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 360 - 399
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 400 - 439
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 440 - 479
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 480 - 519
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 520 - 559
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 560 - 599
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 600 - 639
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 640 - 679
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 680 - 719
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 720 - 759
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 760 - 799
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 800 - 839
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 840 - 879
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 880 - 919
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 920 - 959
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

  // 960 - 999
  printidx0 += 40; printidx1 += 40; printidx2 += 40; printidx3 += 40; printidx4 += 40; printidx5 += 40; printidx6 += 40; printidx7 += 40; printidx8 += 40; printidx9 += 40;
  printidx10 += 40; printidx11 += 40; printidx12 += 40; printidx13 += 40; printidx14 += 40; printidx15 += 40; printidx16 += 40; printidx17 += 40; printidx18 += 40; printidx19 += 40;
  printidx20 += 40; printidx21 += 40; printidx22 += 40; printidx23 += 40; printidx24 += 40; printidx25 += 40; printidx26 += 40; printidx27 += 40; printidx28 += 40; printidx29 += 40;
  printidx30 += 40; printidx31 += 40; printidx32 += 40; printidx33 += 40; printidx34 += 40; printidx35 += 40; printidx36 += 40; printidx37 += 40; printidx38 += 40; printidx39 += 40;
  PrintBold(
              s:"\cf Index[\cn",d:printidx0,s:"\cf]: \cd",d:MiscellaneousVars[printidx0],s:"\cf     Index[\cn",d:printidx20,s:"\cf]: \cd",d:MiscellaneousVars[printidx20],
            s:"\n\cf Index[\cn",d:printidx1,s:"\cf]: \cd",d:MiscellaneousVars[printidx1],s:"\cf     Index[\cn",d:printidx21,s:"\cf]: \cd",d:MiscellaneousVars[printidx21],
            s:"\n\cf Index[\cn",d:printidx2,s:"\cf]: \cd",d:MiscellaneousVars[printidx2],s:"\cf     Index[\cn",d:printidx22,s:"\cf]: \cd",d:MiscellaneousVars[printidx22],
            s:"\n\cf Index[\cn",d:printidx3,s:"\cf]: \cd",d:MiscellaneousVars[printidx3],s:"\cf     Index[\cn",d:printidx23,s:"\cf]: \cd",d:MiscellaneousVars[printidx23],
            s:"\n\cf Index[\cn",d:printidx4,s:"\cf]: \cd",d:MiscellaneousVars[printidx4],s:"\cf     Index[\cn",d:printidx24,s:"\cf]: \cd",d:MiscellaneousVars[printidx24],
            s:"\n\cf Index[\cn",d:printidx5,s:"\cf]: \cd",d:MiscellaneousVars[printidx5],s:"\cf     Index[\cn",d:printidx25,s:"\cf]: \cd",d:MiscellaneousVars[printidx25],
            s:"\n\cf Index[\cn",d:printidx6,s:"\cf]: \cd",d:MiscellaneousVars[printidx6],s:"\cf     Index[\cn",d:printidx26,s:"\cf]: \cd",d:MiscellaneousVars[printidx26],
            s:"\n\cf Index[\cn",d:printidx7,s:"\cf]: \cd",d:MiscellaneousVars[printidx7],s:"\cf     Index[\cn",d:printidx27,s:"\cf]: \cd",d:MiscellaneousVars[printidx27],
            s:"\n\cf Index[\cn",d:printidx8,s:"\cf]: \cd",d:MiscellaneousVars[printidx8],s:"\cf     Index[\cn",d:printidx28,s:"\cf]: \cd",d:MiscellaneousVars[printidx28],
            s:"\n\cf Index[\cn",d:printidx9,s:"\cf]: \cd",d:MiscellaneousVars[printidx9],s:"\cf     Index[\cn",d:printidx29,s:"\cf]: \cd",d:MiscellaneousVars[printidx29],
            s:"\n\cf Index[\cn",d:printidx10,s:"\cf]: \cd",d:MiscellaneousVars[printidx10],s:"\cf     Index[\cn",d:printidx30,s:"\cf]: \cd",d:MiscellaneousVars[printidx30],
            s:"\n\cf Index[\cn",d:printidx11,s:"\cf]: \cd",d:MiscellaneousVars[printidx11],s:"\cf     Index[\cn",d:printidx31,s:"\cf]: \cd",d:MiscellaneousVars[printidx31],
            s:"\n\cf Index[\cn",d:printidx12,s:"\cf]: \cd",d:MiscellaneousVars[printidx12],s:"\cf     Index[\cn",d:printidx32,s:"\cf]: \cd",d:MiscellaneousVars[printidx32],
            s:"\n\cf Index[\cn",d:printidx13,s:"\cf]: \cd",d:MiscellaneousVars[printidx13],s:"\cf     Index[\cn",d:printidx33,s:"\cf]: \cd",d:MiscellaneousVars[printidx33],
            s:"\n\cf Index[\cn",d:printidx14,s:"\cf]: \cd",d:MiscellaneousVars[printidx14],s:"\cf     Index[\cn",d:printidx34,s:"\cf]: \cd",d:MiscellaneousVars[printidx34],
            s:"\n\cf Index[\cn",d:printidx15,s:"\cf]: \cd",d:MiscellaneousVars[printidx15],s:"\cf     Index[\cn",d:printidx35,s:"\cf]: \cd",d:MiscellaneousVars[printidx35],
            s:"\n\cf Index[\cn",d:printidx16,s:"\cf]: \cd",d:MiscellaneousVars[printidx16],s:"\cf     Index[\cn",d:printidx36,s:"\cf]: \cd",d:MiscellaneousVars[printidx36],
            s:"\n\cf Index[\cn",d:printidx17,s:"\cf]: \cd",d:MiscellaneousVars[printidx17],s:"\cf     Index[\cn",d:printidx37,s:"\cf]: \cd",d:MiscellaneousVars[printidx37],
            s:"\n\cf Index[\cn",d:printidx18,s:"\cf]: \cd",d:MiscellaneousVars[printidx18],s:"\cf     Index[\cn",d:printidx38,s:"\cf]: \cd",d:MiscellaneousVars[printidx38],
            s:"\n\cf Index[\cn",d:printidx19,s:"\cf]: \cd",d:MiscellaneousVars[printidx19],s:"\cf     Index[\cn",d:printidx39,s:"\cf]: \cd",d:MiscellaneousVars[printidx39]
           );

/*
  PrintBold(
            s:"\cf Index[\cn0\cf]: \cd",d:MiscellaneousVars[0],s:"\cf     Index[\cn20\cf]: \cd",d:MiscellaneousVars[20],
            s:"\n\cf Index[\cn1\cf]: \cd",d:MiscellaneousVars[1],s:"\cf     Index[\cn21\cf]: \cd",d:MiscellaneousVars[21],
            s:"\n\cf Index[\cn2\cf]: \cd",d:MiscellaneousVars[2],s:"\cf     Index[\cn22\cf]: \cd",d:MiscellaneousVars[22],
            s:"\n\cf Index[\cn3\cf]: \cd",d:MiscellaneousVars[3],s:"\cf     Index[\cn23\cf]: \cd",d:MiscellaneousVars[23],
            s:"\n\cf Index[\cn4\cf]: \cd",d:MiscellaneousVars[4],s:"\cf     Index[\cn24\cf]: \cd",d:MiscellaneousVars[24],
            s:"\n\cf Index[\cn5\cf]: \cd",d:MiscellaneousVars[5],s:"\cf     Index[\cn25\cf]: \cd",d:MiscellaneousVars[25],
            s:"\n\cf Index[\cn6\cf]: \cd",d:MiscellaneousVars[6],s:"\cf     Index[\cn26\cf]: \cd",d:MiscellaneousVars[26],
            s:"\n\cf Index[\cn7\cf]: \cd",d:MiscellaneousVars[7],s:"\cf     Index[\cn27\cf]: \cd",d:MiscellaneousVars[27],
            s:"\n\cf Index[\cn8\cf]: \cd",d:MiscellaneousVars[8],s:"\cf     Index[\cn28\cf]: \cd",d:MiscellaneousVars[28],
            s:"\n\cf Index[\cn9\cf]: \cd",d:MiscellaneousVars[9],s:"\cf     Index[\cn29\cf]: \cd",d:MiscellaneousVars[29],
            s:"\n\cf Index[\cn10\cf]: \cd",d:MiscellaneousVars[10],s:"\cf     Index[\cn30\cf]: \cd",d:MiscellaneousVars[30],
            s:"\n\cf Index[\cn11\cf]: \cd",d:MiscellaneousVars[11],s:"\cf     Index[\cn31\cf]: \cd",d:MiscellaneousVars[31],
            s:"\n\cf Index[\cn12\cf]: \cd",d:MiscellaneousVars[12],s:"\cf     Index[\cn32\cf]: \cd",d:MiscellaneousVars[32],
            s:"\n\cf Index[\cn13\cf]: \cd",d:MiscellaneousVars[13],s:"\cf     Index[\cn33\cf]: \cd",d:MiscellaneousVars[33],
            s:"\n\cf Index[\cn14\cf]: \cd",d:MiscellaneousVars[14],s:"\cf     Index[\cn34\cf]: \cd",d:MiscellaneousVars[34],
            s:"\n\cf Index[\cn15\cf]: \cd",d:MiscellaneousVars[15],s:"\cf     Index[\cn35\cf]: \cd",d:MiscellaneousVars[35],
            s:"\n\cf Index[\cn16\cf]: \cd",d:MiscellaneousVars[16],s:"\cf     Index[\cn36\cf]: \cd",d:MiscellaneousVars[36],
            s:"\n\cf Index[\cn17\cf]: \cd",d:MiscellaneousVars[17],s:"\cf     Index[\cn37\cf]: \cd",d:MiscellaneousVars[37],
            s:"\n\cf Index[\cn18\cf]: \cd",d:MiscellaneousVars[18],s:"\cf     Index[\cn38\cf]: \cd",d:MiscellaneousVars[38],
            s:"\n\cf Index[\cn19\cf]: \cd",d:MiscellaneousVars[19],s:"\cf     Index[\cn39\cf]: \cd",d:MiscellaneousVars[39]
           );
*/

 }
}

// HUD Display
script "HUDDisplay" ENTER
{
 int C1, C2, I1, I2, Z1, Z2, G1, G2, G3, G4, G5, G6, G7, G8, G9, G10, G11, HealMin, HealMax, HealSorcRatio;
 str S1;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int xpos;
 int ypos = 32.0;
 int msgdelay;
 int msgalpha;
 int MultiUpper, MultiLower;
 int ScreenXOffset;
 int tempvar1, tempvar2;

 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 int HUDMsgDelayBase = GetCVar("dvdsallhuds_refreshdelay");
 if (HUDMsgDelayBase < 1) HUDMsgDelayBase = 1;
 if (HUDMsgDelayBase > 420) HUDMsgDelayBase = 420;
 if (GetCVar("dvds_gfxeffectlevel") == 0) HUDMsgDelayBase *= 1;
 else if (GetCVar("dvds_gfxeffectlevel") == 1) HUDMsgDelayBase *= 3;
 else if (GetCVar("dvds_gfxeffectlevel") == 2) HUDMsgDelayBase *= 9;
 int HUDMsgDelayFixed = HUDMsgDelayBase * 1.0;
 HUDMsgDelayFixed /= 35;
/*
 PrintBold(s:"HudMsgDelay [Fixed]: ",f:HUDMsgDelayFixed,
         s:"\nHudMsgDelay [Whole]: ",d:HUDMsgDelayBase);
*/ 
 HUDMsgDelayFixed += 0.008;

 int overallhudalpha = GetCVar("dvdsoldhud_generaltransperancy");
 
 int EXPGainChecker = 1;
 if (ModType == 0 && GetCVar("dvds_noexpgains") != 0) EXPGainChecker = 0; // If in Classic mode and the EXP Gain option is turned off, don't show EXP stuff on HUD.

 if (MenuSystemVars[0] == 0 && MiscellaneousVars[199] > 0 && CheckActorInventory(Player1TID,"PlayerDeathFadeOut") < 1 && GetCVAR("dvds_showacshudelements") == 1)
 { 

                                    // *************************
  if (MiscellaneousVars[2000] == 0) // ** OLD STYLE HUD IS ON **
                                    // *************************
  {
/*
// START OLD STYLE HUD
	MessageIDs used: [lower IDs mean closer, higher IDs mean farther]

		2198 		- 	Kill Counter
		2200-2300	- 	EXP Combo Timer Bar Notches
        3200-3300 	- 	Mana Bar Notches
        3302-3402	- 	EXP Bar Notches
*/
   SetHudSize(640,480,0);

   // Mana Bar
   // 3200-3300	- Mana Bar Notches
   if (GetCVar("dvdsoldhud_showmanabar") > 0)
   {
    if (EXPGainChecker == 1) ypos = 32.0; else ypos = 24.0;
    G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
    G9 = 100 / G10;
    I1 = CurrentMana * G9 / MaxMana;
    if (I1 > G9) I1 = G9;
    if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
    for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
    {
     if (MaxMana != 0)
     {
       if (C1 <= I1)
       {
        if (G10 == 10) { SetFont("MANAHFA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("MANAHF4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("MANAHF2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("MANAHF"); G11 = 0.0; }
       }
       else
       {
        if (G10 == 10) { SetFont("OLDHEMPA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("OLDHEMP4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("OLDHEMP2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("OLDHEMP1"); G11 = 0.0; }
       }
       I2 = ((C1 << 16) * G10) + G11;
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,C1+3200,cr_untranslated,1.0+I2,ypos,HUDMsgDelayFixed,msgalpha);
     }
    }
   }

   if (GetCVar("dvdsoldhud_showexpbar") > 0)
   {
    if (EXPGainChecker == 1)
    {
     // EXP Bar
     // 3302-3402	- EXP Bar Notches
     G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
     G9 = 100 / G10;
     Z1 = Experience - ExpTable[PlayerLevel - 1];
     Z2 = ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1];
     I1 = Z1 * G9 / Z2;     
     if (I1 > G9) I1 = G9;
     if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
     for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
     {
       if (Z2 != 0)
       {
        if ((C1 <= I1) || (PlayerLevel == LevelCap))
        {
         if (G10 == 10) { SetFont("EXPHFA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("EXPHF4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("EXPHF2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("EXPHF"); G11 = 0.0; }
        }
        else
        {
         if (G10 == 10) { SetFont("OLDHEMPA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("OLDHEMP4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("OLDHEMP2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("OLDHEMP1"); G11 = 0.0; }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+3302,cr_untranslated,1.0+I2,24.0,HUDMsgDelayFixed,msgalpha);
       }
     }
    }
   }

   G6 += 1; if (G6 > 11) G6 = 0; // Resets Palette Flasher
   if (GetCVar("dvdsoldhud_showcombobar") > 0)
   {
    int MaxEXPCombotimer;
    if (PowerupTimer[7] > 0) MaxEXPCombotimer = 7000; else MaxEXPCombotimer = 5600;
    // EXP Combo Timer Bar
    // 2200-2300	- EXP Combo Timer Bar Notches
    G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
    G9 = 100 / G10;
    Z1 = MiscellaneousVars[157];
    Z2 = MaxEXPCombotimer;
    I1 = Z1 * G9 / Z2;     
    if (I1 > G9) I1 = G9;
    if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
    if (Z1 > 0 && Z2 > 0)
    {
     for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
     {
      if (C1 <= I1)
      {
       if (G10 == 10) { SetFont("COMBOHFA"); G11 = -5.0; }
       if (G10 == 4) { SetFont("COMBOHF4"); G11 = -2.0; }
       if (G10 == 2) { SetFont("COMBOHF2"); G11 = -1.0; }
       if (G10 == 1) { SetFont("COMBOHF"); G11 = 0.0; }
      }
      else
      {
       if (G10 == 10) { SetFont("COMBOHEA"); G11 = -5.0; }
       if (G10 == 4) { SetFont("COMBOHE4"); G11 = -2.0; }
       if (G10 == 2) { SetFont("COMBOHE2"); G11 = -1.0; }
       if (G10 == 1) { SetFont("COMBOHE"); G11 = 0.0; }
      }
      I2 = ((C1 << 16) * G10) + G11;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,C1+2200,cr_untranslated,1.0+I2,68.0,HUDMsgDelayFixed,msgalpha);
     }
    }
   }
 
    // EXP Combo Kill Counter
	// 2198 - Kill Counter
    SetFont("DVDSSMLFONT");
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
    if (MiscellaneousVars[158] > 0)
    {
      if (G6 > 8)
      {
       // \c[LightBlue]
       if (MiscellaneousVars[158] == 1) HudMessage(s:"\c[LightBlue]",d:MiscellaneousVars[158],s:" KILL";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[158] > 1) HudMessage(s:"\c[LightBlue]",d:MiscellaneousVars[158],s:" KILLS";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 5 && G6 < 9)
      {
       // \c[Gray]
       if (MiscellaneousVars[158] == 1) HudMessage(s:"\c[Gray]",d:MiscellaneousVars[158],s:" KILL";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[158] > 1) HudMessage(s:"\c[Gray]",d:MiscellaneousVars[158],s:" KILLS";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 2 && G6 < 6)
      {
       // \c[Green]
       if (MiscellaneousVars[158] == 1) HudMessage(s:"\c[Green]",d:MiscellaneousVars[158],s:" KILL";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[158] > 1) HudMessage(s:"\c[Green]",d:MiscellaneousVars[158],s:" KILLS";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 < 3)
      {
       // \c[Purple]
       if (MiscellaneousVars[158] == 1) HudMessage(s:"\c[Purple]",d:MiscellaneousVars[158],s:" KILL";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[158] > 1) HudMessage(s:"\c[Purple]",d:MiscellaneousVars[158],s:" KILLS";HUDMSG_ALPHA,2200,cr_green,51.0,56.0,HUDMsgDelayFixed,msgalpha);
      }
    }
    // EXP Combo Total
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
    if (MiscellaneousVars[158] > 1 && MiscellaneousVars[160] > 0)
    {
      if (G6 > 8)
      {
       // \c[LightBlue]
       HudMessage(s:"\c[LightBlue]+",d:MiscellaneousVars[160],s:" EXP";HUDMSG_ALPHA,2198,cr_green,51.0,80.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 5 && G6 < 9)
      {
       // \c[Gray]
       HudMessage(s:"\c[Gray]+",d:MiscellaneousVars[160],s:" EXP";HUDMSG_ALPHA,2198,cr_green,51.0,80.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 2 && G6 < 6)
      {
       // \c[Green]
       HudMessage(s:"\c[Green]+",d:MiscellaneousVars[160],s:" EXP";HUDMSG_ALPHA,2198,cr_green,51.0,80.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 < 3)
      {
       // \c[Purple]
       HudMessage(s:"\c[Purple]+",d:MiscellaneousVars[160],s:" EXP";HUDMSG_ALPHA,2198,cr_green,51.0,80.0,HUDMsgDelayFixed,msgalpha);
      }
    }
 
    // EXP Combo Multiplier
    MultiLower = (MiscellaneousVars[159] - 10000) % 100;
    MultiUpper = ((MiscellaneousVars[159] - 10000) - MultiLower) / 100;
    SetFont("DVDSSMLFONT");
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
    if (MiscellaneousVars[158] > 1)
    {
      if (G6 > 8)
      {
       // \c[LightBlue]
       if (MultiLower > -1 && MultiLower < 10) HudMessage(s:"\c[LightBlue]+",d:MultiUpper,s:".0",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"\c[LightBlue]+",d:MultiUpper,s:".",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 5 && G6 < 9)
      {
       // \c[Gray]
       if (MultiLower > -1 && MultiLower < 10) HudMessage(s:"\c[Gray]+",d:MultiUpper,s:".0",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"\c[Gray]+",d:MultiUpper,s:".",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 > 2 && G6 < 6)
      {
       // \c[Green]
       if (MultiLower > -1 && MultiLower < 10) HudMessage(s:"\c[Green]+",d:MultiUpper,s:".0",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"\c[Green]+",d:MultiUpper,s:".",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
      }
      else
      if (G6 < 3)
      {
       // \c[Purple]
       if (MultiLower > -1 && MultiLower < 10) HudMessage(s:"\c[Purple]+",d:MultiUpper,s:".0",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"\c[Purple]+",d:MultiUpper,s:".",d:MultiLower,s:"%";HUDMSG_ALPHA,2199,cr_green,51.0,92.0,HUDMsgDelayFixed,msgalpha);
      }
    }

   int MaxTensionChargeTimer;
   int TensionTimerMax = 3600;
   if (GetCVar("dvds_allowtension") > 0)
   {
    if (GetCVar("dvdsoldhud_showtensionbars") > 0)
    {
     // Tension Charge Timer Bar
     if (MiscellaneousVars[181] == 0) { MaxTensionChargeTimer = 14000; } // "0"
     if (MiscellaneousVars[181] == 1) { MaxTensionChargeTimer = 14880; TensionTimerMax = 3600; } // "5"
     if (MiscellaneousVars[181] == 2) { MaxTensionChargeTimer = 15750; TensionTimerMax = 4320; } // "20" [x1.2]
     if (MiscellaneousVars[181] == 3) { MaxTensionChargeTimer = 17500; TensionTimerMax = 5184; } // "50" [x1.2]
     if (MiscellaneousVars[181] == 4) { MaxTensionChargeTimer = 19250; TensionTimerMax = 6221; } // "100" [x1.2]
     if (MiscellaneousVars[181] == 5) { MaxTensionChargeTimer = 21000; TensionTimerMax = 7465; } // "250" [x1.2]
     if (MiscellaneousVars[181] == 6) { MaxTensionChargeTimer = 26250; TensionTimerMax = 8958; } // "500" [x1.2]
     if (MiscellaneousVars[181] == 7) { TensionTimerMax = 10750; } // "1000" [x1.2]
 
     if (MiscellaneousVars[181] < 7 && MiscellaneousVars[185] > 0 && MiscellaneousVars[184] == 0)
     {
      G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
      G9 = 100 / G10;
      Z1 = MiscellaneousVars[185];
      Z2 = MaxTensionChargeTimer;
      I1 = Z1 * G9 / Z2;     
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {
       if (C1 <= I1)
       {
        if (G10 == 10) { SetFont("TENCHAFA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("TENCHAF4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("TENCHAF2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("TENCHAF"); G11 = 0.0; }
       }
       else
       {
        if (G10 == 10) { SetFont("OLDHEMPA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("OLDHEMP4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("OLDHEMP2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("OLDHEMP1"); G11 = 0.0; }
       }
       I2 = ((C1 << 16) * G10) + G11;
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,C1+2302,cr_untranslated,536.0+I2,20.0,HUDMsgDelayFixed,msgalpha); //
      }
     }

 
     // Tension Time-Left Bar
     if (MiscellaneousVars[181] > 0) //   && MiscellaneousVars[183] < TensionTimerMax
     {
      G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
      G9 = 100 / G10;
      Z1 = MiscellaneousVars[183];
      Z2 = TensionTimerMax;
      I1 = Z1 * G9 / Z2;     
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {
       if (C1 <= I1)
       {
        if (G10 == 10) { SetFont("TENTIMFA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("TENTIMF4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("TENTIMF2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("TENTIMF"); G11 = 0.0; }
       }
       else
       {
        if (G10 == 10) { SetFont("OLDHEMPA"); G11 = -6.0; }
        if (G10 == 4) { SetFont("OLDHEMP4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("OLDHEMP2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("OLDHEMP1"); G11 = 0.0; }
       }
       I2 = ((C1 << 16) * G10) + G11;
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,C1+2404,cr_untranslated,536.0+I2,28.0,HUDMsgDelayFixed,msgalpha); //
      }
     }

     // Tension Cooldown Bar
     // MiscellaneousVars[188] = MiscellaneousVars[186];
     if (MiscellaneousVars[186] > 0 && MiscellaneousVars[188] > 0 && MiscellaneousVars[184] == 0)
     {
      G10 = GetCVar("dvdsoldhud_hudmeternotchdetail");
      G9 = 100 / G10;
      Z1 = MiscellaneousVars[186];
      Z2 = MiscellaneousVars[188];
      I1 = Z1 * G9 / Z2;     
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsoldhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {
       if (C1 <= I1)
       {
        if (G10 == 10) { SetFont("TENCOOFA"); G11 = -5.0; }
        if (G10 == 4) { SetFont("TENCOOF4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("TENCOOF2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("TENCOOF"); G11 = 0.0; }
       }
       else
       {
        if (G10 == 10) { SetFont("OLDHEMPA"); G11 = -5.0; }
        if (G10 == 4) { SetFont("OLDHEMP4"); G11 = -2.0; }
        if (G10 == 2) { SetFont("OLDHEMP2"); G11 = -1.0; }
        if (G10 == 1) { SetFont("OLDHEMP1"); G11 = 0.0; }
       }
       I2 = ((C1 << 16) * G10) + G11;
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,C1+2506,cr_untranslated,536.0+I2,36.0,HUDMsgDelayFixed,msgalpha); //
      }
     }
    }

    // Shows Tension Level [icon]
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
    if (MiscellaneousVars[181] > 0)
    {
      if (MiscellaneousVars[181] == 1) SetFont("TENMEDA0");
      if (MiscellaneousVars[181] == 2) SetFont("TENMEDB0");
      if (MiscellaneousVars[181] == 3) SetFont("TENMEDC0");
      if (MiscellaneousVars[181] == 4) SetFont("TENMEDD0");
      if (MiscellaneousVars[181] == 5) SetFont("TENMEDE0");
      if (MiscellaneousVars[181] == 6) SetFont("TENMEDF0");
      if (MiscellaneousVars[181] == 7) SetFont("TENMEDG0");
      HudMessage(s:"A";HUDMSG_ALPHA,2609,cr_untranslated,508.0,28.0,HUDMsgDelayFixed,msgalpha); //
    }
    else
    {
     if (MiscellaneousVars[185] > 0) // Charging Tension
     {
      SetFont("TENMED00"); // "0" Tension Icon
      HudMessage(s:"A";HUDMSG_ALPHA,2609,cr_untranslated,508.0,28.0,HUDMsgDelayFixed,msgalpha); //
     }
     else
     {
      if (MiscellaneousVars[186] > 0) // Not Charging Tension /w Tension Cooldown
      {
       SetFont("TENSMLNO"); // No Tension Icon
       HudMessage(s:"A";HUDMSG_ALPHA,2609,cr_untranslated,508.0,28.0,HUDMsgDelayFixed,msgalpha); //
      }
     }
    }
   }

   // Boss HP Bar
   MiscellaneousVars[2027] = 0;
   G1 = GetActorProperty(1124,APROP_Health);
   if (G1 > 0) { MiscellaneousVars[2027] = 1124; } // Check for a Sauravatar first
   else
   {
    G1 = GetActorProperty(1123,APROP_Health);
    if (G1 > 0) { MiscellaneousVars[2027] = 1123; } // Check for a Sauron's Eye [Main] second
    else
    {
     G1 = GetActorProperty(1222,APROP_Health); // use tag 1222 for custom "bosses"
     if (G1 > 0) { MiscellaneousVars[2027] = 1222; } // Check for custom bosses third if neither of the above exists
    }
   }

   if (MiscellaneousVars[2027] > 0)
   {
    SetActivator(MiscellaneousVars[2027]);
    if (IsPointerEqual(AAPTR_TARGET, AAPTR_NULL) == FALSE)
    {
     SetActivator(0);
     for (C1 = 257; C1 > 1; C1 --)
     {
      G3 = GetActorProperty(MiscellaneousVars[2027],APROP_Health); // Current Health for Boss
      G2 = GetUserVariable(MiscellaneousVars[2027],"user_MaxHP"); // Max Health for Boss
      if (G2 != 0)
      {
       I1 = G3 * 256 / G2;
    
       if (C1 - 1 <= I1) SetFont("BossHF"); else SetFont("BossHE");
       I2 = C1 << 16;
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,C1+3502,cr_untranslated,192.0+I2,384.0,HUDMsgDelayFixed,msgalpha);

       SetFont("DVDSBIGFONT");
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       if (MiscellaneousVars[2027] == 1222) HudMessage(s:"BOSS";HUDMSG_ALPHA,3501,cr_red,320.0,400.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[2027] == 1123) HudMessage(s:"SAURON'S EYE";HUDMSG_ALPHA,3501,cr_red,320.0,400.0,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[2027] == 1124) HudMessage(s:"SAURAVATAR";HUDMSG_ALPHA,3501,cr_darkgrey,320.0,400.0,HUDMsgDelayFixed,msgalpha);
       SetFont("DVDSSMLFONT");
       msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:G3,s:" / ",d:G2;HUDMSG_ALPHA,3500,cr_darkgrey,320.0,376.0,HUDMsgDelayFixed,msgalpha);
      }
      SetActivator(0);
     }
     SetActivator(0);
    }
    SetActivator(0);
   }
   SetActivator(0);

   SetHudSize(640,480,0);
   msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
   if (EXPGainChecker == 1)
   {
    SetFont("DVDSSMLFONT");
    if (PlayerLevel >= LevelCap)
    {
     HudMessage(s:"\cdLevel: ",d:PlayerLevel,s:" / ",d:LevelCap,s:"\c-      \cn(",d:Experience,s:" EXP)";HUDMSG_ALPHA,3413,cr_white,120.1,24.0,HUDMsgDelayFixed,msgalpha);
    }
    else
    {
     HudMessage(s:"\cdLevel: ",d:PlayerLevel,s:" / ",d:LevelCap,s:"\c-      \cn(",d:Experience,s:" EXP)      \ca(",d:MiscellaneousVars[48],s:" Needed)";HUDMSG_ALPHA,3413,cr_white,120.1,24.0,HUDMsgDelayFixed,msgalpha);
    }
   }

   SetFont("DVDSSMLFONT");
   if (EXPGainChecker == 1) ypos = 32.0; else ypos = 24.0;
   msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
   HudMessage(s:"\c[Purple]Mana: ",d:CurrentMana,s:" / ",d:MaxMana;HUDMSG_ALPHA,3415,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);

   // Seed Level Displays [#3416 & #3417]
   msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
   if (GetCVar("dvdsallhuds_showstatinfo") == 1)
   {
    if (EXPGainChecker == 1) ypos = 54.0; else ypos = 46.0;
    if (MiscellaneousVars[24] == 0) // No Stat Selected
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
    if (MiscellaneousVars[24] == 1) // Selected Agility
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \c[blue]",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
    if (MiscellaneousVars[24] == 2) // Selected Defense
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \c[blue]",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
    if (MiscellaneousVars[24] == 3) // Selected Deftness
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \c[blue]",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
 
    if (MiscellaneousVars[24] == 4) // Selected Sorcery
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \c[blue]",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
    if (MiscellaneousVars[24] == 5) // Selected Strength
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \c[blue]",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \cf",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }
    if (MiscellaneousVars[24] == 6) // Selected Therapeusis
    {
     HudMessage(
              s:"\c[LightBlue]Agility: \cf",d:MiscellaneousVars[31],
                 s:"\n\c[Olive]Defense: \cf",d:MiscellaneousVars[32],
                 s:"\n\c[Green]Deftness: \cf",d:MiscellaneousVars[33],
                    s:"\n\c[Tan]Balance: \cf",d:MiscellaneousVars[201];
                 HUDMSG_ALPHA,3416,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     HudMessage(
                   s:"\c[Purple]Sorcery: \cf",d:MiscellaneousVars[34],
                    s:"\n\c[Red]Strength: \cf",d:MiscellaneousVars[35],
                   s:"\n\c[Gray]Therapeusis: \c[blue]",d:MiscellaneousVars[36],
           s:"\n\c[LightBlue]Jumping: \cf",d:MiscellaneousVars[200];
                 HUDMSG_ALPHA,3417,cr_white,248.1,ypos,HUDMsgDelayFixed,msgalpha);
    }

    // AeonPts Display [#3420]
    G5 += 1;
    if (G5 > 11) G5 = 0; // Resets Palette Flasher
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);

    ypos = 16.0;
    if (MiscellaneousVars[25] > 0 && PlayerLevel >= MiscellaneousVars[197])
    {
     if (G5 > 8)
     {
       HudMessage(
       s:"\c[LightBlue]AeonPTS: \cf",d:MiscellaneousVars[25],
                                                                   s:"\cn   (\cj",k:"pukename AeonPointKey 0",s:"\cf [down], \cj",
                                                                                        k:"pukename AeonPointKey 1",s:"\cf [up], \cj",
                                                                                        k:"pukename AeonPointKey 2",s:"\cf [use]\cn)";
       HUDMSG_ALPHA,3420,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     }
     else
     if (G5 > 5 && G5 < 9)
     {
       HudMessage(
       s:"\c[Gray]AeonPTS: \cf",d:MiscellaneousVars[25],
                                                                   s:"\cn   (\cj",k:"pukename AeonPointKey 0",s:"\cf [down], \cj",
                                                                                        k:"pukename AeonPointKey 1",s:"\cf [up], \cj",
                                                                                        k:"pukename AeonPointKey 2",s:"\cf [use]\cn)";
       HUDMSG_ALPHA,3420,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     }
     else
     if (G5 > 2 && G5 < 6)
     {
       HudMessage(
       s:"\c[Green]AeonPTS: \cf",d:MiscellaneousVars[25],
                                                                   s:"\cn   (\cj",k:"pukename AeonPointKey 0",s:"\cf [down], \cj",
                                                                                        k:"pukename AeonPointKey 1",s:"\cf [up], \cj",
                                                                                        k:"pukename AeonPointKey 2",s:"\cf [use]\cn)";
       HUDMSG_ALPHA,3420,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     }
     else
     if (G5 < 3)
     {
       HudMessage(
       s:"\c[Purple]AeonPTS: \cf",d:MiscellaneousVars[25],
                                                                   s:"\cn   (\cj",k:"pukename AeonPointKey 0",s:"\cf [down], \cj",
                                                                                        k:"pukename AeonPointKey 1",s:"\cf [up], \cj",
                                                                                        k:"pukename AeonPointKey 2",s:"\cf [use]\cn)";
       HUDMSG_ALPHA,3420,cr_white,120.1,ypos,HUDMsgDelayFixed,msgalpha);
     }
    }
   }

   SetHudSize(704,528,0); // 640,480 //   SetHudSize(960,720,0);
   xpos = 352.0; // 50% [centered]
   ypos = 476.0; // 90% [towards bottom]
   // Function Ran
   G1 = SpellCostCheck(SelectedSpell); // Function testing to come later :P
   // Function Ran

   G4 = CurrentMana / SpellCostCheck(SelectedSpell);
 
   msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
   if (CurrentMana >= G1)
   {
    if (SelectedSpell == 40)
    {
     if (CharacterClass == 2)
     {
      HudMessage(s:"\cfSpreader Aura Lv. 1\c-",s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 320,432
     }
     else
     {
      HudMessage(s:SpellTable[SelectedSpell],s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
    }
    else
    {
     HudMessage(s:SpellTable[SelectedSpell],s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
    }
   }
   else
   {
    if (SelectedSpell == 40)
    {
     if (CharacterClass == 2)
     {
      HudMessage(s:"\cfSpreader Aura Lv. 1\c-",s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     else
     {
      HudMessage(s:SpellTable[SelectedSpell],s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
    }
    else
    {
     HudMessage(s:SpellTable[SelectedSpell],s:"\n(",d:G1,s:" Mana)    (",d:G4,s:" Uses)";HUDMSG_ALPHA,3406,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
    }
   }

   xpos = 352.0; // 50% [centered]
   ypos = 502.0; // 95% [towards bottom]
   msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
   if (SelectedSpell == 1) // Minor Healing
   {
    HealMin = GetHealingValue(0,0); // Minor [Min] 
    HealMax = GetHealingValue(0,1); // Minor [Max] 
    HudMessage(s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthTrue,s:" [100%]";HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
   }
   else if (SelectedSpell == 14) // Healing
   {
    HealMin = GetHealingValue(1,0); // Normal [Min] 
    HealMax = GetHealingValue(1,1); // Normal [Max] 
    HudMessage(s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthTrue,s:" [100%]";HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
   }
   else if (SelectedSpell == 29) // Major Healing
   {
    HealMin = GetHealingValue(2,0); // Major [Min] 
    HealMax = GetHealingValue(2,1); // Major [Max] 
    HudMessage(s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthLimit,s:" [200%]";HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
   }
   else if (SelectedSpell == 40) // Diamond Skin / Spreader Aura Lv. 1
   {
    if (CharacterClass == 2) // Flora uses Spreader Aura Lv. 1 [and thus it uses an unique Description]
    {
     HudMessage(s:"Allows You to Create 2 Extra Copies of Most Attacks/Spells.";HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
    }
    else // The other two use the usual Spell Description for Diamond Skin
    {
     HudMessage(s:SpellDesc[SelectedSpell];HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
    }
   }
   else
   {
    HudMessage(s:SpellDesc[SelectedSpell];HUDMSG_ALPHA,3407,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
   }

   // Quickspell
   if (GetCVar("dvdsoldhud_showquickspells") > 0)
   {
    str Keyname;
    SetHudSize(704,528,0); // 640,480 //   SetHudSize(960,720,0);
    xpos = 704.2;
    ypos = 220.0; // 200.0;
    int yposint = 11.0; // 10.0;
    msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
    // Spell Bind Displays
    for (C1 = 0; C1 < 10; C1 ++)
    {
     if (C1+1 == 1) Keyname = "pukename SpellQuickAssign 0";
     if (C1+1 == 2) Keyname = "pukename SpellQuickAssign 1";
     if (C1+1 == 3) Keyname = "pukename SpellQuickAssign 2";
     if (C1+1 == 4) Keyname = "pukename SpellQuickAssign 3";
     if (C1+1 == 5) Keyname = "pukename SpellQuickAssign 4";
     if (C1+1 == 6) Keyname = "pukename SpellQuickAssign 5";
     if (C1+1 == 7) Keyname = "pukename SpellQuickAssign 6";
     if (C1+1 == 8) Keyname = "pukename SpellQuickAssign 7";
     if (C1+1 == 9) Keyname = "pukename SpellQuickAssign 8";
     if (C1+1 == 10) Keyname = "pukename SpellQuickAssign 9";
 
     if (ReadiedSpells[C1] != 0)
     {
       // Function Ran
       G8 = SpellCostCheck(ReadiedSpells[C1] - 1); // Function testing to come later :P
       // Function Ran
  
       G4 = CurrentMana / SpellCostCheck(ReadiedSpells[C1] - 1);
  
       if (CurrentMana >= G8)
       {
        //PrintBold(d:CharacterClass,s:" ",d:(ReadiedSpells[C1] - 1));
        if ((ReadiedSpells[C1] - 1) == 40)
        {
         if (CharacterClass == 2)
         {
          HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:"\cfSpreader Aura Lv. 1\c-",s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_white,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
         }
         else
         {
          HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:SpellTable[ReadiedSpells[C1] - 1],s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_white,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
         }
        }
        else
        {
         HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:SpellTable[ReadiedSpells[C1] - 1],s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_white,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
        }
       }
       else
       {
        //PrintBold(d:CharacterClass,s:" ",d:(ReadiedSpells[C1] - 1));
        if ((ReadiedSpells[C1] - 1) == 40)
        {
         if (CharacterClass == 2)
         {
          HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:"\cfSpreader Aura Lv. 1\c-",s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_red,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
         }
         else
         {
          HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:SpellTable[ReadiedSpells[C1] - 1],s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_red,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
         }
        }
        else
        {
         HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: ",s:SpellTable[ReadiedSpells[C1] - 1],s:" (",d:G8,s:") [",d:G4,s:"]";HUDMSG_ALPHA,2001+C1,cr_red,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
        }
       }
     }
     else
     {
      HudMessage(d:C1+1,s:" [\cf",k:Keyname,s:"\c-]: Empty";HUDMSG_ALPHA,2001+C1,cr_white,xpos,ypos+FixedMul(C1 << 16,yposint),HUDMsgDelayFixed,msgalpha);
     }
    }
   }

   SetHudSize(0,0,0);
  }
  //***************************************************************
  //***************************************************************
  else if (MiscellaneousVars[2000] == 1 && ClassCheck > 1) //** NEW STYLE HUD HERE **
  //***************************************************************
  //***************************************************************
  {
/*
// START NEW STYLE HUD
	MessageIDs used: [lower IDs mean closer, higher IDs mean farther]

		2006 		- 	EXP Combo Meter Frame [Combos]
		2010-2110 	- 	EXP Combo Meter Notches [Combos]
		2111 		- 	EXP Combo Meter Glass [Combos]
		2112 		- 	# of Kills [Combos]
		2113 		- 	"Kills" Label [Combos]
		2114 		- 	"OVERKILL" text [Combos]
		2115 		- 	EXP [from last kill] [Combos]

		2222		-	Multi-Color Test Background

		2500 		- 	HP Gained during "LEVEL UP" [HP Info]
		2501 		- 	MP Gained during "LEVEL UP" [MP Info]

		2502 		- 	HP Label [HP Info]
		2504 		- 	HP Amounts [HP Info]
		2505 		- 	HP Meter Border [HP Info]
		2506 		- 	HP Meter Frame [HP Info]
		2600-2800 	- 	HP Meter "Overlife" Notches [HP Info]
		2800-3000 	- 	HP Meter Notches [HP Info] 
		3001 		- 	HP Meter Glass [HP Info]

		3002 		- 	MP Label [MP Info]
		3004 		- 	MP Amounts [MP Info]
		3005 		- 	MP Meter "Focus" Border [MP Info]
		3006 		- 	MP Meter Border [MP Info]
		3100-3300 	- 	MP Meter "Overmagic" Notches [MP Info]
		3301-3500 	- 	MP Meter Notches [MP Info]
		3501 		- 	MP Meter Glass [MP Info]

		3502 		- 	AP/HLCR Label [AP/HLCR Info]
		3503 		- 	AP/HLCR Amounts [AP/HLCR Info]
		3504 		- 	AP "Armor Type" Meter Frame / HLCR "OverHeat" Meter Frame [AP/HLCR Info]
		3505 		- 	AP/HLCR Meter Frame [AP/HLCR Info]
		3600-3800 	- 	AP Meter Notches / Hellcore "Overheat" Meter Notches [AP/HLCR Info]
		3801-4000 	- 	Hellcore Meter Notches [AP/HLCR Info]
		4001 		- 	AP/HLCR Meter Glass [AP/HLCR Info]

		4002 		- 	Stamina Label [STAMINA Info]
		4003 		- 	Stamina Amounts [STAMINA Info]
		4004 		- 	Stamina "Focus Charge" Meter Frame [STAMINA Info]
		4005 		- 	Stamina "Tension Charge" Meter Frame [STAMINA Info]
		4006 		- 	Stamina Meter Frame [STAMINA Info]
		4100-4300 	- 	Stamina Meter "OverStamina" Notches [STAMINA Info]
		4301-4500 	- 	Stamina Meter Notches [STAMINA Info]
		4501 		- 	Stamina Meter Glass [STAMINA Info]

		4502 		- 	LVL Label [LVL Info]
		4503 		- 	LVL Amounts [LVL Info]
		4504 		- 	LVL Meter Frame [LVL Info]
		4510-4560 	- 	LVL Meter Notches [LVL Info]
		4565 		- 	LVL Meter Glass [LVL Info]

		4602 		- 	SV% Label [SV% Info]
		4603 		- 	SV% Amounts [SV% Info]
		4604 		- 	SV% Meter Frame [SV% Info]
		4610-4660 	- 	SV% Meter Notches [SV% Info]
		4665 		- 	SV% Meter Glass [SV% Info]

		4702 		- 	AB% Label [AB% Info]
		4703 		- 	AB% Amounts [AB% Info]
		4704 		- 	AB% Meter Frame [AB% Info]
		4710-4760 	- 	AB% Meter Notches [AB% Info]
		4765 		- 	AB% Meter Glass [AB% Info]

		4802 		- 	EV% Label [EV% Info]
		4803 		- 	EV% Amounts [EV% Info]
		4804 		- 	EV% Meter Frame [EV% Info]
		4810-4860 	- 	EV% Meter Notches [EV% Info]
		4865 		- 	EV% Meter Glass [EV% Info]

		4901 		- 	EXP Label [EXP Info]
		4902 		- 	EXP Meter Border [EXP Info]
		4903-5103 	- 	EXP Meter Notches [EXP Info]
		5106 		- 	EXP Meter Glass [EXP Info]

		5110 		- 	Tension-Charge Meter "Psyche" Border [Tension Charge/Timer]
		5111 		- 	Tension-Charge Meter Border [Tension Charge/Timer]
		5120-5320 	- 	Tension-Charge Meter Notches [Tension Charge/Timer]
		5323-5523 	- 	Tension-Timer Notches [Tension Charge/Timer]
		5525 		- 	Tension-Timer Glass [Tension Charge/Timer]
		
		5621 		- 	Tension-Cooldown Meter "Max Cooldown" Border [Tension Cooldown]
		5622 		- 	Tension-Cooldown Meter Border [Tension Cooldown]
		5630-5730 	- 	Tension-Cooldown Meter Notches [Tension Cooldown]
        5731 		- 	Tension Star Icon [Tension Star]
		5732 		- 	Tension Cooldown Meter Glass [Tension Cooldown]

		5734 		- 	Sauron Helmet Icon [Armor Icons]
		5735 		- 	Sauron Gauntlets Icon [Armor Icons]
		5736 		- 	One Ring Icon [Armor Icons]
		5737-5749 	- 	Flora-Specfic Armor Icons [Armor Icons]

		5750 		- 	"Aeon Points" Icon [Stat/AeonPts Icons/Values]
		5751 		- 	"Aeon Points" Value [Stat/AeonPts Icons/Values]
		5752 		- 	"Strength" Icon [Stat/AeonPts Icons/Values]
		5753 		- 	"Strength" Value [Stat/AeonPts Icons/Values]
		5754 		- 	"Defense" Icon [Stat/AeonPts Icons/Values]
		5755 		- 	"Defense" Value [Stat/AeonPts Icons/Values]
		5756 		- 	"Sorcery" Icon [Stat/AeonPts Icons/Values]
		5757 		- 	"Sorcery" Value [Stat/AeonPts Icons/Values]
		5758 		- 	"Therapeusis" Icon [Stat/AeonPts Icons/Values]
		5759 		- 	"Therapeusis" Value [Stat/AeonPts Icons/Values]
		5760 		- 	"Agility" Icon [Stat/AeonPts Icons/Values]
		5761 		- 	"Agility" Value [Stat/AeonPts Icons/Values]
		5762 		- 	"Deftness" Icon [Stat/AeonPts Icons/Values]
		5763 		- 	"Deftness" Value [Stat/AeonPts Icons/Values]
		5764 		- 	"Balance" Icon [Stat/AeonPts Icons/Values]
		5765 		- 	"Balance" Value [Stat/AeonPts Icons/Values]
		5766 		- 	"Jumping" Icon [Stat/AeonPts Icons/Values]
		5767 		- 	"Jumping" Value [Stat/AeonPts Icons/Values]

		5768-5807	-	Buff/Debuff Icons/Timers

		5808 		- 	Buff/Debuff Message #1
		5809		- 	Buff/Debuff Message #2
		5810 		- 	Buff/Debuff Message #3
		5811 		- 	Buff/Debuff Message #4
		5812		- 	Buff/Debuff Message #5

		5900 		- 	Spin Attack Indicator Icon [Weapon/Ammo Display and Sceptre-EXP meter]
		5901 		- 	"AMMO" type label / Level Label and Amount [Hellcore] [Weapon/Ammo Display and Sceptre-EXP meter]
		5902 		- 	"AMMO" Amounts / Sceptre EXP [Weapon/Ammo Display and Sceptre-EXP meter]
		5903 		- 	"AMMO" Meter Empty "Glow" Border [Weapon/Ammo Display and Sceptre-EXP meter]
		5904 		- 	"AMMO" Meter / Sceptre EXP Meter Border [Weapon/Ammo Display and Sceptre-EXP meter]
		6000-6200 	- 	"AMMO" Meter Notches / Sceptre Meter Notches [Weapon/Ammo Display and Sceptre-EXP meter]
		6205 		- 	"AMMO" Meter / Sceptre EXP Meter Glass [Weapon/Ammo Display and Sceptre-EXP meter]
		6206 		-	Weapon Icon [Weapon/Ammo Display and Sceptre-EXP meter]

	    16213 		-	Boss HP Label [Boss Lifemeter]
		16214 		- 	Boss HP Amounts [Boss Lifemeter]
		16215 		- 	Boss HP Meter Border [Boss Lifemeter]
		16217-6617 	- 	Boss Meter Notches  [Boss Lifemeter]
		16620 		- 	Boss HP Meter Glass  [Boss Lifemeter]
		16621 		- 	Boss Name [Boss Lifemeter]
		16622 		- 	Boss Portrait [Boss Lifemeter]

		7531		-	Tension-OverPsyche Meter "OverPsyched" Border [Tension-OverPsyche]
		7532		-	Tension-OverPsyche Meter Border [Tension-OverPsyche]
		7533-7633	-	Tension-OverPsyche Meter Notches [Tension-OverPsyche]
		7635		-	Tension-OverPsyche Meter Glass [Tension-OverPsyche]

		7796 		- 	Level Up Icon 
		7797-7820 	- 	Character Portrait Pieces

		7854-7864 	- 	QuickSpell Text Costs [Quickspell]
		7865-7875 	- 	QuickSpell Bind Key Display [Quickspell]
		7876-7886 	- 	Not Enough Mana Icons [Quickspell]
		7887-7897 	- 	QuickSpell Icons [Quickspell]
		7898 		- 	QuickSpell Box Style [Quickspell]

		7991 		- 	Spell Cost [Spell Box]
		7992 		- 	Spell "<" Button [Spell Box]
		7993 		- 	Spell ">" Button [Spell Box]
		7994 		- 	Spell "Left" Button [Spell Box]
		7995 		- 	Spell "Right" Button [Spell Box]
		7996		- 	Spell "Use" Button [Spell Box]
		7997 		- 	Icon Shown on Spell Box [Spell Box]
		7998 		- 	Current Spell Icon [Spell Box]
		7999 		- 	Spell Style Box [Spell Box]

		8101-8405	-	Kills Meter
		8501-8805	-	Secrets Meter
		8901-9205	-	Items Meter
		
// END NEW STYLE HUD
*/
     overallhudalpha = GetCVar("dvdsnewhud_generaltransperancy");
     msgdelay = 0.036;
     msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
     xpos = MiscellaneousVars[2001];
     ypos = MiscellaneousVars[2002];
     SetHudSize(1440,1080,0); // Since 1920x1080 isn't truly "supported" [ZDOOM(TM(TM(TM))), etc] :V

     xpos = MiscFixedVars[1];
     ypos = MiscFixedVars[2];
     xpos = MiscFixedVars[3];
     ypos = MiscFixedVars[4];
     xpos = MiscFixedVars[5];
     ypos = MiscFixedVars[6];
     xpos = MiscFixedVars[7];
     ypos = MiscFixedVars[8];
     xpos = MiscFixedVars[9];
     ypos = MiscFixedVars[10];
     xpos = MiscFixedVars[11];
     ypos = MiscFixedVars[12];
     xpos = MiscFixedVars[13];
     ypos = MiscFixedVars[14];
     xpos = MiscFixedVars[15];
     ypos = MiscFixedVars[16];
     xpos = MiscFixedVars[17];
     ypos = MiscFixedVars[18];
     xpos = MiscFixedVars[19];
     ypos = MiscFixedVars[20];

    //*******************************
    //**Multi-Color Test Background**
    //*******************************
    if (MiscellaneousVars[170] == 1) // 0 means "on", 1 means "off".
    {
     xpos = ScreenXOffset + 320.0;
     ypos = 180.0;
	 msgalpha = 0.25; msgalpha = FixedMul(msgalpha,overallhudalpha);
     SetFont("HUDBGBOS"); // HUDBGTST
     HudMessage(s:"A";HUDMSG_ALPHA,2222,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap
    }
    //***********************
    //**General Positioning**
    //***********************

    // Healing/Damage Bursts

    int PopUpXPlacement = random(-288,288) * 1.0;
    int PopUpYPlacement = random(-216,216) * 1.0;
    int PopupHoldDuration = 0.0;
    int PopupFadeOutDuration = 0.0;
    int xposmod = 0.0;
    int yposmod = 0.0;

	// Damage Number Flashes
    if (Timer() > 3)
    {
     // Health
     PopupHoldDuration = 0.0;
     PopupFadeOutDuration = 0.0;
     xpos = 720.0;
     ypos = 540.0;
     msgalpha = 0.834; msgalpha = FixedMul(msgalpha,overallhudalpha);
     // [173] Shows "HealthDifference" in the new HUD for Player's "Damage/Healing" bursts.
     // [174] Shows "HealthDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
     // [175] Shows "NewHealthValue" in the new HUD for the Player's "Damage/Healing" bursts. 
     // HP/Health Damage/Heal
     if (MiscellaneousVars[173] != 0)
     {
       if (MiscellaneousVars[173] > 0) // Positive Value
       {
        if (MiscellaneousVars[174] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[175] >= MaxHealthLimit) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[173],s:" (",d:MiscellaneousVars[174],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_green,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[173];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_green,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        SetFont("BBURHPHL");
        yposmod = 0.0; // 1.0
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[173] < 0) // Negative Value
       {
        MiscellaneousVars[173] *= -1;
        MiscellaneousVars[174] *= -1;
        if (MiscellaneousVars[174] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[175] <= 0) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[173],s:" (",d:MiscellaneousVars[174],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[173];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        // Damage/Heal Cloud/Bursts
        if (MiscellaneousVars[175] <= 0) // Death [for now] 
        {
         SetFont("BBURHPCP");
         xposmod = 20.0; // 20.0 [large]
         yposmod = 10.0; // 10.0 [large]
        }
        else // Damage w/o Death
        {
         SetFont("BBURHPDP");
         xposmod = 2.0; // 0.0
         yposmod = 0.0; // 1.0
        }
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+xposmod+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
     }
	 else
	 if (CheckActorInventory(Player1TID,"Missed") > 0)
	 {
      yposmod = 0.0; // 9.0
	  SetFont("BBURMISS");
	  PopupHoldDuration = 0.375; PopupFadeOutDuration = 0.25;
	  HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_white,xpos+xposmod+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
	  TakeActorInventory(Player1TID,"Missed",9999);
	 }

     // Armor
     PopupHoldDuration = 0.0;
     PopupFadeOutDuration = 0.0;
     xpos = 720.0 - 48.0;
     ypos = 540.0 - 48.0;
     if (MiscellaneousVars[174] >= 30)
     {
      xpos -= 32.0;
      ypos -= 32.0;
     }
     msgalpha = 0.834; msgalpha = FixedMul(msgalpha,overallhudalpha);
     // [176] Shows "ArmorDifference" in the new HUD for Player's "Damage/Healing" bursts.
     // [177] Shows "ArmorDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
     // [178] Shows "NewArmorValue" in the new HUD for the Player's "Damage/Healing" bursts. 
     // AP/Armor Damage/Heal
     if (MiscellaneousVars[176] != 0)
     {
       if (MiscellaneousVars[176] > 0) // Positive Value
       {
        if (MiscellaneousVars[177] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[178] >= CurrentMaxArmor) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[176],s:" (",d:MiscellaneousVars[177],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_gold,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[176];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_gold,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        SetFont("BBURAPHL");
        yposmod = 0.0; // 1.0
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[176] < 0) // Negative Value
       {
        MiscellaneousVars[176] *= -1;
        MiscellaneousVars[177] *= -1;
        if (MiscellaneousVars[177] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[178] <= 0) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        xpos -= 32.0;
        ypos -= 32.0;
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[176],s:" (",d:MiscellaneousVars[177],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_darkgreen,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[176];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_darkgreen,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        // Damage/Heal Cloud/Bursts
        if (MiscellaneousVars[178] <= 0) // Armor Break [for now]
        {
         SetFont("BBURAPCT");
         xposmod = 20.0; // 20.0 [large], 8.0 [small]
         yposmod = 10.0; // 10.0 [large], 6.0 [small]
		 PlaySound(Player1TID,"marines/armorbroken",CHAN_ITEM,1.0,0,ATTN_NORM);
        }
        else // Damage w/o Armor Break
        {
         SetFont("BBURAPDM");
         xposmod = 2.0; // 0.0
         yposmod = 0.0; // 1.0
		 PlaySound(Player1TID,"marines/armordamaged",CHAN_ITEM,1.0,0,ATTN_NORM);
        }
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+xposmod+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
     }

     // Mana/MP
     PopupHoldDuration = 0.0;
     PopupFadeOutDuration = 0.0;
     xpos = 720.0 + 48.0;
     ypos = 540.0 + 48.0;
     if (MiscellaneousVars[174] >= 30)
     {
      xpos += 32.0;
      ypos += 32.0;
     }
     msgalpha = 0.834; msgalpha = FixedMul(msgalpha,overallhudalpha);
     // [236] Shows "ManaDifference" in the new HUD for Player's "Damage/Healing" bursts.
     // [237] Shows "ManaDiffRatio" in the new HUD for Player's "Damage/Healing" bursts.
     // [238] Shows "NewManaValue" in the new HUD for the Player's "Damage/Healing" bursts. 
     // MP/Mana Damage/Heal
     if (MiscellaneousVars[236] != 0)
     {
       if (MiscellaneousVars[236] > 0) // Positive Value
       {
        if (MiscellaneousVars[237] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[238] >= CurrentMaxArmor) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[236],s:" (",d:MiscellaneousVars[237],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_lightblue,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[236];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_lightblue,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        SetFont("BBURMPHL");
        yposmod = 0.0; // 1.0
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[236] < 0) // Negative Value
       {
        MiscellaneousVars[236] *= -1;
        MiscellaneousVars[237] *= -1;
        if (MiscellaneousVars[237] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[238] <= 0) { PopupHoldDuration += 0.75; PopupFadeOutDuration += 0.5; } 
        xpos += 32.0;
        ypos += 32.0;
        SetFont("DQGDMNMED"); // DQHUDFONT 
        yposmod = 0.0; // 9.0
        if (GetCVar("dvdsnewhud_damageburstsratios") == 1)
        {
         HudMessage(d:MiscellaneousVars[236],s:" (",d:MiscellaneousVars[237],s:"%)";
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }
        else
        {
         HudMessage(d:MiscellaneousVars[236];
         HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,xpos+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
        }

        // Damage/Heal Cloud/Bursts
        if (MiscellaneousVars[238] <= 0) // Mana Depleted Fully
        {
         SetFont("BBURMPCT");
         xposmod = 20.0; // 20.0 [large], 8.0 [small]
         yposmod = 10.0; // 10.0 [large], 6.0 [small]
        }
        else // Damage w/o Mana Depletion
        {
         SetFont("BBURMPDM");
         xposmod = 2.0; // 0.0
         yposmod = 0.0; // 1.0
        }
        HudMessage(s:"A";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_untranslated,xpos+xposmod+PopUpXPlacement,ypos+yposmod+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
     }
    }

    //*************
    //**Left Side**
    //*************
     ScreenXOffset = GetCVar("dvdsnewhud_widescreenxoffset") * -1.0;
 
     //*************************************
     //**"Boss" Lifemeter [16211 to 16622]**
     //*************************************
	// 16213 - Boss HP Label 
	// 16214 - Boss HP Amounts, 
	// 16215 - Boss HP Meter Border, 
	// 16217-16617 - Boss Meter Notches 
	// 16620 - Boss HP Meter Glass 
	// 16621 - Boss Name
	// 16622 - Boss Portrait
     MiscellaneousVars[2027] = 0;
     G1 = GetActorProperty(1124,APROP_Health);
     if (G1 > 0) { MiscellaneousVars[2027] = 1124; } // Check for a Sauravatar first
     else
     {
      G1 = GetActorProperty(1123,APROP_Health);
      if (G1 > 0) { MiscellaneousVars[2027] = 1123; } // Check for a Sauron's Eye [Main] second
      else
      {
       G1 = GetActorProperty(1222,APROP_Health); // use tag 1222 for custom "bosses"
       if (G1 > 0) { MiscellaneousVars[2027] = 1222; } // Check for custom bosses third if neither of the above exists
      }
     }

     SetActivator(0);
     if (MiscellaneousVars[2027] > 0)
     {     
      SetActivator(MiscellaneousVars[2027]);
      if (IsPointerEqual(AAPTR_TARGET, AAPTR_NULL) == FALSE)
      {
       SetActivator(0);
       G3 = GetActorProperty(MiscellaneousVars[2027],APROP_Health); // Current Health for Boss
       G2 = GetUserVariable(MiscellaneousVars[2027],"user_MaxHP"); // Max Health for Boss
       if (G2 > 0)
       {
        // Boss "HP" Label
        xpos = ScreenXOffset + 168.0; // 168.0;
        ypos = 92.0; // 92.0;
		msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("DQHUDFONTSML");
        HudMessage(s:"HP";HUDMSG_ALPHA,16213,cr_orange,xpos,ypos,HUDMsgDelayFixed,msgalpha);

        // Boss HP Amounts
        // HPInterpolationDisplay;
        xpos = ScreenXOffset + 371.0; // 371.0;
        ypos = 96.0; // 96.0;
		msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("DQHUDFONTSML");
        HudMessage(d:G3,s:"/",d:G2;HUDMSG_ALPHA,16214,cr_orange,xpos,ypos,HUDMsgDelayFixed,msgalpha);

        // Boss Meter Border
        xpos = ScreenXOffset + 369.0;
        ypos = 94.0;
		msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("BLMMFRAM");
        HudMessage(s:"A";HUDMSG_ALPHA,16215,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

        // Boss Meter Notches
        xpos = ScreenXOffset + 169.0; // 169.0
        ypos = 92.0; // 92.0

        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 400 / G10;
        G3 = GetActorProperty(MiscellaneousVars[2027],APROP_Health); // Current Health for Boss
        G2 = GetUserVariable(MiscellaneousVars[2027],"user_MaxHP"); // Max Health for Boss
        I1 = G3 * G9 / G2;
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
        if (G2 != 0)
        {
         // Normal
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
           if (G10 == 10) { SetFont("HPBFILNA"); G11 = -5.0; }
           if (G10 == 4) { SetFont("HPBFILN4"); G11 = -2.0; }
           if (G10 == 2) { SetFont("HPBFILN2"); G11 = -1.0; }
           if (G10 == 1) { SetFont("HPBFILNR"); G11 = 1.0; }
          }
          else SetFont("BARNOFIL");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+16217,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
        }
  
        // Boss Meter Glass
        xpos = ScreenXOffset + 369.0;
        ypos = 94.0;
        SetFont("BLMMGLAS");
		msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,16620,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
        // Boss Name
        xpos = ScreenXOffset + 169.0 + 0.1; // 169.1
        if (xpos < 0.0) xpos -= 0.2;
        ypos = 60.0; // 60.0
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("BLMNNORM");
        if (MiscellaneousVars[2027] == 1123) SetFont("BLMNSAEY");
        if (MiscellaneousVars[2027] == 1124) SetFont("BLMNSAAV");
        HudMessage(s:"A";HUDMSG_ALPHA,16621,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

        // Boss Portrait
        xpos = ScreenXOffset + 126.0; // 126.0
        ypos = 75.0; // 75.0
        SetFont("BLMPNORM");
        if (MiscellaneousVars[2027] == 1123) SetFont("BLMPSAEY");
        if (MiscellaneousVars[2027] == 1124) SetFont("BLMPSAAV");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,16622,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
     }
     SetActivator(0);



     //**************************
     //**"LEVEL UP" Icon [7796]**
     //**************************
	 // 7796 - Level Up Icon 
	 // 7797-7820 - Character Portrait Pieces
	 // 7854-7864 - QuickSpell Text Costs, 
	 // 7865-7875 - QuickSpell Bind Key Display
	 // 7876-7886 - Not Enough Mana Icons
	 // 7887-7897 - QuickSpell Icons
	 // 7898 - QuickSpell Box Style
	 tempvar1 = 172;
     if (MiscellaneousVars[171] > 0) // Level up timer
     {
       xpos = ScreenXOffset + 240.0; // 240.0
       ypos = 576.0; // 640.0
       msgalpha = 0.975;
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.975;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.96;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.945;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.93;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.915;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.90;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.885;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.87;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.855;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.84;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.825;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.81;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.795;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.78;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.765;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.735;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] = 1;
	   msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("LEVELUP");
       HudMessage(s:"A";HUDMSG_ALPHA,7796,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     else { msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha); MiscellaneousVars[tempvar1] = 0; }
    
     //**********************************
     //**Character Portrait [7797-7824]**
     //**********************************
	 xpos = ScreenXOffset + 200.0; // 200.0
	 ypos = 814.0; // 814.0;


     // Blindness Overlay [7797]
	 int blindnessframe;
	 MiscellaneousVars[458]++;
	 if (MiscellaneousVars[458] >= 15) MiscellaneousVars[458] = 0;
	 if (MiscellaneousVars[458] >= 0 & MiscellaneousVars[458] <= 2) blindnessframe = 1;
	 if (MiscellaneousVars[458] >= 3 & MiscellaneousVars[458] <= 5) blindnessframe = 2;
	 if (MiscellaneousVars[458] >= 6 & MiscellaneousVars[458] <= 8) blindnessframe = 3;
	 if (MiscellaneousVars[458] >= 9 & MiscellaneousVars[458] <= 11) blindnessframe = 4;
	 if (MiscellaneousVars[458] >= 12 & MiscellaneousVars[458] <= 14) blindnessframe = 5;
	 if (PowerupTimer[19] > 0 && GetActorProperty(Player1TID,APROP_HEALTH) > 0) 
	 {
	  if (PowerupTimer[7] > 0) 
	  {
	   if (blindnessframe == 1) SetFont("PF2BLND1");
	   if (blindnessframe == 2) SetFont("PF2BLND2"); 
	   if (blindnessframe == 3) SetFont("PF2BLND3");
	   if (blindnessframe == 4) SetFont("PF2BLND4");
	   if (blindnessframe == 5) SetFont("PF2BLND5");
	  }
	  else
	  {
	   if (blindnessframe == 1) SetFont("PF1BLND1");
	   if (blindnessframe == 2) SetFont("PF1BLND2"); 
	   if (blindnessframe == 3) SetFont("PF1BLND3");
	   if (blindnessframe == 4) SetFont("PF1BLND4");
	   if (blindnessframe == 5) SetFont("PF1BLND5");
	  }
	  msgalpha = 1.0;
	  //if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7797,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 // Buff Overlays (6) [Divine Avatar Aura] [7798]
	 SetFont("PBLKIMG");
	 int divineavatarframe;
	 MiscellaneousVars[456]++;
	 if (MiscellaneousVars[456] >= 30) MiscellaneousVars[456] = 0;
	 if (MiscellaneousVars[456] >= 0 & MiscellaneousVars[456] <= 2) divineavatarframe = 1;
	 if (MiscellaneousVars[456] >= 3 & MiscellaneousVars[456] <= 5) divineavatarframe = 2;
	 if (MiscellaneousVars[456] >= 6 & MiscellaneousVars[456] <= 8) divineavatarframe = 3;
	 if (MiscellaneousVars[456] >= 9 & MiscellaneousVars[456] <= 11) divineavatarframe = 4;
	 if (MiscellaneousVars[456] >= 12 & MiscellaneousVars[456] <= 14) divineavatarframe = 5;
	 if (MiscellaneousVars[456] >= 15 & MiscellaneousVars[456] <= 17) divineavatarframe = 6;
	 if (MiscellaneousVars[456] >= 18 & MiscellaneousVars[456] <= 20) divineavatarframe = 5;
	 if (MiscellaneousVars[456] >= 21 & MiscellaneousVars[456] <= 23) divineavatarframe = 4;
	 if (MiscellaneousVars[456] >= 24 & MiscellaneousVars[456] <= 26) divineavatarframe = 3;
	 if (MiscellaneousVars[456] >= 27 & MiscellaneousVars[456] <= 29) divineavatarframe = 2;
	 if (PowerupTimer[7] > 0 && GetActorProperty(Player1TID,APROP_HEALTH) > 0) 
	 {
 	  if (CharacterClass == 0)
	  {
	   if (divineavatarframe == 1) SetFont("PD2DVAV1");
	   if (divineavatarframe == 2) SetFont("PD2DVAV2");
	   if (divineavatarframe == 3) SetFont("PD2DVAV3");
	   if (divineavatarframe == 4) SetFont("PD2DVAV4");
	   if (divineavatarframe == 5) SetFont("PD2DVAV5");
	   if (divineavatarframe == 6) SetFont("PD2DVAV6");
	  }
 	  if (CharacterClass == 1)
	  {
	   if (divineavatarframe == 1) SetFont("PI2DVAV1");
	   if (divineavatarframe == 2) SetFont("PI2DVAV2");
	   if (divineavatarframe == 3) SetFont("PI2DVAV3");
	   if (divineavatarframe == 4) SetFont("PI2DVAV4");
	   if (divineavatarframe == 5) SetFont("PI2DVAV5");
	   if (divineavatarframe == 6) SetFont("PI2DVAV6");
	  }
 	  if (CharacterClass == 2)
	  {
	   if (divineavatarframe == 1) SetFont("PF2DVAV1");
	   if (divineavatarframe == 2) SetFont("PF2DVAV2");
	   if (divineavatarframe == 3) SetFont("PF2DVAV3");
	   if (divineavatarframe == 4) SetFont("PF2DVAV4");
	   if (divineavatarframe == 5) SetFont("PF2DVAV5");
	   if (divineavatarframe == 6) SetFont("PF2DVAV6");
	  }
 	  if (CharacterClass == 8)
	  {
	   if (divineavatarframe == 1) SetFont("PA2DVAV1");
	   if (divineavatarframe == 2) SetFont("PA2DVAV2");
	   if (divineavatarframe == 3) SetFont("PA2DVAV3");
	   if (divineavatarframe == 4) SetFont("PA2DVAV4");
	   if (divineavatarframe == 5) SetFont("PA2DVAV5");
	   if (divineavatarframe == 6) SetFont("PA2DVAV6");
	  }
 	  if (CharacterClass == 9)
	  {
	   if (divineavatarframe == 1) SetFont("PP2DVAV1");
	   if (divineavatarframe == 2) SetFont("PP2DVAV2");
	   if (divineavatarframe == 3) SetFont("PP2DVAV3");
	   if (divineavatarframe == 4) SetFont("PP2DVAV4");
	   if (divineavatarframe == 5) SetFont("PP2DVAV5");
	   if (divineavatarframe == 6) SetFont("PP2DVAV6");
	  }
 	  msgalpha = 1.0;
 	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
 	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7798,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }	 

	 // Buff Overlays (5) [Curse] [7799-7800]
     if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
     {
 	  MiscellaneousVars[448]++; // Curse Overall Transperancy/Alpha
      if (MiscellaneousVars[448] == 1 || MiscellaneousVars[448] == 35) msgalpha = 0.875;
      if (MiscellaneousVars[448] == 2 || MiscellaneousVars[448] == 34) msgalpha = 0.864; // -0.011
      if (MiscellaneousVars[448] == 3 || MiscellaneousVars[448] == 33) msgalpha = 0.853;
      if (MiscellaneousVars[448] == 4 || MiscellaneousVars[448] == 32) msgalpha = 0.842;
      if (MiscellaneousVars[448] == 5 || MiscellaneousVars[448] == 31) msgalpha = 0.831;
      if (MiscellaneousVars[448] == 6 || MiscellaneousVars[448] == 30) msgalpha = 0.820;
      if (MiscellaneousVars[448] == 7 || MiscellaneousVars[448] == 29) msgalpha = 0.809;
      if (MiscellaneousVars[448] == 8 || MiscellaneousVars[448] == 28) msgalpha = 0.798;
      if (MiscellaneousVars[448] == 9 || MiscellaneousVars[448] == 27) msgalpha = 0.787;
      if (MiscellaneousVars[448] == 10 || MiscellaneousVars[448] == 26) msgalpha = 0.776;
      if (MiscellaneousVars[448] == 11 || MiscellaneousVars[448] == 25) msgalpha = 0.765;
      if (MiscellaneousVars[448] == 12 || MiscellaneousVars[448] == 24) msgalpha = 0.754;
      if (MiscellaneousVars[448] == 13 || MiscellaneousVars[448] == 23) msgalpha = 0.743;
      if (MiscellaneousVars[448] == 14 || MiscellaneousVars[448] == 22) msgalpha = 0.732;
      if (MiscellaneousVars[448] == 15 || MiscellaneousVars[448] == 21) msgalpha = 0.721;
      if (MiscellaneousVars[448] == 16 || MiscellaneousVars[448] == 20) msgalpha = 0.710;
      if (MiscellaneousVars[448] == 17 || MiscellaneousVars[448] == 19) msgalpha = 0.699;
      if (MiscellaneousVars[448] == 18) msgalpha = 0.688; // -0.187
 	  if (MiscellaneousVars[448] >= 35) MiscellaneousVars[448] -= 34;
	 
	  int curseoutlineframe;
	  MiscellaneousVars[449]++;
	  if (MiscellaneousVars[449] >= 0 & MiscellaneousVars[449] <= 1) curseoutlineframe = 1;
	  if (MiscellaneousVars[449] >= 2 & MiscellaneousVars[449] <= 3 || MiscellaneousVars[449] >= 38 & MiscellaneousVars[449] <= 39) curseoutlineframe = 2;
	  if (MiscellaneousVars[449] >= 4 & MiscellaneousVars[449] <= 5 || MiscellaneousVars[449] >= 36 & MiscellaneousVars[449] <= 37) curseoutlineframe = 3;
	  if (MiscellaneousVars[449] >= 6 & MiscellaneousVars[449] <= 7 || MiscellaneousVars[449] >= 34 & MiscellaneousVars[449] <= 35) curseoutlineframe = 4;
	  if (MiscellaneousVars[449] >= 8 & MiscellaneousVars[449] <= 9 || MiscellaneousVars[449] >= 32 & MiscellaneousVars[449] <= 33) curseoutlineframe = 5;
	  if (MiscellaneousVars[449] >= 10 & MiscellaneousVars[449] <= 11 || MiscellaneousVars[449] >= 30 & MiscellaneousVars[449] <= 31) curseoutlineframe = 6;
	  if (MiscellaneousVars[449] >= 12 & MiscellaneousVars[449] <= 13 || MiscellaneousVars[449] >= 28 & MiscellaneousVars[449] <= 29) curseoutlineframe = 7;
	  if (MiscellaneousVars[449] >= 14 & MiscellaneousVars[449] <= 15 || MiscellaneousVars[449] >= 26 & MiscellaneousVars[449] <= 27) curseoutlineframe = 8;
	  if (MiscellaneousVars[449] >= 16 & MiscellaneousVars[449] <= 17 || MiscellaneousVars[449] >= 24 & MiscellaneousVars[449] <= 25) curseoutlineframe = 9;
	  if (MiscellaneousVars[449] >= 18 & MiscellaneousVars[449] <= 19 || MiscellaneousVars[449] >= 22 & MiscellaneousVars[449] <= 23) curseoutlineframe = 10;
	  if (MiscellaneousVars[449] >= 20 & MiscellaneousVars[449] <= 21) curseoutlineframe = 11;
	  if (MiscellaneousVars[449] >= 40) MiscellaneousVars[449] = 0;
 	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (curseoutlineframe == 1) SetFont("PF2CROL1");
	    if (curseoutlineframe == 2) SetFont("PF2CROL2"); 
	    if (curseoutlineframe == 3) SetFont("PF2CROL3");
	    if (curseoutlineframe == 4) SetFont("PF2CROL4");
	    if (curseoutlineframe == 5) SetFont("PF2CROL5");
	    if (curseoutlineframe == 6) SetFont("PF2CROL6");
	    if (curseoutlineframe == 7) SetFont("PF2CROL7");
	    if (curseoutlineframe == 8) SetFont("PF2CROL8");
	    if (curseoutlineframe == 9) SetFont("PF2CROL9");
	    if (curseoutlineframe == 10) SetFont("PF2CROLA");
	    if (curseoutlineframe == 11) SetFont("PF2CROLB");
       }
	   else
	   {
	    if (curseoutlineframe == 1) SetFont("PF1CROL1");
	    if (curseoutlineframe == 2) SetFont("PF1CROL2"); 
	    if (curseoutlineframe == 3) SetFont("PF1CROL3");
	    if (curseoutlineframe == 4) SetFont("PF1CROL4");
	    if (curseoutlineframe == 5) SetFont("PF1CROL5");
	    if (curseoutlineframe == 6) SetFont("PF1CROL6");
	    if (curseoutlineframe == 7) SetFont("PF1CROL7");
	    if (curseoutlineframe == 8) SetFont("PF1CROL8");
	    if (curseoutlineframe == 9) SetFont("PF1CROL9");
	    if (curseoutlineframe == 10) SetFont("PF1CROLA");
	    if (curseoutlineframe == 11) SetFont("PF1CROLB");
       }
	  }
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,1.25);
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7799,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	  int curseoverlayframe;
	  MiscellaneousVars[450]++;
	  if (MiscellaneousVars[450] >= 0 & MiscellaneousVars[450] <= 2) curseoverlayframe = 1;
	  if (MiscellaneousVars[450] >= 3 & MiscellaneousVars[450] <= 5 || MiscellaneousVars[450] >= 57 & MiscellaneousVars[450] <= 59) curseoverlayframe = 2;
	  if (MiscellaneousVars[450] >= 6 & MiscellaneousVars[450] <= 8 || MiscellaneousVars[450] >= 54 & MiscellaneousVars[450] <= 56) curseoverlayframe = 3;
	  if (MiscellaneousVars[450] >= 9 & MiscellaneousVars[450] <= 11 || MiscellaneousVars[450] >= 51 & MiscellaneousVars[450] <= 53) curseoverlayframe = 4;
	  if (MiscellaneousVars[450] >= 12 & MiscellaneousVars[450] <= 14 || MiscellaneousVars[450] >= 48 & MiscellaneousVars[450] <= 50) curseoverlayframe = 5;
	  if (MiscellaneousVars[450] >= 15 & MiscellaneousVars[450] <= 17 || MiscellaneousVars[450] >= 45 & MiscellaneousVars[450] <= 47) curseoverlayframe = 6;
	  if (MiscellaneousVars[450] >= 18 & MiscellaneousVars[450] <= 20 || MiscellaneousVars[450] >= 42 & MiscellaneousVars[450] <= 44) curseoverlayframe = 7;
	  if (MiscellaneousVars[450] >= 21 & MiscellaneousVars[450] <= 23 || MiscellaneousVars[450] >= 39 & MiscellaneousVars[450] <= 41) curseoverlayframe = 8;
	  if (MiscellaneousVars[450] >= 24 & MiscellaneousVars[450] <= 26 || MiscellaneousVars[450] >= 36 & MiscellaneousVars[450] <= 38) curseoverlayframe = 9;
	  if (MiscellaneousVars[450] >= 27 & MiscellaneousVars[450] <= 29 || MiscellaneousVars[450] >= 33 & MiscellaneousVars[450] <= 35) curseoverlayframe = 10;
	  if (MiscellaneousVars[450] >= 30 & MiscellaneousVars[450] <= 32) curseoverlayframe = 11;
	  if (MiscellaneousVars[450] >= 60) MiscellaneousVars[450] = 0;

 	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (curseoverlayframe == 1) SetFont("PF2CROV1");
	    if (curseoverlayframe == 2) SetFont("PF2CROV2"); 
	    if (curseoverlayframe == 3) SetFont("PF2CROV3");
	    if (curseoverlayframe == 4) SetFont("PF2CROV4");
	    if (curseoverlayframe == 5) SetFont("PF2CROV5");
	    if (curseoverlayframe == 6) SetFont("PF2CROV6");
	    if (curseoverlayframe == 7) SetFont("PF2CROV7");
	    if (curseoverlayframe == 8) SetFont("PF2CROV8");
	    if (curseoverlayframe == 9) SetFont("PF2CROV9");
	    if (curseoverlayframe == 10) SetFont("PF2CROVA");
	    if (curseoverlayframe == 11) SetFont("PF2CROVB");
       }
	   else
	   {
	    if (curseoverlayframe == 1) SetFont("PF1CROV1");
	    if (curseoverlayframe == 2) SetFont("PF1CROV2"); 
	    if (curseoverlayframe == 3) SetFont("PF1CROV3");
	    if (curseoverlayframe == 4) SetFont("PF1CROV4");
	    if (curseoverlayframe == 5) SetFont("PF1CROV5");
	    if (curseoverlayframe == 6) SetFont("PF1CROV6");
	    if (curseoverlayframe == 7) SetFont("PF1CROV7");
	    if (curseoverlayframe == 8) SetFont("PF1CROV8");
	    if (curseoverlayframe == 9) SetFont("PF1CROV9");
	    if (curseoverlayframe == 10) SetFont("PF1CROVA");
	    if (curseoverlayframe == 11) SetFont("PF1CROVB");
       }
	  }
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,1.25);
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7800,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 // Buff Overlays (4) [Poison Aura] [7801]
	 SetFont("PBLKIMG");
	 int poisonoverlayframe;
	 MiscellaneousVars[451]++; // Buff Overlay Timer 1 [Overlay Frame]
	 if (MiscellaneousVars[451] >= 0 & MiscellaneousVars[451] <= 3) poisonoverlayframe = 0;
	 if (MiscellaneousVars[451] >= 4 & MiscellaneousVars[451] <= 7) poisonoverlayframe = 1;
	 if (MiscellaneousVars[451] >= 8 & MiscellaneousVars[451] <= 11) poisonoverlayframe = 2;
	 if (MiscellaneousVars[451] >= 12 & MiscellaneousVars[451] <= 15) poisonoverlayframe = 3;
	 if (MiscellaneousVars[451] >= 16 & MiscellaneousVars[451] <= 19) poisonoverlayframe = 4;
	 if (MiscellaneousVars[451] >= 20 & MiscellaneousVars[451] <= 23) poisonoverlayframe = 5;
	 if (MiscellaneousVars[451] >= 24 & MiscellaneousVars[451] <= 27) poisonoverlayframe = 6;
	 if (MiscellaneousVars[451] >= 28 & MiscellaneousVars[451] <= 31) poisonoverlayframe = 7;
	 if (MiscellaneousVars[451] >= 32 & MiscellaneousVars[451] <= 35) poisonoverlayframe = 8;
	 if (MiscellaneousVars[451] >= 36 & MiscellaneousVars[451] <= 39) poisonoverlayframe = 9;
	 if (MiscellaneousVars[451] >= 40) MiscellaneousVars[451] -= 40;
     if (PowerupTimer[16] > 0 && GetActorProperty(Player1TID,APROP_HEALTH) > 0)
	 {
 	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   { 
	    if (poisonoverlayframe == 0) SetFont("PF2POIS0");
	    if (poisonoverlayframe == 1) SetFont("PF2POIS1");
	    if (poisonoverlayframe == 2) SetFont("PF2POIS2");
	    if (poisonoverlayframe == 3) SetFont("PF2POIS3");
	    if (poisonoverlayframe == 4) SetFont("PF2POIS4");
	    if (poisonoverlayframe == 5) SetFont("PF2POIS5");
	    if (poisonoverlayframe == 6) SetFont("PF2POIS6");
	    if (poisonoverlayframe == 7) SetFont("PF2POIS7");
	    if (poisonoverlayframe == 8) SetFont("PF2POIS8");
	    if (poisonoverlayframe == 9) SetFont("PF2POIS9");
	   }
	   else
	   { 
	    if (poisonoverlayframe == 0) SetFont("PF1POIS0");
	    if (poisonoverlayframe == 1) SetFont("PF1POIS1");
	    if (poisonoverlayframe == 2) SetFont("PF1POIS2");
	    if (poisonoverlayframe == 3) SetFont("PF1POIS3");
	    if (poisonoverlayframe == 4) SetFont("PF1POIS4");
	    if (poisonoverlayframe == 5) SetFont("PF1POIS5");
	    if (poisonoverlayframe == 6) SetFont("PF1POIS6");
	    if (poisonoverlayframe == 7) SetFont("PF1POIS7");
	    if (poisonoverlayframe == 8) SetFont("PF1POIS8");
	    if (poisonoverlayframe == 9) SetFont("PF1POIS9");
	   }
	  }

	  msgalpha = 1.0;
	  MiscellaneousVars[452]++; // Buff Overlay Timer 2 [Overlay Alpha]
      if (MiscellaneousVars[452] == 1 || MiscellaneousVars[452] == 35) msgalpha = 0.875;
      if (MiscellaneousVars[452] == 2 || MiscellaneousVars[452] == 34) msgalpha = 0.853;
      if (MiscellaneousVars[452] == 3 || MiscellaneousVars[452] == 33) msgalpha = 0.831;
      if (MiscellaneousVars[452] == 4 || MiscellaneousVars[452] == 32) msgalpha = 0.809;
      if (MiscellaneousVars[452] == 5 || MiscellaneousVars[452] == 31) msgalpha = 0.787;
      if (MiscellaneousVars[452] == 6 || MiscellaneousVars[452] == 30) msgalpha = 0.765;
      if (MiscellaneousVars[452] == 7 || MiscellaneousVars[452] == 29) msgalpha = 0.743;
      if (MiscellaneousVars[452] == 8 || MiscellaneousVars[452] == 28) msgalpha = 0.721;
      if (MiscellaneousVars[452] == 9 || MiscellaneousVars[452] == 27) msgalpha = 0.699;
      if (MiscellaneousVars[452] == 10 || MiscellaneousVars[452] == 26) msgalpha = 0.677;
      if (MiscellaneousVars[452] == 11 || MiscellaneousVars[452] == 25) msgalpha = 0.655;
      if (MiscellaneousVars[452] == 12 || MiscellaneousVars[452] == 24) msgalpha = 0.633;
      if (MiscellaneousVars[452] == 13 || MiscellaneousVars[452] == 23) msgalpha = 0.611;
      if (MiscellaneousVars[452] == 14 || MiscellaneousVars[452] == 22) msgalpha = 0.589;
      if (MiscellaneousVars[452] == 15 || MiscellaneousVars[452] == 21) msgalpha = 0.567;
      if (MiscellaneousVars[452] == 16 || MiscellaneousVars[452] == 20) msgalpha = 0.545;
      if (MiscellaneousVars[452] == 17 || MiscellaneousVars[452] == 19) msgalpha = 0.523;
      if (MiscellaneousVars[452] == 18) msgalpha = 0.501;
	  if (MiscellaneousVars[452] >= 35) MiscellaneousVars[452] -= 34;
	  msgalpha += 0.00; 
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7801,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
	 
	 // Buff Overlays (1) [Fear Aura] [7802]
	 int fearauraframe = 0;
	 MiscellaneousVars[147]++; // Buff Overlay Timer 1 [Overlay Frame]
	 if (MiscellaneousVars[147] >= 20) MiscellaneousVars[147] -= 20;
	 if (MiscellaneousVars[147] == 0) fearauraframe = 0;
	 if (MiscellaneousVars[147] == 1) fearauraframe = 0;
	 if (MiscellaneousVars[147] == 2 || MiscellaneousVars[147] == 19) fearauraframe = 1;
	 if (MiscellaneousVars[147] == 3 || MiscellaneousVars[147] == 18) fearauraframe = 1;
	 if (MiscellaneousVars[147] == 4 || MiscellaneousVars[147] == 17) fearauraframe = 2;
	 if (MiscellaneousVars[147] == 5 || MiscellaneousVars[147] == 16) fearauraframe = 2;
	 if (MiscellaneousVars[147] == 6 || MiscellaneousVars[147] == 15) fearauraframe = 3;
	 if (MiscellaneousVars[147] == 7 || MiscellaneousVars[147] == 14) fearauraframe = 3;
	 if (MiscellaneousVars[147] == 8 || MiscellaneousVars[147] == 13) fearauraframe = 4;
	 if (MiscellaneousVars[147] == 9 || MiscellaneousVars[147] == 12) fearauraframe = 4;
	 if (MiscellaneousVars[147] == 10) fearauraframe = 5;
	 if (MiscellaneousVars[147] == 11) fearauraframe = 5;
	 SetFont("PBLKIMG");
	 if (PowerupTimer[6] > 0 && GetActorProperty(Player1TID,APROP_HEALTH) > 0)
	 {
 	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (fearauraframe == 0) SetFont("PF2FRAR0");
	    if (fearauraframe == 1) SetFont("PF2FRAR1"); 
	    if (fearauraframe == 2) SetFont("PF2FRAR2");
	    if (fearauraframe == 3) SetFont("PF2FRAR3");
	    if (fearauraframe == 4) SetFont("PF2FRAR4");
	    if (fearauraframe == 5) SetFont("PF2FRAR5");
       }
	   else
	   {
	    if (fearauraframe == 0) SetFont("PF1FRAR0");
	    if (fearauraframe == 1) SetFont("PF1FRAR1"); 
	    if (fearauraframe == 2) SetFont("PF1FRAR2");
	    if (fearauraframe == 3) SetFont("PF1FRAR3");
	    if (fearauraframe == 4) SetFont("PF1FRAR4");
	    if (fearauraframe == 5) SetFont("PF1FRAR5");
       }
      }	   
	  msgalpha = 1.0;
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7802,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 // Buff Overlays (2) [ATK/DEF/SPD Up/Down] [7803]
	 MiscellaneousVars[138]++; // Buff Overlay Timer 3 [Overlay Type]
	 if (MiscellaneousVars[138] >= 120) MiscellaneousVars[138] -= 120;

	 int bufftypebitfield = 0;
	 if (PowerupTimer[10] > 0 || PowerupTimer[13] > 0) bufftypebitfield += 1;
	 if (PowerupTimer[11] > 0 || PowerupTimer[14] > 0) bufftypebitfield += 2;
	 if (PowerupTimer[12] > 0 || PowerupTimer[15] > 0) bufftypebitfield += 4;

	 if (bufftypebitfield == 1) // ATK
	 {
	  if (PowerupTimer[10] > 0 && PowerupTimer[13] > 0)
	  {
	   if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 0;
	   if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 3;
	  }
	  else
	  {
	   if (PowerupTimer[10] > 0) MiscellaneousVars[139] = 0;
	   if (PowerupTimer[13] > 0) MiscellaneousVars[139] = 3;
	  }
	 }

	 if (bufftypebitfield == 2) // DEF
	 {
	  if (PowerupTimer[11] > 0 && PowerupTimer[14] > 0)
	  {
	   if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 1;
	   if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 4;
	  }
	  else
	  {
	   if (PowerupTimer[11] > 0) MiscellaneousVars[139] = 1;
	   if (PowerupTimer[14] > 0) MiscellaneousVars[139] = 4;
	  }
	 }

	 if (bufftypebitfield == 4) // SPD
	 {
	  if (PowerupTimer[12] > 0 && PowerupTimer[15] > 0)
	  {
	   if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 2;
	   if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 5;
	  }
	  else
	  {
	   if (PowerupTimer[12] > 0) MiscellaneousVars[139] = 2;
	   if (PowerupTimer[15] > 0) MiscellaneousVars[139] = 5;
	  }
	 }

	 if (bufftypebitfield == 3) // ATK/DEF
	 {
	  if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59)
	  {
	   if (PowerupTimer[10] > 0 && PowerupTimer[13] > 0)
	   {
	    if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 29) MiscellaneousVars[139] = 0;
	    if (MiscellaneousVars[138] >= 30 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 3;
	   }
	   else
	   {
	    if (PowerupTimer[10] > 0) MiscellaneousVars[139] = 0;
	    if (PowerupTimer[13] > 0) MiscellaneousVars[139] = 3;
	   }
	  }
	  if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119)
	  {
	   if (PowerupTimer[11] > 0 && PowerupTimer[14] > 0)
	   {
	    if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 89) MiscellaneousVars[139] = 1;
	    if (MiscellaneousVars[138] >= 90 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 4;
	   }
	   else
	   {
	    if (PowerupTimer[11] > 0) MiscellaneousVars[139] = 1;
	    if (PowerupTimer[14] > 0) MiscellaneousVars[139] = 4;
	   }
	  }
	 }

	 if (bufftypebitfield == 5) // ATK/SPD
	 {
	  if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59)
	  {
	   if (PowerupTimer[10] > 0 && PowerupTimer[13] > 0)
	   {
	    if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 29) MiscellaneousVars[139] = 0;
	    if (MiscellaneousVars[138] >= 30 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 3;
	   }
	   else
	   {
	    if (PowerupTimer[10] > 0) MiscellaneousVars[139] = 0;
	    if (PowerupTimer[13] > 0) MiscellaneousVars[139] = 3;
	   }
	  }
	  if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119)
	  {
	   if (PowerupTimer[12] > 0 && PowerupTimer[15] > 0)
	   {
	    if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 89) MiscellaneousVars[139] = 2;
	    if (MiscellaneousVars[138] >= 90 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 5;
	   }
	   else
	   {
	    if (PowerupTimer[12] > 0) MiscellaneousVars[139] = 2;
	    if (PowerupTimer[15] > 0) MiscellaneousVars[139] = 5;
	   }
	  }
	 }

	 if (bufftypebitfield == 6) // DEF/SPD
	 {
	  if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 59)
	  {
	   if (PowerupTimer[11] > 0 && PowerupTimer[14] > 0)
	   {
	    if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 29) MiscellaneousVars[139] = 1;
	    if (MiscellaneousVars[138] >= 30 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 4;
	   }
	   else
	   {
	    if (PowerupTimer[11] > 0) MiscellaneousVars[139] = 1;
	    if (PowerupTimer[14] > 0) MiscellaneousVars[139] = 4;
	   }
	  }
	  if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 119)
	  {
	   if (PowerupTimer[12] > 0 && PowerupTimer[15] > 0)
	   {
	    if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 89) MiscellaneousVars[139] = 2;
	    if (MiscellaneousVars[138] >= 90 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 5;
	   }
	   else
	   {
	    if (PowerupTimer[12] > 0) MiscellaneousVars[139] = 2;
	    if (PowerupTimer[15] > 0) MiscellaneousVars[139] = 5;
	   }
	  }
	 }

	 if (bufftypebitfield == 7) // ATK/DEF/SPD
	 {
	  if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 39)
	  {
	   if (PowerupTimer[10] > 0 && PowerupTimer[13] > 0)
	   {
	    if (MiscellaneousVars[138] >= 0 && MiscellaneousVars[138] <= 19) MiscellaneousVars[139] = 0;
	    if (MiscellaneousVars[138] >= 20 && MiscellaneousVars[138] <= 39) MiscellaneousVars[139] = 3;
	   }
	   else
	   {
	    if (PowerupTimer[10] > 0) MiscellaneousVars[139] = 0;
	    if (PowerupTimer[13] > 0) MiscellaneousVars[139] = 3;
	   }
	  }
	  if (MiscellaneousVars[138] >= 40 && MiscellaneousVars[138] <= 79)
	  {
	   if (PowerupTimer[11] > 0 && PowerupTimer[14] > 0)
	   {
	    if (MiscellaneousVars[138] >= 40 && MiscellaneousVars[138] <= 59) MiscellaneousVars[139] = 1;
	    if (MiscellaneousVars[138] >= 60 && MiscellaneousVars[138] <= 79) MiscellaneousVars[139] = 4;
	   }
	   else
	   {
	    if (PowerupTimer[11] > 0) MiscellaneousVars[139] = 1;
	    if (PowerupTimer[14] > 0) MiscellaneousVars[139] = 4;
	   }
	  }
	  if (MiscellaneousVars[138] >= 80 && MiscellaneousVars[138] <= 119)
	  {
	   if (PowerupTimer[12] > 0 && PowerupTimer[15] > 0)
	   {
	    if (MiscellaneousVars[138] >= 80 && MiscellaneousVars[138] <= 99) MiscellaneousVars[139] = 2;
	    if (MiscellaneousVars[138] >= 100 && MiscellaneousVars[138] <= 119) MiscellaneousVars[139] = 5;
	   }
	   else
	   {
	    if (PowerupTimer[12] > 0) MiscellaneousVars[139] = 2;
	    if (PowerupTimer[15] > 0) MiscellaneousVars[139] = 5;
	   }
	  }
	 }

     // Buff Overlays
	 SetFont("PBLKIMG");
	 int buffoverlayframe;
	 MiscellaneousVars[136]++; // Buff Overlay Timer 2 [Overlay Frame]
	 if (MiscellaneousVars[136] >= 0 & MiscellaneousVars[136] <= 1) buffoverlayframe = 0;
	 if (MiscellaneousVars[136] >= 2 & MiscellaneousVars[136] <= 3) buffoverlayframe = 1;
	 if (MiscellaneousVars[136] >= 4 & MiscellaneousVars[136] <= 5) buffoverlayframe = 2;
	 if (MiscellaneousVars[136] >= 6 & MiscellaneousVars[136] <= 7) buffoverlayframe = 3;
	 if (MiscellaneousVars[136] >= 8 & MiscellaneousVars[136] <= 9) buffoverlayframe = 4;
	 if (MiscellaneousVars[136] >= 10 & MiscellaneousVars[136] <= 11) buffoverlayframe = 5;
	 if (MiscellaneousVars[136] >= 12 & MiscellaneousVars[136] <= 13) buffoverlayframe = 6;
	 if (MiscellaneousVars[136] >= 14 & MiscellaneousVars[136] <= 15) buffoverlayframe = 7;
	 if (MiscellaneousVars[136] >= 16 & MiscellaneousVars[136] <= 17) buffoverlayframe = 8;
	 if (MiscellaneousVars[136] >= 18 & MiscellaneousVars[136] <= 19) buffoverlayframe = 9;
	 if (MiscellaneousVars[136] >= 20) MiscellaneousVars[136] -= 20;
     if (GetActorProperty(Player1TID,APROP_HEALTH) > 0)
	 {
 	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   { 
	    if (bufftypebitfield > 0)
	    {
	     if (buffoverlayframe == 0) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU0"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU0"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU0"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD0"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD0"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD0"); // Deceleratle
		 }
	     if (buffoverlayframe == 1) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU1"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU1"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU1"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD1"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD1"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD1"); // Deceleratle
		 }
	     if (buffoverlayframe == 2) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU2"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU2"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU2"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD2"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD2"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD2"); // Deceleratle
		 }
	     if (buffoverlayframe == 3) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU3"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU3"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU3"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD3"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD3"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD3"); // Deceleratle
		 }
	     if (buffoverlayframe == 4) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU4"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU4"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU4"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD4"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD4"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD4"); // Deceleratle
		 }
	     if (buffoverlayframe == 5) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU5"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU5"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU5"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD5"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD5"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD5"); // Deceleratle
		 }
	     if (buffoverlayframe == 6) 
		 {
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU6"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU6"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU6"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD6"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD6"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD6"); // Deceleratle
		 }
	     if (buffoverlayframe == 7) 
		  { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU7"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU7"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU7"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD7"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD7"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD7"); // Deceleratle
		 }
	     if (buffoverlayframe == 8) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU8"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU8"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU8"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD8"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD8"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD8"); // Deceleratle
		 }
	     if (buffoverlayframe == 9) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF2ATKU9"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF2DEFU9"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF2SPDU9"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF2ATKD9"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF2DEFD9"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF2SPDD9"); // Deceleratle
		 }
	    }
	   }
	   else
	   {
	    if (bufftypebitfield > 0)
	    {
	     if (buffoverlayframe == 0) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU0"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU0"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU0"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD0"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD0"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD0"); // Deceleratle
		 }
	     if (buffoverlayframe == 1) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU1"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU1"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU1"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD1"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD1"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD1"); // Deceleratle
		 }
	     if (buffoverlayframe == 2) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU2"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU2"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU2"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD2"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD2"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD2"); // Deceleratle
		 }
	     if (buffoverlayframe == 3) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU3"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU3"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU3"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD3"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD3"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD3"); // Deceleratle
		 }
	     if (buffoverlayframe == 4) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU4"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU4"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU4"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD4"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD4"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD4"); // Deceleratle
		 }
	     if (buffoverlayframe == 5) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU5"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU5"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU5"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD5"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD5"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD5"); // Deceleratle
		 }
	     if (buffoverlayframe == 6) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU6"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU6"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU6"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD6"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD6"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD6"); // Deceleratle
		 }
	     if (buffoverlayframe == 7) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU7"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU7"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU7"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD7"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD7"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD7"); // Deceleratle
		 }
	     if (buffoverlayframe == 8) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU8"); // Oomph
		  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU8"); // Buff
		  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU8"); // Acceleratle
		  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD8"); // Blunt
		  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD8"); // Sap
		  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD8"); // Deceleratle
		 }
	     if (buffoverlayframe == 9) 
		 { 
		  if (MiscellaneousVars[139] == 0) SetFont("PF1ATKU9"); // Oomph
	 	  if (MiscellaneousVars[139] == 1) SetFont("PF1DEFU9"); // Buff
	 	  if (MiscellaneousVars[139] == 2) SetFont("PF1SPDU9"); // Acceleratle
	 	  if (MiscellaneousVars[139] == 3) SetFont("PF1ATKD9"); // Blunt
	 	  if (MiscellaneousVars[139] == 4) SetFont("PF1DEFD9"); // Sap
	 	  if (MiscellaneousVars[139] == 5) SetFont("PF1SPDD9"); // Deceleratle
	 	 }
	    }
	   }
	  }
	 }

	 MiscellaneousVars[137]++; // Buff Overlay Timer 2 [Overlay Alpha]
     if (MiscellaneousVars[137] == 1 || MiscellaneousVars[137] == 35) msgalpha = 0.875;
     if (MiscellaneousVars[137] == 2 || MiscellaneousVars[137] == 34) msgalpha = 0.853;
     if (MiscellaneousVars[137] == 3 || MiscellaneousVars[137] == 33) msgalpha = 0.831;
     if (MiscellaneousVars[137] == 4 || MiscellaneousVars[137] == 32) msgalpha = 0.809;
     if (MiscellaneousVars[137] == 5 || MiscellaneousVars[137] == 31) msgalpha = 0.787;
     if (MiscellaneousVars[137] == 6 || MiscellaneousVars[137] == 30) msgalpha = 0.765;
     if (MiscellaneousVars[137] == 7 || MiscellaneousVars[137] == 29) msgalpha = 0.743;
     if (MiscellaneousVars[137] == 8 || MiscellaneousVars[137] == 28) msgalpha = 0.721;
     if (MiscellaneousVars[137] == 9 || MiscellaneousVars[137] == 27) msgalpha = 0.699;
     if (MiscellaneousVars[137] == 10 || MiscellaneousVars[137] == 26) msgalpha = 0.677;
     if (MiscellaneousVars[137] == 11 || MiscellaneousVars[137] == 25) msgalpha = 0.655;
     if (MiscellaneousVars[137] == 12 || MiscellaneousVars[137] == 24) msgalpha = 0.633;
     if (MiscellaneousVars[137] == 13 || MiscellaneousVars[137] == 23) msgalpha = 0.611;
     if (MiscellaneousVars[137] == 14 || MiscellaneousVars[137] == 22) msgalpha = 0.589;
     if (MiscellaneousVars[137] == 15 || MiscellaneousVars[137] == 21) msgalpha = 0.567;
     if (MiscellaneousVars[137] == 16 || MiscellaneousVars[137] == 20) msgalpha = 0.545;
     if (MiscellaneousVars[137] == 17 || MiscellaneousVars[137] == 19) msgalpha = 0.523;
     if (MiscellaneousVars[137] == 18) msgalpha = 0.501;
	 if (MiscellaneousVars[137] >= 35) MiscellaneousVars[137] -= 34;
	 msgalpha += 0.00; 
	 if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	 msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,7803,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	 // Night/Light-Vision Indicator [7804]
     if (PowerupTimer[0] > 0)
	 {
	  if (CharacterClass == 0)
	  {
	   if (PowerupTimer[4] > 0) SetFont("PD1NGVI2");
	   else SetFont("PD1NGVI1");
	  }
	  if (CharacterClass == 1)
	  {
	   if (PowerupTimer[4] > 0) SetFont("PI1NGVI2");
	   else SetFont("PI1NGVI1");
	  }
	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (PowerupTimer[4] > 0) SetFont("PF2NGVI2");
	    else SetFont("PF2NGVI1");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PF1NGVI2");
	    else SetFont("PF1NGVI1");
	   }
	  }
	  if (CharacterClass == 8)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (PowerupTimer[4] > 0) SetFont("PA2NGVI2");
	    else SetFont("PA2NGVI1");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PA1NGVI2");
	    else SetFont("PA1NGVI1");
	   }
	  }
	  if (CharacterClass == 9)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (PowerupTimer[4] > 0) SetFont("PP2NGVI2");
	    else SetFont("PP2NGVI1");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PP1NGVI2");
	    else SetFont("PP1NGVI1");
	   }
	  }

      msgalpha = 0.9;
	  MiscellaneousVars[145]++; // Buff Overlay Timer 2 [Overlay Alpha]
	  if (MiscellaneousVars[145] >= 40) MiscellaneousVars[145] = 0;
	  if (MiscellaneousVars[145] >= 0 && MiscellaneousVars[145] <= 1) msgalpha = 0.70;
	  if (MiscellaneousVars[145] >= 2 && MiscellaneousVars[145] <= 3 || MiscellaneousVars[145] >= 38 && MiscellaneousVars[145] <= 39) msgalpha = 0.73;
	  if (MiscellaneousVars[145] >= 4 && MiscellaneousVars[145] <= 5 || MiscellaneousVars[145] >= 36 && MiscellaneousVars[145] <= 37) msgalpha = 0.76;
	  if (MiscellaneousVars[145] >= 6 && MiscellaneousVars[145] <= 7 || MiscellaneousVars[145] >= 34 && MiscellaneousVars[145] <= 35) msgalpha = 0.79;
	  if (MiscellaneousVars[145] >= 8 && MiscellaneousVars[145] <= 9 || MiscellaneousVars[145] >= 32 && MiscellaneousVars[145] <= 33) msgalpha = 0.82;
	  if (MiscellaneousVars[145] >= 10 && MiscellaneousVars[145] <= 11 || MiscellaneousVars[145] >= 30 && MiscellaneousVars[145] <= 31) msgalpha = 0.85;
	  if (MiscellaneousVars[145] >= 12 && MiscellaneousVars[145] <= 13 || MiscellaneousVars[145] >= 28 && MiscellaneousVars[145] <= 29) msgalpha = 0.88;
	  if (MiscellaneousVars[145] >= 14 && MiscellaneousVars[145] <= 15 || MiscellaneousVars[145] >= 26 && MiscellaneousVars[145] <= 27) msgalpha = 0.91;
	  if (MiscellaneousVars[145] >= 16 && MiscellaneousVars[145] <= 17 || MiscellaneousVars[145] >= 24 && MiscellaneousVars[145] <= 25) msgalpha = 0.94;
	  if (MiscellaneousVars[145] >= 18 && MiscellaneousVars[145] <= 19 || MiscellaneousVars[145] >= 22 && MiscellaneousVars[145] <= 23) msgalpha = 0.97;
	  if (MiscellaneousVars[145] >= 20 && MiscellaneousVars[145] <= 21) msgalpha = 1.0;

	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7804,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 // Berserk Indicator [7805]
	 int berserkveinframe = 0;
	 MiscellaneousVars[455]++;
	 if (MiscellaneousVars[455] >= 24) MiscellaneousVars[455] = 0;
	 if (MiscellaneousVars[455] >= 0 & MiscellaneousVars[455] <= 2) berserkveinframe = 1;
	 if (MiscellaneousVars[455] >= 3 & MiscellaneousVars[455] <= 5) berserkveinframe = 2;
	 if (MiscellaneousVars[455] >= 6 & MiscellaneousVars[455] <= 8) berserkveinframe = 3;
	 if (MiscellaneousVars[455] >= 9 & MiscellaneousVars[455] <= 11) berserkveinframe = 4;
	 if (MiscellaneousVars[455] >= 12 & MiscellaneousVars[455] <= 14) berserkveinframe = 5;
	 if (MiscellaneousVars[455] >= 15 & MiscellaneousVars[455] <= 17) berserkveinframe = 4;
	 if (MiscellaneousVars[455] >= 18 & MiscellaneousVars[455] <= 20) berserkveinframe = 3;
	 if (MiscellaneousVars[455] >= 21 & MiscellaneousVars[455] <= 23) berserkveinframe = 2;
     if (PowerupTimer[23] > 0)
	 {
	  if (CharacterClass == 0)
	  {
	   if (PowerupTimer[4] > 0)
	   {
	    SetFont("PD1BERS2");
		if (berserkveinframe == 1) SetFont("PD1BER21");
		if (berserkveinframe == 2) SetFont("PD1BER22");
		if (berserkveinframe == 3) SetFont("PD1BER23");
		if (berserkveinframe == 4) SetFont("PD1BER24");
		if (berserkveinframe == 5) SetFont("PD1BER25");
	   }
	   else
	   {
	    SetFont("PD1BERS1");
		if (berserkveinframe == 1) SetFont("PD1BER11");
		if (berserkveinframe == 2) SetFont("PD1BER12");
		if (berserkveinframe == 3) SetFont("PD1BER13");
		if (berserkveinframe == 4) SetFont("PD1BER14");
		if (berserkveinframe == 5) SetFont("PD1BER15");
	   }
	  }
	  if (CharacterClass == 1)
	  {
	   if (PowerupTimer[4] > 0)
	   {
	    SetFont("PI1BERS2");
		if (berserkveinframe == 1) SetFont("PI1BER21");
		if (berserkveinframe == 2) SetFont("PI1BER22");
		if (berserkveinframe == 3) SetFont("PI1BER23");
		if (berserkveinframe == 4) SetFont("PI1BER24");
		if (berserkveinframe == 5) SetFont("PI1BER25");
	   }
	   else
	   {
	    SetFont("PI1BERS1");
		if (berserkveinframe == 1) SetFont("PI1BER11");
		if (berserkveinframe == 2) SetFont("PI1BER12");
		if (berserkveinframe == 3) SetFont("PI1BER13");
		if (berserkveinframe == 4) SetFont("PI1BER14");
		if (berserkveinframe == 5) SetFont("PI1BER15");
	   }
	  }

	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (PowerupTimer[4] > 0)
		{
		 SetFont("PF2BERS2");
	 	 if (berserkveinframe == 1) SetFont("PF2BER21");
	 	 if (berserkveinframe == 2) SetFont("PF2BER22");
		 if (berserkveinframe == 3) SetFont("PF2BER23");
		 if (berserkveinframe == 4) SetFont("PF2BER24");
		 if (berserkveinframe == 5) SetFont("PF2BER25");
		}
	    else
		{
		 SetFont("PF2BERS1");
	 	 if (berserkveinframe == 1) SetFont("PF2BER11");
	 	 if (berserkveinframe == 2) SetFont("PF2BER12");
		 if (berserkveinframe == 3) SetFont("PF2BER13");
		 if (berserkveinframe == 4) SetFont("PF2BER14");
		 if (berserkveinframe == 5) SetFont("PF2BER15");
		}
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) 
		{
		 SetFont("PF1BERS2");
		 if (berserkveinframe == 1) SetFont("PF1BER21");
 		 if (berserkveinframe == 2) SetFont("PF1BER22");
 		 if (berserkveinframe == 3) SetFont("PF1BER23");
		 if (berserkveinframe == 4) SetFont("PF1BER24");
		 if (berserkveinframe == 5) SetFont("PF1BER25");
		}
	    else 
		{
		 SetFont("PF1BERS1");
		 if (berserkveinframe == 1) SetFont("PF1BER11");
		 if (berserkveinframe == 2) SetFont("PF1BER12");
		 if (berserkveinframe == 3) SetFont("PF1BER13");
		 if (berserkveinframe == 4) SetFont("PF1BER14");
		 if (berserkveinframe == 5) SetFont("PF1BER15");
		}
	   }
	  }

	  if (CharacterClass == 8)
	  {
	   if (PowerupTimer[7] > 0) 
	   {
	    if (PowerupTimer[4] > 0)
		{
	 	 if (berserkveinframe == 1) SetFont("PA2BER21");
	 	 if (berserkveinframe == 2) SetFont("PA2BER22");
		 if (berserkveinframe == 3) SetFont("PA2BER23");
		 if (berserkveinframe == 4) SetFont("PA2BER24");
		 if (berserkveinframe == 5) SetFont("PA2BER25");
		}
	    else
		{
	 	 if (berserkveinframe == 1) SetFont("PA2BER11");
	 	 if (berserkveinframe == 2) SetFont("PA2BER12");
		 if (berserkveinframe == 3) SetFont("PA2BER13");
		 if (berserkveinframe == 4) SetFont("PA2BER14");
		 if (berserkveinframe == 5) SetFont("PA2BER15");
		}
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) 
		{
		 if (berserkveinframe == 1) SetFont("PA1BER21");
 		 if (berserkveinframe == 2) SetFont("PA1BER22");
 		 if (berserkveinframe == 3) SetFont("PA1BER23");
		 if (berserkveinframe == 4) SetFont("PA1BER24");
		 if (berserkveinframe == 5) SetFont("PA1BER25");
		}
	    else 
		{
		 SetFont("PF1BERS1");
		 if (berserkveinframe == 1) SetFont("PA1BER11");
		 if (berserkveinframe == 2) SetFont("PA1BER12");
		 if (berserkveinframe == 3) SetFont("PA1BER13");
		 if (berserkveinframe == 4) SetFont("PA1BER14");
		 if (berserkveinframe == 5) SetFont("PA1BER15");
		}
	   }
	  }

	  if (CharacterClass == 9)
	  {
	    if (PowerupTimer[4] > 0) 
		{
		 if (berserkveinframe == 1) SetFont("PP1BER21");
 		 if (berserkveinframe == 2) SetFont("PP1BER22");
 		 if (berserkveinframe == 3) SetFont("PP1BER23");
		 if (berserkveinframe == 4) SetFont("PP1BER24");
		 if (berserkveinframe == 5) SetFont("PP1BER25");
		}
	    else 
		{
		 SetFont("PF1BERS1");
		 if (berserkveinframe == 1) SetFont("PP1BER11");
		 if (berserkveinframe == 2) SetFont("PP1BER12");
		 if (berserkveinframe == 3) SetFont("PP1BER13");
		 if (berserkveinframe == 4) SetFont("PP1BER14");
		 if (berserkveinframe == 5) SetFont("PP1BER15");
		}
	  }

      msgalpha = 1.0;
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7805,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
	 
	 // Spread Aura Indicator[s] [7806]
	 int spreadauraframe = 0;
	 int maxspreadauraframe;
	 MiscellaneousVars[457]++;
	 if (MiscellaneousVars[457] >= maxspreadauraframe)
	 {
	  MiscellaneousVars[457] = 0;
	  maxspreadauraframe = Random(2,12) * 3;
	 }
	 if (MiscellaneousVars[457] == 0) spreadauraframe = 1;
	 if (MiscellaneousVars[457] == 1) spreadauraframe = 2;
	 if (MiscellaneousVars[457] == 2) spreadauraframe = 1;
	 if (MiscellaneousVars[457] >= 3) spreadauraframe = 0;
     if (PowerupTimer[8] > 0 || PowerupTimer[9] > 0)
	 {
      if (PowerupTimer[9] > 0)
	  {
	   if (CharacterClass == 2)
	   {
	    if (PowerupTimer[7] > 0) 
	    {
		 if (spreadauraframe == 0) SetFont("PF2SPR20");
 		 if (spreadauraframe == 1) SetFont("PF2SPR21");
 		 if (spreadauraframe == 2) SetFont("PF2SPR22");
		}
		else
		{
		 if (spreadauraframe == 0) SetFont("PF1SPR20");
 		 if (spreadauraframe == 1) SetFont("PF1SPR21");
 		 if (spreadauraframe == 2) SetFont("PF1SPR22");
		}
	   }
	  }
	  else
	  {
	   if (CharacterClass == 2)
	   {
	    if (PowerupTimer[7] > 0) 
	    {
		 if (spreadauraframe == 0) SetFont("PF2SPR10");
 		 if (spreadauraframe == 1) SetFont("PF2SPR11");
 		 if (spreadauraframe == 2) SetFont("PF2SPR12");
		}
		else
		{
		 if (spreadauraframe == 0) SetFont("PF1SPR10");
 		 if (spreadauraframe == 1) SetFont("PF1SPR11");
 		 if (spreadauraframe == 2) SetFont("PF1SPR12");
		}
	   }
	  }
      msgalpha = 1.0;
	  if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]); // If using Invisiblity Spell, pulsate the alpha of the buff effect
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7806,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 //*******************************
     // Main Character Portrait [7820]
	 //*******************************
     if (GetActorProperty(Player1TID,APROP_HEALTH) <= 0) // If dead, show a coffin portrait :V
	 {
	  SetFont("PCOF1NRM");
	 }
	 else
	 {
	  if (CharacterClass == 0)
	  {
	   if (PowerupTimer[4] > 0) SetFont("PDEG1INV");
	   else SetFont("PDEG1NRM");
	  }
	  if (CharacterClass == 1)
	  {
	   if (PowerupTimer[4] > 0) SetFont("PILL1INV");
	   else SetFont("PILL1NRM");
	  }
	  if (CharacterClass == 2)
	  {
	   if (PowerupTimer[7] > 0)
	   {
	    if (PowerupTimer[4] > 0) SetFont("PFLO2INV");
	    else SetFont("PFLO2NRM");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PFLO1INV");
	    else SetFont("PFLO1NRM");
	   }
	  }
	  if (CharacterClass == 8)
	  {
	   if (PowerupTimer[7] > 0)
	   {
	    if (PowerupTimer[4] > 0) SetFont("PAIL2INV");
	    else SetFont("PAIL2NRM");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PAIL1INV");
	    else SetFont("PAIL1NRM");
	   }
	  }
	  if (CharacterClass == 9)
	  {
	   if (PowerupTimer[7] > 0)
	   {
	    if (PowerupTimer[4] > 0) SetFont("PPET2INV");
	    else SetFont("PPET2NRM");
	   }
	   else
	   {
	    if (PowerupTimer[4] > 0) SetFont("PPET1INV");
	    else SetFont("PPET1NRM");
	   }
  	  }
	 }

	 msgalpha = 1.0;
     if (MiscellaneousVars[194] > 0)
     {
      if (MiscellaneousVars[196] >= 0 && MiscellaneousVars[196] <= 29) msgalpha = FixedMul(msgalpha,0.25);
      if (MiscellaneousVars[196] >= 30 && MiscellaneousVars[196] <= 59) msgalpha = FixedMul(msgalpha,0.375);
      if (MiscellaneousVars[196] >= 60 && MiscellaneousVars[196] <= 89) msgalpha = FixedMul(msgalpha,0.50);
      if (MiscellaneousVars[196] >= 90 && MiscellaneousVars[196] <= 119) msgalpha = FixedMul(msgalpha,0.375);
     }	 
	 // If Invisible, pulsate the Alpha of the portrait
	 if (PowerupTimer[1] > 0) msgalpha = FixedMul(msgalpha,MiscFixedVars[101]);
	 msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,7820,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // Portrait Edges [7821]
	 SetFont("PORTEMPT");
	 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,7821,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // Tension Background [portrait] [7822]
	 if (MiscellaneousVars[181] > 0)
	 {
	  MiscellaneousVars[453]++;
	  if (MiscellaneousVars[181] >= 1 && MiscellaneousVars[181] <= 2) 
	  { 
	   if (MiscellaneousVars[453] >= 16) MiscellaneousVars[453] = 0;
	   if (MiscellaneousVars[453] >= 0 && MiscellaneousVars[453] <= 3) SetFont("PORTTE21"); 
	   if (MiscellaneousVars[453] >= 4 && MiscellaneousVars[453] <= 7) SetFont("PORTTE22"); 
	   if (MiscellaneousVars[453] >= 8 && MiscellaneousVars[453] <= 11) SetFont("PORTTE23"); 
	   if (MiscellaneousVars[453] >= 12 && MiscellaneousVars[453] <= 15) SetFont("PORTTE24"); 
	  }
	  if (MiscellaneousVars[181] >= 3 && MiscellaneousVars[181] <= 4) 
	  { 
	   if (MiscellaneousVars[453] >= 12) MiscellaneousVars[453] = 0;
	   if (MiscellaneousVars[453] >= 0 && MiscellaneousVars[453] <= 2) SetFont("PORTTE21"); 
	   if (MiscellaneousVars[453] >= 3 && MiscellaneousVars[453] <= 5) SetFont("PORTTE22"); 
	   if (MiscellaneousVars[453] >= 6 && MiscellaneousVars[453] <= 8) SetFont("PORTTE23"); 
	   if (MiscellaneousVars[453] >= 9 && MiscellaneousVars[453] <= 11) SetFont("PORTTE24"); 
	  }
	  if (MiscellaneousVars[181] >= 5 && MiscellaneousVars[181] <= 6) 
	  { 
	   if (MiscellaneousVars[453] >= 8) MiscellaneousVars[453] = 0;
	   if (MiscellaneousVars[453] >= 0 && MiscellaneousVars[453] <= 1) SetFont("PORTTE21"); 
	   if (MiscellaneousVars[453] >= 2 && MiscellaneousVars[453] <= 3) SetFont("PORTTE22"); 
	   if (MiscellaneousVars[453] >= 4 && MiscellaneousVars[453] <= 5) SetFont("PORTTE23"); 
	   if (MiscellaneousVars[453] >= 6 && MiscellaneousVars[453] <= 7) SetFont("PORTTE24"); 
	  }
	  if (MiscellaneousVars[181] >= 7) 
	  { 
	   if (MiscellaneousVars[453] >= 4) MiscellaneousVars[453] = 0;
	   if (MiscellaneousVars[453] == 0) SetFont("PORTTE21"); 
	   if (MiscellaneousVars[453] == 1) SetFont("PORTTE22"); 
	   if (MiscellaneousVars[453] == 2) SetFont("PORTTE23"); 
	   if (MiscellaneousVars[453] == 3) SetFont("PORTTE24"); 
	  }
	  msgalpha = 0.875;
	  MiscellaneousVars[454]++;
      if (MiscellaneousVars[454] == 1 || MiscellaneousVars[454] == 35) msgalpha = 0.875;
      if (MiscellaneousVars[454] == 2 || MiscellaneousVars[454] == 34) msgalpha = 0.864;
      if (MiscellaneousVars[454] == 3 || MiscellaneousVars[454] == 33) msgalpha = 0.855;
      if (MiscellaneousVars[454] == 4 || MiscellaneousVars[454] == 32) msgalpha = 0.846;
      if (MiscellaneousVars[454] == 5 || MiscellaneousVars[454] == 31) msgalpha = 0.837;
      if (MiscellaneousVars[454] == 6 || MiscellaneousVars[454] == 30) msgalpha = 0.828;
      if (MiscellaneousVars[454] == 7 || MiscellaneousVars[454] == 29) msgalpha = 0.819;
      if (MiscellaneousVars[454] == 8 || MiscellaneousVars[454] == 28) msgalpha = 0.810;
      if (MiscellaneousVars[454] == 9 || MiscellaneousVars[454] == 27) msgalpha = 0.801;
      if (MiscellaneousVars[454] == 10 || MiscellaneousVars[454] == 26) msgalpha = 0.792;
      if (MiscellaneousVars[454] == 11 || MiscellaneousVars[454] == 25) msgalpha = 0.783;
      if (MiscellaneousVars[454] == 12 || MiscellaneousVars[454] == 24) msgalpha = 0.774;
      if (MiscellaneousVars[454] == 13 || MiscellaneousVars[454] == 23) msgalpha = 0.765;
      if (MiscellaneousVars[454] == 14 || MiscellaneousVars[454] == 22) msgalpha = 0.756;
      if (MiscellaneousVars[454] == 15 || MiscellaneousVars[454] == 21) msgalpha = 0.747;
      if (MiscellaneousVars[454] == 16 || MiscellaneousVars[454] == 20) msgalpha = 0.738;
      if (MiscellaneousVars[454] == 17 || MiscellaneousVars[454] == 19) msgalpha = 0.729;
      if (MiscellaneousVars[454] == 18) msgalpha = 0.720;
      if (MiscellaneousVars[454] >= 35) MiscellaneousVars[454] -= 34;
	  if (MiscellaneousVars[181] == 1) msgalpha = FixedMul(msgalpha,0.70);
	  if (MiscellaneousVars[181] == 2) msgalpha = FixedMul(msgalpha,0.75);
	  if (MiscellaneousVars[181] == 3) msgalpha = FixedMul(msgalpha,0.80);
	  if (MiscellaneousVars[181] == 4) msgalpha = FixedMul(msgalpha,0.85);
	  if (MiscellaneousVars[181] == 5) msgalpha = FixedMul(msgalpha,0.90);
	  if (MiscellaneousVars[181] == 6) msgalpha = FixedMul(msgalpha,0.95);
	  if (MiscellaneousVars[181] == 7) msgalpha = FixedMul(msgalpha,1.00);
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7822,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     // Red Glow (critical health) [portrait] [7823]
     int HealthRatio = GetActorProperty(Player1TID,APROP_Health) * 1000 / MaxHealthTrue;
	 if (HealthRatio <= 100)
	 {
	  msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  SetFont("PORTCRTH");
      HudMessage(s:"A";HUDMSG_ALPHA,7823,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

	 // Normal Frame Background [portrait] [7824]
	 msgalpha = 0.8; msgalpha = FixedMul(msgalpha,overallhudalpha);
	 SetFont("PORTNRMH");
	 if (CharacterClass == 0) SetFont("PORTNRMD");
	 if (CharacterClass == 1) SetFont("PORTNRMI");
	 if (CharacterClass == 2) SetFont("PORTNRMF");
	 if (CharacterClass == 8) SetFont("PORTNRMA");
	 if (CharacterClass == 9) SetFont("PORTNRMP");
     HudMessage(s:"A";HUDMSG_ALPHA,7824,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     //********************************
     //* Quickspell Bar [7854 to 7898]*
     //********************************
 	if (GetCVar("dvdsnewhud_showquickspells") > 0)
 	{
      for (C1 = 0; C1 < 10; C1 ++)
      {
       //************************
       //*Text/Costs [7854-7864]*
       //************************
       if (C1 == 0) { xpos = ScreenXOffset + 80.0 + 0.2; ypos = 1049.0; }
       if (C1 == 1) { xpos = ScreenXOffset + 139.0 + 0.2; ypos = 1049.0; }
       if (C1 == 2) { xpos = ScreenXOffset + 198.0 + 0.2; ypos = 1049.0; }
       if (C1 == 3) { xpos = ScreenXOffset + 257.0 + 0.2; ypos = 1049.0; }
       if (C1 == 4) { xpos = ScreenXOffset + 316.0 + 0.2; ypos = 1049.0; }
       if (C1 == 5) { xpos = ScreenXOffset + 375.0 + 0.2; ypos = 1049.0; }
       if (C1 == 6) { xpos = ScreenXOffset + 434.0 + 0.2; ypos = 1049.0; }
       if (C1 == 7) { xpos = ScreenXOffset + 493.0 + 0.2; ypos = 1049.0; }
       if (C1 == 8) { xpos = ScreenXOffset + 552.0 + 0.2; ypos = 1049.0; }
       if (C1 == 9) { xpos = ScreenXOffset + 611.0 + 0.2; ypos = 1049.0; }
       if (xpos < 0.0) xpos -= 0.4;
       SetFont("DQHUDFONTSTATUS");
       G8 = SpellCostCheck(ReadiedSpells[C1] - 1);
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       if (ReadiedSpells[C1] != 0)
       {
        HudMessage(d:G8;HUDMSG_ALPHA,7854+C1,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
       else
       {
        HudMessage(s:"N/A";HUDMSG_ALPHA,7854+C1,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }

       //*******************************************
       //*Spell Bind Key (left-aligned) [7865-7876]*
       //*******************************************
       if (C1 == 0) { xpos = ScreenXOffset + 20.0 + 0.1; ypos = 1000.0; }
       if (C1 == 1) { xpos = ScreenXOffset + 79.0 + 0.1; ypos = 1000.0; }
       if (C1 == 2) { xpos = ScreenXOffset + 139.0 + 0.1; ypos = 1000.0; }
       if (C1 == 3) { xpos = ScreenXOffset + 197.0 + 0.1; ypos = 1000.0; }
       if (C1 == 4) { xpos = ScreenXOffset + 256.0 + 0.1; ypos = 1000.0; }
       if (C1 == 5) { xpos = ScreenXOffset + 315.0 + 0.1; ypos = 1000.0; }
       if (C1 == 6) { xpos = ScreenXOffset + 374.0 + 0.1; ypos = 1000.0; }
       if (C1 == 7) { xpos = ScreenXOffset + 433.0 + 0.1; ypos = 1000.0; }
       if (C1 == 8) { xpos = ScreenXOffset + 492.0 + 0.1; ypos = 1000.0; }
       if (C1 == 9) { xpos = ScreenXOffset + 551.0 + 0.1; ypos = 1000.0; }
       if (xpos < 0.0) xpos -= 0.2;
       if (C1+1 == 1) Keyname = "pukename SpellQuickAssign 0";
       if (C1+1 == 2) Keyname = "pukename SpellQuickAssign 1";
       if (C1+1 == 3) Keyname = "pukename SpellQuickAssign 2";
       if (C1+1 == 4) Keyname = "pukename SpellQuickAssign 3";
       if (C1+1 == 5) Keyname = "pukename SpellQuickAssign 4";
       if (C1+1 == 6) Keyname = "pukename SpellQuickAssign 5";
       if (C1+1 == 7) Keyname = "pukename SpellQuickAssign 6";
       if (C1+1 == 8) Keyname = "pukename SpellQuickAssign 7";
       if (C1+1 == 9) Keyname = "pukename SpellQuickAssign 8";
       if (C1+1 == 10) Keyname = "pukename SpellQuickAssign 9";
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(k:Keyname;HUDMSG_ALPHA,7865+C1,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);


       //*******************
       //*Icons [7876-7897]*
       //*******************
       if (C1 == 0) { xpos = ScreenXOffset + 55.0; ypos = 1023.0; }
       if (C1 == 1) { xpos = ScreenXOffset + 114.0; ypos = 1023.0; }
       if (C1 == 2) { xpos = ScreenXOffset + 173.0; ypos = 1023.0; }
       if (C1 == 3) { xpos = ScreenXOffset + 232.0; ypos = 1023.0; }
       if (C1 == 4) { xpos = ScreenXOffset + 291.0; ypos = 1023.0; }
       if (C1 == 5) { xpos = ScreenXOffset + 350.0; ypos = 1023.0; }
       if (C1 == 6) { xpos = ScreenXOffset + 409.0; ypos = 1023.0; }
       if (C1 == 7) { xpos = ScreenXOffset + 468.0; ypos = 1023.0; }
       if (C1 == 8) { xpos = ScreenXOffset + 527.0; ypos = 1023.0; }
       if (C1 == 9) { xpos = ScreenXOffset + 586.0; ypos = 1023.0; }

       if (ReadiedSpells[C1] != 0)
       {
        // Function Ran
        G8 = SpellCostCheck(ReadiedSpells[C1] - 1); // Function testing to come later :P
        // Function Ran
 
        G4 = CurrentMana / SpellCostCheck(ReadiedSpells[C1] - 1);

        //**********************************
        //*Not Enough Mana Icon [7876-7886]*
        //**********************************
        // Mana Cost Check
	    tempvar1 = 2011+C1;
        if (CurrentMana < G8)
        {
         msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
         MiscellaneousVars[tempvar1] += 1;
         if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
         if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.735;
         if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.72;
         if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.705;
         if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.69;
         if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.675;
         if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.66;
         if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.645;
         if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.63;
         if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.615;
         if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.60;
         if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.585;
         if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.57;
         if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.555;
         if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.54;
         if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.525;
         if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.51;
         if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.495;
         if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] = 1;
 		 msgalpha = FixedMul(msgalpha,overallhudalpha);
         SetFont("SPLINOUS");
         HudMessage(s:"A";HUDMSG_ALPHA,7876+C1,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha); // Not Enough Mana
        }
        else
        {
         MiscellaneousVars[tempvar1] = 0;
        }

        //******************************
        //*QuickSpell Icons [7887-7897]*
        //******************************
        if ((ReadiedSpells[C1] - 1) == 0) // (Minor Magic Missile) Level 0
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIMAS1"); else SetFont("SPLIMAM1"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 1) // (Minor Healing) Level 0
	    {
	     if (buttons & BT_ZOOM) SetFont("SPLIHEA4"); else SetFont("SPLIHEA1"); 
	    }
        if ((ReadiedSpells[C1] - 1) == 2) SetFont("SPLINGV1"); // (Minor Night Vision) Level 1
        if ((ReadiedSpells[C1] - 1) == 3) SetFont("SPLICHL1"); // (Chill Touch) Level 1
        if ((ReadiedSpells[C1] - 1) == 4) SetFont("SPLIIVS1"); // (Minor Invisibility) Level 2
        if ((ReadiedSpells[C1] - 1) == 5) SetFont("SPLIFLI1"); // (Minor Flight) Level 2
        if ((ReadiedSpells[C1] - 1) == 6) SetFont("SPLIPSC1"); // (Minor Poison Cloud) Level 3
        if ((ReadiedSpells[C1] - 1) == 7) // (Minor Fireball) Level 4
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIFBS1"); else SetFont("SPLIFBL1"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 8) SetFont("SPLIENST"); // (Enhanced Strength) Level 5
        if ((ReadiedSpells[C1] - 1) == 9) // (Minor Ice Blast) Level 6
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIICS1"); else SetFont("SPLIICB1"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 10) SetFont("SPLISUM1"); // (Summon Weak Monster) Level 7
        if ((ReadiedSpells[C1] - 1) == 11) // (Magic Missile) Level 7
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIMAS2"); else SetFont("SPLIMAM2"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 12) // (Fireball) Level 8
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIFBS2"); else SetFont("SPLIFBL2"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 13) SetFont("SPLIGLY1"); // (Explosive Glyph) Level 9
        if ((ReadiedSpells[C1] - 1) == 14) // (Healing) Level 9
	    {
	     if (buttons & BT_ZOOM) SetFont("SPLIHEA5"); else SetFont("SPLIHEA2"); 
	    }
        if ((ReadiedSpells[C1] - 1) == 15) { if (Characterclass == 9) SetFont("SPLIDEDA"); else SetFont("SPLINVFR");} // (Fireball Nova) or Desperado Damsel [Petra Only] Level 10
        if ((ReadiedSpells[C1] - 1) == 16) SetFont("SPLISTL1"); // (Minor Stealth) Level 11
        if ((ReadiedSpells[C1] - 1) == 17) SetFont("SPLIIVN1"); // (Minor Invulnerability) Level 11
        if ((ReadiedSpells[C1] - 1) == 18) SetFont("SPLIIVS2"); // (Invisibility) Level 11
        if ((ReadiedSpells[C1] - 1) == 19) SetFont("SPLIACRA"); // (Acid Rain) Level 12
        if ((ReadiedSpells[C1] - 1) == 20) SetFont("SPLIGLY2"); // (Freezing Glyph) Level 12
        if ((ReadiedSpells[C1] - 1) == 21) SetFont("SPLINGV2"); // (Night-Vision) Level 13
        if ((ReadiedSpells[C1] - 1) == 22) SetFont("SPLIFLI2"); // (Flight) Level 13
        if ((ReadiedSpells[C1] - 1) == 23) // (Major Magic Missile) Level 14
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIMAS3"); else SetFont("SPLIMAM3"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 24) SetFont("SPLISUM2"); // (Summon Monster) Level 15
        if ((ReadiedSpells[C1] - 1) == 25) SetFont("SPLINVIC"); // (Icy Nova) Level 16
        if ((ReadiedSpells[C1] - 1) == 26) SetFont("SPLIPSC2"); // (Poison Cloud) Level 16
        if ((ReadiedSpells[C1] - 1) == 27) SetFont("SPLILGN1"); // (Minor Lightning) Level 17
        if ((ReadiedSpells[C1] - 1) == 28) SetFont("SPLISTSK"); // (Stone Skin) Level 18
        if ((ReadiedSpells[C1] - 1) == 29) // (Major Healing) Level 18
	    {
	     if (buttons & BT_ZOOM) SetFont("SPLIHEA6"); else SetFont("SPLIHEA3"); 
	    }
        if ((ReadiedSpells[C1] - 1) == 30) SetFont("SPLINGV3"); // (Major Night-Vision) Level 19
        if ((ReadiedSpells[C1] - 1) == 31) // (Ice Blast) Level 20
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIICS2"); else SetFont("SPLIICB2"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 32) SetFont("SPLIFARS"); // (Farsight) Level 20
        if ((ReadiedSpells[C1] - 1) == 33) SetFont("SPLINVLG"); // (Lightning Nova) Level 20
        if ((ReadiedSpells[C1] - 1) == 34) SetFont("SPLISTL2"); // (Stealth) Level 21
        if ((ReadiedSpells[C1] - 1) == 35) SetFont("SPLIIVN2"); // (Invulnerability) Level 21
        if ((ReadiedSpells[C1] - 1) == 36) SetFont("SPLIIVS3"); // (Major Invisibility) Level 21
        if ((ReadiedSpells[C1] - 1) == 37) SetFont("SPLIFLI3"); // (Major Flight) Level 21
        if ((ReadiedSpells[C1] - 1) == 38) SetFont("SPLILGN2"); // (Lightning) Level 22
        if ((ReadiedSpells[C1] - 1) == 39) SetFont("SPLISUM3"); // (Summon Strong Monster) Level 23
        if ((ReadiedSpells[C1] - 1) == 40) // (Diamond Skin) [Deggaris/Illucia] or (Spreader Aura Lv. 1) [Flora] Level 24
        {
         if (CharacterClass == 2) SetFont("SPLISRA1"); else SetFont("SPLIDISK");
        }
        if ((ReadiedSpells[C1] - 1) == 41) // (Major Fireball) Level 25
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIFBS3"); else SetFont("SPLIFBL3"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 42) // (Major Ice Blast) Level 25
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIICS3"); else SetFont("SPLIICB3"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 43) SetFont("SPLIPSC3"); // (Major Poison Cloud) Level 25
        if ((ReadiedSpells[C1] - 1) == 44) SetFont("SPLILGN3"); // (Major Lightning) Level 25
        if ((ReadiedSpells[C1] - 1) == 45) SetFont("SPLIIVN3"); // (Major Invulnerability) Level 26
        if ((ReadiedSpells[C1] - 1) == 46) SetFont("SPLISTL3"); // (Major Stealth) Level 26 
        if ((ReadiedSpells[C1] - 1) == 47) SetFont("SPLIRASP"); // (Raging Spirits) Level 27
        if ((ReadiedSpells[C1] - 1) == 48) SetFont("SPLISUM4"); // (Summon Arch-Vile) Level 28
        if ((ReadiedSpells[C1] - 1) == 49) // (Ultra Magic Missile) Level 29
	    { 
	     if (buttons & BT_ZOOM) SetFont("SPLIMAS4"); else SetFont("SPLIMAM4"); 
 	    }
        if ((ReadiedSpells[C1] - 1) == 50) SetFont("SPLITMFR"); // (Time Freezer) Level 30
        if ((ReadiedSpells[C1] - 1) == 51) SetFont("SPLIFRAR"); // (Terrorization Aura) Level 30
        if ((ReadiedSpells[C1] - 1) == 52) SetFont("SPLICRLA"); // (Create Lotso Ammo) Level 30
        if ((ReadiedSpells[C1] - 1) == 53) SetFont("SPLIDVAV"); // (Divine Avatar) Level 31
        if ((ReadiedSpells[C1] - 1) == 54) SetFont("SPLISUM5"); // (Summon Cyberdemon) Level 31
        if ((ReadiedSpells[C1] - 1) == 55) SetFont("SPLISRA2"); // (Spreader Aura Lv. 2) Level 56 [Flora Only]
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,7887+C1,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
       else
       {
        SetFont("SPLINONE");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,7887+C1,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      //****************************
      //*QuickSpell Box Type [7898]*
      //****************************
      xpos = ScreenXOffset + 320.0;
      ypos = 1025.0;
      if (CharacterClass == 0) SetFont("QKSPLDEG");
      if (CharacterClass == 1) SetFont("QKSPLILL");
      if (CharacterClass == 2) SetFont("QKSPLFLO");
	  if (CharacterClass == 8) SetFont("QKSPLAIL");
	  if (CharacterClass == 9) SetFont("QKSPLPET");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7898,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //****************************
     //**Spell Box [7991 to 7999]**
     //****************************
	 // 7991 - Spell Cost [Spell Box]
	 // 7992 - Spell "<" Button [Spell Box]
	 // 7993 - Spell ">" Button [Spell Box]
	 // 7994 - Spell "Left" Button [Spell Box]
	 // 7995 - Spell "Right" Button [Spell Box]
	 // 7996 - Spell "Use" Button [Spell Box]
	 // 7997 - Icon Shown on Spell Box [Spell Box]
	 // 7998 - Current Spell Icon [Spell Box]
	 // 7999 - Spell Style Box [Spell Box]
     // Spell Cost
     xpos = ScreenXOffset + 587.0;
     ypos = 792.0; // 792.0
     SetFont("DQHUDFONTSTATUS");
     G1 = SpellCostCheck(SelectedSpell);
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G1;HUDMSG_ALPHA,7991,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha); // Not Enough Mana

     SetFont("DQHUDFONTSTATUS");

     // Spell "<" Button
     xpos = ScreenXOffset + 536.0;
     ypos = 786.0;
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"<";HUDMSG_ALPHA,7992,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap

     // Spell ">" Button
     xpos = ScreenXOffset + 634.0;
     ypos = 786.0;
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:">";HUDMSG_ALPHA,7993,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap

     // Spell "Left" Button
     xpos = ScreenXOffset + 543.0 + 0.2; // 543.2
     if (xpos < 0.0) xpos -= 0.4;
     ypos = 763.0; // 761.0
     Keyname = "pukename SpellSelection 0";
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(k:Keyname;HUDMSG_ALPHA,7994,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap

     // Spell "Right" Button
     xpos = ScreenXOffset + 629.0 + 0.1; // 629.1
     if (xpos < 0.0) xpos -= 0.2;
     ypos = 763.0; // 761.0
     Keyname = "pukename SpellSelection 1";
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(k:Keyname;HUDMSG_ALPHA,7995,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap

     // Spell "Use" Button
     xpos = ScreenXOffset + 585.0; // 585.0
     ypos = 820.0; // 820.0
     Keyname = "pukename SpellCasting 0";
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(k:Keyname;HUDMSG_ALPHA,7996,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 2222 to overlap, or 7777 or underlap

     // Icon Shown on Spell Box
     xpos = ScreenXOffset + 587.0; // 587.0
     ypos = 768.0; // 768.0
     SetFont("SPLINONE");

     // Function Ran
     G1 = SpellCostCheck(SelectedSpell); // Function testing to come later :P
     // Function Ran
     G4 = CurrentMana / SpellCostCheck(SelectedSpell);
 
     tempvar1 = 2010;
     if (CurrentMana < G1)
     {
      msgalpha = 0.75;
      MiscellaneousVars[tempvar1] += 1;
      if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
      if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.735;
      if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.72;
      if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.705;
      if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.69;
      if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.675;
      if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.66;
      if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.645;
      if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.63;
      if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.615;
      if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.60;
      if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.585;
      if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.57;
      if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.555;
      if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.54;
      if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.525;
      if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.51;
      if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.495;
      if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] = 1;
	  msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("SPLINOUS");
      HudMessage(s:"A";HUDMSG_ALPHA,7997,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha); // Not Enough Mana
     }
     else
     {
      MiscellaneousVars[tempvar1] = 0;
     }

     if (SelectedSpell == 0) // (Minor Magic Missile) Level 0
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIMAS1"); else SetFont("SPLIMAM1"); 
	 }
     if (SelectedSpell == 1) // (Minor Healing) Level 0
     {
	  if (buttons & BT_ZOOM) SetFont("SPLIHEA4"); else SetFont("SPLIHEA1"); 
	 }
     if (SelectedSpell == 2) SetFont("SPLINGV1"); // (Minor Night Vision) Level 1
     if (SelectedSpell == 3) SetFont("SPLICHL1"); // (Chill Touch) Level 1
     if (SelectedSpell == 4) SetFont("SPLIIVS1"); // (Minor Invisibility) Level 2
     if (SelectedSpell == 5) SetFont("SPLIFLI1"); // (Minor Flight) Level 2
     if (SelectedSpell == 6) SetFont("SPLIPSC1"); // (Minor Poison Cloud) Level 3
     if (SelectedSpell == 7) // (Minor Fireball) Level 4
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIFBS1"); else SetFont("SPLIFBL1"); 
     }
     if (SelectedSpell == 8) SetFont("SPLIENST"); // (Enhanced Strength) Level 5
     if (SelectedSpell == 9) // (Minor Ice Blast) Level 6
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIICS1"); else SetFont("SPLIICB1"); 
 	 }
     if (SelectedSpell == 10) SetFont("SPLISUM1"); // (Summon Weak Monster) Level 7
     if (SelectedSpell == 11) // (Magic Missile) Level 7
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIMAS2"); else SetFont("SPLIMAM2"); 
	 }
     if (SelectedSpell == 12) // (Fireball) Level 8
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIFBS2"); else SetFont("SPLIFBL2"); 
     }
     if (SelectedSpell == 13) SetFont("SPLIGLY1"); // (Explosive Glyph) Level 9
     if (SelectedSpell == 14) // (Healing) Level 9
     {
	  if (buttons & BT_ZOOM) SetFont("SPLIHEA5"); else SetFont("SPLIHEA2"); 
	 }
     if (SelectedSpell == 15) { if (Characterclass == 9) SetFont("SPLIDEDA"); else SetFont("SPLINVFR"); } // (Fireball Nova) or Desperado Damsel [Petra Only] Level 10
     if (SelectedSpell == 16) SetFont("SPLISTL1"); // (Minor Stealth) Level 11
     if (SelectedSpell == 17) SetFont("SPLIIVN1"); // (Minor Invulnerability) Level 11
     if (SelectedSpell == 18) SetFont("SPLIIVS2"); // (Invisibility) Level 11
     if (SelectedSpell == 19) SetFont("SPLIACRA"); // (Acid Rain) Level 12
     if (SelectedSpell == 20) SetFont("SPLIGLY2"); // (Freezing Glyph) Level 12
     if (SelectedSpell == 21) SetFont("SPLINGV2"); // (Night-Vision) Level 13
     if (SelectedSpell == 22) SetFont("SPLIFLI2"); // (Flight) Level 13
     if (SelectedSpell == 23) // (Major Magic Missile) Level 14
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIMAS3"); else SetFont("SPLIMAM3"); 
	 }
     if (SelectedSpell == 24) SetFont("SPLISUM2"); // (Summon Monster) Level 15
     if (SelectedSpell == 25) SetFont("SPLINVIC"); // (Icy Nova) Level 16
     if (SelectedSpell == 26) SetFont("SPLIPSC2"); // (Poison Cloud) Level 16
     if (SelectedSpell == 27) SetFont("SPLILGN1"); // (Minor Lightning) Level 17
     if (SelectedSpell == 28) SetFont("SPLISTSK"); // (Stone Skin) Level 18
     if (SelectedSpell == 29) // (Major Healing) Level 18
     {
	  if (buttons & BT_ZOOM) SetFont("SPLIHEA6"); else SetFont("SPLIHEA3"); 
	 }
     if (SelectedSpell == 30) SetFont("SPLINGV3"); // (Major Night-Vision) Level 19
     if (SelectedSpell == 31) // (Ice Blast) Level 20
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIICS2"); else SetFont("SPLIICB2"); 
 	 }
     if (SelectedSpell == 32) SetFont("SPLIFARS"); // (Farsight) Level 20
     if (SelectedSpell == 33) SetFont("SPLINVLG"); // (Lightning Nova) Level 20
     if (SelectedSpell == 34) SetFont("SPLISTL2"); // (Stealth) Level 21
     if (SelectedSpell == 35) SetFont("SPLIIVN2"); // (Invulnerability) Level 21
     if (SelectedSpell == 36) SetFont("SPLIIVS3"); // (Major Invisibility) Level 21
     if (SelectedSpell == 37) SetFont("SPLIFLI3"); // (Major Flight) Level 21
     if (SelectedSpell == 38) SetFont("SPLILGN2"); // (Lightning) Level 22
     if (SelectedSpell == 39) SetFont("SPLISUM3"); // (Summon Strong Monster) Level 23
     if (SelectedSpell == 40) // (Diamond Skin) [Deggaris/Illucia] or (Spreader Aura Lv. 1) [Flora] Level 24
     {
      if (CharacterClass == 2) SetFont("SPLISRA1"); else SetFont("SPLIDISK");
     }
     if (SelectedSpell == 41) // (Major Fireball) Level 25
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIFBS3"); else SetFont("SPLIFBL3"); 
     }
     if (SelectedSpell == 42) // (Major Ice Blast) Level 25
	 { 
	  if (buttons & BT_ZOOM) SetFont("SPLIICS3"); else SetFont("SPLIICB3"); 
 	 }
     if (SelectedSpell == 43) SetFont("SPLIPSC3"); // (Major Poison Cloud) Level 25
     if (SelectedSpell == 44) SetFont("SPLILGN3"); // (Major Lightning) Level 25
     if (SelectedSpell == 45) SetFont("SPLIIVN3"); // (Major Invulnerability) Level 26
     if (SelectedSpell == 46) SetFont("SPLISTL3"); // (Major Stealth) Level 26 
     if (SelectedSpell == 47) SetFont("SPLIRASP"); // (Raging Spirits) Level 27
     if (SelectedSpell == 48) SetFont("SPLISUM4"); // (Summon Arch-Vile) Level 28
     if (SelectedSpell == 49) // (Ultra Magic Missile) Level 29
	 {
 	  if (buttons & BT_ZOOM) SetFont("SPLIMAS4"); else SetFont("SPLIMAM4"); 
	 }
     if (SelectedSpell == 50) SetFont("SPLITMFR"); // (Time Freezer) Level 30
     if (SelectedSpell == 51) SetFont("SPLIFRAR"); // (Terrorization Aura) Level 30
     if (SelectedSpell == 52) SetFont("SPLICRLA"); // (Create Lotso Ammo) Level 30
     if (SelectedSpell == 53) SetFont("SPLIDVAV"); // (Divine Avatar) Level 31
     if (SelectedSpell == 54) SetFont("SPLISUM5"); // (Summon Cyberdemon) Level 31
     if (SelectedSpell == 55) SetFont("SPLISRA2"); // (Spreader Aura Lv. 2) Level 56 [Flora Only]
     msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,7998,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     //PrintBold(d:CurrentMana,s:" / ",d:G1);

     // Spell Box
     xpos = ScreenXOffset + 586.0; // 586.0;
     ypos = 770.0; // 789.0;
     if (CharacterClass == 0) SetFont("SPLBXDEG");
     if (CharacterClass == 1) SetFont("SPLBXILL");
     if (CharacterClass == 2) SetFont("SPLBXFLO");
	 if (CharacterClass == 8) SetFont("SPLBXAIL");
	 if (CharacterClass == 9) SetFont("SPLBXPET");
     msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,7999,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);



     //*******************************************
     //** EXP-Gains/Kills/Combos [2001 to 2500?]**
     //*******************************************
	 // 2006 - EXP Combo Meter Frame [Combos]
	 // 2010-2110 - EXP Combo Meter Notches [Combos]
	 // 2111 - EXP Combo Meter Glass [Combos]
	 // 2112 - # of Kills [Combos]
	 // 2113 - "Kills" Label [Combos]
	 // 2114 - "OVERKILL" text [Combos]
	 // 2115 - EXP [from last kill] [Combos]
     if (EXPGainChecker == 1)
     {
      if (MiscellaneousVars[157] > 0)
      {
       // Combo Meter Frames
       xpos = ScreenXOffset + 129.0;
       ypos = 708.0; // MiscFixedVars[2]; // 772.0; // 772.0
       SetFont("KLBFRAME");
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,2006,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       // Combo Meter Notches
       xpos = ScreenXOffset + 79.0; // MiscFixedVars[1];
       ypos += 0.0; // = 772.0; // MiscFixedVars[2]; // 772.0
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

       if (PowerupTimer[7] > 0) MaxEXPCombotimer = 7000; else MaxEXPCombotimer = 5600;
       // Combo Timer Bar
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 100 / G10;
       Z1 = MiscellaneousVars[157];
       Z2 = MaxEXPCombotimer;
       I1 = Z1 * G9 / Z2;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {
        if (Z2 != 0)
        {
         if (C1 <= I1)
         {
		  // Note: Meter Fixed Notches
          if (G10 == 10) { SetFont("KLBNOTCA"); G11 = -5.0; }
          if (G10 == 4) { SetFont("KLBNOTC4"); G11 = -2.0; }
          if (G10 == 2) { SetFont("KLBNOTC2"); G11 = -1.0; }
          if (G10 == 1) { SetFont("KLBNOTCH"); G11 = 0.0; }
         }
         else SetFont("KLBNOTEM");
         I2 = ((C1 << 16) * G10) + G11;
         msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
         HudMessage(s:"A";HUDMSG_ALPHA,C1+2010,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
        }
       }
       // Combo Meter Glass
       xpos = ScreenXOffset + 129.0;
       ypos += 0.0; // = 772.0;
       SetFont("KLBGLASS");
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,2111,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }

	  str killmsgcolor = "Green";
	  MiscellaneousVars[142]++;
	  if (MiscellaneousVars[142] > 39) MiscellaneousVars[142] -= 39;

      // # of Kills
      if (MiscellaneousVars[158] > 0)
      {
       // Kill Combo
       if (MiscellaneousVars[158] > 1)
       {
        if (MiscellaneousVars[158] > 10 && MiscellaneousVars[158] < 21) { killmsgcolor = "LightBlue"; }
        else if (MiscellaneousVars[158] > 20 && MiscellaneousVars[158] < 36) { killmsgcolor = "Cream"; }
        else if (MiscellaneousVars[158] > 35 && MiscellaneousVars[158] < 61) { killmsgcolor = "Cyan"; }
        else if (MiscellaneousVars[158] > 60 && MiscellaneousVars[158] < 101) { killmsgcolor = "Brick"; }
        else if (MiscellaneousVars[158] > 100 && MiscellaneousVars[158] < 201) { killmsgcolor = "Orange"; }
        else if (MiscellaneousVars[158] > 200 && MiscellaneousVars[158] < 501) { killmsgcolor = "Gold"; }
        else if (MiscellaneousVars[158] > 500) 
		{ 
	     if (MiscellaneousVars[142] >= 0 && MiscellaneousVars[142] <= 9) killmsgcolor = "PetraOrange"; 
	     if (MiscellaneousVars[142] >= 10 && MiscellaneousVars[142] <= 19) killmsgcolor = "FloraBlue"; 
	     if (MiscellaneousVars[142] >= 20 && MiscellaneousVars[142] <= 29) killmsgcolor = "PetraOrange"; 
	     if (MiscellaneousVars[142] >= 30 && MiscellaneousVars[142] <= 39) killmsgcolor = "FloraBlue"; 
		}
       }

       SetFont("DQHUDFONT");
       xpos = ScreenXOffset + 108.0 + 0.2;
       if (xpos < 0.0) xpos -= 0.4;
       //Print(f:xpos);
       ypos += -22.0; // = 750.0;
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[158];HUDMSG_ALPHA | HUDMSG_COLORSTRING,2112,killmsgcolor,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       SetFont("DQHUDFONTSML");
       // "Kills" Label
       xpos = ScreenXOffset + 120.0 + 0.1;
       if (xpos < 0.0) xpos -= 0.2;
       ypos += 5.0; // = 755.0;
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);

       if (MiscellaneousVars[158] == 1) HudMessage(s:"KILL";HUDMSG_ALPHA | HUDMSG_COLORSTRING,2113,killmsgcolor,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"KILLS";HUDMSG_ALPHA | HUDMSG_COLORSTRING,2113,killmsgcolor,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }

      // "OVERKILL" text
      xpos = ScreenXOffset + 312.0; // MiscFixedVars[1];
      ypos += -43.0; // = 712.0; // MiscFixedVars[2];
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      if (MiscellaneousVars[2023] > 0) // Overkill timer
      {
       if (MiscellaneousVars[2022] == 1)
       {
        SetFont("DQHUDFONTSML");
        HudMessage(s:"OVERKILL!";HUDMSG_ALPHA,2114,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
       if (MiscellaneousVars[2022] == 2)
       {
        SetFont("DQHUDFONTSML");
        HudMessage(s:"\c[purple]OVERKILL!!";HUDMSG_ALPHA,2114,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
       MiscellaneousVars[2023] -= 1;
      }

      // EXP [from last kill]
      if (MiscellaneousVars[2026] > 0)
      {
       xpos = ScreenXOffset + 222.0 + 0.1;
       if (xpos < 0.0) xpos -= 0.2;
       ypos += 29.0; // = 741.0
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       if (MiscellaneousVars[2024]-MiscellaneousVars[2025] > 1) HudMessage(s:"+",d:MiscellaneousVars[2024],s:" EXP (+",d:MiscellaneousVars[2024]-MiscellaneousVars[2025],s:")";HUDMSG_ALPHA,2115,cr_blue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"+",d:MiscellaneousVars[2024],s:" EXP";HUDMSG_ALPHA,2115,cr_blue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       MiscellaneousVars[2026] -= 1;
      }

      // EXP Total + Combo Bonus [combo]
      if (MiscellaneousVars[158] > 1 && MiscellaneousVars[160] > 0)
      {
       xpos = ScreenXOffset + 222.0 + 0.1;
       if (xpos < 0.0) xpos -= 0.2;
       if (MiscellaneousVars[2026] > 0) ypos += 28.0; else ypos += 57.0;  // = 769.0;
       MultiLower = (MiscellaneousVars[159] - 10000) % 100;
       MultiUpper = ((MiscellaneousVars[159] - 10000) - MultiLower) / 100;

       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("DQHUDFONTSML");
       if (MultiLower > -1 && MultiLower < 10) HudMessage(s:"+",d:MiscellaneousVars[160],s:" EXP (+",d:MultiUpper,s:".0",d:MultiLower,s:"%)";HUDMSG_ALPHA,2116,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       else HudMessage(s:"+",d:MiscellaneousVars[160],s:" EXP (+",d:MultiUpper,s:".",d:MultiLower,s:"%)";HUDMSG_ALPHA,2116,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
     }



     //***************************
     //** HP Info [2498 to 3001]**
     //***************************
	 // 2500 - HP Gained during "LEVEL UP" [HP Info]
	 // 2502 - HP Label [HP Info]
	 // 2504 - HP Amounts [HP Info]
	 // 2505 - HP Meter Border [HP Info]
	 // 2506 - HP Meter Frame [HP Info]
	 // 2600-2800 - HP Meter "Overlife" Notches [HP Info]
	 // 2800-3000 - HP Meter Notches [HP Info] 
	 // 3001 - HP Meter Glass [HP Info]
     G3 = GetActorProperty(Player1TID,APROP_Health);
     G2 = MaxHealthTrue; // Max Health for player
     // HP Label
     xpos = ScreenXOffset + 220.0;
     ypos = 868.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"HP";HUDMSG_ALPHA,2502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // HP Gained during "LEVEL UP"
     // MiscellaneousVars[2031] = MaxHP
     xpos = ScreenXOffset + 388.0 + 0.1;
     if (xpos < 0.0) xpos -= 0.2;
     ypos = 862.0;
     SetFont("DQHUDFONTSML");
     //HudMessage(s:"+ ";HUDMSG_ALPHA,2503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     if (MiscellaneousVars[222] > 0)
     {
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"+ ",d:MiscellaneousVars[222];HUDMSG_ALPHA,2500,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // HP Amounts
     // HPInterpolationDisplay;
     xpos = ScreenXOffset + 326.0;
     ypos = 872.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G3,s:"/",d:G2;HUDMSG_ALPHA,2504,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
     {
      // HP Meter Border
      xpos = ScreenXOffset + 325.0;
      ypos = 870.0;
      G3 = GetActorProperty(Player1TID,APROP_Health);
      G2 = MaxHealthTrue; // Max Health for player
      if (G2 != 0)
      {
	   tempvar1 = 2003;
       I1 = G3 * 200 / G2;
       if (I1 <= 20) // If Health is "Critical" [10% or less]
       {
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
        if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.735;
        if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.72;
        if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.705;
        if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.69;
        if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.675;
        if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.66;
        if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.645;
        if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.63;
        if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.615;
        if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.60;
        if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.585;
        if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.57;
        if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.555;
        if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.54;
        if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.525;
        if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.51;
        if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.495;
        if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
		msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("HPBFCRIT");
        HudMessage(s:"A";HUDMSG_ALPHA,2505,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
       else
       {
        MiscellaneousVars[tempvar1] = 0;
       }
      }
      SetFont("HPBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,2506,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // HP Meter Notches
      xpos = ScreenXOffset + 225.0; // 225
      ypos = 870.0; // 870
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      G3 = GetActorProperty(Player1TID,APROP_Health); // HPInterpolationDisplay
      G2 = MaxHealthTrue; // Max Health for player
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("HPBFILNA"); G11 = -5.0; }
         if (G10 == 4) { SetFont("HPBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("HPBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("HPBFILNR"); G11 = 0.0; } //
        }
        else SetFont("BARNOFIL");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+2800,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
       if (GetCVar("dvdsnewhud_showoverlifenotches") == 1)
       {
        // Overlife
        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 200 / G10;
        G3 = GetActorProperty(Player1TID,APROP_Health);
        G2 = MaxHealthTrue; // Max Health for player
        I1 = (G3 * G9 / G2) - G9; 
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
        if (G2 != 0 && I1 > 0)
        {
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
           if (G10 == 10) { SetFont("HPBFILOA"); G11 = -5.0; }
           if (G10 == 4) { SetFont("HPBFILO4"); G11 = -2.0; }
           if (G10 == 2) { SetFont("HPBFILO2"); G11 = -1.0; }
           if (G10 == 1) { SetFont("HPBFILOV"); G11 = 0.0; }
          }
          else SetFont("BARNOFIL");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+2600,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
        }
       }
      }

      // HP Meter Glass
      xpos = ScreenXOffset + 324.0;
      ypos = 870.0;
      SetFont("HPBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,3001,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }




     //**********************************
     //** MP Info [2501 & 3002 to 3501]**
     //**********************************
	 // 2501 - MP Gained during "LEVEL UP" [MP Info]
	 // 3002 - MP Label [MP Info]
	 // 3004 - MP Amounts [MP Info]
	 // 3005 - MP Meter "Focus" Border [MP Info]
	 // 3006 - MP Meter Border [MP Info]
	 // 3100-3300 - MP Meter "Overmagic" Notches [MP Info]
	 // 3301-3500 - MP Meter Notches [MP Info]
	 // 3501 - MP Meter Glass [MP Info]
     G3 = CurrentMana;
     G2 = MaxMana;
     // MP Label
     xpos = ScreenXOffset + 220.0;
     ypos = 895.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"MP";HUDMSG_ALPHA,3002,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // MP Gained during "LEVEL UP"
     // MiscellaneousVars[2032] = MaxMP
     xpos = ScreenXOffset + 388.0 + 0.1;
     if (xpos < 0.0) xpos -= 0.2;
     ypos = 889.0;
     SetFont("DQHUDFONTSML");
     //HudMessage(s:"+ ";HUDMSG_ALPHA,2503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     if (MiscellaneousVars[223] > 0)
     {
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"+ ",d:MiscellaneousVars[223];HUDMSG_ALPHA,2501,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // MP Amounts
     xpos = ScreenXOffset + 326.0;
     ypos = 899.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G3,s:"/",d:G2;HUDMSG_ALPHA,3004,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
     {
      // MP Meter Border
      xpos = ScreenXOffset + 324.0;
      ypos = 897.0;
 
      tempvar1 = 2004;
      if (MiscellaneousVars[212] > 0) // Focusing
      {
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 350) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 1050) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 2100) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 2800) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 3500) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[231] >= 4200) MiscellaneousVars[tempvar1] += 1;
        if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
        if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
        if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.735;
        if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.72;
        if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.705;
        if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.69;
        if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.675;
        if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.66;
        if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.645;
        if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.63;
        if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.615;
        if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.60;
        if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.585;
        if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.57;
        if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.555;
        if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.54;
        if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.525;
        if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.51;
        if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.495;
	    msgalpha = FixedMul(msgalpha,overallhudalpha);
        SetFont("MPBFOCUS");
        HudMessage(s:"A";HUDMSG_ALPHA,3005,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      SetFont("MPBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,3006,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // MP Meter Notches
      xpos = ScreenXOffset + 225.0; // 225
      ypos = 897.0; // 870
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      G3 = CurrentMana;
      G2 = MaxMana;
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("MPBFILNA"); G11 = -6.0; }
         if (G10 == 4) { SetFont("MPBFILN4"); G11 = -3.0; }
         if (G10 == 2) { SetFont("MPBFILN2"); G11 = -2.0; }
         if (G10 == 1) { SetFont("MPBFILNR"); G11 = -1.0; }
        }
        else SetFont("MPBFILEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+3300,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
       if (GetCVar("dvdsnewhud_showoverlifenotches") == 1)
       {
        // Overlife
        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 200 / G10;
        G3 = CurrentMana;
        G2 = MaxMana;
        I1 = (G3 * G9 / G2) - G9; 
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = 200;
        if (G2 != 0 && I1 > 0)
        {
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
	  	   // Note: Meter Fixed Notches
           if (G10 == 10) { SetFont("MPBFILOA"); G11 = -6.0; }
           if (G10 == 4) { SetFont("MPBFILO4"); G11 = -3.0; }
           if (G10 == 2) { SetFont("MPBFILO2"); G11 = -2.0; }
           if (G10 == 1) { SetFont("MPBFILOV"); G11 = -1.0; }
          }
          else SetFont("MPBFILEM");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+3100,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
        }
       }
      }

      // MP Meter Glass
      xpos = ScreenXOffset + 324.0;
      ypos = 897.0;
      SetFont("MPBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,3501,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }



     //********************************
     //** AP/HLCR Info [3502 to 4001]**
     //********************************
     // 3502 - AP/HLCR Label [AP/HLCR Info]
     // 3503 - AP/HLCR Amounts [AP/HLCR Info]
     // 3504 - AP "Armor Type" Meter Frame / HLCR "OverHeat" Meter Frame [AP/HLCR Info]
     // 3505 - AP/HLCR Meter Frame [AP/HLCR Info]
     // 3600-3800 - AP Meter Notches / Hellcore "Overheat" Meter Notches [AP/HLCR Info]
     // 3801-4000 - Hellcore Meter Notches [AP/HLCR Info]
     // 4001 - AP/HLCR Meter Glass [AP/HLCR Info]
	 
     // AP/HLCR/ARC Meter Border
	 if (CharacterClass == 9) // Petra = Arcana Gauge
	 {
	  // ARC Glass Frame
      xpos = ScreenXOffset + 320.0;
      ypos = 924.0;

      SetFont("HCBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4001,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	  // ARC Frame
      xpos = ScreenXOffset + 320.0;
      ypos = 924.0;

      SetFont("HCBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,3505,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	  // ARC Label
      xpos = ScreenXOffset + 220.0;
      ypos = 922.0;
		
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"ARC";HUDMSG_ALPHA,3502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

		
	  // ARC Notches
      xpos = ScreenXOffset + 225.0; // 225
      ypos = 924.0; // 870
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      G3 = MiscellaneousVars[5001];
      G2 = 900; //To replace in the future with other max. Arcana Gauge options
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("ARBFILNA"); G11 = -5.0; }
         if (G10 == 4) { SetFont("ARBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("ARBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("ARBFILNR"); G11 = 0.0; }
        }
        else SetFont("ARBFILEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+3800,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
	  }
       // ARC Amounts
       xpos = ScreenXOffset + 326.0;
       ypos = 926.0;
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:G3,s:"/",d:G2;HUDMSG_ALPHA,3503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
	 if (CharacterClass == 8) // Ailish = Spirit Strike Meter
	 {
		// ARC Glass Frame
        xpos = ScreenXOffset + 320.0;
        ypos = 924.0;

        SetFont("HCBGLASS");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,4001,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

		// ARC Frame
        xpos = ScreenXOffset + 320.0;
        ypos = 924.0;

        SetFont("HCBFRAME");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,3505,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

		// ARC Label
        xpos = ScreenXOffset + 220.0;
        ypos = 922.0;
		
        SetFont("DQHUDFONTSML");
        msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"SSP";HUDMSG_ALPHA,3502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	 }
     if (CharacterClass == 2) // Flora = HellCore/HLCR
     {
       // HLCR Label
       xpos = ScreenXOffset + 220.0;
       ypos = 922.0;
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"HLCR";HUDMSG_ALPHA,3502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       // HLCR Amounts
       G3 = (HellcoreOverheatLevel / 100) / 100;
       G4 = (HellcoreOverheatLevel / 100) % 100;
       xpos = ScreenXOffset + 326.0;
       ypos = 926.0;
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("DQHUDFONTSML");
       if (G4 < 10) HudMessage(d:G3,s:".0",d:G4,s:"%";HUDMSG_ALPHA,3503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       else HudMessage(d:G3,s:".",d:G4,s:"%";HUDMSG_ALPHA,3503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
       {
        // HLCR Meter Frame
        xpos = ScreenXOffset + 320.0;
        ypos = 924.0;
   	    tempvar1 = 2005;

        if (144 > 10000) // Hellcore - "Overheated" Glow
        {
         msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
         MiscellaneousVars[tempvar1] += 1;
         if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
         if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
         if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
         if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
         if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
         if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
         if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
         if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
         if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
         if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
         if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
         if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
         if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
         if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
         if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
         if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
         if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
         if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
         if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
		 msgalpha = FixedMul(msgalpha,overallhudalpha);
         SetFont("HCBOVHET");
         HudMessage(s:"A";HUDMSG_ALPHA,3504,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
        }
        SetFont("HCBFRAME");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,3505,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
 
        // HLCR Meter Notches
        xpos = ScreenXOffset + 225.0; // 225
        ypos = 924.0; // 870
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
 
        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 200 / G10;
        G3 = HellcoreOverheatLevel; G2 = 1000000;
        I1 = G3 * G9 / G2;
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
        if (G2 != 0)
        {
         // Normal
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
           if (G10 == 10) { SetFont("HCBFILNA"); G11 = -5.0; }
           if (G10 == 4) { SetFont("HCBFILN4"); G11 = -2.0; }
           if (G10 == 2) { SetFont("HCBFILN2"); G11 = -1.0; }
           if (G10 == 1) { SetFont("HCBFILNR"); G11 = 0.0; }
          }
          else SetFont("HCBFILEM");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+3800,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
         if (GetCVar("dvdsnewhud_showoverlifenotches") == 1)
         {
          // Overheat
          G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
          G9 = 200 / G10;
          G3 = HellcoreOverheatLevel; G2 = 1000000;
          I1 = ((G3 * G9 / G2) - G9) / 9;
          if (I1 > G9) I1 = G9;
          if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
          if (I1 > 0)
          {
           for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
           {    
            if (C1 <= I1)
            {
             if (G10 == 10) { SetFont("HCBFILOA"); G11 = -5.0; }
             if (G10 == 4) { SetFont("HCBFILO4"); G11 = -2.0; }
             if (G10 == 2) { SetFont("HCBFILO2"); G11 = -1.0; }
             if (G10 == 1) { SetFont("HCBFILOV"); G11 = 0.0; }
            }
            else SetFont("HCBFILEM");
            I2 = ((C1 << 16) * G10) + G11;
            msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
            HudMessage(s:"A";HUDMSG_ALPHA,C1+3600,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
           }
          }
         }
        }

        // HLCR Meter Glass
        xpos = ScreenXOffset + 320.0;
        ypos = 924.0;
        SetFont("HCBGLASS");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,4001,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }

     }
     else // Marines = AP
     {
      G3 = CheckActorInventory(Player1TID,"Armor");
      G2 = CurrentMaxArmor;
      if (G3 > 0 && G2 > 0)
      {
       // AP Label
       xpos = ScreenXOffset + 220.0;
       ypos = 922.0;
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"AP";HUDMSG_ALPHA,3502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       // AP Amounts
       xpos = ScreenXOffset + 326.0;
       ypos = 926.0;
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:G3,s:"/",d:G2;HUDMSG_ALPHA,3503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
       {
        // AP Meter Type Frame
        xpos = ScreenXOffset + 324.0;
        ypos = 924.0;
        if (CurrentArmorClass > 0) // Armor Type
        {
         if (CurrentArmorClass == 1) // Green Armor
         {
          SetFont("APBGRNAR");
         }
         if (CurrentArmorClass == 2) // Blue Armor
         {
          SetFont("APBBLUAR");
         }
         if (CurrentArmorClass == 3) // Stone Skin [1]
         {
          SetFont("APBSTSK1");
         }
         if (CurrentArmorClass == 4) // Diamond Skin [1]
         {
          SetFont("APBDISK1");
         }
         if (CurrentArmorClass == 5) // Stone Skin [2]
         {
          SetFont("APBSTSK2");
         }
         if (CurrentArmorClass == 6) // Diamond Skin [2]
         {
          SetFont("APBDISK2");
         }
         msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
         HudMessage(s:"A";HUDMSG_ALPHA,3504,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
        }
        // AP Meter Frame
        SetFont("APBFRAME");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,3505,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
        // AP Meter Notches
        xpos = ScreenXOffset + 225.0; // 225
        ypos = 924.0; // 870
 
        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 200 / G10;
        G3 = CheckActorInventory(Player1TID,"Armor");
        G2 = CurrentMaxArmor;
        I1 = G3 * G9 / G2;
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
        if (G2 != 0)
        {
         // Normal
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
           if (G10 == 10) { SetFont("APBFILNA"); G11 = -5.0; }
           if (G10 == 4) { SetFont("APBFILN4"); G11 = -2.0; }
           if (G10 == 2) { SetFont("APBFILN2"); G11 = -1.0; }
           if (G10 == 1) { SetFont("APBFILNR"); G11 = 0.0; }
          }
          else SetFont("APBFILEM");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+3600,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
        }

        // AP Meter Glass
        xpos = ScreenXOffset + 324.0;
        ypos = 924.0;
        SetFont("APBGLASS");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,4001,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
     }




     //********************************
     //** STAMINA Info [4002 to 4501]**
     //********************************
	 // 4002 - Stamina Label [STAMINA Info]
	 // 4003 - Stamina Amounts [STAMINA Info]
	 // 4004 - Stamina "Focus Charge" Meter Frame [STAMINA Info]
	 // 4005 - Stamina "Tension Charge" Meter Frame [STAMINA Info]
	 // 4006 - Stamina Meter Frame [STAMINA Info]
	 // 4100-4300 - Stamina Meter "OverStamina" Notches [STAMINA Info]
	 // 4301-4500 - Stamina Meter Notches [STAMINA Info]
	 // 4501 - Stamina Meter Glass [STAMINA Info]
     G3 = ((MiscellaneousVars[21] * 100) / MiscellaneousVars[22]); // Current Stamina
     // STAM Label
     xpos = ScreenXOffset + 220.0;
     ypos = 949.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"STAM";HUDMSG_ALPHA,4002,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // Stamina Amounts
     G3 = ((MiscellaneousVars[21] * 10000) / MiscellaneousVars[22]) / 100;
     G4 = ((MiscellaneousVars[21] * 10000) / MiscellaneousVars[22]) % 100;
     xpos = ScreenXOffset + 326.0;
     ypos = 953.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     if (G4 < 10) HudMessage(d:G3,s:".0",d:G4,s:"%";HUDMSG_ALPHA,4003,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     else HudMessage(d:G3,s:".",d:G4,s:"%";HUDMSG_ALPHA,4003,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
     {
      // STAM Meter Frame
      xpos = ScreenXOffset + 318.0;
      ypos = 951.0;
	  tempvar1 = 2006;
      if (MiscellaneousVars[212] > 0) // Stamina - "Focus Charge" Glow
      {
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
	   msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("SMBFOCDR");
       HudMessage(s:"A";HUDMSG_ALPHA,4004,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
 
      if (MiscellaneousVars[185] > 0) // Stamina - "Tension Charge" Glow
      {
	   tempvar1 = 2007;
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
	   msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("SMBTENDR");
       HudMessage(s:"A";HUDMSG_ALPHA,4005,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
 
      SetFont("SMBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4006,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // STAM Meter Notches
      xpos = ScreenXOffset + 225.0; // 225
      ypos = 951.0; // 870
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      G3 = MiscellaneousVars[21];
      G2 = MiscellaneousVars[22];
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("SMBFILNA"); G11 = -6.0; }
         if (G10 == 4) { SetFont("SMBFILN4"); G11 = -3.0; }
         if (G10 == 2) { SetFont("SMBFILN2"); G11 = -2.0; }
         if (G10 == 1) { SetFont("SMBFILNR"); G11 = -1.0; }
        }
        else SetFont("SMBFILEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+4300,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
       if (GetCVar("dvdsnewhud_showoverlifenotches") == 1)
       {
        // Overcharge
        G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
        G9 = 200 / G10;
        G3 = MiscellaneousVars[21];
        G2 = MiscellaneousVars[22];
        I1 = ((G3 * G9 / G2) - G9) / 4;
        if (I1 > G9) I1 = G9;
        if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
        if (I1 > 0)
        {
         for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
         {    
          if (C1 <= I1)
          {
		   // Note: Meter Fixed Notches
           if (G10 == 10) { SetFont("SMBFILOA"); G11 = -6.0; }
           if (G10 == 4) { SetFont("SMBFILO4"); G11 = -3.0; }
           if (G10 == 2) { SetFont("SMBFILO2"); G11 = -2.0; }
           if (G10 == 1) { SetFont("SMBFILOV"); G11 = -1.0; }
          }
          else SetFont("SMBFILEM");
          I2 = ((C1 << 16) * G10) + G11;
          msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
          HudMessage(s:"A";HUDMSG_ALPHA,C1+4100,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
         }
        }
       }
      }
 
      // STAM Meter Glass
      xpos = ScreenXOffset + 318.0;
      ypos = 951.0;
      SetFont("SMBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4501,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }


     //****************************
     //** LVL Info [4502 to 4565]**
     //****************************
	 // 4502 - LVL Label [LVL Info]
	 // 4503 - LVL Amounts [LVL Info]
	 // 4504 - LVL Meter Frame [LVL Info]
	 // 4510-4560 - LVL Meter Notches [LVL Info]
	 // 4565 - LVL Meter Glass [LVL Info]
     G3 = PlayerLevel;
     if (EXPGainChecker == 1)
     {
      // LVL Label
      xpos = ScreenXOffset + 470.0;
      ypos = 868.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"LVL";HUDMSG_ALPHA,4502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // LVL Amounts
      xpos = ScreenXOffset + 535.0;
      ypos = 872.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:G3;HUDMSG_ALPHA,4503,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      if (GetCVar("dvdsnewhud_showsecondarymeters") == 1)
      {
       // LVL Meter Frame
       xpos = ScreenXOffset + 535.0;
       ypos = 870.0; 
       SetFont("LVBFRAME");
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,4504,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

       // LVL Meter Notches
       xpos = ScreenXOffset + 508.0;
       ypos = 870.0;
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       if (G10 == 4) G10 = 2;
       if (G10 == 10) G10 = 5;
       G9 = 50 / G10;
       G3 = PlayerLevel; // Current Player Level
       G2 = LevelCap; // Max Level for player
       I1 = G3 * G9 / G2;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       if (G2 != 0)
       {
        // Normal
        for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 51; C1 > 1; C1 --)
        {    
         if (C1 <= I1)
         {
		  // Note: Meter Fixed Notches
          if (G10 == 5) { SetFont("LVBNOTC5"); G11 = 0.0; }
          if (G10 == 2) { SetFont("LVBNOTC2"); G11 = 1.0; }
          if (G10 == 1) { SetFont("LVBNOTCH"); G11 = 2.0; }
         }
         else SetFont("LVBNOTEM");
         I2 = ((C1 << 16) * G10) + G11;
         msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
         HudMessage(s:"A";HUDMSG_ALPHA,C1+4510,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
        }
       }

       // LVL Meter Glass
       xpos = ScreenXOffset + 535.0;
       ypos = 870.0; 
       SetFont("LVBGLASS");
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,4565,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }

     }


     //****************************
     //** SV% Info [4602 to 4665]**
     //****************************
	 // 4602 - SV% Label [SV% Info]
	 // 4603 - SV% Amounts [SV% Info]
	 // 4604 - SV% Meter Frame [SV% Info]
	 // 4610-4660 - SV% Meter Notches [SV% Info]
	 // 4665 - SV% Meter Glass [SV% Info]
     //G3 = SurvivalWhole;
     G3 = MiscellaneousVars[232] / 10;
     G4 = MiscellaneousVars[232] % 10;
     // SV% Label
     xpos = ScreenXOffset + 470.0;
     ypos = 895.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"SV%";HUDMSG_ALPHA,4602,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // SV% Amounts
     xpos = ScreenXOffset + 535.0;
     ypos = 899.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G3,s:".",d:G4;HUDMSG_ALPHA,4603,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     if (GetCVar("dvdsnewhud_showsecondarymeters") == 1)
     {
      // SV% Meter Frame
      xpos = ScreenXOffset + 535.0;
      ypos = 897.0;
      SetFont("SVBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4604,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // SV% Meter Notches
      xpos = ScreenXOffset + 508.0;
      ypos = 897.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      if (G10 == 4) G10 = 2;
      if (G10 == 10) G10 = 5;
      G9 = 50 / G10;
      G3 = SurvivalWhole;
      G2 = 100;
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 51; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 5) { SetFont("SVBNOTC5"); G11 = 0.0; }
         if (G10 == 2) { SetFont("SVBNOTC2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("SVBNOTCH"); G11 = 2.0; }
        }
        else SetFont("SVBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+4610,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // SV% Meter Glass
      xpos = ScreenXOffset + 535.0;
      ypos = 897.0;
      SetFont("SVBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4665,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //****************************
     //** AB% Info [4702 to 4765]**
     //****************************
	 // 4702 - AB% Label [AB% Info]
	 // 4703 - AB% Amounts [AB% Info]
	 // 4704 - AB% Meter Frame [AB% Info]
	 // 4710-4760 - AB% Meter Notches [AB% Info]
	 // 4765 - AB% Meter Glass [AB% Info]
     G3 = SavePercent;
     G3 = MiscellaneousVars[233] / 10;
     G4 = MiscellaneousVars[233] % 10;
     // AB% Label
     xpos = ScreenXOffset + 470.0;
     ypos = 922.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"AB%";HUDMSG_ALPHA,4702,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // AB% Amounts
     xpos = ScreenXOffset + 535.0;
     ypos = 926.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G3,s:".",d:G4;HUDMSG_ALPHA,4703,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     if (GetCVar("dvdsnewhud_showsecondarymeters") == 1)
     {
      // AB% Meter Frame
      xpos = ScreenXOffset + 535.0;
      ypos = 924.0;
      SetFont("ABBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4704,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // AB% Meter Notches
      xpos = ScreenXOffset + 508.0;
      ypos = 924.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      if (G10 == 4) G10 = 2;
      if (G10 == 10) G10 = 5;
      G9 = 50 / G10;
      G3 = SavePercent; // Armor Absorbsion Rate
      G2 = 100;
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 51; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
         if (CharacterClass == 2)
         {
		  // Note: Meter Fixed Notches
          if (G10 == 5) { SetFont("ABBNOT5"); G11 = 0.0; }
          if (G10 == 2) { SetFont("ABBNOT2"); G11 = 1.0; }
          if (G10 == 1) { SetFont("ABBNOTF"); G11 = 2.0; }
         }
         else
         {
		  // Note: Meter Fixed Notches
          if (G10 == 5) { SetFont("ABBNTM5"); G11 = 0.0; }
          if (G10 == 2) { SetFont("ABBNTM2"); G11 = 1.0; }
          if (G10 == 1) { SetFont("ABBNOTM"); G11 = 2.0; }
         }
        }
        else SetFont("ABBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+4710,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
 
      // AB% Meter Glass
      xpos = ScreenXOffset + 535.0;
      ypos = 924.0;
      SetFont("ABBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4765,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //****************************
     //** EV% Info [4802 to 4865]**
     //****************************
	 // 4802 - EV% Label [EV% Info]
	 // 4803 - EV% Amounts [EV% Info]
	 // 4804 - EV% Meter Frame [EV% Info]
	 // 4810-4860 - EV% Meter Notches [EV% Info]
	 // 4865 - EV% Meter Glass [EV% Info]
     G3 = EvadeWhole;
     G3 = MiscellaneousVars[23] / 100;
     G4 = (MiscellaneousVars[23] % 100) / 10;
     // EV% Label
     xpos = ScreenXOffset + 470.0;
     ypos = 949.0;
     SetFont("DQHUDFONTSML");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"EV%";HUDMSG_ALPHA,4802,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

     // EV% Amounts
     xpos = ScreenXOffset + 535.0;
     ypos = 953.0;
     SetFont("DQHUDFONTSML");
     // if (G4 < 10) HudMessage(d:G3,s:".0",d:G4;HUDMSG_ALPHA,4803,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(d:G3,s:".",d:G4;HUDMSG_ALPHA,4803,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     

     if (GetCVar("dvdsnewhud_showsecondarymeters") == 1)
     {
      // EV% Meter Frame
      xpos = ScreenXOffset + 535.0;
      ypos = 951.0;
      SetFont("EVBFRAME");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4804,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // EV% Meter Notches
      xpos = ScreenXOffset + 508.0;
      ypos = 951.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      if (G10 == 4) G10 = 2;
      if (G10 == 10) G10 = 5;
      G9 = 50 / G10;
      G3 = EvadeWhole;
      G2 = 100;
      I1 = G3 * G9 / G2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      if (G2 != 0)
      {
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 51; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 5) { SetFont("EVBNOTC5"); G11 = 0.0; }
         if (G10 == 2) { SetFont("EVBNOTC2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("EVBNOTCH"); G11 = 2.0; }
        }
        else SetFont("EVBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+4810,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // EV% Meter Glass
      xpos = ScreenXOffset + 535.0;
      ypos = 951.0;
      SetFont("EVBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4865,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //****************************
     //** EXP Info [4901 to 5106]**
     //****************************
	 // 4901 - EXP Label [EXP Info]
	 // 4902 - EXP Meter Border [EXP Info]
	 // 4903 - EXP Meter Ruler [EXP Info]
	 // 4904-5104 - EXP Meter Notches [EXP Info]
	 // 5106 - EXP Meter Glass [EXP Info]
     if (EXPGainChecker == 1)
     {
      // EXP Label
      xpos = ScreenXOffset + 204.0; 
      ypos = 972.0;
      SetFont("EXBLABEL");
  	  msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // EXP Meter Border
      xpos = ScreenXOffset + 316.0;
      ypos = 972.0;
      SetFont("EXBFRAME");
  	  msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4902,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // EXP Meter "Ruler"
      xpos = ScreenXOffset + 316.0;
      ypos = 972.0;
      SetFont("EXBRULER");
  	  msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,4903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // EXP Notches
      xpos = ScreenXOffset + 214.0;
      ypos = 972.0;
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      Z1 = Experience - ExpTable[PlayerLevel - 1];
      Z2 = ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1];
      I1 = Z1 * G9 / Z2;
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
      {
       if (Z2 != 0)
       {
        if ((C1 <= I1) || (PlayerLevel == LevelCap))
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("EXBNOTCA"); G11 = -3.0; }
         if (G10 == 4) { SetFont("EXBNOTC4"); G11 = -1.0; }
         if (G10 == 2) { SetFont("EXBNOTC2"); G11 = 0.0; }
         if (G10 == 1) { SetFont("EXBNOTCH"); G11 = 1.0; }
        }
        else SetFont("EXBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
	    msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+4904,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // EXP Meter Glass
      xpos = ScreenXOffset + 316.0;
      ypos = 972.0;
      SetFont("EXBGLASS");
	  msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5106,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }



    if (GetCVar("dvds_allowtension") > 0)
	{
     //****************************************
     //** Tension Charge/Timer [5110 to 5525]**
     //****************************************
	 // 5110 - Tension-Charge Meter "Psyche" Border [Tension Charge/Timer]
	 // 5111 - Tension-Charge Meter Border [Tension Charge/Timer]
	 // 5120-5320 - Tension-Charge Meter Notches [Tension Charge/Timer]
	 // 5323-5523 - Tension-Timer Notches [Tension Charge/Timer]
	 // 5525 - Tension-Timer Glass [Tension Charge/Timer]
     // Tension-Charge Meter Border
     G6 = 0;
     if (GetCVar("dvdsnewhud_tensionmainbar") == 0)
     {
      if (MiscellaneousVars[185] > 0) G6 += 1;
      if (MiscellaneousVars[183] > 0) G6 += 1;
     }
     else G6 += 1;
     if (G6 == 1)
     {
      xpos = ScreenXOffset + 27.0;
      ypos = 856.0;
	  tempvar1 = 2009;
      if (MiscellaneousVars[181] > 0)
      {
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       if (MiscellaneousVars[181] == 1) SetFont("TNBGLVL1");
       if (MiscellaneousVars[181] == 2) SetFont("TNBGLVL2");
       if (MiscellaneousVars[181] == 3) SetFont("TNBGLVL3");
       if (MiscellaneousVars[181] == 4) SetFont("TNBGLVL4");
       if (MiscellaneousVars[181] == 5) SetFont("TNBGLVL5");
       if (MiscellaneousVars[181] == 6) SetFont("TNBGLVL6");
       if (MiscellaneousVars[181] == 7) SetFont("TNBGLVL7");
	   msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,5110,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      if (MiscellaneousVars[181] > 0) SetFont("TNBGFRAM"); else SetFont("TNBFRAME");
	  msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5111,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      // Tension-Charge/Timer Meter Notches
      if (MiscellaneousVars[181] == 0) { MaxTensionChargeTimer = 14000; } // "0"
      if (MiscellaneousVars[181] == 1) { MaxTensionChargeTimer = 14880; TensionTimerMax = 3600; } // "5"
      if (MiscellaneousVars[181] == 2) { MaxTensionChargeTimer = 15750; TensionTimerMax = 4320; } // "20" [x1.2]
      if (MiscellaneousVars[181] == 3) { MaxTensionChargeTimer = 17500; TensionTimerMax = 5184; } // "50" [x1.2]
      if (MiscellaneousVars[181] == 4) { MaxTensionChargeTimer = 19250; TensionTimerMax = 6221; } // "100" [x1.2]
      if (MiscellaneousVars[181] == 5) { MaxTensionChargeTimer = 21000; TensionTimerMax = 7465; } // "250" [x1.2]
      if (MiscellaneousVars[181] == 6) { MaxTensionChargeTimer = 26250; TensionTimerMax = 8958; } // "500" [x1.2]
      if (MiscellaneousVars[181] == 7) { TensionTimerMax = 10750; } // "1000" [x1.2]
      xpos = ScreenXOffset + 27.0;
      ypos = 958.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      // Tension-Charge Meter Notches
      if (MiscellaneousVars[181] < 7 && MiscellaneousVars[185] > 0 && MiscellaneousVars[184] == 0)
      {
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 200 / G10;
       I1 = MiscellaneousVars[185] * G9 / MaxTensionChargeTimer;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
       {
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("TNBNOTCA"); G11 = -3.0; }
         if (G10 == 4) { SetFont("TNBNOTC4"); G11 = 0.0; }
         if (G10 == 2) { SetFont("TNBNOTC2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("TNBNOTCH"); G11 = 1.0; }
        }
        else SetFont("TNBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+5120,cr_untranslated,xpos,ypos-I2,HUDMsgDelayFixed,msgalpha);
       }
      }
 
      xpos = ScreenXOffset + 27.0;
      ypos = 958.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      // Tension-Timer Notches
      if (MiscellaneousVars[181] > 0) //   && MiscellaneousVars[183] < TensionTimerMax
      {
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 200 / G10;
       I1 = MiscellaneousVars[183] * G9 / TensionTimerMax;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
       {
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("TNBNOTTA"); G11 = -3.0; }
         if (G10 == 4) { SetFont("TNBNOTT4"); G11 = 0.0; }
         if (G10 == 2) { SetFont("TNBNOTT2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("TNBNOTTI"); G11 = 1.0; }
        }
        else SetFont("TNBNOTEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+5323,cr_untranslated,xpos,ypos-I2,HUDMsgDelayFixed,msgalpha);
       }
      }
 
      // Tension-Timer Glass
      xpos = ScreenXOffset + 27.0;
      ypos = 856.0;
      SetFont("TNBGLASS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5525,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     } 
 
     //**************************************
     //** Tension OverPsyche [7531 to 7634]**
     //**************************************
	 //	7531		-	Tension-OverPsyche Meter "OverPsyched" Border [Tension-OverPsyche]
	 //	7532		-	Tension-OverPsyche Meter Border [Tension-OverPsyche]
	 //	7533-7633	-	Tension-OverPsyche Meter Notches [Tension-OverPsyche]
	 //	7635		-	Tension-OverPsyche Meter Glass [Tension-OverPsyche]
     // MiscellaneousVars[250] - OverPsyche Timer [Current]
     // MiscellaneousVars[262] - OverPsyche Timer [Max]
     G6 = 0;
     if (GetCVar("dvds_allowtensionocdmg") > 0)
	 {
	  if (MiscellaneousVars[250] > 0) G6 += 1;
	 }
     if (G6 == 1)
     {
      // Tension-OverPsyche Meter Border
      xpos = ScreenXOffset + 62.0; // 62.0
      ypos = 911.0; // 911.0
	  tempvar1 = 2051;
      if (MiscellaneousVars[250] >= MiscellaneousVars[262])
      {
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("OVPSMAXG");
       HudMessage(s:"A";HUDMSG_ALPHA,7531,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      SetFont("OVPSFRAM");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7532,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 62.0; // 62.0
      ypos = 963.0; // 963.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      // Tension-OverPsyche Notches
      if (MiscellaneousVars[250] > 0) //   && MiscellaneousVars[183] < TensionTimerMax
      {
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 100 / G10;
       I1 = MiscellaneousVars[250] * G9 / MiscellaneousVars[262];
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
       {
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("OVPSNOTA"); G11 = -3.0; }
         if (G10 == 4) { SetFont("OVPSNOT4"); G11 = 0.0; }
         if (G10 == 2) { SetFont("OVPSNOT2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("OVPSNOTC"); G11 = 1.0; }
        }
        else SetFont("OVPSNOEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+7533,cr_untranslated,xpos,ypos-I2,HUDMsgDelayFixed,msgalpha);
       }
      }

      // Tension-OverPsyche Glass
      xpos = ScreenXOffset + 62.0; // 62.0
      ypos = 911.0; // 911.0
      SetFont("OVPSGLAS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7635,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     //************************************
     //** Tension Cooldown [5621 to 5731]**
     //************************************
	 // 5621 - Tension-Cooldown Meter "Max Cooldown" Border [Tension Cooldown]
	 // 5622 - Tension-Cooldown Meter Border [Tension Cooldown]
	 // 5630-5730 - Tension-Cooldown Meter Notches [Tension Cooldown]
	 // 5732 - Tension Cooldown Meter Glass [Tension Cooldown]
     G6 = 0;
     if (GetCVar("dvdsnewhud_tensioncooldownbar") == 0)
     {
      if (MiscellaneousVars[186] > 0) G6 += 1;
     }
     else G6 += 1;
     if (G6 == 1)
     {
      // Tension-Cooldown Meter "Max Cooldown" Border
      xpos = ScreenXOffset + 46.0; 
      ypos = 911.0;

      // MiscellaneousVars[188] = MiscellaneousVars[186];
      G3 = MiscellaneousVars[186]; // Current Tension Cooldown Timer
      G2 = MiscellaneousVars[188]; // Max Tension Cooldown
	  tempvar1 = 2008;
      if (G2 > 0 && G3 >= G2)
      {
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("TNCDMAXG");
       HudMessage(s:"A";HUDMSG_ALPHA,5621,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      // Tension-Cooldown Meter Border
      xpos = ScreenXOffset + 46.0; 
      ypos = 911.0;
      SetFont("TNCDFRAM");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5622,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // Tension-Cooldown Meter Notches
      xpos = ScreenXOffset + 46.0;
      ypos = 963.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);

      if (G2 != 0)
      {
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 100 / G10;
       G3 = MiscellaneousVars[186]; // Current Tension Cooldown Timer
       G2 = MiscellaneousVars[188]; // Max Tension Cooldown
       I1 = G3 * G9 / G2;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
		 // Note: Meter Fixed Notches
         if (G10 == 10) { SetFont("TNCDNOTA"); G11 = -3.0; }
         if (G10 == 4) { SetFont("TNCDNOT4"); G11 = 0.0; }
         if (G10 == 2) { SetFont("TNCDNOT2"); G11 = 1.0; }
         if (G10 == 1) { SetFont("TNCDNOTC"); G11 = 1.0; }
        }
        else SetFont("TNCDNOEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+5630,cr_untranslated,xpos,ypos-I2,HUDMsgDelayFixed,msgalpha);
       }
      }

	  // Tension Cooldown Meter Glass
      xpos = ScreenXOffset + 46.0; 
      ypos = 911.0;
      SetFont("TNCDGLAS");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5732,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }


     //************************
     //** Tension Star [5731]**
     //************************
	 // 5731 - Tension Star Icon [Tension Star]
     xpos = ScreenXOffset + 132.0; // 152.0;
     ypos = 948.0; // 950.0; 
     if (MiscellaneousVars[181] == 0)
     {
      if (MiscellaneousVars[185] > 0) SetFont("TNST0000"); else SetFont("TNSTNONE");
     }
     if (MiscellaneousVars[181] == 1) SetFont("TNST0005");
     if (MiscellaneousVars[181] == 2) SetFont("TNST0020");
     if (MiscellaneousVars[181] == 3) SetFont("TNST0050");
     if (MiscellaneousVars[181] == 4) SetFont("TNST0100");
     if (MiscellaneousVars[181] == 5) SetFont("TNST0250");
     if (MiscellaneousVars[181] == 6) SetFont("TNST0500");
     if (MiscellaneousVars[181] == 7) SetFont("TNST1000");
     msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
     HudMessage(s:"A";HUDMSG_ALPHA,5733,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	}

     //******************************************************
     //**Armor Icons [Flora's & Sauron-type] [5734 to 5749]**
     //******************************************************
     // 5734 - Sauron Helmet Icon [Armor Icons]
     // 5735 - Sauron Gauntlets Icon [Armor Icons]
     // 5736 - One Ring Icon [Armor Icons]
     // 5737-5749 - Flora-Specfic Armor Icons [Armor Icons]
	 
     // Sauron Armors
     xpos = ScreenXOffset + 442.0;
     ypos = 744.0;
     if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)
     {
      SetFont("SAURHELM");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5734,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     Z1 = 0;
     if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) Z1 += 1;
     if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) Z1 += 1;
     if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) Z1 += 1;
     if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) Z1 += 1;
     if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) Z1 += 1;
     if (Z1 > 0)
     {
      SetFont("SAURGNTS");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5735,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
     {
      SetFont("TONERING");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5736,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Flora Armors
     xpos = ScreenXOffset + 59.0; // 59.0
     ypos = 744.0;
     if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0)
     {
      SetFont("IFLRARM1");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5737,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"PearlyCorset") > 0)
     {
      SetFont("IFLRARM2");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5738,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0)
     {
      SetFont("IFLRARM3");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5739,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0)
     {
      SetFont("IFLRARM4");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5740,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0)
     {
      SetFont("IFLRARM5");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5741,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0)
     {
      SetFont("IFLRARM6");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5742,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"KissaBra") > 0)
     {
      SetFont("IFLRARM7");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5743,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"DivineShield") > 0)
     {
      SetFont("IFLRARM8");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5744,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
     {
      int RuinousShieldWhole = RuinousShieldPercentF / 10;
      int RuinousShieldDecimal = RuinousShieldPercentF % 10;
      ypos -= 32.0;
      SetFont("DVDSBIGFONT");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:RuinousShieldWhole,s:".",d:RuinousShieldDecimal,s:"%";HUDMSG_ALPHA,5745,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      ypos += 32.0;
      SetFont("IFLRARMX");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5746,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"BalrogRing") > 0)
     {
      SetFont("IFLRARM9");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5747,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
     {
      SetFont("IFLRARMA");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5748,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
     xpos += 32.0;
     ypos += 0.0;
     if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0)
     {
      SetFont("IFLRARMB");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5749,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //********************************************
     //**Stat/AeonPts Icons/Values [5750 to 5767]**
     //********************************************
	 // 5750 - "Aeon Points" Icon [Stat/AeonPts Icons/Values]
	 // 5751 - "Aeon Points" Value [Stat/AeonPts Icons/Values]
	 // 5752 - "Strength" Icon [Stat/AeonPts Icons/Values]
	 // 5753 - "Strength" Value [Stat/AeonPts Icons/Values]
	 // 5754 - "Defense" Icon [Stat/AeonPts Icons/Values]
	 // 5755 - "Defense" Value [Stat/AeonPts Icons/Values]
	 // 5756 - "Sorcery" Icon [Stat/AeonPts Icons/Values]
	 // 5757 - "Sorcery" Value [Stat/AeonPts Icons/Values]
	 // 5758 - "Therapeusis" Icon [Stat/AeonPts Icons/Values]
	 // 5759 - "Therapeusis" Value [Stat/AeonPts Icons/Values]
	 // 5760 - "Agility" Icon [Stat/AeonPts Icons/Values]
	 // 5761 - "Agility" Value [Stat/AeonPts Icons/Values]
	 // 5762 - "Deftness" Icon [Stat/AeonPts Icons/Values]
	 // 5763 - "Deftness" Value [Stat/AeonPts Icons/Values]
	 // 5764 - "Balance" Icon [Stat/AeonPts Icons/Values]
	 // 5765 - "Balance" Value [Stat/AeonPts Icons/Values]
	 // 5766 - "Jumping" Icon [Stat/AeonPts Icons/Values]
	 // 5767 - "Jumping" Value [Stat/AeonPts Icons/Values]
     if (GetCVar("dvdsallhuds_showstatinfo") == 1)
     {
      // MiscellaneousVars[2033] = Aeon Pts
      // Aeon Points
      if (MiscellaneousVars[25] > 0 && PlayerLevel >= MiscellaneousVars[197])
      {
       xpos = ScreenXOffset + 662.0; // 662.0
       ypos = 764.0; // 764.0
       SetFont("STATAEON");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,5750,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
       xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
       if (xpos < 0.0) xpos -= 0.2;
       ypos = 766.0; // 766.0
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[25];HUDMSG_ALPHA,5751,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[224] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[25],s:" \cj+ ",d:MiscellaneousVars[224];HUDMSG_ALPHA,5751,cr_gold,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // MiscellaneousVars[2034] = Strength
      // Strength
      xpos = ScreenXOffset + 663.0;
      ypos = 805.0;
      SetFont("STATSTR");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5752,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 807.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 5) // Selected Strength w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[35];HUDMSG_ALPHA,5753,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[229] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[35],s:" \cj+ ",d:MiscellaneousVars[229];HUDMSG_ALPHA,5753,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[35];HUDMSG_ALPHA,5753,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[229] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[35],s:" \cj+ ",d:MiscellaneousVars[229];HUDMSG_ALPHA,5753,cr_red,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }


      // MiscellaneousVars[2035] = Defense
      // Defense
      xpos = ScreenXOffset + 663.0;
      ypos = 836.0;
      SetFont("STATDEF");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5754,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 838.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 2) // Selected Defense w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[32];HUDMSG_ALPHA,5755,cr_olive,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[226] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[32],s:" \cj+ ",d:MiscellaneousVars[226];HUDMSG_ALPHA,5755,cr_olive,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[32];HUDMSG_ALPHA,5755,cr_olive,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[226] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[32],s:" \cj+ ",d:MiscellaneousVars[226];HUDMSG_ALPHA,5755,cr_olive,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }


      // MiscellaneousVars[2036] = Sorcery
      // Sorcery
      xpos = ScreenXOffset + 663.0;
      ypos = 867.0;
      SetFont("STATSORC");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5756,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 869.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 4) // Selected Sorcery w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[34];HUDMSG_ALPHA,5757,cr_purple,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[228] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[34],s:" \cj+ ",d:MiscellaneousVars[228];HUDMSG_ALPHA,5757,cr_purple,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[Purple]",d:MiscellaneousVars[34];HUDMSG_ALPHA,5757,cr_purple,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[228] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[Purple]",d:MiscellaneousVars[34],s:" \cj+ ",d:MiscellaneousVars[228];HUDMSG_ALPHA,5757,cr_purple,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // MiscellaneousVars[2037] = Therapeusis
      // Therapeusis
      xpos = ScreenXOffset + 663.0;
      ypos = 898.0;
      SetFont("STATTHER");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5758,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 900.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 6) // Selected Therapeusis w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[36];HUDMSG_ALPHA,5759,cr_gray,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[230] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[36],s:" \cj+ ",d:MiscellaneousVars[230];HUDMSG_ALPHA,5759,cr_gray,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[36];HUDMSG_ALPHA,5759,cr_gray,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[230] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[36],s:" \cj+ ",d:MiscellaneousVars[230];HUDMSG_ALPHA,5759,cr_gray,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }


      // MiscellaneousVars[2038] = Agility
      // Agility
      xpos = ScreenXOffset + 663.0;
      ypos = 929.0;
      SetFont("STATAGL");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5760,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 931.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 1) // Selected Agility w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[31];HUDMSG_ALPHA,5761,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[225] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[31],s:" \cj+ ",d:MiscellaneousVars[225];HUDMSG_ALPHA,5761,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[31];HUDMSG_ALPHA,5761,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[225] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[31],s:" \cj+ ",d:MiscellaneousVars[225];HUDMSG_ALPHA,5761,cr_lightblue,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
 
      // MiscellaneousVars[2039] = Deftness
      // Deftness
      xpos = ScreenXOffset + 663.0;
      ypos = 960.0;
      SetFont("STATDFTN");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5762,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
 
      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 962.0; // 766.0
      SetFont("DQHUDFONTSML");
      if (MiscellaneousVars[24] == 3) // Selected Deftness w/ Aeon Pts
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"\c[blue]",d:MiscellaneousVars[33];HUDMSG_ALPHA,5763,cr_green,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[227] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"\c[blue]",d:MiscellaneousVars[33],s:" \cj+ ",d:MiscellaneousVars[227];HUDMSG_ALPHA,5763,cr_green,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:MiscellaneousVars[33];HUDMSG_ALPHA,5763,cr_green,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       if (MiscellaneousVars[227] > 0)
       {
        msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(d:MiscellaneousVars[33],s:" \cj+ ",d:MiscellaneousVars[227];HUDMSG_ALPHA,5763,cr_green,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
 

      // Balance
      xpos = ScreenXOffset + 663.0;
      ypos = 1003.0;
      SetFont("STATMASS");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5764,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 1005.0; // 766.0
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:MiscellaneousVars[201];HUDMSG_ALPHA,5765,cr_olive,xpos,ypos,HUDMsgDelayFixed,msgalpha);


      // Jumping
      xpos = ScreenXOffset + 663.0;
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 1034.0;
      SetFont("STATJUMP");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,5766,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 680.0 + 0.1; // 680.1
      if (xpos < 0.0) xpos -= 0.2;
      ypos = 1036.0; // 766.0
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:MiscellaneousVars[200];HUDMSG_ALPHA,5767,cr_cyan,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }


     //*******************************************
     //**Buff/Debuff Icons/Timers [5768 to 5807]**
     //*******************************************
     int blinktimethreshold = 4;

     // Y +7 per icon's timer
     // Lower Row
     Z1 = 999; // Testing number for displays

      // Divine Avatar
     if (PowerupTimer[7] > 0)
     {
      Z1 = PowerupTimer[7] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 213.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2052;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5768,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 213.0;
      ypos = 839.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2053;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFDVAV");
      HudMessage(s:"A";HUDMSG_ALPHA,5769,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Oomph / Blunt
     Z2 = 0;
     if (PowerupTimer[13] > 0) Z2 += 1; // Blunt
     if (PowerupTimer[10] > 0) Z2 += 1; // Oomph
     if (Z2 > 0)
     {
      if (PowerupTimer[13] > 0) Z1 = PowerupTimer[13] / 35; // Blunt
      if (PowerupTimer[10] > 0) Z1 = PowerupTimer[10] / 35; // Oomph
      if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 246.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2054;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5770,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 246.0;
      ypos = 839.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2055;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      if (PowerupTimer[13] > 0) SetFont("STDBBLNT"); // Blunt
      if (PowerupTimer[10] > 0) SetFont("STBFOMPH"); // Oomph
      HudMessage(s:"A";HUDMSG_ALPHA,5771,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Buff / Sap
     Z2 = 0;
     if (PowerupTimer[14] > 0) Z2 += 1; // Sap
     if (PowerupTimer[11] > 0) Z2 += 1; // Buff
     if (Z2 > 0)
     {
      if (PowerupTimer[14] > 0) Z1 = PowerupTimer[14] / 35; // Sap
      if (PowerupTimer[11] > 0) Z1 = PowerupTimer[11] / 35; // Buff
      if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 279.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2056;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5772,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 279.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2057;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      if (PowerupTimer[14] > 0) SetFont("STDBSAP"); // Sap
      if (PowerupTimer[11] > 0) SetFont("STBFBUFF"); // Buff
      HudMessage(s:"A";HUDMSG_ALPHA,5773,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Accelerate / Decelerate
     Z2 = 0;
     if (PowerupTimer[15] > 0) Z2 += 1; // Decelerate
     if (PowerupTimer[12] > 0) Z2 += 1; // Accelerate
     if (Z2 > 0)
     {
      if (PowerupTimer[15] > 0) Z1 = PowerupTimer[15] / 35; // Decelerate
      if (PowerupTimer[12] > 0) Z1 = PowerupTimer[12] / 35; // Accelerate
      if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 312.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2058;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5774,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 312.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2059;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      if (PowerupTimer[15] > 0) SetFont("STDBDECL"); // Decelerate
      if (PowerupTimer[12] > 0) SetFont("STBFACEL"); // Accelerate
      HudMessage(s:"A";HUDMSG_ALPHA,5775,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Poison
     if (PowerupTimer[16] > 0)
     {
      Z1 = PowerupTimer[16] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 345.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2060;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5776,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 345.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2061;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBPOIS");
      HudMessage(s:"A";HUDMSG_ALPHA,5777,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Corrosion
     if (PowerupTimer[17] > 0)
     {
      Z1 = PowerupTimer[17] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 378.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2062;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5778,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 378.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2063;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBCORR");
      HudMessage(s:"A";HUDMSG_ALPHA,5779,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Fatigue
     if (PowerupTimer[18] > 0)
     {
      Z1 = PowerupTimer[18] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 411.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2064;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5780,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 411.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2065;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBFATI");
      HudMessage(s:"A";HUDMSG_ALPHA,5781,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Blind
     if (PowerupTimer[19] > 0)
     {
      Z1 = PowerupTimer[19] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 444.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2066;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5782,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 444.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2067;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBBLND");
      HudMessage(s:"A";HUDMSG_ALPHA,5783,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }
 
      // Sleep
     if (PowerupTimer[20] > 0)
     {
      Z1 = PowerupTimer[20] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 477.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2068;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5784,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 477.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2069;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBSLEP");
      HudMessage(s:"A";HUDMSG_ALPHA,5785,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

      // Silence
     if (PowerupTimer[21] > 0)
     {
      Z1 = PowerupTimer[21] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 510.0;
      ypos = 846.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2070;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5786,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 510.0;
      ypos = 839.0; // 839.0
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2071;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STDBMUTE");
      HudMessage(s:"A";HUDMSG_ALPHA,5787,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // X/Y +33 per icon
     // Lower Row

     // Flight
     if (PowerupTimer[2] > 0)
     {
      Z1 = PowerupTimer[2] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 213.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2072;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5788,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 213.0; // 213.0
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2073;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFFLYI");
      HudMessage(s:"A";HUDMSG_ALPHA,5789,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Partial Invisibility
     if (PowerupTimer[1] > 0)
     {
      Z1 = PowerupTimer[1] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 246.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2074;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5790,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 246.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2075;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFPTIN");
      HudMessage(s:"A";HUDMSG_ALPHA,5791,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Stealth / Complete Invisibility
     if (PowerupTimer[3] > 0)
     {
      Z1 = PowerupTimer[3] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 279.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2076;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5792,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 279.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2077;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFSTEL");
      HudMessage(s:"A";HUDMSG_ALPHA,5793,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Night Vision
     if (PowerupTimer[0] > 0)
     {
      Z1 = PowerupTimer[0] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 312.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2078;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5794,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 312.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2079;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFNGVI");
      HudMessage(s:"A";HUDMSG_ALPHA,5795,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // BioShield / RadSuit / IronFeet
     if (PowerupTimer[22] > 0)
     {
      Z1 = PowerupTimer[22] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 345.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2080;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5796,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 345.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2081;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFIRFT");
      HudMessage(s:"A";HUDMSG_ALPHA,5797,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Invulnerability
     if (PowerupTimer[4] > 0)
     {
      Z1 = PowerupTimer[4] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 378.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2082;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5798,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 378.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2083;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFINVU");
      HudMessage(s:"A";HUDMSG_ALPHA,5799,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Berserk
     if (PowerupTimer[23] > 0)
     {
      Z1 = PowerupTimer[23] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 411.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2084;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5800,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 411.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2085;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFBERS");
      HudMessage(s:"A";HUDMSG_ALPHA,5801,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Spreader Aura [Both level 1 and 2]
     Z2 = 0;
     if (PowerupTimer[8] > 0) Z2 += 1; // Spread Aura Lv. 1
     if (PowerupTimer[9] > 0) Z2 += 1; // Spread Aura Lv. 2
     if (Z2 > 0)
     {
      if (PowerupTimer[8] > 0) Z1 = PowerupTimer[8] / 35; // Spread Aura Lv. 1
      if (PowerupTimer[9] > 0) Z1 = PowerupTimer[9] / 35; // Spread Aura Lv. 2
      if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 444.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2086;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5802,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 444.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2087;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      if (PowerupTimer[8] > 0) SetFont("STBFSPR1"); // Spread Aura Lv. 1
      if (PowerupTimer[9] > 0) SetFont("STBFSPR2"); // Spread Aura Lv. 2
      HudMessage(s:"A";HUDMSG_ALPHA,5803,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Fear Aura
     if (PowerupTimer[6] > 0)
     {
      Z1 = PowerupTimer[6] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 477.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2088;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5804,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 477.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2089;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFFRAR");
      HudMessage(s:"A";HUDMSG_ALPHA,5805,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     // Time Freezer
     if (PowerupTimer[5] > 0)
     {
      Z1 = PowerupTimer[5] / 35; if (Z1 > 999) Z1 = 999;
      xpos = ScreenXOffset + 510.0;
      ypos = 813.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2090;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.875;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.86;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.845;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.83;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.815;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.80;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.785;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.77;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.755;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.74;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.725;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.71;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.695;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.68;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.665;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.65;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.635;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.62;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("DQHUDFONTSTATUS");
      HudMessage(d:Z1;HUDMSG_ALPHA,5806,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      xpos = ScreenXOffset + 510.0;
      ypos = 806.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
	  tempvar1 = 2091;
	  if (Z1 <= blinktimethreshold)
      {
       MiscellaneousVars[tempvar1] += 1;
       if (MiscellaneousVars[tempvar1] == 1 || MiscellaneousVars[tempvar1] == 35) msgalpha = 0.75;
       if (MiscellaneousVars[tempvar1] == 2 || MiscellaneousVars[tempvar1] == 34) msgalpha = 0.72;
       if (MiscellaneousVars[tempvar1] == 3 || MiscellaneousVars[tempvar1] == 33) msgalpha = 0.69;
       if (MiscellaneousVars[tempvar1] == 4 || MiscellaneousVars[tempvar1] == 32) msgalpha = 0.66;
       if (MiscellaneousVars[tempvar1] == 5 || MiscellaneousVars[tempvar1] == 31) msgalpha = 0.63;
       if (MiscellaneousVars[tempvar1] == 6 || MiscellaneousVars[tempvar1] == 30) msgalpha = 0.60;
       if (MiscellaneousVars[tempvar1] == 7 || MiscellaneousVars[tempvar1] == 29) msgalpha = 0.57;
       if (MiscellaneousVars[tempvar1] == 8 || MiscellaneousVars[tempvar1] == 28) msgalpha = 0.54;
       if (MiscellaneousVars[tempvar1] == 9 || MiscellaneousVars[tempvar1] == 27) msgalpha = 0.51;
       if (MiscellaneousVars[tempvar1] == 10 || MiscellaneousVars[tempvar1] == 26) msgalpha = 0.48;
       if (MiscellaneousVars[tempvar1] == 11 || MiscellaneousVars[tempvar1] == 25) msgalpha = 0.45;
       if (MiscellaneousVars[tempvar1] == 12 || MiscellaneousVars[tempvar1] == 24) msgalpha = 0.42;
       if (MiscellaneousVars[tempvar1] == 13 || MiscellaneousVars[tempvar1] == 23) msgalpha = 0.39;
       if (MiscellaneousVars[tempvar1] == 14 || MiscellaneousVars[tempvar1] == 22) msgalpha = 0.36;
       if (MiscellaneousVars[tempvar1] == 15 || MiscellaneousVars[tempvar1] == 21) msgalpha = 0.33;
       if (MiscellaneousVars[tempvar1] == 16 || MiscellaneousVars[tempvar1] == 20) msgalpha = 0.30;
       if (MiscellaneousVars[tempvar1] == 17 || MiscellaneousVars[tempvar1] == 19) msgalpha = 0.27;
       if (MiscellaneousVars[tempvar1] == 18) msgalpha = 0.24;
       if (MiscellaneousVars[tempvar1] >= 35) MiscellaneousVars[tempvar1] -= 34;
       msgalpha = FixedMul(msgalpha,overallhudalpha);
      }	  
      SetFont("STBFTMFR");
      HudMessage(s:"A";HUDMSG_ALPHA,5807,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
     }

     //***************************************
     //**Buff/Debuff Messages [5808 to 5812]**
     //***************************************
     // 5808 - Buff/Debuff Message #1
     // 5809 - Buff/Debuff Message #2
     // 5810 - Buff/Debuff Message #3
     // 5811 - Buff/Debuff Message #4
     // 5812 - Buff/Debuff Message #5
     str buffmsg1 = "";
     str buffmsg2 = "";
     str buffmsg3 = "";
     str buffmsg4 = "";
     str buffmsg5 = "";
	 
     SetHudSize(1080,810,0); // Since 1920x1080 isn't truly "supported" [ZDOOM(TM(TM(TM))), etc] :V
     if (MiscellaneousVars[2040] > 0)
     {
	  if (MiscellaneousVars[2045] == -8) buffmsg1 = "\c[olive]SAFE PASSAGE OVER HAZARDS!!";
	  if (MiscellaneousVars[2045] == -7) buffmsg1 = "\c[darkgreen]THE DARKNESS VANISHES!!";
	  if (MiscellaneousVars[2045] == -6) buffmsg1 = "\c[cream]YOU MOVE UNDETECTED!!";
	  if (MiscellaneousVars[2045] == -5) buffmsg1 = "\c[green]IMPERVIOUS TO DAMAGE!!";
	  if (MiscellaneousVars[2045] == -4) buffmsg1 = "\c[gold]TIME STOPS AROUND YOU!!";
	  if (MiscellaneousVars[2045] == -3) buffmsg1 = "\c[gold]YOUR PRESENSE SCARES ENEMIES!!";
	  if (MiscellaneousVars[2045] == -2) buffmsg1 = "\c[lightblue]YOU CAN FLY!!";
	  if (MiscellaneousVars[2045] == -1) buffmsg1 = "\c[purple]EVASION INCREASED!!";
	  if (MiscellaneousVars[2045] == 0) buffmsg1 = "\c[red]ATTACK INCREASED!!";
	  if (MiscellaneousVars[2045] == 1) buffmsg1 = "\c[olive]DEFENSE INCREASED!!";
	  if (MiscellaneousVars[2045] == 2) buffmsg1 = "\c[lightblue]SPEED INCREASED!!";
	  if (MiscellaneousVars[2045] == 3) buffmsg1 = "\c[gold]ATTACK/DEFENSE INCREASED!!";
	  if (MiscellaneousVars[2045] == 4) buffmsg1 = "\c[red]MELEE DAMAGE TIMES 10!!";
	  if (MiscellaneousVars[2045] == 5) buffmsg1 = "\c[gold]ALL POWER BOOSTED 4X!!";
	  if (MiscellaneousVars[2045] == 6) buffmsg1 = "\c[olive]TRIPLE ATTACKS!!";
	  if (MiscellaneousVars[2045] == 7) buffmsg1 = "\c[olive]SEPTUPLE ATTACKS!!";

	  if (MiscellaneousVars[2045] == 10) buffmsg1 = "\c[red]ATTACK DECREASED!!";
	  if (MiscellaneousVars[2045] == 11) buffmsg1 = "\c[olive]DEFENSE DECREASED!!";
	  if (MiscellaneousVars[2045] == 12) buffmsg1 = "\c[lightblue]SPEED DECREASED!!";
	  if (MiscellaneousVars[2045] == 13) buffmsg1 = "\c[darkgreen]POISONED!!";
	  if (MiscellaneousVars[2045] == 14) buffmsg1 = "\c[purple]BLINDED!!";
	  if (MiscellaneousVars[2045] == 15) buffmsg1 = "\c[cream]ASLEEP!!";
	  if (MiscellaneousVars[2045] == 16) buffmsg1 = "\c[green]SPELLS SEALED!!";
	  if (MiscellaneousVars[2045] == 17) buffmsg1 = "\c[brick]YOU'RE EXHAUSTED!!";
	  //if (MiscellaneousVars[2045] == 18 buffmsg1 = "\[gold]ARCANA FORCE!";
      xpos = 540.0; // MiscFixedVars[1]; [1440]
      ypos = 696.0; // MiscFixedVars[2]; [1080]
      SetFont("DQHUDFONTSML"); // DQHUDFONTSML // DQHUDFONTSTATUS
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:buffmsg1;HUDMSG_ALPHA,5808,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     if (MiscellaneousVars[2041] > 0)
     {
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:buffmsg2;HUDMSG_ALPHA,5809,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     if (MiscellaneousVars[2042] > 0)
     {
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:buffmsg3;HUDMSG_ALPHA,5810,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
	 
     if (MiscellaneousVars[2043] > 0)
     {
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:buffmsg4;HUDMSG_ALPHA,5811,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     if (MiscellaneousVars[2044] > 0)
     {
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:buffmsg5;HUDMSG_ALPHA,5812,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
     SetHudSize(1440,1080,0); // Since 1920x1080 isn't truly "supported" [ZDOOM(TM(TM(TM))), etc] :V

     xpos = MiscFixedVars[1];
     ypos = MiscFixedVars[2];
     xpos = MiscFixedVars[3];
     ypos = MiscFixedVars[4];
     xpos = MiscFixedVars[5];
     ypos = MiscFixedVars[6];
     xpos = MiscFixedVars[7];
     ypos = MiscFixedVars[8];
     xpos = MiscFixedVars[9];
     ypos = MiscFixedVars[10];
     xpos = MiscFixedVars[11];
     ypos = MiscFixedVars[12];
     xpos = MiscFixedVars[13];
     ypos = MiscFixedVars[14];
     xpos = MiscFixedVars[15];
     ypos = MiscFixedVars[16];
     xpos = MiscFixedVars[17];
     ypos = MiscFixedVars[18];
     xpos = MiscFixedVars[19];
     ypos = MiscFixedVars[20];


    //************************
    //************************
    //************************
    //************************
    //************************
    //*******  Middle  *******
    //************************
    //************************
    //************************
    //************************
    //************************

	 int baseypos = 1024.0;
	     int currentair = GetAirSupply(0);
     int maxair = 700;
	 if (currentair < 0) currentair = 0;
     if (currentair < maxair && GetActorProperty(Player1TID,APROP_HEALTH) > 0)
	 {
	  baseypos -= 32.0;
      // "Air" Text [7001]
      xpos = 592.0; // 1149.0;
      ypos = baseypos;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("DQHUDFONTSML");
      HudMessage(s:"AIR";HUDMSG_ALPHA,7001,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	  int currentair2 = currentair / 35;
	  int maxair2 = maxair / 35;
      G3 = ((currentair * 10000) / maxair) / 100;
      G4 = ((currentair * 10000) / maxair) % 100;
      // "Air" Amounts [7002]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos + 6.0; // 1028.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      //HudMessage(d:currentair2,s:"/",d:maxair2;HUDMSG_ALPHA,7002,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      
      if (G4 > -1 && G4 < 10) HudMessage(d:G3,s:".0",d:G4,s:"%";HUDMSG_ALPHA,7002,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      else HudMessage(d:G3,s:".",d:G4,s:"%";HUDMSG_ALPHA,7002,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	   
	  // Air Meter Empty "Glow" Border [7003]
      xpos = 592.0 + 142.0; // 1291.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("AIBFOCUS");
	  if (currentair <= 0)
	  {
       HudMessage(s:"A";HUDMSG_ALPHA,7003,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
 
 	  // Air Meter Border [7004]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("AIBFRAME"); // SetFont("SCBFRAME"); 
      HudMessage(s:"A";HUDMSG_ALPHA,7004,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // Air Meter Notches [6400-6600]
      xpos = 592.0 + 39.0; // 1188.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75;
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      I1 = currentair * G9 / maxair;

      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      // Normal
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("AIBFILNA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("AIBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("AIBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("AIBFILNR"); G11 = 1.0; }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+7100,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  
	  
      // "Air" Meter Glass [7205]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      SetFont("AIBGLASS"); 
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,7205,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }

     xpos = MiscFixedVars[1];
     ypos = MiscFixedVars[2];
    int mkilled = GetLevelInfo (LEVELINFO_KILLED_MONSTERS),
        mtotal = GetLevelInfo (LEVELINFO_TOTAL_MONSTERS),
        ifound = GetLevelInfo (LEVELINFO_FOUND_ITEMS),
        itotal = GetLevelInfo (LEVELINFO_TOTAL_ITEMS),
        sfound = GetLevelInfo (LEVELINFO_FOUND_SECRETS),
        stotal = GetLevelInfo (LEVELINFO_TOTAL_SECRETS);
	if (GetCVar("dvdsnewhud_showlevelstats") > 0)
	{
	 // Items Meter [8901-9205]
     if (itotal > 0)
	 {
	  baseypos -= 32.0;
      // "Item" Text [8901]
      xpos = 592.0; // 1149.0;
      ypos = baseypos;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("DQHUDFONTSML");
      HudMessage(s:"ITEM";HUDMSG_ALPHA,8901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // "Item" Amounts [8902]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos + 6.0; // 1028.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:ifound,s:"/",d:itotal;HUDMSG_ALPHA,8902,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	   
	  // Item Meter "Glow" Border [8903]
      xpos = 592.0 + 142.0; // 1291.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("AIBFOCUS");
	  if (ifound >= itotal)
	  {
       HudMessage(s:"A";HUDMSG_ALPHA,8903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
 
 	  // Item Meter Border [8904]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("AIBFRAME"); // SetFont("SCBFRAME"); 
      HudMessage(s:"A";HUDMSG_ALPHA,8904,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // Item Meter Notches [9000-9200]
      xpos = 592.0 + 39.0; // 1188.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75;
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      I1 = ifound * G9 / itotal;

      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      // Normal
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("MPBFILNA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("MPBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("MPBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("MPBFILNR"); G11 = 1.0; }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+9000,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  
	  
      // "Item" Meter Glass [9205]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      SetFont("AIBGLASS"); 
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,9205,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }


	 // Secrets Meter [8501-8805]
     if (stotal > 0)
	 {
	  baseypos -= 32.0;
      // "Secr" Text [8501]
      xpos = 592.0; // 1149.0;
      ypos = baseypos;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("DQHUDFONTSML");
      HudMessage(s:"SECR";HUDMSG_ALPHA,8501,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // "Secret" Amounts [8502]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos + 6.0; // 1028.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:sfound,s:"/",d:stotal;HUDMSG_ALPHA,8502,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	   
	  // Secret Meter "Glow" Border [8503]
      xpos = 592.0 + 136.0; // 1291.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("SMBFULDR");
	  if (sfound >= stotal)
	  {
       HudMessage(s:"A";HUDMSG_ALPHA,8503,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
 
 	  // Secret Meter Border [8504]
      xpos = 592.0 + 134.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("SMBFRAME"); // SetFont("SCBFRAME"); 
      HudMessage(s:"A";HUDMSG_ALPHA,8504,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // Secret Meter Notches [8600-8800]
      xpos = 592.0 + 38.0; // 1188.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75;
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      I1 = sfound * G9 / stotal;

      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      // Normal
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("SMBFILNA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("SMBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("SMBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("SMBFILNR"); G11 = 1.0; }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+8600,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  
	  
      // "Secret" Meter Glass [8805]
      xpos = 592.0 + 134.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      SetFont("SMBGLASS"); 
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,8805,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }


	 // Kills Meter [8101-8405]
     if (mtotal > 0)
	 {
	  baseypos -= 32.0;
      // "KILL" Text [8101]
      xpos = 592.0; // 1149.0;
      ypos = baseypos;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("DQHUDFONTSML");
      HudMessage(s:"KILL";HUDMSG_ALPHA,8101,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // "Kill" Amounts [8102]
      xpos = 592.0 + 140.0; // 1289.0;
      ypos = baseypos + 6.0; // 1028.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(d:mkilled,s:"/",d:mtotal;HUDMSG_ALPHA,8102,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);

	   
	  // Kill Meter "Glow" Border [8103]
      xpos = 592.0 + 137.0; // 1291.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("HCBOVHET");
	  if (mkilled >= mtotal)
	  {
       HudMessage(s:"A";HUDMSG_ALPHA,8103,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
 
 	  // Kill Meter Border [8104]
      xpos = 592.0 + 135.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("HCBFRAME"); // SetFont("SCBFRAME"); 
      HudMessage(s:"A";HUDMSG_ALPHA,8104,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);

      // Kill Meter Notches [8200-8400]
      xpos = 592.0 + 39.0; // 1188.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      msgalpha = 0.75;
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
      I1 = mkilled * G9 / mtotal;

      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      // Normal
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {    
        if (C1 <= I1)
        {
         if (G10 == 10) { SetFont("HCBFILNA"); G11 = -4.0; }
         if (G10 == 4) { SetFont("HCBFILN4"); G11 = -2.0; }
         if (G10 == 2) { SetFont("HCBFILN2"); G11 = -1.0; }
         if (G10 == 1) { SetFont("HCBFILNR"); G11 = 1.0; }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+8200,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  
	  
      // "Kill" Meter Glass [8405]
      xpos = 592.0 + 135.0; // 1289.0;
      ypos = baseypos; // 1028.0; // 1060.0;
      SetFont("HCBGLASS"); 
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,8405,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	 }
	}
	 
	//************************
    //************************
    //************************
    //************************
    //************************
    //*******Right Side*******
    //************************
    //************************
    //************************
    //************************
    //************************

	 int showmanabar = 0;
	 int showetherstock = 0;
     ScreenXOffset = GetCVar("dvdsnewhud_widescreenxoffset") * 1.0;
     //************************************************************
     //**Weapon/Ammo Display and Sceptre-EXP meter [5900 to 6205]**
     //************************************************************
	 // 5900 - Spin Attack Indicator Icon [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 5901 - "AMMO" type label / Level Label and Amount [Hellcore] [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 5902 - "AMMO" Amounts / Sceptre EXP [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 5903 - "AMMO" Meter Empty "Glow" Border [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 5904 - "AMMO" Meter / Sceptre EXP Meter Border [Weapon/Ammo Display and Sceptre-EXP meter]
     // 6000-6200 - "AMMO" Meter Notches / Sceptre Meter Notches [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 6205 - "AMMO" Meter / Sceptre EXP Meter Glass [Weapon/Ammo Display and Sceptre-EXP meter]
	 // 6206 - Weapon Icon [Weapon/Ammo Display and Sceptre-EXP meter]

	 // 6301 - "HEAT"/"MP" type label / Level Label and Amount [Hellcore] [MinigunHeat/MP Display and meter 2]
	 // 6302 - "HEAT"/"MP" Amounts / Sceptre EXP [MinigunHeat/MP Display and meter 2]
	 // 6303 - "HEAT"/"MP" Meter Empty "Glow" Border [MinigunHeat/MP Display and meter 2]
	 // 6304 - "HEAT"/"MP" Meter / Sceptre EXP Meter Border [MinigunHeat/MP Display and meter 2]
     // 6400-6600 - "HEAT"/"MP" Meter Notches / Sceptre Meter Notches [MinigunHeat/MP Display and meter 2]
	 // 6605 - "HEAT"/"MP" Meter / Sceptre EXP Meter Glass [MinigunHeat/MP Display and meter 2]
     SetActivator(Player1TID);
     str weapon = GetWeapon();
     int ammo = 0; // Ammo Values Default to 0 unless a weapon that uses ammo/has an ammo limit is detected
     int maxammo = 0; // Ammo Values Default to 0 unless a weapon that uses ammo/has an ammo limit is detected
     int showsecondmeter = 0; // Determines what weapons show a second meter [Minigun Heat & MP (Heretic weapons)]
	 
     //PrintBold(s:weapon);
     // Ammo Type/Amount Checks
     If(StrIcmp(weapon, "Pistol2") == 0 || StrIcmp(weapon, "DualPistols") == 0 || StrIcmp(weapon, "Chaingun2") == 0 || StrIcmp(weapon, "Minigun") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"Clip");
      maxammo = GetAmmoCapacity("Clip");
	  if (StrIcmp(weapon, "Minigun") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "Rifle") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"RifleAmmo");
      maxammo = GetAmmoCapacity("RifleAmmo");
     }
     If(StrIcmp(weapon, "Shotgun2") == 0 || StrIcmp(weapon, "SuperShotgun2") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"Shell");
      maxammo = GetAmmoCapacity("Shell");
     }
     If(StrIcmp(weapon, "RocketLauncher2") == 0 || StrIcmp(weapon, "KDiZDGrenadeLauncher") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"RocketAmmo");
      maxammo = GetAmmoCapacity("RocketAmmo");
     }
     If(StrIcmp(weapon, "PlasmaRifle2") == 0 || StrIcmp(weapon, "Railgun2") == 0 || StrIcmp(weapon, "Repeater2") == 0 || StrIcmp(weapon, "Karasawa2") == 0 || StrIcmp(weapon, "BFG90002") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"Cell");
      maxammo = GetAmmoCapacity("Cell");
	  if (StrIcmp(weapon, "Railgun2") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DiarisLongbow") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"DiarisArrow");
      maxammo = GetAmmoCapacity("DiarisArrow");
     }
     // Circus2-Exclusive Checks
     If(StrIcmp(weapon, "ClownGrenadeNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CGrenadeAmmo");
      maxammo = GetAmmoCapacity("CGrenadeAmmo");
     }
     If(StrIcmp(weapon, "GutFlingerNew") == 0 || StrIcmp(weapon, "GasRocketLauncherNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"ClownSouls");
      maxammo = GetAmmoCapacity("ClownSouls");
     }
     If(StrIcmp(weapon, "GoreBalloonNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"GoreBalloons");
      maxammo = GetAmmoCapacity("GoreBalloons");
     }
     If(StrIcmp(weapon, "PopcornGunNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PopcornPiece");
      maxammo = GetAmmoCapacity("PopcornPiece");
     }
     If(StrIcmp(weapon, "CrazyBall2New") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CzBall");
      maxammo = GetAmmoCapacity("CzBall");
     }
     // Heretic-Exclusive Checks
     If(StrIcmp(weapon, "GoldWandNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"GoldWandAmmo");
      maxammo = GetAmmoCapacity("GoldWandAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualGoldWandNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"GoldWandAmmo");
      maxammo = GetAmmoCapacity("GoldWandAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "CrossbowNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CrossbowAmmo");
      maxammo = GetAmmoCapacity("CrossbowAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualCrossbowNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CrossbowAmmo");
      maxammo = GetAmmoCapacity("CrossbowAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "SuperCrossbowNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CrossbowAmmo");
      maxammo = GetAmmoCapacity("CrossbowAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualSuperCrossbowNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"CrossbowAmmo");
      maxammo = GetAmmoCapacity("CrossbowAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DragonClawNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"BlasterAmmo");
      maxammo = GetAmmoCapacity("BlasterAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualDragonClawNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"BlasterAmmo");
      maxammo = GetAmmoCapacity("BlasterAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "HellStaffNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"SkullRodAmmo");
      maxammo = GetAmmoCapacity("SkullRodAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualHellStaffNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"SkullRodAmmo");
      maxammo = GetAmmoCapacity("SkullRodAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "PhoenixRodNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PhoenixRodAmmo");
      maxammo = GetAmmoCapacity("PhoenixRodAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualPhoenixRodNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PhoenixRodAmmo");
      maxammo = GetAmmoCapacity("PhoenixRodAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "FiremaceNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"MaceAmmo");
      maxammo = GetAmmoCapacity("MaceAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualFiremaceNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"MaceAmmo");
      maxammo = GetAmmoCapacity("MaceAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DSparilStaff") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"BlasterAmmo");
      maxammo = GetAmmoCapacity("BlasterAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
     If(StrIcmp(weapon, "DualDSparilStaff") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"BlasterAmmo");
      maxammo = GetAmmoCapacity("BlasterAmmo");
	  if (GetCVar("dvds_florausesmagicheretic") == 1) showmanabar = 1;
      if (GetCVar("dvds_florausesmagicheretic") == 0) showsecondmeter = 1;
     }
	 // STRIFE-exclusive checks
     If(StrIcmp(weapon, "StrifeCrossbowNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"ElectricBolts");
      maxammo = GetAmmoCapacity("ElectricBolts");
     }
     If(StrIcmp(weapon, "StrifeCrossbow2New") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PoisonBolts");
      maxammo = GetAmmoCapacity("PoisonBolts");
     }
     If(StrIcmp(weapon, "StrifeCrossbowDualNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"ElectricBolts");
      maxammo = GetAmmoCapacity("ElectricBolts");
     }
     If(StrIcmp(weapon, "StrifeCrossbow2DualNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PoisonBolts");
      maxammo = GetAmmoCapacity("PoisonBolts");
     }
     If(StrIcmp(weapon, "AssaultGunNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"ClipOfBullets");
      maxammo = GetAmmoCapacity("ClipOfBullets");
     }
     If(StrIcmp(weapon, "AssaultGunDualNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"ClipOfBullets");
      maxammo = GetAmmoCapacity("ClipOfBullets");
     }
     If(StrIcmp(weapon, "MiniMissileLauncherNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"MiniMissiles");
      maxammo = GetAmmoCapacity("MiniMissiles");
     }
     If(StrIcmp(weapon, "MiniMissileLauncherDualNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"MiniMissiles");
      maxammo = GetAmmoCapacity("MiniMissiles");
     }
     If(StrIcmp(weapon, "FlameThrowerNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"EnergyPod");
      maxammo = GetAmmoCapacity("EnergyPod");
     }
     If(StrIcmp(weapon, "StrifeGrenadeLauncherNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"HEGrenadeRounds");
      maxammo = GetAmmoCapacity("HEGrenadeRounds");
     }
     If(StrIcmp(weapon, "StrifeGrenadeLauncher2New") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"PhosphorusGrenadeRounds");
      maxammo = GetAmmoCapacity("PhosphorusGrenadeRounds");
     }
     If(StrIcmp(weapon, "MaulerNew") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"EnergyPod");
      maxammo = GetAmmoCapacity("EnergyPod");
     }
     If(StrIcmp(weapon, "Mauler2New") == 0)
     {
      ammo = CheckActorInventory(Player1TID,"EnergyPod");
      maxammo = GetAmmoCapacity("EnergyPod");
     }
     If(StrIcmp(weapon, "NNSigil") == 0 || StrIcmp(weapon, "Sigil") == 0)
     {
      ammo = GetActorProperty(Player1TID,APROP_HEALTH);
      maxammo = MaxHealthTrue;
     }
     If(StrIcmp(weapon, "EvilWarriorShield") == 0)
     {
      showmanabar = 1;
     }
     If(StrIcmp(weapon, "64UnmakerPetra") == 0) //Petra's version of the Unmaker runs on Cell ammo instead of MP.
     {
      ammo = CheckActorInventory(Player1TID,"Cell");
      maxammo = GetAmmoCapacity("Cell");
     }
     If(StrIcmp(weapon, "64UnmakerFlora") == 0) //Flora's version of the Unmaker runs off of MP instead of Cell ammo.
     {
      showmanabar = 1;
	 }
     If(StrIcmp(weapon, "SapphireWandNew" ) == 0 || StrIcmp(weapon, "DualSapphireWandsNew" ) == 0)
     {
      showmanabar = 1;
     }
     If(StrIcmp(weapon, "SerpentStaffAilish") == 0) //Ailish's version of the Serpent Staff uses Mana.
     {
      showmanabar = 1;
	 }
     If(showmanabar == 1)
     {
      ammo = CurrentMana;
      maxammo = MaxMana;
     }
     If(StrIcmp(weapon, "AChristina") == 0) //Show Ether stock for A. Christina
     {
      showetherstock = 1;
	 }
     SetActivator(0);

     // Weapon Icons
     xpos = ScreenXOffset + 1288.0; // 1288.0
     ypos = 960.0; // 960.0
     SetFont("WIEMPTY");
	  // Ailish-Specific Weapons
      If(StrIcmp(weapon, "FistAilish") == 0) SetFont("WIFISTF");
	  If(StrIcmp(weapon, "SauronGauntletsAilish") == 0) SetFont("WISGNLTF");  
	  If(StrIcmp(weapon, "SerpentStaffAilish") == 0) SetFont("WISERPST");
	  // Petra-Specific Weapons
      If(StrIcmp(weapon, "FistPetra") == 0) SetFont("WIFISTF");
	  If(StrIcmp(weapon, "SauronGauntletsPetra") == 0) SetFont("WISGNLTF");  
	  If(StrIcmp(weapon, "AChristina") == 0) SetFont("WIACHRIS");  
	  // Petra-Specific Addons from Boss-type enemies
	  If(StrIcmp(weapon, "AChristinaCyberdemon") == 0) SetFont("WIACHCYB");  
	  If(StrIcmp(weapon, "AChristinaMastermind") == 0) SetFont("WIACHSPI");  
	  If(StrIcmp(weapon, "AChristinaHades") == 0) SetFont("WIACHHOV");  
	  If(StrIcmp(weapon, "AChristinaIronLich") == 0) SetFont("WIACHLCH");  
	  If(StrIcmp(weapon, "AChristinaMaulotaur") == 0) SetFont("WIACHMAU");  
	  If(StrIcmp(weapon, "AChristinaWyvern") == 0) SetFont("WIACHWYV");  
	  If(StrIcmp(weapon, "AChristinaHeresiarch") == 0) SetFont("WIACHHER");  
	  // Special Petra-Specific Addons
	  If(StrIcmp(weapon, "AChristinaPartinias") == 0) SetFont("WIACHPAR");
	  If(StrIcmp(weapon, "AChristinaRagnarok") == 0) SetFont("WIACHRAG");
	  
      // Flora-Specfic Weapons
      If(StrIcmp(weapon, "FistFlora") == 0) 
	  {
	   SetFont("WIFISTF");
	   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) SetFont("WIFSTFG");
	  }
      If(StrIcmp(weapon, "SauronGauntletsFlora") == 0) SetFont("WISGNLTF");
      If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0) SetFont("WISCEPTR");
      If(StrIcmp(weapon, "DiarisLongbow") == 0) SetFont("WIDIARIS");
      If(StrIcmp(weapon, "ImpClaw") == 0) SetFont("WIHLCR1");
      If(StrIcmp(weapon, "DarkImpClaw") == 0) SetFont("WIHLCR2");
      If(StrIcmp(weapon, "CacodemonEye") == 0) SetFont("WIHLCR3");
      If(StrIcmp(weapon, "CacolanternEye") == 0) SetFont("WIHLCR4");
      If(StrIcmp(weapon, "AbaddonEye") == 0) SetFont("WIHLCR5");
      If(StrIcmp(weapon, "KnightFist") == 0) SetFont("WIHLCR6");
      If(StrIcmp(weapon, "BaronFist") == 0) SetFont("WIHLCR7");
      If(StrIcmp(weapon, "BelphegorFist") == 0) SetFont("WIHLCR8");
      If(StrIcmp(weapon, "BruiserFist") == 0) SetFont("WIHLCR9");
      If(StrIcmp(weapon, "ArchonFist") == 0) SetFont("WIHLCR10");
      If(StrIcmp(weapon, "PyroFist") == 0) SetFont("WIHLCR11");
      If(StrIcmp(weapon, "IncarnateSkull") == 0) SetFont("WIHLCR12");
      If(StrIcmp(weapon, "ArchvileHand") == 0) SetFont("WIHLCR13");
      If(StrIcmp(weapon, "DiabloistHand") == 0) SetFont("WIHLCR14");
      If(StrIcmp(weapon, "BalrogFist") == 0) SetFont("WIHLCR15");
      // Deggaris-Specfic Weapons
      If(StrIcmp(weapon, "FistDeggaris") == 0) 
	  {
	   SetFont("WIFISTD");
	   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) SetFont("WIFISD2");
	  }
      If(StrIcmp(weapon, "SauronGauntlets") == 0) SetFont("WISGNLTD");
      // Illucia-Specfic Weapons
      If(StrIcmp(weapon, "FistIllucia") == 0) 
	  {
	   SetFont("WIFISTI");
	   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) SetFont("WIFISI2");
	  }
      If(StrIcmp(weapon, "SauronGauntletsIllucia") == 0) SetFont("WISGNLTI");
      // Marine Weapons
      If(StrIcmp(weapon, "Chainsaw2") == 0) SetFont("WICNSW");
      If(StrIcmp(weapon, "DoubleBladedChainsaw") == 0) SetFont("WIDCNSW");
      If(StrIcmp(weapon, "Pistol2") == 0) SetFont("WIPISTL");
      If(StrIcmp(weapon, "DualPistols") == 0) SetFont("WIDPISTL");
      If(StrIcmp(weapon, "Shotgun2") == 0) SetFont("WISHOTG");
      If(StrIcmp(weapon, "SuperShotgun2") == 0) SetFont("WISSHOTG");
      If(StrIcmp(weapon, "Chaingun2") == 0) SetFont("WICHAING");
      If(StrIcmp(weapon, "Minigun") == 0) SetFont("WIMINIG");
      If(StrIcmp(weapon, "RocketLauncher2") == 0)
      {
	   SetFont("WIROCKLA");
       if (CheckActorInventory(Player1TID,"RLMode") == 0) SetFont("WIROCKL1");
       if (CheckActorInventory(Player1TID,"RLMode") == 1) SetFont("WIROCKL2");	   
	  }
      If(StrIcmp(weapon, "PlasmaRifle2") == 0) SetFont("WIPLSRIF");
      If(StrIcmp(weapon, "Railgun2") == 0) SetFont("WIRAILGN");
      If(StrIcmp(weapon, "Repeater2") == 0) SetFont("WIREPETR");
      If(StrIcmp(weapon, "Karasawa2") == 0) SetFont("WIKAWAS");
      If(StrIcmp(weapon, "BFG90002") == 0) SetFont("WIBFG9K");
      // Circus2 Weapons
      If(StrIcmp(weapon, "ClownGrenadeNew") == 0) SetFont("WICLWNGR");
      If(StrIcmp(weapon, "GutFlingerNew") == 0) SetFont("WIGUTFLN");
      If(StrIcmp(weapon, "GasRocketLauncherNew") == 0) SetFont("WIGASRKT");
      If(StrIcmp(weapon, "GoreBalloonNew") == 0) SetFont("WIGORBAL");
      If(StrIcmp(weapon, "PopcornGunNew") == 0) SetFont("WIPOPCGN");
      If(StrIcmp(weapon, "CrazyBall2New") == 0) SetFont("WICRZBAL");
      // Heretic Weapons 
      If(StrIcmp(weapon, "GoldWandNew") == 0) SetFont("WIGWAND1");
      If(StrIcmp(weapon, "DualGoldWandNew") == 0) SetFont("WIGWAND2");
      If(StrIcmp(weapon, "CrossbowNew") == 0) SetFont("WICRBOW1");
      If(StrIcmp(weapon, "DualCrossbowNew") == 0) SetFont("WICRBOW2");
      If(StrIcmp(weapon, "SuperCrossbowNew") == 0) SetFont("WISCRBW1");
      If(StrIcmp(weapon, "DualSuperCrossbowNew") == 0) SetFont("WISCRBW2");
      If(StrIcmp(weapon, "DragonClawNew") == 0) SetFont("WIDCLWS1");
      If(StrIcmp(weapon, "DualDragonClawNew") == 0) SetFont("WIDCLWD1");
      If(StrIcmp(weapon, "HellStaffNew") == 0) SetFont("WIHELST1");
      If(StrIcmp(weapon, "DualHellStaffNew") == 0) SetFont("WIHELST2");
      If(StrIcmp(weapon, "PhoenixRodNew") == 0) SetFont("WIPHNRD1");
      If(StrIcmp(weapon, "DualPhoenixRodNew") == 0) SetFont("WIPHNRD2");
      If(StrIcmp(weapon, "FiremaceNew") == 0) SetFont("WIFIRMC1");
      If(StrIcmp(weapon, "DualFiremaceNew") == 0) SetFont("WIFIRMC2");
      If(StrIcmp(weapon, "DSparilStaff") == 0) SetFont("WIDSTAF1");
      If(StrIcmp(weapon, "DualDSparilStaff") == 0) SetFont("WIDSTAF2");
      // Strife Weapons
      If(StrIcmp(weapon, "StrifeCrossbowNew") == 0) SetFont("WICROSS1");
      If(StrIcmp(weapon, "StrifeCrossbow2New") == 0) SetFont("WICROSS2");
      If(StrIcmp(weapon, "StrifeCrossbowDualNew") == 0) SetFont("WICROSD1");
      If(StrIcmp(weapon, "StrifeCrossbow2DualNew") == 0) SetFont("WICROSD2");
      If(StrIcmp(weapon, "AssaultGunNew") == 0) SetFont("WIASSTS1");
      If(StrIcmp(weapon, "AssaultGunDualNew") == 0) SetFont("WIASSTD1");
      If(StrIcmp(weapon, "MiniMissileLauncherNew") == 0) SetFont("WIMMSLS1");
      If(StrIcmp(weapon, "MiniMissileLauncherDualNew") == 0) SetFont("WIMMSLD1");
      If(StrIcmp(weapon, "FlameThrowerNew") == 0) SetFont("WIFLMS1");
      If(StrIcmp(weapon, "StrifeGrenadeLauncherNew") == 0) SetFont("WIGRNDS1");
      If(StrIcmp(weapon, "StrifeGrenadeLauncher2New") == 0) SetFont("WIGRNDS1");
      If(StrIcmp(weapon, "MaulerNew") == 0) SetFont("WIMALRS1");
      If(StrIcmp(weapon, "Mauler2New") == 0) SetFont("WIMALRS1");
      If(StrIcmp(weapon, "NNSigil") == 0 || StrIcmp(weapon, "Sigil") == 0)
	  {
	   SetActivator(Player1TID);
       int sigil_pieces = GetSigilPieces();
	   SetActivator(0);
	   if (sigil_pieces == 1) SetFont("WISIGIL1");
	   if (sigil_pieces == 2) SetFont("WISIGIL2");
	   if (sigil_pieces == 3) SetFont("WISIGIL3");
	   if (sigil_pieces == 4) SetFont("WISIGIL4");
	   if (sigil_pieces == 5) SetFont("WISIGIL5");
	   // PrintBold(s:"Pieces: ",d:sigil_pieces);
	  }
	  // KDIZD Weapons
      If(StrIcmp(weapon, "Rifle") == 0) SetFont("WIKDRIF");
      If(StrIcmp(weapon, "KDiZDGrenadeLauncher") == 0) SetFont("WIKDGRN");
      If(StrIcmp(weapon, "EvilWarriorShield") == 0) SetFont("WIEVWASH");
      If(StrIcmp(weapon, "SapphireWandNew") == 0) SetFont("WISAPWND");
      If(StrIcmp(weapon, "DualSapphireWandsNew") == 0) SetFont("WISAPWN2");

	  // Doom 64 Weapons
      If(StrIcmp(weapon, "64UnmakerFlora") == 0) SetFont("WIUNMAKE");
      If(StrIcmp(weapon, "64UnmakerPetra") == 0) SetFont("WIUNMAKE");
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      HudMessage(s:"A";HUDMSG_ALPHA,6206,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); // 6206



     // Ammo [1] / SceptreLevel Label
     int HellcoreLevel;
     Keyname = "+attack";
     str Keyname2 = "+moveleft";
     str Keyname3 = "+moveright";
     xpos = ScreenXOffset + 1149.0;
     ypos = 1060.0;
     If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0)
     {
      // Sceptre "LVL" Text [5901]
      if (GetCVar("dvds_noscexpgains") == 0)
      {
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"LVL \cg",d:SceptreActualLevel;HUDMSG_ALPHA,5901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      if (MiscellaneousVars[244] > 0)
      {
       // Spin Attack Indicator Icon [5900]
       xpos = ScreenXOffset + 1150.0;
       ypos = 992.0;
       SetFont("SCEPTSPN");
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,5900,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
     }
     else
     {
      // HP/MP/AMMO Text [1] [5901]
      if (maxammo > 0)
      {
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       SetFont("DQHUDFONTSML");
       If(showmanabar == 1)
       {
        HudMessage(s:"MP";HUDMSG_ALPHA,5901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
	   else
       If(StrIcmp(weapon, "NNSigil") == 0 || StrIcmp(weapon, "Sigil") == 0)
       {
        HudMessage(s:"HP";HUDMSG_ALPHA,5901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
	   else
       {
        HudMessage(s:"AMMO";HUDMSG_ALPHA,5901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
      }
      else
      {
       // [96] is the Current Level of the Imp's Claw
       // [97] is the Current Level of the Dark Imp's Claw
       // [98] is the Current Level of the Cacodemon's Eye
       // [99] is the Current Level of the Cacolantern's Eye
       // [100] is the Current Level of the Abaddon's Eye

       // [101] is the Current Level of the Hell Knight's Fist
       // [102] is the Current Level of the Baron of Hell's Fist
       // [103] is the Current Level of the Belphegor's Fist
       // [104] is the Current Level of the Bruiser Demon's Fist
       // [105] is the Current Level of the Archon of Hell's Fist
       // [106] is the Current Level of the Pyro Demon's Fist

       // [107] is the Current Level of the Death Incarnate's Skull
       // [108] is the Current Level of the Archvile's Hand
       // [109] is the Current Level of the Diabloist's Hand
       // [110] is the Current Level of the Flying Balrog's Fist

       // [111] is the Current Level of the Hades Elemental's Eye [?]
       // [112] is the Current Level of the Hades Overlord's Eye [?]
       // Hellcore "LVL" Text [1] [5901]
       Z2 = 0;
       xpos = ScreenXOffset + 1309.0;
       ypos = 1060.0;
       SetFont("DQHUDFONTSML");
       If(StrIcmp(weapon, "ImpClaw") == 0) { HellcoreLevel = MiscellaneousVars[96]; Z2 += 1; }
       If(StrIcmp(weapon, "DarkImpClaw") == 0) { HellcoreLevel = MiscellaneousVars[97]; Z2 += 1; }
       If(StrIcmp(weapon, "CacodemonEye") == 0) { HellcoreLevel = MiscellaneousVars[98]; Z2 += 1; }
       If(StrIcmp(weapon, "CacolanternEye") == 0) { HellcoreLevel = MiscellaneousVars[99]; Z2 += 1; }
       If(StrIcmp(weapon, "AbaddonEye") == 0) { HellcoreLevel = MiscellaneousVars[100]; Z2 += 1; }
       If(StrIcmp(weapon, "KnightFist") == 0) { HellcoreLevel = MiscellaneousVars[101]; Z2 += 1; }
       If(StrIcmp(weapon, "BaronFist") == 0) { HellcoreLevel = MiscellaneousVars[102]; Z2 += 1; }
       If(StrIcmp(weapon, "BelphegorFist") == 0) { HellcoreLevel = MiscellaneousVars[103]; Z2 += 1; }
       If(StrIcmp(weapon, "BruiserFist") == 0) { HellcoreLevel = MiscellaneousVars[104]; Z2 += 1; }
       If(StrIcmp(weapon, "ArchonFist") == 0) { HellcoreLevel = MiscellaneousVars[105]; Z2 += 1; }
       If(StrIcmp(weapon, "PyroFist") == 0) { HellcoreLevel = MiscellaneousVars[106]; Z2 += 1; }
       If(StrIcmp(weapon, "IncarnateSkull") == 0) { HellcoreLevel = MiscellaneousVars[107]; Z2 += 1; }
       If(StrIcmp(weapon, "ArchvileHand") == 0) { HellcoreLevel = MiscellaneousVars[108]; Z2 += 1; }
       If(StrIcmp(weapon, "DiabloistHand") == 0) { HellcoreLevel = MiscellaneousVars[109]; Z2 += 1; }
       If(StrIcmp(weapon, "BalrogFist") == 0) { HellcoreLevel = MiscellaneousVars[110]; Z2 += 1; }
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       if (Z2 > 0) HudMessage(s:"LVL \cg",d:HellcoreLevel;HUDMSG_ALPHA,5901,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
     }

     // Ammo Amounts / Sceptre EXP [5902]
     xpos = ScreenXOffset + 1289.0;
     ypos = 1066.0;
     If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0)
     {
      if (GetCVar("dvds_noscexpgains") == 0)
      {
       G1 = SceptreLevelEXP;
       if (SceptreActualLevel < 1) { G3 = 0; G2 = MiscellaneousVars[301]; }
       if (SceptreActualLevel == 1) { G3 = MiscellaneousVars[301]; G2 = MiscellaneousVars[302]; }
       if (SceptreActualLevel == 2) { G3 = MiscellaneousVars[302]; G2 = MiscellaneousVars[303]; }
       if (SceptreActualLevel == 3) { G3 = MiscellaneousVars[303]; G2 = MiscellaneousVars[304]; }
       if (SceptreActualLevel == 4) { G3 = MiscellaneousVars[304]; G2 = MiscellaneousVars[305]; }
       if (SceptreActualLevel == 5) { G3 = MiscellaneousVars[305]; G2 = MiscellaneousVars[306]; }
       if (SceptreActualLevel == 6) { G3 = MiscellaneousVars[306]; G2 = MiscellaneousVars[307]; }
       if (SceptreActualLevel == 7) { G3 = MiscellaneousVars[307]; G2 = MiscellaneousVars[308]; }
       if (SceptreActualLevel == 8) { G3 = MiscellaneousVars[308]; G2 = MiscellaneousVars[309]; }
       if (SceptreActualLevel == 9) { G3 = MiscellaneousVars[309]; G2 = MiscellaneousVars[310]; }
       if (SceptreActualLevel == 10) { G3 = MiscellaneousVars[310]; G2 = MiscellaneousVars[311]; }
       if (SceptreActualLevel == 11) { G3 = MiscellaneousVars[311]; G2 = MiscellaneousVars[312]; }
       if (SceptreActualLevel == 12) { G3 = MiscellaneousVars[312]; G2 = MiscellaneousVars[313]; }
       if (SceptreActualLevel == 13) { G3 = MiscellaneousVars[313]; G2 = MiscellaneousVars[314]; }
       if (SceptreActualLevel == 14) { G3 = MiscellaneousVars[314]; G2 = MiscellaneousVars[315]; }
       if (SceptreActualLevel >= 15) { G3 = MiscellaneousVars[315]; G2 = MiscellaneousVars[316]; }

       G4 = G2 - G3;
       G1 -= G3;
       G5 = SceptreLevelEXP; 
       if (G5 > MiscellaneousVars[316]) G5 = MiscellaneousVars[316];
 
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:SceptreLevelEXP;HUDMSG_ALPHA,5902,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
     }
     else
     {
      If(showmanabar == 1)
      {
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:CurrentMana,s:"/",d:MaxMana;HUDMSG_ALPHA,5902,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
	  else
      if (maxammo > 0)
      {
       SetFont("DQHUDFONTSML");
       msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(d:ammo,s:"/",d:maxammo;HUDMSG_ALPHA,5902,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
     }

     if (GetCVar("dvdsnewhud_showprimarymeters") == 1)
     {
      // Ammo Meter Empty "Glow" Border [5903]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1060.0;
      if (maxammo > 0)
      {
       Z1 = 0;
       if (maxammo > 0) // if the weapon has any ammo maximum
       {
        If(StrIcmp(weapon, "BFG90002") == 0)
        {
         if (ammo < 40) Z1 += 1;
        }
        else
        If(StrIcmp(weapon, "Karasawa2") == 0)
        {
         if (ammo < 8) Z1 += 1;
        }
        else
        If(StrIcmp(weapon, "Repeater2") == 0)
        {
         if (ammo < 2) Z1 += 1;
        }
        else
        {
         if (ammo < 1) Z1 += 1;
        }
       }
 
       if (Z1 > 0)
       {
        SetFont("AMMBEMPT");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
 
      // Ammo Meter / Sceptre EXP Meter Border [5904]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1060.0;
      If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0)
      {
       if (GetCVar("dvds_noscexpgains") == 0)
       {
        SetFont("SCBFRAME"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,5904,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       If(showmanabar == 1)
       {
        SetFont("MPBFRAME"); // SetFont("SCBFRAME"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,5904,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
	   else
	   if(showetherstock == 1)
	   {
	   //This needs to eventually be optimized for later and possibly use less code...
		SetFont("ACMFULL");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        if (CheckActorInventory(Player1TID,"EtherStock") == 12) { HudMessage(s:"AAAAAA\nAAAAAA";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 11) { HudMessage(s:"AAAAAA\nAAAAAB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 10) { HudMessage(s:"AAAAAA\nAAAABB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 9) { HudMessage(s:"AAAAAA\nAAABBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 8) { HudMessage(s:"AAAAAA\nAABBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 7) { HudMessage(s:"AAAAAA\nABBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 6) { HudMessage(s:"AAAAAA\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 5) { HudMessage(s:"AAAAAB\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 4) { HudMessage(s:"AAAABB\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 3) { HudMessage(s:"AAABBB\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 2) { HudMessage(s:"AABBBB\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }
        if (CheckActorInventory(Player1TID,"EtherStock") == 1) { HudMessage(s:"ABBBBB\nBBBBBB";HUDMSG_ALPHA,5903,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha); }

		SetFont("ACMEMPTY");
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"AAAAAA\nAAAAAA";HUDMSG_ALPHA,5904,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
	   else
       if (maxammo > 0)
       {
        SetFont("AMMBFRAM"); // SetFont("SCBFRAME"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
		HudMessage(s:"A";HUDMSG_ALPHA,5904,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }

      // AMMO Meter Notches [6000-6200]
      xpos = ScreenXOffset + 1188.0; // 1188.0
      ypos = 1060.0; // 1060.0
      msgalpha = 0.75;
 
      if (maxammo != 0)
      {
       G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
       G9 = 200 / G10;
       I1 = ammo * G9 / maxammo;
       if (I1 > G9) I1 = G9;
       if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
       // Normal
       for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
       {    
        if (C1 <= I1)
        {
         If(StrIcmp(weapon, "NNSigil") == 0 || StrIcmp(weapon, "Sigil") == 0)
	     {
          if (G10 == 10) { SetFont("HPBFILNA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("HPBFILN4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("HPBFILN2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("HPBFILNR"); G11 = 1.0; }
		 }
		 else
         If(showmanabar == 1)
         {
          if (G10 == 10) { SetFont("MPBFILNA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("MPBFILN4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("MPBFILN2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("MPBFILNR"); G11 = 1.0; }
		 }
		 else
		 {
          if (G10 == 10) { SetFont("AMMBFILA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("AMMBFIL4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("AMMBFIL2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("AMMBFILL"); G11 = 1.0; }
		 }
        }
        else SetFont("SCBFILEM");
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+6000,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else // Sceptre EXP Notches
      {
       If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0)
       {
        if (GetCVar("dvds_noscexpgains") == 0)
        {
         G1 = SceptreLevelEXP;
         if (SceptreActualLevel < 1) { G3 = 0; G2 = MiscellaneousVars[301]; }
         if (SceptreActualLevel == 1) { G3 = MiscellaneousVars[301]; G2 = MiscellaneousVars[302]; }
         if (SceptreActualLevel == 2) { G3 = MiscellaneousVars[302]; G2 = MiscellaneousVars[303]; }
         if (SceptreActualLevel == 3) { G3 = MiscellaneousVars[303]; G2 = MiscellaneousVars[304]; }
         if (SceptreActualLevel == 4) { G3 = MiscellaneousVars[304]; G2 = MiscellaneousVars[305]; }
         if (SceptreActualLevel == 5) { G3 = MiscellaneousVars[305]; G2 = MiscellaneousVars[306]; }
         if (SceptreActualLevel == 6) { G3 = MiscellaneousVars[306]; G2 = MiscellaneousVars[307]; }
         if (SceptreActualLevel == 7) { G3 = MiscellaneousVars[307]; G2 = MiscellaneousVars[308]; }
         if (SceptreActualLevel == 8) { G3 = MiscellaneousVars[308]; G2 = MiscellaneousVars[309]; }
         if (SceptreActualLevel == 9) { G3 = MiscellaneousVars[309]; G2 = MiscellaneousVars[310]; }
         if (SceptreActualLevel == 10) { G3 = MiscellaneousVars[310]; G2 = MiscellaneousVars[311]; }
         if (SceptreActualLevel == 11) { G3 = MiscellaneousVars[311]; G2 = MiscellaneousVars[312]; }
         if (SceptreActualLevel == 12) { G3 = MiscellaneousVars[312]; G2 = MiscellaneousVars[313]; }
         if (SceptreActualLevel == 13) { G3 = MiscellaneousVars[313]; G2 = MiscellaneousVars[314]; }
         if (SceptreActualLevel == 14) { G3 = MiscellaneousVars[314]; G2 = MiscellaneousVars[315]; }
         if (SceptreActualLevel >= 15) { G3 = MiscellaneousVars[315]; G2 = MiscellaneousVars[316]; }

         G4 = G2 - G3;
         G1 -= G3;
  
         if (G4 > 0)
         {
          G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
          G9 = 200 / G10;
          I1 = G1 * G9 / G4;
          if (I1 > G9) I1 = G9;
          if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
          for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 201; C1 > 1; C1 --)
          {    
           if (C1 <= I1)
           {
            if (G10 == 10) { SetFont("SCBFILLA"); G11 = -4.0; }
            if (G10 == 4) { SetFont("SCBFILL4"); G11 = -1.0; } // +3
            if (G10 == 2) { SetFont("SCBFILL2"); G11 = 0.0; } // +1 
            if (G10 == 1) { SetFont("SCBFILLN"); G11 = 1.0; } // +1
           }
           else SetFont("SCBFILEM");
           I2 = ((C1 << 16) * G10) + G11;
           msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
           HudMessage(s:"A";HUDMSG_ALPHA,C1+6000,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
          }
         }
        }
       }
      }
 
      // Ammo Meter / Sceptre EXP Meter Glass [6205]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1060.0;
      If(StrIcmp(weapon, "SceptreOfEmpyrea") == 0)
      {
       if (GetCVar("dvds_noscexpgains") == 0)
       {
        SetFont("SCBGLASS"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,6205,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
      else
      {
       If(showmanabar == 1)
       {
        SetFont("MPBGLASS"); // SetFont("SCBGLASS"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,6205,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	   }
  	   else
       if (maxammo > 0)
       {
        SetFont("AMMBGLSS"); // SetFont("SCBGLASS"); 
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,6205,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
       }
      }
     }



	 //************************************************************* 
	 // Minigun HEAT/MP [for Heretic weapons using Tomed Alt-Fires] [6301+]
	 //************************************************************* 
     int minigunheat = CheckActorInventory(Player1TID,"MinigunHeat");
     int minigunheatmax = 100;
     if (showsecondmeter == 1 && GetCVar("dvdsnewhud_showsecondaryweapmeter") == 1)
	 {
      xpos = ScreenXOffset + MiscFixedVars[0]; // 1289.0;
      ypos = MiscFixedVars[1]; // 1060.0;

      // "Heat/MP" Text [6301]
      xpos = ScreenXOffset + 1149.0;
      ypos = 1028.0;
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      SetFont("DQHUDFONTSML");
      If(StrIcmp(weapon, "Minigun") == 0)
      {
	   minigunheat = CheckActorInventory(Player1TID,"MinigunHeat");
       HudMessage(s:"HEAT";HUDMSG_ALPHA,6301,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
      If(StrIcmp(weapon, "Railgun2") == 0)
      {
	   minigunheat = CheckActorInventory(Player1TID,"RailgunCharge");
       HudMessage(s:"CHRG";HUDMSG_ALPHA,6301,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
	  {
       HudMessage(s:"MP";HUDMSG_ALPHA,6301,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }
	   
      // "Heat/MP" Amounts [6302]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1034.0;
      SetFont("DQHUDFONTSML");
      msgalpha = 0.875; msgalpha = FixedMul(msgalpha,overallhudalpha);
      If(StrIcmp(weapon, "Minigun") == 0)
      {
       HudMessage(d:minigunheat,s:"%";HUDMSG_ALPHA,6302,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
      If(StrIcmp(weapon, "Railgun2") == 0)
      {
       HudMessage(d:minigunheat,s:"%";HUDMSG_ALPHA,6302,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
	  {
       HudMessage(d:CurrentMana,s:"/",d:MaxMana;HUDMSG_ALPHA,6302,cr_white,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }

	  // Heat Meter Empty "Glow" Border [6303]
      xpos = ScreenXOffset + 1291.0;
      ypos = 1028.0; // 1060.0;
      msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
      If(StrIcmp(weapon, "Minigun") == 0)
      {
	   int miniheatalpha = 0.01 * CheckActorInventory(Player1TID,"MinigunHeat");
       msgalpha = FixedMul(msgalpha,miniheatalpha);
       SetFont("MHBOVHET");
       HudMessage(s:"A";HUDMSG_ALPHA,6303,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      If(StrIcmp(weapon, "Railgun2") == 0)
      {
	   int chargealpha = 0.01 * CheckActorInventory(Player1TID,"RailgunCharge");
       msgalpha = FixedMul(msgalpha,chargealpha);
       SetFont("AIBFOCUS");
       HudMessage(s:"A";HUDMSG_ALPHA,6303,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
 
 	  // Heat/MP Meter Border [6304]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1028.0; // 1060.0;
      msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
      If(StrIcmp(weapon, "Minigun") == 0)
      {
       SetFont("MHBFRAME"); 
       HudMessage(s:"A";HUDMSG_ALPHA,6304,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      else
      If(StrIcmp(weapon, "Railgun2") == 0)
      {
       SetFont("MHBFRAME"); 
       HudMessage(s:"A";HUDMSG_ALPHA,6304,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
      else
      {
       SetFont("MPBFRAME"); // SetFont("SCBFRAME"); 
       HudMessage(s:"A";HUDMSG_ALPHA,6304,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }

	  
	  //
      // AMMO Meter Notches [6400-6600]
      xpos = ScreenXOffset + 1188.0; // 1188.0
      ypos = 1028.0; // 1060.0
      msgalpha = 0.75;
 
      G10 = GetCVar("dvdsnewhud_hudmeternotchdetail");
      G9 = 200 / G10;
            If(StrIcmp(weapon, "Minigun") == 0) { I1 = minigunheat * G9 / minigunheatmax; xpos+= 5.0; }
      else If(StrIcmp(weapon, "Railgun2") == 0) { I1 = minigunheat * G9 / minigunheatmax; xpos+= 5.0; }
	                                       else { I1 = currentmana * G9 / maxmana; }
      if (I1 > G9) I1 = G9;
      if (GetCVar("dvdsnewhud_showemptynotches") == 0) G7 = I1; else G7 = G9;
      // Normal
      for (C1 = 1; C1 <= G7; C1 ++) //for (C1 = 101; C1 > 1; C1 --)
      {    
        if (C1 <= I1)
        {
         If(StrIcmp(weapon, "Minigun") == 0)
         {
          if (G10 == 10) { SetFont("MHBFILNA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("MHBFILN4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("MHBFILN2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("MHBFILNR"); G11 = 1.0; }
		 }
		 else
         If(StrIcmp(weapon, "Railgun2") == 0)
         {
          if (G10 == 10) { SetFont("AIBFILNA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("AIBFILN4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("AIBFILN2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("AIBFILNR"); G11 = 1.0; }
		 }
		 else
		 {
          if (G10 == 10) { SetFont("MPBFILNA"); G11 = -4.0; }
          if (G10 == 4) { SetFont("MPBFILN4"); G11 = -1.0; }
          if (G10 == 2) { SetFont("MPBFILN2"); G11 = 0.0; }
          if (G10 == 1) { SetFont("MPBFILNR"); G11 = 1.0; }
		 }
        }
        I2 = ((C1 << 16) * G10) + G11;
        msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
        HudMessage(s:"A";HUDMSG_ALPHA,C1+6400,cr_untranslated,xpos+I2,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  
	  
      // "HEAT/MP" Meter Glass [6605]
      xpos = ScreenXOffset + 1289.0;
      ypos = 1028.0;
      If(StrIcmp(weapon, "Minigun") == 0)
      {
       SetFont("MHBGLASS"); 
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,6605,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
      If(StrIcmp(weapon, "Railgun2") == 0)
      {
       SetFont("MHBGLASS"); 
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,6605,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
      }
	  else
	  {
       SetFont("MPBGLASS"); 
       msgalpha = 0.75; msgalpha = FixedMul(msgalpha,overallhudalpha);
       HudMessage(s:"A";HUDMSG_ALPHA,6605,cr_untranslated,xpos,ypos,HUDMsgDelayFixed,msgalpha);
	  }

	 }
     SetHudSize(0,0,0);
  }
 }

 SetHudSize(0,0,0);

 Delay(HUDMsgDelayBase);
 Restart;
}

script "ManaRegenerationStuff" ENTER
{
 int C1, I1, C2, I2, RegenedMana, G2, ManaReDelay, ExtraManaRegen, G4, DoveManaTimer, G5, MaxRegenableMana, EquippedRegenCap, SkillLevelManaDelay, OverallDelay;
 int MaxManaLimit, buttons, delaycount;
 int FocusHumTimer, PerkFactor;
 int StamUpgradeDelay;

 if (FirstRun == 0)
 {
  FirstRun = 1;
  Thing_ChangeTID(0,Player1TID);
 }

 str weapon = GetWeapon();

 // Base Delay Count
 delaycount = 20; // 20 = 1 tic

 // Stamina Upgrades [Strife]
 StamUpgradeDelay = (MiscellaneousVars[317] * 2) / 3;
 delaycount += StamUpgradeDelay;
 
 // Accelerates MP Regen when Tension is Boosted
 if (MiscellaneousVars[181] >= 1) delaycount += 1; // "5" = +1 [+5%]
 if (MiscellaneousVars[181] >= 2) delaycount += 1; // "20" = +2 [+10%]
 if (MiscellaneousVars[181] >= 3) delaycount += 2; // "50" = +4 [+20%]
 if (MiscellaneousVars[181] >= 4) delaycount += 2; // "100" = +6 [+30%]
 if (MiscellaneousVars[181] >= 5) delaycount += 3; // "250" = +9 [+45%]
 if (MiscellaneousVars[181] >= 6) delaycount += 4; // "500" = +13 [+65%]
 if (MiscellaneousVars[181] >= 7) delaycount += 5; // "1000" = +18 [+90%]
 if (MiscellaneousVars[181] >= 5 && MiscellaneousVars[184] == 0) delaycount = delaycount * random(40,50) / 40; // +~25%
 // PowerTrip Mode
 if (GetCVar("dvds_musou_powertripmode") == 1) delaycount = delaycount * 5 / 2; // 250%
 if (GetCVar("dvds_musou_powertripmode") == 2) delaycount = delaycount * 5; // 500%

 if (PowerupTimer[12] > 0) delaycount = delaycount * 6 / 5; // Acceleratle = 1.2x regen speed
 if (PowerupTimer[15] > 0) delaycount = delaycount * 4 / 5; // Deceleratle = 0.8x regen speed
 if (PowerupTimer[18] > 0) delaycount /= 5; // Fatigue = 0.2x regen speed
 if (PowerupTimer[20] > 0)
 {
  delaycount *= 5; // Sleep = 5x regen speed
  PerkFactor = ((MiscellaneousVars[10015] * 2000) + (MiscellaneousVars[10016] * 5000)) + 10000;
  delaycount = delaycount * PerkFactor / 10000; // "RegenMPFast" and "RegenMPFast EX" perks.
 }
 // Ruinous Shield - greatly reduces MP regeneration speed
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"RuinousShield") > 0) delaycount = delaycount * 3 / 8; // 37.5%

 // RegenMPFast perks
 if (MiscellaneousVars[10015] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10015] * 2) + (MiscellaneousVars[10016] * 5)) + 10;
  delaycount = delaycount * PerkFactor / 10; // "RegenMPFast" and "RegenMPFast EX" perks.
 }

 // "Cleared of Mind" Perks
 if (MiscellaneousVars[10055] > 0)
 {
  perkfactor = ((MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5)) + 80;
  delaycount = delaycount * perkfactor / 80;
 }
  
 // Checks Mana Regen Rate Menu Option
 delaycount = delaycount * GetCVar("dvds_manaregenratemultiplier") / 100;
 if (MiscellaneousVars[212] > 0) // Focusing
 {
  // Slowly increases the speed of regen as focus lasts longer
  if (MiscellaneousVars[231] >= 140) delaycount += 1; // [4 seconds]
  if (MiscellaneousVars[231] >= 245) delaycount += 1; // [7 seconds]
  if (MiscellaneousVars[231] >= 350) delaycount += 2; // [10 seconds]
  if (MiscellaneousVars[231] >= 490) delaycount += 2; // [14 seconds]
  if (MiscellaneousVars[231] >= 630) delaycount += 3; // [18 seconds]
  if (MiscellaneousVars[231] >= 770) delaycount += 3; // [22 seconds]
  if (MiscellaneousVars[231] >= 980) delaycount += 4; // [28 seconds]
  if (MiscellaneousVars[231] >= 1190) delaycount += 4; // [34 seconds]
  if (MiscellaneousVars[231] >= 1470) delaycount += 5; // [42 seconds]
  if (MiscellaneousVars[231] >= 1750) delaycount += 5; // [50 seconds]
  if (MiscellaneousVars[231] >= 2100) delaycount += 6; // [60 seconds]
  if (MiscellaneousVars[231] >= 2450) delaycount += 6; // [70 seconds]
  if (MiscellaneousVars[231] >= 2870) delaycount += 7; // [82 seconds]
  if (MiscellaneousVars[231] >= 3290) delaycount += 7; // [94 seconds]
  if (MiscellaneousVars[231] >= 3780) delaycount += 8; // [108 seconds]
  if (MiscellaneousVars[231] >= 4270) delaycount += 8; // [122 seconds]
  if (MiscellaneousVars[231] >= 2100) delaycount = (delaycount * 3) / 2; // [60 seconds]
  if (MiscellaneousVars[231] >= 4200) delaycount = (delaycount * 3) / 2; // [60 seconds]

  if (MiscellaneousVars[317] > 0)
  {
   if (MiscellaneousVars[231] >= 350) delaycount += (MiscellaneousVars[317] * 1) / 4;
   if (MiscellaneousVars[231] >= 700 && MiscellaneousVars[317] >= 2) delaycount += (MiscellaneousVars[317] * 1) / 4;
   if (MiscellaneousVars[231] >= 1050 && MiscellaneousVars[317] >= 4) delaycount += (MiscellaneousVars[317] * 1) / 3;
   if (MiscellaneousVars[231] >= 1400 && MiscellaneousVars[317] >= 6) delaycount += (MiscellaneousVars[317] * 1) / 3;
   if (MiscellaneousVars[231] >= 1750 && MiscellaneousVars[317] >= 8) delaycount += (MiscellaneousVars[317] * 1) / 2;
   if (MiscellaneousVars[231] >= 2100 && MiscellaneousVars[317] >= 10) delaycount += (MiscellaneousVars[317] * 1) / 2;
  }

  if (random(1,25) == 1) delaycount *= 8; else delaycount *= 4;

  FocusHumTimer = MiscellaneousVars[231] % 25;
  if (MiscellaneousVars[231] >= 140) FocusHumTimer = MiscellaneousVars[231] % 24;
  if (MiscellaneousVars[231] >= 245) FocusHumTimer = MiscellaneousVars[231] % 23;
  if (MiscellaneousVars[231] >= 315) FocusHumTimer = MiscellaneousVars[231] % 22;
  if (MiscellaneousVars[231] >= 350) FocusHumTimer = MiscellaneousVars[231] % 21;
  if (MiscellaneousVars[231] >= 490) FocusHumTimer = MiscellaneousVars[231] % 19;
  if (MiscellaneousVars[231] >= 630) FocusHumTimer = MiscellaneousVars[231] % 17;
  if (MiscellaneousVars[231] >= 910) FocusHumTimer = MiscellaneousVars[231] % 15;
  if (MiscellaneousVars[231] >= 2100) FocusHumTimer = MiscellaneousVars[231] % 12;
  if (FocusHumTimer == 1)
  {
   ActivatorSound("focushum",127);
  }
 }

 If(StrIcmp(weapon, "SapphireWandNew") == 0)
 {
  if (MiscellaneousVars[10053] == 1) delaycount = delaycount * 21 / 20;
  if (MiscellaneousVars[10053] == 2) delaycount = delaycount * 23 / 20;
  if (MiscellaneousVars[10053] == 3) delaycount = delaycount * 26 / 20;
  if (MiscellaneousVars[10053] == 4) delaycount = delaycount * 30 / 20;
  if (MiscellaneousVars[10053] == 5) delaycount = delaycount * 35 / 20;
 }
 If(StrIcmp(weapon, "DualSapphireWandsNew") == 0)
 {
  if (MiscellaneousVars[10053] == 1) delaycount = delaycount * 22 / 20;
  if (MiscellaneousVars[10053] == 2) delaycount = delaycount * 26 / 20;
  if (MiscellaneousVars[10053] == 3) delaycount = delaycount * 32 / 20;
  if (MiscellaneousVars[10053] == 4) delaycount = delaycount * 40 / 20;
  if (MiscellaneousVars[10053] == 5) delaycount = delaycount * 50 / 20;
 }

 if (delaycount < 1) delaycount = 1;
 if (MenuSystemVars[0] != 0) delaycount = 0; // In-Game Menus are On
 if (DVDSSpecialArrayValue[0] == 0 && CurrentMana < MaxMana) MiscellaneousVars[211] -= delaycount; // If "Conscious" and Mana is below Max
  
 RegenedMana = 0;
 if (MiscellaneousVars[211] < 1)
 {
  // Main Regeneration
  if (CurrentMana < MaxMana)
  {
   C2 = GetActorProperty(Player1TID,APROP_HEALTH);
   if (C2 > 0)
   {
    if (GameSkill() == SKILL_VERY_EASY) RegenedMana = 3;
    if (GameSkill() == SKILL_EASY) RegenedMana = random(2,3);
    if (GameSkill() == SKILL_NORMAL) RegenedMana = 2;
    if (GameSkill() == SKILL_HARD) RegenedMana = random(1,2);
    if (GameSkill() == SKILL_VERY_HARD) RegenedMana = 1;
 
    // A combined total of 12-20 points of Sorcery/Theraphesuis are needed for an extra point of MP regen.
    if (GameSkill() == SKILL_VERY_EASY) RegenedMana += ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 12);
    if (GameSkill() == SKILL_EASY) RegenedMana += ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 14);
    if (GameSkill() == SKILL_NORMAL) RegenedMana += ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 16);
    if (GameSkill() == SKILL_HARD) RegenedMana += ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 18);
    if (GameSkill() == SKILL_VERY_HARD) RegenedMana += ((MiscellaneousVars[34] + MiscellaneousVars[36]) / 20);    
   }
 
   if (PowerupTimer[7] > 0) // Divine Avatar
   {
    ExtraManaRegen = PlayerLevel / 10;
    RegenedMana += ExtraManaRegen;
    if (random(0,100) < 26)
    {
     RegenedMana = RegenedMana * 5 / 4;
    }
    else
    {
     if (random(0,100) < 51)
     {
      RegenedMana = RegenedMana * 9 / 8;
     }
    }
   }
   else
   {
    ExtraManaRegen = PlayerLevel / 25;
    RegenedMana += ExtraManaRegen;
    if (random(0,100) < 26)
    {
     RegenedMana = RegenedMana * 17 / 16;
    }
    else
    {
     if (random(0,100) < 51)
     {
      RegenedMana = RegenedMana * 33 / 32;
     }
    }
   }
 
   // Character-Based regen factors
   if (CharacterClass == 0) RegenedMana = RegenedMana * random(15,17) / 16; // Deggaris (93.75% - 106.25%)
   if (CharacterClass == 1) RegenedMana = RegenedMana * random(19,21) / 16; // Illucia (118.75% - 131.25%)
   if (CharacterClass == 2) RegenedMana = RegenedMana * random(23,25) / 16; // Flora (143.75% - 156.25%)
   if (CharacterClass == 8) RegenedMana = RegenedMana * random(23,25) / 16; // Ailish (143.75% - 156.25%)
   if (CharacterClass == 9) RegenedMana = RegenedMana * random(17,19) / 16; // Petra (106.25% - 118.75%)
 
   // Sauron's Helmet
   if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronHelmet") > 0) RegenedMana = RegenedMana * 11 / 8; // Deggaris w/ Helmet (137.5%)
   if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronHelmet") > 0) RegenedMana = RegenedMana * 10 / 8; // Illucia w/ Helmet (125%)
   if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronHelmet") > 0) RegenedMana = RegenedMana * 9 / 8; // Flora w/ Helmet (112.5%)
   if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronHelmet") > 0) RegenedMana = RegenedMana * 9 / 8; // Flora w/ Helmet (112.5%)
   if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronHelmet") > 0) RegenedMana = RegenedMana * 12 / 8; // Petra w/ Helmet (150%)
   // Sauron's Gauntlets
   if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0) RegenedMana = RegenedMana * 5 / 4; // Deggaris w/ Gauntlets (125%)
   if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) RegenedMana = RegenedMana * 5 / 4; // Illucia w/ Gauntlets (125%)
   if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) RegenedMana = RegenedMana * 5 / 4; // Flora w/ Gauntlets (125%)
   if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) RegenedMana = RegenedMana * 5 / 4; // Ailish w/ Gauntlets (125%)
   if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) RegenedMana = RegenedMana * 5 / 4; // Petra w/ Gauntlets (125%)
   // The One Ring
   if (CharacterClass == 0 && CheckActorInventory(Player1TID,"TheOneRing") > 0) RegenedMana = RegenedMana * 5 / 8; // Deggaris w/ Ring (62.5%)
   if (CharacterClass == 1 && CheckActorInventory(Player1TID,"TheOneRing") > 0) RegenedMana = RegenedMana * 6 / 8; // Illucia w/ Ring (75%)
   if (CharacterClass == 2 && CheckActorInventory(Player1TID,"TheOneRing") > 0) RegenedMana = RegenedMana * 7 / 8; // Flora w/ Ring (87.5%)
   if (CharacterClass == 8 && CheckActorInventory(Player1TID,"TheOneRing") > 0) RegenedMana = RegenedMana * 6 / 8; // Ailish w/ Ring (87.5%)
   if (CharacterClass == 9 && CheckActorInventory(Player1TID,"TheOneRing") > 0) RegenedMana = RegenedMana * 5 / 8; // Petra w/ Ring (62.5%)
 
   if (PowerupTimer[12] > 0) RegenedMana = RegenedMana * 6 / 5; // Acceleratle = +20% Regen
   if (PowerupTimer[15] > 0) RegenedMana = RegenedMana * 4 / 5; // Deceleratle = -20% Regen

   // Poison = +8.334% Regen
   if (PowerupTimer[16] > 0 && PowerupTimer[4] == 0) RegenedMana = RegenedMana * 13 / 12;
 
   // Checks Mana Regen Rate Menu Option
   RegenedMana = RegenedMana * GetCVar("dvds_manaregenmultiplier") / 100;
 
   If(StrIcmp(weapon, "SapphireWandNew") == 0)
   {
    if (MiscellaneousVars[10053] == 1) RegenedMana = RegenedMana * 41 / 40;
    if (MiscellaneousVars[10053] == 2) RegenedMana = RegenedMana * 43 / 40;
    if (MiscellaneousVars[10053] == 3) RegenedMana = RegenedMana * 45 / 40;
    if (MiscellaneousVars[10053] == 4) RegenedMana = RegenedMana * 48 / 40;
    if (MiscellaneousVars[10053] == 5) RegenedMana = RegenedMana * 51 / 40;
   }
   If(StrIcmp(weapon, "DualSapphireWandsNew") == 0)
   {
    if (MiscellaneousVars[10053] == 1) RegenedMana = RegenedMana * 42 / 40;
    if (MiscellaneousVars[10053] == 2) RegenedMana = RegenedMana * 46 / 40;
    if (MiscellaneousVars[10053] == 3) RegenedMana = RegenedMana * 50 / 40;
    if (MiscellaneousVars[10053] == 4) RegenedMana = RegenedMana * 56 / 40;
    if (MiscellaneousVars[10053] == 5) RegenedMana = RegenedMana * 62 / 40;
   }

   if (RegenedMana < 1) RegenedMana = 1;
 
   // New Addition = Caps Maximum Mana Regeneration to a certain amount based on Difficulty and armor-type items.
   MaxRegenableMana = MaxMana * 50 / 100;
   if (GameSkill() == SKILL_VERY_EASY) MaxRegenableMana = MaxMana * 61 / 100; 	// (61% of Max)
   if (GameSkill() == SKILL_EASY) MaxRegenableMana = MaxMana * 55 / 100; 		// (55% of Max)
   if (GameSkill() == SKILL_NORMAL) MaxRegenableMana = MaxMana * 50 / 100; 		// (50% of Max)
   if (GameSkill() == SKILL_HARD) MaxRegenableMana = MaxMana * 45 / 100; 		// (45% of Max)
   if (GameSkill() == SKILL_VERY_HARD) MaxRegenableMana = MaxMana * 39 / 100; 	// (39% of Max)
 
   EquippedRegenCap = 100; // in percent
   // All-Character Specfic Items
   if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) EquippedRegenCap -= 25;  // (-25% extension if Sauron's Helmet is equipped)
   if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
   if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
   if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
   if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
   if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) EquippedRegenCap += 50;  // (+50% extension if The One Ring is equipped)
 
   // Marine Specfic Items (between -4% and -16%, since only one can be equipped at once
   if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) EquippedRegenCap -= 4; // (-4% for Green Armor)
   if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) EquippedRegenCap -= 8; // (-8% for Blue Armor)
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) EquippedRegenCap -= 10; // (-10% for Stone Armor 1)
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) EquippedRegenCap -= 14; // (-14% for Diamond Armor 1)
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) EquippedRegenCap -= 12; // (-12% for Stone Armor 2)
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) EquippedRegenCap -= 16; // (-16% for Diamond Armor 2)
 
   // Flora Specfic Items (up to +150%)
   if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) EquippedRegenCap += 25;  // (+25% extension if Evenstar Necklace is equipped)
   if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) EquippedRegenCap += 62;  // (+62% extension if Anubis Cufflinks are equipped)
   if (CheckActorInventory(Player1TID,"KissaBra") > 0) EquippedRegenCap += 38; // (+38% extension if Kissa's Armor Brassiere is equipped)
   if (CheckActorInventory(Player1TID,"BalrogRing") > 0) EquippedRegenCap += 25; // (+25% extension if Balrog's Ring is equipped)
 
   if (EquippedRegenCap < 20) EquippedRegenCap = 20;
   if (EquippedRegenCap > 640) EquippedRegenCap = 640;
   MaxRegenableMana = MaxRegenableMana * EquippedRegenCap / 100;
 
   // Caps Mana Regeneration to a certain % of the maximum based on difficulty level
   if (RegenedMana > MaxRegenableMana) RegenedMana = MaxRegenableMana;
 
   // Dove's Ribbon [Increases MP Regeneration]
   if (CharacterClass == 2)
   {
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
    {
     RegenedMana += random(2,4); // Only Flora can use the Dove's Ribbon (100% Chance of Extra 2-4 Mana)
     if (random(1,4) == 1) RegenedMana += random(1,2); // Only Flora can use the Dove's Ribbon (25% Chance of extra 1-2 Mana)
     if (random(1,16) == 1) RegenedMana += random(1,2); // Only Flora can use the Dove's Ribbon (6.25% Chance of extra 1-2 Mana)
     if (random(1,64) == 1) RegenedMana += random(1,2); // Only Flora can use the Dove's Ribbon (1.5625% Chance of extra 1-2 Mana)
    }
   }
 
   int FocusStrFactor = 36;
   // Focus = 12.5% more mana per interval
   if (MiscellaneousVars[212] > 0)
   {
    if (CharacterClass == 2)
	{
     if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) FocusStrFactor += 2;
     if (CheckActorInventory(Player1TID,"BalrogRing") > 0) FocusStrFactor += 2;
     if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) FocusStrFactor += 2;
    }
    else
	{
     if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) FocusStrFactor += 1;
     if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) FocusStrFactor += 2;
     if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) FocusStrFactor += 3;
     if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) FocusStrFactor += 4;
     if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) FocusStrFactor += 5;
     if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) FocusStrFactor += 6;
	}
    RegenedMana = RegenedMana * FocusStrFactor / 20;
   }
 
   // Prevents 0 MP regeneration periods
   if (RegenedMana < 1) RegenedMana = 1;
 
   // The actual Regeneration Part
   if (GetActorProperty(Player1TID,APROP_HEALTH) > 0 && CurrentMana < MaxMana)
   {
    CurrentMana += RegenedMana;

    if (CurrentMana > MaxMana) CurrentMana = MaxMana;
   }
 
   MaxManaLimit = MaxMana * 2;
 
   if (CurrentMana > MaxManaLimit) CurrentMana = MaxManaLimit;
   MiscellaneousVars[243] = CurrentMana;
   MiscellaneousVars[238] = CurrentMana;
  }


  // Reset Regen Delay
  if (GameSkill() == SKILL_VERY_EASY) SkillLevelManaDelay = 600; // 30 tics
  if (GameSkill() == SKILL_EASY) SkillLevelManaDelay = 660; // 33 tics
  if (GameSkill() == SKILL_NORMAL) SkillLevelManaDelay = 740; // 37 tics
  if (GameSkill() == SKILL_HARD) SkillLevelManaDelay = 840; // 42 tics
  if (GameSkill() == SKILL_VERY_HARD) SkillLevelManaDelay = 960; // 48 tics
  if (GetCVar("dvdsdebug_showmanaregenstuff") > 0) PrintBold(d:SkillLevelManaDelay);
  if (CharacterClass == 0) SkillLevelManaDelay += (20 * random(-3,5)); 
  if (CharacterClass == 1) SkillLevelManaDelay += (20 * random(-4,4));
  if (CharacterClass == 2) SkillLevelManaDelay += (20 * random(-5,3));
  if (CharacterClass == 8) SkillLevelManaDelay += (20 * random(-5,3));
  if (CharacterClass == 9) SkillLevelManaDelay += (20 * random(-4,4));
  if (GetCVar("dvdsdebug_showmanaregenstuff") > 0) PrintBold(d:SkillLevelManaDelay);

  if (CharacterClass == 0) ManaReDelay = PlayerLevel / 30; // Deggaris (up to 3/6)
  else if (CharacterClass == 1) ManaReDelay = PlayerLevel / 25; // Illucia (up to 4/8)
  else if (CharacterClass == 2) ManaReDelay = PlayerLevel / 20; // Flora (up to 5/10) 
  else if (CharacterClass == 8) ManaReDelay = PlayerLevel / 21; // Ailish 
  else if (CharacterClass == 9) ManaReDelay = PlayerLevel / 25; // Petra (up to 4/8)
  OverallDelay = SkillLevelManaDelay - ManaReDelay;
  if (GetCVar("dvdsdebug_showmanaregenstuff") > 0) PrintBold(d:OverallDelay);

  // A combined total of 15 points of Sorcery/Theraphesuis are needed for a tic-point of faster regen time.
  ManaReDelay = (MiscellaneousVars[34] + MiscellaneousVars[36]) / 300;
  OverallDelay -= ManaReDelay;
  if (GetCVar("dvdsdebug_showmanaregenstuff") > 0) PrintBold(d:OverallDelay);

  if (GameSkill() == SKILL_VERY_EASY) if (OverallDelay < 20) OverallDelay = 20;
  if (GameSkill() == SKILL_EASY) if (OverallDelay < 40) OverallDelay = 40;
  if (GameSkill() == SKILL_NORMAL) if (OverallDelay < 80) OverallDelay = 80;
  if (GameSkill() == SKILL_HARD) if (OverallDelay < 140) OverallDelay = 140;
  if (GameSkill() == SKILL_VERY_HARD) if (OverallDelay < 220) OverallDelay = 220;
  if (GetCVar("dvdsdebug_showmanaregenstuff") > 0) PrintBold(d:OverallDelay);
  MiscellaneousVars[211] = OverallDelay;
 }

 if (GetCVar("dvdsdebug_showmanaregenstuff") > 0)
 {
  PrintBold(
             s:"Focus?: ",d:MiscellaneousVars[212],s:"\n",
             s:"FocusTimer: ",d:MiscellaneousVars[231],s:"\n",
             s:"HumTimer: ",d:FocusHumTimer,s:"\n\n",
             s:"Timer: ",d:MiscellaneousVars[211],s:"\n",
             s:"ManaRedelay: ",d:ManaReDelay,s:"\n",
             s:"DelayCount: ",d:delaycount,s:"\n",
             s:"PerkFactor: ",d:perkfactor,s:"\n\n",
             s:"Current/Max Mana: ",d:CurrentMana,s:" / ",d:MaxMana,s:"\n",
             s:"RegenedMana: ",d:RegenedMana,s:"\n"
            );
 }           


 // Gets Values for Accquired Kills & Secrets [will move this to a different ENTER script later :P]
 if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
 {
  G2 = GetLevelInfo(LEVELINFO_LEVELNUM);
  MonstersAlive[G2] = GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) - GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
  MonstersKilled[G2] = GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
  SecretsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_SECRETS);
  ItemsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_ITEMS);
  //PrintBold(s:"MAP: ",d:G2,s:"\n Alive: ",d:MonstersAlive[G2],s:"\n Dead: ",d:MonstersKilled[G2],s:"\n Secrets: ",d:SecretsFound[G2],s:"\n Items: ",d:ItemsFound[G2]);
 }
 if (ModType == 1) // Deus Vult 1 only
 {
  if (SpecialGameFlags[10000] != 1)
  {
   G2 = GetLevelInfo(LEVELINFO_LEVELNUM);
   if (G2 >= 1100 && G2 <= 1199)
   {
    MonstersAlive[G2] = GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) - GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
    MonstersKilled[G2] = GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
    SecretsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_SECRETS);
    ItemsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_ITEMS);
    //PrintBold(s:"MAP: ",d:G2,s:"\n Alive: ",d:MonstersAlive[G2],s:"\n Dead: ",d:MonstersKilled[G2],s:"\n Secrets: ",d:SecretsFound[G2],s:"\n Items: ",d:ItemsFound[G2]);
   }
  }
 }
 if (ModType == 2) // Deus Vult 2 only
 {
  G2 = GetLevelInfo(LEVELINFO_LEVELNUM);
  if (G2 >= 1200 && G2 <= 1299)
  {
   MonstersAlive[G2] = GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) - GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
   MonstersKilled[G2] = GetLevelInfo(LEVELINFO_KILLED_MONSTERS);
   SecretsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_SECRETS);
   ItemsFound[G2] = GetLevelInfo(LEVELINFO_FOUND_ITEMS);
   //PrintBold(s:"MAP: ",d:G2,s:"\n Alive: ",d:MonstersAlive[G2],s:"\n Dead: ",d:MonstersKilled[G2],s:"\n Secrets: ",d:SecretsFound[G2],s:"\n Items: ",d:ItemsFound[G2]);
  }
 }
 Delay(1);
 Restart;
}

Script "ArcanaGaugeRegenerationStuff" ENTER
{
 int ArcanaRegenDelay, ArcanaRegenDelaySkill, ArcanaRegenAmount;
 if (CharacterClass != 9) Terminate;
 if (GameSkill() == SKILL_VERY_EASY) { ArcanaRegenDelaySkill = 8; }
 if (GameSkill() == SKILL_EASY) { ArcanaRegenDelaySkill = 16; }
 if (GameSkill() == SKILL_NORMAL) { ArcanaRegenDelaySkill = 24; }
 if (GameSkill() == SKILL_HARD) { ArcanaRegenDelaySkill = 32; }
 if (GameSkill() == SKILL_VERY_HARD) { ArcanaRegenDelaySkill = 40; }
 if (ArcanaRegenDelay == ArcanaRegenDelaySkill && MiscellaneousVars[5001] < 900)
 {
	MiscellaneousVars[5001] += 1;
	ArcanaRegenDelay = 0;
	if (MiscellaneousVars[5001] == 100 || MiscellaneousVars[5001] == 200 || MiscellaneousVars[5001] == 300 || MiscellaneousVars[5001] == 400 || MiscellaneousVars[5001] == 500 || MiscellaneousVars[5001] == 600 || MiscellaneousVars[5001] == 700 || MiscellaneousVars[5001] == 800 || MiscellaneousVars[5001] == 900 )
	{
		PlaySound(0,"ArcanaGaugeLevelup",CHAN_7);
	}
 }
 else
 {
	ArcanaRegenDelay += 1;
 }
 Delay(1);
 Restart;
}
//------------------------------
// FUNCTION: Get ExpMultiFactor
//------------------------------
function int GetExpMultiFactor (void)
{
  int ExpMultiFactor, Exp1, Exp2;
  // Gets the Experience Multiplication Factor [Part 1]
  ExpMultiFactor = Random(90,120);
  if (PlayerLevel < 40) ExpMultiFactor += PlayerLevel * 17 / 16; // +6.25%
  else
  {
   if (PlayerLevel < 80) ExpMultiFactor += PlayerLevel * 9 / 8; // +12.5%
   else
   {
    if (PlayerLevel < 120) ExpMultiFactor += PlayerLevel * 5 / 4; // +25%
    else
    {
     if (PlayerLevel < 160) ExpMultiFactor += PlayerLevel * 3 / 2; // +50%
     else ExpMultiFactor += PlayerLevel * 2; // +100%
    }
   }
  }

  // Gets the Experience Multiplication Factor [Part 2]
  Exp1 = GetLevelInfo(LEVELINFO_LEVELNUM);
  if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
  {
   if (ClassicDoomType == 1 || ClassicDoomType == 2) // Classic Doom 1 or Heretic
   {
    if (Exp1 != 1000 || Exp1 != 1010)
    {
     Exp1 += MiscellaneousVars[52]; 
     Exp1 += MiscellaneousVars[169]; 
     if (Exp1 < 1) Exp1 = 1;
     if (Exp1 > 50) Exp1 = 50;
    }
    if (Exp1 == 1000) Exp2 = 0; // E1M0 [Classic Doom 1]
    if (Exp1 == 1010) Exp2 = 0; // E1MA [Heretic]
    // Episode 1
    if (Exp1 == 1) Exp2 = Exp1 * 1000 / 1000; // Monster Bonus [100%] [E1M1]
    if (Exp1 == 2) Exp2 = Exp1 * 1010 / 1000; // Monster Bonus [100%] [E1M2]
    if (Exp1 == 3) Exp2 = Exp1 * 1020 / 1000; // Monster Bonus [100%] [E1M3]
    if (Exp1 == 9) Exp2 = Exp1 * 1090 / 1000; // Monster Bonus [100%] [E1M9]
    if (Exp1 == 10) Exp2 = Exp1 * 1100 / 1000; // Monster Bonus [100%] [E1M10]
    if (Exp1 == 4) Exp2 = Exp1 * 1030 / 1000; // Monster Bonus [100%] [E1M4]
    if (Exp1 == 5) Exp2 = Exp1 * 1040 / 1000; // Monster Bonus [100%] [E1M5]
    if (Exp1 == 6) Exp2 = Exp1 * 1050 / 1000; // Monster Bonus [100%] [E1M6]
    if (Exp1 == 7) Exp2 = Exp1 * 1060 / 1000; // Monster Bonus [100%] [E1M7]
    if (Exp1 == 8) Exp2 = Exp1 * 1070 / 1000; // Monster Bonus [100%] [E1M8]
    // Episode 2
    if (Exp1 == 11) Exp2 = Exp1 * 1112 / 1000; // Monster Bonus [100%] [E2M1]
    if (Exp1 == 12) Exp2 = Exp1 * 1125 / 1000; // Monster Bonus [100%] [E2M2]
    if (Exp1 == 13) Exp2 = Exp1 * 1137 / 1000; // Monster Bonus [100%] [E2M3]
    if (Exp1 == 14) Exp2 = Exp1 * 1150 / 1000; // Monster Bonus [100%] [E2M4]
    if (Exp1 == 15) Exp2 = Exp1 * 1162 / 1000; // Monster Bonus [100%] [E2M5]
    if (Exp1 == 19) Exp2 = Exp1 * 1220 / 1000; // Monster Bonus [100%] [E2M9]
    if (Exp1 == 20) Exp2 = Exp1 * 1240 / 1000; // Monster Bonus [100%] [E2M10]
    if (Exp1 == 16) Exp2 = Exp1 * 1175 / 1000; // Monster Bonus [100%] [E2M6]
    if (Exp1 == 17) Exp2 = Exp1 * 1187 / 1000; // Monster Bonus [100%] [E2M7]
    if (Exp1 == 18) Exp2 = Exp1 * 1200 / 1000; // Monster Bonus [100%] [E2M8]
    // Episode 3
    if (Exp1 == 21) Exp2 = Exp1 * 1280 / 1000; // Monster Bonus [100%] [E3M1]
    if (Exp1 == 22) Exp2 = Exp1 * 1320 / 1000; // Monster Bonus [100%] [E3M2]
    if (Exp1 == 23) Exp2 = Exp1 * 1360 / 1000; // Monster Bonus [100%] [E3M3]
    if (Exp1 == 24) Exp2 = Exp1 * 1400 / 1000; // Monster Bonus [100%] [E3M4]
    if (Exp1 == 25) Exp2 = Exp1 * 1440 / 1000; // Monster Bonus [100%] [E3M5]
    if (Exp1 == 26) Exp2 = Exp1 * 1480 / 1000; // Monster Bonus [100%] [E3M6]
    if (Exp1 == 29) Exp2 = Exp1 * 1600 / 1000; // Monster Bonus [100%] [E3M9]
    if (Exp1 == 30) Exp2 = Exp1 * 1680 / 1000; // Monster Bonus [100%] [E3M10]
    if (Exp1 == 27) Exp2 = Exp1 * 1520 / 1000; // Monster Bonus [100%] [E3M7]
    if (Exp1 == 28) Exp2 = Exp1 * 1560 / 1000; // Monster Bonus [100%] [E3M8]
    // Episode 4
    if (Exp1 == 31) Exp2 = Exp1 * 1750 / 1000; // Monster Bonus [100%] [E4M1]
    if (Exp1 == 32) Exp2 = Exp1 * 1825 / 1000; // Monster Bonus [100%] [E4M2]
    if (Exp1 == 39) Exp2 = Exp1 * 2600 / 1000; // Monster Bonus [100%] [E4M9]
    if (Exp1 == 40) Exp2 = Exp1 * 2875 / 1000; // Monster Bonus [100%] [E4M10]
    if (Exp1 == 33) Exp2 = Exp1 * 1900 / 1000; // Monster Bonus [100%] [E4M3]
    if (Exp1 == 34) Exp2 = Exp1 * 2000 / 1000; // Monster Bonus [100%] [E4M4]
    if (Exp1 == 35) Exp2 = Exp1 * 2100 / 1000; // Monster Bonus [100%] [E4M5]
    if (Exp1 == 36) Exp2 = Exp1 * 2225 / 1000; // Monster Bonus [100%] [E4M6]
    if (Exp1 == 37) Exp2 = Exp1 * 2350 / 1000; // Monster Bonus [100%] [E4M7]
    if (Exp1 == 38) Exp2 = Exp1 * 2475 / 1000; // Monster Bonus [100%] [E4M8]
    // Episode 4
    if (Exp1 == 31) Exp2 = Exp1 * 1750 / 1000; // Monster Bonus [100%] [E4M1]
    if (Exp1 == 32) Exp2 = Exp1 * 1825 / 1000; // Monster Bonus [100%] [E4M2]
    if (Exp1 == 39) Exp2 = Exp1 * 2600 / 1000; // Monster Bonus [100%] [E4M9]
    if (Exp1 == 40) Exp2 = Exp1 * 2875 / 1000; // Monster Bonus [100%] [E4M10]
    if (Exp1 == 33) Exp2 = Exp1 * 1900 / 1000; // Monster Bonus [100%] [E4M3]
    if (Exp1 == 34) Exp2 = Exp1 * 2000 / 1000; // Monster Bonus [100%] [E4M4]
    if (Exp1 == 35) Exp2 = Exp1 * 2100 / 1000; // Monster Bonus [100%] [E4M5]
    if (Exp1 == 36) Exp2 = Exp1 * 2225 / 1000; // Monster Bonus [100%] [E4M6]
    if (Exp1 == 37) Exp2 = Exp1 * 2350 / 1000; // Monster Bonus [100%] [E4M7]
    if (Exp1 == 38) Exp2 = Exp1 * 2475 / 1000; // Monster Bonus [100%] [E4M8]
    // Episode 5
    if (Exp1 == 41) Exp2 = Exp1 * 1750 / 1000; // Monster Bonus [100%] [E5M1]
    if (Exp1 == 42) Exp2 = Exp1 * 1825 / 1000; // Monster Bonus [100%] [E5M2]
    if (Exp1 == 49) Exp2 = Exp1 * 2600 / 1000; // Monster Bonus [100%] [E5M9]
    if (Exp1 == 50) Exp2 = Exp1 * 2875 / 1000; // Monster Bonus [100%] [E5M10]
    if (Exp1 == 43) Exp2 = Exp1 * 1900 / 1000; // Monster Bonus [100%] [E5M3]
    if (Exp1 == 44) Exp2 = Exp1 * 2000 / 1000; // Monster Bonus [100%] [E5M4]
    if (Exp1 == 45) Exp2 = Exp1 * 2100 / 1000; // Monster Bonus [100%] [E5M5]
    if (Exp1 == 46) Exp2 = Exp1 * 2225 / 1000; // Monster Bonus [100%] [E5M6]
    if (Exp1 == 47) Exp2 = Exp1 * 2350 / 1000; // Monster Bonus [100%] [E5M7]
    if (Exp1 == 48) Exp2 = Exp1 * 2475 / 1000; // Monster Bonus [100%] [E5M8]

          if (Exp1 == 9) Exp2 = Exp2 * 15 / 4; // [375%]
    else if (Exp1 == 19) Exp2 = Exp2 * 5;      // [500%]
    else if (Exp1 == 29) Exp2 = Exp2 * 25 / 4; // [625%]
    else if (Exp1 == 39) Exp2 = Exp2 * 15 / 2; // [750%]
    else if (Exp1 == 49) Exp2 = Exp2 * 35 / 4; // [875%]
                    else Exp2 = Exp2 * 5 / 2;  // [250%]
   }
   else // Classic Doom 2 / Hexen / Strife / Doom64
   {
    if (Exp1 != 1050 || Exp1 != 1020 || Exp1 != 1030)
    {
     Exp1 += MiscellaneousVars[52];
     Exp1 += MiscellaneousVars[169]; 
     if (Exp1 < 1) Exp1 = 1;
     if (Exp1 > 50) Exp1 = 50;
    }
    if (Exp1 == 1050) Exp2 = 0; // MAP00 [Classic Doom 2]
    if (Exp1 == 1020) Exp2 = 0; // MAP0A [Hexen]
    if (Exp1 == 1030) Exp2 = 0; // MAPAA [Strife]
    // Main Game
    if (Exp1 == 1) Exp2 = Exp1 * 1000 / 1000; // Monster Bonus [100%] [MAP01]
    if (Exp1 == 2) Exp2 = Exp1 * 10125 / 10000; // Monster Bonus [101.25%] [MAP02]
    if (Exp1 == 3) Exp2 = Exp1 * 1025 / 1000; // Monster Bonus [102.5%] [MAP03]
    if (Exp1 == 4) Exp2 = Exp1 * 10375 / 10000; // Monster Bonus [103.75%] [MAP04]
    if (Exp1 == 5) Exp2 = Exp1 * 1050 / 1000; // Monster Bonus [105%] [MAP05]

    if (Exp1 == 6) Exp2 = Exp1 * 1069 / 1000; // Monster Bonus [106.9%] [MAP06]
    if (Exp1 == 7) Exp2 = Exp1 * 1088 / 1000; // Monster Bonus [108.8%] [MAP07]
    if (Exp1 == 8) Exp2 = Exp1 * 1107 / 1000; // Monster Bonus [110.7%] [MAP08]
    if (Exp1 == 9) Exp2 = Exp1 * 1125 / 1000; // Monster Bonus [112.5%] [MAP09]
    if (Exp1 == 10) Exp2 = Exp1 * 1144 / 1000; // Monster Bonus [114.4%] [MAP10]

    if (Exp1 == 11) Exp2 = Exp1 * 1169 / 1000; // Monster Bonus [116.9%] [MAP11]
    if (Exp1 == 12) Exp2 = Exp1 * 1194 / 1000; // Monster Bonus [119.4%] [MAP12]
    if (Exp1 == 13) Exp2 = Exp1 * 1219 / 1000; // Monster Bonus [121.9%] [MAP13]
    if (Exp1 == 14) Exp2 = Exp1 * 1244 / 1000; // Monster Bonus [124.4%] [MAP14]
    if (Exp1 == 15) Exp2 = Exp1 * 1269 / 1000; // Monster Bonus [126.9%] [MAP15]

    if (Exp1 == 31) Exp2 = Exp1 * 1519 / 1000; // Monster Bonus [151.9%] [MAP31]
    if (Exp1 == 32) Exp2 = Exp1 * 2019 / 1000; // Monster Bonus [201.9%] [MAP32]

    if (Exp1 == 16) Exp2 = Exp1 * 1300 / 1000; // Monster Bonus [130.0%] [MAP16]
    if (Exp1 == 17) Exp2 = Exp1 * 1331 / 1000; // Monster Bonus [133.1%] [MAP17]
    if (Exp1 == 18) Exp2 = Exp1 * 1363 / 1000; // Monster Bonus [136.3%] [MAP18]
    if (Exp1 == 19) Exp2 = Exp1 * 1394 / 1000; // Monster Bonus [139.4%] [MAP19]
    if (Exp1 == 20) Exp2 = Exp1 * 1425 / 1000; // Monster Bonus [142.5%] [MAP20]

    if (Exp1 == 21) Exp2 = Exp1 * 1475 / 1000; // Monster Bonus [147.5%] [MAP21]
    if (Exp1 == 22) Exp2 = Exp1 * 1525 / 1000; // Monster Bonus [152.5%] [MAP22]
    if (Exp1 == 23) Exp2 = Exp1 * 1575 / 1000; // Monster Bonus [157.5%] [MAP23]
    if (Exp1 == 24) Exp2 = Exp1 * 1625 / 1000; // Monster Bonus [162.5%] [MAP24]
    if (Exp1 == 25) Exp2 = Exp1 * 1675 / 1000; // Monster Bonus [167.5%] [MAP25]

    if (Exp1 == 26) Exp2 = Exp1 * 1743 / 1000; // Monster Bonus [174.3%] [MAP26]
    if (Exp1 == 27) Exp2 = Exp1 * 1819 / 1000; // Monster Bonus [181.9%] [MAP27]
    if (Exp1 == 28) Exp2 = Exp1 * 1900 / 1000; // Monster Bonus [190.0%] [MAP28]
    if (Exp1 == 29) Exp2 = Exp1 * 1998 / 1000; // Monster Bonus [189.0%] [MAP29]
    if (Exp1 == 30) Exp2 = Exp1 * 2688 / 1000; // Monster Bonus [268.8%] [MAP30]
    //PrintBold(d:Exp2);

         if (Exp1 == 31) Exp2 = Exp2 * 5; // [500%]
    else if (Exp1 == 32) Exp2 = Exp2 * 15 / 2; // [750%]
                    else Exp2 = Exp2 * 5 / 2; // [250%]
    //PrintBold(d:Exp2);
   }
  }
  else
  if (ModType == 1) // Deus Vult 1
  {
   if (Exp1 != 1100)
   {
    Exp1 += MiscellaneousVars[52];
    Exp1 += MiscellaneousVars[169]; 
    if (Exp1 < 1101) Exp1 = 1101;
    if (Exp1 > 1104) Exp1 = 1104;
   }
   if (Exp1 == 1100) Exp2 = (Exp1 - 1100) * 26 / 25; // +4% Exp Bonus // DV1M00
   if (Exp1 == 1101) Exp2 = (Exp1 - 1100) * 100 / 100; // Monster Bonus [100%]
   if (Exp1 == 1102) Exp2 = (Exp1 - 1100) * 120 / 100; // Monster Bonus [120%]
   if (Exp1 == 1103) Exp2 = (Exp1 - 1100) * 144 / 100; // Monster Bonus [144%]
   if (Exp1 == 1104) Exp2 = (Exp1 - 1100) * 192 / 100; // Monster Bonus [192%]

        if (Exp1 == 31) Exp2 = Exp2 * 5 / 2; // [250%]
   else if (Exp1 == 32) Exp2 = Exp2 * 15 / 4; // [375%]
                   else Exp2 = Exp2 * 5 / 4; // [125%]
  }
  else
  if (ModType == 2) // Deus Vult 2
  {
   if (Exp1 != 1200)
   {
    Exp1 += MiscellaneousVars[52];
    Exp1 += MiscellaneousVars[169]; 
    if (Exp1 < 1201) Exp1 = 1201;
    if (Exp1 > 1212) Exp1 = 1212;
   }

   // Zendaria Levels
   if (Exp1 == 1200) Exp2 = (Exp1 - 1200) * 26 / 25; // +4% Exp Bonus // Prolouge - The Mysterious Cave
   // Earth-type Levels
   if (Exp1 == 1201) Exp2 = (Exp1 - 1200) * 100 / 100; // Monster Bonus // MAP01 - Entryway Pass
   if (Exp1 == 1202) Exp2 = (Exp1 - 1200) * 106 / 100; // Monster Bonus // MAP02 - Mutagen
   if (Exp1 == 1203) Exp2 = (Exp1 - 1200) * 112 / 100; // Monster Bonus // MAP03 - Crouching Demon, Hidden Archvile
   if (Exp1 == 1204) Exp2 = (Exp1 - 1200) * 120 / 100; // Monster Bonus // MAP04 - Minas Morgul
   if (Exp1 == 1205) Exp2 = (Exp1 - 1200) * 126 / 100; // Monster Bonus // MAP05 - Eagle's Nest
   if (Exp1 == 1206) Exp2 = (Exp1 - 1200) * 134 / 100; // Monster Bonus // MAP05B - The Manliest Level Ever
   if (Exp1 == 1207) Exp2 = (Exp1 - 1200) * 142 / 100; // Monster Bonus // MAP06 - Stargate
   if (Exp1 == 1208) Exp2 = (Exp1 - 1200) * 150 / 100; // Monster Bonus // MAP07 - The Desert Temple
   // Hell Levels
   if (Exp1 == 1209) Exp2 = (Exp1 - 1200) * 178 / 100; // Monster Bonus // MAP08 - The Unholy Cathedral
   if (Exp1 == 1210) Exp2 = (Exp1 - 1200) * 210 / 100; // Monster Bonus // MAP09 - You Shall Not Pass!
   if (Exp1 == 1211) Exp2 = (Exp1 - 1200) * 248 / 100; // Monster Bonus // MAP10 - Hell's Vendetta
   if (Exp1 == 1212) Exp2 = (Exp1 - 1200) * 292 / 100; // Monster Bonus // MAP10B - attedneV s'lleH
   // Extra Levels
   if (Exp1 == 1213) Exp2 = 0; // NO Exp Bonus since it's Heaven, foo. :P // MAP11 - St. Peter's Gate
   if (Exp1 == 1214) Exp2 = (Exp1 - 1200) * 140 / 100; // MAP12 - "The Wings of The Maiar" [DVI combined level remake]
   if (Exp1 == 1215) Exp2 = (Exp1 - 1200) * 292 / 100; // MAP10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
   // Ending Levels
   if (Exp1 == 1216) Exp2 = 0; // NO Exp Bonus in ending levels // MAP13 - The Return Home
   if (Exp1 == 1217) Exp2 = 0; // NO Exp Bonus in ending levels // ENDMAP - Credits and Cast


        if (Exp1 == 31) Exp2 = Exp2 * 5 / 2; // [250%]
   else if (Exp1 == 32) Exp2 = Exp2 * 15 / 4; // [375%]
                   else Exp2 = Exp2 * 5 / 4; // [125%]
  }

  ExpMultiFactor += Exp2;

  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
  {
   PrintBold(s:"ModType: ",d:ModType,s:"\nExp1: ",d:Exp1,s:"\nExp2: ",d:Exp2,s:"\nExpMultiFactor: ",d:ExpMultiFactor);
  }
  return ExpMultiFactor;
}

//---------------------------------------------
// FUNCTION: Get Experience for Each EXP Check
//---------------------------------------------
function int GetExperience (int RealExpGain, int ExpMultiFactor)
{
 int OldExp1 = RealExpGain;
 RealExpGain = RealExpGain * ExpMultiFactor / 100; // Randomizes some of the experience gained

 int OldExp2 = RealExpGain;
 RealExpGain = RealExpGain * (GetCVar("dvds_deftnessexpbase") + MiscellaneousVars[40]) / GetCVar("dvds_deftnessexpbase");

 int OldExp3 = RealExpGain;
 RealExpGain = RealExpGain * GetCVar("dvds_expmultiplier") / 100; // EXP Multiplier Option

 int OldExp4 = RealExpGain;
 int perkfactor;
 // "Cleared of Mind" Perk
 perkfactor = 100;
 if (MiscellaneousVars[10055] > 0)
 {
  if (MiscellaneousVars[10055] >= 1) perkfactor += 4;
  if (MiscellaneousVars[10055] >= 2) perkfactor += 5;
  if (MiscellaneousVars[10055] >= 3) perkfactor += 6;
  if (MiscellaneousVars[10055] >= 4) perkfactor += 7;
  if (MiscellaneousVars[10055] >= 5) perkfactor += 8;
  if (MiscellaneousVars[10056] >= 1) perkfactor += 15;
  if (MiscellaneousVars[10056] >= 2) perkfactor += 15;
  RealExpGain = RealExpGain * perkfactor / 100;
 }
 int OldExp5 = RealExpGain;
 // "Higher Learning" Grand Mastery Perk
 if (MiscellaneousVars[11001] == 1)
 {
  if (CharacterClass == 0 | CharacterClass == 1) RealExpGain = RealExpGain * 49 / 40; // EXP Multiplier Option [122.5%]
  if (CharacterClass == 2) RealExpGain = RealExpGain * 23 / 20; // EXP Multiplier Option [115%]
 }
 if (MiscellaneousVars[11001] == 2)
 {
  if (CharacterClass == 0 | CharacterClass == 1) RealExpGain = RealExpGain * 29 / 20; // EXP Multiplier Option [145%]
  if (CharacterClass == 2) RealExpGain = RealExpGain * 13 / 10; // EXP Multiplier Option [115%]
 }

 int OldExp6 = RealExpGain;
 if (GameSkill() == SKILL_VERY_EASY) RealExpGain = RealExpGain * 25 / 8; // 312.5%
 else if (GameSkill() == SKILL_EASY) RealExpGain = RealExpGain * 5 / 2; // 250%
 else if (GameSkill() == SKILL_NORMAL) RealExpGain = RealExpGain * 15 / 8; // 187.5%
 else if (GameSkill() == SKILL_HARD) RealExpGain = RealExpGain * 5 / 4; // 125%
 else if (GameSkill() == SKILL_VERY_HARD) RealExpGain = RealExpGain * 7 / 8; // 87.5%

 int OldExp7 = RealExpGain;
 int ArmorEXPMulti = 20;
 if (CharacterClass == 2)
 {
  if (CheckActorInventory(Player1TID,"SafeTeaShoes")) { if (random(1,100) < 6) { ArmorEXPMulti += 2; } else { ArmorEXPMulti += 1; } }
  if (CheckActorInventory(Player1TID,"PearlyCorset")) { if (random(1,100) < 6) { ArmorEXPMulti += 9; } else { ArmorEXPMulti += 6; } }
  if (CheckActorInventory(Player1TID,"DoveRibbon")) { if (random(1,100) < 6) { ArmorEXPMulti += 2; } else { ArmorEXPMulti += 1; } }
  RealExpGain = RealExpGain * ArmorEXPMulti / 20;
 }

 int OldExp8 = RealExpGain;
 if (PowerupTimer[7] > 0) { if (random(1,100) > 67) { RealExpGain = RealExpGain * 7 / 6; } else { RealExpGain = RealExpGain * 13 / 12; } } // Divine Avatar [+8.333% EXP, (33% chance of +16.67% EXP instead]

 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"OldEXP1: ",d:OldExp1,
           s:"\nOldEXP2: ",d:OldExp2,s:" [ExpMultiRand: ",d:ExpMultiFactor,s:" / 100]",
           s:"\nOldEXP3: ",d:OldExp3,s:" [DeftBonus: ",d:GetCVar("dvds_deftnessexpbase")+MiscellaneousVars[40],s:" / ",d:GetCVar("dvds_deftnessexpbase"),s:"]",
           s:"\nOldEXP4: ",d:OldExp4,s:" [ExpMultiOption: ",d:GetCVar("dvds_expmultiplier"),s:" / 100]",
           s:"\nOldEXP5: ",d:OldExp5,s:" [PerkFactor: ",d:perkfactor,s:" / 100]",
           s:"\nOldEXP6: ",d:OldExp6,
           s:"\nOldEXP7: ",d:OldExp7,
           s:"\nOldEXP8: ",d:OldExp8,s:" [ArmorEXPMulti: ",d:ArmorEXPMulti,s:" / 20]",
           s:"\nNewEXP: ",d:RealExpGain);
 }
 return RealExpGain;
}

// Seperated Levelup Code
script "LevelUpCode" ENTER // (void)
{
 int C1, I1, C2, I2, Z1, Z2, G1, G2, G3, Exp1, Exp2, ExpMultiFactor, RealExpGain, HPBoost, MPBoost, MapCheck, RandomizedStatChance, RandomizedStatChance2;
 int PerkFactor;
 int leveluptimes = 0;
 int leveluptimesmax = 200;
 int tempaeonpointincrease;
 //*******************
 //** LEVEL UP CODE **
 //*******************
 for (leveluptimes = 0; leveluptimes < leveluptimesmax; leveluptimes++)
 {
  MiscellaneousVars[48] = ExpTable[PlayerLevel] - Experience;
  if (Experience >= ExpTable[PlayerLevel])
  {
   tempaeonpointincrease = 0;  
   if (PlayerLevel < LevelCap)
   { 
    PlayerLevel += 1;

    MiscellaneousVars[171] = 105; // Turns on the "Level Up!!" and "Stat Up" indicators for 3 seconds on the HUD upon level up.
    MiscellaneousVars[204] = MiscellaneousVars[25]; // total Aeon Points gained
    MiscellaneousVars[205] = MiscellaneousVars[31]; // total Agility Points gained
    MiscellaneousVars[206] = MiscellaneousVars[32]; // total Defense Points gained
    MiscellaneousVars[207] = MiscellaneousVars[33]; // total Deftness Points gained
    MiscellaneousVars[208] = MiscellaneousVars[34]; // total Sorcery Points gained
    MiscellaneousVars[209] = MiscellaneousVars[35]; // total Strength Points gained
    MiscellaneousVars[210] = MiscellaneousVars[36]; // total Therapeusis Points gained

    //*********************
    //*Aeon Point Increase*
    //*********************
    // MiscellaneousVars[25] = Aeon Points
    if (PlayerLevel != 0)
    {
     G1 = PlayerLevel % 20;
     if (G1 == 0) C1 = 0;
     else if (G1 == 4) C1 = 1;
     else if (G1 == 8) C1 = 1;
     else if (G1 == 12) C1 = 1;
     else if (G1 == 16) C1 = 1;
     else C1 = 2;

     if (C1 == 0) // Levels 20, 40, 60, 80, 100, 120, 140, 160, 180 & 200
     {
      if (PlayerLevel > 100)
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 25) tempaeonpointincrease += 8; else tempaeonpointincrease += 5;
       if (random(1,100) <= 20) tempaeonpointincrease += random(3,5);
      }
      else
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 25) tempaeonpointincrease += 5; else tempaeonpointincrease += 3;
       if (random(1,100) <= 20) tempaeonpointincrease += random(1,3);
      }
     }
     else
     if (C1 == 1) // Levels [0/2/4/6/8/10/12/14/16/18]4, [0/2/4/6/8/10/12/14/16/18]8, [1/3/5/7/9/11/13/15/17/19]2, & [1/3/5/7/9/11/13/15/17/19]6
     {
      if (PlayerLevel > 100)
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 15) tempaeonpointincrease += 3; else tempaeonpointincrease += 2;
       if (random(1,100) <= 10) tempaeonpointincrease += random(1,2);
      }
      else
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 15) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
       if (random(1,100) <= 10) tempaeonpointincrease += random(0,1);
      }
     }
     else
     if (C1 == 2) // Any other level that's not a multiple of 4 or 20
     {
      if (PlayerLevel > 100)
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,10) <= 6) // 60% chance of +2/3 Aeon Points per level
       {
        if (random(1,100) <= 15) tempaeonpointincrease += 3; else tempaeonpointincrease += 2;
       }
      }
      else
      {
       if (random(1,100) <= 65) tempaeonpointincrease += 1;
       if (random(1,10) <= 3) // 30% chance of +1/2 Aeon Points per level
       {
        if (random(1,100) <= 15) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
       }
      }
     }
    }
    // Extra AeonPts for "Perk Mode"
    if (GetCVar("dvdsperks_active") == 1)
    {
     tempaeonpointincrease += 2;
     if (PlayerLevel >= 15) tempaeonpointincrease += 1;
     if (PlayerLevel >= 30) tempaeonpointincrease += 1;
     if (PlayerLevel >= 45) tempaeonpointincrease += 1;
     if (PlayerLevel >= 60) tempaeonpointincrease += 1;
     // 6
     if (PlayerLevel >= 75) tempaeonpointincrease += 1;
     if (PlayerLevel >= 90) tempaeonpointincrease += 1;
     if (PlayerLevel >= 105) tempaeonpointincrease += 1;
     if (PlayerLevel >= 120) tempaeonpointincrease += 1;
     // 10
     if (PlayerLevel >= 135) tempaeonpointincrease += 1;
     if (PlayerLevel >= 150) tempaeonpointincrease += 1;
     if (PlayerLevel >= 165) tempaeonpointincrease += 1;
     if (PlayerLevel >= 180) tempaeonpointincrease += 1;
     // 14
     if (PlayerLevel >= 195) tempaeonpointincrease += 2;
     // 16
    }
    if (MiscellaneousVars[11001] == 1) tempaeonpointincrease = tempaeonpointincrease * 5 / 4;  // "Higher Learning" Grand Mastery Perk
    if (MiscellaneousVars[11001] == 2) tempaeonpointincrease = tempaeonpointincrease * 3 / 2;  // "Higher Learning" Grand Mastery Perk [Level 2]

    if (DVDSSpecialArrayValue[3] > 0) tempaeonpointincrease += random(1,2); // If playing "Unloved"
    if (DVDSSpecialArrayValue[4] > 0) tempaeonpointincrease += random(1,3); // If playing "TCOTD:A"
    if (DVDSSpecialArrayValue[5] > 0) tempaeonpointincrease += random(2,4); // If playing "Circus2"
    tempaeonpointincrease *= MiscellaneousVars[86];
	MiscellaneousVars[25] += tempaeonpointincrease;

    // Increase Stats
    // 16:25 (1-100) [64] + 20:25 (101-200) [80] = [Max of 144 (or -75%)]
    G1 = PlayerLevel % 20;
    if (G1 == 0) C1 = 0;
    else if (G1 == 4) C1 = 1;
    else if (G1 == 8) C1 = 1;
    else if (G1 == 12) C1 = 1;
    else if (G1 == 16) C1 = 1;
    else C1 = 2;
    if (C1 == 0) // Levels 20, 40, 60, 80, 100, 120, 140, 160, 180 & 200
    {
     RandomizedStatChance = 192 - (10 * random(4,8)); // 112 to 152
     RandomizedStatChance -= (MiscellaneousVars[33] / 5);
    }
    else
    if (C1 == 1) // Levels [0/2/4/6/8/10/12/14/16/18]4, [0/2/4/6/8/10/12/14/16/18]8, [1/3/5/7/9/11/13/15/17/19]2, & [1/3/5/7/9/11/13/15/17/19]6
    {
     RandomizedStatChance = 192 - (4 * random(4,8)); // 160 to 176
     RandomizedStatChance -= (MiscellaneousVars[33] / 7);
    }
    else
    if (C1 == 2) // Any other level that's not a multiple of 4 or 20
    {
     RandomizedStatChance = 192;
     RandomizedStatChance -= (MiscellaneousVars[33] / 8);
    }
    Z1 = 0;
    Z1 = PlayerLevel * 16 / 25;
    if (Z1 < 0) Z1 = 0; if (Z1 > 64) Z1 = 64;
    G3 = 0;
    if (PlayerLevel > 100)
    {
     G3 = (PlayerLevel - 100) * 20 / 25;
     if (G3 < 0) G3 = 0; if (G3 > 80) G3 = 80;
    }

    G2 = 0;
    G2 += Z1; // Adds [level 1-100] range value
    G2 += G3; // Adds [level 101-200] range value
    RandomizedStatChance -= G2;
    if (CheckActorInventory(Player1TID,"TheOneRing") > 0) RandomizedStatChance = RandomizedStatChance * 3 / 4;
    if (RandomizedStatChance < 1) RandomizedStatChance = 1;

    RandomizedStatChance2 = 24;
    if (PlayerLevel > 25) RandomizedStatChance2 = 23;
    if (PlayerLevel > 50) RandomizedStatChance2 = 22;
    if (PlayerLevel > 75) RandomizedStatChance2 = 21;
    if (PlayerLevel > 100) RandomizedStatChance2 = 20;
    if (PlayerLevel > 125) RandomizedStatChance2 = 18;
    if (PlayerLevel > 150) RandomizedStatChance2 = 16;
    if (PlayerLevel > 175) RandomizedStatChance2 = 14;
    //********************************
    //*Random Levelups to Seed Values*
    //********************************

    if (CharacterClass == 0) // Deggaris (192pts) (0 left)
    {
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 24) MiscellaneousVars[31] += Z2; // Agility [12.5%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 5) MiscellaneousVars[31] += Z2; // Extra Agility [2.60%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 42) MiscellaneousVars[32] += Z2; // Defense [21.4%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 8) MiscellaneousVars[32] += Z2; // Extra Defense [4.16%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[33] += Z2; // Deftness [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[33] += Z2; // Extra Deftness [3.12%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[34] += Z2; // Sorcery [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[34] += Z2; // Extra Sorcery [3.12%] 

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 36) MiscellaneousVars[35] += Z2; // Strength [18.36%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 7) MiscellaneousVars[35] += Z2; // Extra Strength [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[36] += Z2; // Therapeusis [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[36] += Z2; // Extra Therapeusis [3.12%] 
    }
    if (CharacterClass == 1) // Illucia (192pts) (0 left)
    {
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[31] += Z2; // Agility [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[31] += Z2; // Extra Agility [3.12%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[32] += Z2; // Defense [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[32] += Z2; // Extra Defense [3.12%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[33] += Z2; // Deftness [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[33] += Z2; // Extra Deftness [3.12%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 36) MiscellaneousVars[34] += Z2; // Sorcery [18.36%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 7) MiscellaneousVars[34] += Z2; // Extra Sorcery [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 24) MiscellaneousVars[35] += Z2; // Strength [12.5%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 5) MiscellaneousVars[35] += Z2; // Extra Strength [2.60%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 42) MiscellaneousVars[36] += Z2; // Therapeusis [21.4%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 8) MiscellaneousVars[36] += Z2; // Extra Therapeusis [4.16%]
    }
    if (CharacterClass == 2) // Flora (192pts) (0 left)
    {
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 37) MiscellaneousVars[31] += Z2; // Agility [19.27%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 7) MiscellaneousVars[31] += Z2; // Extra Agility [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 16) MiscellaneousVars[32] += Z2; // Defense [8.33%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 3) MiscellaneousVars[32] += Z2; // Extra Defense [1.56%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 33) MiscellaneousVars[33] += Z2; // Deftness [17.2%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 7) MiscellaneousVars[33] += Z2; // Extra Deftness [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 45) MiscellaneousVars[34] += Z2; // Sorcery [23.4%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 9) MiscellaneousVars[34] += Z2; // Extra Sorcery [4.68%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 23) MiscellaneousVars[35] += Z2; // Strength [11.9%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 5) MiscellaneousVars[35] += Z2; // Extra Strength [2.6%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 38) MiscellaneousVars[36] += Z2; // Therapeusis [19.79%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 8) MiscellaneousVars[36] += Z2; // Extra Therapeusis [4.16%]
    }

    if (CharacterClass == 9) // Petra (192pts) (0 left)
    {
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 30) MiscellaneousVars[31] += Z2; // Agility [15.625%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[31] += Z2; // Extra Agility [3.12%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 42) MiscellaneousVars[32] += Z2; // Defense [21.4%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 8) MiscellaneousVars[32] += Z2; // Extra Defense [4.16%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 33) MiscellaneousVars[33] += Z2; // Deftness [17.2%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 7) MiscellaneousVars[33] += Z2; // Extra Deftness [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 34) MiscellaneousVars[34] += Z2; // Sorcery [18.36%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[34] += Z2; // Extra Sorcery [3.64%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 23) MiscellaneousVars[35] += Z2; // Strength [11.9%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 5) MiscellaneousVars[35] += Z2; // Extra Strength [2.6%]

     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 38) MiscellaneousVars[36] += Z2; // Therapeusis [21.4%]
     if (random(1,RandomizedStatChance2) == RandomizedStatChance2) { Z2 = 2; } else { Z2 = 1; } 
     Z2 *= MiscellaneousVars[146];
     if (random(1,RandomizedStatChance) <= 6) MiscellaneousVars[36] += Z2; // Extra Therapeusis [4.16%]
    }
	
    if (MiscellaneousVars[31] > 512) MiscellaneousVars[31] = 512;
    if (MiscellaneousVars[32] > 512) MiscellaneousVars[32] = 512;
    if (MiscellaneousVars[33] > 512) MiscellaneousVars[33] = 512;
    if (MiscellaneousVars[34] > 512) MiscellaneousVars[34] = 512;
    if (MiscellaneousVars[35] > 512) MiscellaneousVars[35] = 512;
    if (MiscellaneousVars[36] > 512) MiscellaneousVars[36] = 512;

    MiscellaneousVars[204] -= MiscellaneousVars[25]; // total Aeon Points gained
    MiscellaneousVars[205] -= MiscellaneousVars[31]; // total Agility Points gained
    MiscellaneousVars[206] -= MiscellaneousVars[32]; // total Defense Points gained
    MiscellaneousVars[207] -= MiscellaneousVars[33]; // total Deftness Points gained
    MiscellaneousVars[208] -= MiscellaneousVars[34]; // total Sorcery Points gained
    MiscellaneousVars[209] -= MiscellaneousVars[35]; // total Strength Points gained
    MiscellaneousVars[210] -= MiscellaneousVars[36]; // total Therapeusis Points gained
    MiscellaneousVars[204] *= -1; // total Aeon Points gained
    MiscellaneousVars[205] *= -1;
    MiscellaneousVars[206] *= -1;
    MiscellaneousVars[207] *= -1;
    MiscellaneousVars[208] *= -1;
    MiscellaneousVars[209] *= -1;
    MiscellaneousVars[210] *= -1;

    //***************
    //*Mana Increase*
    //***************
    int LevelAddMaxMana = 0;
    if (GameSkill() == SKILL_VERY_EASY)
    {    
     LevelAddMaxMana = Random(5,10);
     Z1 = MaxMana / 96;
    }
    else if (GameSkill() == SKILL_EASY)
    {
     LevelAddMaxMana = Random(4,8);
     Z1 = MaxMana / 120;
    }
    else if (GameSkill() == SKILL_NORMAL)
    {
     LevelAddMaxMana = Random(3,6);
     Z1 = MaxMana / 144;
    }
    else if (GameSkill() == SKILL_HARD)
    {
     LevelAddMaxMana = Random(2,4);
     Z1 = MaxMana / 168;
    }
    else if (GameSkill() == SKILL_VERY_HARD)
    {
     LevelAddMaxMana = Random(1,2);
     Z1 = MaxMana / 192;
    }

    PerkFactor = ((MiscellaneousVars[10003] * 500) + (MiscellaneousVars[10004] * 1250)) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // "MagiUp" and "MagiUp EX" perks.

    PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"

    PerkFactor = ((MiscellaneousVars[10003] / 2) + (MiscellaneousVars[10004]));
    PerkFactor += (MiscellaneousVars[317] * 3) / 8;
    if (Z1 < PerkFactor) Z1 = PerkFactor;
    LevelAddMaxMana += Z1;

    Z1 = random(6,9); // +7-19 + Level base
    PerkFactor = ((MiscellaneousVars[10003] * 500) + (MiscellaneousVars[10004] * 1250)) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // "MagiUp" and "MagiUp EX" perks.

    PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"

    LevelAddMaxMana += Z1;

    if (CharacterClass == 0) G3 = random(36,42); // Deggaris [MP Gain / Level] [75%-87.5%]
    if (CharacterClass == 1) G3 = random(54,60); // Illucia [MP Gain / Level] [112.5%-125%]
    if (CharacterClass == 2) G3 = random(66,84); // Flora [MP Gain / Level] [137.5%-175%]
    if (CharacterClass == 8) G3 = random(60,78); // Ailish [MP Gain / Level]
    if (CharacterClass == 9) G3 = random(49,55); // Petra [MP Gain / Level]

    G3 += ((MiscellaneousVars[36] + MiscellaneousVars[33]) / 48); // Add [(Therapesius+Deftness / 48)]
    LevelAddMaxMana = LevelAddMaxMana * G3 / 48;

    // Overall Modifier
    LevelAddMaxMana = LevelAddMaxMana * 75 / 100;

    if (LevelAddMaxMana < 1) LevelAddMaxMana = 1;

    LevelAddMaxMana *= MiscellaneousVars[146];
    MaxMana += LevelAddMaxMana;
    CurrentMana += LevelAddMaxMana;
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;


    //*************
    //*HP Increase*
    //*************
    int LevelAddMaxHP = 0;
    int HPRandomizer1;
    if (GameSkill() == SKILL_VERY_EASY)
    {
     Z2 = random(2,4);
     Z2 += MaxHealthTrue / 288;
    }
    if (GameSkill() == SKILL_EASY)
    {
     Z2 = random(1,3);
     Z2 += MaxHealthTrue / 360;
    }
    if (GameSkill() == SKILL_NORMAL)
    {
     Z2 = random(0,2);
     Z2 += MaxHealthTrue / 432;
    }
    if (GameSkill() == SKILL_HARD)
    {
     Z2 = random(-1,1);
     Z2 += MaxHealthTrue / 504;
    }
    if (GameSkill() == SKILL_VERY_HARD)
    {
     Z2 = random(-2,0);
     Z2 += MaxHealthTrue / 576;
    }

    Z2 += Random(1,3);
    if (CharacterClass == 0) Z2 += random(3,5); // + 6-12+ HP
    if (CharacterClass == 1) Z2 += random(2,3); // + 5-10+ HP
    if (CharacterClass == 2) Z2 += random(1,2); // + 4-9+ HP
    if (CharacterClass == 8) Z2 += random(1,2); // + 3-8+ HP
    if (CharacterClass == 9) Z2 += random(3,5); // + 6-12+ HP

    PerkFactor = ((MiscellaneousVars[10001] * 500) + (MiscellaneousVars[10002] * 1250)) + 10000;
    Z2 = Z2 * PerkFactor / 10000; // "LifeUp" and "LifeUp EX" perks.

    PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
    Z2 = Z2 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded

    PerkFactor = ((MiscellaneousVars[10003] / 2) + (MiscellaneousVars[10004]));
    PerkFactor += (MiscellaneousVars[317] * 3) / 8;
    if (Z2 < PerkFactor) Z2 = PerkFactor;
    LevelAddMaxHP += Z2;

    if (GameSkill() == SKILL_VERY_EASY) 		Z1 = PlayerLevel * 35 / 100;	// 35%
    else if (GameSkill() == SKILL_EASY) 		Z1 = PlayerLevel * 30 / 100;	// 30%
    else if (GameSkill() == SKILL_NORMAL) 		Z1 = PlayerLevel * 25 / 100;	// 25%
    else if (GameSkill() == SKILL_HARD) 		Z1 = PlayerLevel * 20 / 100;	// 20%
    else if (GameSkill() == SKILL_VERY_HARD) 	Z1 = PlayerLevel * 15 / 100;	// 15%
 
    if (PlayerLevel > 24 && PlayerLevel < 50) 		Z1 = Z1 * 105 / 100; 		// *105%
    if (PlayerLevel > 49 && PlayerLevel < 75) 		Z1 = Z1 * 110 / 100; 		// *110%
    if (PlayerLevel > 74 && PlayerLevel < 100) 		Z1 = Z1 * 115 / 100; 		// *115%
    if (PlayerLevel > 99 && PlayerLevel < 125) 		Z1 = Z1 * 121 / 100; 		// *121%
    if (PlayerLevel > 124 && PlayerLevel < 150) 	Z1 = Z1 * 127 / 100; 		// *127%
    if (PlayerLevel > 149 && PlayerLevel < 175) 	Z1 = Z1 * 133 / 100; 		// *133%
    if (PlayerLevel > 174) 							Z1 = Z1 * 140 / 100; 		// *140%

    PerkFactor = ((MiscellaneousVars[10001] * 500) + (MiscellaneousVars[10002] * 1250)) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // "LifeUp" and "LifeUp EX" perks.

    PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
    Z1 = Z1 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded

    LevelAddMaxHP += Z1;

    if (CharacterClass == 0) G3 = random(54,60); // Deggaris [HP Gain / Level] [112.5%-125%]
    if (CharacterClass == 1) G3 = random(36,42); // Illucia [HP Gain / Level] [75%-87.5%]
    if (CharacterClass == 2) G3 = random(27,33); // Flora [HP Gain / Level] [43.75%-68.75%]
    if (CharacterClass == 8) G3 = random(24,31); // Ailish [HP Gain / Level] Need to list Percentage values later.
    if (CharacterClass == 9) G3 = random(54,60); // Petra [HP Gain / Level] [112.5%-125%].  Same as Deggaris.

    G3 += ((MiscellaneousVars[32] + MiscellaneousVars[33]) / 48); // Add [(Defense+Deftness / 48)]
    LevelAddMaxHP = LevelAddMaxHP * G3 / 48;

    // Overall Modifier
    LevelAddMaxHP = LevelAddMaxHP * 75 / 100; // *75%+

    // Give The HP to the player
    if (LevelAddMaxHP < 1) LevelAddMaxHP = 1;

    LevelAddMaxHP *= MiscellaneousVars[146];
    I2 = GetActorProperty(Player1TID,APROP_HEALTH);
    //GiveInventory("UpgradeStamina", LevelAddMaxHP);
    SetActorProperty(Player1TID,APROP_HEALTH,(I2+LevelAddMaxHP));
    MaxHealthTrue += LevelAddMaxHP;
    SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);
    MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
    MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);

/*
    PrintBold(
              s:"Health: ",d:LevelAddMaxHP,s:"\n",
              s:"Mana: ",d:LevelAddMaxMana,s:"\n",
              s:"AeonPts: ",d:MiscellaneousVars[204],s:"\n",
              s:"Agility: ",d:MiscellaneousVars[205],s:"\n",
              s:"Defense: ",d:MiscellaneousVars[206],s:"\n",
              s:"Deftness: ",d:MiscellaneousVars[207],s:"\n",
              s:"Sorcery: ",d:MiscellaneousVars[208],s:"\n",
              s:"Strength: ",d:MiscellaneousVars[209],s:"\n",
              s:"Therapeusis: ",d:MiscellaneousVars[210]
             );
*/

    // Other Stuff
    if (leveluptimes == 0)
    {
	 if (CharacterClass == 9) ActivatorSound("PetraLeveledUp",127); //Petra
	 else if (CharacterClass == 8) ActivatorSound("AilishLeveledUp",127); //Ailish
     else if (CharacterClass == 2) ActivatorSound("FloraLeveledUp",127); // Flora
     else if (CharacterClass == 1) ActivatorSound("IlluciaLeveledUp",127); // Illucia
     else if (CharacterClass == 0) ActivatorSound("DeggarisLeveledUp",127); // Deggaris
     else ActivatorSound("misc/spawn",127); 
     MiscellaneousVars[247] = 1;
    }

    // [222] # of TOTAL Max HP gained during multiple stat ups [for displays]
    // [223] # of TOTAL Max MP gained during multiple stat ups [for displays]
    // [224] # of TOTAL Aeon Points gained during multiple stat ups [for displays]
    // [225] # of TOTAL Agility Points gained during multiple stat ups [for displays]
    // [226] # of TOTAL Defense Points gained during multiple stat ups [for displays]
    // [227] # of TOTAL Deftness Points gained during multiple stat ups [for displays]
    // [228] # of TOTAL Sorcery Points gained during multiple stat ups [for displays]
    // [229] # of TOTAL Strength Points gained during multiple stat ups [for displays]
    // [230] # of TOTAL Therapeusis Points gained during multiple stat ups [for displays]
    MiscellaneousVars[222] += LevelAddMaxHP;
    MiscellaneousVars[223] += LevelAddMaxMana;
    MiscellaneousVars[224] += MiscellaneousVars[204];
    MiscellaneousVars[225] += MiscellaneousVars[205];
    MiscellaneousVars[226] += MiscellaneousVars[206];
    MiscellaneousVars[227] += MiscellaneousVars[207];
    MiscellaneousVars[228] += MiscellaneousVars[208];
    MiscellaneousVars[229] += MiscellaneousVars[209];
    MiscellaneousVars[230] += MiscellaneousVars[210];
    if (MiscellaneousVars[222] > 0) MiscellaneousVars[2031] = 105;
    if (MiscellaneousVars[223] > 0) MiscellaneousVars[2032] = 105;
    if (MiscellaneousVars[224] > 0) MiscellaneousVars[2033] = 105;
    if (MiscellaneousVars[225] > 0) MiscellaneousVars[2034] = 105;
    if (MiscellaneousVars[226] > 0) MiscellaneousVars[2035] = 105;
    if (MiscellaneousVars[227] > 0) MiscellaneousVars[2036] = 105;
    if (MiscellaneousVars[228] > 0) MiscellaneousVars[2037] = 105;
    if (MiscellaneousVars[229] > 0) MiscellaneousVars[2038] = 105;
    if (MiscellaneousVars[230] > 0) MiscellaneousVars[2039] = 105;

    SetHudSize(640,480,0);  
    // TODO: Redo the display for levelups to be more dynamic looking [and be one HudMessage instead of using 8 different if forks] >.>

    str LearnedSpells = "";
        if (PlayerLevel <= 32) LearnedSpells = "\c[Green]New Spells Have Been Learned!\cf\n\n";
        if (CharacterClass == 2 && PlayerLevel == 56) LearnedSpells = "\c[Green]New Spells Have Been Learned!\cf\n\n";

    str AeonPtUse = "";
        if (PlayerLevel >= MiscellaneousVars[197]) AeonPtUse = "\c[White]Remember to allocate any Aeon Points you've attained!\cf\n\n";

    str SpinAttack = "";
        if (CharacterClass == 2 && PlayerLevel == 8) SpinAttack = "\caThe Sceptre Will Now Have an Alternate\n\caAttack if Sceptre Level is above 2!\cf";

    if (MiscellaneousVars[2000] == 0)
    {
     HudMessage(
               s:"\cdCongradulations, you've reached Level ",d:PlayerLevel,s:"\n\n",
               s:"\cf",

               s:"\caHP \cf+",d:LevelAddMaxHP,s:"\n",
               s:"\c[Purple]Mana \cf+",d:LevelAddMaxMana,s:"\n",
               s:"\c[White]AeonPts: \cf+",d:MiscellaneousVars[204],s:"\n",
               s:"\c[LightBlue]Agility: \cf+",d:MiscellaneousVars[205],s:"\n",
               s:"\c[Olive]Defense: \cf+",d:MiscellaneousVars[206],s:"\n",
               s:"\c[Green]Deftness: \cf+",d:MiscellaneousVars[207],s:"\n",
               s:"\c[Purple]Sorcery: \cf+",d:MiscellaneousVars[208],s:"\n",
               s:"\c[Red]Strength: \cf+",d:MiscellaneousVars[209],s:"\n",
               s:"\c[Gray]Therapeusis: \cf+",d:MiscellaneousVars[210],s:"\n\n",

               s:LearnedSpells,
               s:AeonPtUse,
               s:SpinAttack;

               HUDMSG_LOG,3432,cr_orange,320.4,240.0,2.25);
    }
    FadeRange(0,0,255,0.3,0,0,255,0.0,0.036);
    SetHudSize(0,0,0);  

   }
  }
  else break;
 }

/* 
 PrintBold(s:"PlayerLevel: ",d:PlayerLevel,
           s:"\nCurrentMana: ",d:CurrentMana,
           s:"\nMaxMana: ",d:MaxMana,
           s:"\nExperience: ",d:Experience,
           s:"\nExpToNext: ",d:ExpTable[PlayerLevel],
           s:"\nBaseEXPRequirement: ",d:BaseEXPRequirement,
           s:"\nMiscellaneousVars[157]: ",d:MiscellaneousVars[157],
           s:"\nMiscellaneousVars[185]: ",d:MiscellaneousVars[185],
           s:"\nMiscellaneousVars[183]: ",d:MiscellaneousVars[183],
           s:"\nMiscellaneousVars[186]: ",d:MiscellaneousVars[186],
           s:"\nMiscellaneousVars[188]: ",d:MiscellaneousVars[188]);
*/

 Delay(1);
 Restart;
}

// Experiessence Pickup
script "PickupExperiessence" (int percentage)
{
 int BaseEXPGain = percentage;
 int perkfactor;
 if (random(1,64) == 1) BaseEXPGain *= 2;
 if (random(1,256) == 1) BaseEXPGain *= 2;
 if (random(1,1024) == 1) BaseEXPGain *= 2;

 int EXPGiven;
 
 if (PlayerLevel == 0) { EXPGiven = (ExpTable[PlayerLevel] * BaseEXPGain) / 100; }
 else if (PlayerLevel >= 1) { EXPGiven = ((ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1]) * BaseEXPGain) / 100; }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Experiessence: ",d:EXPGiven,s:" [Base]");

 if (MiscellaneousVars[10055] > 0)
 {
  perkfactor = 100;
  if (MiscellaneousVars[10055] >= 1) perkfactor += 4;
  if (MiscellaneousVars[10055] >= 2) perkfactor += 5;
  if (MiscellaneousVars[10055] >= 3) perkfactor += 6;
  if (MiscellaneousVars[10055] >= 4) perkfactor += 7;
  if (MiscellaneousVars[10055] >= 5) perkfactor += 8;
  if (MiscellaneousVars[10056] >= 1) perkfactor += 15;
  if (MiscellaneousVars[10056] >= 2) perkfactor += 15;
  EXPGiven = (EXPGiven * perkfactor) / 100;
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Experiessence: ",d:EXPGiven,s:" [Perks1]");
 }
 if (MiscellaneousVars[11001] > 0)
 {
  if (MiscellaneousVars[11001] == 1)
  {
   if (CharacterClass == 0 | CharacterClass == 1) EXPGiven = EXPGiven * 49 / 40; // EXP Multiplier Option [122.5%]
   if (CharacterClass == 2) EXPGiven = EXPGiven * 23 / 20; // EXP Multiplier Option [115%]
  }
  if (MiscellaneousVars[11001] == 2)
  {
   if (CharacterClass == 0 | CharacterClass == 1) EXPGiven = EXPGiven * 29 / 20; // EXP Multiplier Option [145%]
   if (CharacterClass == 2) EXPGiven = EXPGiven * 13 / 10; // EXP Multiplier Option [115%]
  }
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Experiessence: ",d:EXPGiven,s:" [Perks2]");
 }
  
 Experience += EXPGiven;
}

// Old DoomSpellV2 Style Completion Bonues [optional, turned OFF by default]
script "OldDoomSpellCompletion" ENTER
{
 str SecretBonusText1;
 int SecretBonusText2;
 str SecretBonusText3;
 str ItemBonusText1;
 int ItemBonusText2;
 str ItemBonusText3;
 str KillBonusText1;
 int KillBonusText2;
 str KillBonusText3;

 int ItemsForMultiplier = GetCVar("dvds_itemsfoundformulti");
 int SecretsForMultiplier = GetCVar("dvds_secretsfoundformulti");
 int KillsForMultiplier = GetCVar("dvds_monsterskilledformulti");
 
 int XSize = 800;
 int YSize = 600;
 int XPos = 0;
 int XPosF = 0.0;
 int YPos = 0;
 int YPosF = 0.0;

 int BaseEXPGain = 10; // Base % of EXP given for Completion Bonus
 int BaseAeonPoints = 1;

 int ExtraMultiplier = 1;
 
 if (GetLevelInfo(LEVELINFO_TOTAL_SECRETS) <= 0) SecretBonusApplied = 1;
 if (GetLevelInfo(LEVELINFO_TOTAL_ITEMS) <= 0) ItemBonusApplied = 1;
 if (GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) <= 0) KillBonusApplied = 1;
 
 if (GetCVar("dvds_oldcompletionbonuses") > 0)
 {
  if (SecretBonusApplied == 0)
  {
   if (GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
   {
    ExtraMultiplier = (GetLevelInfo(LEVELINFO_TOTAL_SECRETS) / SecretsForMultiplier) + 1;
    SecretBonusApplied = 1;
    SecretBonusText1 = "100% secrets found bonus:\n\n";
	if (GetCVar("dvds_secretsfoundbonus") == 0)
	{
     BaseEXPGain *= GetCVar("dvds_secretsfoundmulti");
	 BaseEXPGain *= ExtraMultiplier;
     BaseEXPGain = BaseEXPGain >> 16;
	 if (PlayerLevel == 0) { Experience += (ExpTable[PlayerLevel] * BaseEXPGain) / 100; }
	 else if (PlayerLevel >= 1) { Experience += ((ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1]) * BaseEXPGain) / 100; }
	  
	 SecretBonusText2 = BaseEXPGain;
	 SecretBonusText3 = "% of the experience required to reach the next level.";
	}
	if (GetCVar("dvds_secretsfoundbonus") == 1)
	{
     BaseAeonPoints *= GetCVar("dvds_secretsfoundmulti");
	 BaseAeonPoints *= ExtraMultiplier;
     BaseAeonPoints = BaseAeonPoints >> 16;
	 if (BaseAeonPoints < 1) BaseAeonPoints = 1;
     MiscellaneousVars[25] += BaseAeonPoints;
     MiscellaneousVars[224] += BaseAeonPoints; 
	 MiscellaneousVars[2033] = 105;

	 SecretBonusText2 = BaseAeonPoints;
	 if (BaseAeonPoints > 1) { SecretBonusText3 = " Aeon Points."; } else { SecretBonusText3 = " Aeon Point."; }
	}

    SetFont("DVDSBIGFONT");
    SetHudSize(XSize,YSize,0);
    XPos = XSize / 2;
    XPosF = XPos * 1.0 + 0.4;
    YPos = YSize * 6 / 9;
    YPosF = YPos * 1.0;
	HudMessage(s:SecretBonusText1,d:SecretBonusText2,s:SecretBonusText3;
	              HUDMSG_TYPEON,106,CR_BLUE,XPosF,YPosF,2.5,0.025,0.125,0.75);
    SetHudSize(0,0,0);
    SetFont("SMALLFONT");
   }
  }
  if (ItemBonusApplied == 0)
  {
   if (GetLevelInfo(LEVELINFO_TOTAL_ITEMS) == GetLevelInfo(LEVELINFO_FOUND_ITEMS))
   {
    ExtraMultiplier = (GetLevelInfo(LEVELINFO_TOTAL_ITEMS) / ItemsForMultiplier) + 1;
    ItemBonusApplied = 1;
	ItemBonusText1 = "100% items found bonus:\n\n";
	if (GetCVar("dvds_itemsfoundbonus") == 0)
	{
     BaseEXPGain *= GetCVar("dvds_itemsfoundmulti");
	 BaseEXPGain *= ExtraMultiplier;
     BaseEXPGain = BaseEXPGain >> 16;
	 if (PlayerLevel == 0) { Experience += (ExpTable[PlayerLevel] * BaseEXPGain) / 100; }
	 else if (PlayerLevel >= 1) { Experience += ((ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1]) * BaseEXPGain) / 100; }
	  
	 ItemBonusText2 = BaseEXPGain;
	 ItemBonusText3 = "% of the experience required to reach the next level.";
	}
	if (GetCVar("dvds_itemsfoundbonus") == 1)
	{
     BaseAeonPoints *= GetCVar("dvds_itemsfoundmulti");
	 BaseAeonPoints *= ExtraMultiplier;
     BaseAeonPoints = BaseAeonPoints >> 16;
	 if (BaseAeonPoints < 1) BaseAeonPoints = 1;
     MiscellaneousVars[25] += BaseAeonPoints;
     MiscellaneousVars[224] += BaseAeonPoints; 
	 MiscellaneousVars[2033] = 105;

	 ItemBonusText2 = BaseAeonPoints;
	 if (BaseAeonPoints > 1) { ItemBonusText3 = " Aeon Points."; } else { ItemBonusText3 = " Aeon Point."; }
	}

    SetFont("DVDSBIGFONT");
    SetHudSize(XSize,YSize,0);
    XPos = XSize / 2;
    XPosF = XPos * 1.0 + 0.4;
    YPos = YSize * 7 / 9;
    YPosF = YPos * 1.0;
	HudMessage(s:ItemBonusText1,d:ItemBonusText2,s:ItemBonusText3;
	              HUDMSG_TYPEON,107,CR_GREEN,XPosF,YPosF,2.5,0.025,0.125,0.75);
    SetHudSize(0,0,0);
    SetFont("SMALLFONT");
   }
  }
  if (KillBonusApplied == 0)
  {
   if (GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) == GetLevelInfo(LEVELINFO_KILLED_MONSTERS))
   {
    ExtraMultiplier = (GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) / KillsForMultiplier) + 1;
    KillBonusApplied = 1;
	KillBonusText1 = "100% monsters killed bonus:\n\n";
	if (GetCVar("dvds_monsterskilledbonus") == 0)
	{
     BaseEXPGain *= GetCVar("dvds_monsterskilledmulti");
	 BaseEXPGain *= ExtraMultiplier;
     BaseEXPGain = BaseEXPGain >> 16;
	 if (PlayerLevel == 0) { Experience += (ExpTable[PlayerLevel] * BaseEXPGain) / 100; }
	 else if (PlayerLevel >= 1) { Experience += ((ExpTable[PlayerLevel] - ExpTable[PlayerLevel - 1]) * BaseEXPGain) / 100; }
	  
	 KillBonusText2 = BaseEXPGain;
	 KillBonusText3 = "% of the experience required to reach the next level.";
	}
	if (GetCVar("dvds_monsterskilledbonus") == 1)
	{
     BaseAeonPoints *= GetCVar("dvds_monsterskilledmulti");
	 BaseAeonPoints *= ExtraMultiplier;
     BaseAeonPoints = BaseAeonPoints >> 16;
	 if (BaseAeonPoints < 1) BaseAeonPoints = 1;
     MiscellaneousVars[25] += BaseAeonPoints;
     MiscellaneousVars[224] += BaseAeonPoints; 
	 MiscellaneousVars[2033] = 105;

	 KillBonusText2 = BaseAeonPoints;
	 if (BaseAeonPoints > 1) { KillBonusText3 = " Aeon Points."; } else { KillBonusText3 = " Aeon Point."; }
	}

    SetFont("DVDSBIGFONT");
    SetHudSize(XSize,YSize,0);
    XPos = XSize / 2;
    XPosF = XPos * 1.0 + 0.4;
    YPos = YSize * 8 / 9;
    YPosF = YPos * 1.0;
	HudMessage(s:KillBonusText1,d:KillBonusText2,s:KillBonusText3;
	              HUDMSG_TYPEON,108,CR_RED,XPosF,YPosF,2.5,0.025,0.125,0.75);
    SetHudSize(0,0,0);
    SetFont("SMALLFONT");
   }
  }
 }

 str FullBonusText1;
 int FullBonusText2;
 str FullBonusText3;

 if (SecretBonusApplied == 1 && ItemBonusApplied == 1 && KillBonusApplied == 1)
 {
  Terminate;
 }
 else
 {
  Delay(random(17,18));
  Restart;
 }
}


// Spell Selection
script "SpellSelection" (int Dir)
{
/*
 //**********************************
 //*** New Spell Selection System ***
 //**********************************
  // MiscellaneousVars[9] is for the category of spells you're using [for revised Spell Selecting]
  // MiscellaneousVars[10] is for the subspell within the current category of spells you're using [for revised Spell Selecting]
  // MiscellaneousVars[70] is storage for the Spell# under the "Offense" spell category [value storage]
  // MiscellaneousVars[71] is storage for the Spell# under the "Restorative" spell category [value storage]
  // MiscellaneousVars[72] is storage for the Spell# under the "Status" spell category [value storage]
  // MiscellaneousVars[73] is storage for the Spell# under the "Conjure" spell category [value storage]

  if (GetActorProperty(Player1TID,APROP_HEALTH) > 0) // Fix Oversight
  {
   // Toggles the Current Spell Category
   if (Dir > 1 && Dir < 4)
   {
    if (Dir == 2) // Previous Spell Category
    {
     MiscellaneousVars[9] -= 1;
     if (MiscellaneousVars[9] < 0) MiscellaneousVars[9] = 3;
    }
    if (Dir == 3) // Next Spell Category
    {
     MiscellaneousVars[9] += 1;
     if (MiscellaneousVars[9] > 3) MiscellaneousVars[9] = 0;
    }
    if (MiscellaneousVars[9] == 0) MiscellaneousVars[10] = MiscellaneousVars[70]; // "Offense" [23]
    if (MiscellaneousVars[9] == 1) MiscellaneousVars[10] = MiscellaneousVars[71]; // "Restorative" [5]
    if (MiscellaneousVars[9] == 2) MiscellaneousVars[10] = MiscellaneousVars[72]; // "Status" [20]
    if (MiscellaneousVars[9] == 3) MiscellaneousVars[10] = MiscellaneousVars[73]; // "Conjure" [7]
   }
 
   // Allows Cycling Spells within a specfic Category
   if (Dir > -1 && Dir < 2)
   {
    if (Dir == 0) // Previous Spell
    {
     MiscellaneousVars[10] -= 1;
     if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] < 0) MiscellaneousVars[10] = 22;
     if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] < 0) MiscellaneousVars[10] = 4;
     if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] < 0) MiscellaneousVars[10] = 19;
     if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] < 0) MiscellaneousVars[10] = 6;
    }
    if (Dir == 1) // Next Spell
    {
     MiscellaneousVars[10] += 1;
     if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] > 22) MiscellaneousVars[10] = 0;
     if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] > 4) MiscellaneousVars[10] = 0;
     if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] > 19) MiscellaneousVars[10] = 0;
     if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] > 6) MiscellaneousVars[10] = 0;
    }
    if (MiscellaneousVars[9] == 0) MiscellaneousVars[70] = MiscellaneousVars[10]; // "Offense" [23]
    if (MiscellaneousVars[9] == 1) MiscellaneousVars[71] = MiscellaneousVars[10]; // "Restorative" [5]
    if (MiscellaneousVars[9] == 2) MiscellaneousVars[72] = MiscellaneousVars[10]; // "Status" [20]
    if (MiscellaneousVars[9] == 3) MiscellaneousVars[73] = MiscellaneousVars[10]; // "Conjure" [7]
   }

   // Aftermath: Determine which Spell ID to select based on above options.

   // Offense
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 0) SelectedSpell = 0; // Minor Magic Missile
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 1) SelectedSpell = 3; // Chill Touch
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 2) SelectedSpell = 6; // Minor Poison Cloud
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 3) SelectedSpell = 7; // Minor Fireball
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 4) SelectedSpell = 9; // Minor Ice Blast
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 5) SelectedSpell = 11; // Magic Missile
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 6) SelectedSpell = 12; // Fireball
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 7) SelectedSpell = 13; // Explosive Glyph
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 8) SelectedSpell = 15; // Fireball Nova
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 9) SelectedSpell = 19; // Acid Rain
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 10) SelectedSpell = 20; // Freezing Glyph
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 11) SelectedSpell = 23; // Major Magic Missile
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 12) SelectedSpell = 25; // Icy Nova
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 13) SelectedSpell = 26; // Poison Cloud
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 14) SelectedSpell = 27; // Minor Lightning
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 15) SelectedSpell = 31; // Ice Blast
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 16) SelectedSpell = 33; // Lightning Nova
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 17) SelectedSpell = 38; // Lightning
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 18) SelectedSpell = 41; // Major Fireball
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 19) SelectedSpell = 42; // Major Ice Blast
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 20) SelectedSpell = 43; // Major Poison Cloud
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 21) SelectedSpell = 44; // Major Lightning
   if (MiscellaneousVars[9] == 0 && MiscellaneousVars[10] == 22) SelectedSpell = 49; // Ultra Magic Missile
   // Restorative
   if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] == 0) SelectedSpell = 1; // Minor Healing
   if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] == 1) SelectedSpell = 14; // Healing
   if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] == 2) SelectedSpell = 28; // Stone Skin
   if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] == 3) SelectedSpell = 29; // Major Healing
   if (MiscellaneousVars[9] == 1 && MiscellaneousVars[10] == 4) SelectedSpell = 40; // Diamond Skin
   // Status
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 0) SelectedSpell = 2; // Minor Night-Vision
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 1) SelectedSpell = 4; // Minor Invisibility
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 2) SelectedSpell = 5; // Minor Flight
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 3) SelectedSpell = 8; // Enhanced Strength
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 4) SelectedSpell = 16; // Minor Stealth
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 5) SelectedSpell = 17; // Minor Invulnerability
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 6) SelectedSpell = 18; // Invisibility
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 7) SelectedSpell = 21; // Night Vision
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 8) SelectedSpell = 22; // Flight
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 9) SelectedSpell = 30; // Major Night Vision
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 10) SelectedSpell = 32; // Farsight
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 11) SelectedSpell = 34; // Stealth
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 12) SelectedSpell = 35; // Invulnerability
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 13) SelectedSpell = 36; // Major Invisiblity
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 14) SelectedSpell = 37; // Major Flight
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 15) SelectedSpell = 45; // Major Invulnerability
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 16) SelectedSpell = 46; // Major Stealth
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 17) SelectedSpell = 50; // Time Freezer
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 18) SelectedSpell = 51; // Terrorization Aura
   if (MiscellaneousVars[9] == 2 && MiscellaneousVars[10] == 19) SelectedSpell = 53; // Divine Avatar
   // Conjure
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 0) SelectedSpell = 10; // Summon Weak Monster
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 1) SelectedSpell = 24; // Summon Monster
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 2) SelectedSpell = 39; // Summon Strong Monster
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 3) SelectedSpell = 47; // Raging Spirits
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 4) SelectedSpell = 48; // Summon Arch-Vile
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 5) SelectedSpell = 52; // Create Lotso Ammo
   if (MiscellaneousVars[9] == 3 && MiscellaneousVars[10] == 6) SelectedSpell = 54; // Summon Cyberdemon

   // PrintBold(s:"Category#: ",d:MiscellaneousVars[9],s:"\nSpell#: ",d:MiscellaneousVars[10],s:"\nCat1Spell#: ",d:MiscellaneousVars[70],s:"\nCat2Spell#: ",d:MiscellaneousVars[71],s:"\nCat3Spell#: ",d:MiscellaneousVars[72],s:"\nCat4Spell#: ",d:MiscellaneousVars[73]);
  }
*/

 //**********************************
 //*** Old Spell Selection System ***
 //**********************************
 if (GetActorProperty(Player1TID,APROP_HEALTH) > 0) // Fix Oversight
 {
  if (Dir == 1) // Next Spell
  {
   SelectedSpell += 1;

   //PrintBold(d:SpellsLearned[PlayerLevel]);

   if (PlayerLevel < 57)
   {
    if (SelectedSpell < 0)
     SelectedSpell = SpellsLearned[PlayerLevel];
   }
   if (SelectedSpell < 0)
    SelectedSpell = SpellIDLimit;

   // 15, 20, 23, 29, 30, 33, 34, 36, 37, 41, 42, 44, 45, 46, 48, 49, 50, 54, 55 = Deggaris Cannot use these Spell IDs in final version
   if (CharacterClass == 0) // Deggaris
   {
    if (SelectedSpell == 15) SelectedSpell += 1; // Skip "Fireball Nova"
    if (SelectedSpell == 20) SelectedSpell += 1; // Skip "Freezing Glyph"
    if (SelectedSpell == 23) SelectedSpell += 1;
    if (SelectedSpell == 29) SelectedSpell += 1;
    if (SelectedSpell == 30) SelectedSpell += 1;
    if (SelectedSpell == 33) SelectedSpell += 1;
    if (SelectedSpell == 34) SelectedSpell += 1;
    if (SelectedSpell == 36) SelectedSpell += 1;
    if (SelectedSpell == 37) SelectedSpell += 1;
    if (SelectedSpell == 41) SelectedSpell += 1; // Skip "Major Fireball"
    if (SelectedSpell == 42) SelectedSpell += 1; // Skip "Major Ice Blast"
    if (SelectedSpell == 44) SelectedSpell += 1; // Skip "Major Lightning"
    if (SelectedSpell == 45) SelectedSpell += 1; // Skip "Major Invulnerability"
    if (SelectedSpell == 46) SelectedSpell += 1; // Skip "Major Stealth"
    if (SelectedSpell == 48) SelectedSpell += 1; // Skip "Summon Arch-Vile"
    if (SelectedSpell == 49) SelectedSpell += 1; // Skip "Ultimate Magic Missile"
    if (SelectedSpell == 50) SelectedSpell += 1; // Skip "Time Freezer"
    if (SelectedSpell == 54) SelectedSpell += 1; // Skip "Summon Cyberdemon"
    if (SelectedSpell == 55) SelectedSpell += 1; // Skip "Spreader Aura Lv. 1"
   }

   // 6, 25, 26, 43, 49, 51, 55 = Illucia Cannot use these Spell IDs in final version
   if (CharacterClass == 1) // Illucia
   {
    if (SelectedSpell == 6) SelectedSpell += 1; // Skip "Minor Poison Cloud"
    if (SelectedSpell == 26) SelectedSpell += 1; // Skip "Poison Cloud"
    if (SelectedSpell == 43) SelectedSpell += 1; // Skip "Major Poison Cloud"
    if (SelectedSpell == 49) SelectedSpell += 1; // Skip "Ultimate Magic Missile"
    if (SelectedSpell == 51) SelectedSpell += 1; // Skip "Terrorization Aura"
    if (SelectedSpell == 55) SelectedSpell += 1; // Skip "Spreader Aura Lv. 1"
   }

   // 28, 52 = Flora Cannot use these Spell IDs in final version
   if (CharacterClass == 2) // Flora
   {
    if (SelectedSpell == 28) SelectedSpell += 1; // Skip "Stone Skin"
    if (SelectedSpell == 52) SelectedSpell += 1; // Skip "Create Lotso Ammo"
   }

   // Ailish cannot use these spell IDs.  To be filled out...
   // if (CharacterClass == 8) // Ailish

   // Petra cannot use these spell IDs.  To be filled out...
   if (CharacterClass == 9) // Petra
   {
    if (SelectedSpell == 6) SelectedSpell += 1; // Skip "Minor Poison Cloud"
    if (SelectedSpell == 26) SelectedSpell += 1; // Skip "Poison Cloud"
    if (SelectedSpell == 28) SelectedSpell += 1; // Skip "Stone Skin"
    if (SelectedSpell == 43) SelectedSpell += 1; // Skip "Major Poison Cloud"
    if (SelectedSpell == 49) SelectedSpell += 1; // Skip "Ultimate Magic Missile"
   }

   if (PlayerLevel < 57)
   {
    if (SelectedSpell > SpellsLearned[PlayerLevel])
     SelectedSpell = 0;
   }
   if (SelectedSpell > SpellIDLimit)
    SelectedSpell = 0;
  }

  if (Dir == 0) // Previous Spell
  {
   SelectedSpell -= 1;

   //PrintBold(d:SpellsLearned[PlayerLevel]);
   if (PlayerLevel < 57)
   {
    if (SelectedSpell < 0)
     SelectedSpell = SpellsLearned[PlayerLevel];
   }
   if (SelectedSpell < 0)
    SelectedSpell = SpellIDLimit;

   // 15, 20, 23, 29, 30, 33, 34, 36, 37, 41, 42, 44, 45, 46, 48, 49, 50, 54, 55 = Deggaris Cannot use these Spell IDs in final version
   if (CharacterClass == 0) // Deggaris
   {
    if (SelectedSpell == 55) SelectedSpell -= 1; // Skip "Spreader Aura"
    if (SelectedSpell == 54) SelectedSpell -= 1; // Skip "Summon Cyberdemon"
    if (SelectedSpell == 50) SelectedSpell -= 1; // Skip "Time Freezer"
    if (SelectedSpell == 49) SelectedSpell -= 1; // Skip "Ultimate Magic Missile"
    if (SelectedSpell == 48) SelectedSpell -= 1; // Skip "Summon Arch-Vile"
    if (SelectedSpell == 46) SelectedSpell -= 1; // Skip "Major Stealth"
    if (SelectedSpell == 45) SelectedSpell -= 1; // Skip "Major Invulnerability"
    if (SelectedSpell == 44) SelectedSpell -= 1; // Skip "Major Lightning"
    if (SelectedSpell == 42) SelectedSpell -= 1; // Skip "Major Ice Blast"
    if (SelectedSpell == 41) SelectedSpell -= 1; // Skip "Major Fireball"
    if (SelectedSpell == 37) SelectedSpell -= 1;
    if (SelectedSpell == 36) SelectedSpell -= 1;
    if (SelectedSpell == 34) SelectedSpell -= 1;
    if (SelectedSpell == 33) SelectedSpell -= 1;
    if (SelectedSpell == 30) SelectedSpell -= 1;
    if (SelectedSpell == 29) SelectedSpell -= 1;
    if (SelectedSpell == 23) SelectedSpell -= 1;
    if (SelectedSpell == 20) SelectedSpell -= 1; // Skip "Freezing Glyph"
    if (SelectedSpell == 15) SelectedSpell -= 1; // Skip "Fireball Nova"
   }

   // 6, 25, 26, 43, 49, 51, 55 = Illucia Cannot use these Spell IDs in final version
   if (CharacterClass == 1) // Illucia
   {
    if (SelectedSpell == 55) SelectedSpell -= 1; // Skip "Spreader Aura"
    if (SelectedSpell == 51) SelectedSpell -= 1; // Skip "Terrorization Aura"
    if (SelectedSpell == 49) SelectedSpell -= 1; // Skip "Ultimate Magic Missile"
    if (SelectedSpell == 43) SelectedSpell -= 1; // Skip "Major Poison Cloud"
    if (SelectedSpell == 26) SelectedSpell -= 1; // Skip "Poison Cloud"
    if (SelectedSpell == 6) SelectedSpell -= 1; // Skip "Minor Poison Cloud"
   }

   // 28, 52 = Flora Cannot use these Spell IDs in final version
   if (CharacterClass == 2) // Flora
   {
    if (SelectedSpell == 52) SelectedSpell -= 1; // Skip "Create Lotso Ammo"
    if (SelectedSpell == 28) SelectedSpell -= 1; // Skip "Stone Skin"
   }

   // Ailish cannot use these spell IDs.  To be filled out...
   // if (CharacterClass == 8) // Ailish

   // Petra cannot use these spell IDs.  To be filled out...
   if (CharacterClass == 9) // Petra
   {
    if (SelectedSpell == 52) SelectedSpell -= 1; // Skip "Create Lotso Ammo"
    if (SelectedSpell == 49) SelectedSpell -= 1; // Skip "Ultimate Magic Missile"
    if (SelectedSpell == 43) SelectedSpell -= 1; // Skip "Major Poison Cloud"
    if (SelectedSpell == 28) SelectedSpell -= 1; // Skip "Stone Skin"
    if (SelectedSpell == 26) SelectedSpell -= 1; // Skip "Poison Cloud"
    if (SelectedSpell == 6) SelectedSpell -= 1; // Skip "Minor Poison Cloud"
   }

   //PrintBold(d:SpellsLearned[PlayerLevel]);
   if (PlayerLevel < 57)
   {
    if (SelectedSpell < 0)
     SelectedSpell = SpellsLearned[PlayerLevel];
   }
   if (SelectedSpell < 0)
    SelectedSpell = SpellIDLimit;

  }
 }


}

// Spell Readying (For Five Slot system)
script "SpellQuickAssign" (int Slot, int Type)
{
 if (MiscellaneousVars[2500] != 0) terminate; // cannot change spells in the menu
 if (PowerupTimer[20] > 0 || PowerupTimer[21] > 0) // cannot cast spells while put to sleep/silenced/muted :V
 {
  PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  terminate; 
 }
 
 int C1, C2, C3, I1, I2, I3, G1, G2, G3, G4, Z1, Z2;
 int MaxHealthLimit = MaxHealthTrue * 2;
 
 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 if (buttons & BT_SPEED) Type = 0; // Assign Current Spell to Slot Reflecting the pressed key
 else if (buttons & BT_RELOAD) Type = 1; // Clear Slot Reflecting the pressed key
 else Type = 2; // Fire Spell if no specfic buttons are held down

 if (Type == 0) // assign spell
 {
  if (GetActorProperty(Player1TID,APROP_HEALTH) > 0) // Fix Oversight
  {
   for (C1 = 0; C1 < 10; C1++)
   {
    if (ReadiedSpells[C1] == 0) // Initialize unused slots
    {
     ReadiedSpells[C1] = 0;
    }
   }
   ReadiedSpells[Slot] = SelectedSpell + 1;
  }
 }
 if (Type == 1) // clear spell
 {
  if (GetActorProperty(Player1TID,APROP_HEALTH) > 0) // Fix Oversight
  {
   ReadiedSpells[Slot] = 0;
  }
 }
 if (Type == 2) // cast spell
 {
  if (ReadiedSpells[Slot] != 0)
  {
   // Function Ran
   G1 = SpellCostCheck(ReadiedSpells[Slot] - 1); // Function testing to come later :P
   MiscellaneousVars[555] = G1; // Saves spellcost into a global array [in case the spell fails, so it gives back the MP you lost] :P
   // Function Ran

   if (GetActorProperty(Player1TID,APROP_HEALTH) > 0) // Fix Oversight
   {
    if (CurrentMana >= G1)
    {
     //PrintBold(d:ReadiedSpells[Slot]);
     if (ReadiedSpells[Slot] == 2) // Minor Healing [Deggaris/Illucia Only]
     {
	  if (buttons & BT_ZOOM)
	  {
       CurrentMana -= G1;
       MiscellaneousVars[243] = CurrentMana;
       MiscellaneousVars[238] = CurrentMana;
       ACS_NamedExecuteAlways("MagicEffects",0,0,-3,0);
	  }
	  else
	  {
       if (GetActorProperty(Player1TID,APROP_HEALTH) < MaxHealthTrue)
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
       }
	  }
     }
     else if (ReadiedSpells[Slot] == 15) // Healing [Deggaris/Illucia Only]
     {
	  if (buttons & BT_ZOOM)
	  {
       CurrentMana -= G1;
       MiscellaneousVars[243] = CurrentMana;
       MiscellaneousVars[238] = CurrentMana;
       ACS_NamedExecuteAlways("MagicEffects",0,0,-2,0);
	  }
	  else
	  {
       if (GetActorProperty(Player1TID,APROP_HEALTH) < MaxHealthTrue)
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
       }
	  }
     }
     else if (ReadiedSpells[Slot] == 29) // Stone Skin [Deggaris/Illucia Only]
     {
      if (PowerupTimer[7] > 0)
      {
       if (CheckInventory("Armor") < 2000)
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
       }
      }
      else
      {
       if (CheckInventory("Armor") < 500)
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
       }
      }
     }
     else if (ReadiedSpells[Slot] == 30) // Major Healing [Deggaris/Illucia Only]
     {
	  if (buttons & BT_ZOOM)
	  {
       CurrentMana -= G1;
       MiscellaneousVars[243] = CurrentMana;
       MiscellaneousVars[238] = CurrentMana;
       ACS_NamedExecuteAlways("MagicEffects",0,0,-1,0);
	  }
	  else
	  {
       if (GetActorProperty(Player1TID,APROP_HEALTH) < MaxHealthLimit)
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
       }
	  }
     }
     else if (ReadiedSpells[Slot] == 41) // Diamond Skin [Deggaris/Illucia Only] or Spreader Aura Lv. 1 [Flora Only]
     {
      //PrintBold(d:CharacterClass);
      if (CharacterClass == 2) // Flora has "Spreader Aura Lv. 1" in this slot instead of "Diamond Skin"
      {
       if (CheckActorInventory(Player1TID,"SpreaderAura2") > 0) // If Lv. 2 is intact, give it a random (6-8) seconds. :P
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,18,random(6,8),0);
       }
       else // If only Lv. 1 is intact, give it the full 30 seconds. :P
       {
        CurrentMana -= G1;
        MiscellaneousVars[243] = CurrentMana;
        MiscellaneousVars[238] = CurrentMana;
        ACS_NamedExecuteAlways("MagicEffects",0,17,30,0);
       }
      }
      else // Deggaris & Illucia use "Diamond Skin" in this slot.
      {
       if (PowerupTimer[7] > 0)
       {
        if (CheckInventory("Armor") < 5000)
        {
         CurrentMana -= G1;
         MiscellaneousVars[243] = CurrentMana;
         MiscellaneousVars[238] = CurrentMana;
         ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
        }
       }
       else
       {
        if (CheckInventory("Armor") < 1250)
        {
         CurrentMana -= G1;
         MiscellaneousVars[243] = CurrentMana;
         MiscellaneousVars[238] = CurrentMana;
         ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
        }
       }
      }
     }
     else if (ReadiedSpells[Slot] == 11 || ReadiedSpells[Slot] == 25 || ReadiedSpells[Slot] == 40 || ReadiedSpells[Slot] == 49 || ReadiedSpells[Slot] == 55) // Summon Spells
	 {
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
	 }
     else // All Other Spells [Deggaris/Illucia Only]
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[ReadiedSpells[Slot] - 1],SpellCastStrength[ReadiedSpells[Slot] - 1],0);
     }
    }
   }

  }
 }
}

// {-7-} Spell Casting

script "SpellCasting" (void)
{
 if (MiscellaneousVars[2500] != 0) terminate; 
 if (PowerupTimer[20] > 0 || PowerupTimer[21] > 0) // cannot cast spells while put to sleep :V
 {
  PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  terminate; 
 }

 int C1, C2, I1, I2, G1, G2, G3, G4, Z1, Z2;
 int MaxHealthLimit = MaxHealthTrue * 2;

 // Function Ran
 G1 = SpellCostCheck(SelectedSpell); // Function testing to come later :P
 MiscellaneousVars[555] = G1; // Saves spellcost into a global array [in case the spell fails, so it gives back the MP you lost] :P
 // Function Ran

 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 if (GetActorProperty(Player1TID,APROP_HEALTH) > 0)
 {
  if (CurrentMana >= G1)
  {
   //PrintBold(d:SelectedSpell);
   if (SelectedSpell == 1) // Minor Healing [Deggaris and Illucia Only]
   {
	if (buttons & BT_ZOOM)
	{
     CurrentMana -= G1;
     MiscellaneousVars[243] = CurrentMana;
     MiscellaneousVars[238] = CurrentMana;
     ACS_NamedExecuteAlways("MagicEffects",0,0,-3,0);
	}
	else
	{
     I2 = GetActorProperty(Player1TID,APROP_HEALTH);
     if (I2 < MaxHealthTrue)
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
     }
	}
   }
   else if (SelectedSpell == 14) // Healing [Deggaris and Illucia Only]
   {
	if (buttons & BT_ZOOM)
	{
     CurrentMana -= G1;
     MiscellaneousVars[243] = CurrentMana;
     MiscellaneousVars[238] = CurrentMana;
     ACS_NamedExecuteAlways("MagicEffects",0,0,-2,0);
	}
	else
	{
     I2 = GetActorProperty(Player1TID,APROP_HEALTH);
     if (I2 < MaxHealthTrue)
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
     }
	}
   }
   else if (SelectedSpell == 28)
   {
    if (PowerupTimer[7] > 0)
    {
     if (CheckInventory("Armor") < 2000)
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
     }
    }
    else
    {
     if (CheckInventory("Armor") < 500)
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
     }
    }
   }
   else if (SelectedSpell == 29) // Major Healing [Deggaris and Illucia Only]
   {
	if (buttons & BT_ZOOM)
	{
     CurrentMana -= G1;
     MiscellaneousVars[243] = CurrentMana;
     MiscellaneousVars[238] = CurrentMana;
     ACS_NamedExecuteAlways("MagicEffects",0,0,-1,0);
	}
	else
	{
     I2 = GetActorProperty(Player1TID,APROP_HEALTH);
     if (I2 < MaxHealthLimit)
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
     }
	}
   }
   else if (SelectedSpell == 40) // Diamond Skin [Deggaris and Illucia Only]
   {
    if (CharacterClass == 2) // Flora has "Spreader Aura Lv. 1" in this slot instead of "Diamond Skin"
    {
     if (CheckActorInventory(Player1TID,"SpreaderAura2") > 0) // If Lv. 2 is intact, give it a random (6-8) seconds. :P
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,18,random(6,8),0);
     }
     else // If only Lv. 1 is intact, give it the full 30 seconds. :P
     {
      CurrentMana -= G1;
      MiscellaneousVars[243] = CurrentMana;
      MiscellaneousVars[238] = CurrentMana;
      ACS_NamedExecuteAlways("MagicEffects",0,17,30,0);
     }
    }
    else // Deggaris & Illucia use "Diamond Skin" in this slot.
    {
     if (PowerupTimer[7] > 0)
     {
      if (CheckInventory("Armor") < 5000)
      {
       CurrentMana -= G1;
       MiscellaneousVars[243] = CurrentMana;
       MiscellaneousVars[238] = CurrentMana;
       ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
      }
     }
     else
     {
      if (CheckInventory("Armor") < 1250)
      {
       CurrentMana -= G1;
       MiscellaneousVars[243] = CurrentMana;
       MiscellaneousVars[238] = CurrentMana;
       ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
      }
     }
    }
   }
   else if (SelectedSpell == 10 || SelectedSpell == 24 || SelectedSpell == 39 || SelectedSpell == 48 || SelectedSpell == 54)
   {
    ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
   }
   else // All other spells [Deggaris and Illucia only]
   {
    CurrentMana -= G1;
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
    ACS_NamedExecuteAlways("MagicEffects",0,SpellCastTypes[SelectedSpell],SpellCastStrength[SelectedSpell],0);
   }
  }
 }
}

// {-8-} Spell Effects

// TODO: FIX WHATEVER FREAKIN BUG IS MESSING WITH THIS SCRIPT # >______<
/*
Script 8 (void)
{
 int PX, PY, PZ, PA, PBA, PVA, FWX, FWY, I1, C1, I2, C2, I3, C3, I4, C4; 

 Print(d:PVA); 
}
*/

script "MagicEffects" (int Type, int Strength)
{
 int PX, PY, PZ, PFZ, PA, PBA, PVA, FWX, FWY, I1, C1, I2, C2, I3, C3, I4, C4; 
 int speed, vspeed, angle, fireheight, healheight;
 int fireheight2, healheight2;
 int NovaRotations;
 int spreadangle, spreadpitch, baseangle, basepitch;
 int spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
 int MaxHealthLimit = MaxHealthTrue * 2;

 // TERRAIN FLOOR CHECKS [Check the "floor" definitions in Terrain.txt if you want to add more]
 int inwater = 0;
 int waterfootclip = 10.0;
 if (CheckActorFloorTexture(Player1TID, "FLTWAWA1")) inwater++;
 if (CheckActorFloorTexture(Player1TID, "FLTFLWW1")) inwater++;
 if (CheckActorFloorTexture(Player1TID, "X_005")) inwater++;

 int insludge = 0;
 int sludgefootclip = 10.0;
 if (CheckActorFloorTexture(Player1TID, "FLTSLUD1")) insludge++;

 int inlava = 0;
 int lavafootclip = 10.0;
 if (CheckActorFloorTexture(Player1TID, "FLTLAVA1")) inlava++;
 if (CheckActorFloorTexture(Player1TID, "FLATHUH1")) inlava++;
 if (CheckActorFloorTexture(Player1TID, "X_001")) inlava++;

 int instrifeliquid = 0;
 int strifeliquidfootclip = 12.0;
 if (CheckActorFloorTexture(Player1TID, "F_WATR03")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_WATR02")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_WATR01")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_VWATR3")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_VWATR2")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_VWATR1")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_HWATR3")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_HWATR2")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_HWATR1")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_PWATR3")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_PWATR2")) instrifeliquid++;
 if (CheckActorFloorTexture(Player1TID, "F_PWATR1")) instrifeliquid++;
 
 PX = GetActorX(Player1TID);
 PY = GetActorY(Player1TID);
 PZ = GetActorZ(Player1TID);
 PFZ = GetActorFloorZ(Player1TID);
 PVA = -sin(GetActorPitch(Player1TID)) * 64 >> 16;
 PBA = FixedMul(GetActorAngle(Player1TID),255.0);
 fireheight = GetActorViewHeight(Player1TID) * 39 / 50;
 fireheight2 = fireheight / 65536;
 fireheight = FixedMul(fireheight,1.0);
 healheight = GetActorViewHeight(Player1TID) * 3 / 5;
 healheight2 = healheight / 65536;
 healheight = FixedMul(healheight,1.0);
 // PrintBold(s:"FireHeight: ",d:fireheight); 
 PA = FixedMul(GetActorAngle(Player1TID),360.0);
 PVA = PVA * 3;

 int onfloor = 0;
 if (PZ <= PFZ) onfloor++;
 
 angle = GetActorAngle(Player1TID) >> 8;
 speed = cos(GetActorPitch(Player1TID)) * 64 >> 16;
 vspeed = -sin(GetActorPitch(Player1TID)) * 64 >> 16;
 // SpawnProjectile(1003,"MinorMagicMissile",angle,speed,vspeed,0,0);

 // PrintBold(s:"Angle: ",d:angle,s:" Speed: ",d:speed,s:" VSpeed: ",d:vspeed); 
 // Print(d:PVA); 
 if (GetCVar("dvdsdebug_showplayercoords") > 0)
 {
    PrintBold(s:"PlayerX: ",d:PX,
              s:"\nPlayerY: ",d:PY,
              s:"\nPlayerZ: ",d:PZ,
              s:"\nPlayerFloorZ: ",d:PFZ,
              s:"\nPlayerFireHeight: ",d:fireHeight, s:" [",d:fireheight2,s:"]",
              s:"\nPA: ",d:PA,
              s:"\nPBA: ",d:PBA,
              s:"\nPVA: ",d:PVA,
              s:"\nAngle: ",d:angle,
              s:"\nSpeed: ",d:speed,
              s:"\nVSpeed: ",d:vspeed,
              s:"\nOnFloor: ",d:onfloor,
              s:"\nInWater: ",d:inwater, 
              s:"\nInSludge: ",d:insludge, 
              s:"\nInLava: ",d:inlava, 
              s:"\nInStrifeLiquid: ",d:instrifeliquid); 
 }
 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 if ((PBA >= 0.0) && (PBA <= 64.0))
 {
  FWX = 1.0 - FixedMul(0.015625,PBA);
  FWY = 0.0 + FixedMul(0.015625,PBA);
 }
 if ((PBA > 64.0) && (PBA <= 128.0))
 {
  FWX = 0.0 - FixedMul(0.015625,PBA - 64.0);
  FWY = 1.0 - FixedMul(0.015625,PBA - 64.0);
 }
 if ((PBA > 128.0) && (PBA <= 192.0))
 {
  FWX = -1.0 + FixedMul(0.015625,PBA - 128.0);
  FWY = 0.0 - FixedMul(0.015625,PBA - 128.0);
 }
 if ((PBA > 192.0) && (PBA <= 255.0))
 {
  FWX = 0.0 + FixedMul(0.015625,PBA - 192.0);
  FWY = -1.0 + FixedMul(0.015625,PBA - 192.0);
 }
 
 FWX = FixedMul(FWX,32.0);
 FWY = FixedMul(FWY,32.0);

 int project_X = GetActorX(0);
 int project_Y = GetActorY(0);
 int project_Z = GetActorZ(0);
 int project_Pitch = GetActorPitch(0);
 int project_PitchSpread;
 int project_Angle = GetActorAngle(0);
 int project_AngleSpread;
 int project_XSpeed = FixedMul(cos(project_Angle), FixedMul(cos(project_Pitch), 16.0));
 int project_YSpeed = FixedMul(sin(project_Angle), FixedMul(cos(project_Pitch), 16.0));
 int project_ZSpeed = -FixedMul(sin(project_Pitch), 16.0);
 int project_XSpeedSpread;
 int project_YSpeedSpread;
 int project_ZSpeedSpread;
 int project_FireHeight = GetActorViewHeight(0) * 39 / 50;
 int project_Offset = 8.0;
 str spellname;
 str spellname2;
 str spellname3;
 str spellname4;
 
/*
 if (onfloor > 0)
 {
  if (inwater > 0) project_Offset += waterfootclip;
  if (insludge > 0) project_Offset += sludgefootclip;
  if (inlava > 0) project_Offset += lavafootclip;
  if (instrifeliquid > 0) project_Offset += strifeliquidfootclip;
 }
*/

 int project_RealZ = project_Z + project_FireHeight + project_Offset;
 
 if (GetCVar("dvdsdebug_showspellpos") > 0)
 {
    PrintBold(s:"Projectile X: ",d:project_X,
              s:"\nProjectile Y: ",d:project_Y,
              s:"\nProjectile Z: ",d:project_Z,
              s:"\nFireHeight: ",d:project_FireHeight,
              s:"\nOffset: ",d:project_Offset,
              s:"\nProjectile REAL Z: ",d:project_RealZ,
              s:"\nPitch: ",d:project_Pitch,
              s:"\nAngle: ",d:project_Angle,
              s:"\nXSpeed: ",d:project_XSpeed,
              s:"\nYSpeed: ",d:project_YSpeed,
              s:"\nZSpeed: ",d:project_ZSpeed); 
 }
			  
 if (Type == 0) // Straight Ahead Fireball Shooter
 {
  Switch(Strength)
  {
   Case -3:  // Healing Shots
   {
    spellname = "Heal1Shot";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 32.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4443);

    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);
     }
	}

    Break;
   }
   Case -2:  // Healing Shots
   {
    spellname = "Heal2Shot";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 32.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4443);

    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);
	 }
	}

    Break;
   }
   Case -1:  // Healing Shots
   {
    spellname = "Heal3Shot";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 32.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4443);


    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4443);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4443);
	 }
	}

    Break;
   }

   Case 0:  // Minor Magic Missile
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MinorMagicMissileSeek"; } else { spellname = "MinorMagicMissile"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 1:  // Chill Touch
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "ChillTouch";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 2:  // Minor Fireball
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MinorFireBallSeek"; } else { spellname = "MinorFireBall"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 3:  // Minor Ice Blast
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MinorHexenIceShardSeek"; } else { spellname = "MinorHexenIceShard"; }
    // Low Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Middle Row [3]
    baseangle = 182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    // High Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 4:  // Magic Missile
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MagicMissileSeek"; } else { spellname = "MagicMissile"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 5:  // Fireball
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "NormalFireBallSeek"; } else { spellname = "NormalFireBall"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 6:  // Exploding Glyph
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    SpawnProjectile(0, "ExplodingGlyphBase", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeed, project_YSpeed, project_ZSpeed, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);

    Break;
   }
   Case 7:  // Acid Rain
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "AcidRain";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 8:  // Freezing Glyph
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    SpawnProjectile(0, "FreezingGlyphBase", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeed, project_YSpeed, project_ZSpeed, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);

    Break;
   }
   Case 9:  // Major Magic Missile
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MajorMagicMissileSeek"; } else { spellname = "MajorMagicMissile"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 10:  // Minor Lightning
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 11:  // Ice Blast
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "HexenIceShardSeek"; } else { spellname = "HexenIceShard"; }
    // Lowest Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = 364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    // Lower Row [3]
    baseangle = 182; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    // Middle Row [5]
    baseangle = 364; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -364; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle-364), FixedMul(cos(project_Pitch+0), 16.0));
    project_YSpeedSpread = FixedMul(sin(project_Angle-364), FixedMul(cos(project_Pitch+0), 16.0));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+0), 16.0);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Higher Row [3]
    baseangle = 182; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    // Highest Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = -364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 12:  // Lightning
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 728; // 364		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -728; // -364 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 13:  // Major Fireball
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MajorFireBallSeek"; } else { spellname = "MajorFireBall"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 14:  // Major Ice Blast
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "MajorHexenIceShardSeek"; } else { spellname = "MajorHexenIceShard"; }
    // Lowest Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = -546;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
	spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Lower Row [3]
    baseangle = 182; 		// 0 degree angle
    basepitch = -364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = -364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = -364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    // Low Row [5]
    baseangle = 364; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 182; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -364; 		// 0 degree angle
    basepitch = -182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Middle [7]
    baseangle = 546; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 364; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -364; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -546; 		// 0 degree angle
    basepitch = 0;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // High Row [5]
    baseangle = 364; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 182; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -364; 		// 0 degree angle
    basepitch = 182;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Higher Row [3]
    baseangle = 182; 		// 0 degree angle
    basepitch = 364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 0; 		// 0 degree angle
    basepitch = 364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -182; 		// 0 degree angle
    basepitch = 364;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    // Highest Row [1]
    baseangle = 0; 		// 0 degree angle
    basepitch = 546;	// -15 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }


    Break;
   }
   Case 15:  // Major Lightning
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;	// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 728; // 364 		// 0 degree angle
    basepitch = 0;	// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = 1456; // 728 		// 0 degree angle
    basepitch = 0;	// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -1456; //-728 		// 0 degree angle
    basepitch = 0;	// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    baseangle = -728; //-364 		// 0 degree angle
    basepitch = 0;	// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
    SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
     SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, "HexenLightningC", 0, 0, 0, 0, 2001);
      SpawnProjectile(0, "HexenLightningF", 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
   Case 16:  // Raging Spirits
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    SpawnProjectile(Player1TID,"RagingSpiritBase", (PBA >> 16), 100, PVA, 0, 2002);
    SpawnProjectile(Player1TID,"RagingSpiritBase", (PBA >> 16), 100, PVA, 0, 2003);
    SpawnProjectile(Player1TID,"RagingSpiritBase", (PBA >> 16), 100, PVA, 0, 2004);  
    SpawnProjectile(Player1TID,"RagingSpiritBase", (PBA >> 16), 100, PVA, 0, 2005);  
    SpawnProjectile(Player1TID,"RagingSpiritBase", (PBA >> 16), 100, PVA, 0, 2006);  
    SetActorPosition(2002,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + fireheight,0);
    SetActorPosition(2003,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + fireheight,0);
    SetActorPosition(2004,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + fireheight,0);
    SetActorPosition(2005,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + fireheight,0);
    SetActorPosition(2006,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + fireheight,0);
    Break;
   }
   Case 17:  // Ultra Magic Missile
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    if (buttons & BT_ZOOM) { spellname = "UltraMagicMissileSeek"; } else { spellname = "UltraMagicMissile"; }
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    Break;
   }
  }
  Thing_Remove(1002);
 }
 if (Type == 1) // Healing
 {
  int StamHealMin;
  int StamHealMax;
  int StamHealCap;
  if (Strength < 10) // Not the Major Healing Spell [Deggaris and Illucia Only]
  {
   if (Strength < 3) // Minor Healing Spell [Deggaris and Illucia Only]
   {
    C1 = MaxHealthTrue;
    C2 = random(GetHealingValue(0,0),GetHealingValue(0,1));

    StamHealCap = ((MiscellaneousVars[22] * 10250) / 10000);
    StamHealMin = ((MiscellaneousVars[22] * 36) / 10000);
    StamHealMax = ((MiscellaneousVars[22] * 66) / 10000);

    FadeRange(63,63,63,0.8,255,255,255,0.0,1.0);
    if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
    else ActivatorSound("HealSpell1",127); 
    if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
    SpawnProjectile(0, "Heal1Spark", 0, 0, 0, 0, 2001);
   }
   else // Healing Spell [Deggaris and Illucia Only]
   {
    C1 = MaxHealthTrue;
    C2 = random(GetHealingValue(1,0),GetHealingValue(1,1));

    StamHealCap = ((MiscellaneousVars[22] * 11250) / 10000);
    StamHealMin = ((MiscellaneousVars[22] * 180) / 10000);
    StamHealMax = ((MiscellaneousVars[22] * 330) / 10000);

    FadeRange(127,127,127,0.8,255,255,255,0.0,1.0);
    if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
    else ActivatorSound("HealSpell1",127); 
    if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantMidHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
    SpawnProjectile(0, "Heal2Spark", 0, 0, 0, 0, 2001);
   }
  }
  else // Major Healing Spell [Deggaris and Illucia Only]
  {
   C1 = MaxHealthLimit;
   C2 = random(GetHealingValue(2,0),GetHealingValue(2,1));

   StamHealCap = ((MiscellaneousVars[22] * 15000) / 10000);
   StamHealMin = ((MiscellaneousVars[22] * 450) / 10000);
   StamHealMax = ((MiscellaneousVars[22] * 825) / 10000);

   FadeRange(193,193,193,0.8,255,255,255,0.0,1.0);
   if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
   else ActivatorSound("HealSpell1",127); 
   if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantMoreHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
   SpawnProjectile(0, "Heal3Spark", 0, 0, 0, 0, 2001);
  }
  SetActorVelocity(2001, 0, 0, 0, 0, 0);
  SetActorAngle(2001, 0);
  SetActorPosition(2001,GetActorX(Player1TID),GetActorY(Player1TID), GetActorZ(Player1TID) + healheight,0);
  Thing_ChangeTID(2001,4444);

  if (CheckInventory("SpreaderAura2") > 0)
  {
   C2 *= 7;
   StamHealMin *= 7;
   StamHealMax *= 7;
  }
  else
  {
   if (CheckInventory("SpreaderAura1") > 0)
   {
    C2 *= 3;
    StamHealMin *= 3;
    StamHealMax *= 3;
   }
  }

  StamHealMin = StamHealMin * (10 + (PlayerLevel / 25)) / 10;
  StamHealMax = StamHealMax * (10 + (PlayerLevel / 25)) / 10;

  // Check Sauron Equipment
  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0)
  {
   StamHealMin = StamHealMin * 9 / 8; // 1.125x
   StamHealMax = StamHealMax * 9 / 8; // 1.125x
  }
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
  {
   StamHealMin = StamHealMin * 5 / 2; // 2.5x
   StamHealMax = StamHealMax * 5 / 2; // 2.5x
  }

  // Divine Avatar
  if (PowerupTimer[7] > 0)
  {
   StamHealMin *= 4;
   StamHealMax *= 4;
  }
  // ???
  if (PowerupTimer[129] > 0)
  {
   StamHealMin *= 10;
   StamHealMax *= 10;
  }
  // Tension
  if (MiscellaneousVars[181] == 1)
  {
   StamHealMin = StamHealMin * 17 / 10; // 1.7x
   StamHealMax = StamHealMax * 17 / 10; // 1.7x
  }
  if (MiscellaneousVars[181] == 2)
  {
   StamHealMin = StamHealMin * 3; // 3x
   StamHealMax = StamHealMax * 3; // 3x
  }
  if (MiscellaneousVars[181] == 3)
  {
   StamHealMin = StamHealMin * 5; // 5x
   StamHealMax = StamHealMax * 5; // 5x
  }
  if (MiscellaneousVars[181] == 4)
  {
   StamHealMin = StamHealMin * 15 / 2; // 7.5x
   StamHealMax = StamHealMax * 15 / 2; // 7.5x
  }
  if (MiscellaneousVars[181] == 5)
  {
   StamHealMin = StamHealMin * 45 / 4; // 11.25x
   StamHealMax = StamHealMax * 45 / 4; // 11.25x
  }
  if (MiscellaneousVars[181] == 6)
  {
   StamHealMin = StamHealMin * 35 / 2; // 17.5x
   StamHealMax = StamHealMax * 35 / 2; // 17.5x
  }
  if (MiscellaneousVars[181] == 7)
  {
   StamHealMin = StamHealMin * 25; // 25x
   StamHealMax = StamHealMax * 25; // 25x
  }

  // Deggaris in use
  if (CharacterClass == 0)
  {
   StamHealMin = StamHealMin * 7 / 4; // 1.75x
   StamHealMax = StamHealMax * 7 / 4; // 1.75x
  }
  // Illucia in use
  if (CharacterClass == 1)
  {
   StamHealMin = StamHealMin * 5 / 4; // 1.25x
   StamHealMax = StamHealMax * 5 / 4; // 1.25x
  }
  // Flora in use
  if (CharacterClass == 2)
  {
   StamHealMin = StamHealMin * 7 / 8; // 0.875x
   StamHealMax = StamHealMax * 7 / 8; // 0.875x
  }
  // Ailish in use
  if (CharacterClass == 8)
  {
   StamHealMin = StamHealMin * 6 / 8; // 0.75x
   StamHealMax = StamHealMax * 6 / 8; // 0.75x
  }
  // Petra in use
  if (CharacterClass == 9)
  {
   StamHealMin = StamHealMin * 8 / 4; // 2x
   StamHealMax = StamHealMax * 8 / 4; // 2x
  }
  
  int healingcap;  
  int oldhealthvalue;
  int finalhealvalue;
  oldhealthvalue = GetActorProperty(Player1TID,APROP_HEALTH);
  healingcap = C1;
  finalhealvalue = oldhealthvalue + C2;
  if (oldhealthvalue < healingcap)
  {
   ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
   if (finalhealvalue < 1) finalhealvalue = 1; // Prevents the gaming from killing you when trying to heal >__>;
   if (finalhealvalue > healingcap) finalhealvalue = healingcap;
   SetActorProperty(Player1TID,APROP_HEALTH,finalhealvalue);
  }

  if (MiscellaneousVars[21] < StamHealCap)
  {
   //ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
   MiscellaneousVars[21] += random(StamHealMin,StamHealMax);
   if (MiscellaneousVars[21] < 0) MiscellaneousVars[21] = 0;
   if (MiscellaneousVars[21] > StamHealCap) MiscellaneousVars[21] = StamHealCap;
  }
 }

 if (Type == 2) // Light
 {
  ActivatorSound("CastLightRoom",127);
  PowerupTimer[0] += (Strength*35);
  if (PowerupTimer[0] > 0) GiveActorInventory(Player1TID,"NightVisionSpell",1);
 }
 if (Type == 3) // Invisibility
 {
  ActivatorSound("CastInvisiblity",127);
  PowerupTimer[1] += (Strength*35);
  if (PowerupTimer[1] > 0) GiveActorInventory(Player1TID,"InvisiblitySpell",1);
 }
 if (Type == 4) // Flight
 {
  ActivatorSound("CastFlight",127);
  PowerupTimer[2] += (Strength*35);
  if (PowerupTimer[2] > 0) GiveActorInventory(Player1TID,"FlightSpell",1);
 }
 if (Type == 5) // Berserk
 {
  ActivatorSound("CastBerserk",127);
  PowerupTimer[23] += (Strength*35);
  if (PowerupTimer[23] > 0) GiveActorInventory(Player1TID, "PowerStrength", 1);

 }
 if (Type == 6) // Summon Monster
 {
  C1 = 0;
  if (random(1,100) < 25) C1 = 1;
  if (Strength == 0) // Weak Monster
  {
   SpawnForced(FriendIDDoom[random(0,17)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1002,PA >> 16);
   if (ThingCount(0,1002) > 0)
   {
    ActivatorSound("monstersummon",127);
    if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
    Thing_ChangeTID(1002,1000);
    CurrentMana -= MiscellaneousVars[555];
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
	PrintBold(s:"Successful Summon!");
    if (C1 == 1)
    {
     SpawnForced(FriendIDDoom[random(0,17)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1003,PA >> 16);
	 if (ThingCount(0,1003) > 0)
	 {
      ActivatorSound("monstersummon",127);
      if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
      Thing_ChangeTID(1003,1000);
 	  terminate;
  	 }
    }
   }
   else
   {
    ActivatorSound("inv_fail",127);
    PrintBold(s:"Summon Failed!");
   }
  }

  if (Strength == 1) // Moderate Monster
  {
   SpawnForced(FriendIDDoom[random(18,29)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1002,PA >> 16);
   if (ThingCount(0,1002) > 0)
   {
    ActivatorSound("monstersummon",127);
    if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
    Thing_ChangeTID(1002,1000);
    CurrentMana -= MiscellaneousVars[555];
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
	PrintBold(s:"Successful Summon!");
    if (C1 == 1)
    {
     SpawnForced(FriendIDDoom[random(18,29)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1003,PA >> 16);
 	 if (ThingCount(0,1003) > 0)
	 {
      ActivatorSound("monstersummon",127);
      if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
      Thing_ChangeTID(1003,1000);
 	  terminate;
  	 }
    }
   }
   else
   {
    ActivatorSound("inv_fail",127);
    PrintBold(s:"Summon Failed!");
   }
  }

  if (Strength == 2) // Strong Monster
  {
   SpawnForced(FriendIDDoom[random(30,48)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1002,PA >> 16);
   if (ThingCount(0,1002) > 0)
   {
    ActivatorSound("monstersummon",127);
    if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
    Thing_ChangeTID(1002,1000);
    CurrentMana -= MiscellaneousVars[555];
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
	PrintBold(s:"Successful Summon!");
    if (C1 == 1)
    {
     SpawnForced(FriendIDDoom[random(30,48)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1003,PA >> 16);
	 if (ThingCount(0,1003) > 0)
	 {
      ActivatorSound("monstersummon",127);
      if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
      Thing_ChangeTID(1003,1000);
 	  terminate;
  	 }
    }
   }
   else
   {
    ActivatorSound("inv_fail",127);
    PrintBold(s:"Summon Failed!");
   }
  }

  if (Strength == 3) // ArchVile/Diabloist
  {
   SpawnForced(FriendIDDoom[random(49,50)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1002,PA >> 16);
   if (ThingCount(0,1002) > 0)
   {
    ActivatorSound("monstersummon",127);
    if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
    Thing_ChangeTID(1002,1000);
    CurrentMana -= MiscellaneousVars[555];
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
	PrintBold(s:"Successful Summon!");
   }
   else
   {
    ActivatorSound("inv_fail",127);
    PrintBold(s:"Summon Failed!");
   }
  }

  if (Strength == 4) // Cyberdemon/Annihilator
  {
   SpawnForced(FriendIDDoom[random(51,52)],PX + (Random(-8,8) << 16),PY + (Random(-8,8) << 16),PZ + (Random(0,4) << 16),1002,PA >> 16);
   if (ThingCount(0,1002) > 0)
   {
    ActivatorSound("monstersummon",127);
    if (CharacterClass == 2 && random(1,5) == 1) PlaySound(Player1TID,"FloraSummon",CHAN_VOICE,1.0,0,ATTN_NORM);
    Thing_ChangeTID(1002,1000);
    CurrentMana -= MiscellaneousVars[555];
    MiscellaneousVars[243] = CurrentMana;
    MiscellaneousVars[238] = CurrentMana;
	PrintBold(s:"Successful Summon!");
   }
   else
   {
    ActivatorSound("inv_fail",127);
    PrintBold(s:"Summon Failed!");
   }
  }
 }
 if (Type == 7) // Novas
 {
  if (Strength == 0) // Fireball Nova
  {
   for (NovaRotations = 0; NovaRotations < 32; NovaRotations++)
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "NormalFireBall";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

   }
  }
  if (Strength == 1) // Ice Nova
  {
   for (NovaRotations = 0; NovaRotations < 32; NovaRotations++)
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "HexenIceShard";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

   }
  }
  if (Strength == 2) // Lightning Nova
  {
   for (NovaRotations = 0; NovaRotations < 32; NovaRotations++)
   {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "HexenLightningF";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

    spellname = "HexenLightningC";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle - (2048 + (NovaRotations * 2048))), FixedMul(cos(project_Pitch+basepitch+spreadpitch), 16.0));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle - (2048 + (NovaRotations * 2048)));
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }

   }
  }
 }
 if (Type == 8) // Stealth
 {
  ActivatorSound("CastStealth",127);
  PowerupTimer[3] += (Strength*35);
  if (PowerupTimer[3] > 0) SetPlayerProperty(1,1,PROP_NOTARGET);
 }
 if (Type == 9) // Invulnerability
 {
  ActivatorSound("CastInvuln",127);
  PowerupTimer[4] += (Strength*35);
  if (PowerupTimer[4] > 0) GiveActorInventory(Player1TID, "InvulnerabilitySpell", 1); // SetPlayerProperty(1,1,PROP_INVULNERABILITY);
 }
 if (Type == 10) // Poison Clouds
 {
  SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1002,PBA);
  if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
  {
   SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1004,PBA);
   SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1006,PBA);
   if (CheckInventory("SpreaderAura2") > 0)
   {
    SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1008,PBA);
    SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1010,PBA);
    SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1012,PBA);
    SpawnForced("MapSpot",PX+FWX,PY+FWY,PZ+32.0,1014,PBA);
   }
  }
  if (ThingCount(0,1002) < 1 && ThingCount(0,1004) < 1 && ThingCount(0,1006) < 1 && ThingCount(0,1008) < 1 && ThingCount(0,1010) < 1 && ThingCount(0,1012) < 1 && ThingCount(0,1014) < 1) // failed... try again
  {
   ACS_NamedExecuteAlways("MagicEffects",0,Type,Strength,0);
  }
  if (Strength == 0)
  {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "MinorPoisonCloud";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }
  }

  if (Strength == 1)
  {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "NormalPoisonCloud";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }
  }
  if (Strength == 2)
  {
    ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
    spellname = "MajorPoisonCloud";
    baseangle = 0; 		// 0 degree angle
    basepitch = 0;		// 0 degree pitch
    spreadangle = 0;	// 0 degree angle
    spreadpitch = 0;	// 0 degree pitch
    spelllaunchspdmulti = 16.0; // Basically determines the final speed of the projectile [usually 16.0]
    project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
    project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
    SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
    SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
    SetActorAngle(2001, project_Angle);
    SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
    Thing_ChangeTID(2001,4444);
    if (CheckInventory("SpreaderAura2") > 0 || CheckInventory("SpreaderAura1") > 0)
    {
     spreadangle = 2730;	// 15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     spreadangle = -2730;	// -15 degree angle
     spreadpitch = 0;	// 0 degree pitch
     project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
     project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
     SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
     SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
     SetActorAngle(2001, project_Angle);
     SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
     Thing_ChangeTID(2001,4444);

     if (CheckInventory("SpreaderAura2") > 0)
     {
      spreadangle = 1365; // 7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = 1365; // 7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = -1365; // -7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);

      spreadangle = -1365; // -7.5d angle
      spreadpitch = 1365; // 7.5d pitch
      project_XSpeedSpread = FixedMul(cos(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_YSpeedSpread = FixedMul(sin(project_Angle+baseangle+spreadangle), FixedMul(cos(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti));
      project_ZSpeedSpread = -FixedMul(sin(project_Pitch+basepitch+spreadpitch), spelllaunchspdmulti);
      SpawnProjectile(0, spellname, 0, 0, 0, 0, 2001);
      SetActorVelocity(2001, project_XSpeedSpread, project_YSpeedSpread, project_ZSpeedSpread, 0, 0);
      SetActorAngle(2001, project_Angle);
      SetActorPosition(2001, project_X, project_Y, project_RealZ, 0);
      Thing_ChangeTID(2001,4444);
     }
    }
  }
 }
 if (Type == 11) // Armor
 {
  if (Strength == 0) // Stone Skin [Deggaris/Illucia Only]
  {
   if (PowerupTimer[7] > 0)
   {
    if (CheckInventory("Armor") < 2000)
    {
     if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) GiveActorInventory(Player1TID, "StoneSkinGA", 1); else GiveActorInventory(Player1TID, "MaxHealthBonusREAL", 4);
    }
   }
   else
   {
    if (CheckInventory("Armor") < 500)
    {
     if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) GiveActorInventory(Player1TID, "StoneSkin", 1); else GiveActorInventory(Player1TID, "MaxHealthBonusREAL", 1);
    }
   }
  }
  else if (Strength == 1) // Diamond Skin [Deggaris/Illucia Only]
  {
   if (PowerupTimer[7] > 0)
   {
    if (CheckInventory("Armor") < 5000)
    {
     if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) GiveActorInventory(Player1TID, "DiamondSkinGA", 1); else GiveActorInventory(Player1TID, "MaxHealthBonusREAL", 4);
    }
   }
   else
   {
    if (CheckInventory("Armor") < 1250)
    {
     if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) GiveActorInventory(Player1TID, "DiamondSkin", 1); else GiveActorInventory(Player1TID, "MaxHealthBonusREAL", 1);
    }
   }
  }

/*
  else if (Strength == 2) // Spiritual Exoskin [Flora Only] [50% Protection, Max AP equal to 100% of Flora's Max HP]
  {
   C1 = MaxHealthTrue;
   if (CheckInventory("Armor") < C1)
   {
   }
  }
  else if (Strength == 3) // Greater Spiritual Exoskin [Flora Only] [75% Protection, Max AP equal to 200% of Flora's Max HP]
  {
   C1 = MaxHealthLimit;
   if (CheckInventory("Armor") < C1)
   {
   }
  }
  else if (Strength == 4) // Perfected Spiritual Exoskin [Flora Only] [100% Protection, Max AP equal to 400% of Flora's Max HP]
  {
   C1 = MaxHealthLimit;
   C1 = C1 * 2;
   if (CheckInventory("Armor") < C1)
   {
   }
  }
*/

 }

 if (Type == 12) // Computer Map
 {
  ActivatorSound("CastFarsight",127);
  GiveActorInventory(Player1TID, "Allmap", 1);
  GiveActorInventory(Player1TID, "FarsightScanner", 1);
 }
 if (Type == 13) // Freeze Time
 {
  ActivatorSound("CastTimeFreeze",127);
  PowerupTimer[5] += (Strength*35);
  if (PowerupTimer[5] > 0) GiveActorInventory(Player1TID, "AetheriusTimeFreezer", 1);
 }
 if (Type == 14) // Terrorization Aura
 {
  ActivatorSound("CastTerrorAura",127);
  PowerupTimer[6] += (Strength*35);
  if (PowerupTimer[6] > 0) GiveActorInventory(Player1TID, "PowerFrightener", 1);
 }
 if (Type == 15) // Ammo Spawner
 {
  SpawnForced("ClipBoxNew",PX+20,PY+20,PZ+10.0,0,0);
  SpawnForced("ShellBoxNew",PX-20,PY+20,PZ+10.0,0,0);
  SpawnForced("RocketBoxNew",PX+10,PY+10,PZ+10.0,0,0);
  SpawnForced("CellPackNew",PX-10,PY+10,PZ+10.0,0,0);

  if (random(0,800) < 100)
  {
   SpawnForced("ClipBoxNew",PX+20,PY-20,PZ+10.0,0,0);
   SpawnForced("ShellBoxNew",PX-20,PY-20,PZ+10.0,0,0);
   SpawnForced("RocketBoxNew",PX+10,PY-10,PZ+10.0,0,0);
   SpawnForced("CellPackNew",PX-10,PY-10,PZ+10.0,0,0);
  }
  if (random(0,800) < 25)
  {
   SpawnForced("ClipBoxNew",PX+20,PY+20,PZ+10.0,0,0);
   SpawnForced("ShellBoxNew",PX-20,PY+20,PZ+10.0,0,0);
   SpawnForced("RocketBoxNew",PX+10,PY+10,PZ+10.0,0,0);
   SpawnForced("CellPackNew",PX-10,PY+10,PZ+10.0,0,0);

   SpawnForced("ClipBoxNew",PX+20,PY-20,PZ+10.0,0,0);
   SpawnForced("ShellBoxNew",PX-20,PY-20,PZ+10.0,0,0);
   SpawnForced("RocketBoxNew",PX+10,PY-10,PZ+10.0,0,0);
   SpawnForced("CellPackNew",PX-10,PY-10,PZ+10.0,0,0);
  }
 }
 if (Type == 16) // Divine Avatar
 {
  ActivatorSound("CastDivineAvatar",127);
  if (CharacterClass == 2 && random(1,16) == 4) PlaySound(Player1TID,"FloraChantDivineAvatar",CHAN_VOICE,1.0,0,ATTN_NORM);
  PowerupTimer[7] += (Strength*35);
  if (PowerupTimer[7] > 0)
  {
   GiveActorInventory(Player1TID, "DivineAvatarDamage", 1);
   GiveActorInventory(Player1TID, "DivineAvatarDefense", 1);
   GiveActorInventory(Player1TID, "PowerDoubleFiringSpeed", 1);
   GiveActorInventory(Player1TID, "DivineAvatarHighJump", 1);
  }
 }
 if (Type == 17) // Spreader Aura Lv. 1
 {
  ActivatorSound("CastSpreaderAura1",127);
  PowerupTimer[8] += (Strength*35);
 }
 if (Type == 18) // Spreader Aura Lv. 2
 {
  ActivatorSound("CastSpreaderAura1",127);
  ActivatorSound("CastSpreaderAura2",127);
  PowerupTimer[9] += (Strength*35);
 }
 if (Type == 19) // Oomph
 {
  //ActivatorSound("CastSpreaderAura2",127);
  PowerupTimer[10] += (Strength*35);
 }
 if (Type == 20) // Buff
 {
  //ActivatorSound("CastSpreaderAura2",127);
  PowerupTimer[11] += (Strength*35);
 }
 if (Type == 21) // Accelerate
 {
  //ActivatorSound("CastSpreaderAura2",127);
  PowerupTimer[12] += (Strength*35);
 }
 if (Type == 22) // Desperado Damsel
 {
  PowerUpTimer[13] += (Strength*35);
  if (PowerupTimer[13] > 0)
  {
   GiveActorInventory(Player1TID, "PowerHitscanBoost", 1);
   GiveActorInventory(Player1TID, "PowerChristinaBoost", 1);
   GiveActorInventory(Player1TID, "PowerAccuracyBoost", 1);
  }
 }
}

script "CreateTranslationTables" OPEN
{
 CreateTranslation(1, 16:47=112:127); // Demon
 CreateTranslation(2, 64:79=112:127, 61:63=112:114); // Imp
 CreateTranslation(3, 128:151=112:127, 77:79=125:127, 1:2=126:127); // Pistol
 CreateTranslation(4, 96:111=112:125, 5:8=126:127); // Shotgun
 CreateTranslation(5, 31:47=112:127); // Chaingunner
 CreateTranslation(6, 32:47=117:127, 160:167=112:127, 213:223=112:127, 232:235=122:125, 175:191=112:127); // Lost Soul
 CreateTranslation(7, 16:47=112:127, 165:167=123:125, 169:191=112:127, 73:79=121:127); // Caco
 CreateTranslation(8, 193:207=112:127, 5:8=124:127, 104:111=120:127); // Arach
 CreateTranslation(9, 64:79=112:127, 149:151=123:125); // HK
 CreateTranslation(10, 55:79=112:127); // Baron
 CreateTranslation(11, 80:111=112:127); // Revenant
 CreateTranslation(12, 51:79=112:127, 236:239=124:127, 13:15=121:123, 1:2=126:127, 128:151=112:127); // Manc
 CreateTranslation(13, 192:207=112:122, 240:247=123:127); // Nazi
 CreateTranslation(14, 48:79=112:127, 13:15=120:122, 208:213=112:117, 128:151=112:127); // Arch-Vile
 CreateTranslation(15, 64:79=112:127, 48:63=127:112, 144:151=112:127); // Cyberdemon
 CreateTranslation(16, 64:79=88:103, 48:63=103:88, 144:151=88:103, 32:47=224:231, 168:191=224:231, 224:231=[255, 255, 255]:[128, 255, 128], 208:223=112:127); // Cyberdemon?

 CreateTranslation(17, 112:127=48:63); // No Armor
 CreateTranslation(18, 112:127=112:127); // Green Armor
 CreateTranslation(19, 112:127=240:246); // Blue Armor
 CreateTranslation(20, 112:127=96:111); // Stone Skin
 CreateTranslation(21, 112:127=88:103); // Diamond Skin

 CreateTranslation(22, 112:127=196:207); // Blue Armor (Armor Bonus)

 CreateTranslation(30, 80:111=112:127); // For Healing on the Damage Indicator
 CreateTranslation(31, 80:111=16:31); // For Damage on the Damage Indicator [normal]
 CreateTranslation(32, 80:111=32:47); // For Damage on the Damage Indicator [CRITICAL]

 // Doom/Doom2 [heal/damage]
 CreateTranslation(33, 80:111=112:127); // For Healing on the Damage Indicator [NEW DQH NUMBERS]
 CreateTranslation(34, 80:111=208:223); // For Damage on the Damage Indicator [normal] [NEW DQH NUMBERS]
 CreateTranslation(35, 80:111=216:223); // For Damage on the Damage Indicator [CRITICAL] [NEW DQH NUMBERS]

 // Heretic [heal/damage]
 CreateTranslation(36, 0:31=209:221); // For Healing on the Damage Indicator [NEW DQH NUMBERS]
 CreateTranslation(37, 0:31=137:144); // For Damage on the Damage Indicator [normal] [NEW DQH NUMBERS]
 CreateTranslation(38, 0:31=137:140); // For Damage on the Damage Indicator [CRITICAL] [NEW DQH NUMBERS]

 // Hexen [heal/damage]
 CreateTranslation(39, 33:50=112:127); // For Healing on the Damage Indicator [NEW DQH NUMBERS]
 CreateTranslation(40, 33:50=203:210); // For Damage on the Damage Indicator [normal] [NEW DQH NUMBERS]
 CreateTranslation(41, 33:50=203:206); // For Damage on the Damage Indicator [CRITICAL] [NEW DQH NUMBERS]

 // Strife [heal/damage]
 CreateTranslation(42, 1:31=112:127); // For Healing on the Damage Indicator [NEW DQH NUMBERS]
 CreateTranslation(43, 1:31=224:231); // For Damage on the Damage Indicator [normal] [NEW DQH NUMBERS]
 CreateTranslation(44, 1:31=228:231); // For Damage on the Damage Indicator [CRITICAL] [NEW DQH NUMBERS]

 
}

// Mana Recovery Items
script "CheckManaLevels" (int overmana)
{
 int C1, I1, C2, I2, G1, G2, G3, G4;
 int MaxManaLimit = MaxMana * 2;

 int result = 0;
 if (overmana == 0 && CurrentMana < MaxMana) result = 1;
 if (overmana == 1 && CurrentMana < MaxManaLimit) result = 1;
 SetResultValue(result);
}

// ManaCube Pickup script
script "PickupManaCube" (int type, int overmana)
{
 int I1, I2, Z1, Z2, C1, C2;
 int GiveManaAmount;
 int MaxManaDouble = MaxMana * 2;
 if (type == 1) // Small
 {
  GiveManaAmount = 50;
 }
 else
 if (type == 2) // Mediym
 {
  GiveManaAmount = 125;
 }
 else
 if (type == 3) // Large
 {
  GiveManaAmount = 350;
 }

 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) GiveManaAmount = GiveManaAmount * 9 / 8; // Sauron Helmet = 112.5%
 if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0) GiveManaAmount = GiveManaAmount * 5 / 4; // Sauron Gauntlets = 125%
 if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) GiveManaAmount = GiveManaAmount * 5 / 4; // Sauron Gauntlets = 125%
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) GiveManaAmount = GiveManaAmount * 5 / 4; // Sauron Gauntlets = 125%
 if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) GiveManaAmount = GiveManaAmount * 5 / 4; // Sauron Gauntlets = 125%
 if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) GiveManaAmount = GiveManaAmount * 5 / 4; // Sauron Gauntlets = 125%
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
 {  
  if (CharacterClass == 2) GiveManaAmount = GiveManaAmount * 5 / 4;	// The One Ring [Flora] = 125%
                      else GiveManaAmount = GiveManaAmount / 2;		// The One Ring [Marines] = 50%
 }

 GiveManaAmount = GiveManaAmount * GetCVar("dvds_manaitemmultiplier") / 100;

 CurrentMana += GiveManaAmount;
 if (overmana == 0 && CurrentMana > MaxMana) CurrentMana = MaxMana;
 if (overmana == 1 && MaxManaDouble > MaxMana) CurrentMana = MaxManaDouble;
}


// Defines the Buildup to Sauravatar's appearance [DVI-DS]
script "DVI-MainEyeDeath2" (void)
{
 int C1, C2, C3, C4;
 if (ModType != 0) // Deus Vult 1 or DVII
 {
  Delay(35);
  SetMusic("STAGE6D", 0); 
  AmbientSound("SauronAwakens",127);
  // 18.25 * 35 = 637
  Delay(637);
  ACS_NamedExecute("DVI-AwakenSauravatar",0,0,0,0);
  Delay(1);
 }
 else
 {
  Delay(21);
  Exit_Normal(0);
  Delay(1);
 }
}

// Awakens the Stone Cyberdemon that becomes the Greater Sauravatar [DVI-DS]
script "DVI-AwakenSauravatar" (void)
{
 int PX, PY, PZ, PA, PBA, FWX, FWY, I1, C1, I2, C2, I3, C3, I4, C4; 

 PX = GetActorX(Player1TID);
 PY = GetActorY(Player1TID);
 PZ = GetActorZ(Player1TID);
 PA = FixedMul(GetActorAngle(Player1TID),360.0);
 PBA = FixedMul(GetActorAngle(Player1TID),255.0);

 if (ModType != 0)
 {
  AmbientSound("SauronSight",127);
  Thing_Activate(999);
  Thing_ChangeTID(999,1124);
  SpecialGameFlags[10000] = 1;
 }
}

// Killed MAP02 Eye [DVI-DS] / MAP12 First Eye [DVII-DS]
script "DVI-M02EyeDead" (void)
{
 int C1, C2, C3, G1, G2, G3;
 if (ModType == 1)
 {
  SetLineTexture(1, SIDE_FRONT, TEXTURE_MIDDLE, "-"); //remove middle 
  SetLineTexture(1, SIDE_BACK, TEXTURE_MIDDLE, "-"); //remove middle 
 }
 if (ModType == 2)
 {
  ReplaceTextures("XE03_01","-",NOT_BOTTOM|NOT_TOP|NOT_FLOOR|NOT_CEILING);
 }
}

// Killed MAP04 Eye #1 [DVI-DS] / MAP12 Second Eye [DVII-DS]
script "DV1-M04Eye1Dead" (void)
{
 int C1, C2, C3, G1, G2, G3;
 if (ModType == 1)
 {
  SetLineTexture(2, SIDE_FRONT, TEXTURE_TOP, "BLACK"); //remove middle 
  SetLineTexture(2, SIDE_FRONT, TEXTURE_MIDDLE, "BLACK"); //remove middle 
  SetLineTexture(2, SIDE_FRONT, TEXTURE_BOTTOM, "BLACK"); //remove middle 
 }
}

// Killed MAP04 Eye #2 [DVI-DS] / MAP12 Third Eye [DVII-DS]
script "DV1-M04Eye2Dead" (void)
{
 int C1, C2, C3, G1, G2, G3;
 if (ModType == 1)
 {
  SetLineTexture(3, SIDE_FRONT, TEXTURE_TOP, "BLACK"); //remove middle 
  SetLineTexture(3, SIDE_FRONT, TEXTURE_MIDDLE, "BLACK"); //remove middle 
  SetLineTexture(3, SIDE_FRONT, TEXTURE_BOTTOM, "BLACK"); //remove middle 
 }
}

// Killed MAP04 Main Eye [DVI-DS] / MAP12 Fourth Eye [DVII-DS]
script "DVI-MainEyeDeath1" (void)
{
 int C1, C2, C3, G1, G2, G3;
 if (ModType == 1)
 {
  SetLineTexture(4, SIDE_FRONT, TEXTURE_TOP, "BLACK"); //remove middle 
  SetLineTexture(4, SIDE_FRONT, TEXTURE_MIDDLE, "BLACK"); //remove middle 
  SetLineTexture(4, SIDE_FRONT, TEXTURE_BOTTOM, "BLACK"); //remove middle 
  SetLineTexture(4, SIDE_BACK, TEXTURE_TOP, "BLACK"); //remove middle 
  SetLineTexture(4, SIDE_BACK, TEXTURE_MIDDLE, "BLACK"); //remove middle 
  SetLineTexture(4, SIDE_BACK, TEXTURE_BOTTOM, "BLACK"); //remove middle 
  ChangeCeiling(13, "BLACK");
  ChangeFloor(13, "BLACK");
 }
}

// Sauravatar's Death [DVI-DS]
script "SauravatarDeath" (void)
{
 int C1;
 SetMusic("*", 0); 
}

// New Soulsphere script :P
script "GrabSoulsphere" (void)
{
 int C1, C2, C3, G1, G2, G3, H1, H2, H3, M1, M2, M3;
 int MaxManaLimit;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int temp1, temp2;
 int PerkFactor;
 int perktemp1;
 
 G1 = GetActorProperty(Player1TID,APROP_Health); 
 G2 = MaxHealthLimit;
 if (G1 < G2)
 {
  C1 = MaxHealthTrue;
  G1 += C1;
  if (G1 >= G2) G1 = G2;

  SetActorProperty(Player1TID,APROP_Health,G1);
 }

 // Add 25% to Stamina Value [up to 500%]
 MiscellaneousVars[165] = MiscellaneousVars[22] / 4;
 perktemp1 = MiscellaneousVars[165];
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
 PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
 perktemp1 = perktemp1 * PerkFactor / 10000;
 if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");

 if (MiscellaneousVars[21] < MiscellaneousVars[164]) MiscellaneousVars[21] += MiscellaneousVars[165]; 
 if (MiscellaneousVars[21] > MiscellaneousVars[164]) MiscellaneousVars[21] = MiscellaneousVars[164];

 // Add 50% MP/Mana to Deggaris/Illucia/Flora, 200% Max MP/Mana.
 MaxManaLimit = MaxMana * 2;
 if (CurrentMana < MaxManaLimit)
 {
  M1 = MaxMana / 2;
  CurrentMana += M1;
  if (CurrentMana > MaxManaLimit) CurrentMana = MaxManaLimit;
 }

 int HellcoreRestored;
 if (CharacterClass == 2) // Flora's Hellcore Heating will also go down with each SoulSphere grabbed
 {
  if (HellcoreOverheatLevel > 0)
  {
   H1 = 250000; // 25.00% [10000000 is 1000.00% (maximum)]
   H2 = PlayerLevel * 2500;
   H3 = random(-50000,50000);

   HellcoreRestored = H1 + H2 + H3;
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) HellcoreRestored = HellcoreRestored * 5 / 3;
   if (MiscellaneousVars[10033] >= 0)
   {
    if (MiscellaneousVars[10033] == 1) temp1 = 1;
    if (MiscellaneousVars[10033] == 2) temp1 = 2;
    if (MiscellaneousVars[10033] == 3) temp1 = 3;
    if (MiscellaneousVars[10033] == 4) temp1 = 4;
    if (MiscellaneousVars[10033] == 5) temp1 = 5;
    if (MiscellaneousVars[10034] == 1) temp2 = random(2,3);
    if (MiscellaneousVars[10034] == 2) temp2 = 5;
    PerkFactor = 16 + (temp1 + temp2);
    HellcoreRestored = HellcoreRestored * PerkFactor / 16;
   }

   if (HellcoreRestored < 1) HellcoreRestored = 1;
   if (HellcoreRestored > 10000000) HellcoreRestored = 10000000;

   HellcoreOverheatLevel -= HellcoreRestored;
   if (HellcoreOverheatLevel < 0) HellcoreOverheatLevel = 0;
  }
 }
}

// New Megasphere Script [for health half] :P
script "MegaSphereHealth" (void)
{
 int C1, C2, C3, G1, G2, G3, H1, H2, H3;
 int MaxHealthLimit = MaxHealthTrue * 2;
 G1 = GetActorProperty(Player1TID,APROP_Health); 
 G2 = MaxHealthLimit;
 int temp1, temp2;
 int PerkFactor;
 int perktemp1;

 if (G1 < G2)
 {
  C1 = MaxHealthLimit;
  G1 += C1;
  if (G1 >= G2) G1 = G2;

  SetActorProperty(Player1TID,APROP_Health,G1);
 }

 // Add 50% to Stamina Value [up to 200%]
 MiscellaneousVars[165] = MiscellaneousVars[22] / 2;
 perktemp1 = MiscellaneousVars[165];
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
 PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
 perktemp1 = perktemp1 * PerkFactor / 10000;
 if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");

 if (MiscellaneousVars[21] < MiscellaneousVars[164]) MiscellaneousVars[21] += MiscellaneousVars[165]; 
 if (MiscellaneousVars[21] > MiscellaneousVars[164]) MiscellaneousVars[21] = MiscellaneousVars[164];

 int HellcoreRestored;
 if (CharacterClass == 2) // Flora's Hellcore Heating will also go down with each SoulSphere grabbed
 {
  if (HellcoreOverheatLevel > 0)
  {
   H1 = 750000; // 75.00% [10000000 is 1000.00% (maximum)]
   H2 = PlayerLevel * 7500;
   H3 = random(-150000,150000);
   HellcoreRestored = H1 + H2 + H3;

   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) HellcoreRestored = HellcoreRestored * 5 / 3;
   if (MiscellaneousVars[10033] >= 0)
   {
    if (MiscellaneousVars[10033] == 1) temp1 = 1;
    if (MiscellaneousVars[10033] == 2) temp1 = 2;
    if (MiscellaneousVars[10033] == 3) temp1 = 3;
    if (MiscellaneousVars[10033] == 4) temp1 = 4;
    if (MiscellaneousVars[10033] == 5) temp1 = 5;
    if (MiscellaneousVars[10034] == 1) temp2 = random(2,3);
    if (MiscellaneousVars[10034] == 2) temp2 = 5;
    PerkFactor = 16 + (temp1 + temp2);
    HellcoreRestored = HellcoreRestored * PerkFactor / 16;
   }

   if (HellcoreRestored < 1) HellcoreRestored = 1;
   if (HellcoreRestored > 10000000) HellcoreRestored = 10000000;

   HellcoreOverheatLevel -= HellcoreRestored;
   if (HellcoreOverheatLevel < 0) HellcoreOverheatLevel = 0;
  }
 }

}

// New Health Bonus Script :P
script "EmulateGiveHealthBonus" (int multiplier, int givemanachance)
{
 int C1, C2, C3, G1, G2, G3, H1, H2, H3;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int MaxManaLimit = MaxMana * 2;
 int temp1, temp2;
 int PerkFactor;
 int CurrentHealth, TempHealAmount, TempHealAmount2, TempHealAmount3;

 If (multiplier <= 0) multiplier = 1;

 CurrentHealth = GetActorProperty(Player1TID,APROP_Health); 

 if (CurrentHealth < MaxHealthLimit)
 {
  TempHealAmount = MaxHealthTrue / 100;
  if (TempHealAmount < 1) TempHealAmount = 1;

  TempHealAmount2 = PlayerLevel / 25;
  TempHealAmount += TempHealAmount2;
  TempHealAmount *= multiplier;
  CurrentHealth += TempHealAmount;
  if (CurrentHealth >= MaxHealthLimit) CurrentHealth = MaxHealthLimit;

  SetActorProperty(Player1TID,APROP_Health,CurrentHealth);
 }

 if (random(1,100) <= givemanachance)
 {
  if (CurrentMana < MaxManaLimit)
  {
   TempHealAmount = MaxMana / 100;
   if (TempHealAmount < 1) TempHealAmount = 1;

   TempHealAmount2 = PlayerLevel / 25;
   TempHealAmount += TempHealAmount2;
   TempHealAmount *= multiplier;
   CurrentMana += TempHealAmount;
   if (CurrentMana >= MaxManaLimit) CurrentMana = MaxManaLimit;
  }
 }
 
 // Add 0.5% to Stamina Value [up to 500%]
 MiscellaneousVars[165] = MiscellaneousVars[22] / 200;
 MiscellaneousVars[165] *= multiplier;
 int perktemp1 = MiscellaneousVars[165];

 PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
 perktemp1 = perktemp1 * PerkFactor / 10000;
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) perktemp1 = perktemp1 * 5 / 3;
 if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");
 MiscellaneousVars[165] = perktemp1;

 if (MiscellaneousVars[21] < MiscellaneousVars[164]) MiscellaneousVars[21] += MiscellaneousVars[165]; 
 if (MiscellaneousVars[21] > MiscellaneousVars[164]) MiscellaneousVars[21] = MiscellaneousVars[164];

 int HellcoreRestored;
 if (CharacterClass == 2) // Flora's Hellcore Heating will also marginally go down with each Health Bonus grabbed
 {
  if (HellcoreOverheatLevel > 0)
  {
   TempHealAmount = 2500; // 0.25% [10000000 is 1000.00% (maximum)]
   TempHealAmount *= multiplier;
   TempHealAmount2 = PlayerLevel * 10;
   TempHealAmount3 = random(-500,500);
   HellcoreRestored = TempHealAmount + TempHealAmount2 + TempHealAmount3;
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) HellcoreRestored = HellcoreRestored * 5 / 3;
   if (MiscellaneousVars[10033] >= 0)
   {
    if (MiscellaneousVars[10033] == 1) temp1 = 1;
    if (MiscellaneousVars[10033] == 2) temp1 = 2;
    if (MiscellaneousVars[10033] == 3) temp1 = 3;
    if (MiscellaneousVars[10033] == 4) temp1 = 4;
    if (MiscellaneousVars[10033] == 5) temp1 = 5;
    if (MiscellaneousVars[10034] == 1) temp2 = random(2,3);
    if (MiscellaneousVars[10034] == 2) temp2 = 5;
    PerkFactor = 16 + (temp1 + temp2);
    HellcoreRestored = HellcoreRestored * PerkFactor / 16;
   }
   if (HellcoreRestored < 1) HellcoreRestored = 1;
   if (HellcoreRestored > 10000000) HellcoreRestored = 10000000;

   HellcoreOverheatLevel -= HellcoreRestored;
   if (HellcoreOverheatLevel < 0) HellcoreOverheatLevel = 0;
  }
 }
}

// Used later to configure the full max health of the [Greater] Sauravatar and set it to its proper Health to start the fight [instead of its predefined DECORATE amount] [DVI-DS]
script "SetSauravatarHealth" (void)
{
 int C1, C2, C3, C4, G1, G2, G3, G4;

  SpecialGameFlags[10001] = SpecialGameFlags[10002];
  // PrintBold(s:"Phase1 - First Value: ",d:SpecialGameFlags[10001]);

  if (GameSkill() == SKILL_VERY_EASY) G4 = 30;
  else if (GameSkill() == SKILL_EASY) G4 = 35;
  else if (GameSkill() == SKILL_NORMAL) G4 = 40;
  else if (GameSkill() == SKILL_HARD) G4 = 45;
  else if (GameSkill() == SKILL_VERY_HARD) G4 = 50;

  C1 = SpecialGameFlags[10001] * G4 / 100;
  SpecialGameFlags[10001] += C1;
  // PrintBold(s:"Phase2 - Difficulty Add: ",d:SpecialGameFlags[10001],s:"\nC1: ",d:C1);

  C4 = MonstersAlive[22] * 192;
  C4 += MonstersKilled[22] * 24;
  C4 += MonstersAlive[23] * 160;
  C4 += MonstersKilled[23] * 36;
  C4 += MonstersAlive[24] * 128;
  C4 += MonstersKilled[24] * 48;
  C4 += MonstersAlive[25] * 96;
  C4 += MonstersKilled[25] * 60;
  if (GameSkill() == SKILL_VERY_EASY) C3 = 70;
  else if (GameSkill() == SKILL_EASY) C3 = 88;
  else if (GameSkill() == SKILL_NORMAL) C3 = 100;
  else if (GameSkill() == SKILL_HARD) C3 = 112;
  else if (GameSkill() == SKILL_VERY_HARD) C3 = 130;

  C4 = C4 * C3 / 100;
  SpecialGameFlags[10001] += C4;
//  PrintBold(s:"Phase3 - Level Kills Add: ",d:SpecialGameFlags[10001],s:"\nC4: ",d:C4,s:"\nC3: ",d:C3);

  C4 = SecretsFound[22];
  C4 -= SecretsFound[23];
  C4 -= SecretsFound[24];
  C4 -= SecretsFound[25];
  if (GameSkill() == SKILL_VERY_EASY) C4 = C4 * 3 / 2;
  else if (GameSkill() == SKILL_EASY) C4 = C4 * 5 / 4;
  else if (GameSkill() == SKILL_NORMAL) C4 = C4 / 2;
  else if (GameSkill() == SKILL_HARD) C4 = C4 / 3;
  else if (GameSkill() == SKILL_VERY_HARD) C4 = C4 / 4;

  C3 = 100;
  C3 -= C4;
  SpecialGameFlags[10001] = SpecialGameFlags[10001] * C3 / 100;
//  PrintBold(s:"Phase4 - SecretsFound Add: ",d:SpecialGameFlags[10001],s:"\nC4: ",d:C4,s:"\nC3: ",d:C3);

  C3 = PlayerLevel / 4;
  C3 += 100;
  SpecialGameFlags[10001] = SpecialGameFlags[10001] * C3 / 100;
//  PrintBold(s:"Phase5 - PlayerLevel Add: ",d:SpecialGameFlags[10001],s:"\nC3: ",d:C3);

  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)
  {
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4;
//   PrintBold(s:"Phase6 - SauronItems Add: Found Helmet ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0)
  {
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4; 
//   PrintBold(s:"Phase6 - SauronItems Add: Found Gauntlets [Deggaris] ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0)
  {
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4; 
//   PrintBold(s:"Phase6 - SauronItems Add: Found Gauntlets [Illucia] ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0)
  { 
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4; 
//   PrintBold(s:"Phase6 - SauronItems Add: Found Gauntlets [Flora] ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0)
  { 
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4; 
//   PrintBold(s:"Phase6 - SauronItems Add: Found Gauntlets [Ailish] ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0)
  { 
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 5 / 4; 
//   PrintBold(s:"Phase6 - SauronItems Add: Found Gauntlets [Petra] ",d:SpecialGameFlags[10001]);
  }
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
  {
   SpecialGameFlags[10001] = SpecialGameFlags[10001] * 2;
//   PrintBold(s:"Phase6 - SauronItems Add: Found Ring ",d:SpecialGameFlags[10001]);
  }
//  PrintBold(s:"Phase6 - SauronItems Add: ",d:SpecialGameFlags[10001]);

  SpecialGameFlags[10003] = SpecialGameFlags[10001] * 2 / 3;
  SpecialGameFlags[10004] = SpecialGameFlags[10001] * 1 / 3;

  SetActorProperty(1124,APROP_Health,SpecialGameFlags[10001]);
  SetActorProperty(1124,APROP_SpawnHealth,SpecialGameFlags[10001]);
  SetInventory("CurrentMaxHealth", SpecialGameFlags[10001]);
  SetUserVariable(1124,"user_MaxHP",SpecialGameFlags[10001]);

  Thing_Damage2(666,999999,"Massacre"); 
}

// Health Regeneration [only runs when Sauravatar walks around] [DVI-DS]
script "SauravatarRegenMode" (int C5)
{
 int C1, C2, C3, G1, G2, G3, G4;

  if (GameSkill() == SKILL_VERY_EASY)
  {
   G4 = 6;
   if (C5 == 1) G4 += 24;
  }
  else
  if (GameSkill() == SKILL_EASY)
  {
   G4 = 7;
   if (C5 == 1) G4 += 28;
  }
  else
  if (GameSkill() == SKILL_NORMAL)
  {
   G4 = 8;
   if (C5 == 1) G4 += 32;
  }
  else
  if (GameSkill() == SKILL_HARD)
  {
   G4 = 9;
   if (C5 == 1) G4 += 36;
  }
  else
  if (GameSkill() == SKILL_VERY_HARD)
  {
   G4 = 10;
   if (C5 == 1) G4 += 40;
  }
  if (C2 <= SpecialGameFlags[10003])
  {
   if (C2 <= SpecialGameFlags[10004]) G4 = G4 * 11 / 8; else G4 = G4 * 9 / 8;
  }
  C1 = SpecialGameFlags[10001] * G4 / 131072;
  if (C2 <= SpecialGameFlags[10003])
  {
   if (C2 <= SpecialGameFlags[10004])
   {
    C1 += random(-7,7);
   }
   else
   {
    C1 += random(-5,5);
   }
  }
  else
  {
   C1 += random(-4,4);
  }
  if (C1 < 1) C1 = 1;

  C2 = GetActorProperty(1124,APROP_Health);
  C2 += C1;
  if (C2 > SpecialGameFlags[10001]) C2 = SpecialGameFlags[10001];

  SetActorProperty(1124,APROP_Health,C2);

  if (C2 <= SpecialGameFlags[10003])
  {
   if (C2 <= SpecialGameFlags[10004])
   {
    SetThingSpecial(1124,0,2,0,0,0,0); // Set's args[0] to 2 in order to make the Sauravatar shoot his OmniBFG balls in threes [the white BFG balls]
   }
   else
   {
    SetThingSpecial(1124,0,1,0,0,0,0); // Set's args[0] to 1 in order to make the Sauravatar shoot his MegaBFG balls in twos [the yellow BFG balls]
   }
  }
  else
  {
   SetThingSpecial(1124,0,0,0,0,0,0); // Set's args[0] to 0 in order to make the Sauravatar shoot his SuperBFG balls [the red BFG balls]
  }
}

// Changes Music for the battle with the main Eye of Sauron on MAP04 [DVI-DS] or MAP12 [DVII-DS]
script "DV1M04-Music1" (void)
{
 if (SpecialGameFlags[10000] == 0) SetMusic("DDRAGON3", 13); 
}

// Changes Music back when exiting the Fishmouth Temple in MAP04 [DVI-DS] or MAP12 [DVII-DS]
script 24 (void)
{
 if (SpecialGameFlags[10000] == 0) SetMusic("*", 0); 
}

// Changes Music for Entering the Fishmouth Temple in MAP04 [DVI-DS] or MAP12 [DVII-DS]
script 25 (void)
{
 if (SpecialGameFlags[10000] == 0) SetMusic("DDRAGON3", 15); 
}

// Max Health Bonus Script
script "MaxHPBonusPickup" (void)
{
 int I1, I2, Z1, Z2, HPError, C1, C2, BonusMaxHP, CurrentHP, PerkFactor; 
 int ArmorHPBonus = 0;
 int MapNoBonus = 0;

 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) terminate;

 if (CharacterClass == 0) BonusMaxHP = MaxHealthTrue / 400;
 if (CharacterClass == 1) BonusMaxHP = MaxHealthTrue / 420;
 if (CharacterClass == 2) BonusMaxHP = MaxHealthTrue / 440;
 if (CharacterClass == 8) BonusMaxHP = MaxHealthTrue / 450;
 if (CharacterClass == 9) BonusMaxHP = MaxHealthTrue / 400;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [Base]: ",d:BonusMaxHP);

 if (CharacterClass == 0) HPError = MaxHealthTrue / 1200; // Deggaris has one more HP to his Error for the least amount of HP each [1200]
 if (CharacterClass == 1) HPError = MaxHealthTrue / 1260; // Illucia has one more HP to her Error for the middle amount of HP each [1260]
 if (CharacterClass == 2) HPError = MaxHealthTrue / 1320; // Flora has one more HP to her Error for the most amount of HP each [1320]
 if (CharacterClass == 8) HPError = MaxHealthTrue / 1350; // Ailish has one more HP to her Error for the most amount of HP each [1350]
 if (CharacterClass == 9) HPError = MaxHealthTrue / 1200; // Petra has one more HP to her Error for the least amount of HP each [1200]
 HPError += 1;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"HPError: ",d:HPError);
 BonusMaxHP = BonusMaxHP + random(-HPError,HPError);
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [After HPError]: ",d:BonusMaxHP);

 if (CharacterClass == 0) { C1 = random(18,21); } // Deggaris receives most HP from a bonus
 if (CharacterClass == 1) { C1 = random(15,17); } // Illucia receives less HP from a bonus than Deggaris, but more than Flora.
 if (CharacterClass == 2) { C1 = random(12,14); } // Flora used to receive the least HP from a bonus...
 if (CharacterClass == 8) { C1 = random(10,12); } // Ailish receives the least HP from a bonus
 if (CharacterClass == 9) { C1 = random(18,21); } // Petra receives most HP from a bonus
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"Randomizer C1: ",d:C1);
 BonusMaxHP = BonusMaxHP * C1 / 16;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [After HPError]: ",d:BonusMaxHP);

 // Flora's Armor Items [up to +55% Max HP gained from Max HP Bonuses]
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"PearlyCorset")) ArmorHPBonus += 20; // +20%
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"KissaBra")) ArmorHPBonus += 10; // +10%
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"BalrogRing")) ArmorHPBonus += 15; // +25%
 ArmorHPBonus += 100;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"ArmorHPBonus [Flora]: ",d:ArmorHPBonus);
 BonusMaxHP = BonusMaxHP * ArmorHPBonus / 100; // Flora is the only one who can use the Pearly Corset / Kissa Bra / Balrog Ring
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [After ArmorHPBonus]: ",d:BonusMaxHP);

 PerkFactor = ((MiscellaneousVars[10001] * 500) + (MiscellaneousVars[10002] * 1250)) + 10000;
 BonusMaxHP = BonusMaxHP * PerkFactor / 10000; // "LifeUp" and "LifeUp EX" perks.
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [LifeUp Perk]: ",d:BonusMaxHP);

 PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
 BonusMaxHP = BonusMaxHP * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [StaminaUpgrade (Strife)]: ",d:BonusMaxHP);

 // Overall Modifier
 MapNoBonus = GetLevelInfo(LEVELINFO_LEVELNUM) * 9 / 20; // 45%
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"MapNoBonus: ",d:MapNoBonus);
 BonusMaxHP = BonusMaxHP * (random(70,80) + MapNoBonus) / 100;
 if (GameSkill() == SKILL_VERY_EASY)	BonusMaxHP = BonusMaxHP * (random(90,100) + MapNoBonus) / 100;
 if (GameSkill() == SKILL_EASY)			BonusMaxHP = BonusMaxHP * (random(80,90) + MapNoBonus) / 100;
 if (GameSkill() == SKILL_NORMAL)		BonusMaxHP = BonusMaxHP * (random(75,85) + MapNoBonus) / 100;
 if (GameSkill() == SKILL_HARD)			BonusMaxHP = BonusMaxHP * (random(70,80) + MapNoBonus) / 100;
 if (GameSkill() == SKILL_VERY_HARD)	BonusMaxHP = BonusMaxHP * (random(60,70) + MapNoBonus) / 100;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [After MapNoBonus]: ",d:BonusMaxHP);

 PerkFactor = 1;
 PerkFactor += ((MiscellaneousVars[10001] * 1) / 10) + ((MiscellaneousVars[317] * 1) / 4);
 PerkFactor += ((MiscellaneousVars[317] * 1) / 4);
 if (BonusMaxHP < PerkFactor) BonusMaxHP = PerkFactor;
 if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"BonusMaxHP [Final]: ",d:BonusMaxHP);

 MiscellaneousVars[222] += BonusMaxHP;
 MiscellaneousVars[2031] = 105; 

 CurrentHP = GetActorProperty(Player1TID,APROP_HEALTH);
 //GiveInventory("UpgradeStamina", BonusMaxHP);
 SetActorProperty(Player1TID,APROP_HEALTH,(CurrentHP + BonusMaxHP));
 MaxHealthTrue += BonusMaxHP;
 int MaxHealthLimit = MaxHealthTrue * 2;
 SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);

 // Max HP Bonus also heals extra HP dependant on the character in use.
 CurrentHP = GetActorProperty(Player1TID,APROP_HEALTH);
 if (CharacterClass == 0) CurrentHP = CurrentHP + random(2,4) + BonusMaxHP; // Deggaris receives the Least Healed HP from a bonus
 if (CharacterClass == 1) CurrentHP = CurrentHP + random(3,6) + BonusMaxHP; // Illucia receives a Median of Healed HP from a bonus
 if (CharacterClass == 2) CurrentHP = CurrentHP + random(5,10) + BonusMaxHP; // Flora used to receive the Most Healed HP from a bonus
 if (CharacterClass == 8) CurrentHP = CurrentHP + random(6,12) + BonusMaxHP; // Ailish receives the Most Healed HP from a bonus
 if (CharacterClass == 9) CurrentHP = CurrentHP + random(2,4) + BonusMaxHP; // Petra receives the Least Healed HP from a bonus

 C1 = MaxHealthTrue / 100;
 if (C1 < 1) C1 = 1;

 C2 = PlayerLevel / 10;
 C1 += C2;
 CurrentHP += C1;

 if (CurrentHP > MaxHealthLimit) CurrentHP = MaxHealthLimit;
 SetActorProperty(Player1TID,APROP_HEALTH,CurrentHP);
}

// Check if Health is above or below normal max [for customized "normal" health item checks] (All games)
script "CheckHealthLevels" (int maxhealtype)
{
 int currenthealth = GetActorProperty(Player1TID,APROP_HEALTH);
 int perkhealthlimit = MaxHealthTrue;
 int perkbasemulti = 16;

 if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
 perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
 if (maxhealtype > 0) perkhealthlimit *= 2;
 if (perkhealthlimit > (MaxHealthTrue*2)) perkhealthlimit = (MaxHealthTrue * 2);

 if (currenthealth < perkhealthlimit) SetResultValue(1); else SetResultValue(0);
}

// General Healing Script For Items [HP]
script "Health-HealingItem" (int PercentMax, int PercentAmount, int ExactAmount)
{
 if (PercentMax < 1) PercentMax = 100;
 if (PercentMax > 200) PercentMax = 200;
 int CurrentHP = GetActorProperty(Player1TID,APROP_HEALTH);
 int HPUpperClamp = (MaxHealthTrue * PercentMax) / 100;
 int HPActualHealValue = ((MaxHealthTrue * PercentAmount) / 100) + ExactAmount;

 if (HPActualHealValue > 0)
 {
  CurrentHP += HPActualHealValue;
  if (CurrentHP > HPUpperClamp) CurrentHP = HPUpperClamp;
 }
}

// Increase Stamina
script "Stamina-HealingItem" (int PercentMax, int PercentAmount, int ExactAmount)
{
 if (PercentMax < 1) PercentMax = 100;
 if (PercentMax > 200) PercentMax = 200;
 // MiscellaneousVars[21] = Current Stamina value
 int StaminaUpperClamp = (MiscellaneousVars[22] * PercentMax) / 10000;
 int StaminaPercentHeal = ((MiscellaneousVars[22] * PercentAmount) / 10000) + ExactAmount;

 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) StaminaPercentHeal = StaminaPercentHeal * 5 / 3;

 if (StaminaPercentHeal > 0)
 {
  MiscellaneousVars[21] += StaminaPercentHeal;
  if (MiscellaneousVars[21] > StaminaUpperClamp) MiscellaneousVars[21] = StaminaUpperClamp;
 }
}

// Stimpacks/Medikits/Berserk Packs (All games)
script "PickupMedicalItem" (int HealItemType, int maxhealtype) //
{
 int I1, I2, Z1, Z2, C1, C2, HealAmount, ExtraHeal, CurrentHP;
 int tempstaminalimit;
 int perktemp1, perktemp2, perktemp3;
 int PerkFactor;
 int perkbasemulti = 16;
 CurrentHP = GetActorProperty(Player1TID,APROP_HEALTH);

 if (HealItemType == -1) // Source Guardian Lifeseed
 {
  HealAmount = MaxHealthTrue * 25 / 100;

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  tempstaminalimit = MiscellaneousVars[22] * 5;

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  tempstaminalimit = tempstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < tempstaminalimit)
  {
   MiscellaneousVars[165] = MiscellaneousVars[22] / 8; // 12.5%
   perktemp1 = MiscellaneousVars[165];
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2) + (MiscellaneousVars[10018] * 5)) + 10;
   perktemp1 = perktemp1 * PerkFactor / 10;

   if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   MiscellaneousVars[21] += perktemp1;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:tempstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");
   if (MiscellaneousVars[21] > tempstaminalimit) MiscellaneousVars[21] = tempstaminalimit;
  }

 }
 if (HealItemType == 0 | HealItemType == 1) // Stimpack / Crystal Vial (1) and Medikit / Quartz Flask / Mini Berserk Pack (2) [Health]
 {
  if (HealItemType == 0) HealAmount = MaxHealthTrue * 10 / 100; // [Stimpack/Vial]
  if (HealItemType == 1) HealAmount = MaxHealthTrue * 25 / 100; // [Medikit/Flask]
  perktemp2 = HealAmount;

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  tempstaminalimit = MiscellaneousVars[22];

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  tempstaminalimit = tempstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < tempstaminalimit)
  {
   if (HealItemType == 0) MiscellaneousVars[165] = MiscellaneousVars[22] / 20; // 5.0% [Stimpack/Vial]
   if (HealItemType == 1) MiscellaneousVars[165] = MiscellaneousVars[22] / 8; // 12.5% [Medikit/Flask]
   perktemp1 = MiscellaneousVars[165];
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2) + (MiscellaneousVars[10018] * 5)) + 10;
   perktemp1 = perktemp1 * PerkFactor / 10;

   if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   MiscellaneousVars[21] += perktemp1;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:tempstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");
   if (MiscellaneousVars[21] > tempstaminalimit) MiscellaneousVars[21] = tempstaminalimit;
  }
 }

 if (HealItemType == 2) // Berserk Pack / Mystic Urn [Health]
 {
  HealAmount = MaxHealthTrue;
  perktemp2 = HealAmount;

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
 }
 if (HealItemType == 3 | HealItemType == 4) // Full Berserk Pack (3) and Mini Berserk Pack (4) [Stamina]
 {
  if (HealItemType == 3) MiscellaneousVars[165] = MiscellaneousVars[22] * 2; // 200% [Full Berserk Pack]
  if (HealItemType == 4) MiscellaneousVars[165] = MiscellaneousVars[22] / 2; // 50% [Mini Berserk Pack]
  perktemp1 = MiscellaneousVars[165];
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
  PerkFactor = ((MiscellaneousVars[10017] * 2) + (MiscellaneousVars[10018] * 5)) + 10;
  perktemp1 = perktemp1 * PerkFactor / 10;

  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: [",d:MiscellaneousVars[164],s:"]",
                                                         s:"\nStamina Restored: ",d:perktemp1,s:" VS [",d:MiscellaneousVars[165],s:"]");
  if (MiscellaneousVars[21] < MiscellaneousVars[164]) MiscellaneousVars[21] += perktemp1;
  if (MiscellaneousVars[21] >= MiscellaneousVars[164]) MiscellaneousVars[21] = MiscellaneousVars[164]; 
 }

 int temphealthlimit = MaxHealthTrue;
 if (maxhealtype > 0) temphealthlimit *= 2;

 if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
 temphealthlimit = temphealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

 if (temphealthlimit > (MaxHealthTrue*2)) temphealthlimit = MaxHealthTrue * 2;
 if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:temphealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                        s:"\nHealth Restored: ",d:perktemp2,s:" VS [",d:HealAmount,s:"]");
 if (CurrentHP <= temphealthlimit)
 {
  CurrentHP += perktemp2;
  if (CurrentHP > temphealthlimit) CurrentHP = temphealthlimit;
  SetActorProperty(Player1TID,APROP_HEALTH,CurrentHP);
 }
}

// Debugging for Printing Armor Amounts on Screen
script "PrintArmorValues" (void)
{
 int I1, I2, Z1, Z2, C1, C2;

 Z1 = CheckInventory("Armor");
 Print(s:"BasicArmor: ",d:Z1);
 Z1 = CheckInventory("GreenArmor");
 Print(s:"GreenArmor: ",d:Z1);
 Z1 = CheckInventory("BlueArmor");
 Print(s:"BlueArmor: ",d:Z1);
 Z1 = CheckInventory("StoneSkin");
 Print(s:"StoneSkin: ",d:Z1);
 Z1 = CheckInventory("StoneSkinGA");
 Print(s:"StoneSkinGA: ",d:Z1);
 Z1 = CheckInventory("DiamondSkin");
 Print(s:"DiamondSkin: ",d:Z1);

 Z1 = CheckInventory("DiamondSkinGA");
 Print(s:"DiamondSkinGA: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDS");
 Print(s:"ArmorBonusDS: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSGreen");
 Print(s:"ArmorBonusDSGreen: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSBlue");
 Print(s:"ArmorBonusDSBlue: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSStone1");
 Print(s:"ArmorBonusDSStone1: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSStone2");
 Print(s:"ArmorBonusDSStone2: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSDiamond1");
 Print(s:"ArmorBonusDSDiamond1: ",d:Z1);
 Z1 = CheckInventory("ArmorBonusDSDiamond2");
 Print(s:"ArmorBonusDSDiamond2: ",d:Z1);

/*
 Z1 = CheckInventory("SpiritualExoskin");
 Print(s:"SpiritualExoskin: ",d:Z1);
 Z1 = CheckInventory("GreaterSpiritualExoskin");
 Print(s:"GreaterSpiritualExoskin: ",d:Z1);
 Z1 = CheckInventory("PerfectedSpiritualExoskin");
 Print(s:"PerfectedSpiritualExoskin: ",d:Z1);
*/
}

// Emulates Armor Bonuses for all four (six?) types of armor in DVI-DS. [Applies Only to Deggaris and Illucia]
script "EmulateGiveArmorBonus" (int C5)
{
 int I1, I2, Z1, Z2, C1, C2;

 if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) // Stops Flora/Ailish/Petra from getting armor benefits and sets the item's result to 1 to make the item fail to pickup
 {
  If (C5 <= 0) C5 = 1;

  // Saves original raw Armor Value
  Z1 = CheckActorInventory(Player1TID,"Armor");

  // Clears Armor Types
  Z2 = CheckActorInventory(Player1TID,"Armor"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDS"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSGreen"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSBlue"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSStone1"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSStone2"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSDiamond1"); TakeActorInventory(Player1TID,"Armor", Z2);
  Z2 = CheckActorInventory(Player1TID,"ArmorBonusDSDiamond2"); TakeActorInventory(Player1TID,"Armor", Z2);
  // Flora and her Spiritual Exoskin spell have no Armor Bonuses
  // Flora and her Greater Spiritual Exoskin spell have no Armor Bonuses
  // Flora and her Perfected Spiritual Exoskin spell have no Armor Bonuses

  if (Z1 == 0) // No Armor
  {
   C1 = 1; // Base Increase to Armor and make it Green class
   C1 = C1 * C5;
   Z1 += C1;
   GiveActorInventory(Player1TID,"ArmorBonusDSGreen", Z1);
   CurrentArmorClass = 1;
   CurrentMaxArmor = 100;
   GiveActorInventory(Player1TID,"DSGreenArmorClass", 1);
   TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
  }
  else // Have some kind of existing Armor
  {
   C1 = CurrentArmorClass; // Base Increase to Armor and make it Green class
   C1 = C1 * C5;
   Z1 += C1;
   C2 = Z1 / 100;
   C2 = C2 * C5;
   Z1 += C2;
   C2 = PlayerLevel / 5;
   C2 = C2 * C5;
   Z1 += C2;
   if (Z1 < 101)
   {
    if (CurrentArmorClass < 1) CurrentArmorClass = 1;
   }
   else
   {
    if (Z1 < 201)
    {
     if (CurrentArmorClass < 2) CurrentArmorClass = 2;
    }
    else
    {
     if (Z1 < 501)
     {
      if (CurrentArmorClass < 3) CurrentArmorClass = 3;
     }
     else
     {
      if (Z1 < 1251)
      {
       if (CurrentArmorClass < 4) CurrentArmorClass = 4;
      }
      else
      {
       if (Z1 < 2001)
       {
        if (CurrentArmorClass < 5) CurrentArmorClass = 5;
       }
       else
       {
        if (CurrentArmorClass < 6) CurrentArmorClass = 6;
       }
      }
     }
    }
   }
 
   if (CurrentArmorClass == 0)
   {
    CurrentMaxArmor = 0;
    GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass == 1)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSGreen", Z1);
    CurrentMaxArmor = 100;
    GiveActorInventory(Player1TID,"DSGreenArmorClass", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass == 2)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSBlue", Z1);
    CurrentMaxArmor = 200;
    GiveActorInventory(Player1TID,"DSBlueArmorClass", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass == 3)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSStone1", Z1);
    CurrentMaxArmor = 500;
    GiveActorInventory(Player1TID,"DSStoneArmorClass1", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass == 4)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSDiamond1", Z1);
    CurrentMaxArmor = 1250;
    GiveActorInventory(Player1TID,"DSDiamondArmorClass1", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass == 5)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSStone2", Z1);
    CurrentMaxArmor = 2000;
    GiveActorInventory(Player1TID,"DSStoneArmorClass2", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   }
   if (CurrentArmorClass >= 6)
   {
    GiveActorInventory(Player1TID,"ArmorBonusDSDiamond2", Z1);
    CurrentMaxArmor = 5000;
    GiveActorInventory(Player1TID,"DSDiamondArmorClass2", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   }
  }
 }

}

// Checks Whether a Full Armor Item can be picked up or not
script "CheckArmorLevels" (int C5)
{
 int I1, I2, Z1, Z2, C1, C2;

 SetResultValue(0); // Stops Flora from getting armor benefits and sets the item's result value to 0 to make the item fail to pickup
 if (CharacterClass != 2)
 {
  Z1 = CheckInventory("Armor");
  if (C5 == 1 && CurrentArmorClass <= 1 && Z1 < 100) SetResultValue(1);
  if (C5 == 2 && CurrentArmorClass <= 2 && Z1 < 200) SetResultValue(1);
  if (C5 == 3 && CurrentArmorClass <= 3 && Z1 < 500) SetResultValue(1);
  if (C5 == 4 && CurrentArmorClass <= 4 && Z1 < 1250) SetResultValue(1);
  if (C5 == 5 && CurrentArmorClass <= 5 && Z1 < 2000) SetResultValue(1);
  if (C5 == 6 && CurrentArmorClass <= 6 && Z1 < 5000) SetResultValue(1);
 }
}


// Emulates Main Armor Item Pickups [Applies Only to Deggaris and Illucia]
script "PickupArmorMain" (int C5)
{
 int I1, I2, Z1, Z2, C1, C2;
 
 // Saves original raw Armor Value
 Z1 = CheckInventory("Armor");

 // Clears Armor Types
 Z2 = CheckInventory("Armor"); TakeInventory("Armor", Z2);
 Z2 = CheckInventory("ArmorBonusDS"); TakeInventory("ArmorBonusDS", Z2);

 Z2 = CheckInventory("ArmorBonusDSGreen"); TakeInventory("ArmorBonusDSGreen", Z2);
 Z2 = CheckInventory("ArmorBonusDSBlue"); TakeInventory("ArmorBonusDSBlue", Z2);
 Z2 = CheckInventory("ArmorBonusDSStone1"); TakeInventory("ArmorBonusDSStone1", Z2);
 Z2 = CheckInventory("ArmorBonusDSStone2"); TakeInventory("ArmorBonusDSStone2", Z2);
 Z2 = CheckInventory("ArmorBonusDSDiamond1"); TakeInventory("ArmorBonusDSDiamond1", Z2);
 Z2 = CheckInventory("ArmorBonusDSDiamond2"); TakeInventory("ArmorBonusDSDiamond2", Z2);

 if (C5 == 1 && CurrentArmorClass <= 1) { CurrentArmorClass = 1; C2 = 100; }
 if (C5 == 2 && CurrentArmorClass <= 2) { CurrentArmorClass = 2; C2 = 200; }
 if (C5 == 3 && CurrentArmorClass <= 3) { CurrentArmorClass = 3; C2 = 500; }
 if (C5 == 4 && CurrentArmorClass <= 4) { CurrentArmorClass = 4; C2 = 1250; }
 if (C5 == 5 && CurrentArmorClass <= 5) { CurrentArmorClass = 5; C2 = 2000; }
 if (C5 == 6 && CurrentArmorClass <= 6) { CurrentArmorClass = 6; C2 = 5000; }

 if (CurrentArmorClass == 1)
 {
  GiveInventory("ArmorBonusDSGreen", C2);
  GiveInventory("DSGreenArmorClass", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSBlueArmorClass", 9999);
  TakeInventory("DSStoneArmorClass1", 9999);
  TakeInventory("DSDiamondArmorClass1", 9999);
  TakeInventory("DSStoneArmorClass2", 9999);
  TakeInventory("DSDiamondArmorClass2", 9999);
  CurrentMaxArmor = 100;
 }
 if (CurrentArmorClass == 2)
 {
  GiveInventory("ArmorBonusDSBlue", C2);
  GiveInventory("DSBlueArmorClass", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSGreenArmorClass", 9999);
  TakeInventory("DSStoneArmorClass1", 9999);
  TakeInventory("DSDiamondArmorClass1", 9999);
  TakeInventory("DSStoneArmorClass2", 9999);
  TakeInventory("DSDiamondArmorClass2", 9999);
  CurrentMaxArmor = 200;
 }
 if (CurrentArmorClass == 3)
 {
  GiveInventory("ArmorBonusDSStone1", C2);
  GiveInventory("DSStoneArmorClass1", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSGreenArmorClass", 9999);
  TakeInventory("DSBlueArmorClass", 9999);
  TakeInventory("DSDiamondArmorClass1", 9999);
  TakeInventory("DSStoneArmorClass2", 9999);
  TakeInventory("DSDiamondArmorClass2", 9999);
  CurrentMaxArmor = 500;
 }
 if (CurrentArmorClass == 4)
 {
  GiveInventory("ArmorBonusDSDiamond1", C2);
  GiveInventory("DSDiamondArmorClass1", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSGreenArmorClass", 9999);
  TakeInventory("DSBlueArmorClass", 9999);
  TakeInventory("DSStoneArmorClass1", 9999);
  TakeInventory("DSStoneArmorClass2", 9999);
  TakeInventory("DSDiamondArmorClass2", 9999);
  CurrentMaxArmor = 1250;
 }
 if (CurrentArmorClass == 5)
 {
  GiveInventory("ArmorBonusDSStone2", C2);
  GiveInventory("DSStoneArmorClass2", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSGreenArmorClass", 9999);
  TakeInventory("DSBlueArmorClass", 9999);
  TakeInventory("DSStoneArmorClass1", 9999);
  TakeInventory("DSDiamondArmorClass1", 9999);
  TakeInventory("DSDiamondArmorClass2", 9999);
  CurrentMaxArmor = 2000;
 }
 if (CurrentArmorClass == 6)
 {
  GiveInventory("ArmorBonusDSDiamond2", C2);
  GiveInventory("DSDiamondArmorClass2", 1);
  TakeInventory("DSNoArmorClass", 9999);
  TakeInventory("DSGreenArmorClass", 9999);
  TakeInventory("DSBlueArmorClass", 9999);
  TakeInventory("DSStoneArmorClass1", 9999);
  TakeInventory("DSDiamondArmorClass1", 9999);
  TakeInventory("DSStoneArmorClass2", 9999);
  CurrentMaxArmor = 5000;
 }
}

//*************************
//** IN GAME MENU SYSTEM **
//*************************
// [0] = Main Switch. Menus in general are on/off (0/1)
// [1] = Menu Highlight/Selection [main]
// [2] = Menu Highlight/Selection [secondary]
// [3] = Menu Highlight/Selection [tritary]
// [4] = Main Menu Type
// [5] = Sub Menu Type
// [6] = SubSub Menu Type
// [10001] = Use Push Delay Timer
// [10002] = Up Push Delay Timer
// [10003] = Down Push Delay Timer
// [10004] = Left Push Delay Timer
// [10005] = Right Push Delay Timer
// [10006] = Back Push Delay Timer

script "MENUKEY" (void)
{
 if (MenuSystemVars[0] == 0)
 {
  MiscellaneousVars[271] = GetActorVelX(Player1TID);
  MiscellaneousVars[272] = GetActorVelY(Player1TID);
  MiscellaneousVars[273] = GetActorVelZ(Player1TID);
  SetActorVelocity(Player1TID, 0, 0, 0, 0, 0);

  MenuSystemVars[0] = 1; // Turns On
  MiscellaneousVars[2500] = 1;
 }
 else
 {
  MenuSystemVars[0] = 0; // Turns Off
  MenuSystemVars[1] = 0; // Resets Main Selection
  MenuSystemVars[2] = 0; // Resets Secondary Selection
  MenuSystemVars[3] = 0; // Resets Tritary Selection
  MenuSystemVars[4] = 0; // Resets Menu Type
  MenuSystemVars[5] = 0; // Resets SubMenu Type
  MenuSystemVars[6] = 0; // Resets SubSubMenu Type
  MiscellaneousVars[2500] = 0;

  MenuSystemVars[10001] = 0; // Use Timer Off
  MenuSystemVars[10002] = 0; // Up Timer Off
  MenuSystemVars[10003] = 0; // Down Timer Off
  MenuSystemVars[10004] = 0; // Left Timer Off
  MenuSystemVars[10005] = 0; // Right Timer Off
  MenuSystemVars[10006] = 0; // Back Timer Off

  SetActorVelocity(Player1TID, MiscellaneousVars[271], MiscellaneousVars[272], MiscellaneousVars[273], 0, 0);
  MiscellaneousVars[271] = 0;
  MiscellaneousVars[272] = 0;
  MiscellaneousVars[273] = 0;
 }
}

function void GetPerkSound (void)
{
 SetActivator(Player1TID); 
 ActivatorSound("DraQue/gainperk",127); 
 SetActivator(0);
}

// Mechanical Stuff
script "INGAMEMENUS_MECHANICS" ENTER
{
 int temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8, temp9, temp10, temp11, temp12, temp13, temp14, temp15, temp16, temp17, temp18, temp19, temp20;
 int temp21, temp22, temp23, temp24, temp25, temp26, temp27, temp28, temp29, temp30, temp31, temp32, temp33, temp34, temp35, temp36, temp37, temp38, temp39, temp40;
 int ticresetinterval = GetCVar("dvdsmenu_ticresetinterval");
 int ticresetinterval2 = GetCVar("dvdsmenu_ticresetinterval2");
 int ticresetinterval3 = GetCVar("dvdsmenu_ticresetinterval3");
 int buttons = GetPlayerInput(0, INPUT_BUTTONS); 

 if (MenuSystemVars[0] == 0) // Menu is off...
 {
  if (PowerupTimer[5] == 0) TakeActorInventory(Player1TID, "AetheriusTimeFreezer", 9999);
  TakeActorInventory(Player1TID, "MenuInvulnerability", 9999);
 }
 else // Turned on...
 {
  GiveActorInventory(Player1TID, "AetheriusTimeFreezer", 1);
  GiveActorInventory(Player1TID, "MenuInvulnerability", 1);

  // Use press button
  if (buttons & BT_USE)
  {
   if (MenuSystemVars[10001] <= 0)
   {
    MenuSystemVars[10001] = ticresetinterval;

    if (MenuSystemVars[4] == 0) // Main Menu
	{
     if (MenuSystemVars[1] == 1) { MenuSystemVars[4] = 1; MenuSystemVars[1] = 0; MenuSystemVars[2] = 0; MenuSystemVars[3] = 0; } // Go to Stats
     if (MenuSystemVars[1] == 2) { MenuSystemVars[4] = 2; MenuSystemVars[1] = 0; MenuSystemVars[2] = 0; MenuSystemVars[3] = 0; } // Go to Spells
     if (GetCVar("dvdsperks_active") == 1 && MenuSystemVars[1] == 3) { MenuSystemVars[4] = 3; MenuSystemVars[1] = 0; MenuSystemVars[2] = 0; MenuSystemVars[3] = 0; } // Go to Perks
     if (MenuSystemVars[1] == 4) { MenuSystemVars[4] = 4; MenuSystemVars[1] = 0; MenuSystemVars[2] = 0; MenuSystemVars[3] = 0; } // Go to Codex
	}
	else
    if (MenuSystemVars[4] == 1) // Stats Menu
	{
	 MenuSystemVars[1] = 1; // Set Main selection
	 MenuSystemVars[2] = 0; // Set Secondary selection to 0
	 MenuSystemVars[3] = 0; // Set Tritary selection to 0
	 MenuSystemVars[4] = 0; // Set Menu Page to main
	 MenuSystemVars[5] = 0; // Reset Submenu
	}
	else
    if (MenuSystemVars[4] == 2) // Spells Menu
	{
	 MenuSystemVars[1] = 2; // Set Main selection
	 MenuSystemVars[2] = 0; // Set Secondary selection to 0
	 MenuSystemVars[3] = 0; // Set Tritary selection to 0
	 MenuSystemVars[4] = 0; // Set Menu Page to main
	 MenuSystemVars[5] = 0; // Reset Submenu
	}
	else
    if (MenuSystemVars[4] == 3) // Perks Menu
	{
     MenuSystemVars[10001] = ticresetinterval2; // Input Delay Extension [Use key]
	 if (MenuSystemVars[1] == 0) // No Selection - go back a menu
	 {
	  MenuSystemVars[1] = 3; // Set Main selection
	  MenuSystemVars[2] = 0; // Set Secondary selection to 0
	  MenuSystemVars[3] = 0; // Set Tritary selection to 0
	  MenuSystemVars[4] = 0; // Set Menu Page to main
	  MenuSystemVars[5] = 0; // Reset Submenu
	 }
	 else
     if (MenuSystemVars[5] == 0) // General Stat Perks
	 {
	  if (MenuSystemVars[1] == 1) // LifeUp [5]
	  {
	   temp6 = 10001; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 2) // MagiUp [5]
	  {
	   temp6 = 10003; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 3) // StamUp [5]
	  {
	   temp6 = 10005; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 4) // DodgeMore [5]
	  {
	   temp6 = 10007; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 5) // JumpMore [5]
	  {
	   temp6 = 10009; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 6) // PsycheFast [5]
	  {
	   temp6 = 10011; // MiscellaneousVars[] input
	   temp1 = 3 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 5 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 7 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 11 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 15 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 7) // RegenHPFast [5]
	  {
	   temp6 = 10013; // MiscellaneousVars[] input
	   temp1 = 6 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 9 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 12 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 18 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 24 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 8) // RegenMPFast [5]
	  {
	   temp6 = 10015; // MiscellaneousVars[] input
	   temp1 = 6 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 9 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 12 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 18 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 24 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 9) // RegenStamFast [5]
	  {
	   temp6 = 10017; // MiscellaneousVars[] input
	   temp1 = 6 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 9 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 12 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 18 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 24 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	  if (MenuSystemVars[1] == 10) // OnTheMove [5]
	  {
	   temp6 = 10045; // MiscellaneousVars[] input
	   temp1 = 6 * MiscellaneousVars[280] / 100; // Level 1 Cost
	   temp2 = 7 * MiscellaneousVars[280] / 100; // Level 2 Cost
	   temp3 = 10 * MiscellaneousVars[280] / 100; // Level 3 Cost
	   temp4 = 13 * MiscellaneousVars[280] / 100; // Level 4 Cost
	   temp5 = 17 * MiscellaneousVars[280] / 100; // Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
	  }
	 }
	 else
     if (MenuSystemVars[5] == 1) // Character-Specfic Stat Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] == 1) // MagiUp EX [2]
	   {
	    temp6 = 10004; // MiscellaneousVars[] input
	    temp7 = 10003; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 2) // DodgeMore EX [1]
	   {
	    temp6 = 10008; // MiscellaneousVars[] input
	    temp7 = 10007; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 3) // JumpMore EX [2]
	   {
	    temp6 = 10010; // MiscellaneousVars[] input
	    temp7 = 10009; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] == 1) // StamUp EX [2]
	   {
	    temp6 = 10006; // MiscellaneousVars[] input [main perk]
	    temp7 = 10005; // MiscellaneousVars[] input [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 2) // DodgeMore EX [2]
	   {
	    temp6 = 10008; // MiscellaneousVars[] input
	    temp7 = 10007; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
 	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 3) // JumpMore EX [1]
	   {
	    temp6 = 10010; // MiscellaneousVars[] input
	    temp7 = 10009; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   }
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] == 1) // LifeUp EX [2]
	   {
	    temp6 = 10002; // MiscellaneousVars[] input
	    temp7 = 10001; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 2) // PsycheFast EX [2]
	   {
	    temp6 = 10012; // MiscellaneousVars[] input
	    temp7 = 10011; // MiscellaneousVars[] input [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    temp2 = 16 * MiscellaneousVars[280] / 100; // Level 2 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 3) // StamUp EX [1]
	   {
	    temp6 = 10006; // MiscellaneousVars[] input [main perk]
	    temp7 = 10005; // MiscellaneousVars[] input [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   }
  	  }
      /*if (CharacterClass == 9) // Petra
	  {
	   if (MenuSystemVars[1] == 1) // DodgeMore EX [1]
	   {
	    temp6 = 10008; // MiscellaneousVars[] input
	    temp7 = 10007; // MiscellaneousVars[] [requirement type]
	    temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp1 = 11 * MiscellaneousVars[280] / 100; // Level 1 Cost
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   }
  	  }*/
	 }
	 else
     if (MenuSystemVars[5] == 2) // Weapon Perks
	 {
      if (CharacterClass == 0 | CharacterClass == 1) // Deggaris/Illucia Only
	  {
	   if (MenuSystemVars[1] == 1) // Berserker Fit [5]
	   {
	    temp6 = 10051; // MiscellaneousVars[] input
	    temp1 = 10 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 15 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 20 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 25 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 35 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 2) // Bullet Accuracy [5]
	   {
	    temp6 = 10019; // MiscellaneousVars[] input
	    temp1 = 3 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 6 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 10 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 14 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 19 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
 	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
 	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 3) // Pellet Accuracy [5]
	   {
	    temp6 = 10021; // MiscellaneousVars[] input
	    temp1 = 3 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 6 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 10 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 14 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 19 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 4) // Plasma Accuracy [5]
	   {
	    temp6 = 10023; // MiscellaneousVars[] input
	    temp1 = 3 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 6 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 10 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 14 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 19 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 5) // Demolitions Expert [5]
	   {
	    temp6 = 10025; // MiscellaneousVars[] input
	    temp1 = 3 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 6 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 10 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 14 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 19 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 6) // Bottomless Magazines [5]
	   {
	    temp6 = 10047; // MiscellaneousVars[] input
	    temp1 = 5 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 9 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 14 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 20 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 28 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }

       if (CharacterClass == 0) // Deggaris Only
	   {
	    if (MenuSystemVars[1] == 7) // Bullet Accuracy EX [2]
	    {
	     temp6 = 10020; // MiscellaneousVars[] input
	     temp7 = 10019; // MiscellaneousVars[] [requirement type]
	     temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	     temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	     temp1 = 4 * MiscellaneousVars[280] / 100; // Level 1 Cost
	     temp2 = 7 * MiscellaneousVars[280] / 100; // Level 2 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	     if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	     else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    }
	    if (MenuSystemVars[1] == 8) // Demolitions Expert EX [1]
	    {
	     temp6 = 10026; // MiscellaneousVars[] input [main perk]
	     temp7 = 10025; // MiscellaneousVars[] input [requirement type]
	     temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	     temp1 = 4 * MiscellaneousVars[280] / 100; // Level 1 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
 	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	    }
	    if (MenuSystemVars[1] == 9) // BFG Attunement [2]
	    {
	     temp6 = 10029; // MiscellaneousVars[] input
	     temp1 = 24 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	     temp2 = 43 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
  	     if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; }
	     else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; }
 	    }
	   }
	   else
       if (CharacterClass == 1) // Illucia Only
	   {
	    if (MenuSystemVars[1] == 7) // Pellet Accuracy EX [2]
	    {
	     temp6 = 10022; // MiscellaneousVars[] input
	     temp7 = 10021; // MiscellaneousVars[] [requirement type]
	     temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	     temp9 = 4; // MiscellaneousVars[] input [requirement level threshold 2]
	     temp1 = 4 * MiscellaneousVars[280] / 100; // Level 1 Cost
	     temp2 = 7 * MiscellaneousVars[280] / 100; // Level 2 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	     if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	     else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[temp7] >= temp9 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    }
	    if (MenuSystemVars[1] == 8) // Plasma Accuracy EX [1]
	    {
	     temp6 = 10024; // MiscellaneousVars[] input [main perk]
	     temp7 = 10023; // MiscellaneousVars[] input [requirement type]
	     temp8 = 2; // MiscellaneousVars[] input [requirement level threshold 1]
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	     temp1 = 4 * MiscellaneousVars[280] / 100; // Level 1 Cost
 	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	    }
	    if (MenuSystemVars[1] == 9) // Karasawa Attunement [2]
	    {
	     temp6 = 10027; // MiscellaneousVars[] input
	     temp1 = 24 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	     temp2 = 43 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	     if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	     else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
 	    }
	   }
	  }
	  else
      if (CharacterClass == 2) // Flora Only
	  {
	   if (MenuSystemVars[1] == 1) // Archery Mastery [5]
	   {
	    temp6 = 10031; // MiscellaneousVars[] input
	    temp1 = 5 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 10 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 23 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 31 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
 	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
 	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 2) // Wand/Staff Mastery [5]
	   {
	    temp6 = 10053; // MiscellaneousVars[] input
	    temp1 = 5 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 10 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 23 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 31 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 3) // Soul Mastery [5]
	   {
	    temp6 = 10033; // MiscellaneousVars[] input
	    temp1 = 5 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 10 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 23 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 31 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 4) // Martial Arts Mastery [5]
	   {
	    temp6 = 10035; // MiscellaneousVars[] input
	    temp1 = 8 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 12 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 19 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 31 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 51 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	  }
	 }
	 else
     if (MenuSystemVars[5] == 3) // Item Perks
	 {
	  if (MenuSystemVars[1] == 1) // Medicinal Prowess [5]
	  {
	   temp6 = 10049; // MiscellaneousVars[] input
	   temp1 = 5 * MiscellaneousVars[280] / 100;		// Level 1 Cost
	   temp2 = 9 * MiscellaneousVars[280] / 100;		// Level 2 Cost
	   temp3 = 14 * MiscellaneousVars[280] / 100;		// Level 3 Cost
	   temp4 = 22 * MiscellaneousVars[280] / 100;		// Level 4 Cost
	   temp5 = 29 * MiscellaneousVars[280] / 100;		// Level 5 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	   if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	   else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	  }
	  if (MenuSystemVars[1] == 2) // Powerup Powerhouse [4]
	  {
	   temp6 = 10050; // MiscellaneousVars[] input
	   temp1 = 7 * MiscellaneousVars[280] / 100;		// Level 1 Cost
	   temp2 = 16 * MiscellaneousVars[280] / 100;		// Level 2 Cost
	   temp3 = 27 * MiscellaneousVars[280] / 100;		// Level 3 Cost
	   temp4 = 40 * MiscellaneousVars[280] / 100;		// Level 4 Cost
	   if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	   if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	   if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	   if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	        if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	   else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	  }
	 }
	 else
     if (MenuSystemVars[5] == 4) // Misc Perks
	 {
      if (CharacterClass == 0 | CharacterClass == 1) // Deggaris/Illucia Only
	  {
	   if (MenuSystemVars[1] == 1) // Mortal Hit Survivability Blast Wave [1]
	   {
	    temp6 = 10041; // MiscellaneousVars[] input
	    temp1 = 15 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 2) // Mortal Hit Survivability Mana Recovery [1]
	   {
	    temp6 = 10039; // MiscellaneousVars[] input
	    temp1 = 15 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	   }
       if (CharacterClass == 0) // Deggaris Only
	   {
	    if (MenuSystemVars[1] == 3) // Mortal Hit Survivability "Death Rage" [3]
	    {
	     temp6 = 10043; // MiscellaneousVars[] input
	     temp1 = 20 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	     temp2 = 30 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	     temp3 = 50 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	     if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	     if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	     else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	     else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
 	    }
	   }
	   else
       if (CharacterClass == 1) // Illucia Only
	   {
	    if (MenuSystemVars[1] == 3) // Mortal Hit Survivability Blast Wave EX [1]
	    {
	     temp6 = 10042; // MiscellaneousVars[] input
	     temp7 = 10041; // MiscellaneousVars[] [requirement type]
	     temp8 = 1; // MiscellaneousVars[] input [requirement level threshold 1]
	     temp1 = 35 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	     if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	          if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	    }
	   }
	   if (MenuSystemVars[1] == 4) // Mortal Hit Survivability Psyche Up [7]
	   {
	    temp6 = 10037;	// MiscellaneousVars[] input
	    temp1 = 9 * MiscellaneousVars[280] / 100;		// Level 1 Cost
	    temp2 = 12 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 20 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 28 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    temp21 = 39 * MiscellaneousVars[280] / 100;	// Level 6 Cost
	    temp22 = 57 * MiscellaneousVars[280] / 100;	// Level 7 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	    if (temp21 < GetCVar("dvdsperks_minimumcost")) temp21 = GetCVar("dvdsperks_minimumcost");
	    if (temp22 < GetCVar("dvdsperks_minimumcost")) temp22 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 5 && MiscellaneousVars[25] >= temp21) { MiscellaneousVars[temp6] = 6; MiscellaneousVars[25] -= temp21; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 6 && MiscellaneousVars[25] >= temp22) { MiscellaneousVars[temp6] = 7; MiscellaneousVars[25] -= temp22; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 5) // Cleared of Mind [5]
	   {
	    temp6 = 10055;	// MiscellaneousVars[] input
	    temp1 = 8 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 12 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 20 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 24 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	  }
	  else
      if (CharacterClass == 2) // Flora Only
	  {
	   if (MenuSystemVars[1] == 1) // Mortal Hit Survivability Mana Recovery [1]
	   {
	    temp6 = 10039; // MiscellaneousVars[] input
	    temp1 = 15 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 2) // Mortal Hit Survivability Mana Recovery EX [1]
	   {
	    temp6 = 10040; // MiscellaneousVars[] input
	    temp7 = 10039; // MiscellaneousVars[] input
	    temp8 = 1; // MiscellaneousVars[] input [requirement level threshold 1]
	    temp1 = 35 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[temp7] >= temp8 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	   }
	   if (MenuSystemVars[1] == 3) // Mortal Hit Survivability Psyche Up [7]
	   {
	    temp6 = 10037;	// MiscellaneousVars[] input
	     temp1 = 12 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	     temp2 = 15 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	     temp3 = 19 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	     temp4 = 23 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	     temp5 = 31 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    temp21 = 42 * MiscellaneousVars[280] / 100;	// Level 6 Cost
	    temp22 = 60 * MiscellaneousVars[280] / 100;	// Level 7 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	    if (temp21 < GetCVar("dvdsperks_minimumcost")) temp21 = GetCVar("dvdsperks_minimumcost");
	    if (temp22 < GetCVar("dvdsperks_minimumcost")) temp22 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 5 && MiscellaneousVars[25] >= temp21) { MiscellaneousVars[temp6] = 6; MiscellaneousVars[25] -= temp21; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 6 && MiscellaneousVars[25] >= temp22) { MiscellaneousVars[temp6] = 7; MiscellaneousVars[25] -= temp22; GetPerkSound(); }
 	   }
	   if (MenuSystemVars[1] == 4) // Cleared of Mind [5]
	   {
	    temp6 = 10055;	// MiscellaneousVars[] input
	    temp1 = 8 * MiscellaneousVars[280] / 100;	// Level 1 Cost
	    temp2 = 12 * MiscellaneousVars[280] / 100;	// Level 2 Cost
	    temp3 = 16 * MiscellaneousVars[280] / 100;	// Level 3 Cost
	    temp4 = 20 * MiscellaneousVars[280] / 100;	// Level 4 Cost
	    temp5 = 24 * MiscellaneousVars[280] / 100;	// Level 5 Cost
	    if (temp1 < GetCVar("dvdsperks_minimumcost")) temp1 = GetCVar("dvdsperks_minimumcost");
	    if (temp2 < GetCVar("dvdsperks_minimumcost")) temp2 = GetCVar("dvdsperks_minimumcost");
	    if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	    if (temp4 < GetCVar("dvdsperks_minimumcost")) temp4 = GetCVar("dvdsperks_minimumcost");
	    if (temp5 < GetCVar("dvdsperks_minimumcost")) temp5 = GetCVar("dvdsperks_minimumcost");
	         if (MiscellaneousVars[temp6] == 0 && MiscellaneousVars[25] >= temp1) { MiscellaneousVars[temp6] = 1; MiscellaneousVars[25] -= temp1; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 1 && MiscellaneousVars[25] >= temp2) { MiscellaneousVars[temp6] = 2; MiscellaneousVars[25] -= temp2; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 2 && MiscellaneousVars[25] >= temp3) { MiscellaneousVars[temp6] = 3; MiscellaneousVars[25] -= temp3; GetPerkSound(); }
	    else if (MiscellaneousVars[temp6] == 3 && MiscellaneousVars[25] >= temp4) { MiscellaneousVars[temp6] = 4; MiscellaneousVars[25] -= temp4; GetPerkSound(); }
 	    else if (MiscellaneousVars[temp6] == 4 && MiscellaneousVars[25] >= temp5) { MiscellaneousVars[temp6] = 5; MiscellaneousVars[25] -= temp5; GetPerkSound(); }
 	   }
	  }	  
	 }
	 else
     if (MenuSystemVars[5] == 5) // Mastery Perks
	 {
	  // Nothing for now
	 }
	}
	else
    if (MenuSystemVars[4] == 4) // Codex Menu
	{
	 MenuSystemVars[1] = 4; // Set Main selection
	 MenuSystemVars[2] = 0; // Set Secondary selection to 0
	 MenuSystemVars[3] = 0; // Set Tritary selection to 0
	 MenuSystemVars[4] = 0; // Set Menu Page to main
	 MenuSystemVars[5] = 0; // Reset Submenu
	}

   }
  }
  // Up press button
  if (buttons & BT_FORWARD | buttons & BT_MOVEUP | buttons & BT_LOOKUP)
  {
   if (MenuSystemVars[10002] <= 0) 
   { 
    MenuSystemVars[10002] = ticresetinterval; 

    MenuSystemVars[1] -= 1;
    if (MenuSystemVars[4] == 0) // Main Menu
	{
	 if (GetCVar("dvdsperks_active") == 0 && MenuSystemVars[1] == 3) MenuSystemVars[1] -= 1;
	 if (MenuSystemVars[1] < 1) MenuSystemVars[1] = 4;
	}
    if (MenuSystemVars[4] == 3) // Perks Menu
	{
     MenuSystemVars[10002] = ticresetinterval3; 
     if (MenuSystemVars[5] == 0) // General Stat Perks
	 {
	  if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 10;
	 }
     if (MenuSystemVars[5] == 1) // Character-Specfic Stat Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 3;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 3;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 3;
	  }
	 }
     if (MenuSystemVars[5] == 2) // Weapon Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 9;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 9;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 4;
	  }
	 }
     if (MenuSystemVars[5] == 3) // Item Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 2;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 2;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 2;
	  }
	 }
     if (MenuSystemVars[5] == 4) // Misc Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 5;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 5;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 4;
	  }
	 }
     if (MenuSystemVars[5] == 5) // Mastery Perks
	 {
	  MenuSystemVars[1] = 0;
	 }
	}
    if (MenuSystemVars[4] == 4) // Codex Menu
	{
     MenuSystemVars[10002] = ticresetinterval3; 
     if (MenuSystemVars[5] == 0) // General Stat Perks
	 {
	  if (MenuSystemVars[1] < 0) MenuSystemVars[1] = 6;
	 }
	}

   }
  }
  // Down press button
  if (buttons & BT_BACK | buttons & BT_MOVEDOWN | buttons & BT_LOOKDOWN)
  {
   if (MenuSystemVars[10003] <= 0) 
   { 
    MenuSystemVars[10003] = ticresetinterval; 

    MenuSystemVars[1] += 1;
    if (MenuSystemVars[4] == 0) // Main Menu
	{
	 if (GetCVar("dvdsperks_active") == 0 && MenuSystemVars[1] == 3) MenuSystemVars[1] += 1;
	 if (MenuSystemVars[1] > 4) MenuSystemVars[1] = 1;
	}
    if (MenuSystemVars[4] == 3) // Perks Menu
	{
     MenuSystemVars[10003] = ticresetinterval3; 
     if (MenuSystemVars[5] == 0) // General Stat Perks
	 {
	  if (MenuSystemVars[1] > 10) MenuSystemVars[1] = 0;
	 }
     if (MenuSystemVars[5] == 1) // Character-Specfic Stat Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] > 3) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] > 3) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] > 3) MenuSystemVars[1] = 0;
	  }
	 }
     if (MenuSystemVars[5] == 2) // Weapon Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] > 9) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] > 9) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] > 4) MenuSystemVars[1] = 0;
	  }
	 }
     if (MenuSystemVars[5] == 3) // Item Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] > 2) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] > 2) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] > 2) MenuSystemVars[1] = 0;
	  }
	 }
     if (MenuSystemVars[5] == 4) // Misc Perks
	 {
      if (CharacterClass == 0) // Deggaris Only
	  {
	   if (MenuSystemVars[1] > 5) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 1) // Illucia Only
	  {
	   if (MenuSystemVars[1] > 5) MenuSystemVars[1] = 0;
	  }
	  else
      if (CharacterClass == 2) // Flora
	  {
	   if (MenuSystemVars[1] > 4) MenuSystemVars[1] = 0;
	  }
	 }
     if (MenuSystemVars[5] == 5) // Mastery Perks
	 {
	  MenuSystemVars[1] = 0;
	 }
	}
    if (MenuSystemVars[4] == 4) // Codex Menu
	{
     MenuSystemVars[10003] = ticresetinterval3; 
     if (MenuSystemVars[5] == 0) // General Stat Perks
	 {
	  if (MenuSystemVars[1] > 6) MenuSystemVars[1] = 0;
	 }
	}

   }
  }
  // Left press button
  if (buttons & BT_LEFT | buttons & BT_MOVELEFT)
  {
   if (MenuSystemVars[10004] <= 0) 
   { 
    MenuSystemVars[10004] = ticresetinterval; 

    MenuSystemVars[1] = 0;
    MenuSystemVars[2] = 0;
    MenuSystemVars[3] = 0;
    if (MenuSystemVars[4] == 2) // Spells Menu
    {
     MenuSystemVars[10004] = ticresetinterval3; 
	 MenuSystemVars[5] -= 1;
	 if (MenuSystemVars[5] < 0) MenuSystemVars[5] = 6;
	}
    if (MenuSystemVars[4] == 3) // Perks Menu
    {
     MenuSystemVars[10004] = ticresetinterval3; 
	 MenuSystemVars[5] -= 1;
	 if (MenuSystemVars[5] < 0) MenuSystemVars[5] = 5;
    }

   }
  }
  // Right press button
  if (buttons & BT_RIGHT | buttons & BT_MOVERIGHT)
  {
   if (MenuSystemVars[10005] <= 0)
   {
    MenuSystemVars[10005] = ticresetinterval; 

    MenuSystemVars[1] = 0;
    MenuSystemVars[2] = 0;
    MenuSystemVars[3] = 0;
    if (MenuSystemVars[4] == 2) // Spells Menu
    {
     MenuSystemVars[10005] = ticresetinterval3; 
	 MenuSystemVars[5] += 1;
	 if (MenuSystemVars[5] > 6) MenuSystemVars[5] = 0;
    }
    if (MenuSystemVars[4] == 3) // Perks Menu
    {
     MenuSystemVars[10005] = ticresetinterval3; 
	 MenuSystemVars[5] += 1;
	 if (MenuSystemVars[5] > 5) MenuSystemVars[5] = 0;
    }

   }
  }
  // Back press button
  if (buttons & BT_TURN180)
  {
   if (MenuSystemVars[10006] <= 0)
   {
    MenuSystemVars[10006] = ticresetinterval; 
   }
  }
  
  if (MenuSystemVars[10001] > 0) MenuSystemVars[10001] -= 1; // Use Timer Countdown
  if (MenuSystemVars[10002] > 0) MenuSystemVars[10002] -= 1; // Up Timer Countdown
  if (MenuSystemVars[10003] > 0) MenuSystemVars[10003] -= 1; // Down Timer Countdown
  if (MenuSystemVars[10004] > 0) MenuSystemVars[10004] -= 1; // Left Timer Countdown
  if (MenuSystemVars[10005] > 0) MenuSystemVars[10005] -= 1; // Right Timer Countdown
  if (MenuSystemVars[10006] > 0) MenuSystemVars[10006] -= 1; // Back Timer Countdown
 }

 Delay(1);
 Restart;
}

// [10001] "LifeUp" Perk Level
// [10002] "LifeUp EX" Perk Level
// [10003] "MagiUp" Perk Level
// [10004] "MagiUp EX" Perk Level
// [10005] "StamUp" Perk Level
// [10006] "StamUp EX" Perk Level
// [10007] "DodgeMore" Perk Level
// [10008] "DodgeMore EX" Perk Level
// [10009] "JumpMore" Perk Level
// [10010] "JumpMore EX" Perk Level
// [10011] "PsycheFast" Perk Level
// [10012] "PsycheFast EX" Perk Level
// [10013] "RegenHPFast" Perk Level
// [10014] "RegenHPFast EX" Perk Level
// [10015] "RegenMPFast" Perk Level
// [10016] "RegenMPFast EX" Perk Level
// [10017] "RegenStamFast" Perk Level
// [10018] "RegenStamFast EX" Perk Level
// [10019] "Bullet Accuracy" Perk Level
// [10020] "Bullet Accuracy EX" Perk Level
// [10021] "Pellet Accuracy" Perk Level
// [10022] "Pellet Accuracy EX" Perk Level
// [10023] "Plasma Accuracy" Perk Level
// [10024] "Plasma Accuracy EX" Perk Level
// [10025] "Demolitions Expert" Perk Level
// [10026] "Demolitions Expert EX" Perk Level
// [10027] "Karasawa Attunement" Perk Level
// [10028] "Karasawa Attunement EX" Perk Level
// [10029] "BFG Attunement" Perk Level
// [10030] "BFG Attunement EX" Perk Level
// [10031] "Archery Mastery" Perk Level
// [10032] "Archery Mastery EX" Perk Level
// [10033] "Soul Mastery" Perk Level
// [10034] "Soul Mastery EX" Perk Level
// [10035] "Martial Arts Mastery" Perk Level
// [10036] "Martial Arts Mastery EX" Perk Level
// [10037] "Mortal Hit Survivability Psyche Up" Perk Level
// [10038] "Mortal Hit Survivability Psyche Up EX" Perk Level
// [10039] "Mortal Hit Survivability Mana Recovery" Perk Level
// [10040] "Mortal Hit Survivability Mana Recovery EX" Perk Level
// [10041] "Mortal Hit Survivability Blast Wave" Perk Level
// [10042] "Mortal Hit Survivability Blast Wave EX" Perk Level
// [10043] "Mortal Hit Survivability 'Death Rage'" Perk Level
// [10044] "Mortal Hit Survivability 'Death Rage' EX" Perk Level
// [10045] "On The Move" Perk Level
// [10046] "On The Move EX" Perk Level
// [10047] "Bottomless Magazines" Perk Level
// [10048] "Bottomless Magazines EX" Perk Level
// [10049] "Medical/Medicinal Prowess" Perk Level
// [10050] "Powerup Powerhouse" Perk Level
// [10051] "Berserker Fit" Perk Level
// [10052] "Berserker Fit EX" Perk Level
// [10053] "Wand/Staff Mastery" Perk Level
// [10054] "Wand/Staff Mastery EX" Perk Level
// [11001] "Higher Learning" Grand Mastery Perk Level

// Visual Stuff
script "INGAMEMENUS_DISPLAYS" ENTER
{
 int temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8, temp9, temp10, temp11, temp12, temp13, temp14, temp15, temp16, temp17, temp18, temp19, temp20;
 int temp21, temp22, temp23, temp24, temp25, temp26, temp27, temp28, temp29, temp30, temp31, temp32, temp33, temp34, temp35, temp36, temp37, temp38, temp39, temp40;
 int xtemp1, xtemp2, xtemp3, xtemp4, xtemp5, xtemp6, xtemp7, xtemp8, xtemp9, xtemp10, xtemp11, xtemp12, xtemp13, xtemp14, xtemp15, xtemp16, xtemp17, xtemp18, xtemp19, xtemp20;
 int xtemp21, xtemp22, xtemp23, xtemp24, xtemp25, xtemp26, xtemp27, xtemp28, xtemp29, xtemp30, xtemp31, xtemp32, xtemp33, xtemp34, xtemp35, xtemp36, xtemp37, xtemp38, xtemp39, xtemp40;
 int ytemp1, ytemp2, ytemp3, ytemp4, ytemp5, ytemp6, ytemp7, ytemp8, ytemp9, ytemp10, ytemp11, ytemp12, ytemp13, ytemp14, ytemp15, ytemp16, ytemp17, ytemp18, ytemp19, ytemp20;
 int ytemp21, ytemp22, ytemp23, ytemp24, ytemp25, ytemp26, ytemp27, ytemp28, ytemp29, ytemp30, ytemp31, ytemp32, ytemp33, ytemp34, ytemp35, ytemp36, ytemp37, ytemp38, ytemp39, ytemp40;
 int HealMin, HealMax, SpellCost, SpellCharges, SpellNo, LevelRequirement;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int PageNo = MenuSystemVars[5] + 1;
 str perkname;
 str perkdescript1, perkdescript2, perkdescript3, perkdescript4, perkdescript5;
 str textcolor = "";

 int HudXRange, HudYRange; 
 // MENU SYSTEM [HudMessage]
 //		1000-1399   - General Reserved for Menu System
 //		1400-1599	- SubSub Menu Level Range
 //		1600-1799	- Sub Menu Level Range
 //		1800-1998	- Main Menu Level Range
 //		1999 		- Background 1
 //		2000 		- Background 2

 if (MenuSystemVars[0] != 0) // Menu is On.
 {
  /*
  SetHudSize(1200,800,0);
  SetFont("FIGHT1");
  HudMessage(s:"A"; HUDMSG_ALPHA, 2000, 0, 600.0, 400.0, 0.03, 0.999);
  */

  SetHudSize(512,384,0);
  SetFont("BLACKBAR");
  HudMessage(s:"A"; HUDMSG_ALPHA, 1999, 0, 256.0, 192.0, 0.03, 0.8333);
  SetFont("DVDSSMLFONT");
  SetHudSize(0,0,0);

  HudXRange = 800;
  HudYRange = 600;
  SetHudSize(HudXRange,HudYRange,0);
  // Main Menu
  SetFont("DVDSBIGFONT"); // DQHUDFONTSML // Default Font setting for all menus
  if (MenuSystemVars[4] == 0)
  {
   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange * 35000 / 100000) * 1.0; // 0.35;
   if (MenuSystemVars[1] == 1) HudMessage(s:"STATS [UNFINISHED]";  HUDMSG_ALPHA,  1998, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                          else HudMessage(s:"STATS [UNFINISHED]";  HUDMSG_ALPHA,  1998, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);   

   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange * 45000 / 100000) * 1.0; // 0.45;
   if (MenuSystemVars[1] == 2) HudMessage(s:"SPELLS"; HUDMSG_ALPHA,  1997, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                          else HudMessage(s:"SPELLS"; HUDMSG_ALPHA,  1997, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);

   if (GetCVar("dvdsperks_active") == 1) 
   {
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 55000 / 100000) * 1.0; // 0.55;
    if (MenuSystemVars[1] == 3) HudMessage(s:"PERKS";  HUDMSG_ALPHA,  1996, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0); 
                           else HudMessage(s:"PERKS";  HUDMSG_ALPHA,  1996, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);
   }

   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange * 65000 / 100000) * 1.0; // 0.65;
   if (GetCVar("dvdsperks_active") == 0) ytemp1 = (HudYRange * 55000 / 100000) * 1.0; // 0.65;
   if (MenuSystemVars[1] == 4) HudMessage(s:"CODEX [UNFINISHED]";  HUDMSG_ALPHA,  1995, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                          else HudMessage(s:"CODEX [UNFINISHED]";  HUDMSG_ALPHA,  1995, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);
  }

  
  
  
  //******************
  //******************
  //*** Stats Menu ***
  //******************
  //******************
  if (MenuSystemVars[4] == 1)
  {
   HudXRange = 720;
   HudYRange = 540;
   SetHudSize(HudXRange,HudYRange,0);
   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange *  3125 / 100000) * 1.0; // 0.03125;
   HudMessage(s:"STATS";  HUDMSG_ALPHA,  1998, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
   SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
  }

  
  
  
  
  //*******************
  //*******************
  //*** Spells Menu ***
  //*******************
  //*******************
  if (MenuSystemVars[4] == 2)
  {
   HudXRange = 720;
   HudYRange = 540;
   SetHudSize(HudXRange,HudYRange,0);
   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange *  3125 / 100000) * 1.0; // 0.03125;
   HudMessage(s:"SPELLS - PAGE ",d:PageNo;  HUDMSG_ALPHA,  1998, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
   SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS

   if (MenuSystemVars[5] == 0)
   {
    // Minor Magic Missile [Level 0]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 0;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIMAM1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 0;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Minor Healing [Level 0]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 0;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIHEA1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 1;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
     HealMin = GetHealingValue(0,0); // Minor [Min] 
     HealMax = GetHealingValue(0,1); // Minor [Max] 
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthTrue,s:" [100%]",
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}


    // Minor Night Vision [Level 1]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 1;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLINGV1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 2;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Chill Touch [Level 1]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 1;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLICHL1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 3;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Minor Invisiblity [Level 2]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 2;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVS1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 4;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Minor Flight [Level 2]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 2;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIFLI1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 5;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 1)
	{
     // Minor Poison Cloud [Level 3]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 3;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIPSC1");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 6;
     SpellCost = SpellCostCheck(SpellNo);
 	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

    // Minor Fireball [Level 4]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 4;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIFBL1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 7;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Enhanced Strength [Level 5]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 5;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIENST");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 8;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
   }

   if (MenuSystemVars[5] == 1)
   {
    // Minor Ice Blast [Level 6]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 6;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIICB1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 9;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Summon Weak Monster [Level 7]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 7;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLISUM1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 10;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Magic Missile [Level 7]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 7;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIMAM2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 11;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	            HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Fireball [Level 8]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 8;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIFBL2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 12;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	            HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Explosive Glyph [Level 9]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 9;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIGLY1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 13;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	            HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Healing [Level 9]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 9;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIHEA2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 14;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
     HealMin = GetHealingValue(1,0); // Normal [Min] 
     HealMax = GetHealingValue(1,1); // Normal [Max] 
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthTrue,s:" [100%]",
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0 && CharacterClass != 9)
	{
	 // Fireball Nova [Level 10]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 10;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLINVFR");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 15;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}
	
	if (CharacterClass == 9)
	{
	 // Desperado Damsel [Level 10]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 10;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIDEDA");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 58;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	// Minor Stealth [Level 11]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 11;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLISTL1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 16;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Minor Invulnerability [Level 11]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 11;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVN1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 17;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
   }

   if (MenuSystemVars[5] == 2)
   {
	// Invisiblity [Level 11]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 11;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVS2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 18;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Acid Rain [Level 12]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 12;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIACRA");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 19;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	            HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0)
	{
 	 // Freezing Glyph [Level 12]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 12;
  	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIGLY2");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 20;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	// Night Vision [Level 13]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 13;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLINGV2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 21;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Flight [Level 13]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 13;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIFLI2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 22;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0)
	{
	 // Major Magic Missile [Level 14]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 14;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIMAM3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 23;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	// Summon Monster [Level 15]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 15;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLISUM2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 24;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Icy Nova [Level 16]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 16;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLINVIC");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 25;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 1)
	{
	 // Poison Cloud [Level 16]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 16;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIPSC2");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 26;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}
   }

   if (MenuSystemVars[5] == 3)
   {
	// Minor Lightning [Level 17]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 17;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLILGN1");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 27;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 2)
	{
	 // Stone Skin / ? [Level 18]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 18;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISTSK");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 28;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
	 // Major Healing [Level 18]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 18;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIHEA3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 29;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      SpellCost = SpellCostCheck(SpellNo);
	  SpellCharges = CurrentMana / SpellCost;
      HealMin = GetHealingValue(2,0); // Major [Min] 
      HealMax = GetHealingValue(2,1); // Major [Max] 
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:"Heals ",d:HealMin,s:"-",d:HealMax,s:" health points up to ",d:MaxHealthLimit,s:" [200%]",
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
	 // Major Night Vision [Level 19]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 19;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLINGV3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 30;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	// Ice Blast [Level 20]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 20;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIICB2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 31;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	// Farsight [Level 20]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 20;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIFARS");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 32;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0)
	{
	 // Lightning Nova [Level 20]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 20;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLINVLG");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 33;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
	 // Stealth [Level 21]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 21;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISTL2");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 34;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	// Invulnerablity [Level 21]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 21;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVN2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 35;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
   }

   
   // Spells - Page 4
   if (MenuSystemVars[5] == 4)
   {
	if (CharacterClass != 0)
	{
	 // Major Invisiblity [Level 21]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 21;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVS3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 36;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
	 // Major Flight [Level 21]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 21;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIFLI3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 37;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

    // Lightning [Level 22]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 22;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLILGN2");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 38;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Summon Strong Monster [Level 23]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 23;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLISUM3");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 39;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

    // Diamond Skin / Spreader Aura Lv. 1 [Level 24]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 24;
	if (PlayerLevel >= LevelRequirement) { if (CharacterClass == 2) { SetFont("SPLISRA1"); } else { SetFont("SPLIDISK"); } }
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 40;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
	 if (CharacterClass == 2)
	 {
      HudMessage(s:"\cfSpreader Aura Lv. 1\c-",s:" - ",s:"Allows You to Create 2 Extra Copies of Most Attacks/Spells.", 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0)
	{
     // Major Fireball [Level 25]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 25;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIFBL3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 41;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
     // Major Ice Blast [Level 25]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 25;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIICB3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 42;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 1)
	{
     // Major Poison Cloud [Level 25]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 25;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIPSC3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 43;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
     // Major Lightning [Level 25]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 25;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLILGN3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 44;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}
   }

   if (MenuSystemVars[5] == 5)
   {
	if (CharacterClass != 0)
	{
     // Major Invulnerability [Level 26]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 26;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIIVN3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 45;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
     // Major Stealth [Level 26]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 26;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISTL3");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 46;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

    // Raging Spirits [Level 27]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 27;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIRASP");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 47;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1985, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}

	if (CharacterClass != 0)
	{
     // Summon Archvile [Level 28]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 28;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISUM4");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 48;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1984, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass == 2)
	{
     // Ultra Magic Missile [Level 29]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 29;
 	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIMAM4");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 49;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1983, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 0)
	{
     // Time Freezer [Level 30]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 30;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLITMFR");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 50;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1982, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 1)
	{
     // Terrorization Aura [Level 30]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 30;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLIFRAR");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 51;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1981, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass != 2)
	{
     // Create Lotso Ammo / ? [Level 30]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 30;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLICRLA");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	 SpellNo = 52;
     SpellCost = SpellCostCheck(SpellNo);
	 SpellCharges = CurrentMana / SpellCost;
	 if (PlayerLevel >= LevelRequirement)
	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1980, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

    // Divine Avatar [Level 31]
    xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
    ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    LevelRequirement = 31;
	if (PlayerLevel >= LevelRequirement) SetFont("SPLIDVAV");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
	SpellNo = 53;
    SpellCost = SpellCostCheck(SpellNo);
	SpellCharges = CurrentMana / SpellCost;
	if (PlayerLevel >= LevelRequirement)
	{
     HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	            s:"\n", 
	            s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	            HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
     HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	              HUDMSG_ALPHA,  1979, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	}
   }

   if (MenuSystemVars[5] == 6)
   {
	if (CharacterClass != 0)
	{
	 // Summon Cyberdemon [Level 31]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 10000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 31;
	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISUM5");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1997, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
 	 SpellNo = 54;
     SpellCost = SpellCostCheck(SpellNo);
 	 SpellCharges = CurrentMana / SpellCost;
  	 if (PlayerLevel >= LevelRequirement)
 	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1987, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}

	if (CharacterClass == 2)
	{
	 // Spreader Aura. Lv 2 [Level 56]
     xtemp2 = (HudXRange * 0 / 100000) * 1.0; // -0.10;
     ytemp2 = (HudYRange * 20000 / 100000) * 1.0; // 0.1625;
     SetFont("SPLIUNKN");
     LevelRequirement = 56;
 	 if (PlayerLevel >= LevelRequirement) SetFont("SPLISRA2");
     HudMessage(s:"A"; HUDMSG_ALPHA,  1996, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
     SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 += (HudXRange * 5000 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 -= (HudXRange * 1250 / 100000) * 1.0; // -0.10;
 	 SpellNo = 55;
     SpellCost = SpellCostCheck(SpellNo);
 	 SpellCharges = CurrentMana / SpellCost;
  	 if (PlayerLevel >= LevelRequirement)
 	 {
      HudMessage(s:SpellTable[SpellNo],s:" - ",s:SpellDesc[SpellNo], 
	             s:"\n", 
	             s:"\nCost: [",d:SpellCost,s:"] (Uses: ",d:SpellCharges,s:")"; 
	             HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
      HudMessage(s:"(Unknown Spell - Learned at Level ",d:LevelRequirement,s:")";
	               HUDMSG_ALPHA,  1986, CR_WHITE,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	}
/*
    ytemp2 = (HudYRange * 30000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1995, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 40000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1994, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 50000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1993, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 60000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1992, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 70000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1991, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 80000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1990, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);

    ytemp2 = (HudYRange * 90000 / 100000) * 1.0; // 0.1625;
    SetFont("SPLIUNKN");
    HudMessage(s:"A"; HUDMSG_ALPHA,  1989, CR_UNTRANSLATED,  xtemp2, ytemp2, 0.03, 1.0);
*/
   }

  }




  //******************
  //******************
  //*** Perks Menu ***
  //******************
  //******************
  if (MenuSystemVars[4] == 3)
  {
   HudXRange = 720;
   HudYRange = 540;
   SetHudSize(HudXRange,HudYRange,0);
   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange *  3125 / 100000) * 1.0; // 0.03125;
   HudMessage(s:"PERKS - PAGE ",d:PageNo;  HUDMSG_ALPHA,  1998, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
   //********************************************
   // First Page - All-Character Stat Perks
   //********************************************
   if (MenuSystemVars[5] == 0) // [10]
   {
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
      ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.08125;
	  HudMessage(s:"Stat Perks [All]";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);

	  // Selection #1
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 16250 / 100000) * 1.0; // 0.1625;
      perkname = "LIFE UP";
	  temp4 = 10001; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 5.0;
	  temp2 = MiscellaneousVars[temp4] * 7.5;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-HP INCREASED BY \cd",f:temp1,s:"%\c- AND DEFENSE INCREASED BY \cd",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "MAGI UP";
	  temp4 = 10003; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 5.0;
	  temp2 = MiscellaneousVars[temp4] * 7.5;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-MP INCREASED BY \cd",f:temp1,s:"%\c- AND MAG-DMG INCREASED BY \cd",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #3
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "STAM UP";
	  temp4 = 10005; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 5.0;
	  temp2 = MiscellaneousVars[temp4] * 7.5;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-STAMINA INCREASED BY \cd",f:temp1,s:"%\c- AND MELEE DAMAGE INCREASED BY \cd",f:temp2,s:"%\c-",
			     s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #4
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "DODGE MORE";
	  temp4 = 10007; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 2.5;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 4) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES EVASION CHANCE BY \cd",f:temp1,s:"%\c-",
			     s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #5
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "JUMP MORE";
	  temp4 = 10009; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 5.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 5) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES JUMP STRENGTH BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1993, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #6
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "PSYCHE FAST";
	  temp4 = 10011; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 7.5;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 15 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 6) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES PSYCHE-UP SPEED BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1992, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #7
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "REGEN HP FAST";
	  temp4 = 10013; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 20.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 6 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 9 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 12 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 18 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 24 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 7) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - HP REGEN SPD \cd+",f:temp1,s:"%\c- AND HP DEGEN SPD \cd-",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1991, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #8
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "REGEN MP FAST";
	  temp4 = 10015; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 20.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 6 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 9 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 12 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 18 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 24 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 8) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MP REGEN SPD \cd+",f:temp1,s:"%\c- AND MP DEGEN SPD \cd-",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1990, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #9
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "REGEN STAM FAST";
	  temp4 = 10017; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 20.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 6 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 9 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 12 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 18 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 24 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 9) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA REGEN SPD \cd+",f:temp1,s:"%\c- AND STAMINA DEGEN SPD \cd-",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	   
	  // Selection #10
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "ON THE MOVE";
	  temp4 = 10045; // MiscellaneousVars[]
	  if (MiscellaneousVars[temp4] == 0) temp1 = 0.000000000; else { temp1 = 1.000000000 + (MiscellaneousVars[temp4] * 1.500000000); }   
	  if (MiscellaneousVars[temp4] == 1) temp1 += (MiscellaneousVars[31] * 0.025000000);
	  if (MiscellaneousVars[temp4] == 2) temp1 += (MiscellaneousVars[31] * 0.031250000);
	  if (MiscellaneousVars[temp4] == 3) temp1 += (MiscellaneousVars[31] * 0.041666667);
	  if (MiscellaneousVars[temp4] == 4) temp1 += (MiscellaneousVars[31] * 0.062500000);
	  if (MiscellaneousVars[temp4] == 5) temp1 += (MiscellaneousVars[31] * 0.125000000);
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 6 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 10 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 13 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 17 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 5; // Max Levels
	  if (MenuSystemVars[1] == 10) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - EVASION CHANCE \cd+",f:temp1,s:"%\c- WHEN ACTIVELY MOVING.",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";
				 HUDMSG_ALPHA,  1988, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	   
	   
	   SetFont("STATAEON");
       xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
       ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	   HudMessage(s:"A";
				  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	   SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
       xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
       ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	   HudMessage(d:MiscellaneousVars[25];
				  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }
   //********************************************
   // Second Page - Character-Specfic Stat Perks
   //********************************************
   if (MenuSystemVars[5] == 1)
   {
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.038125;
    HudMessage(s:"Stat Perks [Character-Spectic]";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
    if (CharacterClass == 0) // Deggaris Only [3]
	{
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      // Selection #1
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 16250 / 100000) * 1.0; // 0.1625;
      perkname = "MAGI UP EX";
	  temp4 = 10004; // MiscellaneousVars[]
	  temp5 = 10003;
	  temp1 = MiscellaneousVars[temp4] * 12.5;
	  temp2 = MiscellaneousVars[temp4] * 18.75;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccMAGI UP \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccMAGI UP \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccMAGI UP \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccMAGI UP \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-MP INCREASED BY \cd",f:temp1,s:"%\c- AND MAG-DMG INCREASED BY \cd",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1997, CR_GOLD,  xtemp2, ytemp2, 0.03, 1.0);

				 
      // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "DODGE MORE EX";
	  temp4 = 10008; // MiscellaneousVars[]
	  temp5 = 10007;
	  temp1 = MiscellaneousVars[temp4] * 6.25;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccDODGE MORE \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccDODGE MORE \cv(2+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 1; // Max Levels
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES EVASION CHANCE BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #3
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "JUMP MORE EX";
	  temp4 = 10010; // MiscellaneousVars[]
	  temp5 = 10009;
	  temp1 = MiscellaneousVars[temp4] * 12.5;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccJUMP MORE \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccJUMP MORE \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccJUMP MORE \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccJUMP MORE \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES JUMP STRENGTH BY \cd",f:temp1,s:"%\c-",
			     s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
    if (CharacterClass == 1) // Illucia Only [3]
	{
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      // Selection #1
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 16250 / 100000) * 1.0; // 0.1625;
      perkname = "STAM UP EX";
	  temp4 = 10006; // MiscellaneousVars[]
	  temp5 = 10005;
	  temp1 = MiscellaneousVars[temp4] * 12.5;
	  temp2 = MiscellaneousVars[temp4] * 18.75;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccSTAM UP \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccSTAM UP \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccSTAM UP \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccSTAM UP \cv(4+)\cg]";
	  }
      temp11 = 2; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-STAMINA INCREASED BY \cd",f:temp1,s:"%\c- & AND MELEE DAMAGE INCREASED BY \cd",f:temp2,s:"%",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
				 HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "DODGE MORE EX";
	  temp4 = 10008; // MiscellaneousVars[]
	  temp5 = 10007;
	  temp1 = MiscellaneousVars[temp4] * 6.25;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccDODGE MORE \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccDODGE MORE \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccDODGE MORE \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccDODGE MORE \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES EVASION CHANCE BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #3
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "JUMP MORE EX";
	  temp4 = 10010; // MiscellaneousVars[]
	  temp5 = 10009;
	  temp1 = MiscellaneousVars[temp4] * 6.25;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccJUMP MORE \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccJUMP MORE \cv(2+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 1; // Max Levels
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES JUMP STRENGTH BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  
	}
	else
    if (CharacterClass == 2) // Flora Only [3]
	{
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      // Selection #1
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 16250 / 100000) * 1.0; // 0.1625;
      perkname = "LIFE UP EX";
	  temp4 = 10002; // MiscellaneousVars[]
	  temp5 = 10001;
	  temp1 = MiscellaneousVars[temp4] * 12.5;
	  temp2 = MiscellaneousVars[temp4] * 18.75;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccLIFE UP \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccLIFE UP \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccLIFE UP \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccLIFE UP \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-HP INCREASED BY \cd",f:temp1,s:"%\c- AND DEFENSE INCREASED BY \cd",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
				 HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

				  
      // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "PSYCHE FAST EX";
	  temp4 = 10012; // MiscellaneousVars[]
	  temp5 = 10011;
	  temp1 = MiscellaneousVars[temp4] * 18.75;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccPSYCHE FAST \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccPSYCHE FAST \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccPSYCHE FAST \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccPSYCHE FAST \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
      temp11 = 2; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES PSYCHE-UP SPEED BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

				 
      // Selection #3
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "STAM UP EX";
	  temp4 = 10006; // MiscellaneousVars[]
	  temp5 = 10005;
	  temp1 = MiscellaneousVars[temp4] * 12.5;
	  temp2 = MiscellaneousVars[temp4] * 18.75;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccSTAM UP \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccSTAM UP \cv(2+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
      temp11 = 1; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 11 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - MAX-STAMINA INCREASED BY \cd",f:temp1,s:"%\c- & AND MELEE DAMAGE INCREASED BY \cd",f:temp2,s:"%",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
				 HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	}

	SetFont("STATAEON");
    xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(s:"A";
			  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
    xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(d:MiscellaneousVars[25];
			  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }
   //********************************************
   // Third Page - Weapon Perks
   //********************************************
   if (MenuSystemVars[5] == 2)
   {
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.038125;
    HudMessage(s:"Weapon Perks";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);

    if (CharacterClass == 0 | CharacterClass == 1) // Deggaris & Illucia Both [6 Shared]
	{
     // Selection #1
     xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 = (HudYRange * 15000 / 100000) * 1.0 + 0.1; // -0.15;
     perkname = "BERSERKER FIT";
	 temp4 = 10051; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 4.0;
	 if (MiscellaneousVars[temp4] == 0) temp2 = 0.0;
	 if (MiscellaneousVars[temp4] == 1) temp2 = 5.0;
	 if (MiscellaneousVars[temp4] == 2) temp2 = 12.5;
	 if (MiscellaneousVars[temp4] == 3) temp2 = 17.5;
	 if (MiscellaneousVars[temp4] == 4) temp2 = 30.0;
	 if (MiscellaneousVars[temp4] == 5) temp2 = 60.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 10 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 15 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 20 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 25 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 35 * MiscellaneousVars[280] / 100;
     if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - \cd+",f:temp1,s:"%\c- CRITICAL HIT CHANCE WHEN MELEE WEAPONS ARE EQUIPPED",
			    s:"\nSTAMINA CONSUMPTION FOR MELEE ATTACKS REDUCED BY \cd",f:temp2,s:"%\c-",  
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);


     // Selection #2
     ytemp2 += (HudYRange * 8750 / 100000) * 1.0; // 0.075;
     perkname = "BULLET ACCURACY";
	 temp4 = 10019; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 10.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 6 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 10 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 14 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 19 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF BULLET WEAPONS BY \cd",f:temp1,s:"%\c-",
		  	    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

     // Selection #3
     ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
     perkname = "PELLET ACCURACY";
	 temp4 = 10021; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 10.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 6 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 10 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 14 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 19 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF PELLET WEAPONS BY \cd",f:temp1,s:"%\c-",
		  	    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

     // Selection #4
     ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
     perkname = "PLASMA ACCURACY";
	 temp4 = 10023; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 10.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 6 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 10 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 14 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 19 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 4) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF PLASMA-WEAPONS FIRE BY \cd",f:temp1,s:"%\c-",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

     // Selection #5
     ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
     perkname = "DEMOLITIONS EXPERT";
	 temp4 = 10025; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 7.0;
	 temp2 = MiscellaneousVars[temp4] * 14.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 3 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 6 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 10 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 14 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 19 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 5) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - EXPLOSIVE DAMAGE DEALT \cd+",f:temp1,s:" - ",f:temp2,s:"%\c- & EXPLOSIVE DAMAGE TAKEN \cd-",f:temp1,s:" - ",f:temp2,s:"%\c-",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1993, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

     // Selection #6
     ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
     perkname = "BOTTOMLESS MAGAZINES";
	 temp4 = 10047; // MiscellaneousVars[]
	 temp1 = MiscellaneousVars[temp4] * 10.0;
	 temp3 = 0; // Cost for next level.
     temp11 = 5; // Max Levels
	 if (MiscellaneousVars[temp4] == 0) temp3 = 5 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 9 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 14 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 20 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 28 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 6) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES CHANCES OF NOT CONSUMING AMMO BY \cd",f:temp1,s:"%\c-",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1992, textcolor,  xtemp2, ytemp2, 0.03, 1.0);


     if (CharacterClass == 0) // Deggaris Only [3, 9 total]
	 {
      // Selection #7
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "BULLET ACCURACY EX";
	  temp4 = 10020; // MiscellaneousVars[]
	  temp5 = 10019;
	  temp1 = MiscellaneousVars[temp4] * 15.0;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccBULLET ACCURACY \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccBULLET ACCURACY \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccBULLET ACCURACY \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccBULLET ACCURACY \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 4 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 7) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF BULLET WEAPONS BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
			     HUDMSG_ALPHA,  1991, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

				  
      // Selection #8
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "DEMOLITIONS EXPERT EX";
	  temp4 = 10026; // MiscellaneousVars[]
	  temp5 = 10025;
	  temp1 = MiscellaneousVars[temp4] * 11.0;
	  temp2 = MiscellaneousVars[temp4] * 22.0;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccDEMOLITIONS EXPERT \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccDEMOLITIONS EXPERT \cv(2+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 4 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 1; // Max Levels
	  if (MenuSystemVars[1] == 8) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - EXPLOSIVE DAMAGE DEALT \cd+",f:temp1,s:" - ",f:temp2,s:"%\c- & EXPLOSIVE DAMAGE TAKEN \cd-",f:temp1,s:" - ",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
			     HUDMSG_ALPHA,  1990, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #9
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "BFG ATTUNEMENT";
	  temp4 = 10029; // MiscellaneousVars[]
      temp11 = 2; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 24 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 43 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 9) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  if (MiscellaneousVars[temp4] == 0)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT BFG 9000 TRAITS...",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  else
	  if (MiscellaneousVars[temp4] == 1)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - BFG DAMAGE INCREASED SOMEWHAT.",
			       s:"\nREDUCES THE COST OF BFG SHOTS FROM \cd40\c- CELLS TO \cd32\c- CELLS",  
			       s:"\nBFG WILL EMIT \cd48\c- TRACERS INSTEAD OF \cd40\c- ON DETONATION.",  
			       s:"\nBFG FIRING SPEED \cd+20%\c-.",  
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  else
	  if (MiscellaneousVars[temp4] == 2)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - BFG DAMAGE INCREASED GREATLY.",
			       s:"\nREDUCES THE COST OF BFG SHOTS FROM \cd40\c- CELLS TO \cd24\c- CELLS",  
			       s:"\nBFG WILL EMIT \cd56\c- TRACERS INSTEAD OF \cd40\c- ON DETONATION.",  
			       s:"\nBFG FIRING SPEED \cd+40%\c-.",  
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	 }

     if (CharacterClass == 1) // Illucia Only [3, 9 total]
	 {
      // Selection #7
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "PELLET ACCURACY EX";
	  temp4 = 10022; // MiscellaneousVars[]
	  temp5 = 10021;
	  temp1 = MiscellaneousVars[temp4] * 15.0;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccPELLET ACCURACY \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccPELLET ACCURACY \cv(2+)\cg]";
	  }
      if (MiscellaneousVars[temp4] == 1)
	  {
	   if (MiscellaneousVars[temp5] >= 4) perkdescript1 = " \cd[REQUIRES \ccPELLET ACCURACY \cv(4+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccPELLET ACCURACY \cv(4+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 4 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 2; // Max Levels
	  if (MenuSystemVars[1] == 7) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF PELLET WEAPONS BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
			     HUDMSG_ALPHA,  1991, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #8
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "PLASMA ACCURACY EX";
	  temp4 = 10024; // MiscellaneousVars[]
	  temp5 = 10023;
	  temp1 = MiscellaneousVars[temp4] * 15.0;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 2) perkdescript1 = " \cd[REQUIRES \ccPLASMA ACCURACY \cv(2+)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccPLASMA ACCURACY \cv(2+)\cg]";
	  }
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 4 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
      temp11 = 1; // Max Levels
	  if (MenuSystemVars[1] == 8) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - REDUCES SPREAD OF PLASMA-WEAPONS FIRE BY \cd",f:temp1,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;
			     HUDMSG_ALPHA,  1990, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

      // Selection #9
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "KARASAWA ATTUNEMENT";
	  temp4 = 10027; // MiscellaneousVars[]
      temp11 = 2; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 24 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 43 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 9) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }

	  if (MiscellaneousVars[temp4] == 0)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT KAWASAWA TRAITS...",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  else
	  if (MiscellaneousVars[temp4] == 1)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - KAWASAWA SHOTS BECOMES \cD12.5%\c- SLOWER.",
			       s:"\nKAWASAWA SHOTS WILL DEAL \cd25%\c- MORE DAMAGE.",  
			       s:"\nKAWASAWA SHOTS CONSUME \cd6\c- CELLS INSTEAD OF \cd8\c-.",  
			       s:"\nKAWASAWA FIRING SPEED \cd+20%\c-.",  
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  else
	  if (MiscellaneousVars[temp4] == 2)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - KAWASAWA SHOTS BECOMES \cD25%\c- SLOWER.",
			       s:"\nKAWASAWA SHOTS WILL DEAL \cd50%\c- MORE DAMAGE.",  
			       s:"\nKAWASAWA SHOTS CONSUME \cd4\c- CELLS INSTEAD OF \cd6\c-.",  
			       s:"\nKAWASAWA FIRING SPEED \cd+40%\c-.",  
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1989, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	 }
	}
	else
    if (CharacterClass == 2) // Flora [4, 4 total]
	{
	  // Selection #1
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 15000 / 100000) * 1.0 + 0.1; // -0.15;
      perkname = "ARCHERY MASTERY";
	  temp4 = 10031; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 6.0;
	  temp2 = MiscellaneousVars[temp4] * 6.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 10 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 23 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 31 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - ARROW DAMAGE \cd+",f:temp1,s:"%\c- AND ARROW SPEED \cd+",f:temp2,s:"%\c-",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "WAND/STAFF MASTERY";
	  temp4 = 10053; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 10.0;
	  temp2 = MiscellaneousVars[temp4] * 6.25;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 10 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 23 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 31 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - DAMAGE WITH MAGICAL WANDS/STAVES INCREASED BY \cd",f:temp1,s:"%\c-",
	             s:"\nMAGICAL DAMAGE DEALT INCREASED BY \cd",f:temp2,s:"%\c-.",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #3
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "SOUL MASTERY";
	  temp4 = 10033; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 10.0;
	  temp2 = MiscellaneousVars[temp4] * 6.25;
	  temp21 = MiscellaneousVars[temp4] * 3.75;
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 10 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 23 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 31 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - HELLCORE DAMAGE INCREASED BY \cd",f:temp1,s:"%\c-.",
	             s:"\nHELLCORE HEATING RATIO DECREASED BY \cd",f:temp2,s:"%\c-.",
			     s:"\nHELLCORE OVERHEAT DAMAGE DECREASED BY \cd",f:temp21,s:"%\c-.",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	  // Selection #4
      ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
      perkname = "MARTIAL ARTS MASTERY";
	  temp4 = 10035; // MiscellaneousVars[]
	  temp3 = 0; // Cost for next level.
      temp11 = 5; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 8 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 12 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 19 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 31 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 51 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 4) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }

	  if (MiscellaneousVars[temp4] == 0)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL INCREASE FLORA'S MARTIAL ARTS/MELEE CAPABILITIES.",
	 	 		  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 1)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA CONSUMED FROM NON-SCEPTRE MELEE ATTACKS \cd-5%\c-.",
	              s:"\nNON-SCEPTRE MELEE DAMAGE INCREASED BY \cd2.5%\c-.",
	              s:"\nAOE DAMAGE FROM NON-SCEPTRE MELEE ATTACKS INCREASED BY \cd7.5%\c-.",
	              s:"\nPUNCHES/KICKS/UPPERCUTS HAVE A \cd12.5%\c- CHANCE TO \cdDESTROY PROJECTILES\c-.",
	 			  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 2)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA CONSUMED FROM NON-SCEPTRE MELEE ATTACKS \cd-10%\c-.",
	              s:"\nNON-SCEPTRE MELEE DAMAGE INCREASED BY \cd7.5%\c-.",
	              s:"\nAOE DAMAGE FROM NON-SCEPTRE MELEE ATTACKS INCREASED BY \cd22.5%\c-.",
	              s:"\nPUNCHES/KICKS/UPPERCUTS HAVE A \cd25%\c- CHANCE TO \cdDESTROY PROJECTILES\c-.",
	              s:"\nPUNCHES ARE \cd~1.3X\c- FASTER\c-",
	 			  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 3)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA CONSUMED FROM NON-SCEPTRE MELEE ATTACKS \cd-17.5%\c-.",
	              s:"\nNON-SCEPTRE MELEE DAMAGE INCREASED BY \cd17.5%\c-.",
	              s:"\nAOE DAMAGE FROM NON-SCEPTRE MELEE ATTACKS INCREASED BY \cd52.5%\c-.",
	              s:"\nPUNCHES/KICKS/UPPERCUTS HAVE A \cd50%\c- CHANCE TO \cdDESTROY PROJECTILES\c-.",
	              s:"\nPUNCHES ARE \cd~1.6X\c- FASTER\c-",
	              s:"\nUPPERCUTS ARE \cd~2.1X\c- FASTER\c-",
	              s:"\nKICKS ARE \cd~2.1X\c- FASTER\c-",
	 			  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 4)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA CONSUMED FROM NON-SCEPTRE MELEE ATTACKS \cd-30%\c-.",
	              s:"\nNON-SCEPTRE MELEE DAMAGE INCREASED BY \cd37.5%\c-.",
	              s:"\nAOE DAMAGE FROM NON-SCEPTRE MELEE ATTACKS INCREASED BY \cd112.5%\c-.",
	              s:"\nREDUCES DAMAGE RECEIEVED DURING NON-SCEPTRE MELEE ATTACKS BY \cd20%\c-.",
	              s:"\nPUNCHES/KICKS/UPPERCUTS \cdALWAYS\c- \cdDESTROY PROJECTILES\c-.",
	              s:"\nPUNCHES ARE \cd~2.6X\c- FASTER\c-",
	              s:"\nUPPERCUTS ARE \cd~2.1X\c- FASTER\c-",
	              s:"\nKICKS ARE \cd~2.1X\c- FASTER\c-",
				  s:"\nNON-SCEPTRE MELEE ATTACKS SLOW DOWN TENSION COUNTDOWN TIMER BY \cd10-20%\c-.",
	 			  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 5)
	  {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - STAMINA CONSUMED FROM NON-SCEPTRE MELEE ATTACKS \cd-60%\c-.",
	              s:"\nNON-SCEPTRE MELEE DAMAGE INCREASED BY \cd112.5%\c-.",
	              s:"\nAOE DAMAGE FROM NON-SCEPTRE MELEE ATTACKS INCREASED BY \cd337.5%\c-.",
	              s:"\nREDUCES DAMAGE RECEIEVED DURING NON-SCEPTRE MELEE ATTACKS BY \cd50%\c-.",
	              s:"\nPUNCHES/KICKS/UPPERCUTS \cdALWAYS\c- \cdDESTROY PROJECTILES\c-.",
	              s:"\nPUNCHES ARE \cd~4.3X\c- FASTER\c-",
	              s:"\nUPPERCUTS ARE \cd~3.8X\c- FASTER\c-",
	              s:"\nKICKS ARE \cd~5X\c- FASTER\c-",
				  s:"\nNON-SCEPTRE MELEE ATTACKS SLOW DOWN TENSION COUNTDOWN TIMER BY \cd40-60%\c-.",
	 			  s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
		 	 	  HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	}

	
	SetFont("STATAEON");
    xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(s:"A";
			  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
    xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(d:MiscellaneousVars[25];
			  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }
   //********************************************
   // Fourth Page - Item Perks
   //********************************************
   if (MenuSystemVars[5] == 3)
   {
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.038125;
    HudMessage(s:"Item/Powerup Perks";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
	
	  // Selection #1
	  SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
      xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
      ytemp2 = (HudYRange * 16250 / 100000) * 1.0; // 0.1625;
      perkname = "MEDICAL PROWESS";
      if (CharacterClass == 0 | CharacterClass == 1) perkname = "MEDICAL PROWESS";
      if (CharacterClass == 2) perkname = "MEDICINAL PROWESS";
	  temp4 = 10049; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 12.5;
	  temp2 = 100.0 + (MiscellaneousVars[temp4] * 12.5);
	  temp5 = MiscellaneousVars[temp4] * 6.25;
	  temp6 = 100.0 + (MiscellaneousVars[temp4] * 6.25);
      temp11 = 5; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 5 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 9 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 14 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 22 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 4) temp3 = 29 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  if (CharacterClass == 2)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES HEALING FROM HERBS/MAGIC-WATERS BY \cd",f:temp1,s:"%\c- UP TO \cd",f:temp2,s:"%\c-",
				   s:"\nINCREASES HEALING FROM MEDICIAL ITEMS BY \cd",f:temp5,s:"%\c- UP TO \cd",f:temp6,s:"%\c-",
				   s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				   HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  else
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - INCREASES HEALING FROM MEDICIAL ITEMS BY \cd",f:temp1,s:"%\c- UP TO \cd",f:temp2,s:"%\c-",
				   s:"\nINCREASES HEALING FROM HERBS/MAGIC-WATERS BY \cd",f:temp5,s:"%\c- UP TO \cd",f:temp6,s:"%\c-",
				   s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				   HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }

	  // Selection #2
      ytemp2 += (HudYRange * 7500 / 100000) * 1.0; // 0.075;
      perkname = "POWERUP POWERHOUSE";
	  temp4 = 10050; // MiscellaneousVars[]
	  temp1 = MiscellaneousVars[temp4] * 25.0;
	  temp3 = 0; // Cost for next level.
      temp11 = 4; // Max Levels
	  if (MiscellaneousVars[temp4] == 0) temp3 = 7 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 16 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 27 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 3) temp3 = 40 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - POWERUP ITEMS/ARTIFACTS GIVE \cd+",f:temp1,s:"%\c- MORE DURATION",
				 s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
				 HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	SetFont("STATAEON");
    xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(s:"A";
			  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
    xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(d:MiscellaneousVars[25];
			  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }
   //********************************************
   // Fifth Page - Misc Perks
   //********************************************
   if (MenuSystemVars[5] == 4)
   {
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.038125;
    HudMessage(s:"Misc Perks";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);
    if (CharacterClass == 0 | CharacterClass == 1) // Deggaris & Illucia Both (3)
	{
	 // Selection #1
	 SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 = (HudYRange * 15000 / 100000) * 1.0 + 0.1; // -0.15;
     perkname = "MORTAL HIT BLAST WAVE";
	 temp4 = 10041; // MiscellaneousVars[]
     temp11 = 1; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 15 * MiscellaneousVars[280] / 100;
     if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 50% TO BLAST AWAY NEARBY ENEMIES & PROJECTILES AFTER SURVIVING A MORTAL HIT",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	 // Selection #2
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "MORTAL HIT MANA RECOVERY";
	 temp4 = 10039; // MiscellaneousVars[]
     temp11 = 1; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 15 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 66.6% CHANCE TO RECOVER 25% OF MAXIMUM MP [UP TO 125% OF MAX] AFTER SURVIVING A MORTAL HIT",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 	 
 	 // Selection #3
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     if (CharacterClass == 0) // Deggaris Only (1)
	 {
      perkname = "MORTAL HIT DEATH RAGE";
	  temp4 = 10043; // MiscellaneousVars[]
	  temp1 = 0.0;
	  if (MiscellaneousVars[temp4] == 1) temp1 = 12.5;
	  if (MiscellaneousVars[temp4] == 2) temp1 = 20.0;
	  if (MiscellaneousVars[temp4] == 3) temp1 = 25.0;
      temp11 = 3; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 20 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 1) temp3 = 30 * MiscellaneousVars[280] / 100;
	  if (MiscellaneousVars[temp4] == 2) temp3 = 50 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  if (MiscellaneousVars[temp4] == 0)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - CHANCE FOR INVULNERABLITY AND DAMAGE BOOST AFTER SURVIVING A MORTAL HIT",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 1)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 12.5% CHANCE FOR INVULNERABLITY AND DAMAGE BOOST AFTER SURVIVING A MORTAL HIT",
			       s:"\n\cf180 SECOND COOLDOWN TIME.",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 2)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 20% CHANCE FOR INVULNERABLITY AND DAMAGE BOOST AFTER SURVIVING A MORTAL HIT",
			       s:"\n\cf150 SECOND COOLDOWN TIME.",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	  if (MiscellaneousVars[temp4] == 3)
	  {
	    HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 25% CHANCE FOR INVULNERABLITY AND DAMAGE BOOST AFTER SURVIVING A MORTAL HIT",
			       s:"\n\cf120 SECOND COOLDOWN TIME.",
			       s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			       HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	  }
	 }
     if (CharacterClass == 1) // Illucia Only (1)
	 {
      perkname = "MORTAL HIT BLAST WAVE EX";
	  temp4 = 10042; // MiscellaneousVars[]
	  temp5 = 10041;
      perkdescript1 = "";
      if (MiscellaneousVars[temp4] == 0)
	  {
	   if (MiscellaneousVars[temp5] >= 1) perkdescript1 = " \cd[REQUIRES \ccMORTAL HIT BLAST WAVE \cv(1)\cd]";
	                                 else perkdescript1 = " \cg[REQUIRES \ccMORTAL HIT BLAST WAVE \cv(1)\cg]";
	  }
      temp11 = 1; // Max Levels
	  temp3 = 0; // Cost for next level.
	  if (MiscellaneousVars[temp4] == 0) temp3 = 35 * MiscellaneousVars[280] / 100;
	  if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	  if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	  HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - +25% TO BLAST AWAY NEARBY ENEMIES & PROJECTILES AFTER SURVIVING A MORTAL HIT",
			     s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;   
			     HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }

	 // Selection #4
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "MORTAL HIT PSYCHE UP";
	 temp4 = 10037; // MiscellaneousVars[]
     temp1 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp1 = 5;
	 if (MiscellaneousVars[temp4] == 2) temp1 = 20;
	 if (MiscellaneousVars[temp4] == 3) temp1 = 50;
	 if (MiscellaneousVars[temp4] == 4) temp1 = 100;
	 if (MiscellaneousVars[temp4] == 5) temp1 = 250;
	 if (MiscellaneousVars[temp4] == 6) temp1 = 500;
	 if (MiscellaneousVars[temp4] == 7) temp1 = 1000;
     temp11 = 7; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 9;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 12;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 16;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 20;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 28;
	 if (MiscellaneousVars[temp4] == 5) temp3 = 39;
	 if (MiscellaneousVars[temp4] == 6) temp3 = 57;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 4) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 if (MiscellaneousVars[temp4] == 0)
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT TENSION AFTER SURVIVING A MORTAL HIT",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 40% CHANCE TO HIT \c[Purple]'",d:temp1,s:"'\c- TENSION AFTER SURVIVING A MORTAL HIT",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }

	 // Selection #5
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "CLEARED OF MIND";
	 temp4 = 10055; // MiscellaneousVars[]
     temp1 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp1 = 4;
	 if (MiscellaneousVars[temp4] == 2) temp1 = 9;
	 if (MiscellaneousVars[temp4] == 3) temp1 = 15;
	 if (MiscellaneousVars[temp4] == 4) temp1 = 22;
	 if (MiscellaneousVars[temp4] == 5) temp1 = 30;
     temp7 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp7 = 2.5;
	 if (MiscellaneousVars[temp4] == 2) temp7 = 5.0;
	 if (MiscellaneousVars[temp4] == 3) temp7 = 7.5;
	 if (MiscellaneousVars[temp4] == 4) temp7 = 10.0;
	 if (MiscellaneousVars[temp4] == 5) temp7 = 12.5;
     temp8 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp8 = 2;
	 if (MiscellaneousVars[temp4] == 2) temp8 = 5;
	 if (MiscellaneousVars[temp4] == 3) temp8 = 7;
	 if (MiscellaneousVars[temp4] == 4) temp8 = 11;
	 if (MiscellaneousVars[temp4] == 5) temp8 = 13;
     temp9 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp9 = 3.75;
	 if (MiscellaneousVars[temp4] == 2) temp9 = 7.5;
	 if (MiscellaneousVars[temp4] == 3) temp9 = 11.25;
	 if (MiscellaneousVars[temp4] == 4) temp9 = 15.0;
	 if (MiscellaneousVars[temp4] == 5) temp9 = 18.75;
     temp11 = 5; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 8 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 12 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 16 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 20 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 24 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 5) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 if (MiscellaneousVars[temp4] == 0)
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT EXP GAINED, HP/MP/STAMINA REGEN & GENERAL DAMAGE DEALT.",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1993, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - +",d:temp1,s:"% MORE LEVEL EXP/EXPERIESSENCE-GAIN",
		          s:"\n\c-+",f:temp7,s:"% HP/MP/STAMINA REGENERATION SPEED.",
		          s:"\n\c--",d:temp8,s:"% MANA COST FOR SPELLS.",
		          s:"\n\c-+",f:temp9,s:"% GENERAL DAMAGE DEALT.",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1993, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }	 
	}
	else
    if (CharacterClass == 2) // Flora (3)
	{
	 // Selection #1
	 SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
     xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
     ytemp2 = (HudYRange * 15000 / 100000) * 1.0 + 0.1; // -0.15;
     perkname = "MORTAL HIT MANA RECOVERY";
	 temp4 = 10039; // MiscellaneousVars[]
     temp11 = 1; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 15 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 66.6% CHANCE TO RECOVER 25% OF MAXIMUM MP [UP TO 125% OF MAX] AFTER SURVIVING A MORTAL HIT",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	 // Selection #2
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "MORTAL HIT MANA RECOVERY EX";
	 temp4 = 10040; // MiscellaneousVars[]
	 temp5 = 10039;
     perkdescript1 = "";
     if (MiscellaneousVars[temp4] == 0)
	 {
	  if (MiscellaneousVars[temp5] >= 1) perkdescript1 = " \cd[REQUIRES \ccMORTAL HIT MANA RECOVERY \cv(1)\cd]";
	                                else perkdescript1 = " \cg[REQUIRES \ccMORTAL HIT MANA RECOVERY \cv(1)\cg]";
	 }
     temp11 = 1; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 35 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 2) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - +33.4% CHANCE TO RECOVER 50% OF MAXIMUM MP [UP TO 175% OF MAX] AFTER SURVIVING A MORTAL HIT",
			    s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS",s:perkdescript1;  
			    HUDMSG_ALPHA,  1996, textcolor,  xtemp2, ytemp2, 0.03, 1.0);

	 
	 // Selection #3
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "MORTAL HIT PSYCHE UP";
	 temp4 = 10037; // MiscellaneousVars[]
     temp1 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp1 = 5;
	 if (MiscellaneousVars[temp4] == 2) temp1 = 20;
	 if (MiscellaneousVars[temp4] == 3) temp1 = 50;
	 if (MiscellaneousVars[temp4] == 4) temp1 = 100;
	 if (MiscellaneousVars[temp4] == 5) temp1 = 250;
	 if (MiscellaneousVars[temp4] == 6) temp1 = 500;
	 if (MiscellaneousVars[temp4] == 7) temp1 = 1000;
     temp11 = 7; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 12 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 15 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 19 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 23 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 31 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 5) temp3 = 42 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 6) temp3 = 60 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 3) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 if (MiscellaneousVars[temp4] == 0)
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT TENSION AFTER SURVIVING A MORTAL HIT",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - 75% CHANCE TO HIT \c[Purple]'",d:temp1,s:"'\c- TENSION AFTER SURVIVING A MORTAL HIT",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1995, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }	 
	
	 // Selection #4
     ytemp2 += (HudYRange * 11250 / 100000) * 1.0; // 0.1125;
     perkname = "CLEARED OF MIND";
	 temp4 = 10055; // MiscellaneousVars[]
     temp1 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp1 = 4;
	 if (MiscellaneousVars[temp4] == 2) temp1 = 9;
	 if (MiscellaneousVars[temp4] == 3) temp1 = 15;
	 if (MiscellaneousVars[temp4] == 4) temp1 = 22;
	 if (MiscellaneousVars[temp4] == 5) temp1 = 30;
     temp7 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp7 = 2.5;
	 if (MiscellaneousVars[temp4] == 2) temp7 = 5.0;
	 if (MiscellaneousVars[temp4] == 3) temp7 = 7.5;
	 if (MiscellaneousVars[temp4] == 4) temp7 = 10.0;
	 if (MiscellaneousVars[temp4] == 5) temp7 = 12.5;
     temp8 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp8 = 2;
	 if (MiscellaneousVars[temp4] == 2) temp8 = 5;
	 if (MiscellaneousVars[temp4] == 3) temp8 = 7;
	 if (MiscellaneousVars[temp4] == 4) temp8 = 11;
	 if (MiscellaneousVars[temp4] == 5) temp8 = 13;
     temp9 = 0;
	 if (MiscellaneousVars[temp4] == 1) temp9 = 7.5;
	 if (MiscellaneousVars[temp4] == 2) temp9 = 15.0;
	 if (MiscellaneousVars[temp4] == 3) temp9 = 22.5;
	 if (MiscellaneousVars[temp4] == 4) temp9 = 30.0;
	 if (MiscellaneousVars[temp4] == 5) temp9 = 37.5;
     temp11 = 5; // Max Levels
	 temp3 = 0; // Cost for next level.
	 if (MiscellaneousVars[temp4] == 0) temp3 = 8 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 1) temp3 = 12 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 2) temp3 = 16 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 3) temp3 = 20 * MiscellaneousVars[280] / 100;
	 if (MiscellaneousVars[temp4] == 4) temp3 = 24 * MiscellaneousVars[280] / 100;
	 if (temp3 < GetCVar("dvdsperks_minimumcost") && MiscellaneousVars[temp4] < temp11) temp3 = GetCVar("dvdsperks_minimumcost");
	 if (MenuSystemVars[1] == 4) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 if (MiscellaneousVars[temp4] == 0)
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - WILL AFFECT EXP GAINED, HP/MP/STAMINA REGEN & HELLCORE COOLDOWN SPEED.",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }
	 else
	 {
	   HudMessage(s:perkname,s:" (\cn",d:MiscellaneousVars[temp4],s:"\c-/\cn",d:temp11,s:"\c-) - +",d:temp1,s:"% MORE LEVEL EXP/EXPERIESSENCE-GAIN.",
		          s:"\n\c-+",f:temp7,s:"% HP/MP/STAMINA REGENERATION SPEED.",
		          s:"\n\c--",d:temp8,s:"% MANA COST FOR SPELLS.",
		          s:"\n\c-+",f:temp9,s:"% HELLCORE COOLDOWN SPEED.",
			      s:"\n\cfCOST FOR NEXT LEVEL: ",d:temp3,s:" AEON PTS";  
			      HUDMSG_ALPHA,  1994, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	 }	 

	}

	SetFont("STATAEON");
    xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(s:"A";
			  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
    xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(d:MiscellaneousVars[25];
			  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }
   //********************************************
   // Fifth Page - Grand Mastery Perks
   //********************************************
   if (MenuSystemVars[5] == 5)
   {
    SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange *  8125 / 100000) * 1.0; // 0.038125;
    HudMessage(s:"GRAND-MASTERY PERKS";  HUDMSG_ALPHA,  1903, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);

	
    // Selection #1
	SetFont("DVDSSMLFONT"); // DQHUDFONTSTATUS
    xtemp2 = (HudXRange * 0 / 100000) * 1.0 + 0.1; // -0.10;
    ytemp2 = (HudYRange * 15000 / 100000) * 1.0 + 0.1; // -0.15;
	if (MiscellaneousVars[11001] == 2)
	{
     perkname = "\c[Green]HIGHER LEARNING [LEVEL 2]\c- -";
	 perkdescript1 = "";
	 if (CharacterClass == 2) perkdescript1 = "\n        \cd+30%\c- SCEPTRE EXP GAINED.";
	 perkdescript2 = "\n        \cd+45%\c- EXP GAINED.";
	 if (CharacterClass == 2) perkdescript2 = "\n        \cd+30%\c- EXP GAINED.";
	 perkdescript3 = "\n        \cd+30%\c- COMBO TIMER GAINED PER KILL.";
	 perkdescript4 = "\n        \cd+50%\c- AEON POINTS ACCQUIRED ON LEVEL UP.";
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,
                s:perkdescript1,
                s:perkdescript2,
                s:perkdescript3,
	            s:perkdescript4;  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	if (MiscellaneousVars[11001] == 1)
	{
     perkname = "\c[Green]HIGHER LEARNING\c- -";
	 perkdescript1 = "";
	 if (CharacterClass == 2) perkdescript1 = "\n        \cd+15%\c- SCEPTRE EXP GAINED.";
	 perkdescript2 = "\n        \cd+22.5%\c- EXP GAINED.";
	 if (CharacterClass == 2) perkdescript2 = "\n        \cd+15%\c- EXP GAINED.";
	 perkdescript3 = "\n        \cd+15%\c- COMBO TIMER GAINED PER KILL.";
	 perkdescript4 = "\n        \cd+25%\c- AEON POINTS ACCQUIRED ON LEVEL UP.";
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:perkname,
                s:perkdescript1,
                s:perkdescript2,
                s:perkdescript3,
	            s:perkdescript4;  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	}
	else
	{
	 if (MenuSystemVars[1] == 1) { textcolor = CR_GOLD; } else { textcolor = CR_WHITE; }
	 HudMessage(s:"?????? ????????? - [YOU MUST MAX OUT AT LEAST 5 PERKS WITH 3 OR MORE LEVELS.]";  
			    HUDMSG_ALPHA,  1997, textcolor,  xtemp2, ytemp2, 0.03, 1.0);
	}
	
	
	SetFont("STATAEON");
    xtemp3 = (HudXRange * 47500 / 100000) * 1.0; // 0.475;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(s:"A";
			  HUDMSG_ALPHA,  1902, CR_UNTRANSLATED, xtemp3, ytemp3, 0.03, 1.0);

	SetFont("DQHUDFONTSTATUS"); // DQHUDFONTSTATUS // DQHUDFONTSML // Default Font setting for all menus
    xtemp3 = (HudXRange * 52500 / 100000) * 1.0; // 0.525;
    ytemp3 = (HudYRange * 97500 / 100000) * 1.0; // 0.975;
	HudMessage(d:MiscellaneousVars[25];
			  HUDMSG_ALPHA,  1901, CR_GOLD, xtemp3, ytemp3, 0.03, 1.0);
   }			  
  }

  

  
  //******************
  //******************
  //*** Codex Menu ***
  //******************
  //******************
  if (MenuSystemVars[4] == 4)
  {
   SetFont("DVDSBIGFONT"); // DQHUDFONTSTATUS
   HudXRange = 800;
   HudYRange = 600;
   SetHudSize(HudXRange,HudYRange,0);
   xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
   ytemp1 = (HudYRange *  3125 / 100000) * 1.0; // 0.03125;
   HudMessage(s:"CODEX";  HUDMSG_ALPHA,  1998, CR_WHITE,  xtemp1, ytemp1, 0.03, 1.0);

   //*****************
   //** MAIN PAGE
   //*****************
   if (MenuSystemVars[5] == 0)
   {
    SetFont("DVDSBIGFONT"); // DQHUDFONTSTATUS
    HudXRange = 760;
    HudYRange = 570;
    SetHudSize(HudXRange,HudYRange,0);
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 37500 / 100000) * 1.0; // 0.35;
    if (MenuSystemVars[1] == 1) HudMessage(s:"WEAPONS";  HUDMSG_ALPHA,  1997, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                          else HudMessage(s:"WEAPONS";  HUDMSG_ALPHA,  1997, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);   

    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 42500 / 100000) * 1.0; // 0.45;
    if (MenuSystemVars[1] == 2) HudMessage(s:"ITEMS"; HUDMSG_ALPHA,  1996, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                          else HudMessage(s:"ITEMS"; HUDMSG_ALPHA,  1996, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);

    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 47500 / 100000) * 1.0; // 0.55;
    if (MenuSystemVars[1] == 3) HudMessage(s:"POWERUPS/ARTIFACTS";  HUDMSG_ALPHA,  1995, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0); 
                           else HudMessage(s:"POWERUPS/ARTIFACTS";  HUDMSG_ALPHA,  1995, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);
 
    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 52500 / 100000) * 1.0; // 0.65;
    if (MenuSystemVars[1] == 4) HudMessage(s:"MONSTERS";  HUDMSG_ALPHA,  1994, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                           else HudMessage(s:"MONSTERS";  HUDMSG_ALPHA,  1994, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);

    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 57500 / 100000) * 1.0; // 0.65;
    if (MenuSystemVars[1] == 5) HudMessage(s:"CHARACTERS";  HUDMSG_ALPHA,  1993, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                           else HudMessage(s:"CHARACTERS";  HUDMSG_ALPHA,  1993, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);

    xtemp1 = (HudXRange * 50000 / 100000) * 1.0; // 0.5;
    ytemp1 = (HudYRange * 62500 / 100000) * 1.0; // 0.65;
    if (MenuSystemVars[1] == 6) HudMessage(s:"LOCATIONS/ENVIRONMENTS";  HUDMSG_ALPHA,  1992, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);
                           else HudMessage(s:"LOCATIONS/ENVIRONMENTS";  HUDMSG_ALPHA,  1992, CR_WHITE, xtemp1, ytemp1, 0.03, 1.0);
   }
  }

  // Menu Legend :V
   HudXRange = 864;
   HudYRange = 648;
   SetHudSize(HudXRange,HudYRange,0);
   SetFont("DVDSSMLFONT");
   xtemp1 = (HudXRange * 5000 / 100000) * 1.0 + 0.1;
   ytemp1 = (HudYRange * 96250 / 100000) * 1.0;
   HudMessage(s:"\cd",k:"+use",s:"\c- = \chSELECT\c-";
              HUDMSG_ALPHA,  1051, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);

   xtemp1 = (HudXRange * 5000 / 100000) * 1.0 + 0.1;
   ytemp1 = (HudYRange * 98750 / 100000) * 1.0;
   HudMessage(s:"\cd",k:"+forward",s:"\c-/\cd",k:"+moveup",s:"\c-/\cd",k:"+lookup",s:"\c- = \chSELECTION UP\c-",s:"\n",
              s:"\cd",k:"+back",s:"\c-/\cd",k:"+movedown",s:"\c-/\cd",k:"+lookdown",s:"\c- = \chSELECTION DOWN\c-",s:"\n";
              HUDMSG_ALPHA,  1052, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);

   xtemp1 = (HudXRange * 95000 / 100000) * 1.0 + 0.2;
   ytemp1 = (HudYRange * 96250 / 100000) * 1.0;
   HudMessage(s:"\cd",k:"pukename MENUKEY",s:"\c- = \chEXIT MENUS\c-";
              HUDMSG_ALPHA,  1053, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);

   xtemp1 = (HudXRange * 95000 / 100000) * 1.0 + 0.2;
   ytemp1 = (HudYRange * 98750 / 100000) * 1.0;
   HudMessage(s:"\cd",k:"+left",s:"\c-/\cd",k:"+moveleft",s:"\c- = \chSHIFT PAGE LEFT\c-",s:"\n",
              s:"\cd",k:"+right",s:"\c-/\cd",k:"+moveright",s:"\c- = \chSHIFT PAGE RIGHT\c-",s:"\n";
              HUDMSG_ALPHA,  1054, CR_GOLD,  xtemp1, ytemp1, 0.03, 1.0);



  SetFont("DVDSSMLFONT");
  SetHudSize(0,0,0);
  if (GetCVar("dvdsdebug_ingamemenudisplay") > 0)
  {
   PrintBold(
             s:"[0] Main Menu = ON",s:"\n",
			 s:"\n",
             s:"[1] Main Selection = ",			d:MenuSystemVars[1],s:" \n",
             s:"[2] Secondary Selection = ",	d:MenuSystemVars[2],s:" \n",
             s:"[3] Tritary Selection = ",		d:MenuSystemVars[3],s:" \n",
             s:"[4] Menu Type = ",				d:MenuSystemVars[4],s:" \n",
             s:"[5] SubMenu Type = ",			d:MenuSystemVars[5],s:" \n",
             s:"[6] SubSubMenu Type = ",		d:MenuSystemVars[6],s:" \n",
			 s:"\n",
             s:"[10001] Use Tic Timer = ",		d:MenuSystemVars[10001],s:" \n",
             s:"[10002] Up Tic Timer = ",		d:MenuSystemVars[10002],s:" \n",
             s:"[10003] Down Tic Timer = ",		d:MenuSystemVars[10003],s:" \n",
             s:"[10004] Left Tic Timer = ",		d:MenuSystemVars[10004],s:" \n",
             s:"[10005] Right Tic Timer = ",	d:MenuSystemVars[10005],s:" \n",
             s:"[10006] Back Tic Timer = ",		d:MenuSystemVars[10006],s:" \n",
		 	 s:""
            );
  }
 }
 Delay(1);
 Restart;
}


// ************************
// ** Check Player Stuff **
// ************************
script "CENTRALSCRIPTOFEVERYTHING" ENTER
{
 int G1, G2, G3, C1, C2, C3, C4, I1, I2, I3, H1;
 int Mas1;
 int BuddhaRNGVal, DivineAvatarBuffValue;
 int ArmorBits, Armor2Bits, Armor3Bits, LevelChecker, LevelChecker2, RuinousPtsNeeded, AmmoCheck, HellcoreCoolRatio, IronFeetChance, FearChance;
 int BaseSceptreEXP;
 int SceptreEXPRatio;
 int HealthRatio;
 int checkmeleeweapons;
 int staminaregenbase;
 int staminaregenfinal;
 int buttons;
 int haveruinousshield;
 int SpawnFixedX, SpawnFixedY, SpawnFixedZ, KilledMonsterFactor, Randomizer1;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int FreezePlayer;
 int PerkFactor, BasePerkFactor;
 int project_RealZ;

 SetActivator(Player1TID);
 str weapon = GetWeapon();
 SetActivator(0);
 if (GetActorProperty(Player1TID,APROP_Health) <= 0) // Sets a special flag to check for a "pistol reset" like in resurgance
 {
  if (MiscellaneousVars[149] != 1) MiscellaneousVars[149] = 1;
  if (CheckActorInventory(Player1TID,"Dedz") < 1) GiveActorInventory(Player1TID,"Dedz", 1);
 }

 //******************
 //*Initial Six Tics*
 //******************
 if (ClassCheck == 0) // Will run the check only once at the beginning of a new game
 {
  MiscellaneousVars[1999] = -1;
 }
 // Check for HUD type settings
 if (MiscellaneousVars[1999] == -1)
 {
  MiscellaneousVars[2000] = GetCVAR("dvds_newhud"); // 0 = Old HUD, 1 = DQH-ish Style
  if (MiscellaneousVars[2000] == 0) GiveActorInventory(Player1TID,"DVDSOldHud",1); else TakeActorInventory(Player1TID,"DVDSOldHud",0x7FFFFFFF); 
 }

 MiscellaneousVars[197] = GetCVAR("dvds_aeonstartlvl");
 if (MiscellaneousVars[197] < 0) MiscellaneousVars[197] = 0;
 if (MiscellaneousVars[197] > 200) MiscellaneousVars[197] = 200;

 MiscellaneousVars[169] = GetCVar("dvds_mapdifficultyinflationOVERALL");
 if (MiscellaneousVars[169] < -50) MiscellaneousVars[169] = -50;
 if (MiscellaneousVars[169] > 50) MiscellaneousVars[169] = 50;

 MiscellaneousVars[52] = GetCVar("dvds_mapdifficultyinflationEXP");
 if (MiscellaneousVars[52] < -50) MiscellaneousVars[52] = -50;
 if (MiscellaneousVars[52] > 50) MiscellaneousVars[52] = 50;

 MiscellaneousVars[53] = GetCVar("dvds_mapdifficultyinflationStats");
 if (MiscellaneousVars[53] < -50) MiscellaneousVars[53] = -50;
 if (MiscellaneousVars[53] > 50) MiscellaneousVars[53] = 50;

 MiscellaneousVars[54] = GetCVar("dvds_mapdifficultyinflationSpawnStealth");
 if (MiscellaneousVars[54] < -50) MiscellaneousVars[54] = -50;
 if (MiscellaneousVars[54] > 50) MiscellaneousVars[54] = 50;

 MiscellaneousVars[86] = GetCVar("dvds_aeonpointmultiplier");
 if (MiscellaneousVars[86] < 1) MiscellaneousVars[86] = 1;
 MiscellaneousVars[87] = GetCVar("dvds_seedmultiplier");
 if (MiscellaneousVars[87] < 1) MiscellaneousVars[87] = 1;
 MiscellaneousVars[146] = GetCVar("dvds_lvlstatmultiplier");
 if (MiscellaneousVars[146] < 1) MiscellaneousVars[146] = 1;

 MiscellaneousVars[280] = GetCVar("dvdsperks_costratio");
 
 MiscellaneousVars[148] = GetCVar("dvds_startotherstatsfactor");

 if (GetCVar("dvds_tensionspeed") <= 0 ) MiscellaneousVars[193] = 1;
 if (GetCVar("dvds_tensionspeed") == 1 ) MiscellaneousVars[193] = 2;
 if (GetCVar("dvds_tensionspeed") == 2 ) MiscellaneousVars[193] = 4;
 if (GetCVar("dvds_tensionspeed") == 3 ) MiscellaneousVars[193] = 8;
 if (GetCVar("dvds_tensionspeed") == 4 ) MiscellaneousVars[193] = 16;
 if (GetCVar("dvds_tensionspeed") == 5 ) MiscellaneousVars[193] = 32;
 if (GetCVar("dvds_tensionspeed") >= 6 ) MiscellaneousVars[193] = 64;

 if (GetCVar("dvds_monstercrisisattacks") == 0) TakeActorInventory(Player1TID,"PlayerCanUseCrisisAttacks",0x7FFFFFFF);

 if (ClassCheck == 1) // Will run the check only once at the beginning of a new game
 {
  GiveActorInventory(Player1TID,"GreaterVimstone",1);  TakeActorInventory(Player1TID,"GreaterVimstone",1);
  GiveActorInventory(Player1TID,"LesserVimstone",1);  TakeActorInventory(Player1TID,"LesserVimstone",1);
  GiveActorInventory(Player1TID,"MonsterMunchies",1);  TakeActorInventory(Player1TID,"MonsterMunchies",1);
  GiveActorInventory(Player1TID,"MercuryBandana",1);  TakeActorInventory(Player1TID,"MercuryBandana",1);
  GiveActorInventory(Player1TID,"PaxaPunch",1);  TakeActorInventory(Player1TID,"PaxaPunch",1);
  GiveActorInventory(Player1TID,"RockbombShard",1);  TakeActorInventory(Player1TID,"RockbombShard",1);
  GiveActorInventory(Player1TID,"YggdrasilDew",1);  TakeActorInventory(Player1TID,"YggdrasilDew",1);
  GiveActorInventory(Player1TID,"MiraclePotion",1);  TakeActorInventory(Player1TID,"MiraclePotion",1);
  GiveActorInventory(Player1TID,"ElfinElixir",1);  TakeActorInventory(Player1TID,"ElfinElixir",1);
  GiveActorInventory(Player1TID,"SageElixir",1);  TakeActorInventory(Player1TID,"SageElixir",1);
  GiveActorInventory(Player1TID,"MagicWater",1);  TakeActorInventory(Player1TID,"MagicWater",1);
  GiveActorInventory(Player1TID,"SpecialMedicine",1);  TakeActorInventory(Player1TID,"SpecialMedicine",1);
  GiveActorInventory(Player1TID,"StrongMedicine",1);  TakeActorInventory(Player1TID,"StrongMedicine",1);
  GiveActorInventory(Player1TID,"MedicinalHerb",1);  TakeActorInventory(Player1TID,"MedicinalHerb",1);
  if (ClassicDoomType == 2) // Heretic
  {
   GiveActorInventory(Player1TID,"ArtiHealthNew",1);  TakeActorInventory(Player1TID,"ArtiHealthNew",1);
   GiveActorInventory(Player1TID,"ArtiSuperHealthNew",1);  TakeActorInventory(Player1TID,"ArtiSuperHealthNew",1);
   GiveActorInventory(Player1TID,"ArtiEggNew",1);  TakeActorInventory(Player1TID,"ArtiEggNew",1);
   GiveActorInventory(Player1TID,"ArtiTeleportNew",1);  TakeActorInventory(Player1TID,"ArtiTeleportNew",1);
   GiveActorInventory(Player1TID,"ArtiInvisibilityNew",1);  TakeActorInventory(Player1TID,"ArtiInvisibilityNew",1);
   GiveActorInventory(Player1TID,"ArtiInvulnerabilityNew",1);  TakeActorInventory(Player1TID,"ArtiInvulnerabilityNew",1);
  }
  if (ClassicDoomType == 3) // Hexen
  {
   GiveActorInventory(Player1TID,"ArtiHealthNew",1);  TakeActorInventory(Player1TID,"ArtiHealthNew",1);
   GiveActorInventory(Player1TID,"ArtiHealingRadiusNew",1);  TakeActorInventory(Player1TID,"ArtiHealingRadiusNew",1);
   GiveActorInventory(Player1TID,"ArtiSuperHealthNew",1);  TakeActorInventory(Player1TID,"ArtiSuperHealthNew",1);
   GiveActorInventory(Player1TID,"ArtiBoostManaNew",1);  TakeActorInventory(Player1TID,"ArtiBoostManaNew",1);
   GiveActorInventory(Player1TID,"ArtiPorkNew",1);  TakeActorInventory(Player1TID,"ArtiPorkNew",1);
   GiveActorInventory(Player1TID,"ArtiDarkServantNew",1);  TakeActorInventory(Player1TID,"ArtiDarkServantNew",1);
   GiveActorInventory(Player1TID,"ArtiTeleportOtherNew",1);  TakeActorInventory(Player1TID,"ArtiTeleportOtherNew",1);
   GiveActorInventory(Player1TID,"ArtiTeleportNew",1);  TakeActorInventory(Player1TID,"ArtiTeleportNew",1);
   GiveActorInventory(Player1TID,"ArtiInvulnerability2New",1);  TakeActorInventory(Player1TID,"ArtiInvulnerability2New",1);
  }
  if (ClassicDoomType == 4) // Strife
  {
   GiveActorInventory(Player1TID,"SurgeryKitNew",1);  TakeActorInventory(Player1TID,"SurgeryKitNew",1);
   GiveActorInventory(Player1TID,"MedicalKitNew",1);  TakeActorInventory(Player1TID,"MedicalKitNew",1);
   GiveActorInventory(Player1TID,"MedPatchNew",1);  TakeActorInventory(Player1TID,"MedPatchNew",1);
   GiveActorInventory(Player1TID,"Coin",1);  TakeActorInventory(Player1TID,"Coin",1);

   if (GameSkill() == SKILL_VERY_EASY) GiveActorInventory(Player1TID,"Coin",random(175,225));
   if (GameSkill() == SKILL_EASY) GiveActorInventory(Player1TID,"Coin",random(150,200));
   if (GameSkill() == SKILL_NORMAL) GiveActorInventory(Player1TID,"Coin",random(125,175));
   if (GameSkill() == SKILL_HARD) GiveActorInventory(Player1TID,"Coin",random(100,150));
   if (GameSkill() == SKILL_VERY_HARD) GiveActorInventory(Player1TID,"Coin",random(50,100));
  }
  
  //PrintBold(d:ClassCheck);
  // Checks inital actorname of the player's PlayerPawn actor in order to assess the right class #. If you want to try to define extra characters, make sure you use the character's Player-class name.
  if (ThingCountName("DeggarisMontegger", Player1TID) > 0) CharacterClass = 0;
  else if (ThingCountName("IlluciaHendershot", Player1TID) > 0) CharacterClass = 1;
  else if (ThingCountName("FloraBriscoletti", Player1TID) > 0) CharacterClass = 2;
  // else if (ThingCountName("Corvus", Player1TID) > 0) CharacterClass = 3;
  // else if (ThingCountName("Baratus", Player1TID) > 0) CharacterClass = 4;
  // else if (ThingCountName("Parias", Player1TID) > 0) CharacterClass = 5;
  // else if (ThingCountName("Daedolon", Player1TID) > 0) CharacterClass = 6;
  // else if (ThingCountName("StrifeGuy", Player1TID) > 0) CharacterClass = 7;
  else if (ThingCountName("Ailish", Player1TID) > 0) CharacterClass = 8;
  else if (ThingCountName("PetraLagerkvist", Player1TID) > 0) CharacterClass = 9;
  else { CharacterClass = -1; MaxHealthTrue = 100; }

  if (CharacterClass == 0) // Deggaris
  {
   // HP Range
   MaxHealthTrue = (103 + random(-4,12) * (random(90,110) / 100) + random(6,10)); // 96-136 HP [103 Base]

   // MP Range
   MaxMana = (20 + random(-18,8) * (random(100,116) / 100) + random(0,4)); // 2-36 MP [20 Base]

   // Mortal Hit Survivality Rate [x.x% format] (Deggaris is the lowest ranking in Base Survivability)
   MiscellaneousVars[0] = 32 + random(-16,16); // [1.6%-4.8%]

   // Seed Stat Randomization
   MiscellaneousVars[31] = random(1,3); // Agility
   MiscellaneousVars[32] = random(4,6); // Defense
   MiscellaneousVars[33] = random(2,4); // Deftness
   MiscellaneousVars[34] = random(1,3); // Sorcery
   MiscellaneousVars[35] = random(5,7); // Strength
   MiscellaneousVars[36] = random(2,4); // Therapeusis

   if (GameSkill() == SKILL_VERY_EASY) // 33-57
   {
    MiscellaneousVars[31] += random(3,5); // Agility
    MiscellaneousVars[32] += random(3,5); // Defense
    MiscellaneousVars[33] += random(3,5); // Deftness
    MiscellaneousVars[34] += random(3,5); // Sorcery
    MiscellaneousVars[35] += random(3,5); // Strength
    MiscellaneousVars[36] += random(3,5); // Therapeusis

    GiveInventory("ArmorBonusDSBlue", 200);
    CurrentMaxArmor = 200;
    CurrentArmorClass = 2;
    GiveInventory("DSBlueArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSGreenArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_EASY) // 21-45
   {
    MiscellaneousVars[31] += random(1,3); // Agility
    MiscellaneousVars[32] += random(1,3); // Defense
    MiscellaneousVars[33] += random(1,3); // Deftness
    MiscellaneousVars[34] += random(1,3); // Sorcery
    MiscellaneousVars[35] += random(1,3); // Strength
    MiscellaneousVars[36] += random(1,3); // Therapeusis

    GiveInventory("ArmorBonusDSBlue", 150);
    CurrentMaxArmor = 200;
    CurrentArmorClass = 2;
    GiveInventory("DSBlueArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSGreenArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_NORMAL) // 15-45
   {
    MiscellaneousVars[31] += random(0,3); // Agility
    MiscellaneousVars[32] += random(0,3); // Defense
    MiscellaneousVars[33] += random(0,3); // Deftness
    MiscellaneousVars[34] += random(0,3); // Sorcery
    MiscellaneousVars[35] += random(0,3); // Strength
    MiscellaneousVars[36] += random(0,3); // Therapeusis

    if (random(0,1) == 0)
    {
     GiveInventory("ArmorBonusDSBlue", 100);
     CurrentMaxArmor = 200;
     CurrentArmorClass = 2;
     GiveInventory("DSBlueArmorClass", 1);
     TakeInventory("DSNoArmorClass", 9999);
     TakeInventory("DSGreenArmorClass", 9999);
     TakeInventory("DSStoneArmorClass1", 9999);
     TakeInventory("DSDiamondArmorClass1", 9999);
     TakeInventory("DSStoneArmorClass2", 9999);
     TakeInventory("DSDiamondArmorClass2", 9999);
    }
    else
    {
     GiveInventory("ArmorBonusDSGreen", 100);
     CurrentMaxArmor = 100;
     CurrentArmorClass = 1;
     GiveInventory("DSGreenArmorClass", 1);
     TakeInventory("DSNoArmorClass", 9999);
     TakeInventory("DSBlueArmorClass", 9999);
     TakeInventory("DSStoneArmorClass1", 9999);
     TakeInventory("DSDiamondArmorClass1", 9999);
     TakeInventory("DSStoneArmorClass2", 9999);
     TakeInventory("DSDiamondArmorClass2", 9999);
    }
   }
   if (GameSkill() == SKILL_HARD) // 15-39
   {
    MiscellaneousVars[31] += random(0,2); // Agility
    MiscellaneousVars[32] += random(0,2); // Defense
    MiscellaneousVars[33] += random(0,2); // Deftness
    MiscellaneousVars[34] += random(0,2); // Sorcery
    MiscellaneousVars[35] += random(0,2); // Strength
    MiscellaneousVars[36] += random(0,2); // Therapeusis

    GiveInventory("ArmorBonusDSGreen", 50);
    CurrentMaxArmor = 100;
    CurrentArmorClass = 1;
    GiveInventory("DSGreenArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSBlueArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_VERY_HARD) // 9-33
   {
    MiscellaneousVars[31] += random(-1,1); // Agility
    MiscellaneousVars[32] += random(-1,1); // Defense
    MiscellaneousVars[33] += random(-1,1); // Deftness
    MiscellaneousVars[34] += random(-1,1); // Sorcery
    MiscellaneousVars[35] += random(-1,1); // Strength
    MiscellaneousVars[36] += random(-1,1); // Therapeusis

    GiveInventory("ArmorBonusDSGreen", 25);
    CurrentMaxArmor = 100;
    CurrentArmorClass = 1;
    GiveInventory("DSGreenArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSBlueArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
  }
  else
  if (CharacterClass == 1) // Illucia
  {
   // HP Range
   MaxHealthTrue = (81 + random(-8,8) * (random(90,110) / 100) + random(3,7)); // 69-104 HP [81 Base]

   // MP Range
   MaxMana = (26 + random(-13,13) * (random(116,132) / 100) + random(3,7)); // 18-58 MP [26 Base]

   // Mortal Hit Survivality Rate [x.x% format] (Illucia is the highest ranking in Base Survivability)
   MiscellaneousVars[0] = 46 + random(-16,16); // [3.0%-6.2%]

   // Seed Stat Ranomization
   MiscellaneousVars[31] = random(3,5); // Agility
   MiscellaneousVars[32] = random(2,4); // Defense
   MiscellaneousVars[33] = random(2,4); // Deftness
   MiscellaneousVars[34] = random(3,5); // Sorcery
   MiscellaneousVars[35] = random(3,5); // Strength
   MiscellaneousVars[36] = random(2,4); // Therapeusis

   if (GameSkill() == SKILL_VERY_EASY) // 33-57
   {
    MiscellaneousVars[31] += random(3,5); // Agility
    MiscellaneousVars[32] += random(3,5); // Defense
    MiscellaneousVars[33] += random(3,5); // Deftness
    MiscellaneousVars[34] += random(3,5); // Sorcery
    MiscellaneousVars[35] += random(3,5); // Strength
    MiscellaneousVars[36] += random(3,5); // Therapeusis

    GiveInventory("ArmorBonusDSBlue", 200);
    CurrentMaxArmor = 200;
    CurrentArmorClass = 2;
    GiveInventory("DSBlueArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSGreenArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_EASY) // 21-45
   {
    MiscellaneousVars[31] += random(1,3); // Agility
    MiscellaneousVars[32] += random(1,3); // Defense
    MiscellaneousVars[33] += random(1,3); // Deftness
    MiscellaneousVars[34] += random(1,3); // Sorcery
    MiscellaneousVars[35] += random(1,3); // Strength
    MiscellaneousVars[36] += random(1,3); // Therapeusis

    GiveInventory("ArmorBonusDSBlue", 150);
    CurrentMaxArmor = 200;
    CurrentArmorClass = 2;
    GiveInventory("DSBlueArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSGreenArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_NORMAL) // 15-45
   {
    MiscellaneousVars[31] += random(0,3); // Agility
    MiscellaneousVars[32] += random(0,3); // Defense
    MiscellaneousVars[33] += random(0,3); // Deftness
    MiscellaneousVars[34] += random(0,3); // Sorcery
    MiscellaneousVars[35] += random(0,3); // Strength
    MiscellaneousVars[36] += random(0,3); // Therapeusis

    if (random(0,1) == 0)
    {
     GiveInventory("ArmorBonusDSBlue", 100);
     CurrentMaxArmor = 200;
     CurrentArmorClass = 2;
     GiveInventory("DSBlueArmorClass", 1);
     TakeInventory("DSNoArmorClass", 9999);
     TakeInventory("DSGreenArmorClass", 9999);
     TakeInventory("DSStoneArmorClass1", 9999);
     TakeInventory("DSDiamondArmorClass1", 9999);
     TakeInventory("DSStoneArmorClass2", 9999);
     TakeInventory("DSDiamondArmorClass2", 9999);
    }
    else
    {
     GiveInventory("ArmorBonusDSGreen", 100);
     CurrentMaxArmor = 100;
     CurrentArmorClass = 1;
     GiveInventory("DSGreenArmorClass", 1);
     TakeInventory("DSNoArmorClass", 9999);
     TakeInventory("DSBlueArmorClass", 9999);
     TakeInventory("DSStoneArmorClass1", 9999);
     TakeInventory("DSDiamondArmorClass1", 9999);
     TakeInventory("DSStoneArmorClass2", 9999);
     TakeInventory("DSDiamondArmorClass2", 9999);
    }
   }
   if (GameSkill() == SKILL_HARD) // 15-39
   {
    MiscellaneousVars[31] += random(0,2); // Agility
    MiscellaneousVars[32] += random(0,2); // Defense
    MiscellaneousVars[33] += random(0,2); // Deftness
    MiscellaneousVars[34] += random(0,2); // Sorcery
    MiscellaneousVars[35] += random(0,2); // Strength
    MiscellaneousVars[36] += random(0,2); // Therapeusis

    GiveInventory("ArmorBonusDSGreen", 50);
    CurrentMaxArmor = 100;
    CurrentArmorClass = 1;
    GiveInventory("DSGreenArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSBlueArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   if (GameSkill() == SKILL_VERY_HARD) // 9-33
   {
    MiscellaneousVars[31] += random(-1,1); // Agility
    MiscellaneousVars[32] += random(-1,1); // Defense
    MiscellaneousVars[33] += random(-1,1); // Deftness
    MiscellaneousVars[34] += random(-1,1); // Sorcery
    MiscellaneousVars[35] += random(-1,1); // Strength
    MiscellaneousVars[36] += random(-1,1); // Therapeusis

    GiveInventory("ArmorBonusDSGreen", 25);
    CurrentMaxArmor = 100;
    CurrentArmorClass = 1;
    GiveInventory("DSGreenArmorClass", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSBlueArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSStoneArmorClass2", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }

  }
  else
  if (CharacterClass == 2) // Flora
  {
   // HP Range
   MaxHealthTrue = (73 + random(-12,4) * (random(90,110) / 100) + random(0,4)); // 55-88 HP [73 Base]

   // MP Range
   MaxMana = (35 + random(-8,18) * (random(132,164) / 100) + random(6,10)); // 35-79 MP [35 Base]

   // Mortal Hit Survivality Rate [x.x% format] (Flora is the middle ranking in Base Survivability)
   MiscellaneousVars[0] = 39 + random(-16,16); // [2.3%-5.5%]

   // Seed Stat Ranomization
   MiscellaneousVars[31] = random(5,7); // Agility
   MiscellaneousVars[32] = random(1,3); // Defense
   MiscellaneousVars[33] = random(4,6); // Deftness
   MiscellaneousVars[34] = random(4,6); // Sorcery
   MiscellaneousVars[35] = random(1,3); // Strength
   MiscellaneousVars[36] = random(3,5); // Therapeusis
   BaseSceptreEXP = 312;

   if (GameSkill() == SKILL_VERY_EASY) // 37-60
   {
    MiscellaneousVars[31] += random(3,5); // Agility
    MiscellaneousVars[32] += random(3,5); // Defense
    MiscellaneousVars[33] += random(3,5); // Deftness
    MiscellaneousVars[34] += random(3,5); // Sorcery
    MiscellaneousVars[35] += random(3,5); // Strength
    MiscellaneousVars[36] += random(3,5); // Therapeusis
    BaseSceptreEXP = 240;
   }
   if (GameSkill() == SKILL_EASY) // 25-48
   {
    MiscellaneousVars[31] += random(1,3); // Agility
    MiscellaneousVars[32] += random(1,3); // Defense
    MiscellaneousVars[33] += random(1,3); // Deftness
    MiscellaneousVars[34] += random(1,3); // Sorcery
    MiscellaneousVars[35] += random(1,3); // Strength
    MiscellaneousVars[36] += random(1,3); // Therapeusis
    BaseSceptreEXP = 288;
   }
   if (GameSkill() == SKILL_NORMAL) // 19-48
   {
    MiscellaneousVars[31] += random(0,3); // Agility
    MiscellaneousVars[32] += random(0,3); // Defense
    MiscellaneousVars[33] += random(0,3); // Deftness
    MiscellaneousVars[34] += random(0,3); // Sorcery
    MiscellaneousVars[35] += random(0,3); // Strength
    MiscellaneousVars[36] += random(0,3); // Therapeusis
    BaseSceptreEXP = 312;
   }
   if (GameSkill() == SKILL_HARD) // 19-42
   {
    MiscellaneousVars[31] += random(0,2); // Agility
    MiscellaneousVars[32] += random(0,2); // Defense
    MiscellaneousVars[33] += random(0,2); // Deftness
    MiscellaneousVars[34] += random(0,2); // Sorcery
    MiscellaneousVars[35] += random(0,2); // Strength
    MiscellaneousVars[36] += random(0,2); // Therapeusis
    BaseSceptreEXP = 336;
   }
   if (GameSkill() == SKILL_VERY_HARD) // 13-36
   {
    MiscellaneousVars[31] += random(-1,1); // Agility
    MiscellaneousVars[32] += random(-1,1); // Defense
    MiscellaneousVars[33] += random(-1,1); // Deftness
    MiscellaneousVars[34] += random(-1,1); // Sorcery
    MiscellaneousVars[35] += random(-1,1); // Strength
    MiscellaneousVars[36] += random(-1,1); // Therapeusis
    BaseSceptreEXP = 384;
   }

   // Ensures Flora will not start off with armor. :P
   CurrentMaxArmor = 0;
   CurrentArmorClass = 0;
   TakeActorInventory(Player1TID,"Armor", 999999);
   TakeActorInventory(Player1TID,"BasicArmor", 999999);
   GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
   TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);

   MiscellaneousVars[140] = GetCVar("dvds_sceptrestartlvl");
   if (MiscellaneousVars[140] < 0) MiscellaneousVars[140] = 0;
   if (MiscellaneousVars[140] > 16) MiscellaneousVars[140] = 16;
   while (MiscellaneousVars[140] > 0)
   {
    SceptreEXPRatio += MiscellaneousVars[140];
    MiscellaneousVars[140] -= 1;
   }   
   SceptreLevelEXP = BaseSceptreEXP * SceptreEXPRatio;

   if (GetCVar("dvds_florastartsceptre") == 1)
   {
    GiveActorInventory(Player1TID,"SceptreOfEmpyrea",1);
    SetActivator(Player1TID);
    SetWeapon("SceptreOfEmpyrea");
    SetActivator(0);
   }
   else
   {
    if (ModType != 0)
    {
     GiveActorInventory(Player1TID,"SceptreOfEmpyrea",1);
     SetActivator(Player1TID);
     SetWeapon("SceptreOfEmpyrea");
     SetActivator(0);
    }
   }

   // Mod Type Checks
   if (ModType == 0) // Classic Mode
   {
    if (GetCVar("dvds_florastartdiarislongbow") >= 1)
    {
     GiveActorInventory(Player1TID,"DiarisLongbow",1);
     TakeActorInventory(Player1TID,"DiarisArrow",0x7FFFFFFF);
    }
    if (GetCVar("dvds_florastartsapphirewand") > 0)
    {
     GiveActorInventory(Player1TID,"SapphireWandNew",1);
     if (GetCVar("dvds_florastartsapphirewand") > 1)
     {
      GiveActorInventory(Player1TID,"DualSapphireWandsNew",1);
     }
    }

    // Individual Game Checks
    if (ClassicDoomType == 0) // Doom 1
	{
     GiveActorInventory(Player1TID,"PlayingDoom2",1);
	}
    if (ClassicDoomType == 1) // Doom 1
	{
     GiveActorInventory(Player1TID,"PlayingDoom1",1);
	}
    if (ClassicDoomType == 2) // Heretic
	{
     GiveActorInventory(Player1TID,"PlayingHeretic",1);

     if (GetCVar("dvds_florastartelvenwands") >= 1)
     {
      GiveActorInventory(Player1TID,"GoldWandNew",1);
     }
     if (GetCVar("dvds_florastartelvenwands") == 2)
     {
      GiveActorInventory(Player1TID,"DualGoldWandNew",1);
     }
	}
    if (ClassicDoomType == 3) // HeXen
	{
     GiveActorInventory(Player1TID,"PlayingHexen",1);
	}
    if (ClassicDoomType == 4) // Strife
	{
     GiveActorInventory(Player1TID,"PlayingStrife",1);
	}
    if (ClassicDoomType == 5) // Doom64
	{
     GiveActorInventory(Player1TID,"PlayingDoom64",1);
	}
   }
   else
   if (ModType == 1) // DVI
   {
    GiveActorInventory(Player1TID,"PlayingDeusVultI",1);
   }
   else
   if (ModType == 2) // DVII
   {
    GiveActorInventory(Player1TID,"PlayingDeusVultII",1);
   }
   
  }
  else
  if (CharacterClass == 8) // Ailish
  {
   // HP Range
   MaxHealthTrue = (63 + random(-12,4) * (random(90,110) / 100) + random(0,3)); //

   // MP Range
   MaxMana = (43 + random(-8,18) * (random(132,164) / 100) + random(6,10)); //

   // Mortal Hit Survivality Rate [x.x% format] (Ailish's survivability rate is the lowest of the playables at this point)
   MiscellaneousVars[0] = 18 + random(-16,16); // [2.3%-5.5%]

   // Seed Stat Ranomization
   MiscellaneousVars[31] = random(5,7); // Agility
   MiscellaneousVars[32] = random(1,3); // Defense
   MiscellaneousVars[33] = random(4,6); // Deftness
   MiscellaneousVars[34] = random(4,6); // Sorcery
   MiscellaneousVars[35] = random(1,3); // Strength
   MiscellaneousVars[36] = random(3,5); // Therapeusis
   BaseSceptreEXP = 312;

   if (GameSkill() == SKILL_VERY_EASY) // 37-60
   {
    MiscellaneousVars[31] += random(3,5); // Agility
    MiscellaneousVars[32] += random(3,5); // Defense
    MiscellaneousVars[33] += random(3,5); // Deftness
    MiscellaneousVars[34] += random(3,5); // Sorcery
    MiscellaneousVars[35] += random(3,5); // Strength
    MiscellaneousVars[36] += random(3,5); // Therapeusis
    BaseSceptreEXP = 240;
   }
   if (GameSkill() == SKILL_EASY) // 25-48
   {
    MiscellaneousVars[31] += random(1,3); // Agility
    MiscellaneousVars[32] += random(1,3); // Defense
    MiscellaneousVars[33] += random(1,3); // Deftness
    MiscellaneousVars[34] += random(1,3); // Sorcery
    MiscellaneousVars[35] += random(1,3); // Strength
    MiscellaneousVars[36] += random(1,3); // Therapeusis
    BaseSceptreEXP = 288;
   }
   if (GameSkill() == SKILL_NORMAL) // 19-48
   {
    MiscellaneousVars[31] += random(0,3); // Agility
    MiscellaneousVars[32] += random(0,3); // Defense
    MiscellaneousVars[33] += random(0,3); // Deftness
    MiscellaneousVars[34] += random(0,3); // Sorcery
    MiscellaneousVars[35] += random(0,3); // Strength
    MiscellaneousVars[36] += random(0,3); // Therapeusis
    BaseSceptreEXP = 312;
   }
   if (GameSkill() == SKILL_HARD) // 19-42
   {
    MiscellaneousVars[31] += random(0,2); // Agility
    MiscellaneousVars[32] += random(0,2); // Defense
    MiscellaneousVars[33] += random(0,2); // Deftness
    MiscellaneousVars[34] += random(0,2); // Sorcery
    MiscellaneousVars[35] += random(0,2); // Strength
    MiscellaneousVars[36] += random(0,2); // Therapeusis
    BaseSceptreEXP = 336;
   }
   if (GameSkill() == SKILL_VERY_HARD) // 13-36
   {
    MiscellaneousVars[31] += random(-1,1); // Agility
    MiscellaneousVars[32] += random(-1,1); // Defense
    MiscellaneousVars[33] += random(-1,1); // Deftness
    MiscellaneousVars[34] += random(-1,1); // Sorcery
    MiscellaneousVars[35] += random(-1,1); // Strength
    MiscellaneousVars[36] += random(-1,1); // Therapeusis
    BaseSceptreEXP = 384;
   }
   //Like with Flora, Ailish can't use marine armor at all.
   CurrentMaxArmor = 0;
   CurrentArmorClass = 0;
   TakeActorInventory(Player1TID,"Armor", 999999);
   TakeActorInventory(Player1TID,"BasicArmor", 999999);
   GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
   TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
  }
  else
  if (CharacterClass == 8) // Ailish
  {
  }
  else
  if (CharacterClass == 9) // Petra
  {
   // HP Range
   MaxHealthTrue = (102 + random(-4,12) * (random(90,110) / 100) + random(4,12)); //

   // MP Range
   MaxMana = (25 + random(-12,12) * (random(114,130) / 100) + random(3,7)); // 18-55 MP [25 Base]

   // Mortal Hit Survivality Rate [x.x% format] (Petra's is the highest of the playables at this point)
   MiscellaneousVars[0] = 64 + random(-8,32); // [2.3%-5.5%]

   // Seed Stat Ranomization
   MiscellaneousVars[31] = random(3,5); // Agility
   MiscellaneousVars[32] = random(4,6); // Defense
   MiscellaneousVars[33] = random(2,4); // Deftness
   MiscellaneousVars[34] = random(3,4); // Sorcery
   MiscellaneousVars[35] = random(1,3); // Strength
   MiscellaneousVars[36] = random(4,6); // Therapeusis
   BaseSceptreEXP = 312;

   if (GameSkill() == SKILL_VERY_EASY) // 37-60
   {
    MiscellaneousVars[31] += random(3,5); // Agility
    MiscellaneousVars[32] += random(3,5); // Defense
    MiscellaneousVars[33] += random(3,5); // Deftness
    MiscellaneousVars[34] += random(3,5); // Sorcery
    MiscellaneousVars[35] += random(3,5); // Strength
    MiscellaneousVars[36] += random(3,5); // Therapeusis
    BaseSceptreEXP = 240;
   }
   if (GameSkill() == SKILL_EASY) // 25-48
   {
    MiscellaneousVars[31] += random(1,3); // Agility
    MiscellaneousVars[32] += random(1,3); // Defense
    MiscellaneousVars[33] += random(1,3); // Deftness
    MiscellaneousVars[34] += random(1,3); // Sorcery
    MiscellaneousVars[35] += random(1,3); // Strength
    MiscellaneousVars[36] += random(1,3); // Therapeusis
    BaseSceptreEXP = 288;
   }
   if (GameSkill() == SKILL_NORMAL) // 19-48
   {
    MiscellaneousVars[31] += random(0,3); // Agility
    MiscellaneousVars[32] += random(0,3); // Defense
    MiscellaneousVars[33] += random(0,3); // Deftness
    MiscellaneousVars[34] += random(0,3); // Sorcery
    MiscellaneousVars[35] += random(0,3); // Strength
    MiscellaneousVars[36] += random(0,3); // Therapeusis
    BaseSceptreEXP = 312;
   }
   if (GameSkill() == SKILL_HARD) // 19-42
   {
    MiscellaneousVars[31] += random(0,2); // Agility
    MiscellaneousVars[32] += random(0,2); // Defense
    MiscellaneousVars[33] += random(0,2); // Deftness
    MiscellaneousVars[34] += random(0,2); // Sorcery
    MiscellaneousVars[35] += random(0,2); // Strength
    MiscellaneousVars[36] += random(0,2); // Therapeusis
    BaseSceptreEXP = 336;
   }
   if (GameSkill() == SKILL_VERY_HARD) // 13-36
   {
    MiscellaneousVars[31] += random(-1,1); // Agility
    MiscellaneousVars[32] += random(-1,1); // Defense
    MiscellaneousVars[33] += random(-1,1); // Deftness
    MiscellaneousVars[34] += random(-1,1); // Sorcery
    MiscellaneousVars[35] += random(-1,1); // Strength
    MiscellaneousVars[36] += random(-1,1); // Therapeusis
    BaseSceptreEXP = 384;
   }
   //Like Flora and Ailish, Petra can't use Marine armor.
   CurrentMaxArmor = 0;
   CurrentArmorClass = 0;
   TakeActorInventory(Player1TID,"Armor", 999999);
   TakeActorInventory(Player1TID,"BasicArmor", 999999);
   GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
   TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
  }
  
  MiscellaneousVars[25] += GetCVar("dvds_startingaeonpts");
  MiscellaneousVars[25] = MiscellaneousVars[25] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor

  MiscellaneousVars[31] = MiscellaneousVars[31] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor
  MiscellaneousVars[32] = MiscellaneousVars[32] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor
  MiscellaneousVars[33] = MiscellaneousVars[33] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor
  MiscellaneousVars[34] = MiscellaneousVars[34] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor
  MiscellaneousVars[35] = MiscellaneousVars[35] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor
  MiscellaneousVars[36] = MiscellaneousVars[36] * MiscellaneousVars[148] / 100; // Check Start Other Stats Factor

  MaxMana = MaxMana * GetCVar("dvds_starthpmanafactor") / 100; // Check Start Mana Factor
  if (MaxMana < 1) MaxMana = 1;
  CurrentMana = MaxMana;

  if (CharacterClass == 2) // Deggaris and Illucia have an extra randomization to their HP, while Flora has a slightly more varied randomization which works more to her favor on easier skill levels.
  {
   // Flora: 55-84 HP
   if (GameSkill() == SKILL_VERY_EASY) MaxHealthTrue = MaxHealthTrue * random(120,140) / 100;	// 66-118 HP [spread of 52]
   if (GameSkill() == SKILL_EASY) MaxHealthTrue = MaxHealthTrue * random(110,130) / 100;		// 60-109 HP [spread of 49]
   if (GameSkill() == SKILL_NORMAL) MaxHealthTrue = MaxHealthTrue * random(100,120) / 100;		// 55-101 HP [spread of 46]
   if (GameSkill() == SKILL_HARD) MaxHealthTrue = MaxHealthTrue * random(90,110) / 100; 		// 49-92 HP [spread of 43]
   if (GameSkill() == SKILL_VERY_HARD) MaxHealthTrue = MaxHealthTrue * random(80,100) / 100;	// 44-84 HP [spread of 40]
  }
  else
  {
   // Deg: 90-126 HP
   // Illu: 66-97 HP
   if (GameSkill() == SKILL_VERY_EASY) MaxHealthTrue = MaxHealthTrue * random(100,120) / 100;	// Deg: 90-151 HP [spread of 61], Illu: 66-116 HP [spread of 50]
   if (GameSkill() == SKILL_EASY) MaxHealthTrue = MaxHealthTrue * random(95,115) / 100;			// Deg: 85-145 HP [spread of 60], Illu: 62-111 HP [spread of 49]
   if (GameSkill() == SKILL_NORMAL) MaxHealthTrue = MaxHealthTrue * random(90,110) / 100;		// Deg: 81-138 HP [spread of 57], Illu: 59-106 HP [spread of 47]
   if (GameSkill() == SKILL_HARD) MaxHealthTrue = MaxHealthTrue * random(85,105) / 100; 		// Deg: 76-132 HP [spread of 56], Illu: 56-102 HP [spread of 46]
   if (GameSkill() == SKILL_VERY_HARD) MaxHealthTrue = MaxHealthTrue * random(80,100) / 100; 	// Deg: 72-126 HP [spread of 54], Illu: 52-97 HP [spread of 45]
  }
  MaxHealthTrue = MaxHealthTrue * GetCVar("dvds_starthpmanafactor") / 100; // Check Start HP Factor
  if (MaxHealthTrue < 1) MaxHealthTrue = 1;
  SetActorProperty(Player1TID,APROP_Health,MaxHealthTrue);
  SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);
  MiscellaneousVars[241] = MaxHealthTrue;
  MiscellaneousVars[298] = MaxHealthTrue;
 }
 if (ClassCheck == 3)
 {
 }
 if (ClassCheck == 4)
 {
 }
 if (ClassCheck == 5) // Will run the check only once at the beginning of a new game
 {
  MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
  MiscellaneousVars[298] = MaxHealthTrue;
 }
 if (ClassCheck < 6)
 {
  if (MiscellaneousVars[31] < 0) MiscellaneousVars[31] = 0;
  if (MiscellaneousVars[32] < 0) MiscellaneousVars[32] = 0;
  if (MiscellaneousVars[33] < 0) MiscellaneousVars[33] = 0;
  if (MiscellaneousVars[34] < 0) MiscellaneousVars[34] = 0;
  if (MiscellaneousVars[35] < 0) MiscellaneousVars[35] = 0;
  if (MiscellaneousVars[36] < 0) MiscellaneousVars[36] = 0;

  MiscellaneousVars[21] = MiscellaneousVars[22];
  ClassCheck += 1; // Class Check is done six times for randomization purposes.
 }

 if (MiscellaneousVars[171] > 0) MiscellaneousVars[171] --; // Ticks down the "Level Up" and "Stat Up" indicators on the new HUD after a level up occurs
 if (MiscellaneousVars[2031] > 0) MiscellaneousVars[2031] --; // Ticks down the "MaxHP" gain timer
 if (MiscellaneousVars[2032] > 0) MiscellaneousVars[2032] --; // Ticks down the "MaxMP" gain timer
 if (MiscellaneousVars[2033] > 0) MiscellaneousVars[2033] --; // Ticks down the "AeonPts" gain timer
 if (MiscellaneousVars[2034] > 0) MiscellaneousVars[2034] --; // Ticks down the "Strength" gain timer
 if (MiscellaneousVars[2035] > 0) MiscellaneousVars[2035] --; // Ticks down the "Defense" gain timer
 if (MiscellaneousVars[2036] > 0) MiscellaneousVars[2036] --; // Ticks down the "Sorcery" gain timer
 if (MiscellaneousVars[2037] > 0) MiscellaneousVars[2037] --; // Ticks down the "Therapeusis" gain timer
 if (MiscellaneousVars[2038] > 0) MiscellaneousVars[2038] --; // Ticks down the "Agility" gain timer
 if (MiscellaneousVars[2039] > 0) MiscellaneousVars[2039] --; // Ticks down the "Deftness" gain timer

 if (MiscellaneousVars[2040] > 0) MiscellaneousVars[2040] --; // Ticks down Buff/Debuff Message #1 Timer
 if (MiscellaneousVars[2041] > 0) MiscellaneousVars[2041] --; // Ticks down Buff/Debuff Message #2 Timer
 if (MiscellaneousVars[2042] > 0) MiscellaneousVars[2042] --; // Ticks down Buff/Debuff Message #3 Timer
 if (MiscellaneousVars[2043] > 0) MiscellaneousVars[2043] --; // Ticks down Buff/Debuff Message #4 Timer
 if (MiscellaneousVars[2044] > 0) MiscellaneousVars[2044] --; // Ticks down Buff/Debuff Message #5 Timer

  // [222] # of TOTAL Max HP gained during multiple level ups [for displays]
  // [223] # of TOTAL Max MP gained during multiple level ups [for displays]
  // [224] # of TOTAL Aeon Points gained during multiple level ups [for displays]
  // [225] # of TOTAL Agility Points gained during multiple level ups [for displays]
  // [226] # of TOTAL Defense Points gained during multiple level ups [for displays]
  // [227] # of TOTAL Deftness Points gained during multiple level ups [for displays]
  // [228] # of TOTAL Sorcery Points gained during multiple level ups [for displays]
  // [229] # of TOTAL Strength Points gained during multiple level ups [for displays]
  // [230] # of TOTAL Therapeusis Points gained during multiple level ups [for displays]
  if (MiscellaneousVars[2031] <= 0) MiscellaneousVars[222] = 0;
  if (MiscellaneousVars[2032] <= 0) MiscellaneousVars[223] = 0;
  if (MiscellaneousVars[2033] <= 0) MiscellaneousVars[224] = 0;
  if (MiscellaneousVars[2034] <= 0) MiscellaneousVars[225] = 0;
  if (MiscellaneousVars[2035] <= 0) MiscellaneousVars[226] = 0;
  if (MiscellaneousVars[2036] <= 0) MiscellaneousVars[227] = 0;
  if (MiscellaneousVars[2037] <= 0) MiscellaneousVars[228] = 0;
  if (MiscellaneousVars[2038] <= 0) MiscellaneousVars[229] = 0;
  if (MiscellaneousVars[2039] <= 0) MiscellaneousVars[230] = 0;

 // [2501] Player should be frozen
 // [2502] Unfreeze Player
 FreezePlayer = 0;
 if (MiscellaneousVars[2500] == 1) FreezePlayer += 1; // Freezes the player's actions if in the menu...
 if (PowerupTimer[20] > 0) FreezePlayer += 1; // ...or put to sleep.
 if (FreezePlayer > 0)
 {
  SetPlayerProperty(1,1,PROP_TOTALLYFROZEN);
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",9,1); // Prevents Dashing
  //PrintBold(s:"Player Frozen!");
  MiscellaneousVars[2502] = 0;
 }
 else
 {
  if (MiscellaneousVars[2502] == 0)
  {
   SetPlayerProperty(1,0,PROP_TOTALLYFROZEN);
   SetUserArray(Player1TID,"user_PlayerDVDSSpecial",9,0); // Prevents Dashing
   //PrintBold(s:"Player UnFrozen!");
   MiscellaneousVars[2502] = 1;
  }
 }
 if (MenuSystemVars[0] == 1) // If the in-game menus are on, half velocity
 {
  SetActorVelocity(Player1TID, 0, 0, 0, 0, 0);
 }

 int jiggledecrease = random(4,6);
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) jiggledecrease += random(2,3);
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) jiggledecrease += random(0,1);
 int jigglecooldown = random(2,3);
 int jigglewarmup = 5;
 // Allows the player to "jiggle" out of sleep faster by pressing movement keys :V
 // [274] hold the "jump" var
 // [275] hold the "crouch" var
 // [276] hold the "jiggle left" var
 // [277] hold the "jiggle right" var
 // [278] hold the "jiggle up" var
 // [279] hold the "jiggle down" var
 if (MiscellaneousVars[274] > 0) MiscellaneousVars[274] -= 1;
 if (MiscellaneousVars[275] > 0) MiscellaneousVars[275] -= 1;
 if (MiscellaneousVars[276] > 0) MiscellaneousVars[276] -= 1;
 if (MiscellaneousVars[277] > 0) MiscellaneousVars[277] -= 1;
 if (MiscellaneousVars[278] > 0) MiscellaneousVars[278] -= 1;
 if (MiscellaneousVars[279] > 0) MiscellaneousVars[279] -= 1;
 if (MiscellaneousVars[274] < 0) MiscellaneousVars[274] = 0;
 if (MiscellaneousVars[275] < 0) MiscellaneousVars[275] = 0;
 if (MiscellaneousVars[276] < 0) MiscellaneousVars[276] = 0;
 if (MiscellaneousVars[277] < 0) MiscellaneousVars[277] = 0;
 if (MiscellaneousVars[278] < 0) MiscellaneousVars[278] = 0;
 if (MiscellaneousVars[279] < 0) MiscellaneousVars[279] = 0;
 if (PowerupTimer[20] > 0) // ... put to sleep.
 {
  if (buttons & BT_JUMP | buttons & BT_MOVEUP) // "Crouch"
  {
   if (MiscellaneousVars[274] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] += jigglewarmup;
	MiscellaneousVars[277] -= jigglecooldown;
	MiscellaneousVars[278] -= jigglecooldown;
	MiscellaneousVars[279] -= jigglecooldown;
   }
  }
  else
  if (buttons & BT_CROUCH | buttons & BT_MOVEDOWN) // "Crouch"
  {
   if (MiscellaneousVars[275] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] += jigglewarmup;
	MiscellaneousVars[277] -= jigglecooldown;
	MiscellaneousVars[278] -= jigglecooldown;
	MiscellaneousVars[279] -= jigglecooldown;
   }
  }
  else
  if (buttons & BT_LEFT | buttons & BT_MOVELEFT) // Move "Left"
  {
   if (MiscellaneousVars[276] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] += jigglewarmup;
	MiscellaneousVars[277] -= jigglecooldown;
	MiscellaneousVars[278] -= jigglecooldown;
	MiscellaneousVars[279] -= jigglecooldown;
   }
  }
  else
  if (buttons & BT_RIGHT | buttons & BT_MOVERIGHT) // Move "Right"
  {
   if (MiscellaneousVars[277] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] -= jigglecooldown;
	MiscellaneousVars[277] += jigglewarmup;
	MiscellaneousVars[278] -= jigglecooldown;
	MiscellaneousVars[279] -= jigglecooldown;
   }
  }
  else
  if (buttons & BT_FORWARD | buttons & BT_LOOKUP) // Move "Forward/Up"
  {
   if (MiscellaneousVars[278] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] -= jigglecooldown;
	MiscellaneousVars[277] -= jigglecooldown;
	MiscellaneousVars[278] += jigglewarmup;
	MiscellaneousVars[279] -= jigglecooldown;
   }
  }
  else
  if (buttons & BT_BACK | buttons & BT_LOOKDOWN) // Move "Backwards/Down"
  {
   if (MiscellaneousVars[279] < 1)
   {
    PowerupTimer[20] -= jiggledecrease;
	MiscellaneousVars[274] -= jigglecooldown;
	MiscellaneousVars[275] -= jigglecooldown;
	MiscellaneousVars[276] -= jigglecooldown;
	MiscellaneousVars[277] -= jigglecooldown;
	MiscellaneousVars[278] -= jigglecooldown;
	MiscellaneousVars[279] += jigglewarmup;
   }
  }
/*
  PrintBold(s:"Sleep Timer: ",d:PowerupTimer[20],s:"\n",s:"\n",
            s:"Jump: ",d:MiscellaneousVars[274],s:"\n",
            s:"Crouch: ",d:MiscellaneousVars[275],s:"\n",
            s:"Left: ",d:MiscellaneousVars[276],s:"\n",
            s:"Right: ",d:MiscellaneousVars[277],s:"\n",
			s:"Up: ",d:MiscellaneousVars[278],s:"\n",
			s:"Down: ",d:MiscellaneousVars[279],s:"\n");
*/
  if (PowerupTimer[20] < 0) PowerupTimer[20] = 0;
 }
 
 // ** Checks "user_PlayerDVDSSpecial[]" array on the player actors [used for various things, including disjointed MAP-specfic ACS scripts (TCOTD:A, Unloved, etc)]
 int DVDSSpecialArrayCheck = 0;
 while (DVDSSpecialArrayCheck < 256)
 {
  DVDSSpecialArrayValue[DVDSSpecialArrayCheck] = GetUserArray(Player1TID,"user_PlayerDVDSSpecial",DVDSSpecialArrayCheck);
  DVDSSpecialArrayCheck++;
 }
 // DVDSSpecialArrayValue[1] = Sets MP/Mana to 0 then unsets itself
 if (DVDSSpecialArrayValue[1] > 0)
 {
  CurrentMana = 0;
  DVDSSpecialArrayValue[1] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",1,0);
 }
 // DVDSSpecialArrayValue[2] = Sets Stamina to 0 then unsets itself
 if (DVDSSpecialArrayValue[2] > 0)
 {
  MiscellaneousVars[21] = 0;
  DVDSSpecialArrayValue[2] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",2,0);
 }
 // DVDSSpecialArrayValue[3] = Unloved Specfic - Makes Hellcore Weapons drop 4x more often, etc :o
 if (DVDSSpecialArrayValue[3] > 0) 
 {

  DVDSSpecialArrayValue[3] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",3,0);
 }
 // DVDSSpecialArrayValue[4] = TCOTD:A Specfic
 if (DVDSSpecialArrayValue[4] > 0) 
 {

  DVDSSpecialArrayValue[4] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",4,0);
 }
 // DVDSSpecialArrayValue[5] = Circus2 Specfic
 if (DVDSSpecialArrayValue[5] > 0) 
 {

  DVDSSpecialArrayValue[5] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",5,0);
 }
 // DVDSSpecialArrayValue[6] = Make HUD invisible [for TITLEMAP usage]
 if (DVDSSpecialArrayValue[6] > 0) 
 {
  if (MiscellaneousVars[1999] == -1)
  {
   MiscellaneousVars[1999] = MiscellaneousVars[2000];
   if (MiscellaneousVars[2000] == 0) GiveActorInventory(Player1TID,"DVDSOldHud",1); else TakeActorInventory(Player1TID,"DVDSOldHud",0x7FFFFFFF); 
   MiscellaneousVars[2000] = -1;
  }

  DVDSSpecialArrayValue[6] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",6,0);
 }
 // DVDSSpecialArrayValue[7] = Make HUD visible again
 if (DVDSSpecialArrayValue[7] > 0) 
 {
  if (MiscellaneousVars[1999] != -1)
  {
   MiscellaneousVars[2000] = MiscellaneousVars[1999];
   if (MiscellaneousVars[2000] == 0) GiveActorInventory(Player1TID,"DVDSOldHud",1); else TakeActorInventory(Player1TID,"DVDSOldHud",0x7FFFFFFF); 
   MiscellaneousVars[1999] = -1;
  }

  DVDSSpecialArrayValue[7] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",7,0);
 }
 // DVDSSpecialArrayValue[8] = Remove all weapons [TITLEMAP]
 if (DVDSSpecialArrayValue[8] > 0) 
 {
  ClearActorInventory(Player1TID);
  TakeActorInventory(Player1TID,"SceptreOfEmpyrea",0x7FFFFFFF);
  DVDSSpecialArrayValue[8] = 0;
  SetUserArray(Player1TID,"user_PlayerDVDSSpecial",8,0);
 }


 // Check for Sceptre Abilities
 MiscellaneousVars[244] = 0;
 if (CharacterClass == 2 && PlayerLevel >= 8 && SceptreActualLevel >= 2) MiscellaneousVars[244] = 1;

 // Delays the levelup speech for a character
 if (MiscellaneousVars[247] > 0)
 {
  MiscellaneousVars[180]++;
  if (MiscellaneousVars[180] >= 105)
  {
   if (random(1,100) <= GetCVar("dvds_levelspeechchance") && GetActorProperty(Player1TID,APROP_Health) > 0)
   {
    //if (CharacterClass == 0)
    //if (CharacterClass == 1)
    if (CharacterClass == 2) PlaySound(Player1TID,"FloraLevelSpeech",CHAN_VOICE,1.0,0,ATTN_NORM);
   }
   MiscellaneousVars[247] = 0;
   MiscellaneousVars[180] = 0;
  }
 }

 // Strife Flag Checks
 SetActivator(Player1TID);
 int sigil_pieces = GetSigilPieces();
 SetActivator(0);
 if (sigil_pieces == 1) GiveActorInventory(Player1TID,"SigilPhase1", 1); else TakeActorInventory(Player1TID,"SigilPhase1", 9999);
 if (sigil_pieces == 2) GiveActorInventory(Player1TID,"SigilPhase2", 1); else TakeActorInventory(Player1TID,"SigilPhase2", 9999);
 if (sigil_pieces == 3) GiveActorInventory(Player1TID,"SigilPhase3", 1); else TakeActorInventory(Player1TID,"SigilPhase3", 9999);
 if (sigil_pieces == 4) GiveActorInventory(Player1TID,"SigilPhase4", 1); else TakeActorInventory(Player1TID,"SigilPhase4", 9999);
 if (sigil_pieces == 5) GiveActorInventory(Player1TID,"SigilComplete", 1); else TakeActorInventory(Player1TID,"SigilComplete", 9999);
 if (CheckActorInventory(Player1TID,"QuestItem27") > 0 && CheckActorInventory(Player1TID,"QuestItem25") > 0) GiveActorInventory(Player1TID,"BestEndingFlag", 1); else TakeActorInventory(Player1TID,"BestEndingFlag", 9999);

 if (MiscellaneousVars[525] == 0) // Checks if you've destroyed the Acolye Converter in Strife MAP24 [Conversion Chapel]
 {
  if(CheckActorInventory(Player1TID,"QuestItem25") == 1)
  {
   SetActorProperty(Player1TID,APROP_Stamina,GetActorProperty(Player1TID,APROP_Stamina)-10); // Remove the extra Stamina given
   SetActorProperty(Player1TID,APROP_Accuracy,GetActorProperty(Player1TID,APROP_Accuracy)-10); // Remove the extra Accuracy given
   ACS_NamedExecuteAlways("StrifeComboUpgrade",0,1);
   MiscellaneousVars[525]++;
  }
 }
 if (MiscellaneousVars[529] == 0) // Checks if you've destroyed the Drone Trasmitter in Strife MAP14 [The Mines]
 {
  if(CheckActorInventory(Player1TID,"QuestItem29") == 1)
  {
   SetActorProperty(Player1TID,APROP_Stamina,GetActorProperty(Player1TID,APROP_Stamina)-10); // Remove the extra Stamina given
   SetActorProperty(Player1TID,APROP_Accuracy,GetActorProperty(Player1TID,APROP_Accuracy)-10); // Remove the extra Accuracy given
   ACS_NamedExecuteAlways("StrifeComboUpgrade",0,1);
   MiscellaneousVars[529]++;
  }
 }

 // Other Weapon Checks
 If(StrIcmp(weapon, "EvilWarriorShield") == 0) { GiveActorInventory(Player1TID,"EWShieldIdleMode",1); } else { TakeActorInventory(Player1TID,"EWShieldIdleMode",0x7FFFFFFF); }
 
 //*********************
 // Grand-Mastery Perks
 //*********************
 int perks3mastered;
 perks3mastered = 0;
 if (MiscellaneousVars[10001] == 5) perks3mastered++;
 if (MiscellaneousVars[10003] == 5) perks3mastered++;
 if (MiscellaneousVars[10005] == 5) perks3mastered++;
 if (MiscellaneousVars[10007] == 5) perks3mastered++;
 if (MiscellaneousVars[10009] == 5) perks3mastered++;
 if (MiscellaneousVars[10011] == 5) perks3mastered++;
 if (MiscellaneousVars[10013] == 5) perks3mastered++;
 if (MiscellaneousVars[10015] == 5) perks3mastered++;
 if (MiscellaneousVars[10017] == 5) perks3mastered++;
 if (MiscellaneousVars[10019] == 5) perks3mastered++;
 if (MiscellaneousVars[10021] == 5) perks3mastered++;
 if (MiscellaneousVars[10023] == 5) perks3mastered++;
 if (MiscellaneousVars[10025] == 5) perks3mastered++;
 if (MiscellaneousVars[10031] == 5) perks3mastered++;
 if (MiscellaneousVars[10033] == 5) perks3mastered++;
 if (MiscellaneousVars[10035] == 5) perks3mastered++;
 if (MiscellaneousVars[10037] == 7) perks3mastered++;
 if (MiscellaneousVars[10043] == 3) perks3mastered++;
 if (MiscellaneousVars[10045] == 5) perks3mastered++;
 if (MiscellaneousVars[10047] == 5) perks3mastered++;
 if (CharacterClass == 1)
 {
  if (MiscellaneousVars[10049] == 4) perks3mastered++;
 }
 else
 {
  if (MiscellaneousVars[10049] == 5) perks3mastered++;
 }
 if (MiscellaneousVars[10050] == 4) perks3mastered++;
 if (MiscellaneousVars[10051] == 5) perks3mastered++;
 if (MiscellaneousVars[10053] == 5) perks3mastered++;
 if (MiscellaneousVars[10055] == 5) perks3mastered++;

 if (perks3mastered >= 15) { MiscellaneousVars[11001] = 2; } // Higher Learning Lvl 2 Enabled
 else if (perks3mastered >= 5) { MiscellaneousVars[11001] = 1; } // Higher Learning Enabled
 else { MiscellaneousVars[11001] = 0; } // Higher Learning Disabled
 
 int TempMaxHealth = MaxHealthTrue;
 int TempMaxMana = MaxMana;
 int TempPerkFactor = 0;
 int TempCombinedLevels = 0;
 int TempStartValue;
 int TempEndValue;

 //****************
 //*HP Perk Checks*
 //****************
 // "LifeUp [EX]" perks
 TempCombinedLevels = MiscellaneousVars[10001] + MiscellaneousVars[10002];
 // [9901] = LifeUp Perk ComboLevel Check
 // [9902] = LifeUp Perk PerkFactor
 // [9903] = LifeUp Perk Base PerkFactor
 if (MiscellaneousVars[9901] != TempCombinedLevels)
 {
  if (MiscellaneousVars[9901] != 0)
  {
   MiscellaneousVars[9903] = MiscellaneousVars[9902];
   TempStartValue = MaxHealthTrue;
   TempEndValue = MaxHealthTrue;
   TempEndValue = TempEndValue * ((1000000 / MiscellaneousVars[9902])) / 1000;
   TempEndValue += random(0,1);
   //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9902],s:") / ",d:TempEndValue);
  }
  else
  {
   MiscellaneousVars[9903] = 1000;
   TempStartValue = MaxHealthTrue;
   TempEndValue = MaxHealthTrue;
  }
  MiscellaneousVars[9902] = (MiscellaneousVars[10001] * 50) + (MiscellaneousVars[10002] * 125) + 1000;

  TempStartValue = TempEndValue;
  TempEndValue = TempEndValue * MiscellaneousVars[9902] / 1000;
  TempEndValue += random(0,1);
  //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9902],s:") / ",d:TempEndValue);

  MaxHealthTrue = TempEndValue;
  SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);

  MiscellaneousVars[9901] = TempCombinedLevels;
 }

 // [STRIFE-Compatibility] Stamina Upgrades [HP side]
 TempCombinedLevels = MiscellaneousVars[317];
 // [9907] = Stamina Upgrade [HP] ComboLevel Check
 // [9908] = Stamina Upgrade [HP] PerkFactor
 // [9909] = Stamina Upgrade [HP] Base PerkFactor
 if (MiscellaneousVars[9907] != TempCombinedLevels)
 {
  if (MiscellaneousVars[9907] != 0)
  {
   MiscellaneousVars[9909] = MiscellaneousVars[9908];
   TempStartValue = MaxHealthTrue;
   TempEndValue = MaxHealthTrue;
   TempEndValue = TempEndValue * ((1000000 / MiscellaneousVars[9908])) / 1000;
   TempEndValue += random(0,1);
   //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9908],s:") / ",d:TempEndValue);
  }
  else
  {
   MiscellaneousVars[9909] = 1000;
   TempStartValue = MaxHealthTrue;
   TempEndValue = MaxHealthTrue;
  }
  MiscellaneousVars[9908] = (MiscellaneousVars[317] * 125) + 1000;

  TempStartValue = TempEndValue;
  TempEndValue = TempEndValue * MiscellaneousVars[9908] / 1000;
  TempEndValue += random(0,1);
  //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9908],s:") / ",d:TempEndValue);

  MaxHealthTrue = TempEndValue;
  SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);

  MiscellaneousVars[9907] = TempCombinedLevels;
 }

 //****************
 //*MP Perk Checks*
 //****************
 // "MagiUp [EX]" perks
 TempCombinedLevels = MiscellaneousVars[10003] + MiscellaneousVars[10004];
 // [9904] = MagiUp Perk ComboLevel Check
 // [9905] = MagiUp Perk PerkFactor
 // [9906] = MagiUp Perk Base PerkFactor
 if (MiscellaneousVars[9904] != TempCombinedLevels)
 {
  if (MiscellaneousVars[9904] != 0)
  {
   MiscellaneousVars[9906] = MiscellaneousVars[9905];
   TempStartValue = MaxMana;
   TempEndValue = MaxMana;
   TempEndValue = TempEndValue * ((1000000 / MiscellaneousVars[9905])) / 1000;
   TempEndValue += random(0,1);
   //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9905],s:") / ",d:TempEndValue);
  }
  else
  {
   MiscellaneousVars[9906] = 1000;
   TempStartValue = MaxMana;
   TempEndValue = MaxMana;
  }
  MiscellaneousVars[9905] = (MiscellaneousVars[10003] * 50) + (MiscellaneousVars[10004] * 125) + 1000;

  TempStartValue = TempEndValue;
  TempEndValue = TempEndValue * MiscellaneousVars[9905] / 1000;
  TempEndValue += random(0,1);
  //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9905],s:") / ",d:TempEndValue);

  MaxMana = TempEndValue;

  MiscellaneousVars[9904] = TempCombinedLevels;
 }

 // [STRIFE-Compatibility] Stamina Upgrades [MP side]
 TempCombinedLevels = MiscellaneousVars[317];
 // [9910] = Stamina Upgrade [MP] ComboLevel Check
 // [9911] = Stamina Upgrade [MP] PerkFactor
 // [9912] = Stamina Upgrade [MP] Base PerkFactor
 if (MiscellaneousVars[9910] != TempCombinedLevels)
 {
  if (MiscellaneousVars[9910] != 0)
  {
   MiscellaneousVars[9912] = MiscellaneousVars[9911];
   TempStartValue = MaxMana;
   TempEndValue = MaxMana;
   TempEndValue = TempEndValue * ((1000000 / MiscellaneousVars[9911])) / 1000;
   TempEndValue += random(0,1);
   //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9911],s:") / ",d:TempEndValue);
  }
  else
  {
   MiscellaneousVars[9912] = 1000;
   TempStartValue = MaxMana;
   TempEndValue = MaxMana;
  }
  MiscellaneousVars[9911] = (MiscellaneousVars[317] * 125) + 1000;

  TempStartValue = TempEndValue;
  TempEndValue = TempEndValue * MiscellaneousVars[9911] / 1000;
  TempEndValue += random(0,1);
  //PrintBold(d:TempStartValue,s:" / (",d:MiscellaneousVars[9911],s:") / ",d:TempEndValue);

  MaxMana = TempEndValue;

  MiscellaneousVars[9910] = TempCombinedLevels;
 }

 int DemoRandom = random(1,3);
 // Demolitions Expert Bonuses
 TakeActorInventory(Player1TID,"DemolitionsExpert1_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert1_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert1_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert1a_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert1a_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert1a_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2a_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2a_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert2a_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3a_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3a_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert3a_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4a_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4a_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert4a_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5_3",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5a_1",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5a_2",0x7FFFFFFF);
 TakeActorInventory(Player1TID,"DemolitionsExpert5a_3",0x7FFFFFFF);
 if (MiscellaneousVars[10025] >= 0)
 {
  if (MiscellaneousVars[10025] == 1)
  {
   if (MiscellaneousVars[10026] == 1)
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert1a_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert1a_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert1a_3",1);
   }
   else
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert1_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert1_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert1_3",1);
   }
  }
  else
  if (MiscellaneousVars[10025] == 2)
  {
   if (MiscellaneousVars[10026] == 1)
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert2a_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert2a_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert2a_3",1);
   }
   else
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert2_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert2_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert2_3",1);
   }
  }
  else
  if (MiscellaneousVars[10025] == 3)
  {
   if (MiscellaneousVars[10026] == 1)
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert3a_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert3a_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert3a_3",1);
   }
   else
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert3_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert3_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert3_3",1);
   }
  }
  else
  if (MiscellaneousVars[10025] == 4)
  {
   if (MiscellaneousVars[10026] == 1)
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert4a_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert4a_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert4a_3",1);
   }
   else
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert4_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert4_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert4_3",1);
   }
  }
  else
  if (MiscellaneousVars[10025] == 5)
  {
   if (MiscellaneousVars[10026] == 1)
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert5a_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert5a_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert5a_3",1);
   }
   else
   {
    if (DemoRandom == 1) GiveActorInventory(Player1TID,"DemolitionsExpert5_1",1);
    if (DemoRandom == 2) GiveActorInventory(Player1TID,"DemolitionsExpert5_2",1);
    if (DemoRandom == 3) GiveActorInventory(Player1TID,"DemolitionsExpert5_3",1);
   }
  }
 }

 // Wand/Staff Mastery Bonuses
 if (MiscellaneousVars[10053] >= 0)
 {
  if (MiscellaneousVars[10053] == 1) GiveActorInventory(Player1TID,"WandStaffMasteryATK1",1); else TakeActorInventory(Player1TID,"WandStaffMasteryATK1",0x7FFFFFFF);
  if (MiscellaneousVars[10053] == 2) GiveActorInventory(Player1TID,"WandStaffMasteryATK2",1); else TakeActorInventory(Player1TID,"WandStaffMasteryATK2",0x7FFFFFFF);
  if (MiscellaneousVars[10053] == 3) GiveActorInventory(Player1TID,"WandStaffMasteryATK3",1); else TakeActorInventory(Player1TID,"WandStaffMasteryATK3",0x7FFFFFFF);
  if (MiscellaneousVars[10053] == 4) GiveActorInventory(Player1TID,"WandStaffMasteryATK4",1); else TakeActorInventory(Player1TID,"WandStaffMasteryATK4",0x7FFFFFFF);
  if (MiscellaneousVars[10053] == 5) GiveActorInventory(Player1TID,"WandStaffMasteryATK5",1); else TakeActorInventory(Player1TID,"WandStaffMasteryATK5",0x7FFFFFFF);
 }
 else
 {
  TakeActorInventory(Player1TID,"WandStaffMasteryATK1",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"WandStaffMasteryATK2",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"WandStaffMasteryATK3",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"WandStaffMasteryATK4",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"WandStaffMasteryATK5",0x7FFFFFFF);
 }
 
 // Clearer of Mind Bonuses [Marines Only]
 if (CharacterClass == 0 || CharacterClass == 1)
 {
  if (MiscellaneousVars[10055] >= 0)
  {
   if (MiscellaneousVars[10055] == 1) GiveActorInventory(Player1TID,"CoMATK1",1); else TakeActorInventory(Player1TID,"CoMATK1",0x7FFFFFFF);
   if (MiscellaneousVars[10055] == 2) GiveActorInventory(Player1TID,"CoMATK2",1); else TakeActorInventory(Player1TID,"CoMATK2",0x7FFFFFFF);
   if (MiscellaneousVars[10055] == 3) GiveActorInventory(Player1TID,"CoMATK3",1); else TakeActorInventory(Player1TID,"CoMATK3",0x7FFFFFFF);
   if (MiscellaneousVars[10055] == 4) GiveActorInventory(Player1TID,"CoMATK4",1); else TakeActorInventory(Player1TID,"CoMATK4",0x7FFFFFFF);
   if (MiscellaneousVars[10055] == 5) GiveActorInventory(Player1TID,"CoMATK5",1); else TakeActorInventory(Player1TID,"CoMATK5",0x7FFFFFFF);
  }
  else
  {
   TakeActorInventory(Player1TID,"CoMATK1",0x7FFFFFFF);
   TakeActorInventory(Player1TID,"CoMATK2",0x7FFFFFFF);
   TakeActorInventory(Player1TID,"CoMATK3",0x7FFFFFFF);
   TakeActorInventory(Player1TID,"CoMATK4",0x7FFFFFFF);
   TakeActorInventory(Player1TID,"CoMATK5",0x7FFFFFFF);
  }
 }
 else
 {
  TakeActorInventory(Player1TID,"CoMATK1",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"CoMATK2",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"CoMATK3",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"CoMATK4",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"CoMATK5",0x7FFFFFFF);
 }

 // Soul Mastery Bonuses
 if (MiscellaneousVars[10033] >= 0)
 {
  if (MiscellaneousVars[10033] == 1) GiveActorInventory(Player1TID,"SoulMasteryATK1",1); else TakeActorInventory(Player1TID,"SoulMasteryATK1",0x7FFFFFFF);
  if (MiscellaneousVars[10033] == 2) GiveActorInventory(Player1TID,"SoulMasteryATK2",1); else TakeActorInventory(Player1TID,"SoulMasteryATK2",0x7FFFFFFF);
  if (MiscellaneousVars[10033] == 3) GiveActorInventory(Player1TID,"SoulMasteryATK3",1); else TakeActorInventory(Player1TID,"SoulMasteryATK3",0x7FFFFFFF);
  if (MiscellaneousVars[10033] == 4) GiveActorInventory(Player1TID,"SoulMasteryATK4",1); else TakeActorInventory(Player1TID,"SoulMasteryATK4",0x7FFFFFFF);
  if (MiscellaneousVars[10033] == 5) GiveActorInventory(Player1TID,"SoulMasteryATK5",1); else TakeActorInventory(Player1TID,"SoulMasteryATK5",0x7FFFFFFF);
 }
 else
 {
  TakeActorInventory(Player1TID,"SoulMasteryATK1",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"SoulMasteryATK2",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"SoulMasteryATK3",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"SoulMasteryATK4",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"SoulMasteryATK5",0x7FFFFFFF);
 }

/*
 int TempBitField = 1.0;
 if (MiscellaneousVars[10001] >= 1) TempBitField -= 0.025;
 if (MiscellaneousVars[10001] >= 2) TempBitField -= 0.025;
 if (MiscellaneousVars[10001] >= 3) TempBitField -= 0.025;
 if (MiscellaneousVars[10001] >= 4) TempBitField -= 0.025;
 if (MiscellaneousVars[10001] >= 5) TempBitField -= 0.025;
 if (MiscellaneousVars[10002] >= 1) TempBitField -= 0.0625;
 if (MiscellaneousVars[10002] >= 2) TempBitField -= 0.0625;
 //PrintBold(f:TempBitField);
 SetActorProperty(Player1TID,APROP_DAMAGEFACTOR,TempBitField);
*/

 int TimerMulti;
 int TimerPart1;
 // Check EXP Kill Combo Timer
 if (MiscellaneousVars[157] > 0)
 {
  TimerMulti = 20 * GetCVar("dvds_expcombotimermultiplier") / 100;
  TimerPart1 = 100;
  if (CharacterClass == 2)
  {
   if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) TimerPart1 -= 10; // Item 1
   if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) TimerPart1 -= 5; // Item 5
   if (CheckActorInventory(Player1TID,"DivineShield") > 0) TimerPart1 -= 15; // Item 8

   if (CheckActorInventory(Player1TID,"RuinousShield") > 0) TimerPart1 *= 2;
  }
  else
  {
   if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) TimerPart1 -= 5;
   if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) TimerPart1 -= 10;
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) TimerPart1 -= 15;
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) TimerPart1 -= 20;
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) TimerPart1 -= 25;
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) TimerPart1 -= 30;
  }
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0) TimerPart1 -= 20;
  if (TimerPart1 < 40) TimerPart1 = 40;
  if (TimerPart1 > 250) TimerPart1 = 250;
  TimerMulti = (TimerMulti * TimerPart1) / 100;

  if (PowerupTimer[5] > 0) TimerMulti = TimerMulti / 15;
  if (TimerMulti < 1) TimerMulti = 1;
  MiscellaneousVars[157] -= TimerMulti;
 }
 int tempaeonpts;
 if (MiscellaneousVars[157] <= 0) // Timer Runs out
 {
  int comboamount = MiscellaneousVars[158]; // Temporarily saves the kill combo counter for Aeon Point Checks
  if (comboamount > 0) 
  {
   //** Aeon Point Distribution [Combos] **
   int basecomboneeded = GetCVar("dvdsperks_combobase");
   int combolevel1 = basecomboneeded * 1;
   int combolevel2 = basecomboneeded * 3;
   int combolevel3 = basecomboneeded * 7;
   int combolevel4 = basecomboneeded * 12;
   // PrintBold(s:"Combo Amount: ",d:comboamount,s:"\n",             s:"Lvl 1 Req: ",d:combolevel1,s:"\n",             s:"Lvl 2 Req: ",d:combolevel2,s:"\n",             s:"Lvl 3 Req: ",d:combolevel3,s:"\n",             s:"Lvl 4 Req: ",d:combolevel4,s:"\n"			);
  }
  
  if (basecomboneeded > 0 && comboamount > 0)
  {
   //PrintBold(s:"jln2k5mk54");
   if (comboamount >= combolevel1 && comboamount < combolevel2)
   {
    tempaeonpts = (comboamount / basecomboneeded);
    //PrintBold(s:"Aeon Points Gained [Combo Lvl 1]: ",d:tempaeonpts);
   }
   if (comboamount >= combolevel2 && comboamount < combolevel3)
   {
    tempaeonpts = (comboamount / basecomboneeded) * 3 / 2;
    //PrintBold(s:"Aeon Points Gained [Combo Lvl 2]: ",d:tempaeonpts);
   }
   if (comboamount >= combolevel3 && comboamount < combolevel4)
   {
    tempaeonpts = (comboamount / basecomboneeded) * 5 / 2;
    //PrintBold(s:"Aeon Points Gained [Combo Lvl 3]: ",d:tempaeonpts);
   }
   if (comboamount >= combolevel4)
   {
    tempaeonpts = (comboamount / basecomboneeded) * 4;
    //PrintBold(s:"Aeon Points Gained [Combo Lvl 4]: ",d:tempaeonpts);
   }

   if (tempaeonpts > 0)
   {
    tempaeonpts *= MiscellaneousVars[86];
    MiscellaneousVars[25] += tempaeonpts; MiscellaneousVars[224] += tempaeonpts; MiscellaneousVars[2033] = 105;
    if (PlayerLevel >= MiscellaneousVars[197])
    {
     SetHudSize(0,0,0);
     HudMessage(s:"You have gained ",d:tempaeonpts,s:" Aeon Point[s] for a high enough kill combo!\n\nRemember to allocate your Aeon Points as soon as possible...";
     HUDMSG_LOG,3432,cr_orange,1.5,0.5,2.75);
    }
   }
  }
 
  tempaeonpts = 0;
  comboamount = 0;
  MiscellaneousVars[158] = 0; // Set kill counter back to 0
  MiscellaneousVars[160] = 0; // Set EXP Combo Amount back to 0
 }

 
 
 
 
 int DivineRegenTimer;
 if (PowerupTimer[7] > 0)
 {
  DivineRegenTimer -= 1;
  if (DivineRegenTimer < 1)
  {
   DivineRegenTimer = random(30,35);
   C3 = MaxHealthLimit / random(67,100);
   if (CharacterClass == 0 && CheckActorInventory(Player1TID, "SauronGauntlets") > 0) C3 = C3 * 17 / 16;
   if (CharacterClass == 1 && CheckActorInventory(Player1TID, "SauronGauntletsIllucia") > 0) C3 = C3 * 17 / 16;
   if (CharacterClass == 2 && CheckActorInventory(Player1TID, "SauronGauntletsFlora") > 0) C3 = C3 * 17 / 16;
   if (CharacterClass == 8 && CheckActorInventory(Player1TID, "SauronGauntletsAilish") > 0) C3 = C3 * 17 / 16;
   if (CharacterClass == 9 && CheckActorInventory(Player1TID, "SauronGauntletsPetra") > 0) C3 = C3 * 17 / 16;
   if (CheckActorInventory(Player1TID, "TheOneRing") > 0) C3 = C3 * 9 / 8;
   I3 = GetActorProperty(Player1TID,APROP_HEALTH);
   if (I3 > 0 && I3 < MaxHealthLimit)
   {
    I3 += C3;
    if (I3 >= MaxHealthLimit) I3 = MaxHealthLimit;
    SetActorProperty(Player1TID,APROP_HEALTH,I3);
    MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
    MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
   }
  }
 }

 int DoveRegenTimer;
 DoveRegenTimer -= 1;
 if (DoveRegenTimer < 1)
 {
  DoveRegenTimer = random(27,32);
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"DoveRibbon") > 0) // Flora
  {
   C3 = PlayerLevel / 50 + 1;
   I3 = GetActorProperty(Player1TID,APROP_HEALTH);
   if (I3 > 0 && I3 < MaxHealthLimit)
   {
    I3 += C3;
    if (I3 >= MaxHealthLimit) I3 = MaxHealthLimit;
    SetActorProperty(Player1TID,APROP_HEALTH,I3);
    MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
    MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
   }
  }
 }



 //*******************************************************************************
 //*Attempting to Interpolate Health Values for the player to show damage values.*
 //*******************************************************************************
 int HealthDifferenceTimer;
 int ArmorResistance, ArmRes1, ArmRes2, ArmRes3;
 if (ClassCheck > 2)
 {
  if (HealthDifferenceTimer > 0)
  {
   MiscellaneousVars[241] = MiscellaneousVars[175];
   MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
   MiscellaneousVars[173] = MiscellaneousVars[175] - MiscellaneousVars[241];
   MiscellaneousVars[174] = MiscellaneousVars[173] * 100 / MaxHealthTrue;

   MiscellaneousVars[243] = MiscellaneousVars[238];
   MiscellaneousVars[238] = CurrentMana;
   MiscellaneousVars[236] = MiscellaneousVars[238] - MiscellaneousVars[243];
   MiscellaneousVars[237] = MiscellaneousVars[236] * 100 / MaxMana;

   if (CharacterClass != 2)
   {
    if (CurrentMaxArmor > 0)
    {
     MiscellaneousVars[242] = MiscellaneousVars[178];
     MiscellaneousVars[178] = CheckActorInventory(Player1TID,"BasicArmor");
     MiscellaneousVars[176] = MiscellaneousVars[178] - MiscellaneousVars[242];
     MiscellaneousVars[177] = MiscellaneousVars[176] * 100 / CurrentMaxArmor;
    }
    else
    {
     MiscellaneousVars[242] = MiscellaneousVars[178];
     MiscellaneousVars[178] = CheckActorInventory(Player1TID,"BasicArmor");
     MiscellaneousVars[176] = 0;
     MiscellaneousVars[177] = 0;
    }
   }

   ArmorResistance = 0;
   if (CharacterClass == 2)
   {
    if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) ArmorResistance += 30; // Item 1
    if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) ArmorResistance += 70; // Item 2
    if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) ArmorResistance += 80; // Item 3
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) ArmorResistance += 20; // Item 4
    if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) ArmorResistance += 40; // Item 5
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) ArmorResistance += 50; // Item 6
    if (CheckActorInventory(Player1TID,"KissaBra") > 0) ArmorResistance += 60; // Item 7
    if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorResistance += 160; // Item 8
    if (CheckActorInventory(Player1TID,"BalrogRing") > 0) ArmorResistance += 20; // Item 9
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) ArmorResistance += 90; // Item 10
    if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) ArmorResistance += 50; // Item 11
   }
   else
   {
    if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) ArmorResistance += 350;
    if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) ArmorResistance += 525;
    if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) ArmorResistance += 708;
    if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) ArmorResistance += 937;
    if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) ArmorResistance += 875;
    if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) ArmorResistance += 987;
   }

   MiscellaneousVars[233] = ArmorResistance;
   SavePercent = ArmorResistance / 10;

   int PopUpXPlacement = random(-128,128) * 1.0;
   int PopUpYPlacement = random(-96,96) * 1.0;
   int PopupHoldDuration = 0.0;
   int PopupFadeOutDuration = 0.0;

   if (Timer() > 3)
   {
    PopupHoldDuration = 0.0;
    PopupFadeOutDuration = 0.0;
    // HP/Health Damage/Heal
    MiscellaneousVars[173] = MiscellaneousVars[173];
    MiscellaneousVars[174] = MiscellaneousVars[174];
    MiscellaneousVars[175] = MiscellaneousVars[175];
    if (MiscellaneousVars[173] != 0)
    {
      SetHudSize(640,480,0);
      if (MiscellaneousVars[2000] == 0)
      {
       SetFont("DVDSSMLFONT");
       if (MiscellaneousVars[173] > 0) // Positive Value
       {
        if (MiscellaneousVars[174] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[174] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        HudMessageBold(s:"+",d:MiscellaneousVars[173],s:" HP (+",d:MiscellaneousVars[174],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_green,320.0+PopUpXPlacement,240.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[173] < 0) // Negative Value
       {
        MiscellaneousVars[173] *= -1;
        MiscellaneousVars[174] *= -1;
        if (MiscellaneousVars[174] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[174] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        if (MiscellaneousVars[175] <= 0) HudMessageBold(s:"FATAL!\n",s:"-",d:MiscellaneousVars[173],s:" HP (-",d:MiscellaneousVars[174],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_red,320.0+PopUpXPlacement,240.0+PopUpYPlacement,1.5+PopupHoldDuration,1.0+PopupFadeOutDuration,1.0);
        else HudMessageBold(s:"-",d:MiscellaneousVars[173],s:" HP (-",d:MiscellaneousVars[174],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_red,320.0+PopUpXPlacement,240.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
	   /*
	   else
	   if (MiscellaneousVars[173] == 0 && CheckFlag(Player1TID,"JUSTHIT") == 1)
	   {
	    SetFont("DVDSSMLFONT");
	    PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25;
	    HudMessageBold(s:"NO DAMAGE!";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_white,320.0+PopUpXPlacement,240.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
	   }
	   SetActorFlag(Player1TID,"JUSTHIT",0);
	   */
      }
    }

    PopupHoldDuration = 0.0;
    PopupFadeOutDuration = 0.0;
    // AP/Armor Damage/Heal
    if (CharacterClass != 2 && MiscellaneousVars[176] != 0)
    {
      SetHudSize(640,480,0);
      if (MiscellaneousVars[2000] == 0)
      {
       SetFont("DVDSSMLFONT");
       if (MiscellaneousVars[176] > 0) // Positive Value
       {
        if (MiscellaneousVars[177] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[177] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        HudMessageBold(s:"+",d:MiscellaneousVars[176],s:" AP (+",d:MiscellaneousVars[177],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_lightblue,308.0+PopUpXPlacement,228.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[176] < 0) // Negative Value
       {
        MiscellaneousVars[176] *= -1;
        MiscellaneousVars[177] *= -1;
        if (MiscellaneousVars[177] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[177] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        if (MiscellaneousVars[178] <= 0)
		{
		 HudMessageBold(s:"\ctARMOR BREAK!\n",s:"-",d:MiscellaneousVars[176],s:" AP (-",d:MiscellaneousVars[177],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_purple,308.0+PopUpXPlacement,228.0+PopUpYPlacement,1.5+PopupHoldDuration,1.0+PopupFadeOutDuration,1.0);
		 PlaySound(Player1TID,"marines/armorbroken",CHAN_ITEM,1.0,0,ATTN_NORM);
		}
        else 
		{ 
		 HudMessageBold(s:"\ct-",d:MiscellaneousVars[176],s:" AP (-",d:MiscellaneousVars[177],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_purple,308.0+PopUpXPlacement,228.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
		 PlaySound(Player1TID,"marines/armordamaged",CHAN_ITEM,1.0,0,ATTN_NORM);
		}
       }
      }
    }

    PopupHoldDuration = 0.0;
    PopupFadeOutDuration = 0.0;
    // MP/Mana Damage/Heal
    if (MiscellaneousVars[236] != 0)
    {
      SetHudSize(640,480,0);
      if (MiscellaneousVars[2000] == 0)
      {
       SetFont("DVDSSMLFONT");
       if (MiscellaneousVars[236] > 0) // Positive Value
       {
        if (MiscellaneousVars[237] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[237] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        HudMessageBold(s:"+",d:MiscellaneousVars[236],s:" MP (+",d:MiscellaneousVars[237],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_blue,332.0+PopUpXPlacement,252.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
       else
       if (MiscellaneousVars[236] < 0) // Negative Value
       {
        MiscellaneousVars[236] *= -1;
        MiscellaneousVars[237] *= -1;
        if (MiscellaneousVars[237] < 5) { PopupHoldDuration = -0.375; PopupFadeOutDuration = -0.25; }
        if (MiscellaneousVars[237] >= 30) SetFont("DVDSBIGFONT"); else SetFont("DVDSSMLFONT");
        if (MiscellaneousVars[238] <= 0) HudMessageBold(s:"MANA DEPLETED!\n",s:"-",d:MiscellaneousVars[236],s:" MP (-",d:MiscellaneousVars[237],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,332.0+PopUpXPlacement,252.0+PopUpYPlacement,1.5+PopupHoldDuration,1.0+PopupFadeOutDuration,1.0);
        else HudMessageBold(s:"",d:MiscellaneousVars[236],s:" MP (-",d:MiscellaneousVars[237],s:"%)";HUDMSG_ALPHA|HUDMSG_FADEOUT,0,cr_brick,332.0+PopUpXPlacement,252.0+PopUpYPlacement,0.75+PopupHoldDuration,0.5+PopupFadeOutDuration,0.834);
       }
      }
    }

   }
  }
  HealthDifferenceTimer += 1;
 }

 int InterPolLowestHealth, InterPolStrength;
 InterPolLowestHealth = MaxHealthTrue * -1;
 InterPolStrength = MaxHealthTrue / 35; // 8 is the average
 if (InterPolStrength < 4) InterPolStrength = 4;

 //**************************************************************************************************************
 //*Flicker the Player when they survive a mortal hit (mercy invincibility) and perform actions related to perks*
 //**************************************************************************************************************

 // [194] Mercy Invincibility "Flag"
 // [195] Mercy Invincibility Timer
 // [196] Mercy Invincibility 'Modulus/Remainder'

 // Death Rage Countdown Checks
 if (MiscellaneousVars[9043] > 0)
 {
  if (MiscellaneousVars[10043] == 1) GiveActorInventory(Player1TID,"DeathRageLv1",1); else TakeActorInventory(Player1TID,"DeathRageLv1",0x7FFFFFFF);
  if (MiscellaneousVars[10043] == 2) GiveActorInventory(Player1TID,"DeathRageLv2",1); else TakeActorInventory(Player1TID,"DeathRageLv2",0x7FFFFFFF);
  if (MiscellaneousVars[10043] == 3) GiveActorInventory(Player1TID,"DeathRageLv3",1); else TakeActorInventory(Player1TID,"DeathRageLv3",0x7FFFFFFF);
  GiveActorInventory(Player1TID,"DeathRageInvuln",1);
  FadeRange(208, 0, 32, 0.525, 0, 0, 0, 0.0, 0.5);
   
  MiscellaneousVars[9043] -= 1; // Death Rage Timer
 }
 else
 {
  if (CheckActorInventory(Player1TID,"DeathRageLv1") > 0) TakeActorInventory(Player1TID,"DeathRageLv1",0x7FFFFFFF);
  if (CheckActorInventory(Player1TID,"DeathRageLv2") > 0) TakeActorInventory(Player1TID,"DeathRageLv2",0x7FFFFFFF);
  if (CheckActorInventory(Player1TID,"DeathRageLv3") > 0) TakeActorInventory(Player1TID,"DeathRageLv3",0x7FFFFFFF);
  if (CheckActorInventory(Player1TID,"DeathRageInvuln") > 0) TakeActorInventory(Player1TID,"DeathRageInvuln",0x7FFFFFFF);
 }
 if (MiscellaneousVars[9044] > 0) MiscellaneousVars[9044] -= 1; // Cooldown Timer

 //MiscellaneousVars[241] = MiscellaneousVars[175];
 MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
 //PrintBold(d:MiscellaneousVars[241],s:" ",d:MiscellaneousVars[175]);
 if (MiscellaneousVars[175] == 1 && MiscellaneousVars[241] > 1 && GetCVar("dvds_survivemercyinvin") == 1)
 {
  MiscellaneousVars[194] = 1; // Turns on Mercy Invincibility Flag
  MiscellaneousVars[195] = 1210; // 1.5 seconds [51.5 tics * 20]



  //*************************************************
  //*Check "Mortal Hit Survivability Psyche Up" Perk*
  //*************************************************
  if (MiscellaneousVars[10037] > 0)
  {
   if (CharacterClass == 2) PerkFactor = 7500; else PerkFactor = 4000;
   if (random(1,10000) <= PerkFactor)
   {
    if (MiscellaneousVars[10037] == 1 && MiscellaneousVars[181] <= 1) ACS_NamedExecuteAlways("SetTensionLevel",0,1,0);
    if (MiscellaneousVars[10037] == 2 && MiscellaneousVars[181] <= 2) ACS_NamedExecuteAlways("SetTensionLevel",0,2,0);
    if (MiscellaneousVars[10037] == 3 && MiscellaneousVars[181] <= 3) ACS_NamedExecuteAlways("SetTensionLevel",0,3,0);
    if (MiscellaneousVars[10037] == 4 && MiscellaneousVars[181] <= 4) ACS_NamedExecuteAlways("SetTensionLevel",0,4,0);
    if (MiscellaneousVars[10037] == 5 && MiscellaneousVars[181] <= 5) ACS_NamedExecuteAlways("SetTensionLevel",0,5,0);
    if (MiscellaneousVars[10037] == 6 && MiscellaneousVars[181] <= 6) ACS_NamedExecuteAlways("SetTensionLevel",0,6,0);
    if (MiscellaneousVars[10037] == 7 && MiscellaneousVars[181] <= 7) ACS_NamedExecuteAlways("SetTensionLevel",0,7,0);
   }
  }

  //**********************************************************
  //*Check "Mortal Hit Survivability Mana Recovery [EX]" Perk*
  //**********************************************************
  if (MiscellaneousVars[10039] > 0)
  {
   PerkFactor = 0;
   if (MiscellaneousVars[10039] > 0) PerkFactor += 6666;
   if (MiscellaneousVars[10040] > 0) PerkFactor += 3334;
   if (random(1,10000) <= PerkFactor)
   {
    PerkFactor = 0;
    if (MiscellaneousVars[10039] > 0) PerkFactor += 25;
    if (MiscellaneousVars[10040] > 0) PerkFactor += 50;
    TempStartValue = MaxMana * PerkFactor / 100;
    TempEndValue = MaxMana * (100 + PerkFactor) / 100;
    if (CurrentMana < TempEndValue) CurrentMana += TempStartValue;
    if (CurrentMana > TempEndValue) CurrentMana = TempEndValue;
    FadeRange(192, 0, 192, 0.75, 0, 0, 0, 0.0, 0.5);
   }
  }



  //*******************************************************
  //*Check "Mortal Hit Survivability Blast Wave [EX]" Perk*
  //*******************************************************
  if (MiscellaneousVars[10041] > 0)
  {
   PerkFactor = 0;
   if (MiscellaneousVars[10041] > 0) PerkFactor += 5000;
   if (MiscellaneousVars[10042] > 0) PerkFactor += 2500;
   if (random(1,10000) <= PerkFactor)
   {
    SetActivator(Player1TID); ActivatorSound("MortalHit/BlastWave",127); SetActivator(0);
    FadeRange(255, 192, 1, 0.75, 0, 0, 0, 0.0, 0.5);

    project_RealZ = GetActorZ(Player1TID) + (GetActorViewHeight(Player1TID) * 39 / 50) + 8.0;
    SetActivator(Player1TID);
    SpawnProjectile(0, "PlayerMortalBlastRadius", 0, 0, 0, 0, 2102);
    SetActorVelocity(2102, 0, 0, 0, 0, 0);
    SetActorAngle(2102, 0.0);
    SetActorPosition(2102, GetActorX(Player1TID), GetActorY(Player1TID), project_RealZ, 0);
    Thing_ChangeTID(2102,4443);
    SetActivator(0);
   }
  }

  
  //****************************************************
  //*Check "Mortal Hit Survivability 'Death Rage'" Perk*
  //****************************************************
  if (MiscellaneousVars[10043] > 0 && MiscellaneousVars[9044] == 0)
  {
   if (MiscellaneousVars[10043] == 1) PerkFactor = 1250;
   if (MiscellaneousVars[10043] == 2) PerkFactor = 2000;
   if (MiscellaneousVars[10043] == 3) PerkFactor = 2500;
   if (random(1,10000) <= PerkFactor)
   {
    SetActivator(Player1TID); ActivatorSound("MortalHit/DeathRage",127); SetActivator(0);
    PerkFactor = random(17,18);
	if (MiscellaneousVars[10043] == 1)
	{
	 MiscellaneousVars[9043] = (15 * 35); // Death Rage Timer
	 MiscellaneousVars[9044] = (195 * 35);
	}
	if (MiscellaneousVars[10043] == 2)
	{
	 MiscellaneousVars[9043] = ((22 * 35) + PerkFactor); // Death Rage Timer
	 MiscellaneousVars[9044] = ((172 * 35) + PerkFactor); // Cooldown Timer
	}
	if (MiscellaneousVars[10043] == 3)
	{
	 MiscellaneousVars[9043] = (30 * 35); // Death Rage Timer
	 MiscellaneousVars[9044] = (150 * 35); // Cooldown Timer
	}
   }
  }
 }

 int flickeralpha = 1.0;
 int basealpha = 1.0;
 
 if (MiscellaneousVars[194] != 0) // Flickering
 {
  if (PowerUpTimer[1] > 0) basealpha = MiscFixedVars[101]; // Invisible
  if (MiscellaneousVars[195] > 0) // Timer Above 0
  {
   if (PowerupTimer[4] == 0) 
   {
    SetActorProperty(Player1TID,APROP_INVULNERABLE,1);
    GiveActorInventory(Player1TID,"IsInvulnerable",1);
   }
   MiscellaneousVars[196] = MiscellaneousVars[195] % 120;
   if (MiscellaneousVars[196] >= 0 && MiscellaneousVars[196] <= 29) flickeralpha = FixedMul(basealpha,0.25);
   if (MiscellaneousVars[196] >= 30 && MiscellaneousVars[196] <= 59) flickeralpha = FixedMul(basealpha,0.375);
   if (MiscellaneousVars[196] >= 60 && MiscellaneousVars[196] <= 89) flickeralpha = FixedMul(basealpha,0.5);
   if (MiscellaneousVars[196] >= 90 && MiscellaneousVars[196] <= 119) flickeralpha = FixedMul(basealpha,0.375);
   SetActorProperty(Player1TID,APROP_RenderStyle,STYLE_Add);
   SetActorProperty(Player1TID,APROP_Alpha,flickeralpha);

   MiscellaneousVars[195] -= 20;
  }
  else // Timer at 0
  {
   if (PowerupTimer[4] == 0) 
   {
    SetActorProperty(Player1TID,APROP_INVULNERABLE,0);
    TakeActorInventory(Player1TID,"IsInvulnerable",0x7FFFFFFF);
   }
   // if (MiscellaneousVars[195] != 0) SetActorProperty(Player1TID,APROP_RenderStyle,STYLE_Normal);
   MiscellaneousVars[194] = 0;
   MiscellaneousVars[195] = 0;
  }
 }

 if (MiscellaneousVars[194] == 0) // Not Flickering
 {
  if (PowerupTimer[4] == 0) 
  {
   SetActorProperty(Player1TID,APROP_INVULNERABLE,0);
   TakeActorInventory(Player1TID,"IsInvulnerable",0x7FFFFFFF);
  }
  if (PowerUpTimer[1] > 0)
  {
   SetActorProperty(Player1TID,APROP_RenderStyle,STYLE_Add);
   SetActorProperty(Player1TID,APROP_Alpha,MiscFixedVars[101]);
  }
  else
  {
   SetActorProperty(Player1TID,APROP_RenderStyle,STYLE_Normal);
   SetActorProperty(Player1TID,APROP_Alpha,1.0);
  }
  MiscellaneousVars[195] = 0;
 }



 //******************************************************************
 //*For interpolation of HP [like a Heretic or Hexen style counting]*
 //******************************************************************
 if (HPInterpolationDisplay != GetActorProperty(Player1TID,APROP_Health))
 {
  if (HPInterpolationDisplay > GetActorProperty(Player1TID,APROP_Health)) // Go down
  {
   HPInterpolationDisplay -= InterPolStrength;
   if (HPInterpolationDisplay < GetActorProperty(Player1TID,APROP_Health)) HPInterpolationDisplay = GetActorProperty(Player1TID,APROP_Health);
  }
  else
  if (HPInterpolationDisplay < GetActorProperty(Player1TID,APROP_Health)) // Go up
  {
   HPInterpolationDisplay += InterPolStrength;
   if (HPInterpolationDisplay > GetActorProperty(Player1TID,APROP_Health)) HPInterpolationDisplay = GetActorProperty(Player1TID,APROP_Health);
  }

  if (HPInterpolationDisplay < InterPolLowestHealth) HPInterpolationDisplay = InterPolLowestHealth;
 }

 //*************************************
 //*Blacken Screen if Blinded or Asleep*
 //*************************************
 if (PowerupTimer[19] > 0) FadeRange(0, 0, 0, 0.975, 0, 0, 0, 0.0, 0.1); // Blinded
 if (PowerupTimer[20] > 0) FadeRange(0, 0, 0, 0.9875, 0, 0, 0, 0.0, 0.1); // Asleep

 //***********************
 //*Check for Magic Focus*
 //***********************
 int FocusDrain;
 if (random(1,25) == 1) FocusDrain = (random(1,2) * 4);
                   else FocusDrain = (random(4,8) * 5);
 if (MiscellaneousVars[317] > 0) FocusDrain = FocusDrain * (100 - (MiscellaneousVars[317] * 3)) / 100;
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) FocusDrain = FocusDrain * 9 / 10;

 buttons = GetPlayerInput(0, INPUT_BUTTONS); 
 FreezePlayer = 0;
 if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
 if (PowerupTimer[18] > 0 && random(1,5) > 2) FreezePlayer += 1;
 if (PowerupTimer[20] > 0) FreezePlayer += 1;
 if (PowerupTimer[21] > 0 && random(1,5) > 2) FreezePlayer += 1;
 if (buttons & BT_ZOOM && buttons & BT_SPEED && MiscellaneousVars[21] >= FocusDrain && FreezePlayer == 0)
 {
  if (DVDSSpecialArrayValue[0] == 0)
  {
   MiscellaneousVars[21] -= FocusDrain;
   if (MiscellaneousVars[21] < 0) MiscellaneousVars[21] = 0;

   MiscellaneousVars[212] = 1; // "Focus" on
   MiscellaneousVars[231] += 1;
   // TID 1504 [Focus Generator]
   if (MiscellaneousVars[231] == 1)
   {
    SpawnFixedX = GetActorX(Player1TID);
    SpawnFixedY = GetActorY(Player1TID);
    SpawnFixedZ = GetActorZ(Player1TID);
    if (ThingCountName("FocusParticleSource", 1504) < 1) SpawnForced("FocusParticleSource",SpawnFixedX,SpawnFixedY,SpawnFixedZ,1504,0);
   }
  }
 }
 else
 {
  MiscellaneousVars[212] = 0; // "Focus" off
  MiscellaneousVars[231] = 0;
  if (ThingCountName("FocusParticleSource", 1504) > 0) Thing_Remove(1504);
 }

 if (MiscellaneousVars[212] > 0) // Focusing
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0) FadeRange(0, 0, 48, 0.9375, 0, 0, 0, 0.0, 0.05);
  if (CheckActorInventory(Player1TID,"FocusingMagic_Defense") < 1) GiveActorInventory(Player1TID,"FocusingMagic_Defense", 1);
 }
 else
 {
  if (CheckActorInventory(Player1TID,"FocusingMagic_Defense") > 0) TakeActorInventory(Player1TID,"FocusingMagic_Defense", 1);
 }

 //*********************
 //*Check Aireal Damage*
 //*********************
 buttons = GetPlayerInput(0, INPUT_BUTTONS);
 if (CheckActorInventory(Player1TID,"LandingDMGBonus4") > 0) TakeActorInventory(Player1TID,"LandingDMGBonus4", 9999);
 if (CheckActorInventory(Player1TID,"LandingDMGBonus3") > 0) TakeActorInventory(Player1TID,"LandingDMGBonus3", 9999);
 if (CheckActorInventory(Player1TID,"LandingDMGBonus2") > 0) TakeActorInventory(Player1TID,"LandingDMGBonus2", 9999);
 if (CheckActorInventory(Player1TID,"LandingDMGBonus") > 0) TakeActorInventory(Player1TID,"LandingDMGBonus", 9999);
 if (PowerupTimer[2] < 1) // && buttons & BT_JUMP)
 {
  if (GetActorVelZ(Player1TID) < -8388608)
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Landing Damage Lvl 4 [13.9453125x Melee Dmg] \n[VelZ: ",d:GetActorVelZ(Player1TID),s:"]");
   if (CheckActorInventory(Player1TID,"LandingDMGBonus4") < 1) GiveActorInventory(Player1TID,"LandingDMGBonus4", 1);
  }
  else
  if (GetActorVelZ(Player1TID) < -2097152)
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Landing Damage Lvl 3 [6.5625x Melee Dmg] \n[VelZ: ",d:GetActorVelZ(Player1TID),s:"]");
   if (CheckActorInventory(Player1TID,"LandingDMGBonus3") < 1) GiveActorInventory(Player1TID,"LandingDMGBonus3", 1);
  }
  else
  if (GetActorVelZ(Player1TID) < -524288)
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Landing Damage Lvl 2 [3.5x Melee Dmg] \n[VelZ: ",d:GetActorVelZ(Player1TID),s:"]");
   if (CheckActorInventory(Player1TID,"LandingDMGBonus2") < 1) GiveActorInventory(Player1TID,"LandingDMGBonus2", 1);
  }
  else
  if (GetActorVelZ(Player1TID) < -1024)
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Landing Damage Lvl 1 [2x Melee Dmg] \n[VelZ: ",d:GetActorVelZ(Player1TID),s:"]");
   if (CheckActorInventory(Player1TID,"LandingDMGBonus") < 1) GiveActorInventory(Player1TID,"LandingDMGBonus", 1);
  }
 }

 
 
 //**************************
 //*Sceptre Aireal Dmg Check*
 //**************************
 int SceptreJumpDmgMulti;
 SceptreJumpDmgMulti = GetActorVelZ(Player1TID) / -6553;
 SceptreJumpDmgMulti += 100;
 if (SceptreJumpDmgMulti < 100) SceptreJumpDmgMulti = 100;
 // PrintBold(d:GetActorVelZ(Player1TID),s:"\n",d:SceptreJumpDmgMulti,s:"%");

 //*************************
 //*Blast Resistance Checks*
 //*************************
 int FloExplodeResist = 0;
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) FloExplodeResist += 1;
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) FloExplodeResist += 2;
 if (FloExplodeResist >= 3) 
 {
  GiveActorInventory(Player1TID,"DressRingComboResist",1); 
  TakeActorInventory(Player1TID,"WaterFlyingDressResist",0x7FFFFFFF); 
  TakeActorInventory(Player1TID,"BalrogRingResist",0x7FFFFFFF); 
 }
 else
 if (FloExplodeResist == 2) 
 {
   GiveActorInventory(Player1TID,"BalrogRingResist",1); 
   TakeActorInventory(Player1TID,"WaterFlyingDressResist",0x7FFFFFFF); 
   TakeActorInventory(Player1TID,"DressRingComboResist",0x7FFFFFFF); 
 }
 else
 if (FloExplodeResist == 1) 
 {
   GiveActorInventory(Player1TID,"WaterFlyingDressResist",1); 
   TakeActorInventory(Player1TID,"BalrogRingResist",0x7FFFFFFF); 
   TakeActorInventory(Player1TID,"DressRingComboResist",0x7FFFFFFF); 
 }
 else
 {
   TakeActorInventory(Player1TID,"WaterFlyingDressResist",0x7FFFFFFF); 
   TakeActorInventory(Player1TID,"BalrogRingResist",0x7FFFFFFF); 
   TakeActorInventory(Player1TID,"DressRingComboResist",0x7FFFFFFF); 
 }

 
 
 //********************
 //*Regenerate Stamina*
 //********************
 // [21] is current Stamina points
 // [22] is maximum Stamina points
 // Base Stamina Maximum
 MiscellaneousVars[22] = 10000;
 if (CharacterClass == 2)
 {
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) MiscellaneousVars[22] += 1000; // +10.00%
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) MiscellaneousVars[22] += 1750; // +17.50%
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) MiscellaneousVars[22] += 500; // +5.00%
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) MiscellaneousVars[22] += 1250; // +12.50%
  // Total = 45.00%
 }
 else
 {
  // Armor
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) MiscellaneousVars[22] += 125; // +1.25%
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) MiscellaneousVars[22] += 250; // +2.5%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) MiscellaneousVars[22] += 500; // +5%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) MiscellaneousVars[22] += 1000; // +10%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) MiscellaneousVars[22] += 1250; // +12.5%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) MiscellaneousVars[22] += 2500; // +25%
  // Other
   // To Be Added [maybe]
 }
 // Stats

 int staminastatfactor = 0;
 // Agility
 if (CharacterClass == 0) H1 = MiscellaneousVars[31] * 6;
 if (CharacterClass == 1) H1 = MiscellaneousVars[31] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[31] * 10;
 if (CharacterClass == 8) H1 = MiscellaneousVars[31] * 10;
 if (CharacterClass == 9) H1 = MiscellaneousVars[31] * 8;
 staminastatfactor += H1;

 // Defense
 if (CharacterClass == 0) H1 = MiscellaneousVars[32] * 10;
 if (CharacterClass == 1) H1 = MiscellaneousVars[32] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[32] * 6;
 if (CharacterClass == 8) H1 = MiscellaneousVars[32] * 5;
 if (CharacterClass == 9) H1 = MiscellaneousVars[32] * 10;
 staminastatfactor += H1;

 // Deftness
 if (CharacterClass == 0) H1 = MiscellaneousVars[33] * 8;
 if (CharacterClass == 1) H1 = MiscellaneousVars[33] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[33] * 8;
 if (CharacterClass == 8) H1 = MiscellaneousVars[33] * 8;
 if (CharacterClass == 9) H1 = MiscellaneousVars[33] * 8;
 staminastatfactor += H1;

 // Sorcery
 if (CharacterClass == 0) H1 = MiscellaneousVars[34] * 6;
 if (CharacterClass == 1) H1 = MiscellaneousVars[34] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[34] * 10;
 if (CharacterClass == 8) H1 = MiscellaneousVars[34] * 9;
 if (CharacterClass == 9) H1 = MiscellaneousVars[34] * 7;
 staminastatfactor += H1;

 // Strength
 if (CharacterClass == 0) H1 = MiscellaneousVars[35] * 10;
 if (CharacterClass == 1) H1 = MiscellaneousVars[35] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[35] * 6;
 if (CharacterClass == 8) H1 = MiscellaneousVars[35] * 4;
 if (CharacterClass == 9) H1 = MiscellaneousVars[35] * 6;
 staminastatfactor += H1;

 // Therapeusis
 if (CharacterClass == 0) H1 = MiscellaneousVars[36] * 8;
 if (CharacterClass == 1) H1 = MiscellaneousVars[36] * 8;
 if (CharacterClass == 2) H1 = MiscellaneousVars[36] * 8;
 if (CharacterClass == 8) H1 = MiscellaneousVars[36] * 8;
 if (CharacterClass == 9) H1 = MiscellaneousVars[36] * 8;
 staminastatfactor += H1;

 H1 = 0;
 // Final Calc
 if (GameSkill() == SKILL_VERY_EASY) H1 = 10000;
 if (GameSkill() == SKILL_EASY) H1 = 11250;
 if (GameSkill() == SKILL_NORMAL) H1 = 12500;
 if (GameSkill() == SKILL_HARD) H1 = 15000;
 if (GameSkill() == SKILL_VERY_HARD) H1 = 20000;
 staminastatfactor += H1;
 MiscellaneousVars[22] = MiscellaneousVars[22] * staminastatfactor / H1;

 PerkFactor = ((MiscellaneousVars[10005] * 500) + (MiscellaneousVars[10006] * 1250)) + 10000;
 MiscellaneousVars[22] = MiscellaneousVars[22] * PerkFactor / 10000; // "StamUp" and "StamUp EX" perks.

 PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
 MiscellaneousVars[22] = MiscellaneousVars[22] * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"

 MiscellaneousVars[164] = MiscellaneousVars[22] * 5;
 

 if (MiscellaneousVars[21] < MiscellaneousVars[22])
 {
  staminaregenfinal = 0;
  if (CharacterClass == 0) staminaregenbase = 15; // Deggaris (0.15%/tic = 5.25%/sec)
  if (CharacterClass == 1) staminaregenbase = 13; // Illucia (0.13%/tic = 4.55%/sec)
  if (CharacterClass == 2) staminaregenbase = 9; // Flora (0.09%/tic = 3.15%/sec)
  if (CharacterClass == 8) staminaregenbase = 8; // Ailish (0.08%/tic = 3.15%/sec)
  if (CharacterClass == 9) staminaregenbase = 15; // Petra (0.15%/tic = 5.25%/sec)
  staminaregenfinal += staminaregenbase;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinal [Base1]: ",d:staminaregenfinal);

  if (CharacterClass == 0) staminaregenbase = (PlayerLevel / 14); // +7-15
  if (CharacterClass == 1) staminaregenbase = (PlayerLevel / 14); // +7-15
  if (CharacterClass == 2) staminaregenbase = (PlayerLevel / 10); // +10-20
  if (CharacterClass == 8) staminaregenbase = (PlayerLevel / 10); // +10-20
  if (CharacterClass == 9) staminaregenbase = (PlayerLevel / 14); // +7-15
  staminaregenfinal += staminaregenbase;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinal [Base2]: ",d:staminaregenfinal);

  // Stamina Bonuses [Strife]
  staminaregenfinal += ((MiscellaneousVars[317] * 1) / 8);
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinal [Strife1]: ",d:staminaregenfinal);
  
  // Check Input for Bonus/Penalties
  FreezePlayer = 0;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (FreezePlayer == 0)
  {
   buttons = GetPlayerInput(0, INPUT_BUTTONS); 
   if (buttons & BT_FORWARD) C3 = 76;
   else if (buttons & BT_BACK) C3 = 76;
   else if (buttons & BT_MOVELEFT) C3 = 76;
   else if (buttons & BT_MOVERIGHT) C3 = 76;
   else if (buttons & BT_MOVEUP) C3 = 84;
   else if (buttons & BT_MOVEDOWN) C3 = 84;
   else if (buttons & BT_JUMP) C3 = 76;
   else if (buttons & BT_CROUCH) C3 = 120;
   else C3 = 100;
   staminaregenfinal = staminaregenfinal * C3 / 100;
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinal [Input]: ",d:staminaregenfinal);

  // Check Armor for Bonus/Penalties
  C3 = 1000;
  // Marine Specfic Armors
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0)	C3 += 12; 
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0)		C3 += 25; 
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0)	C3 += 50; 
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0)	C3 += 100;  
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0)	C3 += 75;  
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0)	C3 += 150; 
  // Sauron Stuff
  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)	 		C3 -= 100; 
  if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0)	C3 -= 100; 
  // Flora's Stuff
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) 		C3 -= 625;
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0)	 		C3 += 100;  
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0)		C3 += 25;  
  if (CheckActorInventory(Player1TID,"KissaBra") > 0)	 			C3 += 75;  
  if (CheckActorInventory(Player1TID,"DivineShield") > 0)			C3 += 125;  
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)	 		C3 += 50;  
  if (C3 < 125) C3 = 125;
  staminaregenfinal = staminaregenfinal * C3 / 1000;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Armor]: ",d:staminaregenfinal);

  int basestatdivisor = 8;
  // Initia1 Stat Check = 8pts of Strength = +1% Stamina Regen Speed
  // Secondary Stat Check = 8pts of [?] = +1% Stamina Regen Speed
  C3 = MiscellaneousVars[35];
  if (CharacterClass == 0) C3 += MiscellaneousVars[35]; // Deggaris's Secondary Stat is also strength, making it work doubly for him overall. :P
  if (CharacterClass == 1) C3 += MiscellaneousVars[32]; // Illucia's Secondary Stat is Defense. :P
  if (CharacterClass == 2) C3 += MiscellaneousVars[31]; // Flora's Secondary Stat is Agility. :P
  if (CharacterClass == 8) C3 += MiscellaneousVars[31]; // Ailish's Secondary Stat is Agility. :P
  if (CharacterClass == 9) C3 += MiscellaneousVars[32]; // Petra's Secondary Stat is Defense. :P
  C3 /= basestatdivisor;
  C3 += 100;
  staminaregenfinal = staminaregenfinal * C3 / 100;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [StatCheck]: ",d:staminaregenfinal,s:" [Factor: ",d:C3,s:"%]");

  // Tension
  if (MiscellaneousVars[181] == 1) staminaregenfinal = staminaregenfinal * 1025 / 1000;
  if (MiscellaneousVars[181] == 2) staminaregenfinal = staminaregenfinal * 105 / 100;
  if (MiscellaneousVars[181] == 3) staminaregenfinal = staminaregenfinal * 110 / 100;
  if (MiscellaneousVars[181] == 4) staminaregenfinal = staminaregenfinal * 125 / 100;
  if (MiscellaneousVars[181] == 5) staminaregenfinal = staminaregenfinal * 150 / 100;
  if (MiscellaneousVars[181] == 6) staminaregenfinal = staminaregenfinal * 250 / 100;
  if (MiscellaneousVars[181] == 7) staminaregenfinal = staminaregenfinal * 500 / 100;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Tension]: ",d:staminaregenfinal);

  // Divine Avatar = +100% Regen
  if (PowerupTimer[7] > 0) staminaregenfinal = staminaregenfinal * 2;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [DivineAvatar]: ",d:staminaregenfinal);

  if (PowerupTimer[12] > 0) staminaregenfinal = staminaregenfinal * 6 / 5; // Acceleratle
  if (PowerupTimer[15] > 0) staminaregenfinal = staminaregenfinal * 4 / 5; // Deceleratle
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Accel/Decel]: ",d:staminaregenfinal);

  // Poison = -25% Regen
  if (PowerupTimer[16] > 0 && PowerupTimer[4] == 0) staminaregenfinal = staminaregenfinal * 3 / 4;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Poison]: ",d:staminaregenfinal);

  // Fatigue = -80% Regen
  if (PowerupTimer[18] > 0) staminaregenfinal /= 5;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Fatigue]: ",d:staminaregenfinal);

  // Sleeping = +400% Regen
  if (PowerupTimer[20] > 0)
  {
   staminaregenfinal *= 5;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   staminaregenfinal = staminaregenfinal * PerkFactor / 10000; // "RegenStamFast" and "RegenStamFast EX" perks.
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Sleep]: ",d:staminaregenfinal);

  // Berserk = +25% Regen
  if (PowerupTimer[23] > 0) staminaregenfinal = staminaregenfinal * 5 / 4;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Berserk]: ",d:staminaregenfinal);

  // Checks Stamina Regen Rate Menu Option
  staminaregenfinal = staminaregenfinal * GetCVar("dvds_staminaregenmultiplier") / 100;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [StamMenuOption]: ",d:staminaregenfinal);

  // Checks the final value based on how high the Max Stamina Pts Cap has been increased by various items
  staminaregenfinal = (staminaregenfinal * MiscellaneousVars[22]) / 10000;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [StamCapVal]: ",d:staminaregenfinal);

  // RegenStamFast perks
  if (MiscellaneousVars[10017] > 0)
  {
   PerkFactor = ((MiscellaneousVars[10017] * 2) + (MiscellaneousVars[10018] * 5)) + 10;
   staminaregenfinal = staminaregenfinal * PerkFactor / 10; // "RegenStamFast" and "RegenStamFast EX" perks.
   if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Perks]: ",d:staminaregenfinal);
  }

  // Check for Weapons
  If(StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
  {
   staminaregenfinal = staminaregenfinal * 3 / 4;
  }
  If(StrIcmp(weapon, "EvilWarriorShield") == 0)
  {
   staminaregenfinal = staminaregenfinal * 7 / 8;
  }
  If (StrIcmp(weapon, "Chainsaw2") == 0 || StrIcmp(weapon, "DoubleBladedChainsaw") == 0)
  {
   staminaregenfinal = staminaregenfinal * 9 / 10;
  }
  If (StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistAilish") == 0 || StrIcmp(weapon, "FistPetra") == 0 || StrIcmp(weapon, "FistFlora") == 0)
  {
   staminaregenfinal = staminaregenfinal * 21 / 20;
   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) staminaregenfinal = staminaregenfinal * random(28,32) / 20;
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Weapons]: ",d:staminaregenfinal);

  // "Cleared of Mind" Perks
  if (MiscellaneousVars[10055] > 0)
  {
   perkfactor = ((MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5)) + 80;
   staminaregenfinal = staminaregenfinal * perkfactor / 80;
   if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [Perks2]: ",d:staminaregenfinal);
  }

  // Check Musou Power Trip Mode
  if (GetCVar("dvds_musou_powertripmode") == 1) staminaregenfinal = staminaregenfinal * 5 / 2; // 250%
  if (GetCVar("dvds_musou_powertripmode") == 2) staminaregenfinal = staminaregenfinal * 5; // 500%
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [PowerTrip]: ",d:staminaregenfinal);

  // Low Caps Regen to 1 tic minimum
  if (staminaregenfinal < 1) staminaregenfinal = 1;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [LowCap]: ",d:staminaregenfinal);

  if (MenuSystemVars[0] != 0) staminaregenfinal = 0; // If using In-Game Menus
  if (DVDSSpecialArrayValue[0] == 0) // If "Conscious"
  {
   MiscellaneousVars[21] += staminaregenfinal;
   if (MiscellaneousVars[21] > MiscellaneousVars[22]) MiscellaneousVars[21] = MiscellaneousVars[22];
  }
  if (MiscellaneousVars[21] == MiscellaneousVars[22]) staminaregenfinal = 0;
 }
 else
 {
  staminaregenfinal = 0;
  if (CharacterClass == 0) staminaregenbase = -4; // Deggaris (-0.04%/tic = -1.40%/sec)
  if (CharacterClass == 1) staminaregenbase = -6; // Illucia (-0.06%/tic = -2.10%/sec)
  if (CharacterClass == 2) staminaregenbase = -7; // Flora (-0.07%/tic = -2.45%/sec)
  if (CharacterClass == 8) staminaregenbase = -8; // Ailish (-0.08%/tic = -2.45%/sec)
  if (CharacterClass == 9) staminaregenbase = -4; // Petra (-0.04%/tic = -1.40%/sec)
  staminaregenfinal += staminaregenbase;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Base1]: ",d:staminaregenfinal);

  if (CharacterClass == 0) staminaregenbase = (PlayerLevel / 56); // +1-3
  if (CharacterClass == 1) staminaregenbase = (PlayerLevel / 56); // +1-3
  if (CharacterClass == 2) staminaregenbase = (PlayerLevel / 40); // +2-5
  if (CharacterClass == 8) staminaregenbase = (PlayerLevel / 30); // +2-5
  if (CharacterClass == 9) staminaregenbase = (PlayerLevel / 56); // +1-3
  staminaregenfinal += staminaregenbase;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Base2]: ",d:staminaregenfinal);

  // Stamina Bonuses [Strife]
  staminaregenfinal += ((MiscellaneousVars[317] * 1) / 8);
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Strife1]: ",d:staminaregenfinal);

  FreezePlayer = 0;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (FreezePlayer == 0)
  {
   buttons = GetPlayerInput(0, INPUT_BUTTONS); 
   if (buttons & BT_FORWARD) C3 = 112;
   else if (buttons & BT_BACK) C3 = 112;
   else if (buttons & BT_MOVELEFT) C3 = 112;
   else if (buttons & BT_MOVERIGHT) C3 = 112;
   else if (buttons & BT_MOVEUP) C3 = 108;
   else if (buttons & BT_MOVEDOWN) C3 = 108;
   else if (buttons & BT_JUMP) C3 = 112;
   else if (buttons & BT_CROUCH) C3 = 90;
   else C3 = 100;
   staminaregenfinal = staminaregenfinal * C3 / 100;
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Input]: ",d:staminaregenfinal);

  // Check Armor for Bonus/Penalties
  C3 = 1000;
  // Marine Specfic Armors
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0)	C3 -= 6; 
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0)		C3 -= 12; 
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0)	C3 -= 25; 
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0)	C3 -= 50;  
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0)	C3 -= 37;  
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0)	C3 -= 75; 
  // Sauron Stuff
  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)	 		C3 += 50; 
  if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0)	C3 += 50; 
  // Flora's Stuff
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) 		C3 += random(312,313);
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0)	 		C3 -= 50;  
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0)		C3 -= 13;  
  if (CheckActorInventory(Player1TID,"KissaBra") > 0)	 			C3 -= 37;  
  if (CheckActorInventory(Player1TID,"DivineShield") > 0)			C3 -= 63;  
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)	 		C3 -= 25;  
  if (C3 < 1) C3 = 1;
  if (C3 > 2500) C3 = 2500;
  staminaregenfinal = staminaregenfinal * C3 / 1000;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Armor]: ",d:staminaregenfinal);

  basestatdivisor = 16;
  // 16pts of Strength = -1% Stamina Degen Speed
  // Secondary Stat Check = 16pts of [?] = -1% Stamina Degen Speed
  C3 = MiscellaneousVars[35];
  if (CharacterClass == 0) C3 += MiscellaneousVars[35]; // Deggaris's Secondary Stat is also strength, making it work doubly for him overall. :P
  if (CharacterClass == 1) C3 += MiscellaneousVars[32]; // Illucia's Secondary Stat is Defense. :P
  if (CharacterClass == 2) C3 += MiscellaneousVars[31]; // Flora's Secondary Stat is Agility. :P
  if (CharacterClass == 8) C3 += MiscellaneousVars[31]; // Ailish's Secondary Stat is Agility. :P
  if (CharacterClass == 9) C3 += MiscellaneousVars[32]; // Petra's Secondary Stat is Defense. :P
  C3 *= 1;
  C3 /= basestatdivisor;
  C3 += 100;
  staminaregenfinal = staminaregenfinal * C3 / 100;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [StatCheck]: ",d:staminaregenfinal,s:" [Factor: ",d:C3,s:"%]");

  // Tension
  if (MiscellaneousVars[181] == 1) staminaregenfinal = staminaregenfinal * 990 / 1000;
  if (MiscellaneousVars[181] == 2) staminaregenfinal = staminaregenfinal * 975 / 1000;
  if (MiscellaneousVars[181] == 3) staminaregenfinal = staminaregenfinal * 950 / 1000;
  if (MiscellaneousVars[181] == 4) staminaregenfinal = staminaregenfinal * 900 / 1000;
  if (MiscellaneousVars[181] == 5) staminaregenfinal = staminaregenfinal * 750 / 1000;
  if (MiscellaneousVars[181] == 6) staminaregenfinal = staminaregenfinal * 500 / 1000;
  if (MiscellaneousVars[181] == 7) staminaregenfinal = staminaregenfinal * 200 / 1000;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Tension]: ",d:staminaregenfinal);

  // Divine Avatar = -50% Degen
  if (PowerupTimer[7] > 0) staminaregenfinal = staminaregenfinal / 2;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [DivineAvatar]: ",d:staminaregenfinal);

  if (PowerupTimer[12] > 0) staminaregenfinal = staminaregenfinal * 6 / 5; // Acceleratle
  if (PowerupTimer[15] > 0) staminaregenfinal = staminaregenfinal * 4 / 5; // Deceleratle
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Accel/Decel]: ",d:staminaregenfinal);

  // Poison = +20% Degen
  if (PowerupTimer[16] > 0 && PowerupTimer[4] == 0) staminaregenfinal = staminaregenfinal * 6 / 5;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Poison]: ",d:staminaregenfinal);

  // Fatigue = +400% Degen
  if (PowerupTimer[18] > 0) staminaregenfinal = staminaregenfinal * 5;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Fatigue]: ",d:staminaregenfinal);

  // Sleep = -80% Degen
  if (PowerupTimer[20] > 0)
  {
   staminaregenfinal /= 5;
   PerkFactor = 10000 - ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000));
   staminaregenfinal = staminaregenfinal * PerkFactor / 10000; // "RegenStamFast" and "RegenStamFast EX" perks.
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Sleep]: ",d:staminaregenfinal);

  // Berserk = -20% Degen
  if (PowerupTimer[23] > 0) staminaregenfinal = staminaregenfinal * 4 / 5;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Berserk]: ",d:staminaregenfinal);

  // Checks the final value based on how high the Max Stamina Pts Cap has been increased by various items
  staminaregenfinal = (staminaregenfinal * MiscellaneousVars[22]) / 10000;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaRegenFinall [StamCapVal]: ",d:staminaregenfinal);

  // RegenStamFast perks
  if (MiscellaneousVars[10017] > 0)
  {
   PerkFactor = 10 - ((MiscellaneousVars[10017] * 2) + (MiscellaneousVars[10018] * 5));
   staminaregenfinal = staminaregenfinal * PerkFactor / 10; // "RegenStamFast" and "RegenStamFast EX" perks.
   if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Perks]: ",d:staminaregenfinal);
  }

  // Check for Weapons
  If(StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
  {
   staminaregenfinal = staminaregenfinal * 4 / 3;
  }
  If(StrIcmp(weapon, "EvilWarriorShield") == 0)
  {
   staminaregenfinal = staminaregenfinal * 8 / 7;
  }
  If (StrIcmp(weapon, "Chainsaw2") == 0 || StrIcmp(weapon, "DoubleBladedChainsaw") == 0)
  {
   staminaregenfinal = staminaregenfinal * 10 / 9;
  }
  If (StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistAilish") == 0 || StrIcmp(weapon, "FistPetra") == 0 || StrIcmp(weapon, "FistFlora") == 0)
  {
   staminaregenfinal = staminaregenfinal * 20 / 21;
   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) staminaregenfinal = staminaregenfinal * 20 / random(28,32);
  }
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Weapons]: ",d:staminaregenfinal);

  // "Cleared of Mind" Perks
  if (MiscellaneousVars[10055] > 0)
  {
   perkfactor = 80 - ((MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5));
   staminaregenfinal = staminaregenfinal * perkfactor / 80;
   if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [Perks2]: ",d:staminaregenfinal);
  }

  // Check Musou Power Trip Mode
  if (GetCVar("dvds_musou_powertripmode") == 1) staminaregenfinal = staminaregenfinal * (2 / 5); // 40%
  if (GetCVar("dvds_musou_powertripmode") == 2) staminaregenfinal = staminaregenfinal / 5; // 20%
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [PowerTrip]: ",d:staminaregenfinal);

  // Low Caps Regen to 1 tic minimum
  if (staminaregenfinal > -1) staminaregenfinal = -1;
  if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0) PrintBold(s:"StaminaDegenFinall [LowCap]: ",d:staminaregenfinal);

  if (MenuSystemVars[0] != 0) staminaregenfinal = 0; // If using In-Game Menus
  if (DVDSSpecialArrayValue[0] == 0) // If "Conscious"
  {
   MiscellaneousVars[21] += staminaregenfinal;
   if (MiscellaneousVars[21] < MiscellaneousVars[22]) MiscellaneousVars[21] = MiscellaneousVars[22];
  }
  if (MiscellaneousVars[21] == MiscellaneousVars[22]) staminaregenfinal = 0;
 }

 //***************************
 //*Calculate Stamina for HUD*
 //***************************
 StaminaPercent = MiscellaneousVars[21] * 100 / MiscellaneousVars[22];

/*
 //******************************************************
 //*Calculated Attack [Main/"Normal"] for some Abilities*
 //******************************************************
 int TotalAttack = 1.0;

 int MusouPTAttack = 1.0;
 if (GetCVar("dvds_musou_powertripmode") == 1) MusouPTAttack = 5.0;
 if (GetCVar("dvds_musou_powertripmode") == 2) MusouPTAttack = 10.0;
 TotalAttack = FixedMul(TotalAttack,MusouPTAttack);

 // Final
 SetActorProperty(Player1TID,APROP_DamageMultiplier, TotalAttack);

 //*******************************************************
 //*Calculated Defense [Main/"Normal"] for some Abilities*
 //*******************************************************
 int TotalDefense = 1.0;

 int MusouPTDefense = 1.0;
 if (GetCVar("dvds_musou_powertripmode") == 1) MusouPTDefense = 0.2;
 if (GetCVar("dvds_musou_powertripmode") == 2) MusouPTDefense = 0.1;
 TotalDefense = FixedMul(TotalDefense,MusouPTDefense);

 int HWShieldDefense = 1.0;
 If(StrIcmp(weapon, "EvilWarriorShield") == 0)
 {
  HWShieldDefense = 0.7;
 }
 TotalDefense = FixedMul(TotalDefense,HWShieldDefense);

 SetActorProperty(Player1TID,APROP_DamageFactor, TotalDefense);

 if (GetCVar("dvdsdebug_attackdefensedisplays") > 0)
 {
  PrintBold(s:"MusouPTAttack x: ",f:MusouPTAttack,
			s:"\n",
            s:"\nTotalAttack x: ",f:TotalAttack,
			s:"\n",
			s:"\n",
            s:"\nMusouPTDefense x: ",f:MusouPTDefense,
            s:"\nHWShieldDefense x: ",f:HWShieldDefense,
			s:"\n",
            s:"\nTotalDefense x: ",f:TotalDefense);
 }
*/

 //************************************
 //*Calculate Speed for some Abilities*
 //************************************
 int TotalSpeed = 1.00;

 int StaminaSpeed = 1.00;
 int StaminaPercentFull = MiscellaneousVars[21] * 10000 / MiscellaneousVars[22];
 if (GetCVar("dvds_staminaaffectsspeed") > 0)
 {
  if (StaminaPercentFull < 157) StaminaSpeed = 0.325;
  if (StaminaPercentFull > 156 && StaminaPercentFull < 626) StaminaSpeed = 0.475;
  if (StaminaPercentFull > 625 && StaminaPercentFull < 1251) StaminaSpeed = 0.61;
  if (StaminaPercentFull > 1250 && StaminaPercentFull < 2501) StaminaSpeed = 0.73;
  if (StaminaPercentFull > 2500 && StaminaPercentFull < 5001) StaminaSpeed = 0.835;
  if (StaminaPercentFull > 5000 && StaminaPercentFull < 7501) StaminaSpeed = 0.925;
  if (StaminaPercentFull > 7500 && StaminaPercentFull < 12501) StaminaSpeed = 1.00;
  if (StaminaPercentFull > 12500 && StaminaPercentFull < 20001) StaminaSpeed = 1.075;
  if (StaminaPercentFull > 20000 && StaminaPercentFull < 27501) StaminaSpeed = 1.165;
  if (StaminaPercentFull > 27500 && StaminaPercentFull < 35001) StaminaSpeed = 1.27;
  if (StaminaPercentFull > 35000 && StaminaPercentFull < 42501) StaminaSpeed = 1.39;
  if (StaminaPercentFull > 42500 && StaminaPercentFull < 48751) StaminaSpeed = 1.525;
  if (StaminaPercentFull > 48750) StaminaSpeed = 1.675;
 }
 if (GetCVar("dvdsdebug_showstaminaregenstuff") > 0)
 {
   PrintBold(s:"Stamina Points: ",d:MiscellaneousVars[21],s:" / ",d:MiscellaneousVars[22],s:" [",d:staminaregenfinal,s:"]",
             s:"\nStamina Speed: ",f:StaminaSpeed);
 }
 TotalSpeed = FixedMul(TotalSpeed,StaminaSpeed);
 
 int DodgeMoreSpeed = 1.0;
 DodgeMoreSpeed = 1.0 + ((MiscellaneousVars[10007] * 0.01) + (MiscellaneousVars[10008] * 0.025));
 TotalSpeed = FixedMul(TotalSpeed,DodgeMoreSpeed);

 int JumpMoreSpeed = 1.0;
 JumpMoreSpeed = 1.0 + ((MiscellaneousVars[10009] * 0.01) + (MiscellaneousVars[10010] * 0.025));
 TotalSpeed = FixedMul(TotalSpeed,JumpMoreSpeed);

 int OnTheMoveSpeed = 1.0;
 OnTheMoveSpeed = 1.0 + ((MiscellaneousVars[10045] * 0.02) + (MiscellaneousVars[10046] * 0.05));
 TotalSpeed = FixedMul(TotalSpeed,OnTheMoveSpeed);

 
 int ArmorSpeed = 1.0;
 // Flora-Armor Speed Check
 if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) ArmorSpeed += 0.10;
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) ArmorSpeed += 0.15;
 TotalSpeed = FixedMul(TotalSpeed,ArmorSpeed);

 int OneRingSpeed = 1.0;
 // The One Ring 
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) OneRingSpeed = 1.5;
 TotalSpeed = FixedMul(TotalSpeed,OneRingSpeed);
 
 int LVLSpeed = 1.0;
 // Level
 if (CharacterClass == 0) LVLSpeed = 1.0 + (PlayerLevel * 0.000669);
 if (CharacterClass == 1) LVLSpeed = 1.0 + (PlayerLevel * 0.00117533333333); 
 if (CharacterClass == 2) LVLSpeed = 1.0 + (PlayerLevel * 0.001389);
 if (CharacterClass == 8) LVLSpeed = 1.0 + (PlayerLevel * 0.00128255555555);
 if (CharacterClass == 9) LVLSpeed = 1.0 + (PlayerLevel * 0.00117533333333); 
 TotalSpeed = FixedMul(TotalSpeed,LVLSpeed);

 int AGLSpeed = 1.0;
 // Agility
 if (CharacterClass == 0) AGLSpeed = 1.0 + (MiscellaneousVars[31] * 0.00111113333333);
 if (CharacterClass == 1) AGLSpeed = 1.0 + (MiscellaneousVars[31] * 0.00166666666667); 
 if (CharacterClass == 2) AGLSpeed = 1.0 + (MiscellaneousVars[31] * 0.00222223333333);
 if (CharacterClass == 8) AGLSpeed = 1.0 + (MiscellaneousVars[31] * 0.00188888888889); 
 if (CharacterClass == 9) AGLSpeed = 1.0 + (MiscellaneousVars[31] * 0.00166666666667); 
 TotalSpeed = FixedMul(TotalSpeed,AGLSpeed);

 int LongbowSpeed = 1.0;
 // LongbowSpeed
 if (MiscellaneousVars[398] == 1)
 {
  LongbowSpeed = MiscellaneousVars[8] * 0.01;
  if (LongbowSpeed > 1.0) LongbowSpeed = 1.00;
 }
 TotalSpeed = FixedMul(TotalSpeed,LongbowSpeed); 

 int SceptreShieldSpeed = 1.0;
 // SceptreShieldSpeed
 if (MiscellaneousVars[397] == 1) SceptreShieldSpeed = 0.25;
 if (MiscellaneousVars[397] == 2) SceptreShieldSpeed = 0.5;
 if (MiscellaneousVars[397] == 3) SceptreShieldSpeed = 0.875;
 TotalSpeed = FixedMul(TotalSpeed,SceptreShieldSpeed); 

 int BuffSpeed = 1.0;
 if (PowerupTimer[12] > 0) BuffSpeed = FixedMul(BuffSpeed,1.333); 
 if (PowerupTimer[15] > 0) BuffSpeed = FixedMul(BuffSpeed,0.667); 
 TotalSpeed = FixedMul(TotalSpeed,BuffSpeed); 
 
 int TensionSpeed = 1.0;
 if (MiscellaneousVars[181] == 1) TensionSpeed = 1.035;
 if (MiscellaneousVars[181] == 2) TensionSpeed = 1.15;
 if (MiscellaneousVars[181] == 3) TensionSpeed = 1.25;
 if (MiscellaneousVars[181] == 4) TensionSpeed = 1.375;
 if (MiscellaneousVars[181] == 5) TensionSpeed = 1.5625;
 if (MiscellaneousVars[181] == 6) TensionSpeed = 1.875;
 if (MiscellaneousVars[181] == 7) TensionSpeed = 2.25;
 TotalSpeed = FixedMul(TotalSpeed,TensionSpeed);
 
 int FocusSpeed = 1.0;
 // Focusing
 if (MiscellaneousVars[212] > 0) FocusSpeed = 0.25;
 TotalSpeed = FixedMul(TotalSpeed,FocusSpeed);

 int DivineAvatarSpeed = 1.0;
 if (PowerupTimer[7] > 0) DivineAvatarSpeed = 1.5;
 TotalSpeed = FixedMul(TotalSpeed,DivineAvatarSpeed);

 // Final Speed
 SetActorProperty(Player1TID,APROP_Speed, TotalSpeed);
 //************************************************************************************************************************
 //**From here on, this script will run the remaining code constantly in order to keep tabs on Survivability ratings, etc**
 //************************************************************************************************************************

 //**************************
 //*Character Checks Misc #1*
 //**************************
 if (CharacterClass == 0 && CheckActorInventory(Player1TID,"DeggarisInPlay") < 1) GiveActorInventory(Player1TID,"DeggarisInPlay", 1);
 if (CharacterClass == 1 && CheckActorInventory(Player1TID,"IlluciaInPlay") < 1) GiveActorInventory(Player1TID,"IlluciaInPlay", 1);
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"FloraInPlay") < 1) GiveActorInventory(Player1TID,"FloraInPlay", 1);
 if (CharacterClass == 8 && CheckActorInventory(Player1TID,"AilishInPlay") < 1) GiveActorInventory(Player1TID,"AilishInPlay", 1);
 if (CharacterClass == 9 && CheckActorInventory(Player1TID,"PetraInPlay") < 1) GiveActorInventory(Player1TID,"PetraInPlay", 1);

 if (CharacterClass == 2)
 {
  // Slot 1
  if (CheckActorInventory(Player1TID,"Chainsaw") > 0) TakeActorInventory(Player1TID,"Chainsaw", 1);
  if (CheckActorInventory(Player1TID,"Chainsaw2") > 0) TakeActorInventory(Player1TID,"Chainsaw2", 1);
  // Slot 2
  if (CheckActorInventory(Player1TID,"FloraLearnedPistols") == 0)
  { 
   if (CheckActorInventory(Player1TID,"Pistol") > 0) TakeActorInventory(Player1TID,"Pistol", 1);
   if (CheckActorInventory(Player1TID,"Pistol2") > 0) TakeActorInventory(Player1TID,"Pistol2", 1);
  }
  // Slot 3
  if (CheckActorInventory(Player1TID,"Shotgun") > 0) TakeActorInventory(Player1TID,"Shotgun", 1);
  if (CheckActorInventory(Player1TID,"Shotgun2") > 0) TakeActorInventory(Player1TID,"Shotgun2", 1);
  // Slot 4
  if (CheckActorInventory(Player1TID,"Chaingun") > 0) TakeActorInventory(Player1TID,"Chaingun", 1);
  if (CheckActorInventory(Player1TID,"Chaingun2") > 0) TakeActorInventory(Player1TID,"Chaingun2", 1);
  // Slot 5
  if (CheckActorInventory(Player1TID,"RocketLauncher") > 0) TakeActorInventory(Player1TID,"RocketLauncher", 1);
  if (CheckActorInventory(Player1TID,"RocketLauncher2") > 0) TakeActorInventory(Player1TID,"RocketLauncher2", 1);
  // Slot 6
  if (CheckActorInventory(Player1TID,"PlasmaRifle") > 0) TakeActorInventory(Player1TID,"PlasmaRifle", 1);
  if (CheckActorInventory(Player1TID,"PlasmaRifle2") > 0) TakeActorInventory(Player1TID,"PlasmaRifle2", 1);
  if (CheckActorInventory(Player1TID,"Railgun2") > 0) TakeActorInventory(Player1TID,"Railgun2", 1);
  if (CheckActorInventory(Player1TID,"Repeater2") > 0) TakeActorInventory(Player1TID,"Repeater2", 1);
  if (CheckActorInventory(Player1TID,"Karasawa2") > 0) TakeActorInventory(Player1TID,"Karasawa2", 1);
  // Slot 7
  if (CheckActorInventory(Player1TID,"BFG9000") > 0) TakeActorInventory(Player1TID,"BFG9000", 1);
  if (CheckActorInventory(Player1TID,"BFG90002") > 0) TakeActorInventory(Player1TID,"BFG90002", 1);
 }
 else
 {
  // Slot 1
  if (CheckActorInventory(Player1TID,"SceptreOfEmpyrea") > 0) TakeActorInventory(Player1TID,"SceptreOfEmpyrea", 1);
  if (CheckActorInventory(Player1TID,"DoubleBladedChainsaw") > 0 && CheckActorInventory(Player1TID,"Chainsaw2")) TakeActorInventory(Player1TID,"Chainsaw2", 1);
  // Slot 3
  if (CheckActorInventory(Player1TID,"DiarisLongbow") > 0) TakeActorInventory(Player1TID,"DiarisLongbow", 1);
  // Slot 4
  if (CheckActorInventory(Player1TID,"ImpClaw") > 0) TakeActorInventory(Player1TID,"ImpClaw", 1);
  if (CheckActorInventory(Player1TID,"DarkImpClaw") > 0) TakeActorInventory(Player1TID,"DarkImpClaw", 1);
  if (CheckActorInventory(Player1TID,"CacodemonEye") > 0) TakeActorInventory(Player1TID,"CacodemonEye", 1);
  if (CheckActorInventory(Player1TID,"CacolanternEye") > 0) TakeActorInventory(Player1TID,"CacolanternEye", 1);
  if (CheckActorInventory(Player1TID,"AbaddonEye") > 0) TakeActorInventory(Player1TID,"AbaddonEye", 1);
  // Slot 5
  if (CheckActorInventory(Player1TID,"KnightFist") > 0) TakeActorInventory(Player1TID,"KnightFist", 1);
  if (CheckActorInventory(Player1TID,"BaronFist") > 0) TakeActorInventory(Player1TID,"BaronFist", 1);
  if (CheckActorInventory(Player1TID,"BelphegorFist") > 0) TakeActorInventory(Player1TID,"BelphegorFist", 1);
  if (CheckActorInventory(Player1TID,"BruiserFist") > 0) TakeActorInventory(Player1TID,"BruiserFist", 1);
  if (CheckActorInventory(Player1TID,"ArchonFist") > 0) TakeActorInventory(Player1TID,"ArchonFist", 1);
  if (CheckActorInventory(Player1TID,"PyroFist") > 0) TakeActorInventory(Player1TID,"PyroFist", 1);
  // Slot 6
  if (CheckActorInventory(Player1TID,"IncarnateSkull") > 0) TakeActorInventory(Player1TID,"IncarnateSkull", 1);
  if (CheckActorInventory(Player1TID,"ArchvileHand") > 0) TakeActorInventory(Player1TID,"ArchvileHand", 1);
  if (CheckActorInventory(Player1TID,"DiabloistHand") > 0) TakeActorInventory(Player1TID,"DiabloistHand", 1);
  if (CheckActorInventory(Player1TID,"BalrogFist") > 0) TakeActorInventory(Player1TID,"BalrogFist", 1);
 }

 //******************
 //*Check Dash Timer*
 //******************
 if (MiscellaneousVars[166] > 0) 
 { 
  GiveActorInventory(Player1TID,"PlayerDashing",1);
  GiveActorInventory(Player1TID,"DodgeGhostOn",1);
  GiveActorInventory(Player1TID,"DodgeMeleeBoost",1);
  if (MenuSystemVars[0] == 0) MiscellaneousVars[166]--;
  if (MenuSystemVars[0] == 0) { if (GetActorZ(Player1TID) - GetActorFloorZ(Player1TID) <= 0) SpawnForced("DashPuff",GetActorX(Player1TID),GetActorY(Player1TID),GetActorZ(Player1TID)+(8*65536),0,0); }
 }
 else
 {
  TakeActorInventory(Player1TID,"PlayerDashing",1); 
  GiveActorInventory(Player1TID,"DodgeGhostOff",1);
  TakeActorInventory(Player1TID,"DodgeMeleeBoost",1);
 }


 //*************************
 //*"Power Trip" mode check*
 //*************************
 if (GetCVar("dvds_musou_powertripmode") == 2)
 {
  if (CheckActorInventory(Player1TID,"MusouDMGBoost2") < 1) GiveActorInventory(Player1TID,"MusouDMGBoost2", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist2") < 1) GiveActorInventory(Player1TID,"MusouDMGResist2", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGBoost1") > 0) TakeActorInventory(Player1TID,"MusouDMGBoost1", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist1") > 0) TakeActorInventory(Player1TID,"MusouDMGResist1", 1);
 }
 else
 if (GetCVar("dvds_musou_powertripmode") == 1)
 {
  if (CheckActorInventory(Player1TID,"MusouDMGBoost1") < 1) GiveActorInventory(Player1TID,"MusouDMGBoost1", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist1") < 1) GiveActorInventory(Player1TID,"MusouDMGResist1", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGBoost2") > 0) TakeActorInventory(Player1TID,"MusouDMGBoost2", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist2") > 0) TakeActorInventory(Player1TID,"MusouDMGResist2", 1);
 }
 else
 {
  if (CheckActorInventory(Player1TID,"MusouDMGBoost1") > 0) TakeActorInventory(Player1TID,"MusouDMGBoost1", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist1") > 0) TakeActorInventory(Player1TID,"MusouDMGResist1", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGBoost2") > 0) TakeActorInventory(Player1TID,"MusouDMGBoost2", 1);
  if (CheckActorInventory(Player1TID,"MusouDMGResist2") > 0) TakeActorInventory(Player1TID,"MusouDMGResist2", 1);
 }
 

 
 //************************************
 //*Check the Character's Current Mass*
 //************************************
 MiscellaneousVars[201] = 100; // Put at the start just in case some check fails to run so the player will always have at least 100 mass.

 if (CharacterClass == 0) // Deggaris
 {
  MiscellaneousVars[201] = 116; // Deggaris is pretty heavy! :P
  MiscellaneousVars[201] += (MiscellaneousVars[32] / 9); // Defense [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[35] / 15); // Strength [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[34] / 27); // Sorcery [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[36] / 21); // Therapeusis [Seeds]

  // Check Deggaris's Armor Types
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0)	{ MiscellaneousVars[201] += 4;  MiscellaneousVars[201] = MiscellaneousVars[201] * 101 / 100; } 
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0)		{ MiscellaneousVars[201] += 8;  MiscellaneousVars[201] = MiscellaneousVars[201] * 102 / 100; } 
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0)	{ MiscellaneousVars[201] += 12; MiscellaneousVars[201] = MiscellaneousVars[201] * 104 / 100; } 
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0)	{ MiscellaneousVars[201] += 16; MiscellaneousVars[201] = MiscellaneousVars[201] * 108 / 100; }  
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0)	{ MiscellaneousVars[201] += 12; MiscellaneousVars[201] = MiscellaneousVars[201] * 112 / 100; }  
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0)	{ MiscellaneousVars[201] += 16; MiscellaneousVars[201] = MiscellaneousVars[201] * 124 / 100; } 

  // Add a point of mass for every 8 levels for Deggaris [max of 25]
  Mas1 = PlayerLevel / 8;
 }
 else
 if (CharacterClass == 1) // Illucia
 {
  MiscellaneousVars[201] = 92; // Illucia is a tad above average for her frame. :P
  MiscellaneousVars[201] += (MiscellaneousVars[32] / 12); // Defense [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[35] / 18); // Strength [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[34] / 21); // Sorcery [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[36] / 15); // Therapeusis [Seeds]

  // Check Illucia's Armor Types
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0)	{ MiscellaneousVars[201] += 4;  MiscellaneousVars[201] = MiscellaneousVars[201] * 101 / 100; } 
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0)	{ MiscellaneousVars[201] += 8;  MiscellaneousVars[201] = MiscellaneousVars[201] * 102 / 100; } 
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0)	{ MiscellaneousVars[201] += 12; MiscellaneousVars[201] = MiscellaneousVars[201] * 104 / 100; } 
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0)	{ MiscellaneousVars[201] += 16; MiscellaneousVars[201] = MiscellaneousVars[201] * 108 / 100; }  
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0)	{ MiscellaneousVars[201] += 12; MiscellaneousVars[201] = MiscellaneousVars[201] * 112 / 100; }  
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0)	{ MiscellaneousVars[201] += 16; MiscellaneousVars[201] = MiscellaneousVars[201] * 124 / 100; } 

  // Add a point of mass for every 10 levels for Illucia [max of 20]
  Mas1 = PlayerLevel / 10;
 }
 else
 if (CharacterClass == 2) // Flora
 {
  MiscellaneousVars[201] = 68; // Flora almost blows over like a twig in the wind. :V
  MiscellaneousVars[201] += (MiscellaneousVars[32] / 15); // Defense [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[35] / 21); // Strength [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[34] / 15); // Sorcery [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[36] / 9); // Therapeusis [Seeds]

  // Check for Flora's specfic armor items
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) 		MiscellaneousVars[201] += 1;
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) 		MiscellaneousVars[201] += 3;
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) 	MiscellaneousVars[201] += 4;
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) 	MiscellaneousVars[201] += 1;
  if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) 		MiscellaneousVars[201] += 3;
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) 	MiscellaneousVars[201] += 2;
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) 		MiscellaneousVars[201] += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) 		MiscellaneousVars[201] += 1;
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) 		MiscellaneousVars[201] += 2;
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) 	MiscellaneousVars[201] += 1;
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) 		{ MiscellaneousVars[201] += 10; MiscellaneousVars[201] *= 2; }
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) 		{ MiscellaneousVars[201] -= 10; MiscellaneousVars[201] /= 2; }

  // Check Flora's Spiritual Exoskins
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin1") > 0) 	{ MiscellaneousVars[201] += 4; MiscellaneousVars[201] = MiscellaneousVars[201] * 102 / 100; }
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin2") > 0) 	{ MiscellaneousVars[201] += 12; MiscellaneousVars[201] = MiscellaneousVars[201] * 106 / 100; }
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin3") > 0) 	{ MiscellaneousVars[201] += 30; MiscellaneousVars[201] = MiscellaneousVars[201] * 115 / 100; }

  if (CheckActorInventory(Player1TID,"ShieldDefense") > 0) 		MiscellaneousVars[201] = MiscellaneousVars[201] * 1250 / 1000;
  if (CheckActorInventory(Player1TID,"ShieldDefense2") > 0)		MiscellaneousVars[201] = MiscellaneousVars[201] * 1500 / 1000;
  if (CheckActorInventory(Player1TID,"ShieldDefense3") > 0)		MiscellaneousVars[201] = MiscellaneousVars[201] * 1875 / 1000;

  // Add a point of mass for every 12 levels for Flora [max of 16/17]
  Mas1 = PlayerLevel / 12;
 }
 else
 if (CharacterClass == 9) // Petra
 {
  MiscellaneousVars[201] = 70; // Petra's basically the smallest character in the game, but has better mass than Flora does.
  MiscellaneousVars[201] += (MiscellaneousVars[32] / 9); // Defense [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[35] / 21); // Strength [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[34] / 23); // Sorcery [Seeds]
  MiscellaneousVars[201] += (MiscellaneousVars[36] / 13); // Therapeusis [Seeds]

  // Add a point of mass for every 8 levels for Petra [max of 22]
  Mas1 = PlayerLevel / 8;
 }
 
 MiscellaneousVars[201] += Mas1;
 if (PowerupTimer[4] > 0) MiscellaneousVars[201] *= 128; // 128x Mass when Invulnerable
 if (PowerupTimer[7] > 0) MiscellaneousVars[201] *= 4; // 4x Mass when using Divine Avatar
 if (PowerupTimer[11] > 0) MiscellaneousVars[201] *= 2; // 2x Mass when using Buff

  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) { MiscellaneousVars[201] += 17; MiscellaneousVars[201] = MiscellaneousVars[201] * 117 / 100; }
  if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { MiscellaneousVars[201] += 5; MiscellaneousVars[201] = MiscellaneousVars[201] * 105 / 100; } // Deggaris
  if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { MiscellaneousVars[201] += 6; MiscellaneousVars[201] = MiscellaneousVars[201] * 106 / 100; } // Illucia
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { MiscellaneousVars[201] += 4; MiscellaneousVars[201] = MiscellaneousVars[201] * 104 / 100; } // Flora
  if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { MiscellaneousVars[201] += 3; MiscellaneousVars[201] = MiscellaneousVars[201] * 103 / 100; } // Ailish
  if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { MiscellaneousVars[201] += 7; MiscellaneousVars[201] = MiscellaneousVars[201] * 107 / 100; } // Petra
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0) { MiscellaneousVars[201] += 10; MiscellaneousVars[201] = MiscellaneousVars[201] * 110 / 100; }

  if (CheckActorInventory(Player1TID,"FistPlayerBlock") > 0) { MiscellaneousVars[201] = MiscellaneousVars[201] * 2; }
  if (CheckActorInventory(Player1TID,"FistPlayerBlock2") > 0) { MiscellaneousVars[201] = MiscellaneousVars[201] * 8 / 3; }
  if (CheckActorInventory(Player1TID,"FistPlayerBlock3") > 0) { MiscellaneousVars[201] = MiscellaneousVars[201] * 4; }

  SetActorProperty(Player1TID,APROP_Mass,MiscellaneousVars[201]);

 //*********************************************************************
 //*Cursed Shield Degeneration Effect [will NOT kill the player though]*
 //*********************************************************************
 int DegenMinimumHPFactor = 10; int DegenMinimumManaFactor = 80;
 if (GameSkill() == SKILL_VERY_EASY) { DegenMinimumHPFactor = 8; DegenMinimumManaFactor = 64; }
 if (GameSkill() == SKILL_EASY) { DegenMinimumHPFactor = 9; DegenMinimumManaFactor = 72; }
 if (GameSkill() == SKILL_HARD) { DegenMinimumHPFactor = 11; DegenMinimumManaFactor = 88; }
 if (GameSkill() == SKILL_VERY_HARD) { DegenMinimumHPFactor = 12; DegenMinimumManaFactor = 96; }
 DegenMinimumHPFactor = DegenMinimumHPFactor * 3 / 4;
 DegenMinimumManaFactor = DegenMinimumManaFactor * 3 / 4;
 int DegenMinimumHP = MaxHealthTrue / DegenMinimumHPFactor;
 int DegenMinimumMana = MaxMana / DegenMinimumManaFactor;

 int CursedShieldDegenInterval;
 int CursedShieldDegenTimer;

 if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
 {
   // Set Curse Degeneration Intervals
   CursedShieldDegenInterval = 5;
   FreezePlayer = 0;
   if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
   if (PowerupTimer[20] > 0) FreezePlayer += 1;
   if (FreezePlayer == 0)
   {
    buttons = GetPlayerInput(0, INPUT_BUTTONS); 
    if (buttons & BT_FORWARD) CursedShieldDegenInterval = 6;
    else if (buttons & BT_BACK) CursedShieldDegenInterval = 6;
    else if (buttons & BT_MOVELEFT) CursedShieldDegenInterval = 6;
    else if (buttons & BT_MOVERIGHT) CursedShieldDegenInterval = 6;
    else if (buttons & BT_ATTACK) CursedShieldDegenInterval = random(6,7);
    else if (buttons & BT_ALTATTACK) CursedShieldDegenInterval = random(6,7);
    else if (buttons & BT_MOVEUP) CursedShieldDegenInterval = 7;
    else if (buttons & BT_MOVEDOWN) CursedShieldDegenInterval = 7;
    else if (buttons & BT_JUMP) CursedShieldDegenInterval = 6;
    else if (buttons & BT_CROUCH) CursedShieldDegenInterval = 2;
   }

   if (random(1,16) == 1) CursedShieldDegenInterval *= 2;

   // Checks Armor Items and other types for Degen speed.
   C2 = 200;
   if (CharacterClass == 2)
   {
    if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) C2 -= 20;
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) C2 -= 10;
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) C2 -= 15;
    if (CheckActorInventory(Player1TID,"BalrogRing") > 0) C2 -= 25;
    // total of -34 = 66% speed with all four items
   }
   CursedShieldDegenInterval = CursedShieldDegenInterval * C2 / 200;

   if (MenuSystemVars[0] != 0) CursedShieldDegenInterval = 0;
   MiscellaneousVars[15] += CursedShieldDegenInterval;
   if (MiscellaneousVars[15] >= CursedShieldDegenTimer)
   {
    if(GetActorProperty(Player1TID,APROP_Health) > DegenMinimumHP)
	{
     // HP Degeneration
     C2 = random(1,8);
     switch(C2)
     {
      case 1: C3 = MaxHealthTrue / 67; break;
      case 2: case 3: C3 = MaxHealthTrue / 133; break;
      case 4: case 5: C3 = MaxHealthTrue / 200; break;
      case 6: case 7: C3 = MaxHealthTrue / 266; break;
      case 8: C3 = MaxHealthTrue / 334; break;
     }

     if (C3 < 1) C3 = 1;
     C1 = GetActorProperty(Player1TID,APROP_Health);
     C1 -= C3;
     if (C1 < DegenMinimumHP) C1 = DegenMinimumHP;
     SetActorProperty(Player1TID,APROP_HEALTH,C1);
     MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
     MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
	}

    if (CurrentMana > DegenMinimumMana)
    {
     // MP Degeneration
     C2 = random(1,8);
     switch(C2)
     {
      case 1: C3 = MaxMana / 67; break;
      case 2: case 3: C3 = MaxMana / 133; break;
      case 4: case 5: C3 = MaxMana / 200; break;
      case 6: case 7: C3 = MaxMana / 266; break;
      case 8: C3 = MaxMana / 334; break;
     }

     if (C3 < 1) C3 = 1;
     C1 = CurrentMana;
     C1 -= C3;
     if (C1 < DegenMinimumMana) C1 = DegenMinimumMana;
     CurrentMana = C1;
     MiscellaneousVars[243] = CurrentMana;
     MiscellaneousVars[238] = CurrentMana;
    }

    MiscellaneousVars[15] = 0;
    CursedShieldDegenTimer = 175 + random(-10,10);
   }

//   PrintBold(s:"CurseDegen: [",d:MaxHealthTrue,s:"/",d:MaxHealthTrue,s:"] & ",d:buttons,s:"   [",d:MiscellaneousVars[15],s:"/",d:CursedShieldDegenTimer,s:"]");
 }
 else
 {
  C1 = 0;
  C2 = 0;
  C3 = 0;
  MiscellaneousVars[15] = 0;
  CursedShieldDegenTimer = 175 + random(-10,10);
 }

 int StaminaInputFactor = 100;
 int StaminaRegenRate = 0;
 int StaminaDegenRate = 0;
 //***********************
 //**Health-Regen Checks**
 //***********************
  if (CharacterClass == 0) MiscellaneousVars[14] = 118; // Deggaris Regenerates the second Fastest [3.54 seconds]
  if (CharacterClass == 1) MiscellaneousVars[14] = 140; // Illucia has an even speed of Regeneration [4 seconds]
  if (CharacterClass == 2) MiscellaneousVars[14] = 162; // Flora Regenerates slower than Illucia [4.46 seconds]
  if (CharacterClass == 8) MiscellaneousVars[14] = 175; // Ailish Regenerates the slowest [5 seconds]
  if (CharacterClass == 9) MiscellaneousVars[14] = 81; // Petra Regenerates the fastest [2.314285714 seconds]

  if (GameSkill() == SKILL_VERY_EASY) MiscellaneousVars[14] -= 6;
  if (GameSkill() == SKILL_EASY) MiscellaneousVars[14] -= 2;
  if (GameSkill() == SKILL_HARD) MiscellaneousVars[14] += 2;
  if (GameSkill() == SKILL_VERY_HARD) MiscellaneousVars[14] += 6;
  C3 = PlayerLevel / 7; // up to -28
  MiscellaneousVars[14] -= C3; 
  MiscellaneousVars[14] *= 20;

  buttons = GetPlayerInput(0, INPUT_BUTTONS); 
  if (CharacterClass == 2) // Flora
  {
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) C1 = MaxHealthLimit; else C1 = MaxHealthTrue;
  }
  else C1 = MaxHealthTrue;

  int delaycount;
  int StamUpgradeDelay;
  delaycount = 20;

  if (CharacterClass == 0) delaycount += (MiscellaneousVars[32] / 8); // 8pts of Defense will decrease regen wait by 1 tic each [Deggaris]
  if (CharacterClass == 1) delaycount += (MiscellaneousVars[32] / 10); // 10pts of Defense will decrease regen wait by 1 tic each [Illucia]
  if (CharacterClass == 2) delaycount += (MiscellaneousVars[32] / 12); // 12pts of Defense will decrease regen wait by 1 tic each [Flora]
  if (CharacterClass == 8) delaycount += (MiscellaneousVars[32] / 12); // 12pts of Defense will decrease regen wait by 1 tic each [Ailish]
  if (CharacterClass == 9) delaycount += (MiscellaneousVars[32] / 6); // 6pts of Defense will decrease regen wait by 1 tic each [Petra]

  // Stamina Upgrades [Strife]
  StamUpgradeDelay = (MiscellaneousVars[317] * 4) / 3;
  delaycount += StamUpgradeDelay;

  // Accelerates HP Regen when Tension is Boosted
  if (MiscellaneousVars[181] >= 1) delaycount += 1; // "5" = +1 [+5%]
  if (MiscellaneousVars[181] >= 2) delaycount += 1; // "20" = +2 [+10%]
  if (MiscellaneousVars[181] >= 3) delaycount += 2; // "50" = +4 [+20%]
  if (MiscellaneousVars[181] >= 4) delaycount += 2; // "100" = +6 [+30%]
  if (MiscellaneousVars[181] >= 5) delaycount += 3; // "250" = +9 [+45%]
  if (MiscellaneousVars[181] >= 6) delaycount += 4; // "500" = +13 [+65%]
  if (MiscellaneousVars[181] >= 7) delaycount += 5; // "500" = +18 [+90%]

  // Focusing will slightly accelerate HP regeneration on Strife Mode
  if (MiscellaneousVars[212] > 0 && MiscellaneousVars[317] > 0)
  {
    if (MiscellaneousVars[231] >= 105 && MiscellaneousVars[317] >= 1) delaycount += (MiscellaneousVars[317] * 1) / 5;
    if (MiscellaneousVars[231] >= 210 && MiscellaneousVars[317] >= 1) delaycount += (MiscellaneousVars[317] * 1) / 5;
    if (MiscellaneousVars[231] >= 315 && MiscellaneousVars[317] >= 2) delaycount += (MiscellaneousVars[317] * 2) / 5;
    if (MiscellaneousVars[231] >= 420 && MiscellaneousVars[317] >= 2) delaycount += (MiscellaneousVars[317] * 2) / 5;
    if (MiscellaneousVars[231] >= 525 && MiscellaneousVars[317] >= 3) delaycount += (MiscellaneousVars[317] * 3) / 5;
    if (MiscellaneousVars[231] >= 630 && MiscellaneousVars[317] >= 3) delaycount += (MiscellaneousVars[317] * 3) / 5;
    if (MiscellaneousVars[231] >= 735 && MiscellaneousVars[317] >= 4) delaycount += (MiscellaneousVars[317] * 4) / 5;
    if (MiscellaneousVars[231] >= 840 && MiscellaneousVars[317] >= 4) delaycount += (MiscellaneousVars[317] * 4) / 5;
    if (MiscellaneousVars[231] >= 945 && MiscellaneousVars[317] >= 5) delaycount += (MiscellaneousVars[317] * 5) / 5;
    if (MiscellaneousVars[231] >= 1050 && MiscellaneousVars[317] >= 5) delaycount += (MiscellaneousVars[317] * 5) / 5;
    if (MiscellaneousVars[231] >= 1155 && MiscellaneousVars[317] >= 6) delaycount += (MiscellaneousVars[317] * 6) / 5;
    if (MiscellaneousVars[231] >= 1260 && MiscellaneousVars[317] >= 6) delaycount += (MiscellaneousVars[317] * 6) / 5;
    if (MiscellaneousVars[231] >= 1365 && MiscellaneousVars[317] >= 7) delaycount += (MiscellaneousVars[317] * 7) / 5;
    if (MiscellaneousVars[231] >= 1470 && MiscellaneousVars[317] >= 7) delaycount += (MiscellaneousVars[317] * 7) / 5;
    if (MiscellaneousVars[231] >= 1575 && MiscellaneousVars[317] >= 8) delaycount += (MiscellaneousVars[317] * 8) / 5;
    if (MiscellaneousVars[231] >= 1680 && MiscellaneousVars[317] >= 8) delaycount += (MiscellaneousVars[317] * 8) / 5;
    if (MiscellaneousVars[231] >= 1785 && MiscellaneousVars[317] >= 9) delaycount += (MiscellaneousVars[317] * 9) / 5;
    if (MiscellaneousVars[231] >= 1890 && MiscellaneousVars[317] >= 9) delaycount += (MiscellaneousVars[317] * 9) / 5;
    if (MiscellaneousVars[231] >= 1995 && MiscellaneousVars[317] >= 10) delaycount += (MiscellaneousVars[317] * 10) / 5;
    if (MiscellaneousVars[231] >= 2100 && MiscellaneousVars[317] >= 10) delaycount += (MiscellaneousVars[317] * 10) / 5;
  }

  // Check Musou Power Trip Mode
  if (GetCVar("dvds_musou_powertripmode") == 1) delaycount = delaycount * 5 / 2; // 250%
  if (GetCVar("dvds_musou_powertripmode") == 2) delaycount = delaycount * 5; // 500%

  I3 = GetActorProperty(Player1TID,APROP_HEALTH);
  if (I3 < C1)
  {
   if (buttons & BT_FORWARD) StaminaInputFactor = 40;
   else if (buttons & BT_BACK) StaminaInputFactor = 40;
   else if (buttons & BT_MOVELEFT) StaminaInputFactor = 40;
   else if (buttons & BT_MOVERIGHT) StaminaInputFactor = 40;
   else if (buttons & BT_ATTACK) StaminaInputFactor = 50;
   else if (buttons & BT_ALTATTACK) StaminaInputFactor = 50;
   else if (buttons & BT_MOVEUP) StaminaInputFactor = 60;
   else if (buttons & BT_MOVEDOWN) StaminaInputFactor = 60;
   else if (buttons & BT_JUMP) StaminaInputFactor = 40;
   else if (buttons & BT_CROUCH) StaminaInputFactor = 180;
   else StaminaInputFactor = 100;

   delaycount = (delaycount * StaminaInputFactor) / 100;

   // Checks Armor Items and other types for regen speed.
   C2 = 100;
   if (CharacterClass == 2)
   {
    if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) C2 += 20;
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) C2 += 10;
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) C2 += 15;
    if (CheckActorInventory(Player1TID,"BalrogRing") > 0) C2 += 25;
    // total of 70 = 170% speed with all four items
   }
   delaycount = delaycount * C2 / 100;

   // Divine Avatar = 150% Total Regeneration Speed
   if (PowerupTimer[7] > 0) delaycount = delaycount * 3 / 2;

   if (PowerupTimer[12] > 0) delaycount = delaycount * 6 / 5; // Acceleratle = 120% regen speed
   if (PowerupTimer[15] > 0) delaycount = delaycount * 4 / 5; // Deceleratle = 80% regen speed

   // Poison = random 0.25/0.375.0.5/0.625/0.75x regen speed
   if (PowerupTimer[16] > 0) delaycount = (delaycount * random(2,6)) / 8;

   // Fatigue = 0.2x regen speed
   if (PowerupTimer[18] > 0) delaycount = delaycount / 5;

   // Sleep = x5 regen speed
   if (PowerupTimer[20] > 0)
   {
    delaycount *= 5;
    PerkFactor = ((MiscellaneousVars[10013] * 2000) + (MiscellaneousVars[10014] * 5000)) + 10000;
    delaycount = delaycount * PerkFactor / 10000; // "RegenHPFast" and "RegenHPFast EX" perks.
   }

   // Flora's Regeneration Speed is reduced by 5/8s [62.5%] when holding the Ruinous Shield [curse effect]
   if (CharacterClass == 2) if (CheckActorInventory(Player1TID,"RuinousShield") > 0) delaycount = delaycount * 3 / 8;

   // RegenHPFast perks
   if (MiscellaneousVars[10013] > 0)
   {
    PerkFactor = ((MiscellaneousVars[10013] * 2) + (MiscellaneousVars[10014] * 5)) + 10;
    delaycount = delaycount * PerkFactor / 10; // "RegenHPFast" and "RegenHPFast EX" perks.
   }

   // "Cleared of Mind" Perks
   if (MiscellaneousVars[10055] > 0)
   {
    perkfactor = ((MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5)) + 80;
    delaycount = delaycount * perkfactor / 80;
   }

   // If Defending via Fists
   if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) delaycount = delaycount * random(28,32) / 20;

   // Checks Health Regen Rate Menu Option
   delaycount = delaycount * GetCVar("dvds_healthregenmultiplier") / 100;

   // Low Cap to 1 Tics
   if (delaycount < 1) delaycount = 1;

   if (MenuSystemVars[0] != 0) delaycount = 0; // If using In-Game Menus
   if (DVDSSpecialArrayValue[0] == 0) // If "Conscious"
   {
    StaminaRegenRate = delaycount;
    MiscellaneousVars[13] -= delaycount;
   }
  }
  else MiscellaneousVars[13] = MiscellaneousVars[14] + random(-20,20);

  int HPRegenAmount;
  if (MiscellaneousVars[13] < 1)
  {
   // Base of 1 HP regen
   HPRegenAmount = 1;

   // Every 50 Levels = +1 HP Regen
   HPRegenAmount += (PlayerLevel / 50);

   // Every 15 Pts of Strength = +1 HP Regen
   HPRegenAmount += (MiscellaneousVars[35] / 15);

   // Makes having the Dove Ribbon allow HP Regen up to 200% maximum
   if (CharacterClass == 2) // Flora
   {
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) C2 = MaxHealthLimit; else C2 = MaxHealthTrue;
   }
   else C2 = MaxHealthTrue;

   if (I3 > 0 && I3 < C2)
   {
    I3 += HPRegenAmount;
    if (I3 > C2) I3 = C2;
    SetActorProperty(Player1TID,APROP_HEALTH,I3);
    MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
    MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
   }

   MiscellaneousVars[13] = MiscellaneousVars[14] + random(-20,20);
  }

 //***********************
 //**Health-Degen Checks**
 //***********************
  if (GetCVar("dvds_healthdegenmode") == 1)
  {
   if (CharacterClass == 0) MiscellaneousVars[144] = 41; // Deggaris Degenerates the Slowest [1.17 seconds]
   if (CharacterClass == 1) MiscellaneousVars[144] = 35; // Illucia has an even speed of Degeneration [1 second]
   if (CharacterClass == 2) MiscellaneousVars[144] = 29; // Flora Degenerates the second fastest [0.83 seconds]
   if (CharacterClass == 8) MiscellaneousVars[144] = 25; // Ailish Degenerates the fastest
   if (CharacterClass == 9) MiscellaneousVars[144] = 52; // Petra Degenerates even slower than Deggaris

   if (GameSkill() == SKILL_VERY_EASY) MiscellaneousVars[144] += 3;
   if (GameSkill() == SKILL_EASY) MiscellaneousVars[144] += 1;
   if (GameSkill() == SKILL_HARD) MiscellaneousVars[144] -= 1;
   if (GameSkill() == SKILL_VERY_HARD) MiscellaneousVars[144] -= 3;
   C3 = MiscellaneousVars[32] / 24; // 24pts of Defense will increase degen wait by 1 tic each
   MiscellaneousVars[144] += C3; 
   C3 = PlayerLevel / 14; // up to +14
   MiscellaneousVars[144] += C3; 
   MiscellaneousVars[144] *= 20;

   buttons = GetPlayerInput(0, INPUT_BUTTONS); 
   if (CharacterClass == 2) // Flora
   {
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) C1 = MaxHealthLimit; else C1 = MaxHealthTrue;
   }
   else C1 = MaxHealthTrue;
 
   delaycount = 20;

   // Stamina Upgrades [Strife]
   StamUpgradeDelay = (MiscellaneousVars[317] * 3) / 4;
   delaycount -= StamUpgradeDelay;
   
   // Decelerates HP Degen when Tension is Boosted
   if (MiscellaneousVars[181] >= 1) delaycount -= 0; // "5" = -0 [-0%]
   if (MiscellaneousVars[181] >= 2) delaycount -= 1; // "20" = -1 [-5%]
   if (MiscellaneousVars[181] >= 3) delaycount -= 1; // "50" = -2 [-10%]
   if (MiscellaneousVars[181] >= 4) delaycount -= 1; // "100" = -3 [-15%]
   if (MiscellaneousVars[181] >= 5) delaycount -= 1; // "250" = -4 [-20%]
   if (MiscellaneousVars[181] >= 6) delaycount -= 2; // "500" = -6 [-30%]
   if (MiscellaneousVars[181] >= 7) delaycount -= 3; // "500" = -9 [-45%]
   // Check Musou Power Trip Mode
   if (GetCVar("dvds_musou_powertripmode") == 1) delaycount = delaycount * 2 / 5; // 40%
   if (GetCVar("dvds_musou_powertripmode") == 2) delaycount = delaycount / 5; // 20%

   I3 = GetActorProperty(Player1TID,APROP_HEALTH);
   if (I3 > C1)
   {
    if (buttons & BT_FORWARD) StaminaInputFactor = 120;
    else if (buttons & BT_BACK) StaminaInputFactor = 120;
    else if (buttons & BT_MOVELEFT) StaminaInputFactor = 120;
    else if (buttons & BT_MOVERIGHT) StaminaInputFactor = 120;
    else if (buttons & BT_ATTACK) StaminaInputFactor = 130;
    else if (buttons & BT_ALTATTACK) StaminaInputFactor = 130;
    else if (buttons & BT_MOVEUP) StaminaInputFactor = 120;
    else if (buttons & BT_MOVEDOWN) StaminaInputFactor = 120;
    else if (buttons & BT_JUMP) StaminaInputFactor = 140;
    else if (buttons & BT_CROUCH) StaminaInputFactor = 40;
    else StaminaInputFactor = 100;

    delaycount = (delaycount * StaminaInputFactor) / 100;

    // Checks Armor Items and other types for Degen speed.
    C2 = 200;
    if (CharacterClass == 2)
    {
     if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) C2 -= 20;
     if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) C2 -= 10;
     if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) C2 -= 15;
     if (CheckActorInventory(Player1TID,"BalrogRing") > 0) C2 -= 25;
     // total of -34 = 66% speed with all four items
    }
    delaycount = delaycount * C2 / 200;

    // Divine Avatar = 62.5% Total Degeneration Speed
    if (PowerupTimer[7] > 0) delaycount = delaycount * 5 / 8;

    if (PowerupTimer[12] > 0) delaycount = delaycount * 6 / 5; // Acceleratle
    if (PowerupTimer[15] > 0) delaycount = delaycount * 4 / 5; // Deceleratle

    // Fatigue = 5x degen speed
    if (PowerupTimer[18] > 0) delaycount *= 5;

    // Sleep = 0.2x degen speed
    if (PowerupTimer[20] > 0)
	{
	 delaycount /= 5;
     PerkFactor = 10000 - ((MiscellaneousVars[10013] * 2000) + (MiscellaneousVars[10014] * 5000));
     delaycount = delaycount * PerkFactor / 10000; // "RegenHPFast" and "RegenHPFast EX" perks.
	}

    // Flora's Degeneration Speed is multiplied by 2.667 when holding the Ruinous Shield [curse effect]
    if (CharacterClass == 2) if (CheckActorInventory(Player1TID,"RuinousShield") > 0) delaycount = delaycount * 8 / 3;
 
    // RegenHPFast perks
    if (MiscellaneousVars[10013] > 0)
    {
     PerkFactor = 10 - ((MiscellaneousVars[10013] * 2) + (MiscellaneousVars[10014] * 5));
     delaycount = delaycount * PerkFactor / 10; // "RegenHPFast" and "RegenHPFast EX" perks.
	}

    // "Cleared of Mind" Perks
    if (MiscellaneousVars[10055] > 0)
    {
     perkfactor = 80 - ((MiscellaneousVars[10055] * 2) + (MiscellaneousVars[10056] * 5));
     delaycount = delaycount * perkfactor / 80;
    }

    // If Defending via Fists
    if (CheckActorInventory(Player1TID,"FistPlayerBlockItem") > 0) delaycount = delaycount * 20 / random(28,32);

    // Checks Health DeRegen Rate Menu Option
    delaycount = delaycount * GetCVar("dvds_healthdegenmultiplier") / 100;

    // Low Cap to 1 Tics
    if (delaycount < 1) delaycount = 1;
 
    if (MenuSystemVars[0] != 0) delaycount = 0; // If using In-Game Menus
    if (DVDSSpecialArrayValue[0] == 0) // If "Conscious"
    {
 	 StaminaDegenRate = delaycount;
     MiscellaneousVars[143] -= delaycount;
	}
   }
   else MiscellaneousVars[143] = MiscellaneousVars[144] + random(-20,20);

   int HPDegenAmount;
   if (MiscellaneousVars[143] < 1)
   {
    // Base of 1 HP degen
    HPDegenAmount = 1;

    // Makes having the Dove Ribbon allow HP Regen up to 200% maximum
    if (CharacterClass == 2) // Flora
    {
     if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) C2 = MaxHealthLimit; else C2 = MaxHealthTrue;
    }
    else C2 = MaxHealthTrue;

    if (I3 > C2)
    {
     I3 -= HPDegenAmount;
     if (I3 < C2) I3 = C2;
     SetActorProperty(Player1TID,APROP_HEALTH,I3);
     MiscellaneousVars[241] = GetActorProperty(Player1TID,APROP_Health);
     MiscellaneousVars[175] = GetActorProperty(Player1TID,APROP_Health);
    }

    MiscellaneousVars[143] = MiscellaneousVars[144] + random(-20,20);
   }

   if (GetCVar("dvdsdebug_showhpregenstuff") == 1)
   {
    PrintBold(
              s:"Regen: [",d:I3,s:"/",d:MaxHealthTrue,s:"] & ",d:buttons,s:"   [",d:MiscellaneousVars[13],s:"/",d:MiscellaneousVars[14],s:"] & [",d:StaminaRegenRate,s:"]\n",
              s:"Degen: [",d:I3,s:"/",d:MaxHealthTrue,s:"] & ",d:buttons,s:"   [",d:MiscellaneousVars[143],s:"/",d:MiscellaneousVars[144],s:"] & [",d:StaminaDegenRate,s:"]"
             );
   }
  }

 //********************
 //*Skill Level Checks*
 //********************
 if (CheckActorInventory(Player1TID,"IsSkill1") == 0) TakeActorInventory(Player1TID,"IsSkill1", 1);
 if (CheckActorInventory(Player1TID,"IsSkill2") == 0) TakeActorInventory(Player1TID,"IsSkill2", 1);
 if (CheckActorInventory(Player1TID,"IsEasySkill") == 0) TakeActorInventory(Player1TID,"IsEasySkill", 1);
 if (CheckActorInventory(Player1TID,"IsSkill3") == 0) TakeActorInventory(Player1TID,"IsSkill3", 1);
 if (CheckActorInventory(Player1TID,"IsSkill4") == 0) TakeActorInventory(Player1TID,"IsSkill4", 1);
 if (CheckActorInventory(Player1TID,"IsSkill5") == 0) TakeActorInventory(Player1TID,"IsSkill5", 1);
 if (CheckActorInventory(Player1TID,"IsHardSkill") == 0) TakeActorInventory(Player1TID,"IsHardSkill", 1);
 if (GameSkill() == SKILL_VERY_EASY)
 {
  if (CheckActorInventory(Player1TID,"IsSkill1") == 0) GiveActorInventory(Player1TID,"IsSkill1", 1);
  if (CheckActorInventory(Player1TID,"IsEasySkill") == 0) GiveActorInventory(Player1TID,"IsEasySkill", 1);
 }
 if (GameSkill() == SKILL_EASY)
 {
  if (CheckActorInventory(Player1TID,"IsSkill2") == 0) GiveActorInventory(Player1TID,"IsSkill2", 1);
  if (CheckActorInventory(Player1TID,"IsEasySkill") == 0) GiveActorInventory(Player1TID,"IsEasySkill", 1);
 }
 if (GameSkill() == SKILL_NORMAL)
 {
  if (CheckActorInventory(Player1TID,"IsSkill3") == 0) GiveActorInventory(Player1TID,"IsSkill3", 1);
 }
 if (GameSkill() == SKILL_HARD)
 {
  if (CheckActorInventory(Player1TID,"IsSkill4") == 0) GiveActorInventory(Player1TID,"IsSkill4", 1);
  if (CheckActorInventory(Player1TID,"IsHardSkill") == 0) GiveActorInventory(Player1TID,"IsHardSkill", 1);
 }
 if (GameSkill() == SKILL_VERY_HARD)
 {
  if (CheckActorInventory(Player1TID,"IsSkill5") == 0) GiveActorInventory(Player1TID,"IsSkill5", 1);
  if (CheckActorInventory(Player1TID,"IsHardSkill") == 0) GiveActorInventory(Player1TID,"IsHardSkill", 1);
 }


 //*************************
 //*Check DoomSpell Bonuses*
 //*************************
 if (CharacterClass == 0)
 {
  if (CheckActorInventory(Player1TID,"DeggarisDoomspellBonus") == 0) GiveActorInventory(Player1TID,"DeggarisDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"IlluciaDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"IlluciaDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"FloraDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"FloraDoomspellBonus", 1);
 }
 if (CharacterClass == 1)
 {
  if (CheckActorInventory(Player1TID,"DeggarisDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"DeggarisDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"IlluciaDoomspellBonus") == 0) GiveActorInventory(Player1TID,"IlluciaDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"FloraDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"FloraDoomspellBonus", 1);
 }
 if (CharacterClass == 2)
 {
  if (CheckActorInventory(Player1TID,"DeggarisDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"DeggarisDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"IlluciaDoomspellBonus") >= 0) TakeActorInventory(Player1TID,"IlluciaDoomspellBonus", 1);
  if (CheckActorInventory(Player1TID,"FloraDoomspellBonus") == 0) GiveActorInventory(Player1TID,"FloraDoomspellBonus", 1);
 }
//Add Bonuses for Ailish and Petra in the future here
//
//
 //************************
 //**Flora Specfic Checks**
 //************************
 if (ClassCheck > 5)
 {
  if (CharacterClass != 2)
  {
   if (CharacterClass != 8 && CharacterClass != 9) { LevelCap = GetCVar("dvds_marines_maxlevel"); } // Necessary to prevent the game from giving bogus EXP requirements at level 100-199
   if (CharacterClass == 8) { LevelCap = GetCVar("dvds_ailish_maxlevel"); }
   if (CharacterClass == 9) { LevelCap = GetCVar("dvds_petra_maxlevel"); }
   if (LevelCap < 0) LevelCap = 0;
   if (LevelCap > 200) LevelCap = 200;
  }
  else
  {
   if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 0)
   {
    LevelCap = 100;
    if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"KissaBra") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"BalrogRing") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"DivineShield") > 0) LevelCap += 9;
    if (CheckActorInventory(Player1TID,"RuinousShield") > 0) LevelCap += 4;
  
    if (LevelCap == 199) LevelCap = 200;
    if (LevelCap > 200) LevelCap = 200;
   }
   else
   {
    LevelCap = GetCVar("dvds_flora_maxlevel");
    if (LevelCap < 0) LevelCap = 0;
    if (LevelCap > 200) LevelCap = 200;
   }
  }
 }


 //*******************
 //*RUINOUS SHIELD D:*
 //*******************
 int UncurseInterval;
 UncurseInterval = 700; // 70 tics [up to -17 tics with all items]
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) UncurseInterval -= 50;
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) UncurseInterval -= 40;
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) UncurseInterval -= 30;
 if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) UncurseInterval -= 20;
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) UncurseInterval -= 20;
 if (CheckActorInventory(Player1TID,"KissaBra") > 0) UncurseInterval -= 10;

 int UncurseIntervalChance;
 UncurseIntervalChance = 40;
 if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) UncurseIntervalChance += 2;
 if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) UncurseIntervalChance += 3;
 if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) UncurseIntervalChance += 2;
 if (CheckActorInventory(Player1TID,"KissaBra") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) UncurseIntervalChance += 2;
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) UncurseIntervalChance += 1;
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) UncurseIntervalChance -= 2;
 if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) UncurseIntervalChance -= 3;
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) UncurseIntervalChance += 11;


 int UncurseIntervalChance2;
 UncurseIntervalChance2 = 8;
 if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) UncurseIntervalChance2 += random(0,1);
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) UncurseIntervalChance2 += random(1,3);
 if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0) UncurseIntervalChance2 += random(2,5);
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) UncurseIntervalChance2 += 2;
 if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) UncurseIntervalChance2 += 4;
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) UncurseIntervalChance2 += 6;

 // Checks to determine how many points the Ruinous Shield has gathered towards becoming an uncursed Divine Shield
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"RuinousShield") > 0) // Flora
 {
  // Amount of Points is determined by Difficulty level
  if (GameSkill() == SKILL_VERY_EASY) RuinousPtsNeeded = 384;
  if (GameSkill() == SKILL_EASY) RuinousPtsNeeded = 448;
  if (GameSkill() == SKILL_NORMAL) RuinousPtsNeeded = 576;
  if (GameSkill() == SKILL_HARD) RuinousPtsNeeded = 768;
  if (GameSkill() == SKILL_VERY_HARD) RuinousPtsNeeded = 1024;

  RuinousShieldPercent = MiscellaneousVars[202] * 100 / RuinousPtsNeeded;
  RuinousShieldPercentF = MiscellaneousVars[202] * 1000 / RuinousPtsNeeded;

  if (MenuSystemVars[0] == 0) MiscellaneousVars[11] += 10 * (GetCVar("dvds_uncurserate") / 100);
  if (MiscellaneousVars[11] >= UncurseInterval)
  {
   MiscellaneousVars[11] -= UncurseInterval;

   int UncursePtsAdded = 0;
   // Base Chance
   if (random(1,100) <= UncurseIntervalChance) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 4; else UncursePtsAdded += 2;
   }
   // Safe Tea Shoes
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 6; else UncursePtsAdded += 3;
   }
   // Pearly Corset
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"PearlyCorset") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 12; else UncursePtsAdded += 6;
   }
   // Water Flying Dress
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 8; else UncursePtsAdded += 4;
   }
   // Evenstar Necklace
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 2; else UncursePtsAdded += 1;
   }
   // Cloak of Evasion
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"CloakofEvasion") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 4; else UncursePtsAdded += 2;
   }
   // Anubis Cufflinks
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 4; else UncursePtsAdded += 2;
   }
   // Kissa's Bra
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"KissaBra") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 10; else UncursePtsAdded += 5;
   }
   // Balrog Ring
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"BalrogRing") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 2; else UncursePtsAdded += 1;
   }
   // Dove Ribbon
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"DoveRibbon") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 20; else UncursePtsAdded += 10;
   }
   // Falcon Knife Earrings
   if (random(1,100) <= UncurseIntervalChance && CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) // 35-66% chance of increase
   {
    if (random(1,100) <= UncurseIntervalChance2) UncursePtsAdded += 6; else UncursePtsAdded += 3;
   }
   //Print(s:"Uncurse Points Added: ",d:UncursePtsAdded,s:"");
   MiscellaneousVars[202] += UncursePtsAdded;
  }

  // Once You Exceed the Amount, the Shield Automatically Uncurses!
  if (MiscellaneousVars[202] > RuinousPtsNeeded)
  {
   GiveActorInventory(Player1TID,"DivineShield", 1);
   if (CheckActorInventory(Player1TID,"RuinousShield") > 0) TakeActorInventory(Player1TID,"RuinousShield", 1);
   PrintBold(s:"CONGRADULATIONS!!\n\nTHE RUINOUS SHIELD IS NO LONGER CURSED!\n\nYOU NOW POSSESS AND WIELD THE MIGHTY 'DIVINE SHIELD'!!");
   AmbientSound("Uncursed",127);
   MiscellaneousVars[11] = 0;
  }
 }
 // Checks to make sure you cannot hold the Ruinous Shield if you already have a Divine Shield (the latter is the uncursed version of the former).
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"DivineShield") > 0 && CheckActorInventory(Player1TID,"RuinousShield") > 0) TakeActorInventory(Player1TID,"RuinousShield", 1); // Flora



 //*********************
 //*Death Music/Effects*
 //*********************
 int DY1 = MaxHealthTrue * -1;
 // [12] is for the death time counter, to fade the screen to blackish-red when the player dies.
 if (GetActorProperty(Player1TID,APROP_Health) < 1)
 {
  MiscellaneousVars[12] += 1;
  // Game Over Music
  if (GetCVar("dvds_deathmusic") != 0)
  {
   if (MiscellaneousVars[12] == 1) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 1 && MiscellaneousVars[12] == 8) SetMusic("RoReDead",0);
   if (GetCVar("dvds_deathmusic") == 2 && MiscellaneousVars[12] == 35) SetMusic("GaOvYe",0);
   if (GetCVar("dvds_deathmusic") == 3 && MiscellaneousVars[12] == 35) SetMusic("DRQUDEAD",0);
   if (GetCVar("dvds_deathmusic") == 4 && MiscellaneousVars[12] == 4) SetMusic("MiRiBuTi",0);
   if (GetCVar("dvds_deathmusic") == 5 && MiscellaneousVars[12] == 14) SetMusic("ToDiYoAD",0);
   if (GetCVar("dvds_deathmusic") == 6 && MiscellaneousVars[12] == 4) SetMusic("MGS2GMOV",0);
   if (GetCVar("dvds_deathmusic") == 7 && MiscellaneousVars[12] == 35) SetMusic("ShGYaheh",0);
   if (GetCVar("dvds_deathmusic") == 8 && MiscellaneousVars[12] == 4) SetMusic("AH3GMOVR",0);
   if (GetCVar("dvds_deathmusic") == 9 && MiscellaneousVars[12] == 50) SetMusic("JURPRKP2",0);
   
   if (GetCVar("dvds_deathmusic") == 1 && MiscellaneousVars[12] >= 2220) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 2 && MiscellaneousVars[12] >= 367) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 3 && MiscellaneousVars[12] >= 255) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 4 && MiscellaneousVars[12] >= 290) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 5 && MiscellaneousVars[12] >= 3970) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 6 && MiscellaneousVars[12] == 284) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 7 && MiscellaneousVars[12] == 1365) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 8 && MiscellaneousVars[12] == 350) SetMusic("",0);
   if (GetCVar("dvds_deathmusic") == 9 && MiscellaneousVars[12] == 273) SetMusic("",0);
  }

  // "YOU DIED!" msg [HudMessage id 2] :V
  if (MiscellaneousVars[12] >= 4)
  {
   MiscellaneousVars[179] += 1;
   if (MiscellaneousVars[179] >= 20) MiscellaneousVars[179] = 1;
   SetHudSize(1280, 960, 0);
   if (MiscellaneousVars[179] >= 1 && MiscellaneousVars[179] <= 4) Setfont("UDED1");
   if (MiscellaneousVars[179] >= 5 && MiscellaneousVars[179] <= 8) Setfont("UDED2");
   if (MiscellaneousVars[179] >= 9 && MiscellaneousVars[179] <= 12) Setfont("UDED3");
   if (MiscellaneousVars[179] >= 13 && MiscellaneousVars[179] <= 16) Setfont("UDED4");
   if (MiscellaneousVars[179] >= 17 && MiscellaneousVars[179] <= 20) Setfont("UDED5");
   HudmessageBold(s:"A"; 0, 2, CR_DARKRED, 640.0, 480.0, 0.005, 1.0, 1.0);
   SetHudSize(0,0,0);
   SetFont("DVDSSMLFONT");
  }
  else
  {
   HudmessageBold(s:""; 0, 2, CR_DARKRED, 640.0, 480.0, 0.005, 0.01);
   MiscellaneousVars[179] = 0;
  }

   // Fading Death Heart Beats, if not gibbed
  if (GetActorProperty(Player1TID,APROP_Health) > DY1)
  {
   SetActivator(Player1TID); // Set to Player's ID
   if (MiscellaneousVars[12] == 18) localambientsound("heartb2", 120); // +20
   if (MiscellaneousVars[12] == 20) localambientsound("heartb2", 120); // +20

   if (MiscellaneousVars[12] == 42) localambientsound("heartb2", 103); // +22
   if (MiscellaneousVars[12] == 44) localambientsound("heartb2", 103); // +22

   if (MiscellaneousVars[12] == 68) localambientsound("heartb2", 86); // +26
   if (MiscellaneousVars[12] == 70) localambientsound("heartb2", 86); // +26

   if (MiscellaneousVars[12] == 100) localambientsound("heartb2", 69); // +32
   if (MiscellaneousVars[12] == 102) localambientsound("heartb2", 69); // +32

   if (MiscellaneousVars[12] == 140) localambientsound("heartb2", 52); // +40
   if (MiscellaneousVars[12] == 142) localambientsound("heartb2", 52); // +40

   if (MiscellaneousVars[12] == 188) localambientsound("heartb2", 35); // +62
   if (MiscellaneousVars[12] == 190) localambientsound("heartb2", 35); // +50

   if (MiscellaneousVars[12] == 250) localambientsound("heartb2", 18); // +62
   if (MiscellaneousVars[12] == 252) localambientsound("heartb2", 18); // +62
   SetActivator(0); // Set back to worldly activator
  }

  if (GetActorProperty(Player1TID,APROP_Health) > DY1) // Not Gibbed
  {
   if (MiscellaneousVars[12] == 115)
   {
    if (CheckActorInventory(Player1TID,"PlayerDeathFadeOut") < 1) GiveActorInventory(Player1TID,"PlayerDeathFadeOut", 1);
    SetActivator(Player1TID); // Set to Player's ID
    FadeRange(16, 0, 0, 0.0, 16, 0, 0, 1.0, 4.0);
    SetActivator(0); // Set back to worldly activator
   }
   if (MiscellaneousVars[12] == 260) FadeRange(16, 0, 0, 1.0, 255, 0, 0, 1.0, 1.0); // Intended to show a "Game Over" Euqse Screen
  }
  else // Gibbed
  {
   if (MiscellaneousVars[12] == 4)
   {
    if (CheckActorInventory(Player1TID,"PlayerDeathFadeOut") < 1) GiveActorInventory(Player1TID,"PlayerDeathFadeOut", 1);
    SetActivator(Player1TID); // Set to Player's ID
    FadeRange(0, 0, 0, 0.0, 255, 0, 0, 1.0, 0.8);
    SetActivator(0); // Set back to worldly activator
   }
  }
 }
 else
 {
  if (MiscellaneousVars[12] > 114)
  {
   SetActivator(Player1TID); // Set to Player's ID to check for weapons from this actor.
   FadeRange(0, 0, 0, 0.0, 0, 0, 0, 0.0, 0.0);
   SetActivator(0); // Set back to worldly activator at the end of weapon checking.
  }
  HudmessageBold(s:""; 0, 2, CR_DARKRED, 640.0, 480.0, 0.005, 0.01);
  if (CheckActorInventory(Player1TID,"PlayerDeathFadeOut") > 0) TakeActorInventory(Player1TID,"PlayerDeathFadeOut", 1);
  if (GetCVar("dvds_deathmusic") != 0)
  {
   if (MiscellaneousVars[12] > 0) SetMusic("*", 0);
  }
  MiscellaneousVars[12] = 0;
 }

 //*******************
 //*Whistle Countdown*
 //*******************
 if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[168] > 0) MiscellaneousVars[168] -= 1;


 //*****************************************************
 //*Checks Flora's EXP for using the Sceptre of Empyrea*
 //*****************************************************
 if (CharacterClass == 2) // Flora
 {
  BaseSceptreEXP = 312;
  if (GameSkill() == SKILL_VERY_EASY) BaseSceptreEXP = 240;
  if (GameSkill() == SKILL_EASY) BaseSceptreEXP = 288;
  if (GameSkill() == SKILL_NORMAL) BaseSceptreEXP = 312;
  if (GameSkill() == SKILL_HARD) BaseSceptreEXP = 336;
  if (GameSkill() == SKILL_VERY_HARD) BaseSceptreEXP = 384;

  MiscellaneousVars[301] = BaseSceptreEXP * 1; // +1
  MiscellaneousVars[302] = BaseSceptreEXP * 3; // +2
  MiscellaneousVars[303] = BaseSceptreEXP * 6; // +3
  MiscellaneousVars[304] = BaseSceptreEXP * 10; // +4
  MiscellaneousVars[305] = BaseSceptreEXP * 15; // +5
  MiscellaneousVars[306] = BaseSceptreEXP * 21; // +6
  MiscellaneousVars[307] = BaseSceptreEXP * 28; // +7
  MiscellaneousVars[308] = BaseSceptreEXP * 36; // +8
  MiscellaneousVars[309] = BaseSceptreEXP * 45; // +9
  MiscellaneousVars[310] = BaseSceptreEXP * 55; // +10
  MiscellaneousVars[311] = BaseSceptreEXP * 66; // +11
  MiscellaneousVars[312] = BaseSceptreEXP * 78; // +12
  MiscellaneousVars[313] = BaseSceptreEXP * 91; // +13
  MiscellaneousVars[314] = BaseSceptreEXP * 105; // +14
  MiscellaneousVars[315] = BaseSceptreEXP * 120; // +15
  MiscellaneousVars[316] = BaseSceptreEXP * 136; // +16

  if (SceptreLevelEXP >= MiscellaneousVars[316]) SceptreActualLevel = 16;
  if (SceptreLevelEXP < MiscellaneousVars[316]) SceptreActualLevel = 15;
  if (SceptreLevelEXP < MiscellaneousVars[315]) SceptreActualLevel = 14;
  if (SceptreLevelEXP < MiscellaneousVars[314]) SceptreActualLevel = 13;
  if (SceptreLevelEXP < MiscellaneousVars[313]) SceptreActualLevel = 12;
  if (SceptreLevelEXP < MiscellaneousVars[312]) SceptreActualLevel = 11;
  if (SceptreLevelEXP < MiscellaneousVars[311]) SceptreActualLevel = 10;
  if (SceptreLevelEXP < MiscellaneousVars[310]) SceptreActualLevel = 9;
  if (SceptreLevelEXP < MiscellaneousVars[309]) SceptreActualLevel = 8;
  if (SceptreLevelEXP < MiscellaneousVars[308]) SceptreActualLevel = 7;
  if (SceptreLevelEXP < MiscellaneousVars[307]) SceptreActualLevel = 6;
  if (SceptreLevelEXP < MiscellaneousVars[306]) SceptreActualLevel = 5;
  if (SceptreLevelEXP < MiscellaneousVars[305]) SceptreActualLevel = 4;
  if (SceptreLevelEXP < MiscellaneousVars[304]) SceptreActualLevel = 3;
  if (SceptreLevelEXP < MiscellaneousVars[303]) SceptreActualLevel = 2;
  if (SceptreLevelEXP < MiscellaneousVars[302]) SceptreActualLevel = 1;
  if (SceptreLevelEXP < MiscellaneousVars[301]) SceptreActualLevel = 0;

  int i = 0;
  str SceptreLevelItem;
  // REVISED: Changed If statements info a for block for the Sceptre-Level Bitfield (7/3/12)
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   if (SceptreActualLevel != MiscellaneousVars[3]) // [3] is for checking Sceptre Levels so it doesn't have to run EVERY tic and lag the game too badly.
   {
    for (i = 1; i < 17; i++)
    {
     SceptreLevelItem = StrParam(s:"SceptreLevel", d:i);
 
     if (SceptreActualLevel == i)
     GiveActorInventory(Player1TID, SceptreLevelItem, 1);
      else
     TakeActorInventory(Player1TID, SceptreLevelItem, 1);
    }
    MiscellaneousVars[3] = SceptreActualLevel;
   }
  }
  else
  {
   MiscellaneousVars[3] = 0; // Resets the check if death/0 HP is detected
  }

 }


 //*************************************************************************************************************************************************
 //*Check Buddha Mode (Works for Survivability Rate [like a "Last Chance Hit Point" when you'd otherwise die from an attack], like in various RPGs)*
 //*************************************************************************************************************************************************
 BuddhaRNGVal = random (1,1000); // Based on 0.1% to 100.0% [though the displays only show full %]

 // 0.1% for every 2 levels (max of 50 or 5.0% [max of 100 or 10.0% for Flora at Level 200])
 // Base: Deggaris = 3.2%, Illucia = 4.6%, Flora = 3.9%
 MiscellaneousVars[232] = (PlayerLevel / 2) + MiscellaneousVars[0];

 // Every 3/4/5 Points of Defenses = 0.1% increase to Survivability Rate
 if (GameSkill() < SKILL_NORMAL) MiscellaneousVars[232] += MiscellaneousVars[32] / 3;
 if (GameSkill() == SKILL_NORMAL) MiscellaneousVars[232] += MiscellaneousVars[32] / 4;
 if (GameSkill() > SKILL_NORMAL) MiscellaneousVars[232] += MiscellaneousVars[32] / 5;

 if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [Base]");

 // Abhorrent's Equipment Set
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) MiscellaneousVars[232] += 175; // Helmet = 17.5%
 if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) MiscellaneousVars[232] += 50; // Gauntlets (Deggaris) = 5.0%
 if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) MiscellaneousVars[232] += 60; // Gauntlets (Illucia) = 6.0%
 if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) MiscellaneousVars[232] += 40; // Gauntlets (Flora) = 4.0%
 if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) MiscellaneousVars[232] += 80; // Gauntlets (Ailish) = 8.0%
 if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) MiscellaneousVars[232] += 70; // Gauntlets (Petra) = 7.0%
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) MiscellaneousVars[232] += 333; // The One Ring = 33.3%
 if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [SauronEquipCheck]");

 if (CharacterClass != 2) // Deggaris and Illucia take advantage of Doom-equse Armor, however Flora, Ailish, and Petra cannot.
 {
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) MiscellaneousVars[232] += 5; // Green Armor = 0.5% [Deggaris and Illucia Only]
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) MiscellaneousVars[232] += 10; // Blue Armor = 1.0% [Deggaris and Illucia Only]
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) MiscellaneousVars[232] += 16; // Stone Skin [1] = 1.6% [Deggaris and Illucia Only]
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) MiscellaneousVars[232] += 44; // Diamond Skin [1] = 4.4% [Deggaris and Illucia Only]
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) MiscellaneousVars[232] += 66; // Stone Skin [2] = 6.6% [Deggaris and Illucia Only]
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) MiscellaneousVars[232] += 176; // Diamond Skin [2] = 17.6% [Deggaris and Illucia Only]
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [MarineArmorCheck]");
 }
 if (CharacterClass == 2) // Items only Flora can make use of
 {
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin1") > 0) MiscellaneousVars[232] += 32; // Spiritual Exoskin = 3.2% [Flora Only]
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin2") > 0) MiscellaneousVars[232] += 96; // Greater Spiritual Exoskin = 9.6% [Flora Only]
  if (CheckActorInventory(Player1TID,"DSSpiritualExoskin2") > 0) MiscellaneousVars[232] += 288; // Perfected Spiritual Exoskin = 28.8% [Flora Only]
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) MiscellaneousVars[232] += 100; // Anubis Cufflinks = 10.0% [Flora Only]
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) MiscellaneousVars[232] += 150; // Dove Ribbon = 15.0% [Flora Only]
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [FloraArmorCheck]");
 }
 // Divine Avatar = (25.0% of remaining amount uncovered)
 if (PowerupTimer[7] > 0)
 {  
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[232]) / 4;
  MiscellaneousVars[232] += DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [DivineAvatarCheck]");
 }

 // [STRIFE-Compatibility] Stamina Upgrades
 PerkFactor = (MiscellaneousVars[317] * 11);
 MiscellaneousVars[232] += PerkFactor; // [STRIFE-Compatibility] Stamina Upgrades
 if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [STRIFEStamCheck]");

 // Buff = (10.0% of remaining amount uncovered)
 if (PowerupTimer[11] > 0)
 {  
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[232]) / 10;
  MiscellaneousVars[232] += DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [BuffCheck]");
 }
 
 // Life Up Perks = total of +6% Survival
 if (MiscellaneousVars[10001] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10001] * 6) + (MiscellaneousVars[10002] * 15));
  MiscellaneousVars[232] += PerkFactor; 
 }

 // Kissa's Armored Brassiere = 25.0%
 if (CheckActorInventory(Player1TID,"KissaBra") > 0)
 {  
  MiscellaneousVars[232] += 250; 
  if (MiscellaneousVars[232] > 938) MiscellaneousVars[232] = 938;
 } 
 else
 {
  if (MiscellaneousVars[232] > 875) MiscellaneousVars[232] = 875;
 }
 if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [KissaBraCheck]");

 if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
 {
  MiscellaneousVars[232] = MiscellaneousVars[232] / 5; // Ruinous Shield divides Survival Rate by 5
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [CursedShieldCheck]");
 }

 if (PowerupTimer[4] > 0) // Invulnerability
 {
  MiscellaneousVars[232] = 1000;
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [Invulnerable]");
 }

 if (MiscellaneousVars[9043] > 0) // Death Rage's Invulnerability
 {
  MiscellaneousVars[232] = 1000;
  if (GetCVar("dvdsdebug_showsurvivalstuff") > 0) PrintBold(s:"Survival Rate %: ",d:MiscellaneousVars[232],s:" [DeathRageInvuln]");
 }

 // For the Status Bar (Only shows an int value, not a floating point amount)
 SurvivalWhole = MiscellaneousVars[232] / 10;

 if (BuddhaRNGVal <= MiscellaneousVars[232]) SetPlayerProperty(1,1,PROP_BUDDHA); // Buddha Mode is basically perfect for emulating Survivability [this also means, you can't use the Buddha cheat directly though]
 else SetPlayerProperty(1,0,PROP_BUDDHA);
 if (GetCVar("dvdsdebug_showsurvivalstuff") > 0)
 {
  if (BuddhaRNGVal <= MiscellaneousVars[232])
  {
   PrintBold(s:"\c[green]Survival Rate Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[green]Survival Rate Chance % - ",d:MiscellaneousVars[232]);
  }
  else
  {
   PrintBold(s:"\c[red]Survival Rate Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[red]Survival Rate Chance % - ",d:MiscellaneousVars[232]);
  }
 }

 //***********************
 //*Dealing Critical Hits*
 //***********************
 MiscellaneousVars[235] = MiscellaneousVars[0];
 if (GameSkill() < SKILL_NORMAL) MiscellaneousVars[235] /= 3;
 if (GameSkill() == SKILL_NORMAL) MiscellaneousVars[235] /= 4; 
 if (GameSkill() > SKILL_NORMAL) MiscellaneousVars[235] /= 5;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" [Base]");

 DivineAvatarBuffValue = ((PlayerLevel * 5) / 4); // Each level is +0.125% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [LvlCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[31] * 3) / 4); // 1 pt of Agility is +0.075% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [AglCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[32] * 3) / 8); // 1 pt of Defense is +0.0375% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [DefCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[33] * 7) / 4); // 1 pt of Deftness is +0.175% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [DeftCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[34] * 1) / 8); // 1 pt of Sorcery is +0.0125% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [SorcCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[35] * 1) / 2); // 1 pt of Strength is +0.05% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [StrCheck]");

 DivineAvatarBuffValue = ((MiscellaneousVars[36] * 1) / 8); // 1 pt of Therapeusis is +0.0125% crit rate
 MiscellaneousVars[235] += DivineAvatarBuffValue;
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [TherCheck]");


 // Oomph = (8.33% of remaining amount uncovered)
 if (PowerupTimer[10] > 0)
 {
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[235]) / 12;
  MiscellaneousVars[235] += DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [OomphCheck]");
 }

 // Blunt = (-8.33% of remaining amount uncovered)
 if (PowerupTimer[13] > 0)
 {
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[235]) / 12;
  MiscellaneousVars[235] -= DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (-",d:DivineAvatarBuffValue,s:") [BluntCheck]");
 }

 // Acceleratle (16.67% of remaining amount uncovered)
 if (PowerupTimer[12] > 0)
 {
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[235]) / 6;
  MiscellaneousVars[235] += DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [AccelCheck]");
 }
 // Deceleratle (-16.67% of remaining amount uncovered)
 if (PowerupTimer[15] > 0)
 {
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[235]) / 6;
  MiscellaneousVars[235] -= DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (-",d:DivineAvatarBuffValue,s:") [DecelCheck]");
 }

 // Divine Avatar (25% of remaining amount uncovered)
 if (PowerupTimer[7] > 0)
 {
  DivineAvatarBuffValue = (1000 - MiscellaneousVars[235]) / 4;
  MiscellaneousVars[235] += DivineAvatarBuffValue;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DivineAvatarBuffValue,s:") [DivAvaCheck]");
 }
 
 // [STRIFE-Compatibility] Stamina Upgrades [up to 8.25% more Crit]
 if (MiscellaneousVars[317] > 0)
 {
  PerkFactor = (MiscellaneousVars[317] * 33) / 4;
  MiscellaneousVars[235] += PerkFactor; // [STRIFE-Compatibility] Stamina Upgrades
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:PerkFactor,s:") [STRIFEStamCheck]");
 }

 // [STRIFE-Compatibility] Accuracy Upgrades [up to 5.25% more Crit]
 if (MiscellaneousVars[318] > 0)
 {
  PerkFactor = (MiscellaneousVars[318] * 21) / 4;
  MiscellaneousVars[235] += PerkFactor; // [STRIFE-Compatibility] Accuracy Upgrades
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:PerkFactor,s:") [STRIFEAccuCheck]");
 }

 int UppercutBonusAdd;
 if (CheckActorInventory(Player1TID,"UppercutCritBonus1") > 0) // up to +7.14% more Crit
 {
  UppercutBonusAdd = (1000 - MiscellaneousVars[235]) / 14;
  MiscellaneousVars[235] += UppercutBonusAdd;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:UppercutBonusAdd,s:") [UppercutBonus]");
 }
 if (CheckActorInventory(Player1TID,"UppercutCritBonus2") > 0) // up to +16.67% more Crit
 {
  UppercutBonusAdd = (1000 - MiscellaneousVars[235]) / 6;
  MiscellaneousVars[235] += UppercutBonusAdd;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:UppercutBonusAdd,s:") [UppercutBonus]");
 }

 // Kick Bonus
 if (CheckActorInventory(Player1TID,"KickCritBonus1") > 0) // up to +8.33% more Crit
 {
  UppercutBonusAdd = (1000 - MiscellaneousVars[235]) / 12;
  MiscellaneousVars[235] += UppercutBonusAdd;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:UppercutBonusAdd,s:") [KickBonus]");
 }
 if (CheckActorInventory(Player1TID,"KickCritBonus2") > 0) // up to +20% more Crit
 {
  UppercutBonusAdd = (1000 - MiscellaneousVars[235]) * 1 / 5;
  MiscellaneousVars[235] += UppercutBonusAdd;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:UppercutBonusAdd,s:") [KickBonus]");
 }

 int MeleeWeaponCritCheck = 0;
 If (StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistAilish") == 0 || StrIcmp(weapon, "FistPetra") == 0 || StrIcmp(weapon, "FistFlora") == 0 || StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0 || StrIcmp(weapon, "Chainsaw2") == 0 || StrIcmp(weapon, "DoubleBladedChainsaw") == 0) MeleeWeaponCritCheck = 1;

 int DashBonusAdd;
 if (CheckActorInventory(Player1TID,"PlayerDashing") > 0) // +6.25% more Crit [with most melee weapons], +1.5625% with other weapons
 {
  If (MeleeWeaponCritCheck == 1)
  {
   DashBonusAdd = (1000 - MiscellaneousVars[235]) / 16;
  }
  else
  {
   DashBonusAdd = (1000 - MiscellaneousVars[235]) / 64;
  }
  MiscellaneousVars[235] += DashBonusAdd;
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:DashBonusAdd,s:") [DashBonus]");
 }
 
 // Berserker Fit [+4.0% per level]
 int BerserkBonusAdd;
 if (MiscellaneousVars[10051] > 0)
 {
  If (MeleeWeaponCritCheck == 1)
  {
   BerserkBonusAdd = MiscellaneousVars[10051] * 40;
   MiscellaneousVars[235] += BerserkBonusAdd;
   if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" (+",d:BerserkBonusAdd,s:") [BerserkerFit]");
  }
 }
 
 // Stam Up Perks = total of +8% Crit
 if (MiscellaneousVars[10005] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10005] * 8) + (MiscellaneousVars[10006] * 20));
  MiscellaneousVars[235] += PerkFactor; 
  if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0) PrintBold(s:"Crit Rate %: ",d:MiscellaneousVars[235],s:" [StamUp]");
 }

 // High-Cap Crit at 100.0%, Low-Cap it at 0.1%
 if (MiscellaneousVars[235] < 1) MiscellaneousVars[235] = 1;
 if (MiscellaneousVars[235] > 1000) MiscellaneousVars[235] = 1000;

 if (CheckActorInventory(Player1TID,"CheatCrit") > 0 ) MiscellaneousVars[235] = 2000;
 
 //PrintBold(d:MiscellaneousVars[235]);
 BuddhaRNGVal = random (1,1000); // Based on 0.1% to 100.0% [though the displays only show full %]
 if (MiscellaneousVars[235] < 1) MiscellaneousVars[235] = 1;
 if (BuddhaRNGVal <= MiscellaneousVars[235]) GiveActorInventory(Player1TID,"DealCriticalHit", 1);
 else TakeActorInventory(Player1TID,"DealCriticalHit", 1);
 if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0)
 {
  if (BuddhaRNGVal <= MiscellaneousVars[235])
  {
   PrintBold(s:"\c[green]Critical Hit Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[green]Critical Hit Chance % - ",d:MiscellaneousVars[235]);
  }
  else
  {
   PrintBold(s:"\c[red]Critical Hit Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[red]Critical Hit Chance % - ",d:MiscellaneousVars[235]);
  }
 }


 //******************************************************
 //*Hellcore Cooldown Process [25 tics = 1% of cooldown]*
 //******************************************************
 if (HellcoreOverheatLevel > 0 && GetActorProperty(Player1TID,APROP_HEALTH) > 0)
 {
  HellcoreCoolRatio = 400; // 25 tics = 10000 units [or 1% cooldown], so 1 tic = 400 units (or 0.04% cooldown)
  if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [Base]: ",d:HellcoreCoolRatio);

  // Dove Ribbon quickly cools down Hellcore meter.
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
  {
   HellcoreCoolRatio *= 3;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [DoveRibbon]: ",d:HellcoreCoolRatio);
  }

  // Divine Avatar speeds up cooldown by 50%
  if (PowerupTimer[7] > 0) 
  {
   HellcoreCoolRatio = HellcoreCoolRatio * 3 / 2;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [DivineAvatar]: ",d:HellcoreCoolRatio);
  }

  // Fatigue = 0.2x cooldown speed
  if (PowerupTimer[18] > 0)
  {
   HellcoreCoolRatio /= 5;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [Fatigue]: ",d:HellcoreCoolRatio);
  }

  // Sleep VERY quickly cools down Hellcore meter.
  if (PowerupTimer[20] > 0) 
  {
   HellcoreCoolRatio *= 5; 
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [Sleep]: ",d:HellcoreCoolRatio);
  }

  // "Cleared of Mind: Perk
  if (MiscellaneousVars[10055] > 0)
  {
   PerkFactor = ((MiscellaneousVars[10055] * 6) + (MiscellaneousVars[10056] * 15)) + 80;
   HellcoreCoolRatio = HellcoreCoolRatio * PerkFactor / 80;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [CoM-Perk]: ",d:HellcoreCoolRatio);
  }

  // Check Hellcore Cooldown Multiplier in Options
  HellcoreCoolRatio = (HellcoreCoolRatio * GetCVar("dvds_heatcoolmultiplier")) / 100;
  if (HellcoreCoolRatio < 1) HellcoreCoolRatio = 1;
  if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [HCC-Multiplier]: ",d:HellcoreCoolRatio);

  if (CheckActorInventory(Player1TID,"IsHaSatanNow") > 0)
  {  
   HellcoreCoolRatio = HellcoreCoolRatio * 16;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [HS-Check]: ",d:HellcoreCoolRatio);
  }

  if (DVDSSpecialArrayValue[3] > 0) // Playing Unloved [2x Cooldown Speed]
  {
   HellcoreCoolRatio = HellcoreCoolRatio * 2;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [Unloved-Check]: ",d:HellcoreCoolRatio);
  }

  HellcoreOverheatLevel -= HellcoreCoolRatio;
  if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"CoolDown Amt [Final]: ",d:HellcoreCoolRatio);
 }
 if (HellcoreOverheatLevel < 0) HellcoreOverheatLevel = 0;

 // Converts Hellcore Timer to % format for HUD display
 HellcorePercentFull = HellcoreOverheatLevel / 100;
 if (HellcorePercentFull < 0) HellcorePercentFull = 0;
 if (HellcorePercentFull > 1000) HellcorePercentFull = 1000;

 H1 = 0;
 SetActivator(Player1TID); // Set to Player's ID to check for weapons from this actor.
 if (CheckWeapon("ImpClaw") == 1) H1 += 1;
 if (CheckWeapon("DarkImpClaw") == 1) H1 += 1; 
 if (CheckWeapon("CacodemonEye") == 1) H1 += 1; 
 if (CheckWeapon("CacolanternEye") == 1) H1 += 1; 
 if (CheckWeapon("AbaddonEye") == 1) H1 += 1; 
 if (CheckWeapon("KnightFist") == 1) H1 += 1; 
 if (CheckWeapon("BaronFist") == 1) H1 += 1; 
 if (CheckWeapon("BelphegorFist") == 1) H1 += 1; 
 if (CheckWeapon("BruiserFist") == 1) H1 += 1; 
 if (CheckWeapon("ArchonFist") == 1) H1 += 1; 
 if (CheckWeapon("PyroFist") == 1) H1 += 1; 
 if (CheckWeapon("IncarnateSkull") == 1) H1 += 1; 
 if (CheckWeapon("ArchvileHand") == 1) H1 += 1; 
 if (CheckWeapon("DiabloistHand") == 1) H1 += 1; 
 if (CheckWeapon("BalrogFist") == 1) H1 += 1; 
 if (H1 > 0) { GiveActorInventory(Player1TID,"FloraUsingHellcoreWeapon", 1); } else { TakeActorInventory(Player1TID,"FloraUsingHellcoreWeapon", 1); }
 SetActivator(0); // Set back to worldly activator at the end of weapon checking.


 if (CharacterClass == 2) 
 {
  TakeActorInventory(Player1TID,"FloraHellcoreNotOverheated", 1);
  TakeActorInventory(Player1TID,"FloraHellcore25PercentOverheated", 1);
  TakeActorInventory(Player1TID,"FloraHellcore50PercentOverheated", 1);
  TakeActorInventory(Player1TID,"FloraHellcore75PercentOverheated", 1);
  TakeActorInventory(Player1TID,"FloraHellcore100PercentOverheated", 1);
  TakeActorInventory(Player1TID,"FloraHellcore250PercentOverheated", 1);

  if (HellcoreOverheatLevel < 250000) GiveActorInventory(Player1TID,"FloraHellcoreNotOverheated", 1);
  if (HellcoreOverheatLevel > 249999 && HellcoreOverheatLevel < 500000) GiveActorInventory(Player1TID,"FloraHellcore25PercentOverheated", 1);
  if (HellcoreOverheatLevel > 499999 && HellcoreOverheatLevel < 750000) GiveActorInventory(Player1TID,"FloraHellcore50PercentOverheated", 1);
  if (HellcoreOverheatLevel > 749999 && HellcoreOverheatLevel < 1000000) GiveActorInventory(Player1TID,"FloraHellcore75PercentOverheated", 1);
  if (HellcoreOverheatLevel > 999999 && HellcoreOverheatLevel < 2500000) GiveActorInventory(Player1TID,"FloraHellcore100PercentOverheated", 1);
  if (HellcoreOverheatLevel > 2499999) GiveActorInventory(Player1TID,"FloraHellcore250PercentOverheated", 1);
 }

 // Melee Weapon Inv Check
 H1 = 0;
 SetActivator(Player1TID); // Set to Player's ID to check for weapons from this actor.
 if (CheckWeapon("Fist") == 1) H1 += 1;
 if (CheckWeapon("FistDeggaris") == 1) H1 += 1; 
 if (CheckWeapon("FistIllucia") == 1) H1 += 1; 
 if (CheckWeapon("FistFlora") == 1) H1 += 1; 
 if (CheckWeapon("SauronGauntlets") == 1) H1 += 1; 
 if (CheckWeapon("SauronGauntletsIllucia") == 1) H1 += 1; 
 if (CheckWeapon("SauronGauntletsFlora") == 1) H1 += 1; 
 if (CheckWeapon("SauronGauntletsAilish") == 1) H1 += 1; 
 if (CheckWeapon("SauronGauntletsPetra") == 1) H1 += 1; 
 if (CheckWeapon("SceptreOfEmpyrea") == 1) H1 += 1; 
 if (CheckWeapon("Chainsaw") == 1) H1 += 1; 
 if (CheckWeapon("Chainsaw2") == 1) H1 += 1; 
 if (CheckWeapon("DoubleBladedChainsaw") == 1) H1 += 1; 
 if (H1 > 0) { GiveActorInventory(Player1TID,"UsingMeleeWeapon", 1); } else { TakeActorInventory(Player1TID,"UsingMeleeWeapon", 1); }
 SetActivator(0); // Set back to worldly activator at the end of weapon checking.



 //*************************
 //*Aeon Point Distribution*
 //*************************
 int AeonBonusChecker = GetCVar("dvds_aeonpointbonus");
 if (AeonBonusChecker == 1)
 {
  // Kills
  MiscellaneousVars[63] = 0;
  for (i = 0; i < 51; i++) { MiscellaneousVars[63] += MonstersKilled[i]; }
  MiscellaneousVars[61] = MiscellaneousVars[63] / GetCVar("dvds_killsforaeonpts");

  if (MiscellaneousVars[62] < MiscellaneousVars[61])
  {
   tempaeonpts = 1;
   tempaeonpts *= MiscellaneousVars[86];

   MiscellaneousVars[25] += tempaeonpts; MiscellaneousVars[224] += tempaeonpts; MiscellaneousVars[2033] = 105;
   MiscellaneousVars[62] += 1;
 
   if (PlayerLevel >= MiscellaneousVars[197])
   {
    SetHudSize(0,0,0);
    HudMessage(s:"You have gained ",d:tempaeonpts,s:" Aeon Point[s] for killing enough monsters!\n\nRemember to allocate your Aeon Points as soon as possible...";
    HUDMSG_LOG,3432,cr_orange,1.5,0.5,2.75);
   }
   tempaeonpts = 0;
  }

  // Secrets
  MiscellaneousVars[64] = 0;
  for (i = 0; i < 56; i++) { MiscellaneousVars[64] += SecretsFound[i]; }
  MiscellaneousVars[59] = MiscellaneousVars[64] / GetCVar("dvds_secretsforaeonpts");
 
  if (MiscellaneousVars[60] < MiscellaneousVars[59])
  {
   tempaeonpts = 1;
   tempaeonpts *= MiscellaneousVars[86];

   MiscellaneousVars[25] += tempaeonpts; MiscellaneousVars[224] += tempaeonpts; MiscellaneousVars[2033] = 105;
   MiscellaneousVars[60] += 1;
 
   if (PlayerLevel >= MiscellaneousVars[197])
   {
    SetHudSize(0,0,0);
    HudMessage(s:"You have gained ",d:tempaeonpts,s:" Aeon Point[s] for finding enough secrets!\n\nRemember to allocate your Aeon Points as soon as possible...";
    HUDMSG_LOG,3432,cr_orange,1.5,0.5,2.75);
   }
   tempaeonpts = 0;
  }
 
  // Items
  MiscellaneousVars[56] = 0;
  for (i = 0; i < 51; i++) { MiscellaneousVars[56] += ItemsFound[i]; }
  MiscellaneousVars[57] = MiscellaneousVars[56] / GetCVar("dvds_itemsforaeonpts");
 
  if (MiscellaneousVars[58] < MiscellaneousVars[57])
  {
   tempaeonpts = 1;
   tempaeonpts *= MiscellaneousVars[86];

   MiscellaneousVars[25] += tempaeonpts; MiscellaneousVars[224] += tempaeonpts; MiscellaneousVars[2033] = 105;
   MiscellaneousVars[58] += 1;
 
   if (PlayerLevel >= MiscellaneousVars[197])
   {
    SetHudSize(0,0,0);
    HudMessage(s:"You have gained ",d:tempaeonpts,s:" Aeon Point[s] for finding enough special items!\n\nRemember to allocate your Aeon Points as soon as possible...";
    HUDMSG_LOG,3432,cr_orange,1.5,0.5,2.75);
   }
   tempaeonpts = 0;
  }

 }
 if (MiscellaneousVars[25] < 1) MiscellaneousVars[24] = 0;
 if (MiscellaneousVars[31] > 511 && MiscellaneousVars[32] > 511 && MiscellaneousVars[33] > 511 && MiscellaneousVars[34] > 511 && MiscellaneousVars[35] > 511 && MiscellaneousVars[36] > 511) MiscellaneousVars[24] = 0;



 //*************************************
 //*Inventory Items Check [death-exits]*
 //*************************************
 if (MiscellaneousVars[149] != 1) // If the check is not on, acculmate the ArmorBits as per the norm.
 {
  MiscellaneousVars[214] = CheckActorInventory(Player1TID,"MedicinalHerb");
  MiscellaneousVars[215] = CheckActorInventory(Player1TID,"StrongMedicine");
  MiscellaneousVars[216] = CheckActorInventory(Player1TID,"SpecialMedicine");
  MiscellaneousVars[217] = CheckActorInventory(Player1TID,"YggdrasilDew");
  MiscellaneousVars[218] = CheckActorInventory(Player1TID,"PaxaPunch");
  MiscellaneousVars[219] = CheckActorInventory(Player1TID,"LesserVimstone");
  MiscellaneousVars[220] = CheckActorInventory(Player1TID,"GreaterVimstone");
  MiscellaneousVars[221] = CheckActorInventory(Player1TID,"MercuryBandana");
  MiscellaneousVars[287] = CheckActorInventory(Player1TID,"MagicWater");
  MiscellaneousVars[288] = CheckActorInventory(Player1TID,"SageElixir");
  MiscellaneousVars[289] = CheckActorInventory(Player1TID,"ElfinElixir");
  MiscellaneousVars[290] = CheckActorInventory(Player1TID,"MonsterMunchies");
  MiscellaneousVars[401] = CheckActorInventory(Player1TID,"RockBombShard");
 }
 else
 {
  if (GetCvar("dvds_pistolrestart_allkeepinventoryitems") > 0)
  {
   SetActorInventory(Player1TID,"GreaterVimstone",MiscellaneousVars[220]);
   if (CheckActorInventory(Player1TID,"GreaterVimstone") == 0) { GiveActorInventory(Player1TID,"GreaterVimstone",1);  TakeActorInventory(Player1TID,"GreaterVimstone",1); }

   SetActorInventory(Player1TID,"LesserVimstone",MiscellaneousVars[219]);
   if (CheckActorInventory(Player1TID,"LesserVimstone") == 0) { GiveActorInventory(Player1TID,"LesserVimstone",1);  TakeActorInventory(Player1TID,"LesserVimstone",1); }

   SetActorInventory(Player1TID,"MonsterMunchies",MiscellaneousVars[290]);
   if (CheckActorInventory(Player1TID,"MonsterMunchies") == 0) { GiveActorInventory(Player1TID,"MonsterMunchies",1);  TakeActorInventory(Player1TID,"MonsterMunchies",1); }

   SetActorInventory(Player1TID,"MercuryBandana",MiscellaneousVars[221]);
   if (CheckActorInventory(Player1TID,"MercuryBandana") == 0) { GiveActorInventory(Player1TID,"MercuryBandana",1);  TakeActorInventory(Player1TID,"MercuryBandana",1); }

   SetActorInventory(Player1TID,"PaxaPunch",MiscellaneousVars[218]);
   if (CheckActorInventory(Player1TID,"PaxaPunch") == 0) { GiveActorInventory(Player1TID,"PaxaPunch",1);  TakeActorInventory(Player1TID,"PaxaPunch",1); }

   SetActorInventory(Player1TID,"RockBombShard",MiscellaneousVars[401]);
   if (CheckActorInventory(Player1TID,"RockBombShard") == 0) { GiveActorInventory(Player1TID,"RockBombShard",1);  TakeActorInventory(Player1TID,"RockBombShard",1); }

   SetActorInventory(Player1TID,"YggdrasilDew",MiscellaneousVars[217]);
   if (CheckActorInventory(Player1TID,"YggdrasilDew") == 0) { GiveActorInventory(Player1TID,"YggdrasilDew",1);  TakeActorInventory(Player1TID,"YggdrasilDew",1); }

   SetActorInventory(Player1TID,"ElfinElixir",MiscellaneousVars[289]);
   if (CheckActorInventory(Player1TID,"ElfinElixir") == 0) { GiveActorInventory(Player1TID,"ElfinElixir",1);  TakeActorInventory(Player1TID,"ElfinElixir",1); }

   SetActorInventory(Player1TID,"SageElixir",MiscellaneousVars[288]);
   if (CheckActorInventory(Player1TID,"SageElixir") == 0) { GiveActorInventory(Player1TID,"SageElixir",1);  TakeActorInventory(Player1TID,"SageElixir",1); }

   SetActorInventory(Player1TID,"MagicWater",MiscellaneousVars[287]);
   if (CheckActorInventory(Player1TID,"MagicWater") == 0) { GiveActorInventory(Player1TID,"MagicWater",1);  TakeActorInventory(Player1TID,"MagicWater",1); }

   SetActorInventory(Player1TID,"SpecialMedicine",MiscellaneousVars[216]);
   if (CheckActorInventory(Player1TID,"SpecialMedicine") == 0) { GiveActorInventory(Player1TID,"SpecialMedicine",1);  TakeActorInventory(Player1TID,"SpecialMedicine",1); }

   SetActorInventory(Player1TID,"StrongMedicine",MiscellaneousVars[215]);
   if (CheckActorInventory(Player1TID,"StrongMedicine") == 0) { GiveActorInventory(Player1TID,"StrongMedicine",1);  TakeActorInventory(Player1TID,"StrongMedicine",1); }

   SetActorInventory(Player1TID,"MedicinalHerb",MiscellaneousVars[214]);
   if (CheckActorInventory(Player1TID,"MedicinalHerb") == 0) { GiveActorInventory(Player1TID,"MedicinalHerb",1);  TakeActorInventory(Player1TID,"MedicinalHerb",1); }
  }
 }


 
 //*****************************
 //*Weapons Check [death-exits]*
 //*****************************
 int WeaponBits = 0;
 if (MiscellaneousVars[149] != 1) // If the check is not on, acculmate the ArmorBits as per the norm.
 {
  if (CharacterClass == 2) // Flora
  {
   // Slot 1
   if (CheckActorInventory(Player1TID,"FistFlora")) WeaponBits += 1;
   if (CheckActorInventory(Player1TID,"SceptreOfEmpyrea")) WeaponBits += 2;
   // Slot 3
   if (CheckActorInventory(Player1TID,"DiarisLongBow")) WeaponBits += 4;
   MiscellaneousVars[156] = CheckActorInventory(Player1TID,"DiarisArrow");
   // Slot 4
   if (CheckActorInventory(Player1TID,"ImpClaw")) WeaponBits += 8;
   if (CheckActorInventory(Player1TID,"DarkImpClaw")) WeaponBits += 16;
   if (CheckActorInventory(Player1TID,"CacodemonEye")) WeaponBits += 32;
   if (CheckActorInventory(Player1TID,"CacolanternEye")) WeaponBits += 64;
   if (CheckActorInventory(Player1TID,"AbaddonEye")) WeaponBits += 128;
   // Slot 5
   if (CheckActorInventory(Player1TID,"KnightFist")) WeaponBits += 256;
   if (CheckActorInventory(Player1TID,"BaronFist")) WeaponBits += 512;
   if (CheckActorInventory(Player1TID,"BelphegorFist")) WeaponBits += 1024;
   if (CheckActorInventory(Player1TID,"BruiserFist")) WeaponBits += 2048;
   if (CheckActorInventory(Player1TID,"ArchonFist")) WeaponBits += 4096;
   if (CheckActorInventory(Player1TID,"PyroFist")) WeaponBits += 8192;
   // Slot 6
   if (CheckActorInventory(Player1TID,"IncarnateSkull")) WeaponBits += 16384;
   if (CheckActorInventory(Player1TID,"ArchvileHand")) WeaponBits += 32768;
   if (CheckActorInventory(Player1TID,"DiabloistHand")) WeaponBits += 65536;
   if (CheckActorInventory(Player1TID,"BalrogFist")) WeaponBits += 131072;
  }
  else // Marines
  {
   // Slot 1
   if (CharacterClass == 0 && CheckActorInventory(Player1TID,"FistDeggaris")) WeaponBits += 1;
   if (CharacterClass == 1 && CheckActorInventory(Player1TID,"FistIllucia")) WeaponBits += 1;
   if (CheckActorInventory(Player1TID,"Chainsaw2") > 0) WeaponBits += 2;
   if (CheckActorInventory(Player1TID,"DoubleBladedChainsaw") > 0) WeaponBits += 4;
   // Slot 2
   if (CheckActorInventory(Player1TID,"Pistol2") > 0) WeaponBits += 8;
   if (CheckActorInventory(Player1TID,"DualPistols") > 0) WeaponBits += 16;
   // Slot 3
   if (CheckActorInventory(Player1TID,"Shotgun2") > 0) WeaponBits += 32;
   if (CheckActorInventory(Player1TID,"SuperShotgun2") > 0) WeaponBits += 64;
   // Slot 4
   if (CheckActorInventory(Player1TID,"Chaingun2") > 0) WeaponBits += 128;
   if (CheckActorInventory(Player1TID,"Minigun") > 0) WeaponBits += 256;
   // Slot 5
   if (CheckActorInventory(Player1TID,"RocketLauncher2") > 0) WeaponBits += 512;
   // Slot 6
   if (CheckActorInventory(Player1TID,"PlasmaRifle2") > 0) WeaponBits += 1024;
   if (CheckActorInventory(Player1TID,"Railgun2") > 0) WeaponBits += 2048;
   if (CheckActorInventory(Player1TID,"Repeater2") > 0) WeaponBits += 4096;
   if (CheckActorInventory(Player1TID,"KaraSawa2") > 0) WeaponBits += 8192;
   // Slot 7
   if (CheckActorInventory(Player1TID,"BFG90002") > 0) WeaponBits += 16384;
  }
  MiscellaneousVars[151] = WeaponBits;
  MiscellaneousVars[152] = CheckActorInventory(Player1TID,"Clip");
  MiscellaneousVars[153] = CheckActorInventory(Player1TID,"Shell");
  MiscellaneousVars[154] = CheckActorInventory(Player1TID,"RocketAmmo");
  MiscellaneousVars[155] = CheckActorInventory(Player1TID,"Cell");
 }
 else // If detected from a resurgence-style pistol-restart, give back any weapons previously accumlated [and anyone the Sauron Equipment they accumlated]
 {
  if (ClassCheck >= 6)
  {
   WeaponBits = MiscellaneousVars[151];
   if (CharacterClass == 2) // Flora
   {
    // Slot 1
    if (WeaponBits & 1) GiveActorInventory(Player1TID,"FistFlora",1);
    if (GetCvar("dvds_pistolrestart_florakeepsceptre") > 0)
    {
     if (WeaponBits & 2) GiveActorInventory(Player1TID,"SceptreOfEmpyrea",1);
	}
    if (GetCvar("dvds_pistolrestart_florakeepdiarisbow") > 0)
    {
     // Slot 3
     if (WeaponBits & 4) GiveActorInventory(Player1TID,"DiarisLongBow",1);
     SetActorInventory(Player1TID,"DiarisArrow",MiscellaneousVars[156]);
    }
    if (GetCvar("dvds_pistolrestart_florakeephellcore") > 0)
    {
     // Slot 4
     if (WeaponBits & 8) GiveActorInventory(Player1TID,"ImpClaw",1);
     if (WeaponBits & 16) GiveActorInventory(Player1TID,"DarkImpClaw",1);
     if (WeaponBits & 32) GiveActorInventory(Player1TID,"CacodemonEye",1);
     if (WeaponBits & 64) GiveActorInventory(Player1TID,"CacolanternEye",1);
     if (WeaponBits & 128) GiveActorInventory(Player1TID,"AbaddonEye",1);
     // Slot 5
     if (WeaponBits & 256) GiveActorInventory(Player1TID,"KnightFist",1);
     if (WeaponBits & 512) GiveActorInventory(Player1TID,"BaronFist",1);
     if (WeaponBits & 1024) GiveActorInventory(Player1TID,"BelphegorFist",1);
     if (WeaponBits & 2048) GiveActorInventory(Player1TID,"BruiserFist",1);
     if (WeaponBits & 4096) GiveActorInventory(Player1TID,"ArchonFist",1);
     if (WeaponBits & 8192) GiveActorInventory(Player1TID,"PyroFist",1);
     // Slot 6
     if (WeaponBits & 16384) GiveActorInventory(Player1TID,"IncarnateSkull",1);
     if (WeaponBits & 32768) GiveActorInventory(Player1TID,"ArchvileHand",1);
     if (WeaponBits & 65536) GiveActorInventory(Player1TID,"DiabloistHand",1);
     if (WeaponBits & 131072) GiveActorInventory(Player1TID,"BalrogFist",1);
    }
   }
   else // Marines
   {
    // Slot 1
    if (WeaponBits & 1 && CharacterClass == 0) GiveActorInventory(Player1TID,"FistDeggaris",1);
    if (WeaponBits & 1 && CharacterClass == 1) GiveActorInventory(Player1TID,"FistIllucia",1);
    if (GetCvar("dvds_pistolrestart_marineskeepweapons") > 0)
    {
     // Slot 1
     if (WeaponBits & 2) GiveActorInventory(Player1TID,"Chainsaw2",1);
     if (WeaponBits & 4) GiveActorInventory(Player1TID,"DoubleBladedChainsaw",1);
     // Slot 2
     if (WeaponBits & 8) GiveActorInventory(Player1TID,"Pistol2",1);
     if (WeaponBits & 16) GiveActorInventory(Player1TID,"DualPistols",1);
     // Slot 3
     if (WeaponBits & 32) GiveActorInventory(Player1TID,"Shotgun2",1);
     if (WeaponBits & 64) GiveActorInventory(Player1TID,"SuperShotgun2",1);
     // Slot 4
     if (WeaponBits & 128) GiveActorInventory(Player1TID,"Chaingun2",1);
     if (WeaponBits & 256) GiveActorInventory(Player1TID,"Minigun",1);
     // Slot 5
     if (WeaponBits & 512) GiveActorInventory(Player1TID,"RocketLauncher2",1);
     // Slot 6
     if (WeaponBits & 1024) GiveActorInventory(Player1TID,"PlasmaRifle2",1);
     if (WeaponBits & 2048) GiveActorInventory(Player1TID,"Railgun2",1);
     if (WeaponBits & 4096) GiveActorInventory(Player1TID,"Repeater2",1);
     if (WeaponBits & 8192) GiveActorInventory(Player1TID,"KaraSawa2",1);
     // Slot 7
     if (WeaponBits & 16384) GiveActorInventory(Player1TID,"BFG90002",1);
    }
    if (GetCvar("dvds_pistolrestart_marineskeepammo") > 0)
    {
     SetActorInventory(Player1TID,"Clip",MiscellaneousVars[152]);
     SetActorInventory(Player1TID,"Shell",MiscellaneousVars[153]);
     SetActorInventory(Player1TID,"RocketAmmo",MiscellaneousVars[154]);
     SetActorInventory(Player1TID,"Cell",MiscellaneousVars[155]);
    }
   }
  }
 }

 //***************************
 //*Armor Check [death-exits]*
 //***************************
 ArmorBits = 0;
 if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9)
 {
  if (MiscellaneousVars[149] != 1) // If the check is not on, acculmate the ArmorBits as per the norm.
  {
   MiscellaneousVars[150] = ArmorBits;
   if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) MiscellaneousVars[150] += 4096;
   if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) MiscellaneousVars[150] += 8192;
   if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) MiscellaneousVars[150] += 16384;
   if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) MiscellaneousVars[150] += 32768;
   if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) MiscellaneousVars[150] += 65536;
   if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) MiscellaneousVars[150] += 131072;
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) MiscellaneousVars[150] += 262144;
  }
  else
  {
   if (GetCvar("dvds_pistolrestart_allkeepsauronequip") > 0)
   {
    if (MiscellaneousVars[150] & 4096) { GiveActorInventory(Player1TID, "SauronHelmet", 1); }
    if (MiscellaneousVars[150] & 8192) { GiveActorInventory(Player1TID, "SauronGauntlets", 1); }
    if (MiscellaneousVars[150] & 16384) { GiveActorInventory(Player1TID, "SauronGauntletsIllucia", 1); }
    if (MiscellaneousVars[150] & 32768) { GiveActorInventory(Player1TID, "SauronGauntletsFlora", 1); }
    if (MiscellaneousVars[150] & 65536) { GiveActorInventory(Player1TID, "SauronGauntletsAilish", 1); }
    if (MiscellaneousVars[150] & 131072) { GiveActorInventory(Player1TID, "SauronGauntletsPetra", 1); }
    if (MiscellaneousVars[150] & 262144) { GiveActorInventory(Player1TID, "TheOneRing", 1); }
   }
  }
 }



  //*********************************
  //*Stamina/Accuracy Upgrade Checks*
  //*********************************
  // MiscellaneousVars[300] Bitcheck Reset Timer
  // MiscellaneousVars[317] = current tic [Stamina Upgrades]
  // MiscellaneousVars[319] = previous tic [Stamina Upgrades]
  int StaminaBitField = 0;
  int AccuracyBitField = 0;
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && ClassicDoomType == 4 && ModType == 0) // Must also be in Strife mode
  {
   str StaminaUpgradeItem;
   if (MiscellaneousVars[317] != MiscellaneousVars[319]) // [9801] is for checking LifeUp BitFields
   {
    for (i = 0; i < 11; i++)
    {
     StaminaUpgradeItem = StrParam(s:"StaminaUpgrade", d:i);

     if (MiscellaneousVars[317] == i)
     GiveActorInventory(Player1TID, StaminaUpgradeItem, 1);
      else
     TakeActorInventory(Player1TID, StaminaUpgradeItem, 1);	 
	}
    MiscellaneousVars[319] = MiscellaneousVars[317];
   }

   // MiscellaneousVars[318] = current tic [Accuracy Upgrades]
   // MiscellaneousVars[320] = previous tic [Accuracy Upgrades]
   str AccuracyUpgradeItem;
   if (MiscellaneousVars[318] != MiscellaneousVars[320]) // [9801] is for checking LifeUp BitFields
   {
    for (i = 0; i < 11; i++)
    {
     AccuracyUpgradeItem = StrParam(s:"AccuracyUpgrade", d:i);
	 
     if (MiscellaneousVars[318] == i)
     GiveActorInventory(Player1TID, AccuracyUpgradeItem, 1);
      else
     TakeActorInventory(Player1TID, AccuracyUpgradeItem, 1);	 
	}
    MiscellaneousVars[320] = MiscellaneousVars[318];
   }
  }
  MiscellaneousVars[300]++;
  if (MiscellaneousVars[300] == 4)
  {  
   MiscellaneousVars[319] = 0; // Reset Stamina Checker
   MiscellaneousVars[320] = 0; // Reset Accuracy Checker
  }
  if (MiscellaneousVars[300] >= 70) MiscellaneousVars[300] = 0; // Reset Checker Timer


  //**********************
  //*Perk BitField Checks*
  //**********************
  int PerkBitfield = 0;
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   PerkBitfield = 0;
   if (MiscellaneousVars[10001] >= 1) PerkBitfield += 1;
   if (MiscellaneousVars[10001] >= 2) PerkBitfield += 2;
   if (MiscellaneousVars[10001] >= 3) PerkBitfield += 4;
   if (MiscellaneousVars[10001] >= 4) PerkBitfield += 8;
   if (MiscellaneousVars[10001] >= 5) PerkBitfield += 16;
   if (MiscellaneousVars[10002] >= 1) PerkBitfield += 32;
   if (MiscellaneousVars[10002] >= 2) PerkBitfield += 64;

   //PrintBold(s:"",d:PerkBitfield,s:" [",d:MiscellaneousVars[9801],s:"]");

   str LifeUpPerkItem;
   if (PerkBitfield != MiscellaneousVars[9801]) // [9801] is for checking LifeUp BitFields
   {
    for (i = 0; i < 128; i++)
    {
     LifeUpPerkItem = StrParam(s:"LifeUpDEFBits", d:i);
 
     if (PerkBitfield == i)
     GiveActorInventory(Player1TID, LifeUpPerkItem, 1);
      else
     TakeActorInventory(Player1TID, LifeUpPerkItem, 1);
    }
    MiscellaneousVars[9801] = PerkBitfield;
   }
  }
  else
  {
   MiscellaneousVars[9801] = 0; // Resets to 0 on Death [because of Resurge.wad style pistol-resets :P]
  }
 
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   PerkBitfield = 0;
   if (MiscellaneousVars[10003] >= 1) PerkBitfield += 1;
   if (MiscellaneousVars[10003] >= 2) PerkBitfield += 2;
   if (MiscellaneousVars[10003] >= 3) PerkBitfield += 4;
   if (MiscellaneousVars[10003] >= 4) PerkBitfield += 8;
   if (MiscellaneousVars[10003] >= 5) PerkBitfield += 16;
   if (MiscellaneousVars[10004] >= 1) PerkBitfield += 32;
   if (MiscellaneousVars[10004] >= 2) PerkBitfield += 64;

   //PrintBold(s:"",d:PerkBitfield,s:" [",d:MiscellaneousVars[9802],s:"]");

   str MagiUpPerkItem;
   if (PerkBitfield != MiscellaneousVars[9802]) // [9802] is for checking MagiUp BitFields
   {
    for (i = 0; i < 128; i++)
    {
     MagiUpPerkItem = StrParam(s:"MagiUpATKBits", d:i);
 
     if (PerkBitfield == i)
     GiveActorInventory(Player1TID, MagiUpPerkItem, 1);
      else
     TakeActorInventory(Player1TID, MagiUpPerkItem, 1);
    }
    MiscellaneousVars[9802] = PerkBitfield;
   }
  }
  else
  {
   MiscellaneousVars[9802] = 0; // Resets to 0 on Death [because of Resurge.wad style pistol-resets :P]
  }

/*
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   PerkBitfield = 0;
   if (MiscellaneousVars[10005] >= 1) PerkBitfield += 1;
   if (MiscellaneousVars[10005] >= 2) PerkBitfield += 2;
   if (MiscellaneousVars[10005] >= 3) PerkBitfield += 4;
   if (MiscellaneousVars[10005] >= 4) PerkBitfield += 8;
   if (MiscellaneousVars[10005] >= 5) PerkBitfield += 16;
   if (MiscellaneousVars[10006] >= 1) PerkBitfield += 32;
   if (MiscellaneousVars[10006] >= 2) PerkBitfield += 64;

   //PrintBold(s:"",d:PerkBitfield,s:" [",d:MiscellaneousVars[9803],s:"]");

   str StamUpPerkItem;
   if (PerkBitfield != MiscellaneousVars[9803]) // [9803] is for checking StamUp BitFields
   {
    for (i = 0; i < 128; i++)
    {
     StamUpPerkItem = StrParam(s:"StamUpATKBits", d:i);
 
     if (PerkBitfield == i)
     GiveActorInventory(Player1TID, StamUpPerkItem, 1);
      else
     TakeActorInventory(Player1TID, StamUpPerkItem, 1);
    }
    MiscellaneousVars[9803] = PerkBitfield;
   }
  }
  else
  {
   MiscellaneousVars[9803] = 0; // Resets to 0 on Death [because of Resurge.wad style pistol-resets :P]
  }
 */


 //***************************************************************************
 //***************************************************************************
 //************* Armor Stuff for DVII-DS's armor items :P ********************
 //** Note: ONLY FLORA [(CharacterClass == 2)] CAN USE THESE ITEMS LEGALLY. **
 //***************************************************************************
 //***************************************************************************
 ArmorBits = 0;
 FloraArmorClass = 0;
 if (CharacterClass == 2)
 {
  // These 11 items are all part of a bitfield
  // "FloraArmorClass" is mainly for a display purpose on the HUD than it having an actual affect on the damage taken.
  // The "PermenantArmorBits[#]" items in the section below are the actual mechanic that gives her resistances to damage].
  if (MiscellaneousVars[149] != 1) // If the check is not on, acculmate the ArmorBits as per the norm.
  {
   if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) { ArmorBits += 1; FloraArmorClass += 3; } // Item 1
   if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) { ArmorBits += 2; FloraArmorClass += 7; } // Item 2
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) { ArmorBits += 4; FloraArmorClass += 8; } // Item 3
   if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { ArmorBits += 8; FloraArmorClass += 2; } // Item 4
   if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) { ArmorBits += 16; FloraArmorClass += 4; } // Item 5
   if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { ArmorBits += 32; FloraArmorClass += 5; } // Item 6
   if (CheckActorInventory(Player1TID,"KissaBra") > 0) { ArmorBits += 64; FloraArmorClass += 6; } // Item 7
   if (CheckActorInventory(Player1TID,"DivineShield") > 0) { ArmorBits += 128; FloraArmorClass += 16; } // Item 8
   if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { ArmorBits += 256; FloraArmorClass += 2; } // Item 9
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) { ArmorBits += 512; FloraArmorClass += 9; } // Item 10
   if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) { ArmorBits += 1024; FloraArmorClass += 5; } // Item 11
   MiscellaneousVars[150] = ArmorBits;
   if (CheckActorInventory(Player1TID,"RuinousShield") > 0) MiscellaneousVars[150] += 2048;
   if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) MiscellaneousVars[150] += 4096;
   if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) MiscellaneousVars[150] += 8192;
   if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) MiscellaneousVars[150] += 16384;
   if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) MiscellaneousVars[150] += 32768;
   if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) MiscellaneousVars[150] += 65536;
   if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) MiscellaneousVars[150] += 131072;
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) MiscellaneousVars[150] += 262144;
  }
  else // If detected from a resurgence-style pistol-restart, give Flora back any armor she previously accumlated [and anyone the Sauron Equipment they accumlated]
  {
   //PrintBold(d:ArmorBits);
   ArmorBits = MiscellaneousVars[150];
   if (GetCvar("dvds_pistolrestart_florakeeparmor") > 0)
   {
    if (ArmorBits & 1) { GiveActorInventory(Player1TID, "SafeTeaShoes", 1); FloraArmorClass += 3; }
    if (ArmorBits & 2) { GiveActorInventory(Player1TID, "PearlyCorset", 1); FloraArmorClass += 7; }
    if (ArmorBits & 4) { GiveActorInventory(Player1TID, "WaterFlyingDress", 1); FloraArmorClass += 8; }
    if (ArmorBits & 8) { GiveActorInventory(Player1TID, "EvenstarNecklace", 1); FloraArmorClass += 2; }
    if (ArmorBits & 16) { GiveActorInventory(Player1TID, "CloakofEvasion", 1); FloraArmorClass += 4; }
    if (ArmorBits & 32) { GiveActorInventory(Player1TID, "AnubisCufflinks", 1); FloraArmorClass += 5; }
    if (ArmorBits & 64) { GiveActorInventory(Player1TID, "KissaBra", 1); FloraArmorClass += 6; }
    if (ArmorBits & 128) { GiveActorInventory(Player1TID, "DivineShield", 1); FloraArmorClass += 16; }
    if (ArmorBits & 256) { GiveActorInventory(Player1TID, "BalrogRing", 1); FloraArmorClass += 2; }
    if (ArmorBits & 512) { GiveActorInventory(Player1TID, "DoveRibbon", 1); FloraArmorClass += 9; }
    if (ArmorBits & 1024) { GiveActorInventory(Player1TID, "FalconKnifeEarrings", 1); FloraArmorClass += 5; }
    if (MiscellaneousVars[150] & 2048) { GiveActorInventory(Player1TID, "RuinousShield", 1); }
   }
   if (GetCvar("dvds_pistolrestart_allkeepsauronequip") > 0)
   {
    if (MiscellaneousVars[150] & 4096) { GiveActorInventory(Player1TID, "SauronHelmet", 1); }
    if (MiscellaneousVars[150] & 8192) { GiveActorInventory(Player1TID, "SauronGauntlets", 1); }
    if (MiscellaneousVars[150] & 16384) { GiveActorInventory(Player1TID, "SauronGauntletsIllucia", 1); }
    if (MiscellaneousVars[150] & 32768) { GiveActorInventory(Player1TID, "SauronGauntletsFlora", 1); }
    if (MiscellaneousVars[150] & 65536) { GiveActorInventory(Player1TID, "SauronGauntletsAilish", 1); }
    if (MiscellaneousVars[150] & 131072) { GiveActorInventory(Player1TID, "SauronGauntletsPetra", 1); }
    if (MiscellaneousVars[150] & 262144) { GiveActorInventory(Player1TID, "TheOneRing", 1); }
   }
  }

  // Ruinous Shield is Cursed, so it acts seperately. (do note the Cursed Shield gives penalties which are only called bonuses in a techincal sense)
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) 
  { 
   GiveActorInventory(Player1TID,"CursedShieldBonusATK", 1); 
   GiveActorInventory(Player1TID,"CursedShieldBonusATKHLCR", 1); 
   GiveActorInventory(Player1TID,"CursedShieldBonusDEF", 1); 
   FloraArmorClass = FloraArmorClass * 100 / 256; 
  }
  else
  {
   TakeActorInventory(Player1TID,"CursedShieldBonusATK", 1); 
   TakeActorInventory(Player1TID,"CursedShieldBonusATKHLCR", 1); 
   TakeActorInventory(Player1TID,"CursedShieldBonusDEF", 1); 
  }

  str ArmorBitsItem;
/*
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   // REVISED: Changed If statements info a for block for the Armor Bitfield (7/3/12)
   if (ArmorBits != MiscellaneousVars[1]) // [1] is for checking Flora's Armor Bitfield so it doesn't have to run EVERY tic and lag the game too badly.
   {
    for (i = 0; i < 2048; i++)
    {
     ArmorBitsItem = StrParam(s:"PermenantArmorBits", d:i);
 
     if (ArmorBits == i)
     GiveActorInventory(Player1TID, ArmorBitsItem, 1);
      else
     TakeActorInventory(Player1TID, ArmorBitsItem, 1);
    }
    MiscellaneousVars[1] = ArmorBits;
   }
  }
  else
  {
   MiscellaneousVars[1] = 0; // Resets to 0 on Death [because of Resurge.wad style pistol-resets :P]
  }
*/

  // Safe Tea Boots [25% chance of damagefloor/ironfeet guard during normal incursion of damage]
  // Cloak of Evasion [12.5% chance of damagefloor/ironfeet guard during normal incursion of damage]
  IronFeetChance = 0;
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) IronFeetChance += 250;
  if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0) IronFeetChance += 125;
  if (IronFeetChance > 1000) IronFeetChance = 1000;
  if (CheckActorInventory(Player1TID,"FloraArmorFloorGuard") > 0) TakeActorInventory(Player1TID,"FloraArmorFloorGuard", 1);   
  if (random(1,1000) <= IronFeetChance && CheckActorInventory(Player1TID,"FloraArmorFloorGuard") < 1) GiveActorInventory(Player1TID,"FloraArmorFloorGuard", 1);

  FearChance = 200;
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0) FearChance = FearChance * 5 / 3;
  // Anubis Cufflinks [20% (33.3% with One Ring) chance of brief fear-effect on all hostile creatures with attacks]
  if (CheckActorInventory(Player1TID,"AnubisCufflinksFear") > 0) TakeActorInventory(Player1TID,"AnubisCufflinksFear", 1);   
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0 && random(1,1000) <= FearChance && CheckActorInventory(Player1TID,"AnubisCufflinksFear") < 1) GiveActorInventory(Player1TID,"AnubisCufflinksFear", 1);

  // Damage Boosts from Flora-Specfic Armors
  Armor2Bits = 0;
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) Armor2Bits += 1;
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) Armor2Bits += 2;

  if (Armor2Bits == 1) GiveActorInventory(Player1TID,"EvenstarNecklaceBoost", 1); else TakeActorInventory(Player1TID,"EvenstarNecklaceBoost", 1);
  if (Armor2Bits == 2) GiveActorInventory(Player1TID,"DoveRibbonDamage", 1); else TakeActorInventory(Player1TID,"DoveRibbonDamage", 1);
  if (Armor2Bits == 3) GiveActorInventory(Player1TID,"EvenstarDoveDamage", 1); else TakeActorInventory(Player1TID,"EvenstarDoveDamage", 1);

  // Falcon Knife Earrings [+50% extra damage overall]
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0)
  {
   if (CheckActorInventory(Player1TID,"FalconKnifeDamage") < 1) GiveActorInventory(Player1TID,"FalconKnifeDamage", 1);
  }
  else
  {
   if (CheckActorInventory(Player1TID,"FalconKnifeDamage") > 0) TakeActorInventory(Player1TID,"FalconKnifeDamage", 1);   
  }

  int DivineShieldBlock, DivineShieldBits;
  // Gets the Divine Shield's blocking ability and occurance rate
  if (CheckActorInventory(Player1TID,"DivineShield") > 0)
  {
   DivineShieldBlock = 13;
   DivineShieldBits = 1;
   if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"KissaBra") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }
   if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) { DivineShieldBlock += 2; DivineShieldBits += 1; }

   if (random(1,100) <= DivineShieldBlock)
   {
    for (i = 1; i < 12; i++)
    {
     ArmorBitsItem = StrParam(s:"ShieldBlockBonusLevel", d:i);

     if (DivineShieldBits == i)
      GiveActorInventory(Player1TID, ArmorBitsItem, 1);
       else
      TakeActorInventory(Player1TID, ArmorBitsItem, 1);
    }
   }
   else
   {
    for (i = 1; i < 12; i++)
    {
     ArmorBitsItem = StrParam(s:"ShieldBlockBonusLevel", d:i);
     TakeActorInventory(Player1TID, ArmorBitsItem, 1);
    }
   }
  }
 }
 else // If the items are detected on Deggaris or Illucia, take them away since they have no function on those two. :P
 {
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) TakeActorInventory(Player1TID,"SafeTeaShoes", 1);
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) TakeActorInventory(Player1TID,"PearlyCorset", 1);
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) TakeActorInventory(Player1TID,"WaterFlyingDress", 1);
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) TakeActorInventory(Player1TID,"EvenstarNecklace", 1);
  if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) TakeActorInventory(Player1TID,"CloakofEvasion", 1);
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) TakeActorInventory(Player1TID,"AnubisCufflinks", 1);
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) TakeActorInventory(Player1TID,"KissaBra", 1);
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) TakeActorInventory(Player1TID,"DivineShield", 1);
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) TakeActorInventory(Player1TID,"BalrogRing", 1);
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) TakeActorInventory(Player1TID,"DoveRibbon", 1);
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) TakeActorInventory(Player1TID,"FalconKnifeEarrings", 1);
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) TakeActorInventory(Player1TID,"RuinousShield", 1);
  if (CheckActorInventory(Player1TID,"FloraArmorFloorGuard") > 0) TakeActorInventory(Player1TID,"FloraArmorFloorGuard", 1);   
  if (CheckActorInventory(Player1TID,"AnubisCufflinksFear") > 0) TakeActorInventory(Player1TID,"AnubisCufflinksFear", 1);   
  if (CheckActorInventory(Player1TID,"EvenstarNecklaceBoost") > 0) TakeActorInventory(Player1TID,"EvenstarNecklaceBoost", 1);
  if (CheckActorInventory(Player1TID,"DoveRibbonSpeed") > 0) TakeActorInventory(Player1TID,"DoveRibbonSpeed", 1);
  if (CheckActorInventory(Player1TID,"EvenstarDoveDamage") > 0) TakeActorInventory(Player1TID,"EvenstarDoveDamage", 1);
  if (CheckActorInventory(Player1TID,"CloakofEvasionBoost") > 0) TakeActorInventory(Player1TID,"CloakofEvasionBoost", 1);
  if (CheckActorInventory(Player1TID,"DoveRibbonSpeed") > 0) TakeActorInventory(Player1TID,"DoveRibbonSpeed", 1);
  if (CheckActorInventory(Player1TID,"EvasionDoveSpeed") > 0) TakeActorInventory(Player1TID,"EvasionDoveSpeed", 1);
  if (CheckActorInventory(Player1TID,"FalconKnifeDamage") > 0) TakeActorInventory(Player1TID,"FalconKnifeDamage", 1);   
  for (i = 1; i < 12; i++)
  {
   ArmorBitsItem = StrParam(s:"ShieldBlockBonusLevel", d:i);
   if (CheckActorInventory(Player1TID, ArmorBitsItem) > 0) TakeActorInventory(Player1TID, ArmorBitsItem, 1);
  }
 }


 int AglEvadeCheck;
 int DftEvadeCheck;
 // Evasion Rate (it actually sets the character's damagefactor to 0.0% to null all damage and makes them all but invulnerable to simulate the effect)
 // [23] is a character's 'Evasion' chance [out of 100.00%]

 // Set's The Base increase from each point of Agility
 if (CharacterClass == 0) { AglEvadeCheck = 9; DftEvadeCheck = 0; } // Deggaris
 if (CharacterClass == 1) { AglEvadeCheck = 10; DftEvadeCheck = 0; } // Illucia
 if (CharacterClass == 2) { AglEvadeCheck = 11; DftEvadeCheck = 0; } // Flora
 if (CharacterClass == 8) { AglEvadeCheck = 8; DftEvadeCheck = 0; } // Ailish
 if (CharacterClass == 9) { AglEvadeCheck = 22; DftEvadeCheck = 0; } // Petra (Has double of Flora's)

 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) { AglEvadeCheck += 1; DftEvadeCheck += 1; }
 if (CharacterClass == 0 && CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { AglEvadeCheck += 2; DftEvadeCheck += 2; }
 if (CharacterClass == 1 && CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { AglEvadeCheck += 2; DftEvadeCheck += 2; }
 if (CharacterClass == 2 && CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { AglEvadeCheck += 2; DftEvadeCheck += 2; }
 if (CharacterClass == 8 && CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { AglEvadeCheck += 2; DftEvadeCheck += 2; }
 if (CharacterClass == 9 && CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { AglEvadeCheck += 2; DftEvadeCheck += 2; }
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) { AglEvadeCheck += 6; DftEvadeCheck += 6; }

 MiscellaneousVars[23] = MiscellaneousVars[31] * AglEvadeCheck;
 MiscellaneousVars[23] += MiscellaneousVars[33] * DftEvadeCheck;
 MiscellaneousVars[23] /= 2;
 if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [Base]");

 if (PowerupTimer[7] > 0) 
 {
  MiscellaneousVars[23] = MiscellaneousVars[23] * 7 / 4;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [DivineAvatarCheck]");
 }

 // DodgeMore perks
 if (MiscellaneousVars[10007] > 0 || MiscellaneousVars[10008] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10007] * 250) + (MiscellaneousVars[10008] * 625));
  MiscellaneousVars[23] += PerkFactor; // "DodgeMore" and "DodgeMore EX" perks.
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [DodgeMoreCheck]");
 }

 // [STRIFE-Compatibility] Stamina Upgrades
 if (MiscellaneousVars[317] > 0)
 {
  PerkFactor = (MiscellaneousVars[317] * 111);
  MiscellaneousVars[23] += PerkFactor; // [STRIFE-Compatibility] Stamina Upgrades
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [STRIFEStamCheck]");
 }

 // Checks Evasion Based on Level
 int LevelCheck;
 LevelCheck = PlayerLevel * 5;
 if (PowerupTimer[7] > 0) LevelCheck = LevelCheck * 7 / 5;
 if (LevelCheck > 0)
 {
  MiscellaneousVars[23] += LevelCheck;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [LevelCheck]");
 }

 if (CharacterClass == 2)
 {
  // Flora has Safe Tea Shoes? [+3.75% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) MiscellaneousVars[23] += 375;

  // Flora has Pearly Corset? [+0.75% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) MiscellaneousVars[23] += 75;

  // Flora has Water Flying Dress? [+1.25% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) MiscellaneousVars[23] += 125;

  // Flora has Evenstar Necklace? [+2.5% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) MiscellaneousVars[23] += 250;

  // Flora has Cloak of Evasion? [+12.50% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0) MiscellaneousVars[23] += 1250;

  // Flora has Falcon Knife Earrings? [+1.25% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) MiscellaneousVars[23] += 125;

  // Flora has Anubis Cufflinks? [+0.5% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) MiscellaneousVars[23] += 50;

  // Flora has Kissa's Brasseire? [+1% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) MiscellaneousVars[23] += 100;

  // Flora has Balrog Ring? [+0.5% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) MiscellaneousVars[23] += 50;

  // Flora has Dove Ribbon? [+1.75% Chance to totally "Evade" damage even from a direct hit.]
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) MiscellaneousVars[23] += 175;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [FloraArmorCheck]");
 }

 // Someone has Sauron's Helmet [-1.56% Chance]
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) MiscellaneousVars[23] -= 156;

 // Someone has The One Ring [+6.25% Chance]
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) MiscellaneousVars[23] += 625;

 if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [SauronArmorCheck]");

 // Haste Buff [150% Evade]
 if (CheckActorInventory(Player1TID,"HasteBuff") > 0)
 {
  MiscellaneousVars[23] = MiscellaneousVars[23] * 3 / 2;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [HasteCheck]");
 }

 // Slow Ailment [66.7% Evade]
 if (CheckActorInventory(Player1TID,"SlowAilment") > 0)
 {
  MiscellaneousVars[23] = MiscellaneousVars[23] * 2 / 3;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [SlowCheck]");
 }

 if (CharacterClass == 2)
 {
  // Ruinous Shield [Evade reduced by 5/8ths]
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
  {
   MiscellaneousVars[23] = MiscellaneousVars[23] * 3 / 8;
   if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [CursedShieldCheck]");
  }

  // Divine Shield [Evade Increased by 1/4ths]
  if (CheckActorInventory(Player1TID,"DivineShield") > 0)
  {
   MiscellaneousVars[23] = MiscellaneousVars[23] * 5 / 4;
   if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [DivineShieldCheck]");
  }
 }

 int VelX = GetActorVelX(Player1TID);
 int VelY = GetActorVelY(Player1TID);
 int VelZ = GetActorVelZ(Player1TID);
 int IsMoving = 0;
 if (VelX < -250000) IsMoving++;
 if (VelX > 250000) IsMoving++;
 if (VelY < -250000) IsMoving++;
 if (VelY > 250000) IsMoving++;
 if (VelZ < -125000) IsMoving++;
 if (VelZ > 125000) IsMoving++; 
 int OnTheMoveAdd = 0;
 if (MiscellaneousVars[10045] > 0 && IsMoving > 0) // "On The Move" Perk
 {
  if (MiscellaneousVars[10045] == 1)
  {
   OnTheMoveAdd = 250 + ((MiscellaneousVars[31] * 100) / 40);
  }
  if (MiscellaneousVars[10045] == 2)
  {
   OnTheMoveAdd = 400 + ((MiscellaneousVars[31] * 100) / 32);
  }
  if (MiscellaneousVars[10045] == 3)
  {
   OnTheMoveAdd = 550 + ((MiscellaneousVars[31] * 100) / 24);
  }
  if (MiscellaneousVars[10045] == 4)
  {
   OnTheMoveAdd = 700 + ((MiscellaneousVars[31] * 100) / 16);
  }
  if (MiscellaneousVars[10045] >= 5)
  {
   OnTheMoveAdd = 850 + ((MiscellaneousVars[31] * 100) / 8);
  }

  MiscellaneousVars[23] += OnTheMoveAdd;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"On The Move: +",d:OnTheMoveAdd,s:"\n",
                                                         s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [OnTheMove]");
 }
 
 // Caps Evasion Chances out at 75% [unless you have the Dove's Ribbon, which it caps at 92.5%]
 int EvasionMin;
 int EvasionMax;
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
 {
  EvasionMin = 175;
  EvasionMax = 9250;
  EvasionMin += MiscellaneousVars[10007] * 25;
  EvasionMin += MiscellaneousVars[10008] * 63;
  EvasionMin += MiscellaneousVars[10045] * 16;
  EvasionMin += MiscellaneousVars[10046] * 42;
  EvasionMax += MiscellaneousVars[10007] * 50;
  EvasionMax += MiscellaneousVars[10008] * 125;
  EvasionMax += MiscellaneousVars[10045] * 33;
  EvasionMax += MiscellaneousVars[10046] * 84;
 }
 else
 {
  EvasionMin = 0;
  EvasionMax = 7500;
  EvasionMin += MiscellaneousVars[10007] * 20;
  EvasionMin += MiscellaneousVars[10008] * 50;
  EvasionMin += MiscellaneousVars[10045] * 13;
  EvasionMin += MiscellaneousVars[10046] * 33;
  EvasionMax += MiscellaneousVars[10007] * 30;
  EvasionMax += MiscellaneousVars[10008] * 75;
  EvasionMax += MiscellaneousVars[10045] * 20;
  EvasionMax += MiscellaneousVars[10046] * 50;
 }
 if (MiscellaneousVars[23] < EvasionMin) MiscellaneousVars[23] = EvasionMin;
 if (MiscellaneousVars[23] > EvasionMax) MiscellaneousVars[23] = EvasionMax;
 if (GetCVar("dvdsdebug_showevadestuff") > 0) PrintBold(s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [DoveRibbonCheck]");

 int WeapEvadeAdd;
 BasePerkFactor = 0;
 PerkFactor = 0;
 // Check for Equipped Weapon
 If (StrIcmp(weapon, "BFG90002") == 0) BasePerkFactor = -625;
 If (StrIcmp(weapon, "RocketLauncher2") == 0) BasePerkFactor = -313;
 If (StrIcmp(weapon, "Railgun2") == 0) BasePerkFactor = -156;
 If (StrIcmp(weapon, "Karasawa2") == 0) BasePerkFactor = -156;
 If (StrIcmp(weapon, "Repeater2") == 0) BasePerkFactor = -156;
 If (StrIcmp(weapon, "PlasmaRifle2") == 0) BasePerkFactor = -156;
 If (StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
 {
  BasePerkFactor = -156;
 }
 If (StrIcmp(weapon, "Chainsaw2") == 0 || StrIcmp(weapon, "DoubleBladedChainsaw") == 0) BasePerkFactor = -78;
 If (StrIcmp(weapon, "Minigun") == 0) BasePerkFactor = -78;
 If (StrIcmp(weapon, "EvilWarriorShield") == 0) BasePerkFactor = -63;
 If (StrIcmp(weapon, "Chaingun2") == 0) BasePerkFactor = -39;
 If (StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistAilish") == 0 || StrIcmp(weapon, "FistPetra") == 0 || StrIcmp(weapon, "FistFlora") == 0)
 {
  BasePerkFactor = 625;
 }
 If (StrIcmp(weapon, "SceptreOfEmpyrea") == 0) BasePerkFactor = 1250;

 If (StrIcmp(weapon, "Shotgun2") == 0) BasePerkFactor = 63;
 If (StrIcmp(weapon, "Pistol2") == 0) BasePerkFactor = 125;
 If (StrIcmp(weapon, "DualPistols") == 0) BasePerkFactor = (125 * 3) / 2;

 // Hellcore Weapons
 int EvadeCurrHellcoreLevel = 0;
 If (StrIcmp(weapon, "ImpClaw") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[96]; }
 If (StrIcmp(weapon, "DarkImpClaw") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[97]; }
 If (StrIcmp(weapon, "CacodemonEye") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[98]; }
 If (StrIcmp(weapon, "CacolanternEye") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[99]; }
 If (StrIcmp(weapon, "AbaddonEye") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[100]; }
 If (StrIcmp(weapon, "KnightFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[101]; }
 If (StrIcmp(weapon, "BaronFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[102]; }
 If (StrIcmp(weapon, "BelphegorFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[103]; }
 If (StrIcmp(weapon, "BruiserFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[104]; }
 If (StrIcmp(weapon, "ArchonFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[105]; }
 If (StrIcmp(weapon, "PyroFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[106]; }
 If (StrIcmp(weapon, "IncarnateSkull") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[107]; }
 If (StrIcmp(weapon, "ArchvileHand") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[108]; }
 If (StrIcmp(weapon, "DiabloistHand") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[109]; }
 If (StrIcmp(weapon, "BalrogFist") == 0) { EvadeCurrHellcoreLevel = MiscellaneousVars[110]; }
 if (EvadeCurrHellcoreLevel > 0) BasePerkFactor = (1250 * EvadeCurrHellcoreLevel) / 8;

 If (StrIcmp(weapon, "SapphireWandNew") == 0) BasePerkFactor = 125;
 If (StrIcmp(weapon, "DualSapphireWandsNew") == 0) BasePerkFactor = (125 * 3) / 2;
 If (StrIcmp(weapon, "GoldWandNew") == 0) BasePerkFactor = 187;
 If (StrIcmp(weapon, "DualGoldWandNew") == 0) BasePerkFactor = (187 * 3) / 2;
 If (StrIcmp(weapon, "CrossbowNew") == 0) BasePerkFactor = 325;
 If (StrIcmp(weapon, "DualCrossbowNew") == 0) BasePerkFactor = (325 * 3) / 2;
 If (StrIcmp(weapon, "SuperCrossbowNew") == 0) BasePerkFactor = 468;
 If (StrIcmp(weapon, "DualSuperCrossbowNew") == 0) BasePerkFactor = (468 * 3) / 2;
 If (StrIcmp(weapon, "DragonClawNew") == 0) BasePerkFactor = 250;
 If (StrIcmp(weapon, "DualDragonClawNew") == 0) BasePerkFactor = (250 * 3) / 2;
 If (StrIcmp(weapon, "HellStaffNew") == 0) BasePerkFactor = 250;
 If (StrIcmp(weapon, "DualHellStaffNew") == 0) BasePerkFactor = (250 * 3) / 2;
 If (StrIcmp(weapon, "PhoenixRodNew") == 0) BasePerkFactor = 187;
 If (StrIcmp(weapon, "DualPhoenixRodNew") == 0) BasePerkFactor = (187 * 3) / 2;
 If (StrIcmp(weapon, "FiremaceNew") == 0) BasePerkFactor = 125;
 If (StrIcmp(weapon, "DualFiremaceNew") == 0) BasePerkFactor = (125 * 3) / 2;
 If (StrIcmp(weapon, "StrifeCrossbowNew") == 0) BasePerkFactor = 325;
 If (StrIcmp(weapon, "StrifeCrossbow2New") == 0) BasePerkFactor = (325 * 3) / 2;

 
 
 if (BasePerkFactor != 0)
 {
  PerkFactor = BasePerkFactor;
  PerkFactor += ((MiscellaneousVars[10007] * (BasePerkFactor / 20)) + (MiscellaneousVars[10008] * (BasePerkFactor / 8)));
  WeapEvadeAdd = (10000 - MiscellaneousVars[23]) * PerkFactor / 10000;
  MiscellaneousVars[23] += WeapEvadeAdd;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) 
  {
   PrintBold(s:"PerkFactor: ",d:PerkFactor,s:"\n",
             s:"WeapEvadeAdd %: ",d:WeapEvadeAdd,s:"\n",
             s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [WeapCheck]");
  }
 }

 
 int AccelEvadeAdd;
 // Acceleratle = +1/5 of remaining % Evasion added (done after caps are normally calculated)
 if (PowerupTimer[12] > 0)
 {
  PerkFactor = 2000;
  PerkFactor += ((MiscellaneousVars[10007] * 100) + (MiscellaneousVars[10008] * 250));
  AccelEvadeAdd = (10000 - MiscellaneousVars[23]) * PerkFactor / 10000;
  MiscellaneousVars[23] += AccelEvadeAdd;
  if (GetCVar("dvdsdebug_showevadestuff") > 0)
  {
   PrintBold(s:"PerkFactor: ",d:PerkFactor,s:"\n",
             s:"AccelEvadeAdd %: ",d:AccelEvadeAdd,s:"\n",
             s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [AccelCheck]");
  }
 }

 // Deceleratle = -1/5 of remaining % Current Evasion removed (done after caps are normally calculated)
 if (PowerupTimer[15] > 0)
 {
  PerkFactor = 2000;
  PerkFactor -= ((MiscellaneousVars[10007] * 100) + (MiscellaneousVars[10008] * 250));
  AccelEvadeAdd = MiscellaneousVars[23] * PerkFactor / 10000;
  MiscellaneousVars[23] -= AccelEvadeAdd;
  if (GetCVar("dvdsdebug_showevadestuff") > 0)
  {
   PrintBold(s:"PerkFactor: ",d:PerkFactor,s:"\n",
             s:"AccelEvadeAdd %: ",d:AccelEvadeAdd,s:"\n",
             s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [DecelCheck]");
  }
 }

 int InvisEvadeAdd;
 // BlurSphere = +1/3 of remaining % Evasion added (done after caps are normally calculated) [in other words, make the Blur Sphere & Invisibility Spells actually USEFUL >__>;]
 if (CheckActorInventory(Player1TID,"PowerInvisibility") > 0 | CheckActorInventory(Player1TID,"InvisiblitySpell") > 0)
 {
  PerkFactor = 3334;
  PerkFactor += ((MiscellaneousVars[10007] * 125) + (MiscellaneousVars[10008] * 313));
  InvisEvadeAdd = (10000 - MiscellaneousVars[23]) * PerkFactor / 10000;
  MiscellaneousVars[23] += InvisEvadeAdd;
  if (GetCVar("dvdsdebug_showevadestuff") > 0) 
  {
   PrintBold(s:"PerkFactor: ",d:PerkFactor,s:"\n",
             s:"InvisEvadeAdd %: ",d:InvisEvadeAdd,s:"\n",
             s:"Evasion Rate %: ",d:MiscellaneousVars[23],s:" [InvisCheck]");
  }
 }

 if (MiscellaneousVars[23] < 0) MiscellaneousVars[23] = 0;
 if (MiscellaneousVars[23] > 9875) MiscellaneousVars[23] = 9875;
 
 
 // For the Status Bar (Only shows an int value, not a floating point amount)
 EvadeWhole = MiscellaneousVars[23] / 100;

 // Run Final RNG Check on Evasion
 BuddhaRNGVal = random(1,10000);
 if (BuddhaRNGVal <= MiscellaneousVars[23])
 {
  if (CheckActorInventory(Player1TID,"EvadeAnAttack") < 1) GiveActorInventory(Player1TID,"EvadeAnAttack", 1); // "Dodge/Null" the damage.
 }
 else
 {
  if (CheckActorInventory(Player1TID,"EvadeAnAttack") > 0) TakeActorInventory(Player1TID,"EvadeAnAttack", 1); // Damage will occur as normal   
 }
 if (GetCVar("dvdsdebug_showevadestuff") > 0)
 {
  if (BuddhaRNGVal <= MiscellaneousVars[23])
  {
   PrintBold(s:"\c[green]Evasion Rate Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[green]Evasion Rate Chance % - ",d:MiscellaneousVars[23],s:"\n",
             s:"\nPlayer X Vel: ",d:VelX,
             s:"\nPlayer Y Vel: ",d:VelY,
             s:"\nPlayer Z Vel: ",d:VelZ);
  }
  else
  {
   PrintBold(s:"\c[red]Evasion Rate Roll - ",d:BuddhaRNGVal,s:"\n",
             s:"\c[red]Evasion Rate Chance % - ",d:MiscellaneousVars[23],s:"\n",
             s:"\nPlayer X Vel: ",d:VelX,
             s:"\nPlayer Y Vel: ",d:VelY,
             s:"\nPlayer Z Vel: ",d:VelZ);
  }
 }

 //*****************************
 //**End DVII-DS Armor Testing**
 //*****************************


 //*********************************
 //*Check Sauron Equipment Directly*
 //*********************************
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) GiveActorInventory(Player1TID,"HelmetDMGReduction", 1); else TakeActorInventory(Player1TID,"HelmetDMGReduction", 1);

 if (CharacterClass == 0) // Deggaris's Gauntlets
 {
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsIllucia", 9999); GiveActorInventory(Player1TID,"SauronGauntlets", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsFlora", 9999); GiveActorInventory(Player1TID,"SauronGauntlets", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsAilish", 9999); GiveActorInventory(Player1TID,"SauronGauntlets", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsPetra", 9999); GiveActorInventory(Player1TID,"SauronGauntlets", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0)
  {  
   GiveActorInventory(Player1TID,"SauronGauntletsItem", 1);
   GiveActorInventory(Player1TID,"GauntletDMGBonus", 1);
  }
  else
  {
   TakeActorInventory(Player1TID,"SauronGauntletsItem", 9999);
   TakeActorInventory(Player1TID,"GauntletDMGBonus", 9999);
  }
 }
 if (CharacterClass == 1) // Illucia's Gauntlets
 {
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { TakeActorInventory(Player1TID,"SauronGauntlets", 9999); GiveActorInventory(Player1TID,"SauronGauntletsIllucia", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsFlora", 9999); GiveActorInventory(Player1TID,"SauronGauntletsIllucia", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsAilish", 9999); GiveActorInventory(Player1TID,"SauronGauntletsIllucia", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsPetra", 9999); GiveActorInventory(Player1TID,"SauronGauntletsIllucia", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0)
  {  
   GiveActorInventory(Player1TID,"SauronGauntletsItem", 1);
   GiveActorInventory(Player1TID,"GauntletDMGBonus", 1);
  }
  else
  {
   TakeActorInventory(Player1TID,"SauronGauntletsItem", 9999);
   TakeActorInventory(Player1TID,"GauntletDMGBonus", 9999);
  }
 }
 if (CharacterClass == 2) // Flora's Gauntlets
 {
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { TakeActorInventory(Player1TID,"SauronGauntlets", 9999); GiveActorInventory(Player1TID,"SauronGauntletsFlora", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsIllucia", 9999); GiveActorInventory(Player1TID,"SauronGauntletsFlora", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsAilish", 9999); GiveActorInventory(Player1TID,"SauronGauntletsFlora", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsPetra", 9999); GiveActorInventory(Player1TID,"SauronGauntletsFlora", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0)
  {  
   GiveActorInventory(Player1TID,"SauronGauntletsItem", 1);
   GiveActorInventory(Player1TID,"GauntletDMGBonus", 1);
  }
  else
  {
   TakeActorInventory(Player1TID,"SauronGauntletsItem", 9999);
   TakeActorInventory(Player1TID,"GauntletDMGBonus", 9999);
  }
 }
 if (CharacterClass == 8) // Ailish's Gauntlets
 {
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { TakeActorInventory(Player1TID,"SauronGauntlets", 9999); GiveActorInventory(Player1TID,"SauronGauntletsAilish", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsIllucia", 9999); GiveActorInventory(Player1TID,"SauronGauntletsAilish", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsFlora", 9999); GiveActorInventory(Player1TID,"SauronGauntletsAilish", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsPetra", 9999); GiveActorInventory(Player1TID,"SauronGauntletsAilish", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0)
  {  
   GiveActorInventory(Player1TID,"SauronGauntletsItem", 1);
   GiveActorInventory(Player1TID,"GauntletDMGBonus", 1);
  }
  else
  {
   TakeActorInventory(Player1TID,"SauronGauntletsItem", 9999);
   TakeActorInventory(Player1TID,"GauntletDMGBonus", 9999);
  }
 }
 if (CharacterClass == 9) // Petra's Gauntlets
 {
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { TakeActorInventory(Player1TID,"SauronGauntlets", 9999); GiveActorInventory(Player1TID,"SauronGauntletsPetra", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsIllucia", 9999); GiveActorInventory(Player1TID,"SauronGauntletsPetra", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsFlora", 9999); GiveActorInventory(Player1TID,"SauronGauntletsPetra", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { TakeActorInventory(Player1TID,"SauronGauntletsAilish", 9999); GiveActorInventory(Player1TID,"SauronGauntletsPetra", 1); }
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0)
  {  
   GiveActorInventory(Player1TID,"SauronGauntletsItem", 1);
   GiveActorInventory(Player1TID,"GauntletDMGBonus", 1);
  }
  else
  {
   TakeActorInventory(Player1TID,"SauronGauntletsItem", 9999);
   TakeActorInventory(Player1TID,"GauntletDMGBonus", 9999);
  }
 }
 
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
 {  
  GiveActorInventory(Player1TID,"RingDMGBonus", 1); // All characters get a damage bonus with the Ring
  GiveActorInventory(Player1TID,"RingDMGReduction", 1); // All characters get a defense bonus with the Ring
  GiveActorInventory(Player1TID,"RingFullMap", 1); // All characters get a full automap with the Ring
  GiveActorInventory(Player1TID,"RingScanner", 1); // All characters get a map scanner with the Ring
  if (CharacterClass == 0) GiveActorInventory(Player1TID,"RingGhost", 1); // Deggaris becomes Ghostly like with the Ring
  if (CharacterClass == 1) GiveActorInventory(Player1TID,"RingShadow", 1); // Illucia becomes Shadow like with the Ring 
 }
 else
 {
  TakeActorInventory(Player1TID,"RingDMGBonus", 1);
  TakeActorInventory(Player1TID,"RingDMGReduction", 1);
  TakeActorInventory(Player1TID,"RingFullMap", 1);
  TakeActorInventory(Player1TID,"RingScanner", 1);
  TakeActorInventory(Player1TID,"RingGhost", 1);
  TakeActorInventory(Player1TID,"RingShadow", 1);
 }

  // Infinite Ammo Chances
  int infammoreqremaining;
  int infammoneeded = 0;
  int infammoneeded2 = 0;

  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0)		infammoneeded += 250; // +2.5% Chance
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0)			infammoneeded += 400; // +4.0% Chance
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0)		infammoneeded += 650; // +6.5% Chance
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0)		infammoneeded += 1000; // +10.0% Chance
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0)		infammoneeded += 1500; // +15.0% Chance
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0)		infammoneeded += 2500; // +25.0% Chance
  if (ModType != 0) infammoneeded = infammoneeded * 3 / 2; // Marine's Armor gives them 1.5x the chance of infinite ammo (from their specfic armors only) on each tic in DVI/DVII mode.

  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)				infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0)			infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0)	infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0)		infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0)		infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0)		infammoneeded2 += 750; // +7.5% Chance
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0)				infammoneeded2 += 2500; // +25.0% Chance
  if (ModType != 0) infammoneeded2 = infammoneeded2 * 5 / 4; // Sauron's Armor gives them 1.25x the chance of infinite ammo on each tic in DVI/DVII mode.

  infammoneeded += infammoneeded2;
  if (PowerupTimer[7] > 0)
  {
   infammoneeded += 1250;
   infammoreqremaining = (10000 - infammoneeded) / 4; // Gets 25% of the remaining value not covered by the above.
   infammoneeded += infammoreqremaining;
  }

  // "Bottomless Magazines" Perk
  if (MiscellaneousVars[10047] > 0)
  {
   infammoneeded += 500;
   if (MiscellaneousVars[10047] > 1) infammoneeded += 500;
   if (MiscellaneousVars[10047] > 2) infammoneeded += 500;
   if (MiscellaneousVars[10047] > 3) infammoneeded += 500;
   if (MiscellaneousVars[10047] > 4) infammoneeded += 500;
  }
  
  // "Bottomless Magazines EX" Perk
  if (MiscellaneousVars[10048] > 0)
  {
   infammoneeded += 750;
   if (MiscellaneousVars[10048] > 1) infammoneeded += 750;
  }
  
  int infammochance = random(1,10000);
  int minigunheat = CheckActorInventory(Player1TID,"MinigunHeat");
  int minigunheatmax = 100;
  if (infammochance <= infammoneeded)
  {
   GiveActorInventory(Player1TID,"RandomInfiniteAmmo", 1); 
   if (GetCVar("dvdsdebug_infiniteammostuff") > 0)
   {
    PrintBold(s:"DA Chance: ",d:infammoreqremaining, 
	          s:"\n\cdChance: ",d:infammochance,s:" / ",d:infammoneeded, 
			  s:"\n\c-MinigunHeat: ",d:minigunheat,s:" / ",d:minigunheatmax);
   }
  }
  else
  {
   TakeActorInventory(Player1TID,"RandomInfiniteAmmo", 1);
   if (GetCVar("dvdsdebug_infiniteammostuff") > 0)
   {
    PrintBold(s:"DA Chance: ",d:infammoreqremaining, 
	          s:"\n\cfChance: ",d:infammochance,s:" / ",d:infammoneeded,
			  s:"\n\c-MinigunHeat: ",d:minigunheat,s:" / ",d:minigunheatmax);
   }
  }

  // DQ-Style Seed System [DROPPED Versions only, naturally added Seeds/etc do not get despawned via this system]
  // "MiscellaneousVars[29]" is for the Seed limit amount [to be used in more than one script]
  if (GameSkill() == SKILL_VERY_EASY) MiscellaneousVars[29] = 128;
  if (GameSkill() == SKILL_EASY) MiscellaneousVars[29] = 120;
  if (GameSkill() == SKILL_NORMAL) MiscellaneousVars[29] = 112;
  if (GameSkill() == SKILL_HARD) MiscellaneousVars[29] = 104;
  if (GameSkill() == SKILL_VERY_HARD) MiscellaneousVars[29] = 96;
  if (ModType == 0) MiscellaneousVars[29] = MiscellaneousVars[29] * 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife

  // "MiscellaneousVars[28]" is for the Seed of Skill limit amount [to be used in more than one script]
  if (GameSkill() == SKILL_VERY_EASY) MiscellaneousVars[28] = 32;
  if (GameSkill() == SKILL_EASY) MiscellaneousVars[28] = 30;
  if (GameSkill() == SKILL_NORMAL) MiscellaneousVars[28] = 28;
  if (GameSkill() == SKILL_HARD) MiscellaneousVars[28] = 26;
  if (GameSkill() == SKILL_VERY_HARD) MiscellaneousVars[28] = 24;
  if (ModType == 0) MiscellaneousVars[28] = MiscellaneousVars[28] * 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife

  // "MiscellaneousVars[26]" is for the Fygg limit amount [to be used in more than one script]
  if (GameSkill() == SKILL_VERY_EASY) MiscellaneousVars[26] = 3;
  if (GameSkill() == SKILL_EASY) MiscellaneousVars[26] = 3;
  if (GameSkill() == SKILL_NORMAL) MiscellaneousVars[26] = 2;
  if (GameSkill() == SKILL_HARD) MiscellaneousVars[26] = 1;
  if (GameSkill() == SKILL_VERY_HARD) MiscellaneousVars[26] = 1;
  if (ModType == 0) MiscellaneousVars[26] = MiscellaneousVars[26] * 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife
   

 if (CheckActorInventory(Player1TID,"PowerIronFeet") > 0)
 {
  if (CheckActorInventory(Player1TID,"IronFeetNoPoison") == 0) GiveActorInventory(Player1TID,"IronFeetNoPoison",1);
  if (CheckActorInventory(Player1TID,"MaskNoFire") > 0) TakeActorInventory(Player1TID,"MaskNoFire",0x7FFFFFFF);
 }
 else if (CheckActorInventory(Player1TID,"PowerMask") > 0)
 {
  if (CheckActorInventory(Player1TID,"IronFeetNoPoison") == 0) GiveActorInventory(Player1TID,"IronFeetNoPoison",1);
  if (CheckActorInventory(Player1TID,"MaskNoFire") == 0) GiveActorInventory(Player1TID,"MaskNoFire",1);
 }
 else
 {
  if (CheckActorInventory(Player1TID,"IronFeetNoPoison") > 0) TakeActorInventory(Player1TID,"IronFeetNoPoison",0x7FFFFFFF);
  if (CheckActorInventory(Player1TID,"MaskNoFire") > 0) TakeActorInventory(Player1TID,"MaskNoFire",0x7FFFFFFF);
 }


 //*********************
 //*Check Tension Level*
 //*********************
 // [181] Tension Level
 // [182] Tension Level Compare
 // [183] Tension Timer
 // [184] Tension Timer Counts Down
 // [185] Tension Warmup Meter [you must hold down for this long for tension to go up a level]
 // [186] Tension Cooldown Timer [when Tension levels change, or run out, this decides how long to wait before you can do so again]
 // [187] Tension Charge Multiplier [CVAR]
 // [188] Tension Max Cooldown Timer [for bar displays]
 // [189] Tension Sound Charge Loop Timer
 // [190] Active-Tension Pulse Timer
 // [193] Tension Aura Appearance Frame
 // [250] Tension Duration Timer
 // [251] Tension OverCharge Timer
 str TensionPlaceholderItem;
 str TensionAttackItem;
 str TensionDefenseItem;

 int TensionChargeFailRate;
 int TensionChargeTimeMax;
 int TensionStaminaPerTic;
 int randompulseinterval1;
 int randompulseinterval2;
 int randompulseinterval3;
 int randompulseinterval4;
 int pulsevolume;
 int maxpulseinterval;

 if (MiscellaneousVars[181] == 0)  // 0 to 5 Tension [4 Seconds, 20% Total Stamina Use, 0% Fail Rate]
 {
  TensionChargeFailRate = 0;
  TensionChargeTimeMax = 14000;
  TensionStaminaPerTic = 2000;
  MiscellaneousVars[262] = 99999999;
  MiscellaneousVars[261] = 99999999;
  MiscellaneousVars[250] = 0;
  MiscellaneousVars[251] = 0;
 }

 if (MiscellaneousVars[181] == 1)  // 5 to 20 Tension [4.25~ Seconds, 22.5% Total Stamina Use, 2.5% Fail Rate]
 {
  TensionChargeFailRate = 25;
  TensionChargeTimeMax = 14880;
  TensionStaminaPerTic = 2250;
  MiscellaneousVars[262] = 21000; // 600 Seconds [10 minutes]
  MiscellaneousVars[261] = 130; // 3.71 seconds
 }

 if (MiscellaneousVars[181] == 2)  // 20 to 50 Tension [4.5~ Seconds, 25% Total Stamina Use, 10% Fail Rate]
 {
  TensionChargeFailRate = 100;
  TensionChargeTimeMax = 15750;
  TensionStaminaPerTic = 2500;
  MiscellaneousVars[262] = 15750; // 450 Seconds [7.5 minutes]
  MiscellaneousVars[261] = 110; // 3.14 seconds
 }

 if (MiscellaneousVars[181] == 3)  // 50 to 100 Tension [5 Seconds, 30% Total Stamina Use, 50% Fail Rate]
 {
  TensionChargeFailRate = 500;
  TensionChargeTimeMax = 17500;
  TensionStaminaPerTic = 3000;
  MiscellaneousVars[262] = 10500; // 300 Seconds [5 minutes]
  MiscellaneousVars[261] = 90; // 2.57 seconds
 }

 if (MiscellaneousVars[181] == 4)  // 100 to 250 Tension [5.5 Seconds, 35% Total Stamina Use, 70% Fail Rate]
 {
  TensionChargeFailRate = 700;
  TensionChargeTimeMax = 19250;
  TensionStaminaPerTic = 3500;
  MiscellaneousVars[262] = 5250; // 150 Seconds [2.5 minutes]
  MiscellaneousVars[261] = 70; // 2 seconds
 }

 if (MiscellaneousVars[181] == 5)  // 250 to 500 Tension [6 Seconds, 40% Total Stamina Use, 85% Fail Rate]
 {
  TensionChargeFailRate = 850;
  TensionChargeTimeMax = 21000;
  TensionStaminaPerTic = 4000;
  MiscellaneousVars[262] = 2100; // 60 Seconds
  MiscellaneousVars[261] = 60; // 1.71 seconds
 }

 if (MiscellaneousVars[181] == 6)  // 500 to 1000 Tension [7.5 Seconds, 50% Total Stamina Use, 92.5% Fail Rate]
 {
  TensionChargeFailRate = 950;
  TensionChargeTimeMax = 26250;
  TensionStaminaPerTic = 5000;
  MiscellaneousVars[262] = 1575; // 45 Seconds
  MiscellaneousVars[261] = 50; // 1.42 seconds
 }
 if (MiscellaneousVars[181] == 7)
 {
  TensionChargeFailRate = 1000;
  TensionChargeTimeMax = 26250;
  TensionStaminaPerTic = 5000;
  MiscellaneousVars[262] = 1050; // 30 Seconds
  MiscellaneousVars[261] = 40; // 1.14 seconds
 }

 MiscellaneousVars[262] *= 20;
 MiscellaneousVars[261] *= 20;

 if (PowerupTimer[7] > 0)
 {
  MiscellaneousVars[262] *= 4;
  MiscellaneousVars[261] *= 4;
 }
 
 TensionStaminaPerTic = TensionStaminaPerTic / (TensionChargeTimeMax / 190);
 // Check Tension Speed Option [also affects Stamina]
 TensionStaminaPerTic = TensionStaminaPerTic * MiscellaneousVars[193] / 4;
 // Falcon Knife Earrings [-10% Consumption]
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) TensionStaminaPerTic = TensionStaminaPerTic * 9 / 10;

 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) TensionChargeFailRate -= 125; // -12.5% Fail Rate When Berserked
 if (PowerupTimer[7] > 0) TensionChargeFailRate -= 250; // -25% Fail Rate When In Divine Avatar
 if (PowerupTimer[129] > 0) TensionChargeFailRate = TensionChargeFailRate / 2; // 0.5x Fail Rate When In GoE

 int TensionChargeFailRatio = GetCVar("dvds_tension_failrateratio");
 if (TensionChargeFailRatio < 0) TensionChargeFailRatio = 0;
 if (TensionChargeFailRatio > 200) TensionChargeFailRatio = 200;

 TensionChargeFailRate = TensionChargeFailRate * TensionChargeFailRatio / 100;
 PerkFactor = ((MiscellaneousVars[10011] * 125) + (MiscellaneousVars[10012] * random(312,313))) + 10000;
 TensionChargeFailRate = TensionChargeFailRate * PerkFactor / 10000;
 if (GetCVar("dvds_musou_powertripmode") == 1) TensionChargeFailRate = TensionChargeFailRate / 5; // Check "Power Trip" mode Cheat
 if (GetCVar("dvds_musou_powertripmode") == 2) TensionChargeFailRate = TensionChargeFailRate / 10; // Check "Power Trip" mode Cheat
 if (TensionChargeFailRate <= 0) TensionChargeFailRate = 0;

 int TensionChargeAmount;
 int TensionCoolDownRatio = 200;
 PerkFactor = ((MiscellaneousVars[10011] * 500) + (MiscellaneousVars[10012] * 1250)) + 10000;
 TensionCoolDownRatio = TensionCoolDownRatio * PerkFactor / 10000; // "PsycheMore" and "PsycheMore EX" perks.

 TensionCoolDownRatio = TensionCoolDownRatio * GetCVar("dvds_tension_cooldownmultiplier") / 100;

 // Kill Combo
 if (MiscellaneousVars[158] > 1)
 {
  if (MiscellaneousVars[158] > 10 && MiscellaneousVars[158] < 21) { TensionCoolDownRatio = (TensionCoolDownRatio * 1010) / 1000; }
  else if (MiscellaneousVars[158] > 20 && MiscellaneousVars[158] < 36) { TensionCoolDownRatio = (TensionCoolDownRatio * 1030) / 1000; }
  else if (MiscellaneousVars[158] > 35 && MiscellaneousVars[158] < 61) { TensionCoolDownRatio = (TensionCoolDownRatio * 1060) / 1000; }
  else if (MiscellaneousVars[158] > 60 && MiscellaneousVars[158] < 101) { TensionCoolDownRatio = (TensionCoolDownRatio * 1100) / 1000; }
  else if (MiscellaneousVars[158] > 100 && MiscellaneousVars[158] < 201) { TensionCoolDownRatio = (TensionCoolDownRatio * 1200) / 1000; }
  else if (MiscellaneousVars[158] > 200 && MiscellaneousVars[158] < 501) { TensionCoolDownRatio = (TensionCoolDownRatio * 1500) / 1000; }
  else if (MiscellaneousVars[158] > 500) { TensionCoolDownRatio = (TensionCoolDownRatio * 1950) / 1000; }
 }

 
 if (MiscellaneousVars[166] <= 0 && MenuSystemVars[0] == 0) MiscellaneousVars[186] -= TensionCoolDownRatio;

 if (MiscellaneousVars[186] <= 0) { MiscellaneousVars[186] = 0; MiscellaneousVars[188] = MiscellaneousVars[186]; }
 buttons = GetPlayerInput(0, INPUT_BUTTONS); 
 if (GetActorProperty(Player1TID,APROP_Health) > 0)
 {
  TensionChargeAmount = 0;
  FreezePlayer = 0;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[18] > 0 && random(1,20) == 1) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (buttons & BT_USE && buttons & BT_SPEED && MiscellaneousVars[186] <= 0 && FreezePlayer == 0)
  {   
   if (GetCVar("dvds_allowtension") > 0 && DVDSSpecialArrayValue[0] == 0)
   {
    MiscellaneousVars[186] = 0;
    MiscellaneousVars[188] = MiscellaneousVars[186];
    if (MiscellaneousVars[181] <= 7 && MiscellaneousVars[184] <= 0)
    {
     if (MiscellaneousVars[21] >= TensionStaminaPerTic)
     {
      if (MiscellaneousVars[181] < 7)
      {
       MiscellaneousVars[189] ++; // Increase Charge-Up Sound Loop Timer
       if (MiscellaneousVars[189] == 1) // 4
       {
        SetActivator(Player1TID);
        ActivatorSound("tensioncharge",127);
        SetActivator(0);
       }
       if (MiscellaneousVars[189] >= 63) MiscellaneousVars[189] = 0;
 
       if (MiscellaneousVars[185] == 0 && CharacterClass == 2) PlaySound(Player1TID,"FloraChargeTension",CHAN_VOICE,1.0,0,ATTN_NORM);
       SpawnFixedX = GetActorX(Player1TID);
       SpawnFixedY = GetActorY(Player1TID);
       SpawnFixedZ = GetActorZ(Player1TID);
       SpawnForced("TensionParticleGenerator",SpawnFixedX,SpawnFixedY,SpawnFixedZ+(1*65536),0,0);
       if (MiscellaneousVars[181] > 3) // "100"+ Tension
       {
        if (random(1,100) > 50) SpawnForced("TensionParticleGenerator",SpawnFixedX,SpawnFixedY,SpawnFixedZ+(1*65536),0,0);
       }
       if (MiscellaneousVars[181] > 4) // "250"+ Tension
       {
        if (random(1,100) > 80) SpawnForced("TensionParticleGenerator",SpawnFixedX,SpawnFixedY,SpawnFixedZ+(1*65536),0,0);
       }
       if (MiscellaneousVars[181] > 5) // "500"+ Tension
       {
        if (random(1,100) > 86) SpawnForced("TensionParticleGenerator",SpawnFixedX,SpawnFixedY,SpawnFixedZ+(1*65536),0,0);
       }
       if (MiscellaneousVars[181] > 6) // "1000"+ Tension
       {
        if (random(1,100) > 91) SpawnForced("TensionParticleGenerator",SpawnFixedX,SpawnFixedY,SpawnFixedZ+(1*65536),0,0);
       }
      }
      else MiscellaneousVars[189] = 0;
 
      if (MiscellaneousVars[181] == 0) Radius_Quake2(Player1TID,1,4,0,512,"null");
      if (MiscellaneousVars[181] == 1) Radius_Quake2(Player1TID,2,4,0,512,"null");
      if (MiscellaneousVars[181] == 2) Radius_Quake2(Player1TID,3,4,0,512,"null");
      if (MiscellaneousVars[181] == 3) Radius_Quake2(Player1TID,4,4,0,512,"null");
      if (MiscellaneousVars[181] == 4) Radius_Quake2(Player1TID,5,4,0,512,"null");
      if (MiscellaneousVars[181] == 5) Radius_Quake2(Player1TID,7,4,0,512,"null");
      if (MiscellaneousVars[181] == 6) Radius_Quake2(Player1TID,9,4,0,512,"null");
      if (MiscellaneousVars[181] < 7) MiscellaneousVars[21] -= TensionStaminaPerTic;
 
      // 100 = 1 tic
      TensionChargeAmount = 100;
 
      // -37.5% Charge Speed When Fatigued
      if (PowerupTimer[18] > 0) TensionChargeAmount = TensionChargeAmount * 5 / 8;
      // -25% Charge Speed When Berserked
      if (CheckActorInventory(Player1TID,"PowerStrength") > 0) TensionChargeAmount = TensionChargeAmount * 3 / 4;
      // -12.5% Charge Speed When in Divine Avatar
      if (PowerupTimer[7] > 0) TensionChargeAmount = TensionChargeAmount * 7 / 8;
      // +12.5% Charge Speed When Low on Health
      if (CheckActorInventory(Player1TID,"LowHealth") > 0) TensionChargeAmount = TensionChargeAmount * 1125 / 1000;
      // +33.4% Charge Speed When Critically Low on Health
      if (CheckActorInventory(Player1TID,"CriticalHealth") > 0) TensionChargeAmount = TensionChargeAmount * 1334 / 1000;
      // +33.4% Charge Speed for Flora
      if (CharacterClass == 2) TensionChargeAmount = TensionChargeAmount * 1334 / 1000;
      // +50% Charge Speed for Flora when Low on Health
      if (CharacterClass == 2 && CheckActorInventory(Player1TID,"LowHealth") > 0) TensionChargeAmount = TensionChargeAmount * 1500 / 1000;
      // +125% Charge Speed for Flora when Critically low on Health
      if (CharacterClass == 2 && CheckActorInventory(Player1TID,"CriticalHealth") > 0) TensionChargeAmount = TensionChargeAmount * 2250 / 1000;
      // Check Tension Charge Multiplier Option
      TensionChargeAmount = TensionChargeAmount * GetCVar("dvds_tension_chargemultiplier") / 100;
      // Check Tension Speed Option [also affects Stamina]
      TensionChargeAmount = TensionChargeAmount * MiscellaneousVars[193] / 4;
      // Check "Power Trip" mode Cheat
      if (GetCVar("dvds_musou_powertripmode") == 1) TensionChargeAmount *= 5;
      if (GetCVar("dvds_musou_powertripmode") == 2) TensionChargeAmount *= 10;

	  // Kill Combo
	  if (MiscellaneousVars[158] > 1)
	  {
	   if (MiscellaneousVars[158] > 10 && MiscellaneousVars[158] < 21) { TensionChargeAmount = (TensionChargeAmount * 1005) / 1000; }
	   else if (MiscellaneousVars[158] > 20 && MiscellaneousVars[158] < 36) { TensionChargeAmount = (TensionChargeAmount * 1015) / 1000; }
	   else if (MiscellaneousVars[158] > 35 && MiscellaneousVars[158] < 61) { TensionChargeAmount = (TensionChargeAmount * 1030) / 1000; }
	   else if (MiscellaneousVars[158] > 60 && MiscellaneousVars[158] < 101) { TensionChargeAmount = (TensionChargeAmount * 1050) / 1000; }
	   else if (MiscellaneousVars[158] > 100 && MiscellaneousVars[158] < 201) { TensionChargeAmount = (TensionChargeAmount * 1100) / 1000; }
	   else if (MiscellaneousVars[158] > 200 && MiscellaneousVars[158] < 501) { TensionChargeAmount = (TensionChargeAmount * 1250) / 1000; }
	   else if (MiscellaneousVars[158] > 500) { TensionChargeAmount = (TensionChargeAmount * 1475) / 1000; }
	  }
	  
      // PsycheMore perks
      PerkFactor = ((MiscellaneousVars[10011] * 750) + (MiscellaneousVars[10012] * 1875)) + 10000;
      TensionChargeAmount = TensionChargeAmount * PerkFactor / 10000; // "PsycheMore" and "PsycheMore EX" perks.
      TensionChargeAmount += (MiscellaneousVars[10011] / 2);
      TensionChargeAmount += MiscellaneousVars[10012];

      // Kill-Combo Bonus
	  int TensionChargeKillBonus = ((MiscellaneousVars[158] * 3) / 4) + 100;
      if (MiscellaneousVars[158] > 0) TensionChargeAmount = (TensionChargeAmount * TensionChargeKillBonus) / 100;

      // Up-Clamp to 1 Tic
      if (TensionChargeAmount < 1) TensionChargeAmount = 1;
     }
     else
     {
      if (MiscellaneousVars[189] > 0) MiscellaneousVars[189] = 0;

      if (MiscellaneousVars[181] == 0) MiscellaneousVars[186] = 3500;
      else if (MiscellaneousVars[181] == 1) MiscellaneousVars[186] = 3720;
      else if (MiscellaneousVars[181] == 2) MiscellaneousVars[186] = 3940;
      else if (MiscellaneousVars[181] == 3) MiscellaneousVars[186] = 4380;
      else if (MiscellaneousVars[181] == 4) MiscellaneousVars[186] = 4810;
      else if (MiscellaneousVars[181] == 5) MiscellaneousVars[186] = 5250;
      else if (MiscellaneousVars[181] == 6) MiscellaneousVars[186] = 6560;
      MiscellaneousVars[186] = MiscellaneousVars[186] * 3 / 2;
      MiscellaneousVars[188] = MiscellaneousVars[186];

      if (MiscellaneousVars[181] < 7)
      {
       SetActivator(Player1TID);
       ActivatorSound("tensionfailed",127);
       SetActivator(0);
      }

      MiscellaneousVars[21] = 0;
      TensionChargeAmount -= 250;
     }
    }
   }

  }
  else
  {
   if (MiscellaneousVars[189] > 0) MiscellaneousVars[189] = 0;
   TensionChargeAmount -= 250;
  }

  // Movement to decrease Tension charge.
  C3 = 0;
  FreezePlayer = 0;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (FreezePlayer == 0)
  {
   if (buttons & BT_FORWARD) C3 = -500;
   else if (buttons & BT_BACK) C3 = -500;
   else if (buttons & BT_MOVELEFT) C3 = -500;
   else if (buttons & BT_MOVERIGHT) C3 = -500;
   else if (buttons & BT_MOVEUP) C3 = -500;
   else if (buttons & BT_MOVEDOWN) C3 = -500;
   else if (buttons & BT_JUMP) C3 = -500;
   else if (buttons & BT_CROUCH) C3 = -500;
  }

  FreezePlayer = 0;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (C3 != 0 && MiscellaneousVars[186] < 7000 && FreezePlayer == 0)
  {
   if (GetCVar("dvds_allowtension") > 0)
   {
    MiscellaneousVars[186] = 7000; // 1 Sec
    MiscellaneousVars[188] = MiscellaneousVars[186];
   }
  }
  TensionChargeAmount += C3;
  int TensionTimerMax;

  if (MiscellaneousVars[184] <= 0 && MenuSystemVars[0] == 0) MiscellaneousVars[185] += TensionChargeAmount;

  if (MiscellaneousVars[185] <= 0) MiscellaneousVars[185] = 0;
  if (MiscellaneousVars[185] >= TensionChargeTimeMax)
  {
   if (random(1,1000) > TensionChargeFailRate)
   {
    MiscellaneousVars[184] = 0;

    if (MiscellaneousVars[181] == 0) { MiscellaneousVars[186] = 3500; FadeRange(254,104,253,0.33,254,104,253,0,1.25); }
    else if (MiscellaneousVars[181] == 1) { MiscellaneousVars[186] = 3720; FadeRange(254,104,253,0.44,254,104,253,0,1.375); }
    else if (MiscellaneousVars[181] == 2) { MiscellaneousVars[186] = 3940; FadeRange(254,104,253,0.55,254,104,253,0,1.5); }
    else if (MiscellaneousVars[181] == 3) { MiscellaneousVars[186] = 4380; FadeRange(254,104,253,0.66,254,104,253,0,1.625); }
    else if (MiscellaneousVars[181] == 4) { MiscellaneousVars[186] = 4810; FadeRange(254,104,253,0.77,254,104,253,0,1.75); }
    else if (MiscellaneousVars[181] == 5) { MiscellaneousVars[186] = 5250; FadeRange(254,104,253,0.88,254,104,253,0,1.875); }
    else if (MiscellaneousVars[181] == 6) { MiscellaneousVars[186] = 6560; FadeRange(254,104,253,0.99,254,104,253,0,2.0); }
    MiscellaneousVars[186] *= 2;
    MiscellaneousVars[188] = MiscellaneousVars[186];
    MiscellaneousVars[250] = 0;
    MiscellaneousVars[251] = 0;

    SetActivator(Player1TID);
    if (MiscellaneousVars[181] >= 0 && MiscellaneousVars[181] <= 2) // to 5,20,50
    {
 	 //ActivatorSound("tensionincrease",127);
	 PlaySound(Player1TID,"tensionincrease",CHAN_7,1.0,0,ATTN_NORM);
    }
    if (MiscellaneousVars[181] >= 3 && MiscellaneousVars[181] <= 4)  // to 100,250 [Super High Tension]
	{ 
 	 //ActivatorSound("tensionhigh1",127);
	 PlaySound(Player1TID,"tensionhigh1",CHAN_7,1.0,0,ATTN_NORM);
     if (CharacterClass == 2 && MiscellaneousVars[181] == 3 && random(1,3) == 1) PlaySound(Player1TID,"FloraEnterHighTension1",CHAN_VOICE,1.0,0,ATTN_NORM);
     if (CharacterClass == 2 && MiscellaneousVars[181] == 4 && random(1,2) == 1) PlaySound(Player1TID,"FloraEnterHighTension2",CHAN_VOICE,1.0,0,ATTN_NORM);
	}
    if (MiscellaneousVars[181] == 5) // to 500
	{
 	 //ActivatorSound("tensionhigh2",127);
	 PlaySound(Player1TID,"tensionhigh2",CHAN_7,1.0,0,ATTN_NORM);
     if (CharacterClass == 2) PlaySound(Player1TID,"FloraEnterHighTension2",CHAN_VOICE,1.0,0,ATTN_NORM);
	}
    if (MiscellaneousVars[181] == 6) // to 1000
	{
	 //ActivatorSound("tensionhigh3",127);
	 PlaySound(Player1TID,"tensionhigh3",CHAN_7,1.0,0,ATTN_NORM);
     if (CharacterClass == 2) PlaySound(Player1TID,"FloraEnterHighTension3",CHAN_VOICE,1.0,0,ATTN_NORM);
	}

    if (MiscellaneousVars[181] == 0) SpawnProjectile(0, "PlayerTension5BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 1) SpawnProjectile(0, "PlayerTension20BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 2) SpawnProjectile(0, "PlayerTension50BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 3) SpawnProjectile(0, "PlayerTension100BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 4) SpawnProjectile(0, "PlayerTension250BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 5) SpawnProjectile(0, "PlayerTension500BlastRadius", 0, 0, 0, 0, 2102);
    if (MiscellaneousVars[181] == 6) SpawnProjectile(0, "PlayerTension1000BlastRadius", 0, 0, 0, 0, 2102);
    project_RealZ = GetActorZ(Player1TID) + (GetActorViewHeight(Player1TID) * 39 / 50) + 8.0;
    SetActorVelocity(2102, 0, 0, 0, 0, 0);
    SetActorAngle(2102, 0.0);
    SetActorPosition(2102, GetActorX(Player1TID), GetActorY(Player1TID), project_RealZ, 0);
    Thing_ChangeTID(2102,4443);
	
    SetActivator(0);
    MiscellaneousVars[181] += 1;

    if (MiscellaneousVars[181] == 1) MiscellaneousVars[183] = 3600;
    if (MiscellaneousVars[181] == 2) MiscellaneousVars[183] = 4320;
    if (MiscellaneousVars[181] == 3) MiscellaneousVars[183] = 5184;
    if (MiscellaneousVars[181] == 4) MiscellaneousVars[183] = 6221;
    if (MiscellaneousVars[181] == 5) MiscellaneousVars[183] = 7465;
    if (MiscellaneousVars[181] == 6) MiscellaneousVars[183] = 8958;
    if (MiscellaneousVars[181] == 7) MiscellaneousVars[183] = 10750;
   }   
   else // Psyche Up Fails D:
   {
    MiscellaneousVars[184] = 0;

    if (GetCVar("dvds_allowtension") > 0)
    {
     if (MiscellaneousVars[181] == 0) MiscellaneousVars[186] = 3500;
     else if (MiscellaneousVars[181] == 1) MiscellaneousVars[186] = 3720;
     else if (MiscellaneousVars[181] == 2) MiscellaneousVars[186] = 3940;
     else if (MiscellaneousVars[181] == 3) MiscellaneousVars[186] = 4380;
     else if (MiscellaneousVars[181] == 4) MiscellaneousVars[186] = 4810;
     else if (MiscellaneousVars[181] == 5) MiscellaneousVars[186] = 5250;
     else if (MiscellaneousVars[181] == 6) MiscellaneousVars[186] = 6560;
     MiscellaneousVars[186] = MiscellaneousVars[186] * 3 / 2;
     MiscellaneousVars[188] = MiscellaneousVars[186];

     if (MiscellaneousVars[181] < 7)
     {
      SetActivator(Player1TID);
      ActivatorSound("tensionfailed",127);
      SetActivator(0);
     }
    }

    if (MiscellaneousVars[181] == 1) MiscellaneousVars[183] = 3600;
    if (MiscellaneousVars[181] == 2) MiscellaneousVars[183] = 4320;
    if (MiscellaneousVars[181] == 3) MiscellaneousVars[183] = 5184;
    if (MiscellaneousVars[181] == 4) MiscellaneousVars[183] = 6221;
    if (MiscellaneousVars[181] == 5) MiscellaneousVars[183] = 7465;
    if (MiscellaneousVars[181] == 6) MiscellaneousVars[183] = 8958;
    if (MiscellaneousVars[181] == 7) MiscellaneousVars[183] = 10750;
   }
   MiscellaneousVars[185] = 0; // Warmup Timer
  }
 }
 else
 {
  if (MiscellaneousVars[181] > 0) { PlaySound(Player1TID,"tensionrevert",CHAN_BODY,1.0,0,ATTN_NORM); MiscellaneousVars[181] = 0; } // Level
  if (MiscellaneousVars[182] > 0) MiscellaneousVars[182] = 0; // Compare
  if (MiscellaneousVars[183] > 0) MiscellaneousVars[183] = 0; // Timer
  if (MiscellaneousVars[184] > 0) MiscellaneousVars[184] = 0; // Timer Counts Down?
  if (MiscellaneousVars[185] > 0) MiscellaneousVars[185] = 0;
  if (MiscellaneousVars[186] > 0) MiscellaneousVars[186] = 0;
  if (MiscellaneousVars[188] > 0) MiscellaneousVars[188] = 0;
  if (MiscellaneousVars[189] > 0) MiscellaneousVars[189] = 0;
  if (MiscellaneousVars[190] > 0) MiscellaneousVars[190] = 0;
 }

 if (GetActorProperty(Player1TID,APROP_Health) > 0)
 {
  if (MiscellaneousVars[181] != 0)
  {
   if (MiscellaneousVars[181] == 1) { pulsevolume = random(15,31); maxpulseinterval = random(21,23); }
   if (MiscellaneousVars[181] == 2) { pulsevolume = random(18,47); maxpulseinterval = random(19,21); }
   if (MiscellaneousVars[181] == 3) { pulsevolume = random(21,63); maxpulseinterval = random(17,19); }
   if (MiscellaneousVars[181] == 4) { pulsevolume = random(24,79); maxpulseinterval = random(15,17); }
   if (MiscellaneousVars[181] == 5) { pulsevolume = random(27,95); maxpulseinterval = random(13,15); }
   if (MiscellaneousVars[181] == 6) { pulsevolume = random(30,111); maxpulseinterval = random(12,14); }
   if (MiscellaneousVars[181] == 7) { pulsevolume = random(33,127); maxpulseinterval = random(11,13); }
   maxpulseinterval *= 2;
   if (random(1,4) == 1) randompulseinterval1 = maxpulseinterval * 2; else randompulseinterval1 = random(1,maxpulseinterval);
   if (random(1,4) == 1) randompulseinterval2 = maxpulseinterval * 2; else randompulseinterval2 = random(1,maxpulseinterval);
   if (random(1,4) == 1) randompulseinterval3 = maxpulseinterval * 2; else randompulseinterval3 = random(1,maxpulseinterval);
   if (random(1,4) == 1) randompulseinterval4 = maxpulseinterval * 2; else randompulseinterval4 = random(1,maxpulseinterval);
   MiscellaneousVars[190] ++; // Increase Charge-Up Sound Loop Timer

   if (MiscellaneousVars[190] == randompulseinterval1 && MiscellaneousVars[181] >= 1)
   {
    SetActivator(Player1TID); 
    ActivatorSound("tensionpulserand",pulsevolume); 
    SetActivator(0);
    randompulseinterval1 = random(1,maxpulseinterval);
   }
   if (MiscellaneousVars[190] == randompulseinterval2 && MiscellaneousVars[181] >= 3)
   {
    SetActivator(Player1TID); 
    ActivatorSound("tensionpulserand",pulsevolume); 
    SetActivator(0);
    randompulseinterval2 = random(1,maxpulseinterval);
   }
   if (MiscellaneousVars[190] == randompulseinterval3 && MiscellaneousVars[181] >= 5)
   {
    SetActivator(Player1TID); 
    ActivatorSound("tensionpulserand",pulsevolume); 
    SetActivator(0);
    randompulseinterval3 = random(1,maxpulseinterval);
   }
   if (MiscellaneousVars[190] == randompulseinterval4 && MiscellaneousVars[181] >= 7)
   {
    SetActivator(Player1TID); 
    ActivatorSound("tensionpulserand",pulsevolume); 
    SetActivator(0);
    randompulseinterval4 = random(1,maxpulseinterval);
   }


   if (MiscellaneousVars[190] >= maxpulseinterval) MiscellaneousVars[190] = 0;

   // Background Sound for the humming of tension.
   MiscellaneousVars[246]++;
   if (MiscellaneousVars[246] == 1)
   {    
    StopSound(Player1TID,CHAN_6);
    if (MiscellaneousVars[181] == 1) PlaySound(Player1TID,"tensionaura5",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 2) PlaySound(Player1TID,"tensionaura20",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 3) PlaySound(Player1TID,"tensionaura50",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 4) PlaySound(Player1TID,"tensionaura100",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 5) PlaySound(Player1TID,"tensionaura250",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 6) PlaySound(Player1TID,"tensionaura500",CHAN_6,1.0,0,ATTN_NORM);
    if (MiscellaneousVars[181] == 7) PlaySound(Player1TID,"tensionaura1000",CHAN_6,1.0,0,ATTN_NORM);
   }
   if (MiscellaneousVars[246] >= 68) MiscellaneousVars[246] = 0;

   int TensionOverchargeDmgFactor;
   int TensionOverchargeDmgBase;
   int TensionOverchargeDmgFinal;
   int TensionOverchargeDmgThreshold = GetActorProperty(Player1TID,APROP_HEALTH) / 256;
   if (TensionOverchargeDmgThreshold < 1) TensionOverchargeDmgThreshold = 1;

   // Overcharge Tracking
   int TensionOCTimer1Amount = 20;
   int TensionOCTimer2Amount = 20;
   if (PowerupTimer[4] > 0) // Invulnerability stops the Overcharge timers while in effect
   {
    TensionOCTimer1Amount *= 0;
    TensionOCTimer2Amount *= 0;
   }
   if (PowerupTimer[10] > 0) // Oomph Slows it down
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 3 / 4;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 3 / 4;
   }
   if (PowerupTimer[11] > 0) // Buff Slows it down
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 3 / 4;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 3 / 4;
   }
   if (PowerupTimer[12] > 0) // Accelerate Speeds it up
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 6 / 5;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 6 / 5;
   }
   if (PowerupTimer[15] > 0) // Decelerate Slows it down
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 4 / 5;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 4 / 5;
   }
   if (PowerupTimer[16] > 0) // Poison Really Speeds it Up
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 7 / 4;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 7 / 4;
   }
   if (PowerupTimer[23] > 0) // Berserk Speeds it up
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount * 5 / 4;
    TensionOCTimer2Amount = TensionOCTimer2Amount * 5 / 4;
   }
   if (MiscellaneousVars[184] == 1)
   {
    TensionOCTimer1Amount = TensionOCTimer1Amount / 3;
    TensionOCTimer2Amount = TensionOCTimer2Amount / 3;
   }

   if (GetCVar("dvds_allowtensionocdmg") > 0) MiscellaneousVars[250] += TensionOCTimer1Amount; else MiscellaneousVars[250] = 0;
   if (MiscellaneousVars[250] >= MiscellaneousVars[262] && GetCVar("dvds_allowtensionocdmg") > 0)
   {
    MiscellaneousVars[250] = MiscellaneousVars[262];
    if (GetCVar("dvds_allowtensionocdmg") > 0) MiscellaneousVars[251] += TensionOCTimer2Amount; else MiscellaneousVars[251] = 0;
    if (MiscellaneousVars[251] >= MiscellaneousVars[261] && GetCVar("dvds_allowtensionocdmg") > 0)
    {
     MiscellaneousVars[251] = 0;
	 MiscellaneousVars[261] = 0;
	 TensionOverchargeDmgFactor = random(6,10) * ((6 + ((MiscellaneousVars[181] * 9) / 4)) / 7);
	 TensionOverchargeDmgBase = (random(2,3) * TensionOverchargeDmgFactor) / 8;
	 if (TensionOverchargeDmgBase < 2 && MiscellaneousVars[181] > 4) TensionOverchargeDmgBase = 2;
	 if (TensionOverchargeDmgBase < 1) TensionOverchargeDmgBase = 1;
	 TensionOverchargeDmgFinal = GetActorProperty(Player1TID,APROP_HEALTH) - TensionOverchargeDmgBase;
	 if (TensionOverchargeDmgFinal < TensionOverchargeDmgThreshold) TensionOverchargeDmgFinal = TensionOverchargeDmgThreshold;
	 if (TensionOverchargeDmgFinal > TensionOverchargeDmgThreshold)
	 {
	  if (PowerupTimer[4] == 0)
	  {
	   if (CharacterClass == 2 && random(1,5) == 1) ACS_NamedExecuteAlways("FloraPainScreams",0,0,0,0);
	   if (CharacterClass == 8 && random(1,5) == 1) ACS_NamedExecuteAlways("AilishPainScreams",0,0,0,0);
	   if (CharacterClass == 9 && random(1,5) == 1) ACS_NamedExecuteAlways("PetraPainScreams",0,0,0,0);
	   SetActorProperty(Player1TID,APROP_HEALTH,TensionOverchargeDmgFinal);
	  }
	 }	 
	}
   }
   else
   {
    MiscellaneousVars[251] = 0;
   }
   
   int tensiontimerdecrease;
   if (MiscellaneousVars[184] > 0 && MiscellaneousVars[183] >= 0)
   {
    tensiontimerdecrease = 20;
    tensiontimerdecrease = tensiontimerdecrease * GetCVar("dvds_tension_countdownmultiplier") / 100;
    if (GetCVar("dvds_musou_powertripmode") == 1) tensiontimerdecrease = tensiontimerdecrease / 5; // 'Power Trip' mode cheat
    if (GetCVar("dvds_musou_powertripmode") == 2) tensiontimerdecrease = tensiontimerdecrease / 10; // 'Power Trip' mode cheat
    if (CheckActorInventory(Player1TID,"MartArtsMaster1") > 0) tensiontimerdecrease = (tensiontimerdecrease * random(800,900)) / 1000;
    if (CheckActorInventory(Player1TID,"MartArtsMaster2") > 0) tensiontimerdecrease = (tensiontimerdecrease * random(400,600)) / 1000;
    PerkFactor = 10000 - ((MiscellaneousVars[10011] * 250) + (MiscellaneousVars[10012] * 625));
	tensiontimerdecrease = (tensiontimerdecrease * PerkFactor) / 10000;
    If (MenuSystemVars[0] == 0) MiscellaneousVars[183] -= tensiontimerdecrease;
   }
   if (MiscellaneousVars[183] <= 0) 
   { 
    if (GetCVar("dvds_allowtension") > 0)
    {
     if (MiscellaneousVars[181] == 1) MiscellaneousVars[186] = 14000; // Cooldown Timer set to 4 seconds
     if (MiscellaneousVars[181] == 2) MiscellaneousVars[186] = 14880; // Cooldown Timer set to 4.25 seconds
     if (MiscellaneousVars[181] == 3) MiscellaneousVars[186] = 15750; // Cooldown Timer set to 4.5 seconds
     if (MiscellaneousVars[181] == 4) MiscellaneousVars[186] = 17500; // Cooldown Timer set to 5 seconds
     if (MiscellaneousVars[181] == 5) MiscellaneousVars[186] = 19250; // Cooldown Timer set to 5.5 seconds
     if (MiscellaneousVars[181] == 6) MiscellaneousVars[186] = 21000; // Cooldown Timer set to 6 seconds
     if (MiscellaneousVars[181] == 7) MiscellaneousVars[186] = 26250; // Cooldown Timer set to 7.5 seconds
     MiscellaneousVars[186] *= 2;
     MiscellaneousVars[188] = MiscellaneousVars[186];
    }

    MiscellaneousVars[185] = 0; // Warmup Timer
    MiscellaneousVars[184] = 0; // Tension Timer
    MiscellaneousVars[181] = 0; // Tension Level
    MiscellaneousVars[246] = 0; // Tension Aura-Sound Timer
    StopSound(Player1TID,CHAN_6);
    StopSound(Player1TID,CHAN_7);

    PlaySound(Player1TID,"tensionrevert",CHAN_6,1.0,0,ATTN_NORM);
   }
  }
  if (GetCVar("dvds_allowtension") > 0)
  {
   if (MiscellaneousVars[181] < 0) MiscellaneousVars[181] = 0;
   if (MiscellaneousVars[181] > 7) MiscellaneousVars[181] = 7;
  }
  else
  {
   if (MiscellaneousVars[181] != 0) { MiscellaneousVars[181] = 0; PlaySound(Player1TID,"tensionrevert",CHAN_BODY,1.0,0,ATTN_NORM); }
   if (MiscellaneousVars[183] != 0) MiscellaneousVars[183] = 0; // Timer
   if (MiscellaneousVars[184] != 0) MiscellaneousVars[184] = 0; // Timer Counts Down?
   if (MiscellaneousVars[185] != 0) MiscellaneousVars[185] = 0;
   if (MiscellaneousVars[186] != 0) MiscellaneousVars[186] = 0;
   if (GetCVar("dvds_tension_chargemultiplier") != 0) MiscellaneousVars[189] = 0;
   if (MiscellaneousVars[188] != 0) MiscellaneousVars[190] = 0;   
  }
  if (GetActorProperty(Player1TID,APROP_Health) > 0)
  {
   if (GetCVar("dvds_allowtension") > 0)
   {
    if (MiscellaneousVars[181] == 1) // Tension is "5"
    {
     GiveActorInventory(Player1TID,"Tension5", 1);
     GiveActorInventory(Player1TID,"Tension5Atk", 1);
     GiveActorInventory(Player1TID,"Tension5Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension5", 9999);
     TakeActorInventory(Player1TID,"Tension5Atk", 9999);
     TakeActorInventory(Player1TID,"Tension5Def", 9999);
    }
   
    if (MiscellaneousVars[181] == 2) // Tension is "20"
    {
     GiveActorInventory(Player1TID,"Tension20", 1);
     GiveActorInventory(Player1TID,"Tension20Atk", 1);
     GiveActorInventory(Player1TID,"Tension20Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension20", 9999);
     TakeActorInventory(Player1TID,"Tension20Atk", 9999);
     TakeActorInventory(Player1TID,"Tension20Def", 9999);
    }
   
    if (MiscellaneousVars[181] == 3) // Tension is "50"
    {
     GiveActorInventory(Player1TID,"Tension50", 1);
     GiveActorInventory(Player1TID,"Tension50Atk", 1);
     GiveActorInventory(Player1TID,"Tension50Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension50", 9999);
     TakeActorInventory(Player1TID,"Tension50Atk", 9999);
     TakeActorInventory(Player1TID,"Tension50Def", 9999);
    }
  
    if (MiscellaneousVars[181] == 4) // Tension is "100"
    {
     GiveActorInventory(Player1TID,"Tension100", 1);
     GiveActorInventory(Player1TID,"Tension100Atk", 1);
     GiveActorInventory(Player1TID,"Tension100Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension100", 9999);
     TakeActorInventory(Player1TID,"Tension100Atk", 9999);
     TakeActorInventory(Player1TID,"Tension100Def", 9999);
    }
  
    if (MiscellaneousVars[181] == 5) // Tension is "250"
    {
     GiveActorInventory(Player1TID,"Tension250", 1);
     GiveActorInventory(Player1TID,"Tension250Atk", 1);
     GiveActorInventory(Player1TID,"Tension250Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension250", 9999);
     TakeActorInventory(Player1TID,"Tension250Atk", 9999);
     TakeActorInventory(Player1TID,"Tension250Def", 9999);
    }
  
    if (MiscellaneousVars[181] == 6) // Tension is "500"
    {
     GiveActorInventory(Player1TID,"Tension500", 1);
     GiveActorInventory(Player1TID,"Tension500Atk", 1);
     GiveActorInventory(Player1TID,"Tension500Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension500", 9999);
     TakeActorInventory(Player1TID,"Tension500Atk", 9999);
     TakeActorInventory(Player1TID,"Tension500Def", 9999);
    }
  
    if (MiscellaneousVars[181] == 7) // Tension is "1000"
    {
     GiveActorInventory(Player1TID,"Tension1000", 1);
     GiveActorInventory(Player1TID,"Tension1000Atk", 1);
     GiveActorInventory(Player1TID,"Tension1000Def", 1);
    }
    else
    {
     TakeActorInventory(Player1TID,"Tension1000", 9999);
     TakeActorInventory(Player1TID,"Tension1000Atk", 9999);
     TakeActorInventory(Player1TID,"Tension1000Def", 9999);
    }
   }
   else
   {
    TakeActorInventory(Player1TID,"Tension5", 9999);
    TakeActorInventory(Player1TID,"Tension5Atk", 9999);
    TakeActorInventory(Player1TID,"Tension5Def", 9999);
    TakeActorInventory(Player1TID,"Tension20", 9999);
    TakeActorInventory(Player1TID,"Tension20Atk", 9999);
    TakeActorInventory(Player1TID,"Tension20Def", 9999);
    TakeActorInventory(Player1TID,"Tension50", 9999);
    TakeActorInventory(Player1TID,"Tension50Atk", 9999);
    TakeActorInventory(Player1TID,"Tension50Def", 9999);
    TakeActorInventory(Player1TID,"Tension100", 9999);
    TakeActorInventory(Player1TID,"Tension100Atk", 9999);
    TakeActorInventory(Player1TID,"Tension100Def", 9999);
    TakeActorInventory(Player1TID,"Tension250", 9999);
    TakeActorInventory(Player1TID,"Tension250Atk", 9999);
    TakeActorInventory(Player1TID,"Tension250Def", 9999);
    TakeActorInventory(Player1TID,"Tension500", 9999);
    TakeActorInventory(Player1TID,"Tension500Atk", 9999);
    TakeActorInventory(Player1TID,"Tension500Def", 9999);
    TakeActorInventory(Player1TID,"Tension1000", 9999);
    TakeActorInventory(Player1TID,"Tension1000Atk", 9999);
    TakeActorInventory(Player1TID,"Tension1000Def", 9999);
   }  

   if (MiscellaneousVars[181] >= 4) // Tension is "100" or higher
   {
    GiveActorInventory(Player1TID,"TensionTrail", 1);	 
   }
   else
   {
    TakeActorInventory(Player1TID,"TensionTrail", 9999);	 
   }

  }
 }
 
 // Tension Aura Actor Control
 // TID 1501 - Aura
 // TID 1502 - Aura Lights
 str TensionAuraLight;
 int TensionAuraSpawnHeight;
 int TensionAuraXScale;
 int TensionAuraYScale;
 int TensionAuraAlpha;
 int TensionAuraAlphaInvis;
 if (MiscellaneousVars[181] > 0)
 {
  SpawnFixedX = GetActorX(Player1TID);
  SpawnFixedY = GetActorY(Player1TID);
  SpawnFixedZ = GetActorZ(Player1TID);
  if (CharacterClass == 0) TensionAuraSpawnHeight = 28 * 65536;
  if (CharacterClass == 1) TensionAuraSpawnHeight = 26 * 65536;
  if (CharacterClass == 2) TensionAuraSpawnHeight = 25 * 65536;
  TensionAuraSpawnHeight += SpawnFixedZ;

  int TensionAuraXScaleExtra = 1.0;
  int TensionAuraYScaleExtra = 1.0;
  if (ClassicDoomType == 5) // Doom 64
  {
   TensionAuraXScaleExtra = 1.1;
   TensionAuraYScaleExtra = 1.375;
  }
  
  if (MiscellaneousVars[181] == 1)
  {
   TensionAuraLight = "TensionAuraLight5"; 
   TensionAuraXScale = fixedmul(0.5,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.75,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.20;
   TensionAuraAlphaInvis = 0.02;
   if (ThingCountName("TensionAuraLight5", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 2)
  {
   TensionAuraLight = "TensionAuraLight20";
   TensionAuraXScale = fixedmul(0.5555,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.8333,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.26;
   TensionAuraAlphaInvis = 0.026;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 3) 
  { 
   TensionAuraLight = "TensionAuraLight50"; 
   TensionAuraXScale = fixedmul(0.6111,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.9116,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.32;
   TensionAuraAlphaInvis = 0.032;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 4)
  {
   TensionAuraLight = "TensionAuraLight100"; 
   TensionAuraXScale = fixedmul(0.6667,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.0,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.38;
   TensionAuraAlphaInvis = 0.038;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 5) 
  {
   TensionAuraLight = "TensionAuraLight250";
   TensionAuraXScale = fixedmul(0.7222,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.0833,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.44;
   TensionAuraAlphaInvis = 0.044;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 6) 
  {
   TensionAuraLight = "TensionAuraLight500"; 
   TensionAuraXScale = fixedmul(0.7777,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.1666,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.5;
   TensionAuraAlphaInvis = 0.05;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 7) 
  {
   TensionAuraLight = "TensionAuraLight1000";
   TensionAuraXScale = fixedmul(0.8333,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.25,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.56;
   TensionAuraAlphaInvis = 0.056;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
  }

  // Misc Rescaling
  if (GetCVar("dvds_tensionauratype") == 0) // Classic Tension Aura Sprites
  {
   TensionAuraXScale = fixedmul(TensionAuraXScale,1.0);
   TensionAuraYScale = fixedmul(TensionAuraYScale,1.0);
  }
  if (GetCVar("dvds_tensionauratype") == 1) // Updated Tension Aura Sprites
  {
   TensionAuraXScale = fixedmul(TensionAuraXScale,0.575);
   TensionAuraYScale = fixedmul(TensionAuraYScale,0.425);
  }

  if (CharacterClass == 0) { TensionAuraXScale = fixedmul(TensionAuraXScale,1.12);  TensionAuraYScale = fixedmul(TensionAuraYScale,1.23); }
  if (CharacterClass == 1) { TensionAuraXScale = fixedmul(TensionAuraXScale,1.04);  TensionAuraYScale = fixedmul(TensionAuraYScale,1.08); }
  if (CharacterClass == 2) { TensionAuraXScale = fixedmul(TensionAuraXScale,1.0);   TensionAuraYScale = fixedmul(TensionAuraYScale,1.0); }
  if (CharacterClass == 9) { TensionAuraXScale = fixedmul(TensionAuraXScale,0.96);  TensionAuraYScale = fixedmul(TensionAuraYScale,0.96); }

  if (ThingCountName("TensionAuraLooper", 1501) < 1) SpawnForced("TensionAuraLooper",SpawnFixedX,SpawnFixedY,SpawnFixedZ,1501,0);
  if (ThingCountName("TensionAuraLooper", 1501) > 0)
  {
   SetActorProperty(1501,APROP_ScaleX,TensionAuraXScale);
   SetActorProperty(1501,APROP_ScaleY,TensionAuraYScale);
   if (PowerupTimer[1] > 0) SetActorProperty(1501,APROP_Alpha,TensionAuraAlphaInvis);
   else SetActorProperty(1501,APROP_Alpha,TensionAuraAlpha);
  }
 }
 else
 {
  if (ThingCountName("TensionAuraLooper", 1501) > 0) Thing_Remove(1501);
  if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
 }

 // Debug Displays
 if (GetCVar("dvdsdebug_showtensioninformation") > 0)
 {
  if (MiscellaneousVars[181] < 7)
  {
   PrintBold(s:"Fail-Rate: ",d:TensionChargeFailRate,s:"\n",
             s:"Stamina-Per-Tic: ",d:TensionStaminaPerTic,s:"\n",
             s:"Charge-Timer: ",d:MiscellaneousVars[185],s:" / ",d:TensionChargeTimeMax,s:"\n",
             s:"ChargePulseTimer: ",d:MiscellaneousVars[189],s:"\n",
             s:"ChargeIncreaseAmount: ",d:TensionChargeAmount,s:"\n",
             s:"Timer-Count?: ",d:MiscellaneousVars[184],s:"\n",
             s:"Tension-Timer: ",d:MiscellaneousVars[183],s:"\n",
             s:"Tension-Timer-Decrease Amt: ",d:tensiontimerdecrease,s:"\n",
             s:"Cooldown-Ratio: ",d:TensionCoolDownRatio,s:"\n",
             s:"Cooldown-Timer: ",d:MiscellaneousVars[186],s:"\n",
             s:"PulseTimer: ",d:MiscellaneousVars[190],s:" / ",d:maxpulseinterval,s:"\n",
             s:"Interval1: ",d:randompulseinterval1,s:"\n",
             s:"Interval2: ",d:randompulseinterval2,s:"\n",
             s:"Interval3: ",d:randompulseinterval3,s:"\n",
             s:"Interval4: ",d:randompulseinterval4,s:"\n",
             s:"AuraXPos: ",f:SpawnFixedX,s:"\n",
             s:"AuraYPos: ",f:SpawnFixedY,s:"\n",
             s:"AuraZPos: ",f:SpawnFixedZ,s:"\n",
             s:"AuraXScale: ",f:TensionAuraXScale,s:"\n",
             s:"AuraYScale: ",f:TensionAuraYScale,s:"\n",
             s:"AuraZAlpha: ",f:TensionAuraAlpha,s:"\n",
             s:"AuraSoundTimer: ",d:MiscellaneousVars[246],s:"\n",
             s:"TensionLevel: ",d:MiscellaneousVars[181],s:"\n",
             s:"TensionLevelLastTic: ",d:MiscellaneousVars[182],s:"\n",
             s:"TensionOverchargeDmgFactor: ",d:TensionOverchargeDmgFactor,s:" / 8\n",			 
             s:"TensionOverchargeDmgBase: ",d:TensionOverchargeDmgBase,s:"\n",			 
             s:"TensionOverchargeDmgFinal: ",d:TensionOverchargeDmgFinal,s:"\n",			 
             s:"TensionOverchargeBuffer: ",d:MiscellaneousVars[250],s:" / ",d:MiscellaneousVars[262],s:" [",d:TensionOCTimer1Amount,s:"]\n",
             s:"TensionOverchargeTimeInterval: ",d:MiscellaneousVars[251],s:" / ",d:MiscellaneousVars[261],s:" [",d:TensionOCTimer2Amount,s:"]\n",
             s:"\n");
  }
  else
  {
   PrintBold(s:"Charge-Timer: ",d:MiscellaneousVars[185],s:" / ",d:TensionChargeTimeMax,s:"\n",
             s:"ChargePulseTimer: ",d:MiscellaneousVars[189],s:"\n",
             s:"ChargeIncreaseAmount: ",d:TensionChargeAmount,s:"\n",
             s:"Timer-Count?: ",d:MiscellaneousVars[184],s:"\n",
             s:"Tension-Timer: ",d:MiscellaneousVars[183],s:"\n",
             s:"Tension-Timer-Decrease Amt: ",d:tensiontimerdecrease,s:"\n",
             s:"Cooldown-Ratio: ",d:TensionCoolDownRatio,s:"\n",
             s:"Cooldown-Timer: ",d:MiscellaneousVars[186],s:"\n",
             s:"PulseTimer: ",d:MiscellaneousVars[190],s:" / ",d:maxpulseinterval,s:"\n",
             s:"Interval1: ",d:randompulseinterval1,s:"\n",
             s:"Interval2: ",d:randompulseinterval2,s:"\n",
             s:"Interval3: ",d:randompulseinterval3,s:"\n",
             s:"Interval4: ",d:randompulseinterval4,s:"\n",
             s:"AuraXPos: ",f:SpawnFixedX,s:"\n",
             s:"AuraYPos: ",f:SpawnFixedY,s:"\n",
             s:"AuraZPos: ",f:SpawnFixedZ,s:"\n",
             s:"AuraXScale: ",f:TensionAuraXScale,s:"\n",
             s:"AuraYScale: ",f:TensionAuraYScale,s:"\n",
             s:"AuraZAlpha: ",f:TensionAuraAlpha,s:"\n",
             s:"AuraSoundTimer: ",d:MiscellaneousVars[246],s:"\n",
             s:"TensionLevel: ",d:MiscellaneousVars[181],s:"\n",
             s:"TensionLevelLastTic: ",d:MiscellaneousVars[182],s:"\n",
             s:"TensionOverchargeDmgFactor: ",d:TensionOverchargeDmgFactor,s:" / 8\n",			 
             s:"TensionOverchargeDmgBase: ",d:TensionOverchargeDmgBase,s:"\n",			 
             s:"TensionOverchargeDmgFinal: ",d:TensionOverchargeDmgFinal,s:"\n",			 
             s:"TensionOverchargeBuffer: ",d:MiscellaneousVars[250],s:" / ",d:MiscellaneousVars[262],s:" [",d:TensionOCTimer1Amount,s:"]\n",
             s:"TensionOverchargeTimeInterval: ",d:MiscellaneousVars[251],s:" / ",d:MiscellaneousVars[261],s:" [",d:TensionOCTimer2Amount,s:"]\n",
             s:"\n");
  }
 }



 //********************
 //**Level Up Bonuses**
 //********************
 // REVISED: Changed If statements info a for block for the Level Items Bitfield (7/3/12)
 str LevelAttackItem;
 str LevelDefenseItem;
 str LevelSpeedItem;

 if (GetActorProperty(Player1TID,APROP_Health) > 0)
 {
  if (PlayerLevel != MiscellaneousVars[2]) // [2] is for checking Levels for level specfic boosts (so it doesn't have to run EVERY tic and lag the game too badly)
  {
   for (i = 0; i < 201; i++)
   {
    if (CharacterClass == 0)
    {
     LevelAttackItem = StrParam(s:"DeggarisAttackLevel", d:i);
     LevelDefenseItem = StrParam(s:"DeggarisDefenseLevel", d:i);
    }
    if (CharacterClass == 1)
    {
     LevelAttackItem = StrParam(s:"IlluciaAttackLevel", d:i);
     LevelDefenseItem = StrParam(s:"IlluciaDefenseLevel", d:i);
    }
    if (CharacterClass == 2)
    {
     LevelAttackItem = StrParam(s:"FloraAttackLevel", d:i);
     LevelDefenseItem = StrParam(s:"FloraDefenseLevel", d:i);
    }
	if (CharacterClass == 8)
	{
     LevelAttackItem = StrParam(s:"AilishAttackLevel", d:i);
     LevelDefenseItem = StrParam(s:"AilishDefenseLevel", d:i);
	}
    if (CharacterClass == 9)
    {
     LevelAttackItem = StrParam(s:"PetraAttackLevel", d:i);
     LevelDefenseItem = StrParam(s:"PetraDefenseLevel", d:i);
    }

    if (PlayerLevel == i)
    {
     GiveActorInventory(Player1TID, LevelAttackItem, 1);
     GiveActorInventory(Player1TID, LevelDefenseItem, 1);
    }
    else
    {
     TakeActorInventory(Player1TID, LevelAttackItem, 1);
     TakeActorInventory(Player1TID, LevelDefenseItem, 1);
    }
   }
   MiscellaneousVars[2] = PlayerLevel;
  }

  

  //*************
  //*Seed System*
  //*************
  str AGLSeedItem;
  // "MiscellaneousVars[31]" is for the number of Seeds of Agility carried by your character [Speed]
  // "MiscellaneousVars[41]" is the previous number of seeds of Agility so it doesn't have to run EVERY tic and lag the game too badly.
/*
  if (MiscellaneousVars[31] != MiscellaneousVars[41])
  {
   for (i = 0; i < 513; i++)
   {
    if (CharacterClass == 0) AGLSeedItem = StrParam(s:"DeggarisAGLSeedLVL", d:i);
    if (CharacterClass == 1) AGLSeedItem = StrParam(s:"IlluciaAGLSeedLVL", d:i);
    if (CharacterClass == 2) AGLSeedItem = StrParam(s:"FloraAGLSeedLVL", d:i);
	if (CharacterClass == 8) AGLSeedItem = StrParam(s:"AilishAGLSeedLVL", d:i);
    if (CharacterClass == 9) AGLSeedItem = StrParam(s:"PetraAGLSeedLVL", d:i);

    if (MiscellaneousVars[31] < 0) MiscellaneousVars[31] = 0;
    if (MiscellaneousVars[31] > 512) MiscellaneousVars[31] = 512;
    if (MiscellaneousVars[31] == i)
     GiveActorInventory(Player1TID, AGLSeedItem, 1);
       else
     TakeActorInventory(Player1TID, AGLSeedItem, 1);
   }
   MiscellaneousVars[41] = MiscellaneousVars[31];
  }
*/

  // REVISED: Changed If statements info a for block for the DEF Seed Bitfield (7/3/12)
  str DEFSeedItem;
  // "MiscellaneousVars[32]" is for the number of Seeds of Defense carried by your character [Overall Defense]
  // "MiscellaneousVars[42]" is the previous number of seeds of Defense so it doesn't have to run EVERY tic and lag the game too badly.
  if (MiscellaneousVars[32] != MiscellaneousVars[42])
  {
   for (i = 0; i < 513; i++)
   {
    if (CharacterClass == 0) DEFSeedItem = StrParam(s:"DeggarisDEFSeedLVL", d:i);
    if (CharacterClass == 1) DEFSeedItem = StrParam(s:"IlluciaDEFSeedLVL", d:i);
    if (CharacterClass == 2) DEFSeedItem = StrParam(s:"FloraDEFSeedLVL", d:i);
    if (CharacterClass == 8) DEFSeedItem = StrParam(s:"AilishDEFSeedLVL", d:i);
    if (CharacterClass == 9) DEFSeedItem = StrParam(s:"PetraDEFSeedLVL", d:i);

    if (MiscellaneousVars[32] < 0) MiscellaneousVars[32] = 0;
    if (MiscellaneousVars[32] > 512) MiscellaneousVars[32] = 512;
    if (MiscellaneousVars[32] == i)
     GiveActorInventory(Player1TID, DEFSeedItem, 1);
       else
     TakeActorInventory(Player1TID, DEFSeedItem, 1);
   }
   MiscellaneousVars[42] = MiscellaneousVars[32];
  }

  // "MiscellaneousVars[33]" is for the number of Seeds of Deftness carried by your character [EXP Gain]
  // "MiscellaneousVars[43]" is the previous number of seeds of Deftness so it doesn't have to run EVERY tic and lag the game too badly.
  if (MiscellaneousVars[33] != MiscellaneousVars[43])
  {
   MiscellaneousVars[40] = (MiscellaneousVars[33] * 1);
   if (MiscellaneousVars[33] < 0) MiscellaneousVars[33] = 0;
   if (MiscellaneousVars[33] > 512) MiscellaneousVars[33] = 512;
   MiscellaneousVars[43] = MiscellaneousVars[33];
  }

  // REVISED: Changed If statements info a for block for the SOR Seed Bitfield (7/3/12)
  str SORSeedItem;
  // "MiscellaneousVars[34]" is for the number of Seeds of Sorcery carried by your character [Magic Attack]
  // "MiscellaneousVars[44]" is the previous number of seeds of Sorcery so it doesn't have to run EVERY tic and lag the game too badly.
  if (MiscellaneousVars[34] != MiscellaneousVars[44])
  {
   for (i = 0; i < 513; i++)
   {
    if (CharacterClass == 0) SORSeedItem = StrParam(s:"DeggarisSORSeedLVL", d:i);
    if (CharacterClass == 1) SORSeedItem = StrParam(s:"IlluciaSORSeedLVL", d:i);
    if (CharacterClass == 2) SORSeedItem = StrParam(s:"FloraSORSeedLVL", d:i);
    if (CharacterClass == 8) SORSeedItem = StrParam(s:"AilishSORSeedLVL", d:i);
    if (CharacterClass == 9) SORSeedItem = StrParam(s:"PetraSORSeedLVL", d:i);

    if (MiscellaneousVars[34] < 0) MiscellaneousVars[34] = 0;
    if (MiscellaneousVars[34] > 512) MiscellaneousVars[34] = 512;
    if (MiscellaneousVars[34] == i)
     GiveActorInventory(Player1TID, SORSeedItem, 1);
       else
     TakeActorInventory(Player1TID, SORSeedItem, 1);
   }
   MiscellaneousVars[44] = MiscellaneousVars[34];
  }

  // REVISED: Changed If statements info a for block for the STR Seed Bitfield (7/3/12)
  str STRSeedItem;
  // "MiscellaneousVars[35]" is for the number of Seeds of Strength carried by your character [Overall Attack]
  // "MiscellaneousVars[45]" is the previous number of seeds of Strength so it doesn't have to run EVERY tic and lag the game too badly.
  if (MiscellaneousVars[35] != MiscellaneousVars[45])
  {
   for (i = 0; i < 513; i++)
   {
    if (CharacterClass == 0) STRSeedItem = StrParam(s:"DeggarisSTRSeedLVL", d:i);
    if (CharacterClass == 1) STRSeedItem = StrParam(s:"IlluciaSTRSeedLVL", d:i);
    if (CharacterClass == 2) STRSeedItem = StrParam(s:"FloraSTRSeedLVL", d:i);
    if (CharacterClass == 8) STRSeedItem = StrParam(s:"AilishSTRSeedLVL", d:i);
    if (CharacterClass == 9) STRSeedItem = StrParam(s:"PetraSTRSeedLVL", d:i);

    if (MiscellaneousVars[35] < 0) MiscellaneousVars[35] = 0;
    if (MiscellaneousVars[35] > 512) MiscellaneousVars[35] = 512;
    if (MiscellaneousVars[35] == i)
     GiveActorInventory(Player1TID, STRSeedItem, 1);
       else
     TakeActorInventory(Player1TID, STRSeedItem, 1);
   }
   MiscellaneousVars[45] = MiscellaneousVars[35];
  }

  // REVISED: Changed If statements info a for block for the THE Seed Bitfield (7/3/12)
  str THESeedItem;
  // "MiscellaneousVars[36]" is for the number of Seeds of Therapeusis carried by your character [Magic Defense]
  // "MiscellaneousVars[46]" is the previous number of seeds of Therapeusis so it doesn't have to run EVERY tic and lag the game too badly.
  if (MiscellaneousVars[36] != MiscellaneousVars[46])
  {
   for (i = 0; i < 513; i++)
   {
    if (CharacterClass == 0) THESeedItem = StrParam(s:"DeggarisTHESeedLVL", d:i);
    if (CharacterClass == 1) THESeedItem = StrParam(s:"IlluciaTHESeedLVL", d:i);
    if (CharacterClass == 2) THESeedItem = StrParam(s:"FloraTHESeedLVL", d:i);
    if (CharacterClass == 8) THESeedItem = StrParam(s:"AilishTHESeedLVL", d:i);
    if (CharacterClass == 9) THESeedItem = StrParam(s:"PetraTHESeedLVL", d:i);

    if (MiscellaneousVars[36] < 0) MiscellaneousVars[36] = 0;
    if (MiscellaneousVars[36] > 512) MiscellaneousVars[36] = 512;
    if (MiscellaneousVars[36] == i)
     GiveActorInventory(Player1TID, THESeedItem, 1);
       else
     TakeActorInventory(Player1TID, THESeedItem, 1);
   }
   MiscellaneousVars[46] = MiscellaneousVars[36];
  }
  // End of DQ-Style Seed System


  //******************************
  //*Check Hellcore Weapon Levels*
  //******************************
  str HellcoreItemName;
  // Imp's Claw
  // "MiscellaneousVars[96]" Current Imp Claw Level
  // "MiscellaneousVars[113]" Previous Imp Claw Level [prevents lag]
  if (MiscellaneousVars[96] != MiscellaneousVars[113])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"ImpClawLVL", d:i);

    if (MiscellaneousVars[96] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[96] < 1) MiscellaneousVars[96] = 1;
   if (MiscellaneousVars[96] > 8) MiscellaneousVars[96] = 8;
   MiscellaneousVars[113] = MiscellaneousVars[96];
  }

  // Dark Imp's Claw
  // "MiscellaneousVars[97]" Current Dark Imp Claw Level
  // "MiscellaneousVars[114]" Previous Dark Imp Claw Level [prevents lag]
  if (MiscellaneousVars[97] != MiscellaneousVars[114])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"DarkImpClawLVL", d:i);

    if (MiscellaneousVars[97] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[97] < 1) MiscellaneousVars[97] = 1;
   if (MiscellaneousVars[97] > 8) MiscellaneousVars[97] = 8;
   MiscellaneousVars[114] = MiscellaneousVars[97];
  }

  // Cacodemon's Eye
  // "MiscellaneousVars[98]" Current Cacodemon Eye Level
  // "MiscellaneousVars[115]" Previous Cacodemon Eye Level [prevents lag]
  if (MiscellaneousVars[98] != MiscellaneousVars[115])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"CacodemonEyeLVL", d:i);

    if (MiscellaneousVars[98] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[98] < 1) MiscellaneousVars[98] = 1;
   if (MiscellaneousVars[98] > 8) MiscellaneousVars[98] = 8;
   MiscellaneousVars[115] = MiscellaneousVars[98];
  }

  // Cacolantern's Eye
  // "MiscellaneousVars[99]" Current Cacolantern Eye Level
  // "MiscellaneousVars[116]" Previous Cacolantern Eye Level [prevents lag]
  if (MiscellaneousVars[99] != MiscellaneousVars[116])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"CacolanternEyeLVL", d:i);

    if (MiscellaneousVars[99] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[99] < 1) MiscellaneousVars[99] = 1;
   if (MiscellaneousVars[99] > 8) MiscellaneousVars[99] = 8;
   MiscellaneousVars[116] = MiscellaneousVars[99];
  }

  // Abaddon's Eye
  // "MiscellaneousVars[100]" Current Abaddon Eye Level
  // "MiscellaneousVars[117]" Previous Abaddon Eye Level [prevents lag]
  if (MiscellaneousVars[100] != MiscellaneousVars[117])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"AbaddonEyeLVL", d:i);

    if (MiscellaneousVars[100] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[100] < 1) MiscellaneousVars[100] = 1;
   if (MiscellaneousVars[100] > 8) MiscellaneousVars[100] = 8;
   MiscellaneousVars[117] = MiscellaneousVars[100];
  }

  // Hell Knight's Fist
  // "MiscellaneousVars[101]" Current Hell Knight Fist Level
  // "MiscellaneousVars[118]" Previous Hell Knight Fist Level [prevents lag]
  if (MiscellaneousVars[101] != MiscellaneousVars[118])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"KnightFistLVL", d:i);


    if (MiscellaneousVars[101] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[101] < 1) MiscellaneousVars[101] = 1;
   if (MiscellaneousVars[101] > 8) MiscellaneousVars[101] = 8;
   MiscellaneousVars[118] = MiscellaneousVars[101];
  }

  // Baron of Hell's Fist
  // "MiscellaneousVars[102]" Current Baron of Hell Fist Level
  // "MiscellaneousVars[119]" Previous Baron of Hell Fist Level [prevents lag]
  if (MiscellaneousVars[102] != MiscellaneousVars[119])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"BaronFistLVL", d:i);

    if (MiscellaneousVars[102] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[102] < 1) MiscellaneousVars[102] = 1;
   if (MiscellaneousVars[102] > 8) MiscellaneousVars[102] = 8;
   MiscellaneousVars[119] = MiscellaneousVars[102];
  }

  // Belphegor's Fist
  // "MiscellaneousVars[103]" Current Belphegor Fist Level
  // "MiscellaneousVars[120]" Previous Belphegor Fist Level [prevents lag]
  if (MiscellaneousVars[103] != MiscellaneousVars[120])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"BelphegorFistLVL", d:i);

    if (MiscellaneousVars[103] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[103] < 1) MiscellaneousVars[103] = 1;
   if (MiscellaneousVars[103] > 8) MiscellaneousVars[103] = 8;
   MiscellaneousVars[120] = MiscellaneousVars[103];
  }

  // Bruiser Demon's Fist
  // "MiscellaneousVars[104]" Current Bruiser Demon Fist Level
  // "MiscellaneousVars[121]" Previous Bruiser Demon Fist Level [prevents lag]
  if (MiscellaneousVars[104] != MiscellaneousVars[121])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"BruiserFistLVL", d:i);

    if (MiscellaneousVars[104] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[104] < 1) MiscellaneousVars[104] = 1;
   if (MiscellaneousVars[104] > 8) MiscellaneousVars[104] = 8;
   MiscellaneousVars[121] = MiscellaneousVars[104];
  }

  // Archon of Hell's Fist
  // "MiscellaneousVars[105]" Current Archon of Hell Fist Level
  // "MiscellaneousVars[122]" Previous Archon of Hell Fist Level [prevents lag]
  if (MiscellaneousVars[105] != MiscellaneousVars[122])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"ArchonFistLVL", d:i);

    if (MiscellaneousVars[105] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[105] < 1) MiscellaneousVars[105] = 1;
   if (MiscellaneousVars[105] > 8) MiscellaneousVars[105] = 8;
   MiscellaneousVars[122] = MiscellaneousVars[105];
  }

  // Pyro Demon's Fist
  // "MiscellaneousVars[106]" Current Pyro Demon Fist Level
  // "MiscellaneousVars[123]" Previous Pyro Demon Fist Level [prevents lag]
  if (MiscellaneousVars[106] != MiscellaneousVars[123])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"PyroFistLVL", d:i);

    if (MiscellaneousVars[106] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[106] < 1) MiscellaneousVars[106] = 1;
   if (MiscellaneousVars[106] > 8) MiscellaneousVars[106] = 8;
   MiscellaneousVars[123] = MiscellaneousVars[106];
  }

  // Death Incarnate's Skull
  // "MiscellaneousVars[107]" Current Death Incarnate Skull Level
  // "MiscellaneousVars[124]" Previous Death Incarnate Skull Level [prevents lag]
  if (MiscellaneousVars[107] != MiscellaneousVars[124])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"IncarnateSkullLVL", d:i);

    if (MiscellaneousVars[107] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[107] < 1) MiscellaneousVars[107] = 1;
   if (MiscellaneousVars[107] > 8) MiscellaneousVars[107] = 8;
   MiscellaneousVars[124] = MiscellaneousVars[107];
  }

  // Archvile's Hand
  // "MiscellaneousVars[108]" Current Archvile Hand Level
  // "MiscellaneousVars[125]" Previous Archvile Hand Level [prevents lag]
  if (MiscellaneousVars[108] != MiscellaneousVars[125])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"ArchvileHandLVL", d:i);

    if (MiscellaneousVars[108] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[108] < 1) MiscellaneousVars[108] = 1;
   if (MiscellaneousVars[108] > 8) MiscellaneousVars[108] = 8;
   MiscellaneousVars[125] = MiscellaneousVars[108];
  }

  // Diabloist's Hand
  // "MiscellaneousVars[109]" Current Diabloist Hand Level
  // "MiscellaneousVars[126]" Previous Diabloist Hand Level [prevents lag]
  if (MiscellaneousVars[109] != MiscellaneousVars[126])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"DiabloistHandLVL", d:i);

    if (MiscellaneousVars[109] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[109] < 1) MiscellaneousVars[109] = 1;
   if (MiscellaneousVars[109] > 8) MiscellaneousVars[109] = 8;
   MiscellaneousVars[126] = MiscellaneousVars[109];
  }

  // Flying Balrog's Fist
  // "MiscellaneousVars[110]" Current Flying Balrog Fist Level
  // "MiscellaneousVars[127]" Previous Flying Balrog Fist Level [prevents lag]
  if (MiscellaneousVars[110] != MiscellaneousVars[127])
  {
   for (i = 1; i < 9; i++)
   {
    HellcoreItemName = StrParam(s:"BalrogFistLVL", d:i);

    if (MiscellaneousVars[110] == i)
     GiveActorInventory(Player1TID, HellcoreItemName, 1);
       else
     TakeActorInventory(Player1TID, HellcoreItemName, 1);
   }
   if (MiscellaneousVars[110] < 1) MiscellaneousVars[110] = 1;
   if (MiscellaneousVars[110] > 8) MiscellaneousVars[110] = 8;
   MiscellaneousVars[127] = MiscellaneousVars[110];
  }

  // Hades Elemental's Eye [?]
  // Hades Overlord's Eye [?]
  // End of Checking Hellcore Weapon Levels
 }
 else
 {
  MiscellaneousVars[2] = 0; // Reset Level Check
  MiscellaneousVars[41] = 0; // Reset Agility Check
  MiscellaneousVars[42] = 0;
  MiscellaneousVars[43] = 0;
  MiscellaneousVars[44] = 0;
  MiscellaneousVars[45] = 0;
  MiscellaneousVars[46] = 0;
  MiscellaneousVars[113] = 0;
  MiscellaneousVars[114] = 0;
  MiscellaneousVars[115] = 0;
  MiscellaneousVars[116] = 0;
  MiscellaneousVars[117] = 0;
  MiscellaneousVars[118] = 0;
  MiscellaneousVars[119] = 0;
  MiscellaneousVars[120] = 0;
  MiscellaneousVars[121] = 0;
  MiscellaneousVars[122] = 0;
  MiscellaneousVars[123] = 0;
  MiscellaneousVars[124] = 0;
  MiscellaneousVars[125] = 0;
  MiscellaneousVars[126] = 0;
  MiscellaneousVars[127] = 0;
 }


 //************************************************************************************************
 //*Calculates Friction [Ice/Mud] so Safe Tea Shoes can properly adjust for slowdown/slipperiness?*
 //************************************************************************************************
 MiscellaneousVars[399] = GetActorProperty(Player1TID,APROP_Friction);
 //PrintBold(f:PlayerFriction);



 //***************************
 //*Calculate Jumping Heights*
 //***************************
 // "65" is the main storage value for a character's JumpZ height.
 if (CharacterClass == 0) MiscellaneousVars[65] = FixedMul(5.0, 1.5); // Deggaris (7.50)
 else if (CharacterClass == 1) MiscellaneousVars[65] = FixedMul(5.0, 1.7); // Illucia (8.50)
 else if (CharacterClass == 2) MiscellaneousVars[65] = FixedMul(5.0, 1.8); // Flora (9.00)
 else if (CharacterClass == 8) MiscellaneousVars[65] = FixedMul(5.0, 1.4); // Ailish (Yet to decide.  Will change later)
 else if (CharacterClass == 9) MiscellaneousVars[65] = FixedMul(5.0, 1.9); // Petra (10.00)
 else MiscellaneousVars[65] = FixedMul(5.0, 1.6); // Other (8.00)

 // "66" is storage for the level-based multiplier for JumpZ height.
 if (CharacterClass == 0) MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00226) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 1) MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00256) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 2) MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00276) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 8) MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00216) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 9) MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00296) + FixedMul(1.00, 1.00);
 else MiscellaneousVars[66] = FixedMul((PlayerLevel << 16), 0.00246) + FixedMul(1.00, 1.00);
 // PrintBold(f:MiscellaneousVars[66]);

 // "67" is storage for the AGLSeed-based multiplier for JumpZ height.
 if (CharacterClass == 0) MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00076) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 1) MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00086) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 2) MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00093) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 8) MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00070) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 9) MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00100) + FixedMul(1.00, 1.00);
 else MiscellaneousVars[67] = FixedMul((MiscellaneousVars[31] << 16), 0.00083) + FixedMul(1.00, 1.00);
 // PrintBold(f:MiscellaneousVars[67]);

 // "68" is storage for bonuses/penalities from armor or other items for JumpZ height.
 MiscellaneousVars[68] = FixedMul(1.00, 1.00);
 if (CharacterClass == 2) 
 {
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.10); }		// +10%
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.005); }		// +0.5%
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.005); }	// +0.5%
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.0125); }	// +1.25%
  if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.025); }		// +2.5%
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.0125); }	// +1.25%
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.025); }			// +2.5%
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) {MiscellaneousVars[68] =  MiscellaneousVars[68] + FixedMul(1.00, 0.00625); }		// +0.625%
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.0125); }		// +1.25%
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.05); }		// +5%
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.0375); }	// +3.75%
 }
 else
 {
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.033); }	// -3.3%
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }		// -5%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.067); }	// -6.7%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.09); }	// -9%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.083); }	// -8.3%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.095); }	// -9.5%
 }
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.10); }		// -10%
 if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }		// -5%
 if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }	// -5%
 if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }	// -5%
 if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }	// -5%
 if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.05); }	// -5%
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.25); }			// +25%

 // Buffs = +25% Jumping Height
 if (PowerupTimer[12] > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] + FixedMul(1.00, 0.25); }			// Acceleratle +25%
 if (PowerupTimer[15] > 0) { MiscellaneousVars[68] = MiscellaneousVars[68] - FixedMul(1.00, 0.25); }			// Deceleratle -25%

 // "69" is storage for Sceptre for JumpZ height.
 MiscellaneousVars[69] = FixedMul(1.00, 1.00);
 if (MiscellaneousVars[397] == 1) { MiscellaneousVars[69] = MiscellaneousVars[69] - FixedMul(1.00, 0.20); }		// -20%
 if (MiscellaneousVars[397] == 2) { MiscellaneousVars[69] = MiscellaneousVars[69] - FixedMul(1.00, 0.10); }		// -10%
 if (MiscellaneousVars[397] == 3) { MiscellaneousVars[69] = MiscellaneousVars[69] - FixedMul(1.00, 0.05); }		// -5%
 // PrintBold(f:MiscellaneousVars[69]);

 // Multiply all the jumpz properties
 MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],MiscellaneousVars[66]);
 MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],MiscellaneousVars[67]);
 MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],MiscellaneousVars[68]);
 MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],MiscellaneousVars[69]);

 // JumpMore perks
 int PerkFactorF = 0.0;
 PerkFactorF = ((MiscellaneousVars[10009] * 0.05) + (MiscellaneousVars[10010] * 0.125)) + 1.0;
 MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],PerkFactorF);

 // Stamina Perks
 int StaminaJump = 1.00;
 StaminaPercentFull = MiscellaneousVars[21] * 10000 / MiscellaneousVars[22];
 if (GetCVar("dvds_staminaaffectsspeed") > 0)
 {
  if (StaminaPercentFull < 157) StaminaJump = 0.6625;
  if (StaminaPercentFull > 156 && StaminaPercentFull < 626) StaminaJump = 0.7375;
  if (StaminaPercentFull > 625 && StaminaPercentFull < 1251) StaminaJump = 0.805;
  if (StaminaPercentFull > 1250 && StaminaPercentFull < 2501) StaminaJump = 0.865;
  if (StaminaPercentFull > 2500 && StaminaPercentFull < 5001) StaminaJump = 0.9175;
  if (StaminaPercentFull > 5000 && StaminaPercentFull < 7501) StaminaJump = 0.9625;
  if (StaminaPercentFull > 7500 && StaminaPercentFull < 12501) StaminaJump = 1.00;
  if (StaminaPercentFull > 12500 && StaminaPercentFull < 20001) StaminaJump = 1.0375;
  if (StaminaPercentFull > 20000 && StaminaPercentFull < 27501) StaminaJump = 1.0825;
  if (StaminaPercentFull > 27500 && StaminaPercentFull < 35001) StaminaJump = 1.135;
  if (StaminaPercentFull > 35000 && StaminaPercentFull < 42501) StaminaJump = 1.195;
  if (StaminaPercentFull > 42500 && StaminaPercentFull < 48751) StaminaJump = 1.2625;
  if (StaminaPercentFull > 48750) StaminaJump = 1.3375;
  MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],StaminaJump);
 }

 if (CheckActorInventory(Player1TID,"FistPlayerSpeedFactor") > 0) { MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],0.75); }
 if (CheckActorInventory(Player1TID,"FistPlayerSpeedFactor2") > 0) { MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],0.825); }
 if (CheckActorInventory(Player1TID,"FistPlayerSpeedFactor3") > 0) { MiscellaneousVars[65] = FixedMul(MiscellaneousVars[65],0.90); }
 
 SetActorProperty (Player1TID, APROP_JumpZ, MiscellaneousVars[65]);
 // Convert JumpZ to Player's Jump Height
 MiscellaneousVars[200] = (FixedMul(MiscellaneousVars[65],MiscellaneousVars[65]) / 2);
 MiscellaneousVars[200] = MiscellaneousVars[200] >> 16;
 MiscellaneousVars[200] += 24;
 if (PowerupTimer[7] > 0) MiscellaneousVars[200] = MiscellaneousVars[200] * 4;

 //*************
 //*Air Control*
 //*************
 int AirControlBase = 0.2375;
 if (CharacterClass == 0) AirControlBase = 0.2375;
 if (CharacterClass == 1) AirControlBase = 0.2500;
 if (CharacterClass == 2) AirControlBase = 0.2625;
 if (CharacterClass == 8) AirControlBase = 0.2375;
 if (CharacterClass == 9) AirControlBase = 0.275;

 // level-based multiplier
 int AirControlFactor1 = FixedMul(1.00, 1.00);
 if (CharacterClass == 0) AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00113) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 1) AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00128) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 2) AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00138) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 8) AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00108) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 9) AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00148) + FixedMul(1.00, 1.00);
 else AirControlFactor1 = FixedMul((PlayerLevel << 16), 0.00123) + FixedMul(1.00, 1.00);

 // AGLSeed-based multiplier
 int AirControlFactor2 = FixedMul(1.00, 1.00);
 if (CharacterClass == 0) AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.00038) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 1) AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.00043) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 2) AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.000415) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 8) AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.000375) + FixedMul(1.00, 1.00);
 else if (CharacterClass == 9) AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.000400) + FixedMul(1.00, 1.00);
 else AirControlFactor2 = FixedMul((MiscellaneousVars[31] << 16), 0.000415) + FixedMul(1.00, 1.00);

 // Armor items
 int AirControlFactor3 = FixedMul(1.00, 1.00);
 if (CharacterClass == 2) 
 {
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.20); }				// +30%
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0125); }			// +1.25%
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0125); }		// +1.25%
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0375); }		// +3.75%
  if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.20); }    		// +20%
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.025); }			// +2.5%
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0375); }				// +3.75%
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.05); }				// +5.0%
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0125); }				// +1.25%
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.0375); }				// +3.75%
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.05); }		// +5.0%
 }
 else
 {
  if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.067); }		// -6.7%
  if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.010); }		// -10%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.134); }		// -13.4%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.18); }		// -18%
  if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.167); }		// -16.7%
  if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.190); }	// -19.0%
 }
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.15); }				// -15%
 if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.10); }			// -10%
 if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.10); }	// -10%
 if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.10); }		// -10%
 if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.10); }	// -10%
 if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) { AirControlFactor3 = AirControlFactor3 - FixedMul(1.00, 0.10); }		// -10%
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) { AirControlFactor3 = AirControlFactor3 + FixedMul(1.00, 0.20); }				// +20%

 // Buffs
 int AirControlFactor4 = FixedMul(1.00, 1.00);
 if (PowerupTimer[12] > 0) { AirControlFactor4 = AirControlFactor4 + FixedMul(1.00, 0.25); }		// Acceleratle +25%
 if (PowerupTimer[15] > 0) { AirControlFactor4 = AirControlFactor4 - FixedMul(1.00, 0.25); }		// Deceleratle -25%

 // Sceptre for JumpZ height.
 int AirControlFactor5 = FixedMul(1.00, 1.00);
 if (MiscellaneousVars[397] == 1) { AirControlFactor5 = AirControlFactor5 - FixedMul(1.00, 0.20); }			// -20%
 if (MiscellaneousVars[397] == 2) { AirControlFactor5 = AirControlFactor5 - FixedMul(1.00, 0.10); }			// -10%
 if (MiscellaneousVars[397] == 3) { AirControlFactor5 = AirControlFactor5 - FixedMul(1.00, 0.05); }			// -5%

 MiscellaneousVars[400] = FixedMul(1.00, 1.00);
 MiscellaneousVars[400] = AirControlBase;
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],AirControlFactor1);
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],AirControlFactor2);
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],AirControlFactor3);
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],AirControlFactor4);
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],AirControlFactor5);

 // JumpMore perks
 PerkFactorF = 0.0;
 PerkFactorF = ((MiscellaneousVars[10009] * 0.05) + (MiscellaneousVars[10010] * 0.125)) + 1.0;
 MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],PerkFactorF);

 // Dashing :P
 if (MiscellaneousVars[166] > 0) MiscellaneousVars[400] = FixedMul(MiscellaneousVars[400],0.015625);

 // Final Calculations
 if (MiscellaneousVars[400] > 1.0) MiscellaneousVars[400] = 1.0;
 SetAirControl(MiscellaneousVars[400]);
 


 //************************************************************************
 //***Determines Maximum Ammo Ammounts Based on Strength Seeds and Level***
 //************************************************************************
 // "80" is the number of backpacks grabbed.
 // "81" is storage for the current Clip maximum. 						// 1 STRSeed = 5 Bullets, 1 STRLevel = 10 Bullets [(Base) + 2560 + 2000 = 4560+]
 // "82" is storage for the current Shell maximum. 						// 1 STRSeed = 2 Shells, 1 STRLevel = 4 Shells [(Base) + 1024 + 800 = 1824+]
 // "83" is storage for the current Rocket maximum. 					// 1 STRSeed = 1 Rocket, 1 STRLevel = 2 Rockets [(Base) + 512 + 400 = 912+]
 // "84" is storage for the current Cell maximum. 						// 1 STRSeed = 20 Cells, 1 STRLevel = 40 Cells [(Base) + 10240 + 8000 = 18240+]
 // "85" is storage for the current DiarisArrow maximum. 				// 1 STRSeed = 3 Arrows, 1 STRLevel = 6 Arrows [(Base) + 1536 + 1200 = 2736+]
 // "281" is storage for the current GoldWandAmmo maximum.				// 1 STRSeed = 5 GoldWandAmmo, 1 STRLevel = 10 GoldWandAmmo [(Base) + 2560 + 2000 = 4560+]
 // "282" is storage for the current CrossbowAmmo maximum.				// 1 STRSeed = 2 CrossbowAmmo, 1 STRLevel = 4 CrossbowAmmo [(Base) + 1024 + 800 = 1824+]
 // "283" is storage for the current BlasterAmmo maximum.				// 1 STRSeed = 5 BlasterAmmo, 1 STRLevel = 10 BlasterAmmo [(Base) + 2560 + 2000 = 4560+]
 // "284" is storage for the current PhoenixRodAmmo maximum. 			// 1 STRSeed = 1 PheonixRodAmmo, 1 STRLevel = 2 PheonixRodAmmo [(Base) + 512 + 400 = 912+]
 // "285" is storage for the current SkullRodAmmo maximum.				// 1 STRSeed = 10 SkullRodAmmo, 1 STRLevel = 20 SkullRodAmmo [(Base) + 5120 + 4000 = 9120+]
 // "286" is storage for the current MaceAmmo maximum.					// 1 STRSeed = 10 MaceAmmo, 1 STRLevel = 20 MaceAmmo [(Base) + 5120 + 4000 = 9120+]
 // "321" is storage for the current ElectricBolts maximum.				// 1 STRSeed = 10 ElectricBolts, 1 STRLevel = 20 ElectricBolts
 // "322" is storage for the current PoisonBolts maximum.				// 1 STRSeed = 5 PoisonBolts, 1 STRLevel = 10 PoisonBolts
 // "323" is storage for the current ClipOfBullets maximum.				// 1 STRSeed = 5 ClipOfBullets, 1 STRLevel = 10 ClipOfBullets
 // "324" is storage for the current MiniMissiles maximum.				// 1 STRSeed = 2 MiniMissiles, 1 STRLevel = 4 MiniMissiles
 // "325" is storage for the current EnergyPod maximum.					// 1 STRSeed = 10 EnergyPod, 1 STRLevel = 20 EnergyPod
 // "326" is storage for the current HEGrenadeRounds maximum.			// 1 STRSeed = 3 HEGrenadeRounds, 1 STRLevel = 6 HEGrenadeRounds
 // "327" is storage for the current PhosphorusGrenadeRounds maximum.	// 1 STRSeed = 2 PhosphorusGrenadeRounds, 1 STRLevel = 4 PhosphorusGrenadeRounds

 // "91" is storage for the ultimate Clip maximum.
 // "92" is storage for the ultimate Shell maximum.
 // "93" is storage for the ultimate Rocket maximum.
 // "94" is storage for the ultimate Cell maximum.
 // "95" is storage for the ultimate DiarisArrow maximum.
 // "291" is storage for the ultimate GoldWandAmmo maximum.
 // "292" is storage for the ultimate CrossbowAmmo maximum.
 // "293" is storage for the ultimate BlasterAmmo maximum.
 // "294" is storage for the ultimate PhoenixRodAmmo maximum.
 // "295" is storage for the ultimate SkullRodAmmo maximum.
 // "296" is storage for the ultimate MaceAmmo maximum.
 // "331" is storage for the ultimate ElectricBolts maximum.
 // "332" is storage for the ultimate PoisonBolts maximum.
 // "333" is storage for the ultimate ClipOfBullets maximum.
 // "334" is storage for the ultimate MiniMissiles maximum.
 // "335" is storage for the ultimate EnergyPod maximum.
 // "336" is storage for the ultimate HEGrenadeRounds maximum.
 // "337" is storage for the ultimate PhosphorusGrenadeRounds maximum.


 if (CharacterClass == 0) // Deggaris
 {
  MiscellaneousVars[91] = 500 + (MiscellaneousVars[35] * 5) + (PlayerLevel * 10); // Clip/Bullets
  MiscellaneousVars[92] = 140 + (MiscellaneousVars[35] * 2) + (PlayerLevel * 4); // Shells
  MiscellaneousVars[93] = 120 + (MiscellaneousVars[35] * 1) + (PlayerLevel * 2); // Rockets
  MiscellaneousVars[94] = 750 + (MiscellaneousVars[35] * 20) + (PlayerLevel * 40); // Cells
  MiscellaneousVars[95] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // DiarisArrows
  MiscellaneousVars[338] = 75 + (MiscellaneousVars[35] * 5 / 2) + (PlayerLevel * 5); // Rifle Ammo

  MiscellaneousVars[81] = 250 + (MiscellaneousVars[80] * 100);
  MiscellaneousVars[82] = 70 + (MiscellaneousVars[80] * 25);
  MiscellaneousVars[83] = 60 + (MiscellaneousVars[80] * 25);
  MiscellaneousVars[84] = 375 + (MiscellaneousVars[80] * 150);
  MiscellaneousVars[85] = 0 + (MiscellaneousVars[80] * 15);
  MiscellaneousVars[328] = 75 + (MiscellaneousVars[80] * 2);
 }

 if (CharacterClass == 1) // Illucia
 {
  MiscellaneousVars[91] = 300 + (MiscellaneousVars[35] * 15 / 4) + (PlayerLevel * 15 / 2); // Clip/Bullets
  MiscellaneousVars[92] = 90 + (MiscellaneousVars[35] * 3 / 2) + (PlayerLevel * 3); // Shells
  MiscellaneousVars[93] = 70 + (MiscellaneousVars[35] * 3 / 4) + (PlayerLevel * 3 / 2); // Rockets
  MiscellaneousVars[94] = 500 + (MiscellaneousVars[35] * 15) + (PlayerLevel * 30); // Cells
  MiscellaneousVars[95] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // DiarisArrows
  MiscellaneousVars[338] = 60 + (MiscellaneousVars[35] * 2) + (PlayerLevel * 4); // Rifle Ammo

  MiscellaneousVars[81] = 175 + (MiscellaneousVars[80] * 100);
  MiscellaneousVars[82] = 45 + (MiscellaneousVars[80] * 25);
  MiscellaneousVars[83] = 35 + (MiscellaneousVars[80] * 25);
  MiscellaneousVars[84] = 250 + (MiscellaneousVars[80] * 150);
  MiscellaneousVars[85] = 0 + (MiscellaneousVars[80] * 15);
  MiscellaneousVars[328] = 60 + (MiscellaneousVars[80] * 2);
 }

 if (CharacterClass == 2) // Flora
 {
  if (CheckActorInventory(Player1TID,"FloraLearnedPistols") > 0)
  {
   MiscellaneousVars[91] = 200 + (MiscellaneousVars[35] * 5 / 2) + (PlayerLevel * 5); // Clip/Bullets
  }
  else
  {
   MiscellaneousVars[91] = 0; // Clip/Bullets
  }
  MiscellaneousVars[92] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // Shells
  MiscellaneousVars[93] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // Rockets
  MiscellaneousVars[94] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // Cells
  MiscellaneousVars[95] = 30 + (MiscellaneousVars[35] * 3) + (PlayerLevel * 6); // DiarisArrows
  MiscellaneousVars[291] = 200 + (MiscellaneousVars[35] * 5) + (PlayerLevel * 10); // GoldWandAmmo
  MiscellaneousVars[292] = 100 + (MiscellaneousVars[35] * 2) + (PlayerLevel * 4); // CrossbowAmmo
  MiscellaneousVars[293] = 400 + (MiscellaneousVars[35] * 5) + (PlayerLevel * 10); // BlasterAmmo
  MiscellaneousVars[294] = 40 + (MiscellaneousVars[35] * 1) + (PlayerLevel * 2); // PhoenixRodAmmo
  MiscellaneousVars[295] = 400 + (MiscellaneousVars[35] * 10) + (PlayerLevel * 20); // SkullRodAmmo
  MiscellaneousVars[296] = 300 + (MiscellaneousVars[35] * 10) + (PlayerLevel * 20); // MaceAmmo
  MiscellaneousVars[331] = 100 + (MiscellaneousVars[35] * 10) + (PlayerLevel * 20); // ElectricBolts
  MiscellaneousVars[332] = 50 + (MiscellaneousVars[35] * 5) + (PlayerLevel * 10); // PoisonBolts
  MiscellaneousVars[333] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // ClipOfBullets
  MiscellaneousVars[334] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // MiniMissiles
  MiscellaneousVars[335] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // EnergyPod
  MiscellaneousVars[336] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // HEGrenadeRounds
  MiscellaneousVars[337] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // PhosphorusGrenadeRounds
  MiscellaneousVars[338] = 0 + (MiscellaneousVars[35] * 0) + (PlayerLevel * 0); // RifleAmmo
  
  if (ClassicDoomType == 3) // Hexen has no backpack item so in Hexen her max ammo is solely determined on her Strength stat and her level.
  {
   MiscellaneousVars[81] = MiscellaneousVars[91];
   MiscellaneousVars[82] = MiscellaneousVars[92];
   MiscellaneousVars[83] = MiscellaneousVars[93];
   MiscellaneousVars[84] = MiscellaneousVars[94];
   MiscellaneousVars[85] = MiscellaneousVars[95];
   MiscellaneousVars[281] = MiscellaneousVars[291];
   MiscellaneousVars[282] = MiscellaneousVars[292];
   MiscellaneousVars[283] = MiscellaneousVars[293];
   MiscellaneousVars[284] = MiscellaneousVars[294];
   MiscellaneousVars[285] = MiscellaneousVars[295];
   MiscellaneousVars[286] = MiscellaneousVars[296];
   MiscellaneousVars[321] = MiscellaneousVars[331];
   MiscellaneousVars[322] = MiscellaneousVars[332];
   MiscellaneousVars[323] = MiscellaneousVars[333];
   MiscellaneousVars[324] = MiscellaneousVars[334];
   MiscellaneousVars[325] = MiscellaneousVars[335];
   MiscellaneousVars[326] = MiscellaneousVars[336];
   MiscellaneousVars[327] = MiscellaneousVars[337];
   MiscellaneousVars[328] = MiscellaneousVars[338];
  }
  else
  {
   MiscellaneousVars[81] = 100 + (MiscellaneousVars[80] * 100);
   MiscellaneousVars[82] = 0 + (MiscellaneousVars[80] * 25);
   MiscellaneousVars[83] = 0 + (MiscellaneousVars[80] * 25);
   MiscellaneousVars[84] = 0 + (MiscellaneousVars[80] * 150);
   MiscellaneousVars[85] = 15 + (MiscellaneousVars[80] * 15);
   MiscellaneousVars[281] = 100 + (MiscellaneousVars[80] * 40);
   MiscellaneousVars[282] = 50 + (MiscellaneousVars[80] * 20);
   MiscellaneousVars[283] = 200 + (MiscellaneousVars[80] * 50);
   MiscellaneousVars[284] = 20 + (MiscellaneousVars[80] * 5);
   MiscellaneousVars[285] = 200 + (MiscellaneousVars[80] * 50);
   MiscellaneousVars[286] = 150 + (MiscellaneousVars[80] * 38);
   MiscellaneousVars[321] = 50 + (MiscellaneousVars[80] * 16);
   MiscellaneousVars[322] = 25 + (MiscellaneousVars[80] * 8);
   MiscellaneousVars[323] = 0 + (MiscellaneousVars[80] * 0);
   MiscellaneousVars[324] = 0 + (MiscellaneousVars[80] * 0);
   MiscellaneousVars[325] = 0 + (MiscellaneousVars[80] * 0);
   MiscellaneousVars[326] = 0 + (MiscellaneousVars[80] * 0);
   MiscellaneousVars[327] = 0 + (MiscellaneousVars[80] * 0);
   MiscellaneousVars[328] = 0 + (MiscellaneousVars[80] * 0);
  }
 }
 
 if (MiscellaneousVars[81] > MiscellaneousVars[91]) MiscellaneousVars[81] = MiscellaneousVars[91];
 if (MiscellaneousVars[82] > MiscellaneousVars[92]) MiscellaneousVars[82] = MiscellaneousVars[92];
 if (MiscellaneousVars[83] > MiscellaneousVars[93]) MiscellaneousVars[83] = MiscellaneousVars[93];
 if (MiscellaneousVars[84] > MiscellaneousVars[94]) MiscellaneousVars[84] = MiscellaneousVars[94];
 if (MiscellaneousVars[85] > MiscellaneousVars[95]) MiscellaneousVars[85] = MiscellaneousVars[95];
 if (MiscellaneousVars[281] > MiscellaneousVars[291]) MiscellaneousVars[281] = MiscellaneousVars[291];
 if (MiscellaneousVars[282] > MiscellaneousVars[292]) MiscellaneousVars[282] = MiscellaneousVars[292];
 if (MiscellaneousVars[283] > MiscellaneousVars[293]) MiscellaneousVars[283] = MiscellaneousVars[293];
 if (MiscellaneousVars[284] > MiscellaneousVars[294]) MiscellaneousVars[284] = MiscellaneousVars[294];
 if (MiscellaneousVars[285] > MiscellaneousVars[295]) MiscellaneousVars[285] = MiscellaneousVars[295];
 if (MiscellaneousVars[286] > MiscellaneousVars[296]) MiscellaneousVars[286] = MiscellaneousVars[296];
 if (MiscellaneousVars[321] > MiscellaneousVars[331]) MiscellaneousVars[321] = MiscellaneousVars[331];
 if (MiscellaneousVars[322] > MiscellaneousVars[332]) MiscellaneousVars[322] = MiscellaneousVars[332];
 if (MiscellaneousVars[323] > MiscellaneousVars[333]) MiscellaneousVars[323] = MiscellaneousVars[333];
 if (MiscellaneousVars[324] > MiscellaneousVars[334]) MiscellaneousVars[324] = MiscellaneousVars[334];
 if (MiscellaneousVars[325] > MiscellaneousVars[335]) MiscellaneousVars[325] = MiscellaneousVars[335];
 if (MiscellaneousVars[326] > MiscellaneousVars[336]) MiscellaneousVars[326] = MiscellaneousVars[336];
 if (MiscellaneousVars[327] > MiscellaneousVars[337]) MiscellaneousVars[327] = MiscellaneousVars[337];
 if (MiscellaneousVars[328] > MiscellaneousVars[338]) MiscellaneousVars[328] = MiscellaneousVars[338];
 
 SetActivator(Player1TID); // Set to Player's ID
 SetAmmoCapacity("Clip", MiscellaneousVars[81]);
 SetAmmoCapacity("Shell", MiscellaneousVars[82]);
 SetAmmoCapacity("RocketAmmo", MiscellaneousVars[83]);
 SetAmmoCapacity("Cell", MiscellaneousVars[84]);
 SetAmmoCapacity("DiarisArrow", MiscellaneousVars[85]);
 SetAmmoCapacity("GoldWandAmmo", MiscellaneousVars[281]);
 SetAmmoCapacity("CrossbowAmmo", MiscellaneousVars[282]);
 SetAmmoCapacity("BlasterAmmo", MiscellaneousVars[283]);
 SetAmmoCapacity("PhoenixRodAmmo", MiscellaneousVars[284]);
 SetAmmoCapacity("SkullRodAmmo", MiscellaneousVars[285]);
 SetAmmoCapacity("MaceAmmo", MiscellaneousVars[286]);
 SetAmmoCapacity("ElectricBolts", MiscellaneousVars[321]);
 SetAmmoCapacity("PoisonBolts", MiscellaneousVars[322]);
 SetAmmoCapacity("ClipOfBullets", MiscellaneousVars[323]);
 SetAmmoCapacity("MiniMissiles", MiscellaneousVars[324]);
 SetAmmoCapacity("EnergyPod", MiscellaneousVars[325]);
 SetAmmoCapacity("HEGrenadeRounds", MiscellaneousVars[326]);
 SetAmmoCapacity("PhosphorusGrenadeRounds", MiscellaneousVars[327]);
 SetAmmoCapacity("RifleAmmo", MiscellaneousVars[328]);
 
 SetActivator(0); // Set back to worldly activator

 if (CheckActorInventory(Player1TID,"Clip") > MiscellaneousVars[81]) TakeActorInventory(Player1TID,"Clip", (CheckActorInventory(Player1TID,"Clip") - MiscellaneousVars[81]) ); 
 if (CheckActorInventory(Player1TID,"Shell") > MiscellaneousVars[82]) TakeActorInventory(Player1TID,"Shell", (CheckActorInventory(Player1TID,"Shell") - MiscellaneousVars[82]) ); 
 if (CheckActorInventory(Player1TID,"RocketAmmo") > MiscellaneousVars[83]) TakeActorInventory(Player1TID,"RocketAmmo", (CheckActorInventory(Player1TID,"RocketAmmo") - MiscellaneousVars[83]) ); 
 if (CheckActorInventory(Player1TID,"Cell") > MiscellaneousVars[84]) TakeActorInventory(Player1TID,"Cell", (CheckActorInventory(Player1TID,"Cell") - MiscellaneousVars[84]) ); 
 if (CheckActorInventory(Player1TID,"DiarisArrow") > MiscellaneousVars[85]) TakeActorInventory(Player1TID,"DiarisArrow", (CheckActorInventory(Player1TID,"DiarisArrow") - MiscellaneousVars[85]) ); 
 if (CheckActorInventory(Player1TID,"GoldWandAmmo") > MiscellaneousVars[281]) TakeActorInventory(Player1TID,"GoldWandAmmo", (CheckActorInventory(Player1TID,"GoldWandAmmo") - MiscellaneousVars[281]) ); 
 if (CheckActorInventory(Player1TID,"CrossbowAmmo") > MiscellaneousVars[282]) TakeActorInventory(Player1TID,"CrossbowAmmo", (CheckActorInventory(Player1TID,"CrossbowAmmo") - MiscellaneousVars[282]) ); 
 if (CheckActorInventory(Player1TID,"BlasterAmmo") > MiscellaneousVars[283]) TakeActorInventory(Player1TID,"BlasterAmmo", (CheckActorInventory(Player1TID,"BlasterAmmo") - MiscellaneousVars[283]) ); 
 if (CheckActorInventory(Player1TID,"PhoenixRodAmmo") > MiscellaneousVars[284]) TakeActorInventory(Player1TID,"PhoenixRodAmmo", (CheckActorInventory(Player1TID,"PhoenixRodAmmo") - MiscellaneousVars[284]) ); 
 if (CheckActorInventory(Player1TID,"SkullRodAmmo") > MiscellaneousVars[285]) TakeActorInventory(Player1TID,"SkullRodAmmo", (CheckActorInventory(Player1TID,"SkullRodAmmo") - MiscellaneousVars[285]) ); 
 if (CheckActorInventory(Player1TID,"MaceAmmo") > MiscellaneousVars[286]) TakeActorInventory(Player1TID,"MaceAmmo", (CheckActorInventory(Player1TID,"MaceAmmo") - MiscellaneousVars[286]) ); 
 if (CheckActorInventory(Player1TID,"ElectricBolts") > MiscellaneousVars[321]) TakeActorInventory(Player1TID,"ElectricBolts", (CheckActorInventory(Player1TID,"ElectricBolts") - MiscellaneousVars[321]) ); 
 if (CheckActorInventory(Player1TID,"PoisonBolts") > MiscellaneousVars[322]) TakeActorInventory(Player1TID,"PoisonBolts", (CheckActorInventory(Player1TID,"PoisonBolts") - MiscellaneousVars[322]) ); 
 if (CheckActorInventory(Player1TID,"ClipOfBullets") > MiscellaneousVars[323]) TakeActorInventory(Player1TID,"ClipOfBullets", (CheckActorInventory(Player1TID,"ClipOfBullets") - MiscellaneousVars[323]) ); 
 if (CheckActorInventory(Player1TID,"MiniMissiles") > MiscellaneousVars[324]) TakeActorInventory(Player1TID,"MiniMissiles", (CheckActorInventory(Player1TID,"MiniMissiles") - MiscellaneousVars[324]) ); 
 if (CheckActorInventory(Player1TID,"EnergyPod") > MiscellaneousVars[325]) TakeActorInventory(Player1TID,"EnergyPod", (CheckActorInventory(Player1TID,"EnergyPod") - MiscellaneousVars[325]) ); 
 if (CheckActorInventory(Player1TID,"HEGrenadeRounds") > MiscellaneousVars[326]) TakeActorInventory(Player1TID,"HEGrenadeRounds", (CheckActorInventory(Player1TID,"HEGrenadeRounds") - MiscellaneousVars[326]) ); 
 if (CheckActorInventory(Player1TID,"PhosphorusGrenadeRounds") > MiscellaneousVars[327]) TakeActorInventory(Player1TID,"PhosphorusGrenadeRounds", (CheckActorInventory(Player1TID,"PhosphorusGrenadeRounds") - MiscellaneousVars[327]) ); 
 if (CheckActorInventory(Player1TID,"RifleAmmo") > MiscellaneousVars[328]) TakeActorInventory(Player1TID,"RifleAmmo", (CheckActorInventory(Player1TID,"RifleAmmo") - MiscellaneousVars[328]) ); 
 
 //***************************
 //***Check DVII Game Flags***
 //***************************

 if (CharacterClass == 2 && ModType == 2)
 {
  if (GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) != 0) KilledMonsterFactor = GetLevelInfo(LEVELINFO_KILLED_MONSTERS) * 1000 / GetLevelInfo(LEVELINFO_TOTAL_MONSTERS);

  // Checks for all secrets found in order to spawn Safe Tea Shoes in MAP01
  if (SpecialGameFlags[0] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1201 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = 1744 * 65536; SpawnFixedY = -724 * 65536; SpawnFixedZ = 16 * 65536;
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("SafeTeaShoes",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[0] = 1;
  }

  // Checks for all secrets found in order to spawn Pearly Corset in MAP02
  if (SpecialGameFlags[1] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1202 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = 1440 * 65536; SpawnFixedY = 160 * 65536; SpawnFixedZ = 112 * 65536;
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("PearlyCorset",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[1] = 1;
  }

  // Checks for all secrets found in order to spawn Water Flying Dress in MAP03
  if (SpecialGameFlags[2] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1203 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS)) 
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = -6592 * 65536; SpawnFixedY = 4416 * 65536; SpawnFixedZ = 24 * 65536;
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("WaterFlyingDress",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[2] = 1;
  }

  // Checks for all secrets found in order to spawn Evenstar Necklace in MAP04
  if (SpecialGameFlags[3] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1204 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   Randomizer1 = random(1,4);
   if (Randomizer1 == 1) { SpawnFixedX = -2752 * 65536; SpawnFixedY = 3872 * 65536; SpawnFixedZ = 16 * 65536; } // -2752,3872,0 coords
   if (Randomizer1 == 2) { SpawnFixedX = -2560 * 65536; SpawnFixedY = 4064 * 65536; SpawnFixedZ = 16 * 65536; } // -2560,4064,0 coords
   if (Randomizer1 == 3) { SpawnFixedX = -2752 * 65536; SpawnFixedY = 4256 * 65536; SpawnFixedZ = 16 * 65536; } // -2752,4256,0 coords
   if (Randomizer1 == 4) { SpawnFixedX = -2944 * 65536; SpawnFixedY = 4064 * 65536; SpawnFixedZ = 16 * 65536; } // -2944,4064,0 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("EvenstarNecklace",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[3] = 1;
  }

  // Checks for all secrets found in order to spawn Cloak of Evasion in MAP05
  if (SpecialGameFlags[4] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1205 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = 1216 * 65536; SpawnFixedY = -464 * 65536; SpawnFixedZ = 1416 * 65536; // 1216,-464,1400 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("CloakOfEvasion",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[4] = 1;
  }

  // Checks for all secrets found in order to spawn Falcon Knife Earrings in MAP05S
  if (SpecialGameFlags[5] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1206 && KilledMonsterFactor >= 950)
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = -4160 * 65536; SpawnFixedY = -2396 * 65536; SpawnFixedZ = 16 * 65536; // -4160,-2396,0 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("FalconKnifeEarrings",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[5] = 1;
  }

  // Checks for all secrets found in order to spawn Anubis Cufflinks in MAP06
  if (SpecialGameFlags[6] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1207 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = -128 * 65536; SpawnFixedY = -1312 * 65536; SpawnFixedZ = -48 * 65536; // -128,-1312,-64 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("AnubisCufflinks",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[6] = 1;
  }

  // Checks for all secrets found in order to spawn Kissa's Armored Brassiare in MAP07
  if (SpecialGameFlags[7] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1208 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = -544 * 65536; SpawnFixedY = -224 * 65536; SpawnFixedZ = 272 * 65536; // -544,-224,256 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("KissaBra",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[7] = 1;
  }

  // Checks for all secrets found in order to spawn Ruinous/Divine Shield in MAP08
  if (SpecialGameFlags[8] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1209 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = -6784 * 65536; SpawnFixedY = 12320 * 65536; SpawnFixedZ = 16 * 65536; // -6784,12320,0 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else
   {
    if (random(1,256) < 5) { SpawnForced("DivineShield",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0); }
    else { SpawnForced("RuinousShield",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0); }
   }
   SpecialGameFlags[8] = 1;
  }

  // Checks for all secrets found in order to spawn Balrog's Ring in MAP09
  if (SpecialGameFlags[9] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1210 && ThingCountName("FlyingBalrog",0) < 1 && GetLevelInfo(LEVELINFO_TOTAL_SECRETS) == GetLevelInfo(LEVELINFO_FOUND_SECRETS))
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = 512 * 65536; SpawnFixedY = 2240 * 65536; SpawnFixedZ = 16 * 65536; // 512,2240,0 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("BalrogRing",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[9] = 1;
  }

  // Checks for all secrets found in order to spawn Dove's Ribbon in MAP10
  if (SpecialGameFlags[10] == 0 && GetLevelInfo(LEVELINFO_LEVELNUM) == 1211 && KilledMonsterFactor >= 750)
  {
   PrintBold(s:"A SPECIAL ITEM HAS SPAWNED SOMEWHERE IN THE AREA!");
   AmbientSound("foundhiddenitem",127); 
   SpawnFixedX = 8048 * 65536; SpawnFixedY = 2272 * 65536; SpawnFixedZ = 256 * 65536; // 8048,2272,240 coords
   if (GetCVAR("dvds_dviiarmorspawn") == 1) SpawnForced("FloraRandomArmor2",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   else SpawnForced("DoveRibbon",SpawnFixedX,SpawnFixedY,SpawnFixedZ,0,0);
   SpecialGameFlags[10] = 1;
  }

 }

 if (MaxHealthTrue > 0)
 {
  HealthRatio = GetActorProperty(Player1TID,APROP_Health) * 1000 / MaxHealthTrue;
  if (HealthRatio < 0) HealthRatio = 0;
  if (HealthRatio > 2000) HealthRatio = 2000;
 }

 //****************
 //*POISON AILMENT*
 //****************
 int PoisonIncrement;
 int PoisonHealth;
 int PoisonHealthThreshold;
 int PoisonDamage;
 int PoisonTimer;
 int PoisonHits;
 int PoisonFlashColor;
 int PoisonMaxInterval = 12;
 PoisonMaxInterval += (MiscellaneousVars[32] / 8);
 PoisonMaxInterval += (MiscellaneousVars[35] / 16);
 PoisonMaxInterval *= 20;
 if (GameSkill() == SKILL_VERY_EASY)	PoisonMaxInterval = PoisonMaxInterval * 22 / 20;
 if (GameSkill() == SKILL_EASY)			PoisonMaxInterval = PoisonMaxInterval * 21 / 20;
 if (GameSkill() == SKILL_NORMAL) 		PoisonMaxInterval = PoisonMaxInterval * 20 / 20;
 if (GameSkill() == SKILL_HARD) 		PoisonMaxInterval = PoisonMaxInterval * 19 / 20;
 if (GameSkill() == SKILL_VERY_HARD)	PoisonMaxInterval = PoisonMaxInterval * 18 / 20;
 if (PowerupTimer[16] > 0 && PowerupTimer[4] == 0) // Being invulnerable will prevent poison damage from occuring.
 {
  PoisonIncrement = 20;
  if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
  if (PowerupTimer[20] > 0) FreezePlayer += 1;
  if (FreezePlayer == 0)
  {
   buttons = GetPlayerInput(0, INPUT_BUTTONS); 
   if (buttons & BT_FORWARD) C3 = 125;
   else if (buttons & BT_BACK) C3 = 125;
   else if (buttons & BT_MOVELEFT) C3 = 125;
   else if (buttons & BT_MOVERIGHT) C3 = 125;
   else if (buttons & BT_MOVEUP) C3 = random(112,113);
   else if (buttons & BT_MOVEDOWN) C3 = random(112,113);
   else if (buttons & BT_JUMP) C3 = 125;
   else if (buttons & BT_CROUCH) C3 = 75;
   else C3 = 100;
   PoisonIncrement = PoisonIncrement * C3 / 100;
  }
  // Check Characters & Armor
  if (CharacterClass == 2)
  {
   C3 = 1000;
   if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) C3 -= 83;
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) C3 -= 334;
   if (CheckActorInventory(Player1TID,"DivineShield") > 0) C3 -= 83;
   PoisonIncrement = PoisonIncrement * C3 / 1000;
  }
  else
  if (CharacterClass == 0 || CharacterClass == 1)
  {
   C3 = 100;
   if (CheckActorInventory(Player1TID,"DSGreenArmorClass") > 0) C3 -= 2; // (-2% for Green Armor)
   if (CheckActorInventory(Player1TID,"DSBlueArmorClass") > 0) C3 -= 4; // (-4% for Blue Armor)
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass1") > 0) C3 -= 5; // (-5% for Stone Armor 1)
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass1") > 0) C3 -= 7; // (-7% for Diamond Armor 1)
   if (CheckActorInventory(Player1TID,"DSStoneArmorClass2") > 0) C3 -= 6; // (-6% for Stone Armor 2)
   if (CheckActorInventory(Player1TID,"DSDiamondArmorClass2") > 0) C3 -= 8; // (-8% for Diamond Armor 2)
   PoisonIncrement = PoisonIncrement * C3 / 100;
  }

  // Buffs
  if (PowerupTimer[12] > 0) PoisonIncrement = PoisonIncrement * 6 / 5; // Acceleratle = 120% Speed
  if (PowerupTimer[15] > 0) PoisonIncrement = PoisonIncrement * 4 / 5; // Deceleratle = 80% Speed
  if (PowerupTimer[17] > 0) PoisonIncrement = PoisonIncrement * 1 / 5; // Sleep = 20% Speed
  if (PowerupTimer[18] > 0) PoisonIncrement = PoisonIncrement * 9 / 5; // Fatigue = 180% Speed
  
  PoisonTimer += PoisonIncrement;
  if (PoisonTimer >= PoisonMaxInterval)
  {
   PoisonTimer = 0;
   PoisonHealth = GetActorProperty(Player1TID,APROP_Health);
   PoisonHealthThreshold = MaxHealthTrue / 50;
   if (PoisonHealthThreshold < 2) PoisonHealthThreshold = 2;
   if (PoisonHealth > PoisonHealthThreshold)
   {
    PoisonDamage = MaxHealthTrue / 200;
	if (PoisonDamage < 1) PoisonDamage = 1;
	if (random(1,8) == 8)
	{
	 if (random(1,8) == 8) PoisonDamage *= 3; else PoisonDamage *= 2;
	}

	PoisonFlashColor = random(191,255);
    FadeRange(0,PoisonFlashColor,0,0.125, 0,PoisonFlashColor,0,0, 0.50);
    PoisonHealth -= PoisonDamage;
	if (PoisonHealth < PoisonHealthThreshold) PoisonHealth = PoisonHealthThreshold;
	SetActorProperty(Player1TID,APROP_Health,PoisonHealth);

    // Pain Sounds
    PoisonHits++;
	if (PoisonHits >= 3)
	{
	 PoisonHits = 0;
	 if (random(1,16) == 16)
	 {
	  StopSound(Player1TID,CHAN_VOICE);
	  if (CharacterClass == 9)
	  {
       if (HealthRatio >= 667) PlaySound(Player1TID,"PetraPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
       if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"PetraPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
       if (HealthRatio <= 333 && PoisonHealth > 0) PlaySound(Player1TID,"PetraPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
	  }
	  else
	  if (CharacterClass == 8)
	  {
       if (HealthRatio >= 667) PlaySound(Player1TID,"AilishPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
       if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"AilishPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
       if (HealthRatio <= 333 && PoisonHealth > 0) PlaySound(Player1TID,"AilishPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
	  }
	  else
	  if (CharacterClass == 2)
	  {
       if (HealthRatio >= 667) PlaySound(Player1TID,"FloraPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
       if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"FloraPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
       if (HealthRatio <= 333 && PoisonHealth > 0) PlaySound(Player1TID,"FloraPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
	  }
	  else
	  if (CharacterClass == 1)
	  {
	   if (PoisonHealth > 0) PlaySound(Player1TID,"illucia/pain",CHAN_VOICE,1.0,0,ATTN_NORM);
	  }
	  else
	  if (CharacterClass == 0)
	  {
	   if (PoisonHealth > 0) PlaySound(Player1TID,"deggaris/pain",CHAN_VOICE,1.0,0,ATTN_NORM);
	  }
	 }
	}
   }
  }
 }
 else
 {
  PoisonDamage = 0;
  PoisonTimer = 0;
  PoisonHits = 0;
 }
 if (GetCVar("dvdsdebug_poisonailmentdisplays") > 0)
 {
  PrintBold(s:"Poison: ",d:PowerupTimer[16],
	      s:"\nPoisonIncrement: ",d:PoisonIncrement,
	      s:"\nPoisonTimer: ",d:PoisonTimer,s:" / ",d:PoisonMaxInterval,
          s:"\nPoisonDamage: ",d:PoisonDamage);
 }
 
 if (GetActorProperty(Player1TID,APROP_Health) <= 0) { GiveActorInventory(Player1TID,"PlayerIsDead", 1); }
 else
 {
  TakeActorInventory(Player1TID,"PlayerIsDead", 1);

  if (HealthRatio != MiscellaneousVars[4]); // "4" is for saving health ratio for giving Low or Critical Health Inventory items [for Status Bar Displays and using "Nova" with Flora's Hellcore weapons]
  {
   TakeActorInventory(Player1TID,"NormalHealth", 1);
   TakeActorInventory(Player1TID,"LowHealth", 1);
   TakeActorInventory(Player1TID,"CriticalHealth", 1);

   if (HealthRatio < 167)
   {
    if (HealthRatio < 21) GiveActorInventory(Player1TID,"CriticalHealth", 1);
    else GiveActorInventory(Player1TID,"LowHealth", 1);
   }
   else GiveActorInventory(Player1TID,"NormalHealth", 1);

   if (GetActorProperty(Player1TID,APROP_Health) >= MaxHealthTrue) GiveActorInventory(Player1TID,"FullHealth", 1); else TakeActorInventory(Player1TID,"FullHealth", 1);

   MiscellaneousVars[4] = HealthRatio;
  }
 }


 if (CurrentArmorClass == 6)
 {
  GiveActorInventory(Player1TID,"DSDiamondArmorClass2", 1);
  TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
  TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
  TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
  TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
  TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
  TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
  if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 21); 
 }
 else
 {
  if (CurrentArmorClass == 5)
  {
   GiveActorInventory(Player1TID,"DSStoneArmorClass2", 1);
   TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
   if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 20); 
  }
  else
  {
   if (CurrentArmorClass == 4)
   {
    GiveActorInventory(Player1TID,"DSDiamondArmorClass1", 1);
    TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
    TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
    TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
    if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 21); 
   }
   else
   {
    if (CurrentArmorClass == 3)
    {
     GiveActorInventory(Player1TID,"DSStoneArmorClass1", 1);
     TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
     TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
     TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
     TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
     TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
     TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
     if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 20); 
    }
    else
    {
     if (CurrentArmorClass == 2)
     {
      GiveActorInventory(Player1TID,"DSBlueArmorClass", 1);
      TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
      TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
      TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
      TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
      TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
      TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
      if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 19); 
     }
     else
     {
      if (CurrentArmorClass == 1)
      {
       GiveActorInventory(Player1TID,"DSGreenArmorClass", 1);
       TakeActorInventory(Player1TID,"DSNoArmorClass", 9999);
       TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
       TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
       TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
       TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
       TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
       if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 18); 
      }
      else
      {
       GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
       TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
       TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
       TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
       TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
       TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
       TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
       if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) Thing_SetTranslation(Player1TID, 17); 
      }
     }
    }
   }
  }
 }

 if (CheckActorInventory(Player1TID,"Armor") <= 0)
 {
  CurrentArmorClass = 0;
  CurrentMaxArmor = 0;
  if (CheckActorInventory(Player1TID,"DSNoArmorClass") == 0)
  {
   GiveActorInventory(Player1TID,"DSNoArmorClass", 1);
   TakeActorInventory(Player1TID,"DSGreenArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSBlueArmorClass", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass1", 9999);
   TakeActorInventory(Player1TID,"DSStoneArmorClass2", 9999);
   TakeActorInventory(Player1TID,"DSDiamondArmorClass2", 9999);
  }
 }
 // PrintBold(d:CurrentArmorClass);

 //***************************************
 //**Scripted Events for Individual Maps**
 //***************************************

 if (ModType == 2) // DVII
 {
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1204) // MAP04 - Minas Morgul
  {
   // [1401] = MAP04, Damage inflicted by Helltoxins in Minas Morgul
   GameScriptEvents[1401] = 42;
   if (GameSkill() == SKILL_VERY_EASY) GameScriptEvents[1401] = random(15,17);
   if (GameSkill() == SKILL_EASY) GameScriptEvents[1401] = random(16,20);
   if (GameSkill() == SKILL_NORMAL) GameScriptEvents[1401] = random(17,23);
   if (GameSkill() == SKILL_HARD) GameScriptEvents[1401] = random(18,26);
   if (GameSkill() == SKILL_VERY_HARD) GameScriptEvents[1401] = random(21,31);

   // [1402] = MAP04, Max Damage timer for Helltoxins in Minas Morgul
   GameScriptEvents[1402] = 42;
   if (GameSkill() == SKILL_VERY_EASY) GameScriptEvents[1402] = 35;
   if (GameSkill() == SKILL_EASY) GameScriptEvents[1402] = 32;
   if (GameSkill() == SKILL_NORMAL) GameScriptEvents[1402] = 29;
   if (GameSkill() == SKILL_HARD) GameScriptEvents[1402] = 26;
   if (GameSkill() == SKILL_VERY_HARD) GameScriptEvents[1402] = 21;

   // [1403] = MAP04, Checks for the player having Iron Feet powerup or Flora's Safe Passage spells in effect to determine exposure to Hell-Toxins.
   GameScriptEvents[1403] = 0;
   if (CheckActorInventory(Player1TID,"FloraArmorFloorGuard") > 0) GameScriptEvents[1403] += 1;   
   if (CheckActorInventory(Player1TID,"PowerIronFeet") > 0) GameScriptEvents[1403] += 1;   
   if (CheckActorInventory(Player1TID,"PowerMask") > 0) GameScriptEvents[1403] += 1;   

   // [1404] = MAP04, Current HellToxen Interval [seperate timer]   
   GameScriptEvents[1404] += 1;
   if (GameScriptEvents[1404] >= GameScriptEvents[1402])
   {
    GameScriptEvents[1404] -= GameScriptEvents[1402];
    if (GameScriptEvents[1403] == 0)
    {
     G1 = random(1,100);
     if (CharacterClass == 2)
     {
      if (G1 < 15) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 86) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     if (CharacterClass == 1)
     {
      if (G1 < 11) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 90) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     else
     {
      if (G1 < 13) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 88) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     Thing_Damage(Player1TID,GameScriptEvents[1401],13);
    }
   }

  }

  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1205) // MAP05 - Eagle's Nest
  {
   // [1401] = MAP05, Damage inflicted by Helltoxins in Eagle's Nest
   GameScriptEvents[1401] = 42;
   if (GameSkill() == SKILL_VERY_EASY) GameScriptEvents[1401] = random(2,4);
   if (GameSkill() == SKILL_EASY) GameScriptEvents[1401] = random(3,5);
   if (GameSkill() == SKILL_NORMAL) GameScriptEvents[1401] = random(4,6);
   if (GameSkill() == SKILL_HARD) GameScriptEvents[1401] = random(5,7);
   if (GameSkill() == SKILL_VERY_HARD) GameScriptEvents[1401] = random(6,8);

   // [1402] = MAP05, Max Damage timer for Helltoxins in Eagle's Nest
   GameScriptEvents[1402] = 42;
   if (GameSkill() == SKILL_VERY_EASY) GameScriptEvents[1402] = 35;
   if (GameSkill() == SKILL_EASY) GameScriptEvents[1402] = 32;
   if (GameSkill() == SKILL_NORMAL) GameScriptEvents[1402] = 29;
   if (GameSkill() == SKILL_HARD) GameScriptEvents[1402] = 26;
   if (GameSkill() == SKILL_VERY_HARD) GameScriptEvents[1402] = 21;

   // [1403] = MAP05, Checks for the player having Iron Feet powerup or Flora's Safe Passage spells in effect to determine exposure to Hell-Toxins.
   GameScriptEvents[1403] = 0;
   if (CheckActorInventory(Player1TID,"FloraArmorFloorGuard") > 0) GameScriptEvents[1403] += 1;   
   if (CheckActorInventory(Player1TID,"PowerIronFeet") > 0) GameScriptEvents[1403] += 1;   
   if (CheckActorInventory(Player1TID,"PowerMask") > 0) GameScriptEvents[1403] += 1;   

   SpawnFixedX = GetActorX(Player1TID) >> 16;
   SpawnFixedY = GetActorY(Player1TID) >> 16;
   SpawnFixedZ = GetActorZ(Player1TID) >> 16;

   // [1404] = MAP05, Current HellToxen Interval [seperate timer]   
   GameScriptEvents[1404] += 1;
   if (GameScriptEvents[1404] >= GameScriptEvents[1402])
   {
    GameScriptEvents[1404] -= GameScriptEvents[1402];
    if (GameScriptEvents[1403] == 0)
    {
     G1 = random(1,100);
     if (CharacterClass == 2)

     {
      if (G1 < 15) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 86) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     if (CharacterClass == 1)
     {
      if (G1 < 11) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 90) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     else
     {
      if (G1 < 13) GameScriptEvents[1401] = GameScriptEvents[1401] * 14 / 8;
      if (G1 > 88) GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 8;
     }
     // Upper Left = -9216, 11776
     // Lower Right = 14336, -11776
     // Chasm Bottom = -5000

     if (SpawnFixedZ < 0) // Negative Z Vels
     {
      if (SpawnFixedZ > -1001) { G1 = 10; GameScriptEvents[1401] = GameScriptEvents[1401] * 4 / 3; }
      if (SpawnFixedZ > -2001 && SpawnFixedZ < -1000) { G1 = 16; GameScriptEvents[1401] = GameScriptEvents[1401] * 5 / 3; }
      if (SpawnFixedZ > -3001 && SpawnFixedZ < -2000) { G1 = 23; GameScriptEvents[1401] = GameScriptEvents[1401] * 6 / 3; }
      if (SpawnFixedZ > -4001 && SpawnFixedZ < -3000) { G1 = 31; GameScriptEvents[1401] = GameScriptEvents[1401] * 7 / 3; }
      if (SpawnFixedZ < -4000) { G1 = 40; GameScriptEvents[1401] = GameScriptEvents[1401] * 8 / 3; }
     }
     else // Positive Z Vels
     {
      if (SpawnFixedZ > -1 && SpawnFixedZ < 1000) { G1 = 5; }
      if (SpawnFixedZ > 999 && SpawnFixedZ < 2000) { G1 = 4; }
      if (SpawnFixedZ > 1999 && SpawnFixedZ < 3000) { G1 = 3; GameScriptEvents[1401] = GameScriptEvents[1401] * 2 / 3; }
      if (SpawnFixedZ > 2999 && SpawnFixedZ < 4000) { G1 = 2; GameScriptEvents[1401] = GameScriptEvents[1401] * 2 / 3; }
      if (SpawnFixedZ > 3999 && SpawnFixedZ < 5000) { G1 = 1; GameScriptEvents[1401] = GameScriptEvents[1401] * 1 / 3; }
      if (SpawnFixedZ > 4999) { G1 = 0; GameScriptEvents[1401] = GameScriptEvents[1401] * 0 / 3; }
     }

     if (SpawnFixedX > -9217 && SpawnFixedX < 14337 && SpawnFixedY > -11777 && SpawnFixedY < 11777 && random(1,100) <= G1) { Thing_Damage(Player1TID,GameScriptEvents[1401],13); }
    }
   }
  }

  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1209) // MAP08 - Unholy Cathedrel
  {
   if (GameScriptEvents[1801] == 0)
   {
    GameScriptEvents[1801] += 1;
   }
  }
/*
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1210) // MAP09 - You Shall Not Pass!
  {
   if (GameScriptEvents[1801] == 0)
   {
    GameScriptEvents[1801] += 1;
   }
  }
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1211) // MAP10 - Hell's Vendetta
  {
   if (GameScriptEvents[1801] == 0)
   {
    GameScriptEvents[1801] += 1;
   }
  }
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1212) // MAP10B - attedneV s'lleH
  {
   if (GameScriptEvents[1801] == 0)
   {
    GameScriptEvents[1801] += 1;
   }
  }
*/
 }

 VelX /= 10;
 VelY /= 10;
 VelZ /= 10;
 
 int BaseSpeedVels = 989867;
 if (CharacterClass == 0) BaseSpeedVels = 989867;
 if (CharacterClass == 1) BaseSpeedVels = 1113600;
 if (CharacterClass == 2) BaseSpeedVels = 1237333;
 BaseSpeedVels /= 10;

 int SpeedXFactor = (VelX * 1000) / BaseSpeedVels;
 if (SpeedXFactor < 0) SpeedXFactor *= -1;
 int SpeedXFactorHigh = SpeedXFactor / 10;
 int SpeedXFactorMod = SpeedXFactor % 10;

 int SpeedYFactor = (VelY * 1000) / BaseSpeedVels;
 if (SpeedYFactor < 0) SpeedYFactor *= -1;
 int SpeedYFactorHigh = SpeedYFactor / 10;
 int SpeedYFactorMod = SpeedYFactor % 10;
 
 if (GetCVar("dvdsdebug_showmoveinformation") > 0)
 {
  PrintBold(s:"Angle: ",d:GetActorAngle(Player1TID),s:" (",f:GetActorAngle(Player1TID),s:")",
            s:"\nVelX: ",d:VelX,s:" [",d:SpeedXFactorHigh,s:".",d:SpeedXFactorMod,s:"%] (",d:BaseSpeedVels,s:")",
            s:"\nVelY: ",d:VelY,s:" [",d:SpeedYFactorHigh,s:".",d:SpeedYFactorMod,s:"%] (",d:BaseSpeedVels,s:")",
            s:"\nVelZ: ",d:VelZ,
            s:"\nFriction: ",f:MiscellaneousVars[399],
            s:"\nAirControl: ",f:MiscellaneousVars[400],
			s:"\n",
            s:"\nStaminaSpeed x: ",f:StaminaSpeed,
            s:"\nDodgeMoreSpeed x: ",f:DodgeMoreSpeed,
            s:"\nJumpMoreSpeed x: ",f:JumpMoreSpeed,
            s:"\nOnTheMoveSpeed x: ",f:OnTheMoveSpeed,
            s:"\nOneRingSpeed x: ",f:OneRingSpeed,
            s:"\nArmorSpeed x: ",f:ArmorSpeed,
            s:"\nLVLSpeed x: ",f:LVLSpeed,
            s:"\nAGLSpeed x: ",f:AGLSpeed,
            s:"\nLongbowSpeed x: ",f:LongbowSpeed,
            s:"\nSceptreShieldSpeed x: ",f:SceptreShieldSpeed,
            s:"\nBuffSpeed x: ",f:BuffSpeed,
            s:"\nTensionSpeed x: ",f:TensionSpeed,
            s:"\nFocusSpeed x: ",f:FocusSpeed,
            s:"\nDivineAvatarSpeed x: ",f:DivineAvatarSpeed,
			s:"\n",
			s:"\n",
            s:"\nTotalSpeed x: ",f:TotalSpeed);
 }

 if (GetActorProperty(Player1TID,APROP_Health) > 0) 
 {
  if (MiscellaneousVars[149] != 0) MiscellaneousVars[149] = 0; // Unsets a special flag to check for a "pistol reset" like in resurgance
  if (CheckActorInventory(Player1TID,"Dedz") > 0) TakeActorInventory(Player1TID,"Dedz", 9999);
 }

 Delay(1);
 Restart;
}

// MegaSphere Armor [Deggaris & Illucia Only] or Mana [All Three Characters]
script "MegaSphereArmor" (void)
{
 int I1, I2, Z1, Z2, C1, C2;
 int MaxManaLimit;

 if (CharacterClass == 9) // Petra gets no armor from a Soul Sphere, but gets Mana and Force Gauge refill.
 {
  CurrentMana = MaxMana * 2;
  //Insert code for refilling force gauge here
 }
 else
 if (CharacterClass == 2) // Flora does not get armor from a Soul Sphere, but instead gets Mana up to 200% of her maximum
 {
  CurrentMana = MaxMana * 2;
 }
 else
 if (CharacterClass <= 1)
 {
  MaxManaLimit = MaxMana * 2;
  CurrentMana = MaxManaLimit;

  // Saves original raw Armor Value
  Z1 = CheckInventory("Armor");

  // Clears Armor Types
  Z2 = CheckInventory("Armor"); TakeInventory("Armor", Z2);
  Z2 = CheckInventory("ArmorBonusDS"); TakeInventory("ArmorBonusDS", Z2);
  Z2 = CheckInventory("ArmorBonusDSGreen"); TakeInventory("ArmorBonusDSGreen", Z2);
  Z2 = CheckInventory("ArmorBonusDSBlue"); TakeInventory("ArmorBonusDSBlue", Z2);
  Z2 = CheckInventory("ArmorBonusDSStone1"); TakeInventory("ArmorBonusDSStone1", Z2);
  Z2 = CheckInventory("ArmorBonusDSStone2"); TakeInventory("ArmorBonusDSStone2", Z2);
  Z2 = CheckInventory("ArmorBonusDSDiamond1"); TakeInventory("ArmorBonusDSDiamond1", Z2);
  Z2 = CheckInventory("ArmorBonusDSDiamond2"); TakeInventory("ArmorBonusDSDiamond2", Z2);
 
  // Reinitalizes the proper Armor Class after the previous code above clears it
  if (CurrentArmorClass <= 1) { CurrentArmorClass = 2; GiveInventory("ArmorBonusDSBlue", 200); }
  else if (CurrentArmorClass == 2) { CurrentArmorClass = 3; GiveInventory("ArmorBonusDSStone1", 500); }
  else if (CurrentArmorClass == 3) { CurrentArmorClass = 4; GiveInventory("ArmorBonusDSDiamond1", 1250); }
  else if (CurrentArmorClass == 4) { CurrentArmorClass = 5; GiveInventory("ArmorBonusDSStone2", 2000); }
  else if (CurrentArmorClass == 5) { CurrentArmorClass = 6; GiveInventory("ArmorBonusDSDiamond2", 5000); }
  else if (CurrentArmorClass == 6) { GiveInventory("ArmorBonusDSDiamond2", 5000); }
 
  if (CurrentArmorClass == 6)
  {  
   CurrentMaxArmor = 5000;
   GiveInventory("DSDiamondArmorClass2", 1);
   TakeInventory("DSNoArmorClass", 9999);
   TakeInventory("DSGreenArmorClass", 9999);
   TakeInventory("DSBlueArmorClass", 9999);
   TakeInventory("DSStoneArmorClass1", 9999);
   TakeInventory("DSDiamondArmorClass1", 9999);
   TakeInventory("DSStoneArmorClass2", 9999);
  }
  else
  {
   if (CurrentArmorClass == 5)
   {
    CurrentMaxArmor = 2000;
    GiveInventory("DSStoneArmorClass2", 1);
    TakeInventory("DSNoArmorClass", 9999);
    TakeInventory("DSGreenArmorClass", 9999);
    TakeInventory("DSBlueArmorClass", 9999);
    TakeInventory("DSStoneArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass1", 9999);
    TakeInventory("DSDiamondArmorClass2", 9999);
   }
   else
   {
    if (CurrentArmorClass == 4)
    {
     CurrentMaxArmor = 1250;
     GiveInventory("DSDiamondArmorClass1", 1);
     TakeInventory("DSNoArmorClass", 9999);
     TakeInventory("DSGreenArmorClass", 9999);
     TakeInventory("DSBlueArmorClass", 9999);
     TakeInventory("DSStoneArmorClass1", 9999);
     TakeInventory("DSStoneArmorClass2", 9999);
     TakeInventory("DSDiamondArmorClass2", 9999);
    }
    else
    {
     if (CurrentArmorClass == 3)
     {
      CurrentMaxArmor = 500;
      GiveInventory("DSStoneArmorClass1", 1);
      TakeInventory("DSNoArmorClass", 9999);
      TakeInventory("DSGreenArmorClass", 9999);
      TakeInventory("DSBlueArmorClass", 9999);
      TakeInventory("DSDiamondArmorClass1", 9999);
      TakeInventory("DSStoneArmorClass2", 9999);
      TakeInventory("DSDiamondArmorClass2", 9999);
     }
     else
     {
      if (CurrentArmorClass == 2)
      {
       CurrentMaxArmor = 200;
       GiveInventory("DSBlueArmorClass", 1);
       TakeInventory("DSNoArmorClass", 9999);
       TakeInventory("DSGreenArmorClass", 9999);
       TakeInventory("DSStoneArmorClass1", 9999);
       TakeInventory("DSDiamondArmorClass1", 9999);
       TakeInventory("DSStoneArmorClass2", 9999);
       TakeInventory("DSDiamondArmorClass2", 9999);
      }
      else
      {
       if (CurrentArmorClass == 1)
       {
        CurrentMaxArmor = 100;
        GiveInventory("DSGreenArmorClass", 1);
        TakeInventory("DSNoArmorClass", 9999);
        TakeInventory("DSBlueArmorClass", 9999);
        TakeInventory("DSStoneArmorClass1", 9999);
        TakeInventory("DSDiamondArmorClass1", 9999);
        TakeInventory("DSStoneArmorClass2", 9999);
        TakeInventory("DSDiamondArmorClass2", 9999);
       }
       else
       {
        CurrentMaxArmor = 0;
        GiveInventory("DSNoArmorClass", 1);
        TakeInventory("DSGreenArmorClass", 9999);
        TakeInventory("DSBlueArmorClass", 9999);
        TakeInventory("DSStoneArmorClass1", 9999);
        TakeInventory("DSDiamondArmorClass1", 9999);
        TakeInventory("DSStoneArmorClass2", 9999);
        TakeInventory("DSDiamondArmorClass2", 9999);
       }
      }
     }
    }
   }
  }
 }

}

// DEBUG SCRIPT: Sets Mana to the Current Amount
script "SetManaAmount" (int C5)
{
 CurrentMana = C5;
 int MaxManaLimit;
 if (CurrentMana < 1) CurrentMana = 0;

 MaxManaLimit = MaxMana * 2;

 if (CurrentMana > MaxManaLimit) CurrentMana = MaxManaLimit;
}

// Checks the Player's level to determine how much drawing the Diaris Longbow will slow you down while aiming
script "DrawBow" (int isbowdrawn)
{
 int i = 0;
 int bowlevel;
 int bowlevelbase;
 int lvlforbowdraw;
 int strforbowdraw;
 int aglforbowdraw;
 int perklvlforbowdraw;
 str BowLevelItem;

 bowlevelbase = random(15,19);
 lvlforbowdraw = PlayerLevel / 8; // Max of +25%
 strforbowdraw = MiscellaneousVars[35] / 16; // Max of +32%
 aglforbowdraw = MiscellaneousVars[31] / 10; // Max of +51%
 perklvlforbowdraw = MiscellaneousVars[10031] * 10; // Max of +50%
 bowlevel = bowlevelbase;
 bowlevel += lvlforbowdraw;
 bowlevel += strforbowdraw;
 bowlevel += aglforbowdraw;
 bowlevel += perklvlforbowdraw;
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) bowlevel = bowlevel * 4 / 3;

 if (bowlevel < 0) bowlevel = 0; // Min of 0
 if (bowlevel > 101) bowlevel = 101; // Max of 50

 MiscellaneousVars[398] = isbowdrawn; // 398 - Bow is Drawn?
 MiscellaneousVars[8] = bowlevel; // 8 - Bow Proficency/SpeedMovement%
}

// Checks Sauron's Gauntlets to see if the item is removed from the map or not.
script "GauntletsCheckCharacter" (void)
{
 if (CharacterClass == 0) 
 {
  if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) Thing_Remove(0);
 }
 if (CharacterClass == 1) 
 {
  if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) Thing_Remove(0);
 }
 if (CharacterClass == 2) 
 {
  if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) Thing_Remove(0); 
 }
 if (CharacterClass == 8) 
 {
  if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) Thing_Remove(0); 
 }
 if (CharacterClass == 9) 
 {
  if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) Thing_Remove(0); 
 }
}

// Sets the "glowing eyes" in the "Armor Bonus" items to a specfic color based on the current Armor Class of Deggaris or Illucia [does not apply to Flora as she can't use Armor Bonuses and they aren't supposed to "appear" when she is in play]
script "ArmorBonusEyeGlow" (void)
{
 if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9)
 {
  if (CurrentArmorClass == 0) Thing_SetTranslation(0,18); // If you have no Armor Class
  if (CurrentArmorClass == 1) Thing_SetTranslation(0,18); // If you have Green Armor Class
  if (CurrentArmorClass == 2) Thing_SetTranslation(0,22); // If you have Blue Armor Class
  if (CurrentArmorClass == 3) Thing_SetTranslation(0,20); // If you have Stone Armor [1] Class
  if (CurrentArmorClass == 4) Thing_SetTranslation(0,21); // If you have Diamond Armor [1] Class
  if (CurrentArmorClass == 5) Thing_SetTranslation(0,20); // If you have Stone Armor [2] Class
  if (CurrentArmorClass == 6) Thing_SetTranslation(0,21); // If you have Diamond Armor [2] Class
 }
}

// Backpack Pickup Script
script "GrabBackpack" (void)
{
 int ClipMax, ShellMax, RocketMax, CellMax, DiarisArrowMax; 
 int GoldWandMax, CrossbowAmmoMax, BlasterAmmoMax, PheonixRodAmmoMax, SkullRodAmmoMax, MaceAmmoMax;
 int BlueManaMax, GreenManaMax;
 int ElectricBoltsNew, PoisonBoltsNew, ClipOfBulletsMax, EnergyPodMax, MiniMissiles, HEGrenadeRoundsMax, PhosphorusGrenadeRoundsMax;

 MiscellaneousVars[80] += 1; 
 if (MiscellaneousVars[80] > 512) MiscellaneousVars[80] = 512;

 // Doom Ammo
 if (CharacterClass != 2) // Deggaris & Illucia
 {
  GiveActorInventory(Player1TID,"Clip", 20); 
  GiveActorInventory(Player1TID,"Shell", 8); 
  GiveActorInventory(Player1TID,"RocketAmmo", 2); 
  GiveActorInventory(Player1TID,"Cell", 80); 
 }
 if (CharacterClass == 2) // Flora
 {
  if (CheckActorInventory(Player1TID,"FloraLearnedPistols") > 0) GiveActorInventory(Player1TID,"Clip", 20);
  GiveActorInventory(Player1TID,"DiarisArrow", 6); 
 }

 // Heretic Ammo
 GiveActorInventory(Player1TID,"GoldWandAmmo", 20); 
 GiveActorInventory(Player1TID,"CrossbowAmmo", 10); 
 GiveActorInventory(Player1TID,"BlasterAmmo", 20); 
 GiveActorInventory(Player1TID,"PhoenixRodAmmo", 2); 
 GiveActorInventory(Player1TID,"SkullRodAmmo", 40); 
 GiveActorInventory(Player1TID,"MaceAmmo", 40); 

 // Strife Ammo
 GiveActorInventory(Player1TID,"ElectricBolts", 20); 
 GiveActorInventory(Player1TID,"PoisonBolts", 10); 
 GiveActorInventory(Player1TID,"ClipOfBullets", 10); 
 GiveActorInventory(Player1TID,"MiniMissiles", 4); 
 GiveActorInventory(Player1TID,"EnergyPod", 20); 
 GiveActorInventory(Player1TID,"HEGrenadeRounds", 6); 
 GiveActorInventory(Player1TID,"PhosphorusGrenadeRounds", 4); 
}

// Debug. Prints whatever it specified. :P
script "PrintTest" (void)
{
 int test;
 test += 1;
 Print(d:test);
// Print(s:"?");
}

// Checks to see if you already possess the Ring so it cannot appear more than once.
script "OneRingCopyCheck" (void)
{
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) Thing_Remove(0);
}

// Checks to see if you already possess the Helmet so it cannot appear more than once.
script "HelmetCopyCheck" (void)
{
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) Thing_Remove(0);
}

// Prints out damage on screen for a projectile attached to this script
script "DamagePrintout" (void)
{
 int C1;
 C1 = GetActorProperty(0,APROP_Damage); 
 PrintBold(d:C1);
}

// Set Levelcap Manually
script "SetLevelCap" (int C5)
{
 int C1;
 if (C5 > 99)
 {
  if (C5 < 201)
  {
   LevelCap = C5;
  }
  else
  {
   LevelCap = 200;
  }
 }
 else
 {
  LevelCap = 100;
 }
}

//Controls the Timer for both Sceptre Twirl sprite animation and for when to make the swinging noise. [Flora Only]
script "SceptreTwirlFrameCheck" (int FrameNo)
{
 int ManaDrainTimer;
 if (FrameNo == 0) { MiscellaneousVars[198] = 0; } // 0 resets the timer to 0
 else // FrameNo's value is the speed of the twirling
 {
  if (FrameNo > 16) FrameNo = 16;
  if (FrameNo < 1) FrameNo = 1;
  MiscellaneousVars[198] += FrameNo;

  if (MiscellaneousVars[198] < 1) MiscellaneousVars[198] += 32; // Prevents Timer Underflow
  if (MiscellaneousVars[198] > 32) MiscellaneousVars[198] -= 32; // Prevents Timer Overflow
 }

 int i;
 str TwirlFrame;
 for (i = 1; i < 33; i++)
 {
  TwirlFrame = StrParam(s:"SceptreTwirlTimer", d:i);

  if (MiscellaneousVars[198] == i)
   GiveActorInventory(Player1TID, TwirlFrame, 1);
    else
   TakeActorInventory(Player1TID, TwirlFrame, 1);
 }
}

// Increases the number of points towards uncursing a Ruinous Shield into a Divine Shield
script "CursedShieldPain" (int UncursePts)
{
 int C1;

 if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) UncursePts += UncursePts;
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) UncursePts += UncursePts;

 // MiscellaneousVars[241]

 if (CharacterClass == 2)
 {
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
  {
   C1 = random(1,100);
   if (C1 == 1) UncursePts = UncursePts * 16;
   if (C1 == 2) UncursePts = UncursePts * 8;
   if (C1 == 3) UncursePts = UncursePts * 8;
   if (C1 == 4) UncursePts = UncursePts * 4;
   if (C1 == 5) UncursePts = UncursePts * 4;
   if (C1 == 6) UncursePts = UncursePts * 4;
   if (C1 == 7) UncursePts = UncursePts * 4;
   if (C1 == 8) UncursePts = UncursePts * 2;
   if (C1 == 9) UncursePts = UncursePts * 2;
   if (C1 == 10) UncursePts = UncursePts * 2;
   if (C1 == 11) UncursePts = UncursePts * 2;
   if (C1 == 12) UncursePts = UncursePts * 2;
   if (C1 == 13) UncursePts = UncursePts * 2;
   if (C1 == 14) UncursePts = UncursePts * 2;
   if (C1 == 15) UncursePts = UncursePts * 2;
   UncursePts *= 2;
   if (UncursePts < 2) UncursePts = 2;
   if (UncursePts > 1024) UncursePts = 1024;
   MiscellaneousVars[202] += UncursePts;
   // PrintBold(s:"+",d:UncursePts,s:" (",d:MiscellaneousVars[202],s:")");
  }
 }
}

// Gauntlet Flash Effect
script "GauntletFlashEffect" (void)
{
 if (MiscellaneousVars[49] > 0)
 {
  FadeRange(224,224,224,0.33,224,224,224,0,0.5);
  MiscellaneousVars[49] = 0;
 }
}

// Sauron's Gauntlets Effect
script "SauronGauntletsHit" (int Amount, int HitType)
{
 int C1, C2, C3, Z1, Z2, Z3, I1, I2, I3, G2, G3;
 int MaxManaLimit = MaxMana * 2;
 int check;
 if (HitType <= 0) HitType = 1;
 if (HitType >= 3) HitType = 2;

 if (HitType == 1) // Give some life when hurting a monster [1+(HP/500)]
 {
  if (GetUserVariable(0,"user_MaxHP") > 0) Amount = GetUserVariable(0,"user_MaxHP");
  else Amount = GetActorProperty(0,APROP_SpawnHealth);
  Amount = Amount / 500;
  Amount = Amount + 1;
 }
 else
 if (HitType == 2) // Give some life when killing a monster [3+(HP/100)]
 {
  if (GetUserVariable(0,"user_MaxHP") > 0) Amount = GetUserVariable(0,"user_MaxHP");
  else Amount = GetActorProperty(0,APROP_SpawnHealth);
  Amount = Amount / 100;
  Amount = Amount + 3;
 }
 If (Amount <= 0) Amount = 1;
// if (CharacterClass == 2) PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
// else PlaySound(Player1TID,"HealSpell1",CHAN_BODY,1.0,0,ATTN_NORM);
 if (CharacterClass == 2) ActivatorSound("healing_dq",127);
 else ActivatorSound("HealSpell1",127); 

 MiscellaneousVars[49] = 1; // Screen Flash
 ACS_NamedExecuteAlways("EmulateGiveHealthBonus",0,Amount,0,0); // Restore Health
 if (CharacterClass != 2) ACS_NamedExecuteAlways("EmulateGiveArmorBonus",0,Amount,0,0);  // Restore Armor [Flora Cannot Gain Armor from it though]

 // Restore Mana
 C1 = (PlayerLevel * 4) + 100;
 C2 = Amount;
 C2 = C2 * C1 / 100;
 if (CharacterClass == 2) C2 = C2 * 3 / 2; // Flora will gain Extra Mana from a Gauntlet punch to make up for not being able to get armor.
 CurrentMana += C2;
 if (CurrentMana > MaxManaLimit) CurrentMana = MaxManaLimit;
 SetHudSize(640,480,0);
 SetFont("DVDSSMLFONT");
 //if (MiscellaneousVars[2000] == 0) HudMessage(s:"+",d:C2,s:" Mana";HUDMSG_ALPHA,3419,cr_blue,0.036,0.081,0.75);
}

// Makes Monsters in MAP04 [DVI-DS] or MAP12 [DVII-DS] have a TID of 666 [this makes them suspectible to the Sauravatar's activation script]
script "DVI-M04MonsterTags" (void)
{
 if (ModType == 1) // DVI
 {
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1104)
  {
   Thing_ChangeTID (0, 666);
  }
 }
 else
 if (ModType == 2) // DVII
 {
  if (GetLevelInfo(LEVELINFO_LEVELNUM) == 1214)
  {
   Thing_ChangeTID (0, 666);
  }
 }
}

// "Gravity" style Spell (used for fixed % damage based on CURRENT/REMAINING HP or CURRENT/REMAINING Invulnerability Timer)
script "DiabloistGravity" (int C5, int gravitytype)
{
 int C1, C2, C3;
 int basedmgratio;
 int AffectedStat, MultFactor, THEEffect;

 if (GetActorProperty(Player1TID,APROP_Health) < 1) terminate;

 //PrintBold(d:gravitytype);
 if (gravitytype == 0) // HP only
 {
  if (PowerupTimer[4] > 0) // If the character is Invulnerable, diminish their Invulnerability Timer
  {
   if (GameSkill() == SKILL_VERY_EASY) C5 = 63;  
   if (GameSkill() == SKILL_EASY) C5 = 125;  
   if (GameSkill() == SKILL_NORMAL) C5 = 250;  
   if (GameSkill() == SKILL_HARD) C5 = 375;  
   if (GameSkill() == SKILL_VERY_HARD) C5 = 437;  
   if (random(1,16) == 16) C5 = C5 * 2;
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0)
   {
    C3 = 300 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 300;
   }
   if (CharacterClass == 1)
   {
    C3 = 200 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 200;
   }
   if (CharacterClass == 2)
   {
    C3 = 150 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 150;
   }
   C2 = 1000 - C5;
 
   if (C5 < 0) C5 = 0;
   if (C5 > 0)
   {
    C1 = PowerupTimer[4];
    C1 = C1 * C2 / 1000;
 
    if (C1 < 1) C1 = 1;
    PowerupTimer[4] = C1;
    SetActorState(Player1TID,"InvulnFlashGravity");
   }
  }
  else // Otherwise affect their HP as per usual
  {
   if (GameSkill() == SKILL_VERY_EASY) C5 = 125;  
   if (GameSkill() == SKILL_EASY) C5 = 250;  
   if (GameSkill() == SKILL_NORMAL) C5 = 500;  
   if (GameSkill() == SKILL_HARD) C5 = 750;  
   if (GameSkill() == SKILL_VERY_HARD) C5 = 875;  
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0)
   {
    C3 = 300 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 300;
   }
   if (CharacterClass == 1)
   {
    C3 = 200 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 200;
   }
   if (CharacterClass == 2)
   {
    C3 = 150 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 150;
   }
   C2 = 1000 - C5;
 
   if (C5 < 0) C5 = 0;
   if (C5 > 0)
   {
    C1 = GetActorProperty(Player1TID,APROP_Health);
    C1 = C1 * C2 / 1000;
 
    if (C1 < 1) C1 = 1;
    SetActorProperty(Player1TID,APROP_Health,C1);
    SetActorState(Player1TID,"HPFlashGravity");
   }
  }
 }
 else
 if (gravitytype == 1) // Mana only
 {
  if (PowerupTimer[4] > 0) // If the character is Invulnerable, diminish their Invulnerability Timer
  {
   if (GameSkill() == SKILL_VERY_EASY) C5 = 63;  
   if (GameSkill() == SKILL_EASY) C5 = 125;  
   if (GameSkill() == SKILL_NORMAL) C5 = 250;  
   if (GameSkill() == SKILL_HARD) C5 = 375;  
   if (GameSkill() == SKILL_VERY_HARD) C5 = 437;  
   if (random(1,16) == 16) C5 = C5 * 2;
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0)
   {
    C3 = 300 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 300;
   }
   if (CharacterClass == 1)
   {
    C3 = 200 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 200;
   }
   if (CharacterClass == 2)
   {
    C3 = 150 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 150;
   }
   C2 = 1000 - C5;
 
   // PrintBold(d:C2);
 
   if (C5 < 0) C5 = 0;
   if (C5 > 0)
   {
    C1 = PowerupTimer[4];
    C1 = C1 * C2 / 1000;
 
    if (C1 < 1) C1 = 1;
 
    PowerupTimer[4] = C1;
    SetActorState(Player1TID,"InvulnFlashGravity");
   }
  }
  else // Otherwise affect their MP as per usual
  {
   if (GameSkill() == SKILL_VERY_EASY) C5 = 63;  
   if (GameSkill() == SKILL_EASY) C5 = 125;  
   if (GameSkill() == SKILL_NORMAL) C5 = 250;  
   if (GameSkill() == SKILL_HARD) C5 = 375;  
   if (GameSkill() == SKILL_VERY_HARD) C5 = 437;  
   if (random(1,16) == 16) C5 = C5 * 2;
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0)
   {
    C3 = 300 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 300;
   }
   if (CharacterClass == 1)
   {
    C3 = 200 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 200;
   }
   if (CharacterClass == 2)
   {
    C3 = 150 - MiscellaneousVars[36];
    if (C3 < 0) C3 = 0;
    C5 = C5 * C3 / 150;
   }
   C2 = 1000 - C5;
 
   // PrintBold(d:C2);
 
   if (C5 < 0) C5 = 0;
   if (C5 > 0)
   {
    C1 = CurrentMana;
    C1 = C1 * C2 / 1000;
 
    if (C1 < 0) C1 = 0;
 
    CurrentMana = C1;
    SetActorState(Player1TID,"ManaFlashGravity");
   }
  }
 }
 else
 if (gravitytype == 2) // HP & Mana
 {
  if (PowerupTimer[4] > 0) // If the character is Invulnerable, diminish their Invulnerability Timer
  {
   if (GameSkill() == SKILL_VERY_EASY) basedmgratio = 125; // 12.5% Base Damage
   if (GameSkill() == SKILL_EASY) basedmgratio = 250; // 25.0% Base Damage
   if (GameSkill() == SKILL_NORMAL) basedmgratio = 500; // 50.0% Base Damage
   if (GameSkill() == SKILL_HARD) basedmgratio = 750; // 75.0% Base Damage
   if (GameSkill() == SKILL_VERY_HARD) basedmgratio = 875; // 87.5% Base Damage
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0) THEEffect = 300 - MiscellaneousVars[36];
   if (CharacterClass == 1) THEEffect = 200 - MiscellaneousVars[36];
   if (CharacterClass == 2) THEEffect = 150 - MiscellaneousVars[36];
   if (THEEffect < 0) THEEffect = 0;
   if (CharacterClass == 0) basedmgratio = basedmgratio * THEEffect / 250;
   if (CharacterClass == 1) basedmgratio = basedmgratio * THEEffect / 200;
   if (CharacterClass == 2) basedmgratio = basedmgratio * THEEffect / 150;
   MultFactor = 1000 - basedmgratio;
 
   if (basedmgratio < 0) basedmgratio = 0;
   if (basedmgratio > 0)
   {
    AffectedStat = PowerupTimer[4] * MultFactor / 1000;
    if (AffectedStat < 1) AffectedStat = 1;
 
    PowerupTimer[4] = AffectedStat;
    SetActorState(Player1TID,"InvulnFlashGravity");
   }
  }
  else // Otherwise affect their HP & MP as per usual
  {
   if (GameSkill() == SKILL_VERY_EASY) basedmgratio = 125; // 12.5% Base Damage
   if (GameSkill() == SKILL_EASY) basedmgratio = 250; // 25.0% Base Damage
   if (GameSkill() == SKILL_NORMAL) basedmgratio = 500; // 50.0% Base Damage
   if (GameSkill() == SKILL_HARD) basedmgratio = 750; // 75.0% Base Damage
   if (GameSkill() == SKILL_VERY_HARD) basedmgratio = 875; // 87.5% Base Damage
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0) THEEffect = 300 - MiscellaneousVars[36];
   if (CharacterClass == 1) THEEffect = 200 - MiscellaneousVars[36];
   if (CharacterClass == 2) THEEffect = 150 - MiscellaneousVars[36];
   if (THEEffect < 0) THEEffect = 0;
   if (CharacterClass == 0) basedmgratio = basedmgratio * THEEffect / 250;
   if (CharacterClass == 1) basedmgratio = basedmgratio * THEEffect / 200;
   if (CharacterClass == 2) basedmgratio = basedmgratio * THEEffect / 150;
   MultFactor = 1000 - basedmgratio;
 
   if (basedmgratio < 0) basedmgratio = 0;
   if (basedmgratio > 0)
   {
    AffectedStat = GetActorProperty(Player1TID,APROP_Health) * MultFactor / 1000;
    if (AffectedStat < 1) AffectedStat = 1;
 
    SetActorProperty(Player1TID,APROP_Health,AffectedStat);
   }
 
   if (GameSkill() == SKILL_VERY_EASY) basedmgratio = 63; // 6.3%
   if (GameSkill() == SKILL_EASY) basedmgratio = 125; // 12.5%
   if (GameSkill() == SKILL_NORMAL) basedmgratio = 250; // 25.0%
   if (GameSkill() == SKILL_HARD) basedmgratio = 375; // 37.5%
   if (GameSkill() == SKILL_VERY_HARD) basedmgratio = 437; // 43.7%
   if (random(1,16) == 16) basedmgratio = basedmgratio * 2;
   // SeedTHE Levels
   // Deggaris = 300 Needed to max out
   // Illucia = 200 Needed to max out
   // Flora = 150 Needed to max out
   if (CharacterClass == 0) THEEffect = 300 - MiscellaneousVars[36];
   if (CharacterClass == 1) THEEffect = 200 - MiscellaneousVars[36];
   if (CharacterClass == 2) THEEffect = 150 - MiscellaneousVars[36];
   if (THEEffect < 0) THEEffect = 0;
   if (CharacterClass == 0) basedmgratio = basedmgratio * THEEffect / 250;
   if (CharacterClass == 1) basedmgratio = basedmgratio * THEEffect / 200;
   if (CharacterClass == 2) basedmgratio = basedmgratio * THEEffect / 150;
   MultFactor = 1000 - basedmgratio;
 
   if (basedmgratio < 0) basedmgratio = 0;
   if (basedmgratio > 0)
   {
    AffectedStat = CurrentMana * MultFactor / 1000;
 
    if (AffectedStat < 0) AffectedStat = 0;
 
    CurrentMana = AffectedStat;
 
    SetActorState(Player1TID,"HPManaFlashGravity");
   }
  }
 }

}

// Checks a stat through ACS. :P
script "CheckStat" (int stattype)
{
 int result;
 if (stattype == 0) { result = PlayerLevel; } // Level
 if (stattype == 1) { result = GetActorProperty(Player1TID,APROP_Health); } // Current Health
 if (stattype == 2) { result = MaxHealthTrue; } // Max Health
 if (stattype == 3) { result = CurrentMana; } // Current Mana
 if (stattype == 4) { result = MaxMana; } // Max Mana
 if (stattype == 5) { result = CheckActorInventory(Player1TID,"Armor"); } // Current Armor
 if (stattype == 6) { result = CurrentMaxArmor; } // Max Armor
 if (stattype == 7) { result = HellcoreOverheatLevel; } // Current Hellcore Heat
 if (stattype == 8) { } // Max Hell Core Heat
 if (stattype == 9) { result = MiscellaneousVars[21]; } // Current Stamina
 if (stattype == 10) { result = MiscellaneousVars[22]; } // Max Stamina
 if (stattype == 11) { result = MiscellaneousVars[25]; } // Current Aeon Points
 if (stattype == 12) { result = MiscellaneousVars[31]; } // Agility
 if (stattype == 13) { result = MiscellaneousVars[32]; } // Defense
 if (stattype == 14) { result = MiscellaneousVars[33]; } // Deftness
 if (stattype == 15) { result = MiscellaneousVars[34]; } // Sorcery
 if (stattype == 16) { result = MiscellaneousVars[35]; } // Strength
 if (stattype == 17) { result = MiscellaneousVars[36]; } // Therapeusis
 SetResultValue(result);
}

script "GetBuffTimer" (int bufftype)
{
 // [0] - Light
 // [1] - Invisibility
 // [2] - Flight
 // [3] - Stealth
 // [4] - Invulnerability
 // [5] - Time Freeze
 // [6] - Fear/Terror Aura
 // [7] - Divine Avatar
 // [8] - Spreader Aura Lv. 1
 // [9] - Spreader Aura Lv. 2
 // [10] - Oomph [aka Bikill] (2x damage, up to +8% crit rate)
 // [11] - Buff (2x defense, up to +10% survival rate, 2x balance)
 // [12] - Accelerate (1.33x Speed, up to +10% evade rate, 1.25x jumping)

 // [13] - Blunt (0.5x damage, down to -8% crit rate)
 // [14] - Sap (0.5x defense, down to -10% survival rate, 0.75x balance)
 // [15] - Decelerate (0.66x Speed, down to -10% evade rate, 0.875x jumping)
 // [16] - Poison (HP/Health is damaged every so many tics, down to as low as 1 [cannot kill the player])
 // [17] - Corrosion (AP/Armor is damaged every so many tics, down to as low as 0)
 // [18] - Fatigue (HP/Mana/Stamina Regeneration and Hellcore Cooldown are drastically reduced in speed)
 // [19] - Blind (exactly as on the tin :V)
 // [20] - Sleep (can't move, see or perform actions, 1.25x more damage from attacks, however HP/MP/Stamina regeneration rates are 5x)
 // [21] - Silence/Mute (spells are locked out)
 // [22] - RadSuit (mostly a proper timer for the radsuit)
 // [23] - Berserk (mostly a proper timer for the berserk powerup)
 // [24] - Regen (HP/MP/Stamina regeneration rates are 10x)
 
 // [129] - ??????
 
 SetResultValue(PowerupTimer[bufftype]);
}

// Redone Buff Checker (allows additive buff timers from spells and powerup items) [must use the "DoomSpellACS" actor on a map to make this work!]
script "CheckBuffTimers" ENTER
{
 int G1, G2, G3, C1, C2, C3, I1, I2, I3, D1;
 int BaseTimerIncrement;
 int DoveRegenTimer;
 int DivineRegenTimer;
 int xpos, xposint, ypos, yposint;
 int MaxHealthLimit = MaxHealthTrue * 2;

 int overallhudalpha = GetCVar("dvdsoldhud_generaltransperancy");
 int msgalpha;
 
 // Light/Infared
 SetHudSize(704,528,0); // 640,480 //  SetHudSize(960,720,0);
 xpos = 0.1; // 0% [left side]
 ypos = 209.0; // 210.0; // 90% [towards bottom]
 yposint = 11.0;
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[0] > 0)
 {
  GiveActorInventory(Player1TID,"NightVisionSpell",1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Light: ",d:(PowerupTimer[0]/35),s:" Secs";HUDMSG_ALPHA,3433,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[0] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID,"NightVisionSpell",0x7FFFFFFF);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Invisibility
 if (CheckActorInventory(Player1TID, "InvisAttack1") > 0) TakeActorInventory(Player1TID, "InvisAttack1", 1);
 if (CheckActorInventory(Player1TID, "InvisDefense1") > 0) TakeActorInventory(Player1TID, "InvisDefense1", 1);
 if (CheckActorInventory(Player1TID, "InvisAttack2") > 0) TakeActorInventory(Player1TID, "InvisAttack2", 1);
 if (CheckActorInventory(Player1TID, "InvisDefense2") > 0) TakeActorInventory(Player1TID, "InvisDefense2", 1);
 if (CheckActorInventory(Player1TID, "InvisAttack3") > 0) TakeActorInventory(Player1TID, "InvisAttack3", 1);
 if (CheckActorInventory(Player1TID, "InvisDefense3") > 0) TakeActorInventory(Player1TID, "InvisDefense3", 1);
 if (CheckActorInventory(Player1TID, "InvisAttack4") > 0) TakeActorInventory(Player1TID, "InvisAttack4", 1);
 if (CheckActorInventory(Player1TID, "InvisDefense4") > 0) TakeActorInventory(Player1TID, "InvisDefense4", 1);
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);

 MiscellaneousVars[141]++;
 if (MiscellaneousVars[141] >= 40) MiscellaneousVars[141] -= 40;
 if (MiscellaneousVars[141] == 0 || MiscellaneousVars[141] == 20 || MiscellaneousVars[141] == 40) MiscFixedVars[101] = 0.20;
 if (MiscellaneousVars[141] == 1 || MiscellaneousVars[141] == 19) MiscFixedVars[101] = 0.205;
 if (MiscellaneousVars[141] == 2 || MiscellaneousVars[141] == 18) MiscFixedVars[101] = 0.21;
 if (MiscellaneousVars[141] == 3 || MiscellaneousVars[141] == 17) MiscFixedVars[101] = 0.215;
 if (MiscellaneousVars[141] == 4 || MiscellaneousVars[141] == 16) MiscFixedVars[101] = 0.22;
 if (MiscellaneousVars[141] == 5 || MiscellaneousVars[141] == 15) MiscFixedVars[101] = 0.225;
 if (MiscellaneousVars[141] == 6 || MiscellaneousVars[141] == 14) MiscFixedVars[101] = 0.23;
 if (MiscellaneousVars[141] == 7 || MiscellaneousVars[141] == 13) MiscFixedVars[101] = 0.235;
 if (MiscellaneousVars[141] == 8 || MiscellaneousVars[141] == 12) MiscFixedVars[101] = 0.24;
 if (MiscellaneousVars[141] == 9 || MiscellaneousVars[141] == 11) MiscFixedVars[101] = 0.245;
 if (MiscellaneousVars[141] == 10) MiscFixedVars[101] = 0.25;
 if (MiscellaneousVars[141] == 21 || MiscellaneousVars[141] == 39) MiscFixedVars[101] = 0.195;
 if (MiscellaneousVars[141] == 22 || MiscellaneousVars[141] == 38) MiscFixedVars[101] = 0.19;
 if (MiscellaneousVars[141] == 23 || MiscellaneousVars[141] == 37) MiscFixedVars[101] = 0.185;
 if (MiscellaneousVars[141] == 24 || MiscellaneousVars[141] == 36) MiscFixedVars[101] = 0.18;
 if (MiscellaneousVars[141] == 25 || MiscellaneousVars[141] == 35) MiscFixedVars[101] = 0.175;
 if (MiscellaneousVars[141] == 26 || MiscellaneousVars[141] == 34) MiscFixedVars[101] = 0.17;
 if (MiscellaneousVars[141] == 27 || MiscellaneousVars[141] == 33) MiscFixedVars[101] = 0.165;
 if (MiscellaneousVars[141] == 28 || MiscellaneousVars[141] == 32) MiscFixedVars[101] = 0.16;
 if (MiscellaneousVars[141] == 29 || MiscellaneousVars[141] == 31) MiscFixedVars[101] = 0.155;
 if (MiscellaneousVars[141] == 30) MiscFixedVars[101] = 0.15;

 if (PowerupTimer[1] > 0)
 {
  GiveActorInventory(Player1TID,"InvisiblitySpell",1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Invisibility: ",d:(PowerupTimer[1]/35),s:" Secs";HUDMSG_ALPHA,3434,cr_white,xpos,ypos,0.03,msgalpha);
  if (random(1,100) > 25) // 75% chance of the level 1 version
  {
   if (CheckActorInventory(Player1TID, "InvisAttack1") < 1) GiveActorInventory(Player1TID, "InvisAttack1", 1); // +25% Damage Dealt
   if (CheckActorInventory(Player1TID, "InvisDefense1") < 1) GiveActorInventory(Player1TID, "InvisDefense1", 1); // -20% Damage Taken
  }
  else
  {
   if (random(1,100) > 25) // 18.75% chance of the level 2 version
   {
    if (CheckActorInventory(Player1TID, "InvisAttack2") < 1) GiveActorInventory(Player1TID, "InvisAttack2", 1); // +50% Damage Dealt
    if (CheckActorInventory(Player1TID, "InvisDefense2") < 1) GiveActorInventory(Player1TID, "InvisDefense2", 1); // -33.3% Damage Taken
   }
   else
   {
    if (random(1,100) > 25) // 4.6875% chance of the level 3 version
    {
     if (CheckActorInventory(Player1TID, "InvisAttack3") < 1) GiveActorInventory(Player1TID, "InvisAttack3", 1); // +75% Damage Dealt
     if (CheckActorInventory(Player1TID, "InvisDefense3") < 1) GiveActorInventory(Player1TID, "InvisDefense3", 1); // -42.86% Damage Taken
    }
    else // 1.5625% chance of the level 4 version
    {
     if (CheckActorInventory(Player1TID, "InvisAttack4") < 1) GiveActorInventory(Player1TID, "InvisAttack4", 1); // +100% Damage Dealt
     if (CheckActorInventory(Player1TID, "InvisDefense4") < 1) GiveActorInventory(Player1TID, "InvisDefense4", 1); // -50% Damage Taken
    }
   }
  }
  If (MenuSystemVars[0] == 0) PowerupTimer[1] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID,"InvisiblitySpell",0x7FFFFFFF);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Flight
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[2] > 0)
 {
  GiveActorInventory(Player1TID,"FlightSpell",1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Flight: ",d:(PowerupTimer[2]/35),s:" Secs";HUDMSG_ALPHA,3435,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[2] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID,"FlightSpell",0x7FFFFFFF);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Stealth
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[3] > 0)
 {
  SetPlayerProperty(1,1,PROP_NOTARGET);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Stealth: ",d:(PowerupTimer[3]/35),s:" Secs";HUDMSG_ALPHA,3436,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[3] -= 1;
 }
 else
 {
  SetPlayerProperty(1,0,PROP_NOTARGET);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Invulnerability
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[4] > 0)
 {
  GiveActorInventory(Player1TID,"InvulnerabilitySpell", 1); // SetPlayerProperty(1,1,PROP_INVULNERABILITY);
  GiveActorInventory(Player1TID,"IsInvulnerable",1);
  //if (ThingCountName("InvulnerabilityAura", 1503) < 1) SpawnForced("InvulnerabilityAura",GetActorX(1001),GetActorY(1001),(GetActorZ(1001)+(25*65536)),1503,0);

  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Invulnerability: ",d:(PowerupTimer[4]/35),s:" Secs";HUDMSG_ALPHA,3437,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[4] -= 1;
 }
 else
 {
  //if (ThingCountName("InvulnerabilityAura", 1503) > 0) Thing_Remove(1503);
  TakeActorInventory(Player1TID,"IsInvulnerable",0x7FFFFFFF);
  TakeActorInventory(Player1TID,"InvulnerabilitySpell", 9999); // SetPlayerProperty(1,0,PROP_INVULNERABILITY);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Time Stop
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[5] > 0)
 {
  GiveActorInventory(Player1TID, "AetheriusTimeFreezer", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Time Freeze: ",d:(PowerupTimer[5]/35),s:" Secs";HUDMSG_ALPHA,3438,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[5] -= 1;
 }
 else
 {
  if (MenuSystemVars[0] == 0) TakeActorInventory(Player1TID, "AetheriusTimeFreezer", 9999);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Fear Aura Effects
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[6] > 0)
 {
  GiveActorInventory(Player1TID, "PowerFrightener", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Fear Aura: ",d:(PowerupTimer[6]/35),s:" Secs";HUDMSG_ALPHA,3439,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[6] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "PowerFrightener", 9999);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Divine Avatar Effects
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[7] > 0)
 {
  GiveActorInventory(Player1TID, "DivineAvatarDamage", 1);
  GiveActorInventory(Player1TID, "DivineAvatarDefense", 1);
  GiveActorInventory(Player1TID, "PowerDoubleFiringSpeed", 1);
  GiveActorInventory(Player1TID, "DivineAvatarHighJump", 1);

  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Divine Avatar: ",d:(PowerupTimer[7]/35),s:" Secs";HUDMSG_ALPHA,3440,cr_white,xpos,ypos,0.03,msgalpha);
    
  If (MenuSystemVars[0] == 0) PowerupTimer[7] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "DivineAvatarDamage", 9999);
  TakeActorInventory(Player1TID, "DivineAvatarDefense", 9999);
  TakeActorInventory(Player1TID, "PowerDoubleFiringSpeed", 9999);
  TakeActorInventory(Player1TID, "DivineAvatarHighJump", 9999);
 }

 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 // Speader Aura Lv. 1 Effects
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[9] > 0)
 {
  PowerupTimer[8] = 0;
  TakeActorInventory(Player1TID, "SpreaderAura1", 9999);
 }
 else
 {
  if (PowerupTimer[8] > 0)
  {
   GiveActorInventory(Player1TID, "SpreaderAura1", 1);
   if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Spread-Aura Lv. 1: ",d:(PowerupTimer[8]/35),s:" Secs";HUDMSG_ALPHA,3441,cr_white,xpos,ypos,0.03,msgalpha);
   If (MenuSystemVars[0] == 0) PowerupTimer[8] -= 1;
  }
  else
  {
   TakeActorInventory(Player1TID, "SpreaderAura1", 9999);
  }
 }

 // Speader Aura Lv. 2 Effects
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[9] > 0)
 {
  GiveActorInventory(Player1TID, "SpreaderAura2", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Spread-Aura Lv. 2: ",d:(PowerupTimer[9]/35),s:" Secs";HUDMSG_ALPHA,3441,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[9] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "SpreaderAura2", 9999);
 }

 // Oomph Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[10] > 0)
 {
  GiveActorInventory(Player1TID, "OomphDQSpell", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Oomph: ",d:(PowerupTimer[10]/35),s:" Secs";HUDMSG_ALPHA,3442,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[10] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "OomphDQSpell", 9999);
 }

 // Buff Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[11] > 0)
 {
  GiveActorInventory(Player1TID, "BuffDQSpell", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Buff: ",d:(PowerupTimer[11]/35),s:" Secs";HUDMSG_ALPHA,3443,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[11] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "BuffDQSpell", 9999);
 }

 // Buff Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[12] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Acceleratle: ",d:(PowerupTimer[12]/35),s:" Secs";HUDMSG_ALPHA,3443,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[12] -= 1;
 }

 // Blunt Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[13] > 0)
 {
  GiveActorInventory(Player1TID, "BluntDQSpell", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Blunt: ",d:(PowerupTimer[13]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[13] -= BaseTimerIncrement;
 }
 else
 {
  TakeActorInventory(Player1TID, "BluntDQSpell", 9999);
 }
 
 // Sap Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[14] > 0)
 {
  GiveActorInventory(Player1TID, "SapDQSpell", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Sap: ",d:(PowerupTimer[14]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[14] -= BaseTimerIncrement;
 }
 else
 {
  TakeActorInventory(Player1TID, "SapDQSpell", 9999);
 }
 
 // Deceleratle Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[15] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Deceleratle: ",d:(PowerupTimer[15]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[15] -= BaseTimerIncrement;
 }
 
 // Poison Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[16] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Poison: ",d:(PowerupTimer[16]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[16] -= BaseTimerIncrement;
 }
 else
 {
 }

 // Corrosion Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[17] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Corrosion: ",d:(PowerupTimer[17]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[17] -= BaseTimerIncrement;
 }
 else
 {
  //TakeActorInventory(Player1TID, "SleepDMGPenalty", 9999);
 }

 // Fatigue Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[18] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Fatigue: ",d:(PowerupTimer[18]/35),s:" Secs";HUDMSG_ALPHA,3446,cr_white,xpos,ypos,0.03,msgalpha);
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[18] -= BaseTimerIncrement;
 }
 else
 {
  //TakeActorInventory(Player1TID, "SleepDMGPenalty", 9999);
 }

 // Blind Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[19] > 0)
 {
  GiveActorInventory(Player1TID, "BlindDMGPenalty", 1);
  if (random(1,16) == 1) GiveActorInventory(Player1TID, "SuperBlindDMGPenalty", 1); else TakeActorInventory(Player1TID, "SuperBlindDMGPenalty", 9999);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Blind: ",d:(PowerupTimer[19]/35),s:" Secs";HUDMSG_ALPHA,3447,cr_white,xpos,ypos,0.03,msgalpha);
  MiscellaneousVars[248] += 1;
  if (MiscellaneousVars[248] == 1)
  {
   if (CharacterClass == 2) { StopSound(Player1TID,CHAN_VOICE); PlaySound(Player1TID,"FloraGotBlinded",CHAN_VOICE,1.0,0,ATTN_NORM); }
  }
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[19] -= BaseTimerIncrement;
 }
 else
 {
  TakeActorInventory(Player1TID, "BlindDMGPenalty", 9999);
  TakeActorInventory(Player1TID, "SuperBlindDMGPenalty", 9999);
  MiscellaneousVars[248] = 0;
 }

 // Sleep Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[20] > 0)
 {
  GiveActorInventory(Player1TID, "SleepDMGPenalty", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Sleep: ",d:(PowerupTimer[20]/35),s:" Secs";HUDMSG_ALPHA,3448,cr_white,xpos,ypos,0.03,msgalpha);
  MiscellaneousVars[249] += 1;
  if (MiscellaneousVars[249] == 1)
  {
   PlaySound(Player1TID,"DraQue/fallasleep",CHAN_5,1.0,0,ATTN_NORM);
   if (CharacterClass == 2) { StopSound(Player1TID,CHAN_VOICE); PlaySound(Player1TID,"FloraFallAsleep",CHAN_VOICE,1.0,0,ATTN_NORM); }
  }
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[20] -= BaseTimerIncrement;
 }
 else
 {
  TakeActorInventory(Player1TID, "SleepDMGPenalty", 9999);
  MiscellaneousVars[249] = 0;
 }

 // Silence Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[21] > 0)
 {
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Silence: ",d:(PowerupTimer[21]/35),s:" Secs";HUDMSG_ALPHA,3448,cr_white,xpos,ypos,0.03,msgalpha);
  MiscellaneousVars[270] += 1;
  if (MiscellaneousVars[270] == 1)
  {
   PlaySound(Player1TID,"DraQue/sealed",CHAN_5,1.0,0,ATTN_NORM);
   // if (CharacterClass == 2) { StopSound(Player1TID,CHAN_VOICE); PlaySound(Player1TID,"FloraSpSealed",CHAN_VOICE,1.0,0,ATTN_NORM); }
  }
  BaseTimerIncrement = 1; 
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && random(1,6) == 1) BaseTimerIncrement += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0 && random(1,12) == 1) BaseTimerIncrement += 1;
  if (PowerupTimer[7] > 0) BaseTimerIncrement *= 2;
  If (MenuSystemVars[0] == 0) PowerupTimer[21] -= BaseTimerIncrement;
 }
 else
 {
  MiscellaneousVars[270] = 0;
 }

 // RadSphere Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[22] > 0)
 {
  if (ClassicDoomType == 4) GiveActorInventory(Player1TID, "PowerMask", 1); else GiveActorInventory(Player1TID, "PowerIronFeet", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"BioShield: ",d:(PowerupTimer[22]/35),s:" Secs";HUDMSG_ALPHA,3444,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[22] -= 1;
 }
 else
 {
  if (ClassicDoomType == 4) TakeActorInventory(Player1TID, "PowerMask", 9999); else TakeActorInventory(Player1TID, "PowerIronFeet", 9999);
 }

 // Berserk Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[23] > 0)
 {
  GiveActorInventory(Player1TID, "PowerStrength", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Berserk: ",d:(PowerupTimer[23]/35),s:" Secs";HUDMSG_ALPHA,3445,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[23] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "PowerStrength", 9999);
 }

 // Regen Effects
 ypos = ypos + yposint; // 210.0; // 90% [towards bottom]
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[24] > 0)
 {
  GiveActorInventory(Player1TID, "PowerStrength", 1);
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[2000] == 0) HudMessageBold(s:"Berserk: ",d:(PowerupTimer[24]/35),s:" Secs";HUDMSG_ALPHA,3445,cr_white,xpos,ypos,0.03,msgalpha);
  If (MenuSystemVars[0] == 0) PowerupTimer[24] -= 1;
 }
 else
 {
 //
 }


 // GoE?? Effects
 msgalpha = 1.0; msgalpha = FixedMul(msgalpha,overallhudalpha);
 if (PowerupTimer[129] > 0)
 {
  GiveActorInventory(Player1TID, "GoEDamageBonus", 1);
  GiveActorInventory(Player1TID, "GoEDefenseBonus", 1);
  // (GoE is intended as a "permenant buff" once activated. To disable this and make it time elasped, uncomment the line below)
  // PowerupTimer[129] -= 1;
 }
 else
 {
  TakeActorInventory(Player1TID, "GoEDamageBonus", 9999);
  TakeActorInventory(Player1TID, "GoEDefenseBonus", 9999);
 }
 SetHudSize(0,0,0);

 Delay(1);
 Restart;
}


// Enforces Giving or Removing Buffs when certain powerup timers are on/off
script "GiveBuffsPowerup" (int powertype, int powertimeadd)
{
 // powertype = Powerup Type
 // powertimeadd = Powerup Timer Additive
 int G1, G2, G3, C1, C2, C3, I1, I2, I3;

 powertimeadd *= 35;
 powertimeadd = powertimeadd * (MiscellaneousVars[10050] + 4) / 4;
 if (powertype == 0) // Light/Infared
 {
  PowerupTimer[0] += powertimeadd;
  if (PowerupTimer[0] > 0) GiveActorInventory(Player1TID,"NightVisionSpell",1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -7;
 }
 if (powertype == 1) // Invisibility
 {
  PowerupTimer[1] += powertimeadd;
  if (PowerupTimer[1] > 0) GiveActorInventory(Player1TID,"InvisiblitySpell",1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -1;
 }
 if (powertype == 2) // Flight
 {
  PowerupTimer[2] += powertimeadd;
  if (PowerupTimer[2] > 0) GiveActorInventory(Player1TID,"FlightSpell",1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -2;
 }
 if (powertype == 3) // Stealth
 {
  PowerupTimer[3] += powertimeadd;
  // if (PowerupTimer[3] > 0) SetPlayerProperty(1,1,PROP_NOTARGET);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -6;
 }
 if (powertype == 4) // Invulnerability
 {
  PowerupTimer[4] += powertimeadd;
  if (PowerupTimer[4] > 0) GiveActorInventory(Player1TID, "InvulnerabilitySpell", 1); // SetPlayerProperty(1,1,PROP_INVULNERABILITY);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -5;
 }
 if (powertype == 5) // Time Freeze
 {
  PowerupTimer[5] += powertimeadd;
  if (PowerupTimer[5] > 0) GiveActorInventory(Player1TID, "AetheriusTimeFreezer", 1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -4;
 }
 if (powertype == 6) // Fear Aura
 {
  PowerupTimer[6] += powertimeadd;
  if (PowerupTimer[6] > 0) GiveActorInventory(Player1TID, "PowerFrightener", 1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -3;
 }
 if (powertype == 7) // Divine Avatar
 {
  PowerupTimer[7] += powertimeadd;
  if (PowerupTimer[7] > 0)
  {
   GiveActorInventory(Player1TID, "DivineAvatarDamage", 1);
   GiveActorInventory(Player1TID, "DivineAvatarDefense", 1);
   GiveActorInventory(Player1TID, "PowerDoubleFiringSpeed", 1);
   GiveActorInventory(Player1TID, "DivineAvatarHighJump", 1);
  }
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 5;
 }
 if (powertype == 8) // Spreader Aura Lv. 1
 {
  if (PowerupTimer[9] == 0) // If lacking the Lv. 2 Aura, add to the Lv. 1
  {
   PowerupTimer[8] += powertimeadd;
   if (PowerupTimer[8] > 0) GiveActorInventory(Player1TID, "SpreaderAura1", 1);
   MiscellaneousVars[2040] = 70;
   MiscellaneousVars[2045] = 6;
  }
  else // If possessing Lv. 2 aura, give the player the timer divided by 5 or 6 instead and add to the second level aura.
  {
   if (PowerupTimer[8] > 0) TakeActorInventory(Player1TID, "SpreaderAura1", 1);
   PowerupTimer[8] = 0;
   powertimeadd = powertimeadd / random(5,6);
   PowerupTimer[9] += powertimeadd;
   if (PowerupTimer[9] > 0) GiveActorInventory(Player1TID, "SpreaderAura2", 1);
   MiscellaneousVars[2040] = 70;
   MiscellaneousVars[2045] = 7;
  }
 }
 if (powertype == 9) // Spreader Aura Lv. 2
 {
  PowerupTimer[9] += powertimeadd;
  if (PowerupTimer[9] > 0) GiveActorInventory(Player1TID, "SpreaderAura2", 1);
  if (PowerupTimer[8] > 0) { TakeActorInventory(Player1TID, "SpreaderAura1", 1); PowerupTimer[8] = 0; }
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 7;
 }
 if (powertype == 10) // Oomph [double damage from player]
 {
  PowerupTimer[10] += powertimeadd;
  if (PowerupTimer[10] > 0) GiveActorInventory(Player1TID, "OomphDQSpell", 1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 0;
 }
 if (powertype == 11) // Buff [-50% damage to player]
 {
  PowerupTimer[11] += powertimeadd;
  if (PowerupTimer[11] > 0) GiveActorInventory(Player1TID, "BuffDQSpell", 1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 1;
 }
 if (powertype == 12) // Acceleratle [+33% speed for player]
 {
  PowerupTimer[12] += powertimeadd;
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 2;
 }

 if (powertype == 22) // RadSuit [IronFeet, protection from most damage floors]
 {
  PowerupTimer[22] += powertimeadd;
  if (PowerupTimer[22] > 0)
  {
   if (ClassicDoomType == 4) GiveActorInventory(Player1TID, "PowerMask", 1); else GiveActorInventory(Player1TID, "PowerIronFeet", 1);
  }
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = -8;
 }
 if (powertype == 23) // Berserk [10x damage on exertion based melee attacks]
 {
  PowerupTimer[23] += powertimeadd;
  if (PowerupTimer[23] > 0) GiveActorInventory(Player1TID, "PowerStrength", 1);
  MiscellaneousVars[2040] = 70;
  MiscellaneousVars[2045] = 4;
 }
 if (powertype == 129) // GoE??
 {
  PowerupTimer[129] += powertimeadd;
  if (PowerupTimer[129] > 0)
  {
   GiveActorInventory(Player1TID, "GoEDamageBonus", 1);
   GiveActorInventory(Player1TID, "GoEDefenseBonus", 1);
  }
 }
}

// Screen Flash for Diabloist's Gravity Attack
script "DiabloistGravityFlash" (int C5)
{ 
 if (C5 == 0) FadeRange(192,0,0,1.25,192,0,0,0,1.125);
 if (C5 == 1) FadeRange(0,0,192,1.25,0,0,192,0,1.125);
 if (C5 == 2) FadeRange(192,192,192,1.25,192,192,192,0,1.125);
 if (C5 == 3) FadeRange(192,0,192,1.25,192,0,192,0,1.125);
}


// Makes Armor Bonuses check for Flora's presense in the game in order to change them over to other items [this version is for when playing classic Doom 1/2]
script "ClassicDoom2ArmorCheck" (void)
{
 if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
 {
  if (CharacterClass == 0) SetResultValue(3);
  if (CharacterClass == 1) SetResultValue(4);
  if (CharacterClass == 2) SetResultValue(5); // Sets to 5 so the item can know to transform into another set of items if Flora is detected as the current character.
  if (CharacterClass == 8) SetResultValue(5); // Ailish and Petra don't get to encounter traditional Doom armor either.
  if (CharacterClass == 9) SetResultValue(5);
 }
 else
 {
  if (CharacterClass == 0) SetResultValue(0);
  if (CharacterClass == 1) SetResultValue(1);
  if (CharacterClass == 2) SetResultValue(2); // Sets to 2 so the item can know to transform into another set of items if Flora is detected as the current character.
  if (CharacterClass == 8) SetResultValue(2); // Sets to 2 so the item can know to transform into another set of items if Flora is detected as the current character.
  if (CharacterClass == 9) SetResultValue(2); // Sets to 2 so the item can know to transform into another set of items if Flora is detected as the current character.
 }
}

script "CheckChainsaw" (void)
{

 if (CheckActorInventory(Player1TID,"DoubleBladedChainsaw") > 0) SetResultValue(2);
 else if (CheckActorInventory(Player1TID,"Chainsaw2") > 0) SetResultValue(1);
 else SetResultValue(0);
}

// Keeps Diabloist Locked on players as targets.
script "DiabloistGravityLock" (void)
{
 Thing_Hate(0,Player1TID,0);
}

// Accmulate EXP for Sceptre
script "AddSceptreEXP" (int SExPts, int Check2, int DivAmount)
{
 int C1, C2;
 int EXPBonus1;
 int BossEnemy;

 if (ModType == 0 && GetCVar("dvds_noscexpgains") != 0) terminate;

 if (BossEnemy != 0) DivAmount *= 10;
 if (DivAmount <= 1) DivAmount = 1;

 if (CharacterClass != 2) terminate;
 if (CharacterClass == 2)
 {
  if (Check2 > 0)
  {
   C2 = 16 - SceptreActualLevel;
   if (C2 < 1) C2 += 16;
   if (C2 > 16) C2 -= 16;

   EXPBonus1 = 1000;
   // Pearly Corset [+5/10% EXP Bonus]
   if (CheckActorInventory(Player1TID,"SafeTeaShoes")) 
   {
    if (random(1,100) <= 5) EXPBonus1 += 100; // 5% Chance of +10% EXP Bonus
    else EXPBonus1 += 50; // Else +5% EXP Bonus
   }
   // Pearly Corset [+30/45% EXP Bonus]
   if (CheckActorInventory(Player1TID,"PearlyCorset")) 
   {
    if (random(1,100) <= 5) EXPBonus1 += 450; // 5% Chance of +45% EXP Bonus
    else EXPBonus1 += 300; // Else +30% EXP Bonus
   }
   // Dove's [+5/10% EXP Bonus]
   if (CheckActorInventory(Player1TID,"DoveRibbon")) 
   {
    if (random(1,100) <= 5) EXPBonus1 += 100; // 5% Chance of +10% EXP Bonus
    else EXPBonus1 += 50; // Else +5% EXP Bonus
   }
   C2 = C2 * EXPBonus1 / 1000;

   EXPBonus1 = 1000;
   // Divine Avatar {+25% EXP Bonus]
   if (PowerupTimer[7] > 0)
   {
    if (random(1,100) <= 20) EXPBonus1 += 500; // 20% Chance of +50% EXP Bonus
    else EXPBonus1 += 250; // 20% Else +25% EXP Bonus
   }
   C2 = C2 * EXPBonus1 / 1000;
   C2 = C2 * (GetCVar("dvds_deftnessexpbase") + MiscellaneousVars[40]) / GetCVar("dvds_deftnessexpbase");
   C2 = C2 * GetCVar("dvds_sceptreexpmultiplier") / 100;

   // "Higher Learning" Grand Mastery Perk
   if (MiscellaneousVars[11001] == 1) C2 = C2 * 23 / 20; // [115%]
   if (MiscellaneousVars[11001] == 2) C2 = C2 * 13 / 10; // [130%]
 
   if (ModType == 0) C2 = C2 * 4 / 3; // Classic Doom 1/2 / Heretic / Hexen / Strife
   MiscellaneousVars[203] += C2;


   // PrintBold(d:C2);
   while (MiscellaneousVars[203] > 15) // if (MiscellaneousVars[203] > 15)
   {
    MiscellaneousVars[203] -= 16;
    SceptreLevelEXP += 1;
   }
  }
  else
  {
   if (GetUserVariable(0,"user_MaxHP") > 0) SExPts = GetUserVariable(0,"user_MaxHP"); else SExPts = GetActorProperty(0,APROP_SpawnHealth);
   if (ModType == 0) SExPts = SExPts * 4 / 3; // Classic Doom 1/2 / Heretic / Hexen / Strife
   SExPts *= 16; // * 16 is because each full Sceptre EXP Point is 16 "fragments".
   SExPts = SExPts / 300;

   // Check for if the monster calling the script is a boss or strong monster [to cut down on SExp Gains]
   if (CheckActorClass(0, "Benellus1DS")) DivAmount *= 16;
   if (CheckActorClass(0, "Benellus2DS")) DivAmount *= 16;
   if (CheckActorClass(0, "Benellus3DS")) DivAmount *= 16;
   if (CheckActorClass(0, "DragonNew")) DivAmount *= 16;
   if (CheckActorClass(0, "HeresiarchNew")) DivAmount *= 16;
   if (CheckActorClass(0, "ClericBossNew")) DivAmount *= 16;
   if (CheckActorClass(0, "MageBossNew")) DivAmount *= 16;
   if (CheckActorClass(0, "FighterBossNew")) DivAmount *= 16;
   if (CheckActorClass(0, "DSparilMountedNew")) DivAmount *= 12; // 12
   if (CheckActorClass(0, "DSparilUnmountedNew")) DivAmount *= 16;
   if (CheckActorClass(0, "KoraxNew")) DivAmount *= 16;
   if (CheckActorClass(0, "Zakachi")) DivAmount *= 16;
   if (CheckActorClass(0, "AvatarNew")) DivAmount *= 16; // 32
   if (CheckActorClass(0, "ProgrammerNew")) DivAmount *= 16;
   if (CheckActorClass(0, "StrifeBishopNew")) DivAmount *= 16;
   if (CheckActorClass(0, "OracleNew")) DivAmount *= 16;
   if (CheckActorClass(0, "Macil1New")) DivAmount *= 16;
   if (CheckActorClass(0, "Macil2New")) DivAmount *= 16;
   if (CheckActorClass(0, "LoremasterNew")) DivAmount *= 16;
   if (CheckActorClass(0, "SourceGuardian")) DivAmount *= 16;
   if (CheckActorClass(0, "AlienSpectre1New")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre2New")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre3New")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre4New")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre5New")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre1Model")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre2Model")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre3Model")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre4Model")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "AlienSpectre5Model")) DivAmount *= 16; // 24
   if (CheckActorClass(0, "EntityBossNew")) DivAmount *= 24; // 32
   if (CheckActorClass(0, "EntitySecondNew")) DivAmount *= 24; // 32
   if (CheckActorClass(0, "EntityAscended")) DivAmount *= 24; // 32
   if (CheckActorClass(0, "DSMotherDemon64")) DivAmount *= 16;
   if (CheckActorClass(0, "ThamuzNew")) DivAmount *= 24; // 32
   if (CheckActorClass(0, "TchernobogNew")) DivAmount *= 24; // 32
   if (CheckActorClass(0, "PennywiseBoss")) DivAmount *= 32; // 32
   if (CheckActorClass(0, "TheSource")) DivAmount *= 32; // 128
   if (CheckActorClass(0, "Magmantis")) DivAmount *= 64; // 32
   if (CheckActorClass(0, "AdolfHitlerDS")) DivAmount *= 64; // 32
   if (CheckActorClass(0, "Sauravatar")) DivAmount *= 96; // 128

   
   if (DivAmount >= 1) SExPts = SExPts / DivAmount;
   SExPts = SExPts + 16;

   C1 = random(1,256);
   if (C1 == 1) SExPts = SExPts * 8;
   if (C1 == 2) SExPts = SExPts * 4;
   if (C1 == 3) SExPts = SExPts * 4;
   if (C1 == 4) SExPts = SExPts * 2;
   if (C1 == 5) SExPts = SExPts * 2;
   if (C1 == 6) SExPts = SExPts * 2;
   if (C1 == 7) SExPts = SExPts * 2;

   // Higher Levels = slightly less chances to get all EXP
   if (SceptreActualLevel > 15 && C1 == 241) SExPts = SExPts / 2;
   if (SceptreActualLevel > 14 && C1 == 242) SExPts = SExPts / 2;
   if (SceptreActualLevel > 13 && C1 == 243) SExPts = SExPts / 2;
   if (SceptreActualLevel > 12 && C1 == 244) SExPts = SExPts / 2;
   if (SceptreActualLevel > 11 && C1 == 245) SExPts = SExPts / 2;
   if (SceptreActualLevel > 10 && C1 == 246) SExPts = SExPts / 2;
   if (SceptreActualLevel > 9 && C1 == 247) SExPts = SExPts / 2;
   if (SceptreActualLevel > 8 && C1 == 248) SExPts = SExPts / 2;
   if (SceptreActualLevel > 7 && C1 == 249) SExPts = SExPts / 2;
   if (SceptreActualLevel > 6 && C1 == 250) SExPts = SExPts / 2;
   if (SceptreActualLevel > 5 && C1 == 251) SExPts = SExPts / 2;
   if (SceptreActualLevel > 4 && C1 == 252) SExPts = SExPts / 2;
   if (SceptreActualLevel > 3 && C1 == 253) SExPts = SExPts / 2;
   if (SceptreActualLevel > 2 && C1 == 254) SExPts = SExPts / 2;
   if (SceptreActualLevel > 1 && C1 == 255) SExPts = SExPts / 2;
   if (SceptreActualLevel > 0 && C1 == 256) SExPts = SExPts / 2;

   EXPBonus1 = 1000;
   // Pearly Corset [+30%/+45% EXP Bonus]
   if (CheckActorInventory(Player1TID,"PearlyCorset")) 
   {
    if (random(1,100) <= 5) EXPBonus1 += 450; // 5% Chance of +45% EXP Bonus
    else EXPBonus1 += 300; // Else +30% EXP Bonus
   }
   if (PowerupTimer[7] > 0) // Divine Avatar
   {
    if (random(1,100) <= 20) EXPBonus1 += 500; // 20% Chance of +50% EXP Bonus
    else EXPBonus1 += 250; // Else +25% EXP Bonus
   }

   SExPts = SExPts * EXPBonus1 / 1000;
   SExPts = SExPts * (GetCVar("dvds_deftnessexpbase") + MiscellaneousVars[40]) / GetCVar("dvds_deftnessexpbase");
   SExPts = SExPts * GetCVar("dvds_sceptreexpmultiplier") / 100;

   while (SExPts > 15)
   {
    SExPts -= 16;
    SceptreLevelEXP += 1;
   }
   MiscellaneousVars[203] += SExPts;

   while (MiscellaneousVars[203] > 15) // if (MiscellaneousVars[203] > 15)
   {
    MiscellaneousVars[203] -= 16;
    SceptreLevelEXP += 1;
   }
   

   // PrintBold(d:SExPts);
  }  
 }
}

// Calculates the occurance rate of Sauron's Gauntlets and Sauron's Helmet Dropping when a spawner item for them is spawned from a dying monster and gets the character's ID number to determine the right version of the Gauntlets to drop.
script "SauronItemSpawnerCheck" (void)
{
 if (random(1,4) == 1)
 {
  if (CharacterClass == 0) SetResultValue(1);
  if (CharacterClass == 1) SetResultValue(2);
  if (CharacterClass == 2) SetResultValue(3);
 }
 else
 {
  SetResultValue(0);
 }
}

// script: Red Tunnel Vision/Heartbeat Effect when badly injured [HudMessage id 4]
script "TunnelVisionControl" ENTER
{
 int LowHealth, CriticalHealth;
 CriticalHealth = MaxHealthTrue / 10;

  if (GetActorProperty(0, APROP_HEALTH) > 0)
  {
   if (GetActorProperty(0, APROP_HEALTH) <= CriticalHealth && GetActorProperty(0, APROP_HEALTH) > 0)
   {
    SetHudSize(640, 480, 0);
    Setfont("M_INJ");
    Hudmessage(s:"A"; HUDMSG_FADEINOUT, 4, CR_WHITE, 320.0, 240.0, 0.0, 0.5, 0.5);
    localambientsound("heartb2", 116);
    delay(15);
    localambientsound("heartb2", 116);
   }
   delay(25);
   restart;
  }
  else
  {
   delay(1);
   restart;
  }
}

// script [HudMessage ids 3 & 4]
script "DeathTunnelVision" ENTER
{
  if (GetActorProperty(0, APROP_HEALTH) <= 0)
  {
   SetHudSize(640, 480, 0);
   Setfont("M_INJ2");
   Hudmessage(s:"A"; HUDMSG_FADEINOUT, 3, CR_WHITE, 320.0, 240.0, 0.0, 1.0, 1.0);
   Hudmessage(s:"A"; 0, 4, CR_WHITE, 320.0, 240.0, 0.0, 1.0, 1.0);
   delay(65);
   restart;
  }
  else
  {
   delay(1);
   restart;
  }
}

// script for Hellcore Energy and Heating usage [and also controls dealing Flora direct damage when using a Hellcore weapon when heating is 100% or higher]
script "IncreaseHellcoreHeat" (int percent, int trydamageuser)
{
 int C1, C2, C3, C4, C5, OldHealth, NewHealth, HealthDiff, DamageFactor, DamageDealt, DamageRatio, ObitTimes;
 int MaxHealthLimit = MaxHealthTrue * 2;
 int PerkFactor;
 int temp1, temp2;
 //PrintBold(d:percent,s:" - ",d:trydamageuser);

 // Any damage from overheating is inflicted BEFORE increasing the heating counter (so going from below 100% to above 100% with a single attack doesn't harm you, only being above 100% at the moment of pulling the trigger will harm you)
 if (HellcoreOverheatLevel > 1000000) // Translates to 100% or higher when you first fire your attack, which means you'll deal yourself damage upon use of this attack if above 100% at this point and the "trydamageuser" argument is set to something other than 0.
 {
  if (trydamageuser != 0)
  {
   DamageFactor = (HellcoreOverheatLevel - 1000000) / 100;
   if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Damage % Ratio : ",d:DamageFactor,s:" [unmitigated base]");
   // Dove's Ribbon cuts Hellcore Overheating Damage in half
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
   {
    DamageFactor = DamageFactor * 1 / 5;
    if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Damage % Ratio : ",d:DamageFactor,s:" [base - Dove Ribbon]");
   }
   else
   {
    DamageFactor = DamageFactor * 2 / 5;
    if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Damage % Ratio : ",d:DamageFactor,s:" [base]");
   }

   // Playing Unloved halves heat ratio
   if (DVDSSpecialArrayValue[3] > 0) 
   {
    DamageFactor = DamageFactor / 2;
    if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Damage % Ratio : ",d:DamageFactor,s:" [base]");
   }

   // Soul Mastery Reduces some damage taken if Overheated.
   if (MiscellaneousVars[10033] >= 0)
   {
    if (MiscellaneousVars[10033] == 1) temp1 = 3;
    if (MiscellaneousVars[10033] == 2) temp1 = 6;
    if (MiscellaneousVars[10033] == 3) temp1 = 9;
    if (MiscellaneousVars[10033] == 4) temp1 = 12;
    if (MiscellaneousVars[10033] == 5) temp1 = 15;
    if (MiscellaneousVars[10034] == 1) temp2 = random(7,8);
    if (MiscellaneousVars[10034] == 2) temp2 = 15;
    PerkFactor = 80 - (temp1 + temp2);
	DamageFactor = DamageFactor * PerkFactor / 80;
    if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Damage % Ratio : ",d:DamageFactor,s:" [Soul Mastery Perk]");
   }

   DamageDealt = DamageFactor * MaxHealthTrue / 10000;
   
   if (DamageDealt < 1) DamageDealt = 1;
   if (DamageDealt > MaxHealthLimit) DamageDealt = MaxHealthLimit;
   
   // PrintBold(d:DamageDealt);
   // Deal the Actual Damage
   OldHealth = GetActorProperty(Player1TID,APROP_Health);
   Thing_Damage2(Player1TID,DamageDealt,"HellcoreDrain");
   NewHealth = GetActorProperty(Player1TID,APROP_Health);

   HealthDiff = OldHealth - NewHealth;

   // Get's the damage % for a fade screen
   DamageRatio = HealthDiff; // DamageDealt;
   DamageRatio = DamageRatio * 10000;
   DamageRatio = DamageRatio / MaxHealthTrue;

   if (GetActorProperty(Player1TID,APROP_Health) <= 0 && MiscellaneousVars[19] == 0)
   {
    if (CharacterClass == 0) log(s:"\cgDeggaris incinerated his own soul on the power of Hellcore Magic.");
    if (CharacterClass == 1) log(s:"\cgIllucia incinerated her own soul on the power of Hellcore Magic.");
    if (CharacterClass == 2) log(s:"\cgFlora incinerated her own soul on the power of Hellcore Magic.");    
    if (CharacterClass == 8) log(s:"\cgAilish incinerated her own soul on the power of Hellcore Magic.");    
    if (CharacterClass == 9) log(s:"\cgPetra incinerated her own soul on the power of Hellcore Magic.");    
    MiscellaneousVars[19]++;
   }

   if (GetActorProperty(Player1TID,APROP_Health) > 0)
   {
    if (NewHealth < OldHealth)
    {
     if (DamageRatio > 0 && DamageRatio < 1001) FadeRange(192,0,64,0.15,192,0,64,0,0.625);
     if (DamageRatio > 1000 && DamageRatio < 2001) FadeRange(192,0,64,0.3,192,0,64,0,0.625);
     if (DamageRatio > 2000 && DamageRatio < 3001) FadeRange(192,0,64,0.45,192,0,64,0,0.625);
     if (DamageRatio > 3000 && DamageRatio < 4001) FadeRange(192,0,64,0.6,192,0,64,0,0.625);
     if (DamageRatio > 4000 && DamageRatio < 5001) FadeRange(192,0,64,0.75,192,0,64,0,0.625);
     if (DamageRatio > 5000 && DamageRatio < 6001) FadeRange(192,0,64,0.9,192,0,64,0,0.625);
     if (DamageRatio > 6000 && DamageRatio < 7001) FadeRange(192,0,64,1.05,192,0,64,0,0.625);
     if (DamageRatio > 7000 && DamageRatio < 8001) FadeRange(192,0,64,1.2,192,0,64,0,0.625);
     if (DamageRatio > 8000 && DamageRatio < 9001) FadeRange(192,0,64,1.35,192,0,64,0,0.625);
     if (DamageRatio > 9000 && DamageRatio < 10001) FadeRange(192,0,64,1.5,192,0,64,0,0.625);
     if (DamageRatio > 10000) FadeRange(192,0,64,1.65,192,0,64,0,0.625);
    }
   }
  }
 }

 percent *= 100;
 if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Base]");

 int ArmorHellCoreRate = 200;
 // Armor Based items [Sauron-class or Flora's specfic] can alter the rate of how fast Hellcore heats up.
 if (CheckActorInventory(Player1TID,"RuinousShield") > 0) percent = percent * 2; 					// +100%
 if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) percent = percent * 134 / 100; 			// +34%
 if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) percent = percent * 134 / 100; 	// +34%
 if (CheckActorInventory(Player1TID,"TheOneRing") > 0) percent = percent * 75 / 100; 				// -25%

 if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) ArmorHellCoreRate -= 1; 			// -0.5% (1)
 if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) ArmorHellCoreRate -= 5; 			// -2.5% (5)
 if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) ArmorHellCoreRate -= 15; 	// -7.5% (15)
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) ArmorHellCoreRate -= 27; 	// -13.5% (27)
 if (CheckActorInventory(Player1TID,"CloakofEvasion") > 0) ArmorHellCoreRate -= 3; 		// -1.5% (3)
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) ArmorHellCoreRate -= 9; 	// -4.5% (9)
 if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) ArmorHellCoreRate -= 7; 		// -3.5% (7)
 if (CheckActorInventory(Player1TID,"KissaBra") > 0) ArmorHellCoreRate -= 13; 			// -6.5% (13)
 if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorHellCoreRate -= 25; 		// -12.5% (25)
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) ArmorHellCoreRate -= 17; 			// -8.5% (17)
 if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) ArmorHellCoreRate -= 11; 			// -5.5% (11)
																					// Total: -66.5% (133)

 percent = percent * ArmorHellCoreRate / 200;
 if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Armor Reduction]");

 C2 = PlayerLevel / 10;
 C2 = C2 * -1;
 C2 += 200;
 percent = percent * C2 / 200;
 if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Level Alteration]");

 // Check Hellcore Multiplier in Options
 percent = (percent * GetCVar("dvds_heatheatmultiplier")) / 100;
 if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Menu Options]");

 // Soul Mastery Reduces rate of heat increase
 if (MiscellaneousVars[10033] >= 0)
 {
  if (MiscellaneousVars[10033] == 1) temp1 = 1;
  if (MiscellaneousVars[10033] == 2) temp1 = 2;
  if (MiscellaneousVars[10033] == 3) temp1 = 3;
  if (MiscellaneousVars[10033] == 4) temp1 = 4;
  if (MiscellaneousVars[10033] == 5) temp1 = 5;
  if (MiscellaneousVars[10034] == 1) temp2 = random(2,3);
  if (MiscellaneousVars[10034] == 2) temp2 = 5;
  PerkFactor = 16 - (temp1 + temp2);
  percent = percent * PerkFactor / 16;
  if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Soul Mastery]");
 }

 if (CheckActorInventory(Player1TID,"IsHaSatanNow") > 0)
 {
  percent = percent / 16;
  if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [HaSatan Check]");
 }

 if (percent < 1) percent = 1;
 if (GetCVar("dvdsdebug_hellcoreheatdisplay") > 0) PrintBold(s:"Hellcore Heat %: ",d:percent,s:" [Final Amount]");

 HellcoreOverheatLevel += percent;
 if (HellcoreOverheatLevel < 0) HellcoreOverheatLevel = 0;
 if (HellcoreOverheatLevel > 10000000) HellcoreOverheatLevel = 10000000;

}

// Spawn a Randomized Armor Item for Flora in "DVI" mode [used with "FloraRandomArmor" thing]
script "FloraRandomArmorDrop" (int type, int OldRand0, int DVIIMode)
{
 int Rand0, Rand1, Rand2, PX, PY, PZ, DVIIRandVal, spawnedaitem;

 if (ActivatorTID() == 0) Thing_ChangeTID(0,1535);

 DVIIRandVal = 1 + (MiscellaneousVars[33] / 32); // Default value for randomizer
 // Do not run script if Flora is not the character in play
 if (CharacterClass != 2) { Thing_Remove(1535); terminate; }
 else
 {
  // Do not run script if the game is Deus Vult II
  if (ModType == 2)
  {
   if (DVIIMode == 0) { Thing_Remove(1535); terminate; }
   else DVIIRandVal = 1024; // Randomizer will ALWAYS roll positive in DVII-AltMode
  }
 }

 // Spawn Occurance Rate
 if (type == 5) // Given by an armorer in Strife [random]
 {
  DVIIRandVal = 1024;
  Rand0 = 0;
 }
 if (type == 4) // ALWAYS SPAWNS [no random failure rate]
 {
  DVIIRandVal = 1024;
  Rand0 = 0;
 }
 if (type == 3) // Doom2-Armor Bonuses
 {
  Rand0 = random(1,3072);
  if (GameSkill() == SKILL_VERY_EASY) Rand0 = random(1,2208);
  if (GameSkill() == SKILL_EASY) Rand0 = random(1,2496);
  if (GameSkill() == SKILL_NORMAL) Rand0 = random(1,2784);
  if (GameSkill() == SKILL_HARD) Rand0 = random(1,3072);
  if (GameSkill() == SKILL_VERY_HARD) Rand0 = random(1,3648);
 }
 else
 if (type == 2) // Doom2-Armors
 {
  Rand0 = random(1,128);
  if (GameSkill() == SKILL_VERY_EASY) Rand0 = random(1,92);
  if (GameSkill() == SKILL_EASY) Rand0 = random(1,104);
  if (GameSkill() == SKILL_NORMAL) Rand0 = random(1,116);
  if (GameSkill() == SKILL_HARD) Rand0 = random(1,128);
  if (GameSkill() == SKILL_VERY_HARD) Rand0 = random(1,152);
 }
 else
 if (type == 1)
 {
  Rand0 = OldRand0;
 }
 else
 {
  if (ModType == 1) // DVI has 4 levels
  {
   Rand0 = random(1,256);
   if (GameSkill() == SKILL_VERY_EASY) Rand0 = random(1,184);
   if (GameSkill() == SKILL_EASY) Rand0 = random(1,208);
   if (GameSkill() == SKILL_NORMAL) Rand0 = random(1,232);
   if (GameSkill() == SKILL_HARD) Rand0 = random(1,256);
   if (GameSkill() == SKILL_VERY_HARD) Rand0 = random(1,304);
  }
  else // Classic has 32 levels [1/4th the spawn rate of DVI mode]
  {
   Rand0 = random(1,768);
   if (GameSkill() == SKILL_VERY_EASY) Rand0 = random(1,552);
   if (GameSkill() == SKILL_EASY) Rand0 = random(1,624);
   if (GameSkill() == SKILL_NORMAL) Rand0 = random(1,696);
   if (GameSkill() == SKILL_HARD) Rand0 = random(1,768);
   if (GameSkill() == SKILL_VERY_HARD) Rand0 = random(1,912);
  }
 }

 if (Rand0 <= DVIIRandVal)
 {
  Rand1 = 0;
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"KissaBra") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"RuinousShield") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"DivineShield") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"BalrogRing") > 0) Rand1 += 1;
  if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) Rand1 += 1;
  if (Rand1 > 10) { Thing_Remove(1535); terminate; } // If all at least 11 items or more are detected on Flora, this script will not run past this point.

  while (spawnedaitem == 0)
  {
   PX = GetActorX(1535);
   PY = GetActorY(1535);
   PZ = GetActorZ(1535);
   Rand2 = random(1,100);
   // PrintBold(d:Rand2,s:" / (",d:Rand0,s:") / [",d:Rand1,s:"]\n\n X",d:PX,s:" Y",d:PY,s:" Z",d:PZ);
 
   if (Rand2 > 0 && Rand2 < 10)
   {
    if (CheckActorInventory(Player1TID,"SafeTeaShoes") == 0 && ThingCountName("SafeTeaShoes", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"SafeTeaShoes",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("SafeTeaShoes",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 9 && Rand2 < 19)
   {
    if (CheckActorInventory(Player1TID,"PearlyCorset") == 0 && ThingCountName("PearlyCorset", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"PearlyCorset",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("PearlyCorset",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 18 && Rand2 < 28)
   {
    if (CheckActorInventory(Player1TID,"WaterFlyingDress") == 0 && ThingCountName("WaterFlyingDress", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"WaterFlyingDress",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("WaterFlyingDress",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 27 && Rand2 < 37)
   {
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") == 0 && ThingCountName("EvenstarNecklace", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"EvenstarNecklace",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("EvenstarNecklace",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 36 && Rand2 < 46)
   {
    if (CheckActorInventory(Player1TID,"CloakOfEvasion") == 0 && ThingCountName("CloakOfEvasion", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"CloakOfEvasion",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("CloakOfEvasion",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 45 && Rand2 < 55)
   {
    if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") == 0 && ThingCountName("FalconKnifeEarrings", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"FalconKnifeEarrings",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("FalconKnifeEarrings",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 54 && Rand2 < 64)
   {
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") == 0 && ThingCountName("AnubisCufflinks", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"AnubisCufflinks",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("AnubisCufflinks",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 63 && Rand2 < 73)
   {
    if (CheckActorInventory(Player1TID,"KissaBra") == 0 && ThingCountName("KissaBra", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"KissaBra",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("KissaBra",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 72 && Rand2 < 82)
   {
    if (CheckActorInventory(Player1TID,"DivineShield") == 0 && ThingCountName("DivineShield", 0) < 1)
    {
     if (CheckActorInventory(Player1TID,"RuinousShield") == 0 && ThingCountName("RuinousShield", 0) < 1)
     {
      if (type == 5) // Directly GIVE armor to the player instead of spawning it
      {
       GiveActorInventory(Player1TID,"RuinousShield",1);
	   spawnedaitem++;
      }
	  else // Spawn it
	  {
       SpawnForced("RuinousShield",PX,PY,PZ,0,0);
       spawnedaitem++;
       Thing_Remove(1535);
	  }
     }
    }
   }
   if (Rand2 > 81 && Rand2 < 91)
   {
    if (CheckActorInventory(Player1TID,"BalrogRing") == 0 && ThingCountName("BalrogRing", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"BalrogRing",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("BalrogRing",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 90 && Rand2 < 100)
   {
    if (CheckActorInventory(Player1TID,"DoveRibbon") == 0 && ThingCountName("DoveRibbon", 0) < 1)
    {
     if (type == 5) // Directly GIVE armor to the player instead of spawning it
     {
      GiveActorInventory(Player1TID,"DoveRibbon",1);
	  spawnedaitem++;
     }
	 else // Spawn it
	 {
      SpawnForced("DoveRibbon",PX,PY,PZ,0,0);
      spawnedaitem++;
      Thing_Remove(1535);
	 }
    }
   }
   if (Rand2 > 99)
   {
    if (CheckActorInventory(Player1TID,"RuinousShield") == 0 && ThingCountName("RuinousShield", 0) < 1)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") == 0 && ThingCountName("DivineShield", 0) < 1)
     {
      if (type == 5) // Directly GIVE armor to the player instead of spawning it
      {
       GiveActorInventory(Player1TID,"DivineShield",1);
	   spawnedaitem++;
      }
	  else // Spawn it
	  {
       SpawnForced("DivineShield",PX,PY,PZ,0,0);
       spawnedaitem++;
       Thing_Remove(1535);
	  }
     }
    }
   }
  }

 }
 else // No spawn
 {
  Thing_Remove(1535);
 }
}

// Checks and Removes "Copies" of Flora's armor items on maps [when she already has these items]
script "CheckFloraArmorCopies" (int Armortype)
{
 if (CharacterClass == 2)
 {
  if (Armortype == 1 && CheckActorInventory(Player1TID,"SafeTeaShoes") > 0 && ActivatorTID() == 0) // SafeTeaShoes
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }

  if (Armortype == 2 && CheckActorInventory(Player1TID,"PearlyCorset") > 0 && ActivatorTID() == 0) // PearlyCorset
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }

  if (Armortype == 3 && CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && ActivatorTID() == 0) // WaterFlyingDress
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }

  if (Armortype == 4 && CheckActorInventory(Player1TID,"EvenstarNecklace") > 0 && ActivatorTID() == 0) // EvenstarNecklace
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }

  if (Armortype == 5 && CheckActorInventory(Player1TID,"CloakOfEvasion") > 0 && ActivatorTID() == 0) // CloakOfEvasion
  {
     Thing_ChangeTID(0,1534);
     Thing_Remove(1534);
  }

  if (Armortype == 6 && CheckActorInventory(Player1TID,"AnubisCufflinks") > 0 && ActivatorTID() == 0) // AnubisCufflinks
  {
     Thing_ChangeTID(0,1534);
     Thing_Remove(1534);
  }

  if (Armortype == 7 && CheckActorInventory(Player1TID,"KissaBra") > 0 && ActivatorTID() == 0) // KissaBra
  {
     Thing_ChangeTID(0,1534);
     Thing_Remove(1534);
  }

  if (Armortype == 8) 
  {
   if (CheckActorInventory(Player1TID,"DivineShield") > 0 && ActivatorTID() == 0) // RuinousShield
   {
    Thing_ChangeTID(0,1534);
    Thing_Remove(1534);
   }
   else
   {
    if (CheckActorInventory(Player1TID,"RuinousShield") > 0 && ActivatorTID() == 0)
    {
     Thing_ChangeTID(0,1534);
     Thing_Remove(1534);
    }
   }
  }

  if (Armortype == 9 && CheckActorInventory(Player1TID,"DivineShield") > 0 && ActivatorTID() == 0) // DivineShield 
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }
 
  if (Armortype == 10 && CheckActorInventory(Player1TID,"BalrogRing") > 0 && ActivatorTID() == 0) // BalrogRing
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }
 
  if (Armortype == 11 && CheckActorInventory(Player1TID,"DoveRibbon") > 0 && ActivatorTID() == 0) // DoveRibbon
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }

  if (Armortype == 12 && CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0 && ActivatorTID() == 0) // FalconKnifeEarrings
  {
   Thing_ChangeTID(0,1534);
   Thing_Remove(1534);
  }
 }
 else
 {
  Thing_ChangeTID(0,1534);
  Thing_Remove(1534);
 }

}

// Using a Diabloist's Hands' HP Gravity attack-projectile on an enemy
script "Hand-GravityAttack" (int type)
{
 int C1, C2, C3, C4, C5, PrinterOld, PrinterNew;

  PrinterOld = GetActorProperty(0,APROP_Health);
  if (GameSkill() == SKILL_VERY_EASY) C5 = 875;  
  if (GameSkill() == SKILL_EASY) C5 = 750;  
  if (GameSkill() == SKILL_NORMAL) C5 = 500;  
  if (GameSkill() == SKILL_HARD) C5 = 250;  
  if (GameSkill() == SKILL_VERY_HARD) C5 = 125;  

  C5 = 750;  

  C2 = 1000;
  C2 = C2 - C5;

  C1 = GetActorProperty(0,APROP_Health);
  C1 = C1 * C2 / 1000;
  if (C1 < 1) C1 = 1;

  SetActorProperty(0,APROP_Health,C1);
  PrinterNew = GetActorProperty(0,APROP_Health);
  // PrintBold(d:PrinterOld,s:"  ",d:PrinterNew);
  // SetActorState(0,"HPFlashGravity");
}

// Determines Attack/Defense/Speed Bonuses for Monsters [depending on difficulty level and maps and game mode]
script "MonsterStatsHP_ATK_DEF_SPD" (int type, int extraflags)
{
 int CurrHP, MaxHP, Speed, Attack, Defense, Balance, Temp, RangeVar, LevelCheck, MapCheck;
 int StealthChance;
 int nonstatmonster = 0;

 if (type < 0) type = 0;
 if (type > 1) type = 1;

 // extraflags
 // & 1 = Always multiply level by 4 instead of a 1/64 chance of it. [basically "Elitifies" the monster all the time when called]
 // & 2 = Multiplies the monsters' level by 4 [again]
 
 if (type == 0) // Giving Stats
 {
  ACS_NamedExecuteWithResult("RefreshStealthInfo"); // Runs to check Stealth information [in case something like finding the Ring has happened]

  if (CheckInventory("MonsterHasBuffs") != 0) terminate;
  if (GetUserVariable(0, "user_checkmapskill") > 0) terminate;

  str actorname = GetActorClass(0);

  StealthChance = ACS_NamedExecuteWithResult("GetStealthChance");
  nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
  if (random(1,256) <= StealthChance && nonstatmonster == 0)
  {
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) 
   {
    GiveInventory("IsAStealthMonsterRing", 1);
    TakeInventory("IsAStealthMonster5000", 1); 
    TakeInventory("IsAStealthMonster7500", 1); 
    TakeInventory("IsAStealthMonster8750", 1); 
    TakeInventory("IsAStealthMonster9375", 1); 
   }
   else
   {
    TakeInventory("IsAStealthMonsterRing", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") == 0) GiveInventory("IsAStealthMonster5000", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") == 1) GiveInventory("IsAStealthMonster7500", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") == 2) GiveInventory("IsAStealthMonster8750", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") == 3) GiveInventory("IsAStealthMonster9375", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") != 0) TakeInventory("IsAStealthMonster5000", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") != 1) TakeInventory("IsAStealthMonster7500", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") != 2) TakeInventory("IsAStealthMonster8750", 1); 
    if (GetCVar("dvds_rnd_stealthlevel") != 3) TakeInventory("IsAStealthMonster9375", 1); 
   }   
   SetUserVariable(0, "user_isstealth", 1);
  }
  else
  {
   SetUserVariable(0, "user_isstealth", 0);
   TakeInventory("IsAStealthMonster", 1);
   TakeInventory("IsAStealthMonsterRing", 1);
  }

  //*******************************************************
  //** Calculates Stats By Checking the Difficulty Level **
  //*******************************************************
  int DifficultyChecker = 1;
  if (ModType == 0)
  { 
   if (GetCVar("dvds_monsterstatcalc_skill") > 0) DifficultyChecker = 1; else DifficultyChecker = 0;
  }
  else DifficultyChecker = 1;

  int SpeedFactor = 0.0;
  int AttackFactor = 0.0;
  int DefenseFactor = 0.0;
  int MaxHPFactor = 0.0;
  int BalanceFactor = 0.0;
  Speed = GetActorProperty(0,APROP_Speed);
  Attack = GetActorProperty(0,APROP_DamageMultiplier); 
  Defense = GetActorProperty(0,APROP_DamageFactor); 
  Balance = GetActorProperty(0,APROP_Mass); 
  SetUserVariable(0, "user_basespeed", GetActorProperty(0,APROP_Speed));
  SetUserVariable(0, "user_baseattack", GetActorProperty(0,APROP_DamageMultiplier));
  SetUserVariable(0, "user_basedefense", GetActorProperty(0,APROP_DamageFactor));
  SetUserVariable(0, "user_basemass", GetActorProperty(0,APROP_Mass));
  if (GetCVar("dvdsdebug_showstatcalcstuff") > 0) 
  {
   PrintBold(s:"\co------------------------------",
           s:"\n\co------------------------------",
           s:"\n\co------------------------------",
           s:"\n\co------------------------------");
  }

  MaxHP = GetActorProperty(0,APROP_SpawnHealth);
  if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) 
  {
   PrintBold(s:"\chStart Speed: ",f:Speed,s:"\n\n",
             s:"\cpStart Balance: ",d:Balance,s:"\n\n",
             s:"\caStart Max HP: ",d:MaxHP);
  } 

  nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
  if (DifficultyChecker == 1 && nonstatmonster == 0) // Difficulty-checking enabled
  {
   if (GameSkill() == SKILL_VERY_EASY)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = -0.3333;
     DefenseFactor = 0.5000;
     SpeedFactor = -0.083334;
     MaxHPFactor = -0.15;
     BalanceFactor = -0.3333;
    }
    else
    {
     AttackFactor = -0.1667;
     DefenseFactor = 0.2000;
     SpeedFactor = -0.041667;
     MaxHPFactor = -0.075;
     BalanceFactor = -0.1667;
    }
   }
   else
   if (GameSkill() == SKILL_EASY)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = -0.1667;
     DefenseFactor = 0.2000;
     SpeedFactor = -0.041667;
     MaxHPFactor = -0.05;
     BalanceFactor = -0.1667;
    }
    else
    {
     AttackFactor = -0.08333;
     DefenseFactor = 0.090909;
     SpeedFactor = -0.0208333;
     MaxHPFactor = -0.025;
     BalanceFactor = -0.08333;
    }
   }
   else
   if (GameSkill() == SKILL_NORMAL)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = 0.0;
     DefenseFactor = 0.0;
     SpeedFactor = 0.0;
     MaxHPFactor = 0.0;
     BalanceFactor = 0.0;
    }
    else
    {
     AttackFactor = 0.0;
     DefenseFactor = 0.0;
     SpeedFactor = 0.0;
     MaxHPFactor = 0.0;
     BalanceFactor = 0.0;
    }
   }
   else
   if (GameSkill() == SKILL_HARD)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = 0.1667;
     DefenseFactor = -0.142857;
     SpeedFactor = 0.041667;
     MaxHPFactor = 0.05;
     BalanceFactor = 0.1667;
    }
    else
    {
     AttackFactor = 0.08333;
     DefenseFactor = -0.076924;
     SpeedFactor = 0.0208325;
     MaxHPFactor = 0.0375;
     BalanceFactor = 0.08333;
    }
   }
   else
   if (GameSkill() == SKILL_VERY_HARD)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = 0.5;
     DefenseFactor = -0.333334;
     SpeedFactor = 0.125;
     MaxHPFactor = 0.15;
     BalanceFactor = 0.5;
    }
    else
    {
     AttackFactor = 0.2;
     DefenseFactor = -0.1667;
     SpeedFactor = 0.05;
     MaxHPFactor = 0.10;
     BalanceFactor = 0.2;
    }
   }
   else
   if (GameSkill() == 5)
   {
    if (GetCVar("dvds_skilllevelcalctype") == 0)
    {
     AttackFactor = 1.0;
     DefenseFactor = -0.5;
     SpeedFactor = 0.25;
     MaxHPFactor = 0.30;
     BalanceFactor = 1.0;
    }
    else
    {
     AttackFactor = 0.5;
     DefenseFactor = -0.3333;
     SpeedFactor = 0.125;
     MaxHPFactor = 0.225;
     BalanceFactor = 0.5;
    }
   }

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {
	  PrintBold(s:"\cgAttackFactor [Skill]: ",f:(AttackFactor),s:"\n\n",
	            s:"\cdDefenseFactor [Skill]: ",f:(DefenseFactor),s:"\n\n",
				s:"\chSpeedFactor [Skill]: ",f:(SpeedFactor),s:"\n\n",
				s:"\caMaxHPFactor [Skill]: ",f:(MaxHPFactor),s:"\n\n",
				s:"\cpBalanceFactor [Skill]: ",f:(BalanceFactor));
   }

   SpeedFactor = FixedMul(SpeedFactor, GetCVar("dvds_monsterspeedratio_skill"));
   if (SpeedFactor < -2.00) SpeedFactor = -2.00;
   if (SpeedFactor > 2.00) SpeedFactor = 2.00;
   Speed = FixedMul(Speed, (1.0+SpeedFactor));
   SetActorProperty(0,APROP_Speed,Speed); 

   AttackFactor = FixedMul(AttackFactor, GetCVar("dvds_monsterattackratio_skill"));
   if (AttackFactor < -2.00) AttackFactor = -2.00;
   if (AttackFactor > 2.00) AttackFactor = 2.00;
   Attack = FixedMul(Attack, (1.0+AttackFactor));
   SetActorProperty(0,APROP_DamageMultiplier,Attack); 

   DefenseFactor = FixedMul(DefenseFactor, GetCVar("dvds_monsterdefenseratio_skill"));
   if (DefenseFactor < -2.00) DefenseFactor = -2.00;
   if (DefenseFactor > 2.00) DefenseFactor = 2.00;
   Defense = FixedMul(Defense, (1.0+DefenseFactor));
   SetActorProperty(0,APROP_DamageFactor,Defense); 

   MaxHPFactor = FixedMul(MaxHPFactor, GetCVar("dvds_monstermaxhpratio_skill"));
   if (MaxHPFactor < -2.00) MaxHPFactor = -2.00;
   if (MaxHPFactor > 2.00) MaxHPFactor = 2.00;
   MaxHP = FixedMul(MaxHP, (1.0+MaxHPFactor));

   BalanceFactor = FixedMul(BalanceFactor, GetCVar("dvds_monsterbalanceratio_skill"));
   if (BalanceFactor < -2.00) BalanceFactor = -2.00;
   if (BalanceFactor > 2.00) BalanceFactor = 2.00;
   Balance = FixedMul(Balance, (1.0+BalanceFactor));
   SetActorProperty(0,APROP_Mass,Balance); 

   if (Attack < 0.005) Attack = 0.005;
   if (Attack > 20.00) Attack = 20.00;
   if (Defense < 0.005) Defense = 0.005;
   if (Defense > 20.00) Defense = 20.00;
   if (Balance < 1) Balance = 1;
   if (Balance > 2500000) Balance = 2500000;
   if (MaxHP < 1) MaxHP = 1;
   if (MaxHP > 2147483647) MaxHP = 2147483647;

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {   
    PrintBold(s:"\chSpeedFactor [Skill]: ",f:(1.0+SpeedFactor),s:"\n",
	          s:"\chSpeed After Skill: ",f:speed,s:"\n\n",

			  s:"\cgAttackFactor [Skill]: ",f:(1.0+AttackFactor),s:"\n",
			  s:"\cgAttack After Skill: ",f:Attack,s:"\n\n",
			  
			  s:"\cdDefenseFactor [Skill]: ",f:(1.0+DefenseFactor),s:"\n",
			  s:"\cdDefense After Skill: ",f:Defense,s:"\n\n",
			  
			  s:"\caMaxHPFactor [Skill]: ",f:(1.0+MaxHPFactor),s:"\n",
			  s:"\caMaxHP After Skill: ",d:MaxHP,s:"\n\n",
			  
			  s:"\cpBalanceFactor [Skill]: ",f:(1.0+BalanceFactor),s:"\n",
			  s:"\cpBalance After Skill: ",d:Balance);
   }
  }    

  //*************************************************
  //** Calculates Stats By Checking the Map Number **
  //*************************************************
  int MapChecker = 1;
  if (ModType == 0)
  { 
   if (GetCVar("dvds_monsterstatcalc_maps") > 0) MapChecker = 1; else MapChecker = 0;
  }
  else MapChecker = 1;

  nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
  if (MapChecker == 1 && nonstatmonster == 0) // Map-checking enabled
  {
   if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
   {
    if (ClassicDoomType == 1 || ClassicDoomType == 2) // Doom 1 / Heretic [ExMx system]
    {
     MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
     MapCheck += MiscellaneousVars[53];
     MapCheck += MiscellaneousVars[169];
     if (MapCheck < 1) MapCheck = 1;
     if (MapCheck > 50) MapCheck = 50;
 
     AttackFactor = 0.0;
     if (MapCheck > 1) AttackFactor += (0.02 * (MapCheck - 1));
     if (MapCheck > 2) AttackFactor += (0.001 * (MapCheck - 2));
     if (MapCheck >= 1 && MapCheck <= 10) AttackFactor = FixedMul(AttackFactor, 1.0125);
     if (MapCheck >= 11 && MapCheck <= 20) AttackFactor = FixedMul(AttackFactor, 1.025);
     if (MapCheck >= 21 && MapCheck <= 30) AttackFactor = FixedMul(AttackFactor, 1.0375);
     if (MapCheck >= 31 && MapCheck <= 40) AttackFactor = FixedMul(AttackFactor, 1.05);
     if (MapCheck >= 41 && MapCheck <= 50) AttackFactor = FixedMul(AttackFactor, 1.0625);

     DefenseFactor = FixedDiv(1.0, (AttackFactor+1.0)); //(1.0 / (AttackFactor + 1.0)) - 1.0;
     DefenseFactor -= 1.0;

     SpeedFactor = FixedDiv(AttackFactor,4.0);

     MaxHPFactor = AttackFactor;

     BalanceFactor = AttackFactor;

    }
    else // Doom 2 / Hexen / Strife / Doom64 [MAPxx system]
    {
     MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
     MapCheck += MiscellaneousVars[53];
     MapCheck += MiscellaneousVars[169];
     if (MapCheck < 1) MapCheck = 1;
     if (MapCheck > 50) MapCheck = 50;

     AttackFactor = 0.0;
     if (MapCheck > 1) AttackFactor += (0.025 * (MapCheck - 1));

     if (MapCheck >= 1 && MapCheck <= 6) AttackFactor = FixedMul(AttackFactor, 1.0125);
     if (MapCheck >= 7 && MapCheck <= 11) AttackFactor = FixedMul(AttackFactor, 1.025);
     if (MapCheck >= 12 && MapCheck <= 20) AttackFactor = FixedMul(AttackFactor, 1.0375);
     if (MapCheck == 31) AttackFactor = FixedMul(AttackFactor, 1.0375);
     if (MapCheck == 32) AttackFactor = FixedMul(AttackFactor, 1.0375);
     if (MapCheck >= 21 && MapCheck <= 30) AttackFactor = FixedMul(AttackFactor, 1.05);
     if (MapCheck >= 33 && MapCheck <= 40) AttackFactor = FixedMul(AttackFactor, 1.0625);
     if (MapCheck >= 41 && MapCheck <= 50) AttackFactor = FixedMul(AttackFactor, 1.075);

     DefenseFactor = FixedDiv(1.0, (AttackFactor+1.0)); //(1.0 / (AttackFactor + 1.0)) - 1.0;
     DefenseFactor -= 1.0;

     SpeedFactor = FixedDiv(AttackFactor,4.0);

     MaxHPFactor = AttackFactor;

     BalanceFactor = AttackFactor;

    }
   }

   nonstatmonster = 0;
   if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
   if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
   if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
   if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
   if (ModType == 1 && nonstatmonster == 0) // Deus Vult 1
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[53];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1101) MapCheck = 1101;
    if (MapCheck > 1104) MapCheck = 1104;
 
    AttackFactor = 0.0;
    if (MapCheck == 1101) AttackFactor = 0.0; // MAP01 - Insurgents
    if (MapCheck == 1102) AttackFactor = 0.25; // MAP02 - Torture Chamber
    if (MapCheck == 1103) AttackFactor = 0.75; // MAP03 - Cathedral
    if (MapCheck == 1104) AttackFactor = 1.5; // MAP04 - End Of Days

    DefenseFactor = FixedDiv(1.0, (AttackFactor+1.0)); //(1.0 / (AttackFactor + 1.0)) - 1.0;
    DefenseFactor -= 1.0;

    SpeedFactor = FixedDiv(AttackFactor,4.0);

    MaxHPFactor = FixedDiv(AttackFactor,2.0);

    BalanceFactor = FixedDiv(AttackFactor,2.0);
   }
   if (ModType == 2 && (GetActorClass(0) != "PracticeTarget" || GetActorClass(0) != "PracticeTarget2")) // Deus Vult 2
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[53];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1201) MapCheck = 1201;
    if (MapCheck > 1212) MapCheck = 1212;

    // Earth-type Levels
    if (MapCheck == 1201) // MAP01 - Entryway Pass
    {
     AttackFactor = 0.0;
     DefenseFactor = 0.0;
     SpeedFactor = 0.0;
     MaxHPFactor = 0.0;
     BalanceFactor = 0.0;
    }
    else
    if (MapCheck == 1202) // MAP02 - Mutagen
    {
     AttackFactor = 0.03;
     DefenseFactor = -0.029126;
     SpeedFactor = 0.0075;
     MaxHPFactor = 0.06;
     BalanceFactor = 0.03;
    }
    else
    if (MapCheck == 1203) // MAP03 - Crouching Demon, Hidden Archvile
    {
     AttackFactor = 0.09;
     DefenseFactor = -0.082569;
     SpeedFactor = 0.0225;
     MaxHPFactor = 0.12;
     BalanceFactor = 0.09;
    }
    else
    if (MapCheck == 1204) // MAP04 - Minas Morgul
    {
     AttackFactor = 0.18;
     DefenseFactor = -0.152542;
     SpeedFactor = 0.045;
     MaxHPFactor = 0.19;
     BalanceFactor = 0.18;
    }
    else
    if (MapCheck == 1205) // MAP05 - Eagle's Nest
    {
     AttackFactor = 0.30;
     DefenseFactor = -0.230769;
     SpeedFactor = 0.075;
     MaxHPFactor = 0.26;
     BalanceFactor = 0.30;
    }
    else
    if (MapCheck == 1206) // MAP05S - The Manliest Level Ever
    {
     AttackFactor = 0.45;
     DefenseFactor = -0.310345;
     SpeedFactor = 0.1125;
     MaxHPFactor = 0.34;
     BalanceFactor = 0.45;
    }
    else
    if (MapCheck == 1207) // MAP06 - Stargate
    {
     AttackFactor = 0.63;
     DefenseFactor = -0.386503;
     SpeedFactor = 0.1575;
     MaxHPFactor = 0.42;
     BalanceFactor = 0.63;
    }
    else
    if (MapCheck == 1208) // MAP07 - The Desert Temple
    {
     AttackFactor = 0.84;
     DefenseFactor = -0.456522;
     SpeedFactor = 0.21;
     MaxHPFactor = 0.50;
     BalanceFactor = 0.84;
    }
    else
    // Hell Levels
    if (MapCheck == 1209) // MAP08 - The Unholy Cathedral
    {
     AttackFactor = 1.14;
     DefenseFactor = -0.53271;
     SpeedFactor = 0.285;
     MaxHPFactor = 0.77;
     BalanceFactor = 1.14;
    }
    else
    if (MapCheck == 1210) // DV2M09 - You Shall Not Pass!
    {
     AttackFactor = 1.53;
     DefenseFactor = -0.604743;
     SpeedFactor = 0.3825;
     MaxHPFactor = 1.09;
     BalanceFactor = 1.53;
    }
    else
    if (MapCheck == 1211) // DV2M10 - Hell's Vendetta
    {
     AttackFactor = 2.01;
     DefenseFactor = -0.667774;
     SpeedFactor = 0.5025;
     MaxHPFactor = 1.48;
     BalanceFactor = 2.01;
    }
    else
    if (MapCheck == 1212) // DV2M10B - attedneV s'lleH
    {
     AttackFactor = 2.58;
     DefenseFactor = -0.72067;
     SpeedFactor = 0.645;
     MaxHPFactor = 1.92;
     BalanceFactor = 2.58;
    }
    else
    if (MapCheck == 1214) // DV2M12 - "The Wings of The Maiar" [DVI combined level remake]
    {
     AttackFactor = 1.56;
     DefenseFactor = -0.609375;
     SpeedFactor = 0.39;
     MaxHPFactor = 1.41;
     BalanceFactor = 1.56;
    }
    else
    if (MapCheck == 1215) // DV2M10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
    {
     AttackFactor = 2.58; //GiveInventory("MonsterAttack-DVII-MAP10B", 1);
     DefenseFactor = -0.72067; //GiveInventory("MonsterDefense-DVII-MAP10B", 1);
     SpeedFactor = 0.645;
     MaxHPFactor = 1.92;
     BalanceFactor = 2.58;
    }
   } 

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {
	  PrintBold(s:"\chSpeedFactor [MAP]: ",f:(SpeedFactor),s:"\n\n",
	            s:"\cgAttackFactor [MAP]: ",f:(AttackFactor),s:"\n\n",
	            s:"\cdDefenseFactor [MAP]: ",f:(DefenseFactor),s:"\n\n",
				s:"\caMaxHPFactor [MAP]: ",f:(MaxHPFactor),s:"\n\n",
				s:"\cpBalanceFactor [MAP]: ",f:(BalanceFactor));
   }

   SpeedFactor = FixedMul(SpeedFactor, GetCVar("dvds_monsterspeedratio_maps"));
   if (SpeedFactor < -2.00) SpeedFactor = -2.00;
   if (SpeedFactor > 2.00) SpeedFactor = 2.00;
   Speed = FixedMul(Speed, (1.0+SpeedFactor));
   SetActorProperty(0,APROP_Speed,Speed); 

   AttackFactor = FixedMul(AttackFactor, GetCVar("dvds_monsterattackratio_maps"));
   if (AttackFactor < -2.00) AttackFactor = -2.00;
   if (AttackFactor > 2.00) AttackFactor = 2.00;
   Attack = FixedMul(Attack, (1.0+AttackFactor));
   SetActorProperty(0,APROP_DamageMultiplier,Attack); 

   DefenseFactor = FixedMul(DefenseFactor, GetCVar("dvds_monsterdefenseratio_maps"));
   if (DefenseFactor < -2.00) DefenseFactor = -2.00;
   if (DefenseFactor > 2.00) DefenseFactor = 2.00;
   Defense = FixedMul(Defense, (1.0+DefenseFactor));
   SetActorProperty(0,APROP_DamageFactor,Defense); 

   MaxHPFactor = FixedMul(MaxHPFactor, GetCVar("dvds_monstermaxhpratio_maps"));
   if (MaxHPFactor < -2.00) MaxHPFactor = -2.00;
   if (MaxHPFactor > 2.00) MaxHPFactor = 2.00;
   MaxHP = FixedMul(MaxHP, (1.0+MaxHPFactor));

   BalanceFactor = FixedMul(BalanceFactor, GetCVar("dvds_monsterbalanceratio_skill"));
   if (BalanceFactor < -2.00) BalanceFactor = -2.00;
   if (BalanceFactor > 2.00) BalanceFactor = 2.00;
   Balance = FixedMul(Balance, (1.0+BalanceFactor));
   SetActorProperty(0,APROP_Mass,Balance); 

   if (Attack < 0.005) Attack = 0.005;
   if (Attack > 20.00) Attack = 20.00;
   if (Defense < 0.005) Defense = 0.005;
   if (Defense > 20.00) Defense = 20.00;
   if (MaxHP < 1) MaxHP = 1;
   if (MaxHP > 2147483647) MaxHP = 2147483647;

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {
	 PrintBold(
			   s:"\chSpeedFactor [MAP]: ",f:(1.0+SpeedFactor),s:"\n",
			   s:"\chSpeed After MAP: ",f:Speed,s:"\n\n",

	           s:"\cgAttackFactor [MAP]: ",f:(1.0+AttackFactor),s:"\n",
			   s:"\cgAttack After MAP: ",f:Attack,s:"\n\n",

 	           s:"\cdDefenseFactor [MAP]: ",f:(1.0+DefenseFactor),s:"\n",
			   s:"\cdDefense After MAP: ",f:Defense,s:"\n\n",

			   s:"\caMaxHPFactor [MAP]: ",f:(1.0+MaxHPFactor),s:"\n",
			   s:"\caMaxHP After MAP: ",d:MaxHP,s:"\n\n",

			   s:"\cpBalanceFactor [MAP]: ",f:(1.0+BalanceFactor),s:"\n",
			   s:"\cpBalance After MAP: ",d:Balance
			   );
   }
 }


  //*****************************************************************
  //** Calculates Stats [and Level] By Checking the Player's Level **
  //*****************************************************************
  int LevelErrorRange;
  int LevelBaseMulti = 0.00375;
  if (GameSkill() == SKILL_VERY_EASY) LevelBaseMulti = 0.00225;
  if (GameSkill() == SKILL_EASY) LevelBaseMulti = 0.003;
  if (GameSkill() == SKILL_NORMAL) LevelBaseMulti = 0.00375;
  if (GameSkill() == SKILL_HARD) LevelBaseMulti = 0.0045;
  if (GameSkill() == SKILL_VERY_HARD) LevelBaseMulti = 0.00525;
  if (GameSkill() == 5) LevelBaseMulti = 0.006;
  LevelBaseMulti = FixedMul(LevelBaseMulti, GetCVar("dvds_monsterlevelstatfactor"));

  int LevelChecker = 1;
  int LevelDifficultyInflation = GetCVar("dvds_leveldifficultyinflation");
  if (LevelDifficultyInflation < -2000) LevelDifficultyInflation = -2000;
  if (LevelDifficultyInflation > 2000) LevelDifficultyInflation = 2000;
  int LevelDifficultyInflationPercent = GetCVar("dvds_leveldifficultyinflation2");
  if (LevelDifficultyInflationPercent < -100) LevelDifficultyInflationPercent = -100;
  if (LevelDifficultyInflationPercent > 2000) LevelDifficultyInflationPercent = 2000;

  if (ModType == 0)
  { 
   if (GetCVar("dvds_monsterstatcalc_levels") > 0) LevelChecker = 1; else LevelChecker = 0;
  }
  else LevelChecker = 1;

  nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
  if (LevelChecker == 1 && nonstatmonster == 0)
  {
     LevelCheck = GetUserVariable(0,"user_presetleveladd"); // Checks the "Preset" strength of a monster
     LevelCheck += random(GetUserVariable(0,"user_presetlevelrand1"),GetUserVariable(0,"user_presetlevelrand2")); // Checks the "Preset" strength of a monster
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [PresetLevel Add]: ",d:(LevelCheck));

     LevelCheck += PlayerLevel;
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [PlayerLevel Check]: ",d:(LevelCheck));

     LevelCheck += GetUserVariable(0,"user_ressurrectstr"); // Checks the "Resurrect" strength of a monster [Clay Devils in TCOTD get stronger each time they resurrect]
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [ResurrectStr Check]: ",d:(LevelCheck));
     LevelCheck += LevelDifficultyInflation;
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [inflation-exact]: ",d:(LevelCheck));
	 LevelCheck = LevelCheck * (100 + LevelDifficultyInflationPercent) / 100;
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [inflation-percent]: ",d:(LevelCheck));

     LevelErrorRange = FixedMul(LevelCheck, 0.1667);
     if (LevelErrorRange < 1) LevelErrorRange = random(0,3);
     LevelCheck += random(-LevelErrorRange,LevelErrorRange);
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [error-range]: ",d:(LevelCheck));

     if (ModType == 1) // DV1 [general]
     {
      LevelCheck += random(0,10);
     }
     if (ModType == 2) // DV2 [general]
     {
      if (MapCheck >= 1209 && MapCheck <= 1215) // DV2's Hell Levels
      {
       LevelCheck += random(10,25);
      }
	  else
	  {
       LevelCheck += random(0,10);
	  }
     }
	 else // Normal Mode
	 {
	  // Specfic Actors
 	  if (CheckActorClass(0, "RebelNew")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel1New")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel2New")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel3New")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel4New")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel5New")) LevelCheck += random(-3,7);
 	  if (CheckActorClass(0, "Rebel6New")) LevelCheck += random(-3,7);

	  // Specfic Monsters
       // Mini-Boss
 	  if (CheckActorClass(0, "DSSpiderMastermind")) LevelCheck += random(3,6);
 	  if (CheckActorClass(0, "Demolisher")) LevelCheck += random(3,6);
 	  if (CheckActorClass(0, "DSCyberdemon")) LevelCheck += random(3,6);
 	  if (CheckActorClass(0, "Annihilator")) LevelCheck += random(3,6);

	  // Specfic Bosses
       // Tier 1 Boss
 	  if (CheckActorClass(0, "DSparilMountedNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "FighterBossNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "ClericBossNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "MagicBossNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "ProgrammerNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "StrifeBishopNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "OracleNew")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "Macil1New")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "Macil2New")) LevelCheck += random(9,18);
      if (CheckActorClass(0, "LoremasterNew")) LevelCheck += random(9,18);
       // Tier 2 Boss
 	  if (CheckActorClass(0, "DSBossBrain")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre1New")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre2New")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre3New")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre4New")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre5New")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre1Model")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre2Model")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre3Model")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre4Model")) LevelCheck += random(15,30);
      if (CheckActorClass(0, "AlienSpectre5Model")) LevelCheck += random(15,30);
 	  if (CheckActorClass(0, "SourceGuardian")) LevelCheck += random(15,30);
       // Tier 3 Boss
 	  if (CheckActorClass(0, "DSparilUnmountedNew")) LevelCheck += random(23,45);
	  if (CheckActorClass(0, "Zakachi")) LevelCheck += random(23,45);
	  if (CheckActorClass(0, "KoraxNew")) LevelCheck += random(23,45);
 	  if (CheckActorClass(0, "ThamuzNew")) LevelCheck += random(23,45);
 	  if (CheckActorClass(0, "AvatarNew")) LevelCheck += random(23,45);
 	  if (CheckActorClass(0, "TchernobogNew")) LevelCheck += random(23,45);
 	  if (CheckActorClass(0, "AdolfHitlerDS")) LevelCheck += random(23,45);
 	  if (CheckActorClass(0, "DSMotherDemon64")) LevelCheck += random(23,45);
       // Tier 4 Boss
 	  if (CheckActorClass(0, "EntityBossNew")) LevelCheck += random(37,75);
	  if (CheckActorClass(0, "EntitySecondNew")) LevelCheck += random(37,75);
 	  if (CheckActorClass(0, "PennywiseBoss")) LevelCheck += random(37,75);
 	  if (CheckActorClass(0, "Sauravatar")) LevelCheck += random(37,75);
 	  if (CheckActorClass(0, "TheSource")) LevelCheck += random(37,75);
       // Tier 5 Boss
 	  if (CheckActorClass(0, "EntityAscended")) LevelCheck += random(75,112);
       // Oddball Tier Boss
 	  if (CheckActorClass(0, "Benellus1DS")) LevelCheck += random(37,75);
 	  if (CheckActorClass(0, "Benellus2DS")) LevelCheck += random(42,80);
 	  if (CheckActorClass(0, "Benellus3DS")) LevelCheck += random(47,85);
 	  if (CheckActorClass(0, "Magmantis")) LevelCheck += random(52,75);
	 }
	 if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [actor-check: ",s:actorname,s:"]: ",d:(LevelCheck));

	 // Check if the actor is one of Strife's Peasents [and if so, cancel out most level additions and divide their level by 4]
	 int IsAPeasent = 0;
	 If(CheckActorClass(0,"PeasantNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant1New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant2New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant3New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant4New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant5New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant6New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant7New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant8New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant9New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant10New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant11New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant12New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant13New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant14New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant15New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant16New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant17New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant18New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant19New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant20New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant21New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Peasant22New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"BeggarNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Beggar1New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Beggar2New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Beggar3New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Beggar4New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"Beggar5New") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"MerchantNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"WeaponSmithNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"BarKeepNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"ArmorerNew") == 1) IsAPeasent ++;
	 If(CheckActorClass(0,"MedicNew") == 1) IsAPeasent ++;

	 If(IsAPeasent > 0)
	 {
	  LevelCheck /= 4;
	 }
	 else
	 {
      if (random(1,10) <= 1)
      {
       if (random(1,10) <= 1)
       {
        if (random(1,10) <= 1)
        {
         LevelCheck += random(64,96);
        }
        else
        {
         LevelCheck += random(16,24);
        }
       }
       else
       {
        LevelCheck += random(4,6);
       }
      }
	  if (extraflags & 1) { LevelCheck *= 4; } else { if (random(1,64) == 1) LevelCheck *= 4; }
	  if (extraflags & 2) { LevelCheck *= 4; }
	 }
	 if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [peasent-checking]: ",d:(LevelCheck));

     if (LevelCheck < 0) LevelCheck = 0;
     if (LevelCheck > 2000) LevelCheck = 2000;
     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\ckMonsterLevel [final calc]: ",d:(LevelCheck));
     SetUserVariable(0,"user_monsterlevel",LevelCheck);

     AttackFactor = 0.0;
     if (LevelCheck > 0) AttackFactor += (LevelBaseMulti * (LevelCheck));

     DefenseFactor = FixedDiv(1.0, (AttackFactor+1.0)); //(1.0 / (AttackFactor + 1.0)) - 1.0;
     DefenseFactor -= 1.0;

     SpeedFactor = FixedDiv(AttackFactor,4.0);

     MaxHPFactor = AttackFactor;

     BalanceFactor = AttackFactor;

     if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
     {
	  PrintBold(s:"\cgAttackFactor [MonLevel]: ",f:(AttackFactor),s:"\n\n",
	            s:"\cdDefenseFactor [MonLevel]: ",f:(DefenseFactor),s:"\n\n",
				s:"\chSpeedFactor [MonLevel]: ",f:(SpeedFactor),s:"\n\n",
				s:"\caMaxHPFactor [MonLevel]: ",f:(MaxHPFactor),s:"\n\n",
				s:"\cpBalanceFactor [MonLevel]: ",f:(BalanceFactor));
	 }

    SpeedFactor = FixedMul(SpeedFactor, GetCVar("dvds_monsterspeedratio_levels"));
    if (SpeedFactor < -2.00) SpeedFactor = -2.00;
    if (SpeedFactor > 2.00) SpeedFactor = 2.00;
    Speed = FixedMul(Speed, (1.0+SpeedFactor));
    SetActorProperty(0,APROP_Speed,Speed); 

    AttackFactor = FixedMul(AttackFactor, GetCVar("dvds_monsterattackratio_levels"));
    if (AttackFactor < -2.00) AttackFactor = -2.00;
    if (AttackFactor > 2.00) AttackFactor = 2.00;
    Attack = FixedMul(Attack, (1.0+AttackFactor));
    SetActorProperty(0,APROP_DamageMultiplier,Attack); 

    DefenseFactor = FixedMul(DefenseFactor, GetCVar("dvds_monsterdefenseratio_levels"));
    if (DefenseFactor < -2.00) DefenseFactor = -2.00;
    if (DefenseFactor > 2.00) DefenseFactor = 2.00;
    Defense = FixedMul(Defense, (1.0+DefenseFactor));
    SetActorProperty(0,APROP_DamageFactor,Defense); 

    MaxHPFactor = FixedMul(MaxHPFactor, GetCVar("dvds_monstermaxhpratio_levels"));
    if (MaxHPFactor < -2.00) MaxHPFactor = -2.00;
    if (MaxHPFactor > 2.00) MaxHPFactor = 2.00;
    MaxHP = FixedMul(MaxHP, (1.0+MaxHPFactor));

    BalanceFactor = FixedMul(BalanceFactor, GetCVar("dvds_monsterbalanceratio_skill"));
    if (BalanceFactor < -2.00) BalanceFactor = -2.00;
    if (BalanceFactor > 2.00) BalanceFactor = 2.00;
    Balance = FixedMul(Balance, (1.0+BalanceFactor));
    SetActorProperty(0,APROP_Mass,Balance); 

    if (Attack < 0.005) Attack = 0.005;
    if (Attack > 20.00) Attack = 20.00;
    if (Defense < 0.005) Defense = 0.005;
    if (Defense > 20.00) Defense = 20.00;
    if (MaxHP < 1) MaxHP = 1;
    if (MaxHP > 2147483647) MaxHP = 2147483647;

    if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
    {
     PrintBold(s:"\chSpeedFactor: ",f:(1.0+SpeedFactor),s:"\n",
               s:"\chSpeed After Levels: ",f:Speed,s:"\n\n",
               s:"\cgAttackFactor: ",f:(1.0+AttackFactor),s:"\n",
			   s:"\cgAttack After Levels: ",f:Attack,s:"\n\n",
			   s:"\cdDefenseFactor: ",f:(1.0+DefenseFactor),s:"\n",
			   s:"\cdDefense After Levels: ",f:Defense,s:"\n\n",
			   s:"\caMaxHPFactor: ",f:(1.0+MaxHPFactor),s:"\n",
			   s:"\caMaxHP After Levels: ",d:MaxHP,s:"\n\n",
			   s:"\cpBalanceFactor: ",f:(1.0+BalanceFactor),s:"\n",
			   s:"\cpBalance After Levels: ",d:Balance);
	}
  }


  //**********************************************
  //** Calculates Stats Based on Varience/Error **
  //**********************************************
  int ErrorChecker = 1;
  if (ModType == 0)
  { 
   if (GetCVar("dvds_monsterstatcalc_varience") > 0) ErrorChecker = 1; else ErrorChecker = 0;
  }
  else ErrorChecker = 1;

  nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") <= 0) nonstatmonster = 1;
  if (CheckActorClass(0, "DSBossBrain") && ThingCountName("DSBossEye", 0) <= 0) nonstatmonster = 1;
  if (ErrorChecker == 1 && nonstatmonster == 0)
  {
   // HP Error
   int MaxHPErrorRange = FixedMul(MaxHP, GetCVar("dvds_monstermaxhpvarience")); //MaxHP / 10;
   MaxHP += random(-MaxHPErrorRange,MaxHPErrorRange);
   if (MaxHP < 1) MaxHP = 1;

   int SpeedErrorRange = FixedMul(Speed, GetCVar("dvds_monsterspeedvarience"));
   Speed += random(-SpeedErrorRange,SpeedErrorRange);
   SetActorProperty(0,APROP_Speed,Speed); //Set's Final Speed values

   int AttackErrorRange = FixedMul(Attack, GetCVar("dvds_monsterattackvarience"));
   Attack += random(-AttackErrorRange,AttackErrorRange);
   SetActorProperty(0,APROP_DamageMultiplier,Attack); 

   int DefenseErrorRange = FixedMul(Defense, GetCVar("dvds_monsterdefensevarience"));
   Defense += random(-DefenseErrorRange,DefenseErrorRange);
   SetActorProperty(0,APROP_DamageFactor,Defense); 

   int BalanceErrorRange = FixedMul(Balance, GetCVar("dvds_monsterbalancevarience"));
   Balance += random(-BalanceErrorRange,BalanceErrorRange);
   SetActorProperty(0,APROP_Mass,Balance); 

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {
    PrintBold(s:"\caMaxHP Error Range: ",d:MaxHPErrorRange,s:"\n\n",
	          s:"\chSpeed Error Range: ",f:SpeedErrorRange,s:"\n\n",
			  s:"\cgAttack Error Range: ",f:AttackErrorRange,s:"\n\n",
			  s:"\cdDefense Error Range: ",f:DefenseErrorRange,s:"\n\n",
			  s:"\cpBalance Error Range: ",f:BalanceErrorRange);
   }
  }

  //****************************
  //** Specialized Situations **
  //****************************
  // Strife Rebels
  int IsARebel = 0;
  if (CheckActorClass(0, "RebelNew")) IsARebel ++;
  if (CheckActorClass(0, "Rebel1New")) IsARebel ++;
  if (CheckActorClass(0, "Rebel2New")) IsARebel ++;
  if (CheckActorClass(0, "Rebel3New")) IsARebel ++;
  if (CheckActorClass(0, "Rebel4New")) IsARebel ++;
  if (CheckActorClass(0, "Rebel5New")) IsARebel ++;
  if (CheckActorClass(0, "Rebel6New")) IsARebel ++;
  if (IsARebel > 0)
  {
   // Rebels get an HP boost dependant on the Player's "Stamina" stat in Strife [to reflect them having undergone the process as the player does to "keep up"] :V
   int OldMaxHP = MaxHP;
   MaxHP = MaxHP * (100 + (MiscellaneousVars[317] * 10)) / 100;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
   {
    PrintBold(s:"\caPre Stamina Max HP: ",d:OldMaxHP,s:"\n\n",
	          s:"\caPost Stamina Max HP: ",d:MaxHP,s:"\n\n",
			  s:"\cgPlayer's Stamina Level: ",d:MiscellaneousVars[317]);
   }
   str StaminaUpgradeItem;
   StaminaUpgradeItem = StrParam(s:"StaminaUpgrade", d:MiscellaneousVars[317]);
   GiveInventory(StaminaUpgradeItem, 1);

   str AccuracyUpgradeItem;
   AccuracyUpgradeItem = StrParam(s:"AccuracyUpgrade", d:MiscellaneousVars[318]);
   GiveInventory(AccuracyUpgradeItem, 1);
  }
  
  //*******************************************************************
  //** Specialized Boss Options [D'Sparil/Korax/Spectres/Entity/etc] **
  //*******************************************************************
  // Doom2
  if (CheckActorClass(0, "DSBossBrain") && GetCVar("dvds_improvediconofsin") > 0 && ThingCountName("DSBossEye", 0) > 0)
  {
   MaxHP *= 8;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Icon of Sin): ",d:MaxHP);
  }

  // DUMP3
  if (CheckActorClass(0, "AdolfHitlerDS"))
  {
   MaxHP *= 5;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Hitler [DUMP3]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Benellus1DS"))
  {
   MaxHP *= 5;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Benellus 1 [DUMP3]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Benellus2DS"))
  {
   MaxHP *= 5;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Benellus 2 [DUMP3]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Benellus3DS"))
  {
   MaxHP *= 4;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Benellus 3 [DUMP3]): ",d:MaxHP);
  }
  // KDIZD
  if (CheckActorClass(0, "Magmantis"))
  {
   MaxHP *= 7;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Magmantis): ",d:MaxHP);
  }
  // Unloved
  if (CheckActorClass(0, "AvatarNew"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Avatar): ",d:MaxHP);
  }
  // Doom 64 Retribution
  if (CheckActorClass(0, "DSMotherDemon64"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Mother Demon): ",d:MaxHP);
  }
  // TCOTD:A
  if (CheckActorClass(0, "ThamuzNew"))
  {
   MaxHP = (MaxHP * 3) / 2;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Thamuz): ",d:MaxHP);
  }
  if (CheckActorClass(0, "TchernobogNew"))
  {
   MaxHP = (MaxHP * 3) / 2;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Tchernobog): ",d:MaxHP);
  }
  // HTC II
  if (CheckActorClass(0, "PennywiseBoss"))
  {
   MaxHP = (MaxHP * 3) / 2;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Thamuz): ",d:MaxHP);
  }
  // TUTNT
  if (CheckActorClass(0, "SourceGuardian"))
  {
   MaxHP = (MaxHP * random(4,5)) / 4;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Source Guardian [TUTNT]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "TheSource"))
  {
   MaxHP *= 4;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Source of All Evil [TUTNT]): ",d:MaxHP);
  }

  // Hexen
  if (CheckActorClass(0, "DragonNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Death Wyvern): ",d:MaxHP);
  }

  // Hexen
  if (CheckActorClass(0, "HeresiarchNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Heresiarch): ",d:MaxHP);
  }

  if (CheckActorClass(0, "ClericBossNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Traductus): ",d:MaxHP);
  }
  if (CheckActorClass(0, "MageBossNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Melenkir): ",d:MaxHP);
  }
  if (CheckActorClass(0, "FighterBossNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Zedek): ",d:MaxHP);
  }

  // Heretic
  if (CheckActorClass(0, "DSparilMountedNew"))
  {
   // MaxHP *= 12;

   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (D'Sparil [Mounted]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "DSparilUnmountedNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (D'Sparil [Unmounted]): ",d:MaxHP);
  }
  if (CheckActorClass(0, "KoraxNew"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Korax): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Zakachi"))
  {
   // MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Zakachi Daemonbourne): ",d:MaxHP);
  }

  // Strife
  if (CheckActorClass(0, "ProgrammerNew"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Programmer): ",d:MaxHP);
  }
  if (CheckActorClass(0, "StrifeBishopNew"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Bishop): ",d:MaxHP);
  }
  if (CheckActorClass(0, "OracleNew"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Oracle): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Macil1New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Macil1): ",d:MaxHP);
  }
  if (CheckActorClass(0, "Macil2New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Macil2): ",d:MaxHP);
  }
  if (CheckActorClass(0, "LoremasterNew"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Loremaster): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre1New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Programmer's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre2New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Bishop's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre3New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Oracle's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre4New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Macil's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre5New"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Loremaster's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre1Model"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Programmer's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre2Model"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Bishop's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre3Model"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Oracle's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre4Model"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Macil's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "AlienSpectre5Model"))
  {
   MaxHP *= 16;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Loremaster's Spectre): ",d:MaxHP);
  }
  if (CheckActorClass(0, "EntityBossNew"))
  {
   MaxHP *= 24;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (The Entity): ",d:MaxHP);
  }
  if (CheckActorClass(0, "EntitySecondNew"))
  {
   MaxHP *= 24;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (Mini Entity): ",d:MaxHP);
  }
  if (CheckActorClass(0, "EntityAscended"))
  {
   MaxHP *= 24;
   if (GetCVar("dvdsdebug_showstatcalcstuff") != 0) PrintBold(s:"\caMaxHP (ASCENDED Entity): ",d:MaxHP);
  }
  
  if (Attack < 0.005) Attack = 0.005;
  if (Attack > 20.00) Attack = 20.00;
  if (Defense < 0.005) Defense = 0.005;
  if (Defense > 20.00) Defense = 20.00;
  if (MaxHP < 1) MaxHP = 1;
  if (MaxHP > 2147483647) MaxHP = 2147483647;

  //** Set's Final MaxHP and Current HP values **
  SetActorProperty(0,APROP_Health,MaxHP);
  SetActorProperty(0,APROP_SpawnHealth,MaxHP);
  if (GetCVar("dvdsdebug_showstatcalcstuff") != 0)
  {
   PrintBold(s:"\chFinal Speed: ",f:Speed,s:"\n",
             s:"\cgFinal Attack: ",f:Attack,s:"\n",
			 s:"\cdFinal Defense: ",f:Defense,s:"\n",
			 s:"\caFinal Max HP: ",d:MaxHP,s:"\n",
             s:"\cpFinal Balance: ",d:Balance,s:"\n",
			 s:"\ck[Actor-Check: ",s:actorname,s:"]");
  }

  if (GetActorClass(0) != "Sauravatar") { SetInventory("CurrentMaxHealth", MaxHP); SetUserVariable(0,"user_MaxHP",MaxHP); }
  if (CheckActorClass(0, "HeresiarchNew"))
  {  
   SetActorProperty(0,APROP_Score,MaxHP);
  }

  // Sets the monster's "Desperation Buff" level. The level it must fall below in order to gain it's unique buffs
  RangeVar = 375;
  if (GameSkill() == SKILL_VERY_EASY) RangeVar = 250; // 25.0%
  if (GameSkill() == SKILL_EASY) RangeVar = 313; // 31.3%
  if (GameSkill() == SKILL_NORMAL) RangeVar = 375; // 37.5%
  if (GameSkill() == SKILL_HARD) RangeVar = 437; // 43.7%
  if (GameSkill() == SKILL_VERY_HARD) RangeVar = 500; // 50.0%
  if (GameSkill() == 5) RangeVar = 625; // 62.5%
  Temp = MaxHP * RangeVar / 1000;
  Temp = Temp + 1;
  if (Temp < 2) Temp = 2;
  SetUserVariable(0,"user_HPBuffRange",Temp);


  // Sets the monster's "Low Range" of HP, meaning there is a 25% chance it will execute a "nova" or "shock" attack
  RangeVar = 160;
  if (GameSkill() == SKILL_VERY_EASY) RangeVar = 80; // 8.0%
  if (GameSkill() == SKILL_EASY) RangeVar = 120; // 12.0%
  if (GameSkill() == SKILL_NORMAL) RangeVar = 160; // 16.0%
  if (GameSkill() == SKILL_HARD) RangeVar = 200; // 20.0%
  if (GameSkill() == SKILL_VERY_HARD) RangeVar = 240; // 24.0%
  if (GameSkill() == 5) RangeVar = 320; // 32.0%
  Temp = MaxHP * RangeVar / 1000;
  Temp = Temp + 1;
  if (Temp < 2) Temp = 2;
  SetUserVariable(0,"user_HPLowRange",Temp);
  if (CheckActorClass(0, "HeresiarchNew"))
  {  
   SetActorProperty(0,APROP_Accuracy,Temp);
  }

  // Sets the monster's "Critical Range" of HP, meaning there is a 100% chance it will execute a "nova" or "shock" attack
  RangeVar = 20;
  if (GameSkill() == SKILL_VERY_EASY) RangeVar = 10; // 1.0%
  if (GameSkill() == SKILL_EASY) RangeVar = 15; // 1.5%
  if (GameSkill() == SKILL_NORMAL) RangeVar = 20; // 2.0%
  if (GameSkill() == SKILL_HARD) RangeVar = 25; // 2.5%
  if (GameSkill() == SKILL_VERY_HARD) RangeVar = 30; // 3.0%
  if (GameSkill() == 5) RangeVar = 40; // 4.0%
  Temp = MaxHP * RangeVar / 1000;
  Temp = Temp + 1;
  if (Temp < 2) Temp = 2;
  SetUserVariable(0,"user_HPCritRange",Temp);
  if (CheckActorClass(0, "HeresiarchNew"))
  {  
   SetActorProperty(0,APROP_Stamina,Temp);
  }


  // Sets the monster's "Extreme Death" range of HP, determining how much it takes to gib most monsters (or permenantly kill a Death Incarnate)
  Temp = MaxHP * -1; // -100.0%
  if (Temp > 0) Temp = 0;
  SetUserVariable(0,"user_HPXDeathRange",Temp);

  // Excutes Lifebar-Related Code
  GiveInventory("MonsterDisplayDMG", 1);
  ACS_NamedExecuteAlways("DamageDisplays",0,0,0,0);

  GiveInventory("MonsterHasBuffs", 1);
  SetUserVariable(0, "user_checkmapskill", GetUserVariable(0, "user_checkmapskill") + 1);
  if (CheckFlag(0,"FRIENDLY") == 1) Thing_ChangeTID(0,1000);
 }
 else // Usually if the monster/actor is dying, the script is called using "type 1"
 {
  if (CheckFlag(0,"FRIENDLY") == 1) Thing_ChangeTID(1000,0);
  if (CheckInventory("MonsterHasBuffs") <= 0) terminate;
  if (GetUserVariable(0, "user_checkmapskill") < 1) terminate;
  SetActorProperty(0,APROP_DamageMultiplier,GetUserVariable(0, "user_baseattack"));
  SetActorProperty(0,APROP_DamageFactor,GetUserVariable(0, "user_basedefense"));
  SetActorProperty(0,APROP_Speed,GetUserVariable(0, "user_basespeed"));
  SetActorProperty(0,APROP_Mass,GetUserVariable(0, "user_basemass"));

  TakeInventory("MonsterDisplayDMG", 1);
  TakeInventory("MonsterHasBuffs", 1);
  SetUserVariable(0, "user_legendaryevolved",0);
  SetUserVariable(0, "user_monsterlevel",0);
  SetUserVariable(0, "user_checkmapskill", 0);
  SetUserVariable(0, "user_isstealth", 0);
 }
}

script "CheckFloraItems" (int forelse)
{
 if (forelse == 1) // else
 {
  if (CharacterClass == 2)
  {
   Thing_ChangeTID(0,1534); Thing_Remove(1534);
  }
 }
 else // for
 {
  if (CharacterClass != 2)
  {
   Thing_ChangeTID(0,1534); Thing_Remove(1534);
  }
 }
}

// Checks and Removes Hellcore weapons when Deggaris or Illucia are detected as the current character
script "HellcoreWeaponCheckCharacter" (int Weapontype)
{
 int IsWeaponLevelMaxed;
 if (CharacterClass == 2)
 {
  IsWeaponLevelMaxed = 0;
  if (Weapontype == 0 && MiscellaneousVars[96] >= 8) IsWeaponLevelMaxed = 1; // Imp Claw [4]
  if (Weapontype == 1 && MiscellaneousVars[97] >= 8) IsWeaponLevelMaxed = 1; // Dark Imp Claw [4]

  if (Weapontype == 2 && MiscellaneousVars[98] >= 8) IsWeaponLevelMaxed = 1; // CacoDemon Eye [4]
  if (Weapontype == 3 && MiscellaneousVars[99] >= 8) IsWeaponLevelMaxed = 1; // Cacolantern Eye [4]
  if (Weapontype == 4 && MiscellaneousVars[100] >= 8) IsWeaponLevelMaxed = 1; // Abaddon Eye [4]

  if (Weapontype == 5 && MiscellaneousVars[101] >= 8) IsWeaponLevelMaxed = 1; // Knight Fist [5]
  if (Weapontype == 6 && MiscellaneousVars[102] >= 8) IsWeaponLevelMaxed = 1; // Baron Fist [5]
  if (Weapontype == 7 && MiscellaneousVars[103] >= 8) IsWeaponLevelMaxed = 1; // Belphegor Fist [5]
  if (Weapontype == 8 && MiscellaneousVars[104] >= 8) IsWeaponLevelMaxed = 1; // Bruiser Fist [5]
  if (Weapontype == 9 && MiscellaneousVars[105] >= 8) IsWeaponLevelMaxed = 1; // Archon Fist [5]
  if (Weapontype == 10 && MiscellaneousVars[106] >= 8) IsWeaponLevelMaxed = 1; // Pyro Fist [5]

  if (Weapontype == 11 && MiscellaneousVars[107] >= 8) IsWeaponLevelMaxed = 1; // Incarnate Skull [6]
  if (Weapontype == 12 && MiscellaneousVars[108] >= 8) IsWeaponLevelMaxed = 1; // Archvile Hand [6]
  if (Weapontype == 13 && MiscellaneousVars[109] >= 8) IsWeaponLevelMaxed = 1; // Diabloist Hand  [6]
  if (Weapontype == 14 && MiscellaneousVars[110] >= 8) IsWeaponLevelMaxed = 1; // Balrog Fist [6]

  if (Weapontype == 15 && MiscellaneousVars[111] >= 8) IsWeaponLevelMaxed = 1; // Elemental's Eye [6]
  if (Weapontype == 16 && MiscellaneousVars[112] >= 8) IsWeaponLevelMaxed = 1; // Overlord's Eye [6]
  if (IsWeaponLevelMaxed != 0) { Thing_ChangeTID(0,1534); Thing_Remove(1534); }
 }
 else { Thing_ChangeTID(0,1534); Thing_Remove(1534); }
}

// Checks the mapnumber and gametype for Monster Spawners (main number)
script "GetEvolveChance" (void)
{
 int SpawnChance, G1, LevelCheck, MapCheck;

 if (GetCVar("dvds_rnd_evolve") == 0) { SpawnChance = 0; SetResultValue(SpawnChance); terminate; }
 else SpawnChance = GetCVar("dvds_rnd_evolvechance");
 if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Base]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));

 if (SpawnChance < 0) SpawnChance = 0;
 if (SpawnChance > 512) SpawnChance = 512;

 if (GetCVar("dvds_rnd_evolve_levels") == 1) 
 { 
  SpawnChance = SpawnChance + (SceptreActualLevel * 2 / 10) + (PlayerLevel / 15); 
  if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Level]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 }

 if (GetCVar("dvds_rnd_evolve_chars") == 1) 
 { 
  if (CharacterClass == 0) SpawnChance = SpawnChance * 900 / 1000;
  else if (CharacterClass == 1) SpawnChance = SpawnChance * 975 / 1000;
  else if (CharacterClass == 2) SpawnChance = SpawnChance * 1050 / 1000;
  else SpawnChance = SpawnChance * 1000 / 1000;
  if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Character]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 }

 if (GetCVar("dvds_rnd_evolve_skill") == 1) 
 { 
  if (GameSkill() == SKILL_VERY_EASY) SpawnChance = SpawnChance * 80 / 100;
  else if (GameSkill() == SKILL_EASY) SpawnChance = SpawnChance * 90 / 100;
  else if (GameSkill() == SKILL_NORMAL) SpawnChance = SpawnChance * 100 / 100;
  else if (GameSkill() == SKILL_HARD) SpawnChance = SpawnChance * 110 / 100;
  else if (GameSkill() == SKILL_VERY_HARD) SpawnChance = SpawnChance * 125 / 100;
  else SpawnChance = SpawnChance * 100 / 100;
  if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Skill]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 }
  
 if (GetCVar("dvds_rnd_evolve_sauronequip") == 1) 
 { 
  if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) SpawnChance = SpawnChance * 110 / 100; // Elevates Spawn Chances by 10%
  if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0) SpawnChance = SpawnChance * 110 / 100; // Elevates Spawn Chances by 10%
  if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [SauronEquip]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 }
   
 if (GetCVar("dvds_rnd_evolve_maps") == 1) 
 { 
  if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
  {
   if (ClassicDoomType == 1 || ClassicDoomType == 2) // Doom 1 / Heretic
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[54];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1) MapCheck = 1;
    if (MapCheck > 50) MapCheck = 50;
 
    if (MapCheck >= 1 && MapCheck <= 10) G1 = (MapCheck * 30);
    if (MapCheck >= 11 && MapCheck <= 20) G1 = (MapCheck * 35);
    if (MapCheck >= 21 && MapCheck <= 30) G1 = (MapCheck * 40);
    if (MapCheck == 31) G1 = (MapCheck * 42);
    if (MapCheck == 32) G1 = (MapCheck * 44);
    if (MapCheck == 39) G1 = (MapCheck * 47);
    if (MapCheck == 40) G1 = (MapCheck * 47);
    if (MapCheck == 33) G1 = (MapCheck * 50);
    if (MapCheck == 34) G1 = (MapCheck * 54);
    if (MapCheck == 35) G1 = (MapCheck * 58);
    if (MapCheck == 36) G1 = (MapCheck * 63);
    if (MapCheck == 37) G1 = (MapCheck * 68);
    if (MapCheck == 38) G1 = (MapCheck * 75);
    if (MapCheck == 41) G1 = (MapCheck * 78);
    if (MapCheck == 42) G1 = (MapCheck * 81);
    if (MapCheck == 49) G1 = (MapCheck * 84);
    if (MapCheck == 50) G1 = (MapCheck * 87);
    if (MapCheck == 43) G1 = (MapCheck * 91);
    if (MapCheck == 44) G1 = (MapCheck * 95);
    if (MapCheck == 45) G1 = (MapCheck * 99);
    if (MapCheck == 46) G1 = (MapCheck * 104);
    if (MapCheck == 47) G1 = (MapCheck * 109);
    if (MapCheck == 48) G1 = (MapCheck * 115);
    if (MapCheck == 49) G1 = (MapCheck * 121);
    if (MapCheck == 50) G1 = (MapCheck * 127);
   }
   else // Doom 2 / Hexen / Strife / Doom64
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[54];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1) MapCheck = 1;
    if (MapCheck > 50) MapCheck = 50;
 
    if (MapCheck >= 1 && MapCheck <= 5) G1 = (MapCheck * 30);
    if (MapCheck >= 6 && MapCheck <= 10) G1 = (MapCheck * 35);
    if (MapCheck >= 11 && MapCheck <= 15) G1 = (MapCheck * 40);
    if (MapCheck >= 16 && MapCheck <= 20) G1 = (MapCheck * 45);
    if (MapCheck >= 21 && MapCheck <= 25) G1 = (MapCheck * 55);
    if (MapCheck == 26) G1 = (MapCheck * 56);
    if (MapCheck == 27) G1 = (MapCheck * 58);
    if (MapCheck == 28) G1 = (MapCheck * 61);
    if (MapCheck == 29) G1 = (MapCheck * 65);
    if (MapCheck == 30) G1 = (MapCheck * 70);
    if (MapCheck == 31) G1 = (MapCheck * 45);
    if (MapCheck == 32) G1 = (MapCheck * 55);
    if (MapCheck == 33) G1 = (MapCheck * 72);
    if (MapCheck == 34) G1 = (MapCheck * 74);
    if (MapCheck == 35) G1 = (MapCheck * 76);
    if (MapCheck == 36) G1 = (MapCheck * 79);
    if (MapCheck == 37) G1 = (MapCheck * 82);
    if (MapCheck == 38) G1 = (MapCheck * 85);
    if (MapCheck == 39) G1 = (MapCheck * 88);
    if (MapCheck == 40) G1 = (MapCheck * 92);
    if (MapCheck == 41) G1 = (MapCheck * 96);
    if (MapCheck == 42) G1 = (MapCheck * 100);
    if (MapCheck == 43) G1 = (MapCheck * 104);
    if (MapCheck == 44) G1 = (MapCheck * 109);
    if (MapCheck == 45) G1 = (MapCheck * 114);
    if (MapCheck == 46) G1 = (MapCheck * 119);
    if (MapCheck == 47) G1 = (MapCheck * 125);
    if (MapCheck == 48) G1 = (MapCheck * 131);
    if (MapCheck == 49) G1 = (MapCheck * 137);
    if (MapCheck == 50) G1 = (MapCheck * 143);
   }
   G1 += 1000;
   SpawnChance = SpawnChance * G1 / 1000;
  }
  else if (ModType == 1) // DVI
  {
   MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
   MapCheck += MiscellaneousVars[54];
   MapCheck += MiscellaneousVars[169];
   if (MapCheck < 1101) MapCheck = 1101;
   if (MapCheck > 1104) MapCheck = 1104;

   if (MapCheck == 1101) SpawnChance = SpawnChance * 1000 / 1000; // MAP01 - Insurgents
   else if (MapCheck == 1102) SpawnChance = SpawnChance * 1116 / 1000; // MAP02 - Torture Chamber
   else if (MapCheck == 1103) SpawnChance = SpawnChance * 1256 / 1000; // MAP03 - Cathedral
   else if (MapCheck == 1104) SpawnChance = SpawnChance * 1418 / 1000; // MAP04 - End Of Days
   else SpawnChance = SpawnChance * 1000 / 1000; // Any other Map
  }
  else if (ModType == 2) // DVII
  {
   MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
   MapCheck += MiscellaneousVars[54];
   MapCheck += MiscellaneousVars[169];
   if (MapCheck < 1201) MapCheck = 1201;
   if (MapCheck > 1212) MapCheck = 1212;
 
   if (MapCheck == 1201) SpawnChance = SpawnChance * 1000 / 1000; // MAP01 - Entryway Pass
   else if (MapCheck == 1202) SpawnChance = SpawnChance * 1070 / 1000; // MAP02 - Mutagen
   else if (MapCheck == 1203) SpawnChance = SpawnChance * 1140 / 1000; // MAP03 - Crouching Demon, Hidden Archvile
   else if (MapCheck == 1204) SpawnChance = SpawnChance * 1209 / 1000; // MAP04 - Minas Morgul
   else if (MapCheck == 1205) SpawnChance = SpawnChance * 1302 / 1000; // MAP05 - Eagle's Nest
   else if (MapCheck == 1206) SpawnChance = SpawnChance * 1395 / 1000; // MAP05B - The Manliest Level Ever
   else if (MapCheck == 1207) SpawnChance = SpawnChance * 1488 / 1000; // MAP06 - Stargate
   else if (MapCheck == 1208) SpawnChance = SpawnChance * 1605 / 1000; // MAP07 - The Desert Temple
   else if (MapCheck == 1209) SpawnChance = SpawnChance * 1953 / 1000; // MAP08 - The Unholy Cathedral
   else if (MapCheck == 1210) SpawnChance = SpawnChance * 2372 / 1000; // MAP09 - You Shall Not Pass!
   else if (MapCheck == 1211) SpawnChance = SpawnChance * 2884 / 1000; // MAP10 - Hell's Vendetta
   else if (MapCheck == 1212) SpawnChance = SpawnChance * 3488 / 1000; // MAP10B - attedneV s'lleH
   else if (MapCheck == 1214) SpawnChance = SpawnChance * 1465 / 1000; // MAP12 - "The Wings of The Maiar" [DVI combined level remake]
   else if (MapCheck == 1215) SpawnChance = SpawnChance * 3488 / 1000; // MAP10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
   else SpawnChance = SpawnChance * 1000 / 1000; // All other Maps
  }
  else SpawnChance = SpawnChance * 1000 / 1000;
  if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Maps]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 }

 // Check if the actor is one of Strife's Peasents [and if so, sets Evolve Chance to 0]
 int IsAPeasent = 0;
 If(CheckActorClass(0,"PeasantNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant1New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant2New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant3New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant4New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant5New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant6New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant7New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant8New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant9New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant10New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant11New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant12New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant13New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant14New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant15New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant16New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant17New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant18New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant19New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant20New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant21New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant22New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"BeggarNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar1New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar2New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar3New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar4New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar5New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"MerchantNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"WeaponSmithNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"BarKeepNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"ArmorerNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"MedicNew") == 1) IsAPeasent ++;
 If(IsAPeasent > 0) SpawnChance = 0;
 if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [PeasentCheck]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));

 if (GetCVar("dvdsdebug_evolvestuff") == 1) PrintBold(s:"Evolve Chance [Final]: ",d:SpawnChance,s:" - ",s:GetActorClass(0));
 SetResultValue(SpawnChance);
}

// Checks the mapnumber and gametype for Monster Spawners (stealth number)
script "GetStealthChance" (void)
{
 int StealthChance, G1, LevelCheck, MapCheck;

 if(GetCVar("dvds_rnd_stealth") == 0) { StealthChance = 0; SetResultValue(StealthChance); terminate; }
 else StealthChance = GetCVar("dvds_rnd_stealthchance");
 if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Base]: ",d:StealthChance,s:" - ",s:GetActorClass(0));

 if (StealthChance < 0) StealthChance = 0;
 if (StealthChance > 512) StealthChance = 512;

 if (GetCVar("dvds_rnd_stealth_levels") == 1) 
 { 
  StealthChance = StealthChance + (SceptreActualLevel * 2 / 50) + (PlayerLevel / 75); 
  if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Level]: ",d:StealthChance,s:" - ",s:GetActorClass(0));
 }

 if (GetCVar("dvds_rnd_stealth_chars") == 1) 
 { 
  if (CharacterClass == 0) StealthChance = StealthChance * 1125 / 1000;
  else if (CharacterClass == 1) StealthChance = StealthChance * 1000 / 1000;
  else if (CharacterClass == 2) StealthChance = StealthChance * 875 / 1000;
  else StealthChance = StealthChance * 1000 / 1000;
  if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Character]: ",d:StealthChance,s:" - ",s:GetActorClass(0));
 }
  
 if (GetCVar("dvds_rnd_stealth_skill") == 1) 
 { 
  if (GameSkill() == SKILL_VERY_EASY) StealthChance = StealthChance * 75 / 100;
  else if (GameSkill() == SKILL_EASY) StealthChance = StealthChance * 90 / 100;
  else if (GameSkill() == SKILL_NORMAL) StealthChance = StealthChance * 100 / 100;
  else if (GameSkill() == SKILL_HARD) StealthChance = StealthChance * 110 / 100;
  else if (GameSkill() == SKILL_VERY_HARD) StealthChance = StealthChance * 125 / 100;
  else StealthChance = StealthChance * 100 / 100;
  if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Skill]: ",d:StealthChance,s:" - ",s:GetActorClass(0));
 }
  
 if (GetCVar("dvds_rnd_stealth_maps") == 1) 
 { 
  if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
  {
   if (ClassicDoomType == 1 || ClassicDoomType == 2) // Doom 1 / Heretic
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[54];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1) MapCheck = 1;
    if (MapCheck > 50) MapCheck = 50;
 
    if (MapCheck >= 1 && MapCheck <= 10) G1 = (MapCheck * 30);
    if (MapCheck >= 11 && MapCheck <= 20) G1 = (MapCheck * 35);
    if (MapCheck >= 21 && MapCheck <= 30) G1 = (MapCheck * 40);
    if (MapCheck == 31) G1 = (MapCheck * 42);
    if (MapCheck == 32) G1 = (MapCheck * 44);
    if (MapCheck == 39) G1 = (MapCheck * 47);
    if (MapCheck == 40) G1 = (MapCheck * 47);
    if (MapCheck == 33) G1 = (MapCheck * 50);
    if (MapCheck == 34) G1 = (MapCheck * 54);
    if (MapCheck == 35) G1 = (MapCheck * 58);
    if (MapCheck == 36) G1 = (MapCheck * 63);
    if (MapCheck == 37) G1 = (MapCheck * 68);
    if (MapCheck == 38) G1 = (MapCheck * 75);
    if (MapCheck == 41) G1 = (MapCheck * 78);
    if (MapCheck == 42) G1 = (MapCheck * 81);
    if (MapCheck == 49) G1 = (MapCheck * 84);
    if (MapCheck == 50) G1 = (MapCheck * 87);
    if (MapCheck == 43) G1 = (MapCheck * 91);
    if (MapCheck == 44) G1 = (MapCheck * 95);
    if (MapCheck == 45) G1 = (MapCheck * 99);
    if (MapCheck == 46) G1 = (MapCheck * 104);
    if (MapCheck == 47) G1 = (MapCheck * 109);
    if (MapCheck == 48) G1 = (MapCheck * 115);
    if (MapCheck == 49) G1 = (MapCheck * 121);
    if (MapCheck == 50) G1 = (MapCheck * 127);
   }
   else // Doom / Hexen / Strife / Doom64
   {
    MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
    MapCheck += MiscellaneousVars[54];
    MapCheck += MiscellaneousVars[169];
    if (MapCheck < 1) MapCheck = 1;
    if (MapCheck > 50) MapCheck = 50;
 
    if (MapCheck >= 1 && MapCheck <= 5) G1 = (MapCheck * 30);
    if (MapCheck >= 6 && MapCheck <= 10) G1 = (MapCheck * 35);
    if (MapCheck >= 11 && MapCheck <= 15) G1 = (MapCheck * 40);
    if (MapCheck >= 16 && MapCheck <= 20) G1 = (MapCheck * 45);
    if (MapCheck >= 21 && MapCheck <= 25) G1 = (MapCheck * 55);
    if (MapCheck == 26) G1 = (MapCheck * 56);
    if (MapCheck == 27) G1 = (MapCheck * 58);
    if (MapCheck == 28) G1 = (MapCheck * 61);
    if (MapCheck == 29) G1 = (MapCheck * 65);
    if (MapCheck == 30) G1 = (MapCheck * 70);
    if (MapCheck == 31) G1 = (MapCheck * 45);
    if (MapCheck == 32) G1 = (MapCheck * 55);
    if (MapCheck == 33) G1 = (MapCheck * 72);
    if (MapCheck == 34) G1 = (MapCheck * 74);
    if (MapCheck == 35) G1 = (MapCheck * 76);
    if (MapCheck == 36) G1 = (MapCheck * 79);
    if (MapCheck == 37) G1 = (MapCheck * 82);
    if (MapCheck == 38) G1 = (MapCheck * 85);
    if (MapCheck == 39) G1 = (MapCheck * 88);
    if (MapCheck == 40) G1 = (MapCheck * 92);
    if (MapCheck == 41) G1 = (MapCheck * 96);
    if (MapCheck == 42) G1 = (MapCheck * 100);
    if (MapCheck == 43) G1 = (MapCheck * 104);
    if (MapCheck == 44) G1 = (MapCheck * 109);
    if (MapCheck == 45) G1 = (MapCheck * 114);
    if (MapCheck == 46) G1 = (MapCheck * 119);
    if (MapCheck == 47) G1 = (MapCheck * 125);
    if (MapCheck == 48) G1 = (MapCheck * 131);
    if (MapCheck == 49) G1 = (MapCheck * 137);
    if (MapCheck == 50) G1 = (MapCheck * 143); 
   }
   G1 += 1000;
   StealthChance = StealthChance * G1 / 1000;
   StealthChance = StealthChance * 5 / 8;
  }
  else if (ModType == 1) // DVI
  {
   MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
   MapCheck += MiscellaneousVars[54];
   MapCheck += MiscellaneousVars[169];
   if (MapCheck < 1101) MapCheck = 1101;
   if (MapCheck > 1104) MapCheck = 1104;

   if (MapCheck == 1101) StealthChance = StealthChance * 1000 / 1000; // MAP01 - Insurgents
   else if (MapCheck == 1102) StealthChance = StealthChance * 1116 / 1000; // MAP02 - Torture Chamber
   else if (MapCheck == 1103) StealthChance = StealthChance * 1256 / 1000; // MAP03 - Cathedral
   else if (MapCheck == 1104) StealthChance = StealthChance * 1418 / 1000; // MAP04 - End Of Days
   else StealthChance = StealthChance * 1000 / 1000; // Any other map
  }
  else
  if (ModType == 2) // DVII
  {
   MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
   MapCheck += MiscellaneousVars[54];
   MapCheck += MiscellaneousVars[169];
   if (MapCheck < 1201) MapCheck = 1201;
   if (MapCheck > 1212) MapCheck = 1212;
 
   if (MapCheck == 1201) StealthChance = StealthChance * 1000 / 1000; // MAP01 - Entryway Pass
   else if (MapCheck == 1202) StealthChance = StealthChance * 1070 / 1000; // MAP02 - Mutagen
   else if (MapCheck == 1203) StealthChance = StealthChance * 1140 / 1000; // MAP03 - Crouching Demon, Hidden Archvile
   else if (MapCheck == 1204) StealthChance = StealthChance * 1209 / 1000; // MAP04 - Minas Morgul
   else if (MapCheck == 1205) StealthChance = StealthChance * 1302 / 1000; // MAP05 - Eagle's Nest
   else if (MapCheck == 1206) StealthChance = StealthChance * 1395 / 1000; // MAP05B - The Manliest Level Ever
   else if (MapCheck == 1207) StealthChance = StealthChance * 1488 / 1000; // MAP06 - Stargate
   else if (MapCheck == 1208) StealthChance = StealthChance * 1605 / 1000; // MAP07 - The Desert Temple
   else if (MapCheck == 1209) StealthChance = StealthChance * 1953 / 1000; // MAP08 - The Unholy Cathedral
   else if (MapCheck == 1210) StealthChance = StealthChance * 2372 / 1000; // MAP09 - You Shall Not Pass!
   else if (MapCheck == 1211) StealthChance = StealthChance * 2884 / 1000; // MAP10 - Hell's Vendetta
   else if (MapCheck == 1212) StealthChance = StealthChance * 3488 / 1000; // MAP10B - attedneV s'lleH
   else if (MapCheck == 1214) StealthChance = StealthChance * 1465 / 1000; // MAP12 - "The Wings of The Maiar" [DVI combined level remake]
   else if (MapCheck == 1215) StealthChance = StealthChance * 3488 / 1000; // MAP10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
   else StealthChance = StealthChance * 1000 / 1000; // All other Maps
  }
  else StealthChance = StealthChance * 1000 / 1000;
  if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Maps]: ",d:StealthChance,s:" - ",s:GetActorClass(0));
 }

 // Check if the actor is one of Strife's Peasents [and if so, sets Stealth Chance to 0]
 int IsAPeasent = 0;
 If(CheckActorClass(0,"PeasantNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant1New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant2New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant3New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant4New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant5New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant6New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant7New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant8New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant9New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant10New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant11New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant12New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant13New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant14New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant15New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant16New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant17New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant18New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant19New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant20New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant21New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Peasant22New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"BeggarNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar1New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar2New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar3New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar4New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"Beggar5New") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"MerchantNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"WeaponSmithNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"BarKeepNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"ArmorerNew") == 1) IsAPeasent ++;
 If(CheckActorClass(0,"MedicNew") == 1) IsAPeasent ++;
 If(IsAPeasent > 0) StealthChance = 0;
 if(GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [PeasentCheck]: ",d:StealthChance,s:" - ",s:GetActorClass(0));

 if (GetCVar("dvdsdebug_stealthstuff") == 1) PrintBold(s:"Stealth Chance [Final]: ",d:StealthChance,s:" - ",s:GetActorClass(0));
 SetResultValue( StealthChance );
}

// Updates information on Stealth-ified Monsters
script "RefreshStealthInfo" (int type)
{
 if (type == 0) // nothing special
 {
  TakeInventory("IsAStealthMonsterRingAttacking", 1); 
  TakeInventory("IsAStealthMonster5000Attacking", 1); 
  TakeInventory("IsAStealthMonster7500Attacking", 1); 
  TakeInventory("IsAStealthMonster8750Attacking", 1); 
  TakeInventory("IsAStealthMonster9375Attacking", 1); 
  TakeInventory("IsAStealthMonsterRingAttackingNV", 1); 
  TakeInventory("IsAStealthMonster5000AttackingNV", 1); 
  TakeInventory("IsAStealthMonster7500AttackingNV", 1); 
  TakeInventory("IsAStealthMonster8750AttackingNV", 1); 
  TakeInventory("IsAStealthMonster9375AttackingNV", 1); 

  if (GetUserVariable(0, "user_isstealth") > 0)
  {
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) 
   {
    if (PowerupTimer[0] > 0)
    {
     GiveInventory("IsAStealthMonsterRingNV", 1);
     TakeInventory("IsAStealthMonster5000NV", 1); 
     TakeInventory("IsAStealthMonster7500NV", 1); 
     TakeInventory("IsAStealthMonster8750NV", 1); 
     TakeInventory("IsAStealthMonster9375NV", 1); 
     TakeInventory("IsAStealthMonsterRing", 1); 
     TakeInventory("IsAStealthMonster5000", 1); 
     TakeInventory("IsAStealthMonster7500", 1); 
     TakeInventory("IsAStealthMonster8750", 1); 
     TakeInventory("IsAStealthMonster9375", 1); 
    }
    else
    {
     GiveInventory("IsAStealthMonsterRing", 1);
     TakeInventory("IsAStealthMonster5000", 1); 
     TakeInventory("IsAStealthMonster7500", 1); 
     TakeInventory("IsAStealthMonster8750", 1); 
     TakeInventory("IsAStealthMonster9375", 1); 
     TakeInventory("IsAStealthMonsterRingNV", 1); 
     TakeInventory("IsAStealthMonster5000NV", 1); 
     TakeInventory("IsAStealthMonster7500NV", 1); 
     TakeInventory("IsAStealthMonster8750NV", 1); 
     TakeInventory("IsAStealthMonster9375NV", 1); 
    }
   }
   else
   {
    if (PowerupTimer[0] > 0)
    {
     TakeInventory("IsAStealthMonsterRingNV", 1); 
     TakeInventory("IsAStealthMonster5000", 1); 
     TakeInventory("IsAStealthMonster7500", 1); 
     TakeInventory("IsAStealthMonster8750", 1); 
     TakeInventory("IsAStealthMonster9375", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 0) GiveInventory("IsAStealthMonster5000NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 1) GiveInventory("IsAStealthMonster7500NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 2) GiveInventory("IsAStealthMonster8750NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 3) GiveInventory("IsAStealthMonster9375NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 0) TakeInventory("IsAStealthMonster5000NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 1) TakeInventory("IsAStealthMonster7500NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 2) TakeInventory("IsAStealthMonster8750NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 3) TakeInventory("IsAStealthMonster9375NV", 1); 
    }
    else
    {
     TakeInventory("IsAStealthMonsterRing", 1); 
     TakeInventory("IsAStealthMonster5000NV", 1); 
     TakeInventory("IsAStealthMonster7500NV", 1); 
     TakeInventory("IsAStealthMonster8750NV", 1); 
     TakeInventory("IsAStealthMonster9375NV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 0) GiveInventory("IsAStealthMonster5000", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 1) GiveInventory("IsAStealthMonster7500", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 2) GiveInventory("IsAStealthMonster8750", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 3) GiveInventory("IsAStealthMonster9375", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 0) TakeInventory("IsAStealthMonster5000", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 1) TakeInventory("IsAStealthMonster7500", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 2) TakeInventory("IsAStealthMonster8750", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 3) TakeInventory("IsAStealthMonster9375", 1); 
    }
   }   
   SetUserVariable(0, "user_isstealth", 1);
  }
  else
  {
   SetUserVariable(0, "user_isstealth", 0);
   TakeInventory("IsAStealthMonster5000", 1); 
   TakeInventory("IsAStealthMonster7500", 1); 
   TakeInventory("IsAStealthMonster8750", 1); 
   TakeInventory("IsAStealthMonster9375", 1); 
   TakeInventory("IsAStealthMonsterRing", 1);
   TakeInventory("IsAStealthMonster5000NV", 1); 
   TakeInventory("IsAStealthMonster7500NV", 1); 
   TakeInventory("IsAStealthMonster8750NV", 1); 
   TakeInventory("IsAStealthMonster9375NV", 1); 
   TakeInventory("IsAStealthMonsterRingNV", 1);
  }
 }


 if (type == 1) // attacking
 {
  TakeInventory("IsAStealthMonsterRing", 1); 
  TakeInventory("IsAStealthMonster5000", 1); 
  TakeInventory("IsAStealthMonster7500", 1); 
  TakeInventory("IsAStealthMonster8750", 1); 
  TakeInventory("IsAStealthMonster9375", 1); 
  TakeInventory("IsAStealthMonsterRingNV", 1); 
  TakeInventory("IsAStealthMonster5000NV", 1); 
  TakeInventory("IsAStealthMonster7500NV", 1); 
  TakeInventory("IsAStealthMonster8750NV", 1); 
  TakeInventory("IsAStealthMonster9375NV", 1); 

  if (GetUserVariable(0, "user_isstealth") > 0)
  {
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) 
   {
    if (PowerupTimer[0] > 0)
    {
     GiveInventory("IsAStealthMonsterRingAttackingNV", 1);
     TakeInventory("IsAStealthMonster5000AttackingNV", 1); 
     TakeInventory("IsAStealthMonster7500AttackingNV", 1); 
     TakeInventory("IsAStealthMonster8750AttackingNV", 1); 
     TakeInventory("IsAStealthMonster9375AttackingNV", 1); 
    }
    else
    {
     GiveInventory("IsAStealthMonsterRingAttacking", 1);
     TakeInventory("IsAStealthMonster5000Attacking", 1); 
     TakeInventory("IsAStealthMonster7500Attacking", 1); 
     TakeInventory("IsAStealthMonster8750Attacking", 1); 
     TakeInventory("IsAStealthMonster9375Attacking", 1); 
    }
   }
   else
   {
    if (PowerupTimer[0] > 0)
    {
     TakeInventory("IsAStealthMonsterRingAttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 0) GiveInventory("IsAStealthMonster5000AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 1) GiveInventory("IsAStealthMonster7500AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 2) GiveInventory("IsAStealthMonster8750AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 3) GiveInventory("IsAStealthMonster9375AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 0) TakeInventory("IsAStealthMonster5000AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 1) TakeInventory("IsAStealthMonster7500AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 2) TakeInventory("IsAStealthMonster8750AttackingNV", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 3) TakeInventory("IsAStealthMonster9375AttackingNV", 1); 
    }
    else
    {
     TakeInventory("IsAStealthMonsterRingAttacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 0) GiveInventory("IsAStealthMonster5000Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 1) GiveInventory("IsAStealthMonster7500Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 2) GiveInventory("IsAStealthMonster8750Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") == 3) GiveInventory("IsAStealthMonster9375Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 0) TakeInventory("IsAStealthMonster5000Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 1) TakeInventory("IsAStealthMonster7500Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 2) TakeInventory("IsAStealthMonster8750Attacking", 1); 
     if (GetCVar("dvds_rnd_stealthlevel") != 3) TakeInventory("IsAStealthMonster9375Attacking", 1); 
    }
   }   
   SetUserVariable(0, "user_isstealth", 1);
  }
  else
  {
   SetUserVariable(0, "user_isstealth", 0);
   TakeInventory("IsAStealthMonster5000Attacking", 1); 
   TakeInventory("IsAStealthMonster7500Attacking", 1); 
   TakeInventory("IsAStealthMonster8750Attacking", 1); 
   TakeInventory("IsAStealthMonster9375Attacking", 1); 
   TakeInventory("IsAStealthMonsterRingAttacking", 1);
   TakeInventory("IsAStealthMonster5000AttackingNV", 1); 
   TakeInventory("IsAStealthMonster7500AttackingNV", 1); 
   TakeInventory("IsAStealthMonster8750AttackingNV", 1); 
   TakeInventory("IsAStealthMonster9375AttackingNV", 1); 
   TakeInventory("IsAStealthMonsterRingAttackingNV", 1);
  }
 }
}

// Checks the gametype for spawns to determine various drops/monster spawns.
script "CheckModType" (void)
{
 SetResultValue(ModType);
}

// Runs the "Grabbed a Seed of Life/Magic" script
script "GrabLifeManaSeed" (int SeedType, int SeedAmount, int SeedLimitTypeIncrease)
{
 int SkillSeedRuns, SkillSeedRND, OldHP, NewHP, OldMP, NewMP, StatGain1, StatGain2, ArmorHPBonus, PerkFactor;

 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) terminate;

 if (SeedAmount < 1) SeedAmount = 1;

 if (SeedType < 1) SeedAmount = 1;
 if (SeedType > 2) SeedAmount = 2;

 OldHP = MaxHealthTrue;
 OldMP = MaxMana;

 if (SeedType == 1) // Seed of Life
 {
  StatGain1 = MaxHealthTrue / 80;
  if (CharacterClass == 0) StatGain1 += 4;
  if (CharacterClass == 1) StatGain1 += 2;
  if (CharacterClass == 2) StatGain1 += 1;
  if (CharacterClass == 8) StatGain1 += 1;
  if (CharacterClass == 9) StatGain1 += 4;
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Base]: ",d:StatGain1);

  SkillSeedRND = random(1,13);

  if (SkillSeedRND == 1) StatGain1 = StatGain1 * 1;
  if (SkillSeedRND >= 2 && SkillSeedRND <= 4) StatGain1 = StatGain1 * 3 / 2;
  if (SkillSeedRND >= 5 && SkillSeedRND <= 9) StatGain1 = StatGain1 * 2;
  if (SkillSeedRND >= 10 && SkillSeedRND <= 12) StatGain1 = StatGain1 * 5 / 2;
  if (SkillSeedRND == 13) StatGain1 = StatGain1 * 3;
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Randomizer1]: ",d:StatGain1);

  StatGain1 = StatGain1 * SeedAmount;
  StatGain1 = StatGain1 * MiscellaneousVars[87];
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Multipliers]: ",d:StatGain1);

  // Flora's Armor Items [up to +45% Max HP gained from Max HP Bonuses]
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"PearlyCorset")) ArmorHPBonus += 20; // +20%
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"KissaBra")) ArmorHPBonus += 10; // +10%
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"BalrogRing")) ArmorHPBonus += 15; // +25%
  ArmorHPBonus += 100;
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"ArmorHPBonus: ",d:ArmorHPBonus);
  StatGain1 = StatGain1 * ArmorHPBonus / 100; // Flora is the only one who can use the Pearly Corset
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [ArmorHPBonus]: ",d:StatGain1);

  PerkFactor = ((MiscellaneousVars[10001] * 500) + (MiscellaneousVars[10002] * 1250)) + 10000;
  StatGain1 = StatGain1 * PerkFactor / 10000; // "LifeUp" and "LifeUp EX" perks.
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [LifeUp Perks]: ",d:StatGain1);

  PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
  StatGain1 = StatGain1 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Stamina Upgrade (Strife)]: ",d:StatGain1);

  if (StatGain1 < 1) StatGain1 = 1;
  MiscellaneousVars[222] += StatGain1;
  MiscellaneousVars[2031] = 105; 

  StatGain2 = GetActorProperty(Player1TID,APROP_HEALTH);
  //GiveInventory("UpgradeStamina", StatGain1);
  SetActorProperty(Player1TID,APROP_HEALTH,(StatGain2+StatGain1));
  MaxHealthTrue += StatGain1;
  SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);
 }

 if (SeedType == 2) // Seed of Magic
 {
  StatGain1 = MaxMana / 80;
  if (CharacterClass == 0) StatGain1 += 1;
  if (CharacterClass == 1) StatGain1 += 2;
  if (CharacterClass == 2) StatGain1 += 4;
  if (CharacterClass == 8) StatGain1 += 4;
  if (CharacterClass == 9) StatGain1 += 2;
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Base]: ",d:StatGain1);

  SkillSeedRND = random(1,13);

  if (SkillSeedRND == 1) StatGain1 = StatGain1 * 1;
  if (SkillSeedRND >= 2 && SkillSeedRND <= 4) StatGain1 = StatGain1 * 3 / 2;
  if (SkillSeedRND >= 5 && SkillSeedRND <= 9) StatGain1 = StatGain1 * 2;
  if (SkillSeedRND >= 10 && SkillSeedRND <= 12) StatGain1 = StatGain1 * 5 / 2;
  if (SkillSeedRND == 13) StatGain1 = StatGain1 * 3;
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Randomizer1]: ",d:StatGain1);

  StatGain1 = StatGain1 * SeedAmount;
  StatGain1 = StatGain1 * MiscellaneousVars[87];
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Multipliers]: ",d:StatGain1);

  PerkFactor = ((MiscellaneousVars[10003] * 500) + (MiscellaneousVars[10004] * 1250)) + 10000;
  StatGain1 = StatGain1 * PerkFactor / 10000; // "MagiUp" and "MagiUp EX" perks.
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [LifeUp Perks]: ",d:StatGain1);

  PerkFactor = (MiscellaneousVars[317] * 1250) + 10000;
  StatGain1 = StatGain1 * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"
  if (GetCVar("dvdsdebug_showseedstuff") > 0) PrintBold(s:"StatGain1 [Stamina Upgrade (Strife)]: ",d:StatGain1);

  if (StatGain1 < 1) StatGain1 = 1;
  MiscellaneousVars[223] += StatGain1;
  MiscellaneousVars[2032] = 105; 

  MaxMana += StatGain1;
  CurrentMana += StatGain1;
 }

 NewHP = MaxHealthTrue;
 NewMP = MaxMana;

 if (SeedType == 1) 
 {
  PrintBold
  (
   s:"You've Found a Seed of Life!\n\n",
   s:"HP/Health: ",d:OldHP,s:" --> ",d:NewHP
  );
 }

 if (SeedType == 2) 
 {
  PrintBold
  (
   s:"You've Found a Seed of Magic!\n\n",
   s:"MP/Mana: ",d:OldMP,s:" --> ",d:NewMP
  );
 }

}

// Runs the "Grabbed a Seed of [Bleh]" script
script "GrabSeedOther" (int SeedType, int SeedAmount, int SeedLimitTypeIncrease)
{
 int SkillSeedRuns, MaxSkillSeedRuns, SkillSeedRND, OldAGL, NewAGL, OldDEF, NewDEF, OldDFT, NewDFT, OldSOR, NewSOR, OldSTR, NewSTR, OldTHE, NewTHE, OldAeonPts, NewAeonPts;
 int SeedMulti;
 
 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) terminate;

 if (SeedAmount < 1) SeedAmount = 1;

 // "0" is for non-dropped or map-placed seeds as to not impose a limit on those
 if (SeedLimitTypeIncrease == 1) MiscellaneousVars[30] += 1; // "1" is Normal Seeds
 if (SeedLimitTypeIncrease == 2) MiscellaneousVars[37] += 1; // "2" is Skill Seeds
 if (SeedLimitTypeIncrease == 3) MiscellaneousVars[27] += 1; // "3" is Fyggs


 if (SeedType < 0) SeedAmount = 0;
 if (SeedType > 7) SeedAmount = 0;

 OldAeonPts = MiscellaneousVars[25];
 OldAGL = MiscellaneousVars[31];
 OldDEF = MiscellaneousVars[32];
 OldDFT = MiscellaneousVars[33];
 OldSOR = MiscellaneousVars[34];
 OldSTR = MiscellaneousVars[35];
 OldTHE = MiscellaneousVars[36];

 SeedMulti = 1;
 if (random(1,25) == 25) { if (random(1,625) == 625) SeedMulti = 3; else SeedMulti = 2; }
 
 if (SeedType == 0) // Seed of Skill [special seed, 4+ AeonPts ]
 {
  SeedAmount = 4;
  SeedAmount *= MiscellaneousVars[87];
  SeedAmount *= MiscellaneousVars[86];
  MiscellaneousVars[25] += SeedAmount;
 }

 if (SeedType == 1) // Seed of Agility [Speed/Movement]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[31] < 512) MiscellaneousVars[31] += SeedAmount;
 }

 if (SeedType == 2) // Seed of Defense [Overall Resistance]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[32] < 512) MiscellaneousVars[32] += SeedAmount;
 }

 if (SeedType == 3) // Seed of Deftness [EXP Gain %]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[33] < 512) MiscellaneousVars[33] += SeedAmount;
 }

 if (SeedType == 4) // Seed of Sorcery [Magical Attack]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[34] < 512) MiscellaneousVars[34] += SeedAmount;
 }

 if (SeedType == 5) // Seed of Strength [Overall Attack]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[35] < 512) MiscellaneousVars[35] += SeedAmount;
 }

 if (SeedType == 6) // Seed of Therapeusis [Magical Resistance]
 {
  SeedAmount = SeedAmount * SeedMulti * MiscellaneousVars[87];
  if (MiscellaneousVars[36] < 512) MiscellaneousVars[36] += SeedAmount;
 }

 if (SeedType == 7) // Fygg (extremely rare) [all stats +16]
 {
  SeedAmount = 16;
  SeedAmount = SeedAmount * MiscellaneousVars[87];
  if (MiscellaneousVars[31] < 512) MiscellaneousVars[31] += SeedAmount;
  if (MiscellaneousVars[32] < 512) MiscellaneousVars[32] += SeedAmount;
  if (MiscellaneousVars[33] < 512) MiscellaneousVars[33] += SeedAmount;
  if (MiscellaneousVars[34] < 512) MiscellaneousVars[34] += SeedAmount;
  if (MiscellaneousVars[35] < 512) MiscellaneousVars[35] += SeedAmount;
  if (MiscellaneousVars[36] < 512) MiscellaneousVars[36] += SeedAmount;
 }

 if (SeedType == 8) // Platinum Fygg (extremely rare) [+16 to all stats & +64 Aeon Points]
 {
  SeedAmount = 64;
  SeedAmount *= MiscellaneousVars[87];
  SeedAmount *= MiscellaneousVars[86];
  MiscellaneousVars[25] += SeedAmount;

  SeedAmount = 16;
  SeedAmount = SeedAmount * MiscellaneousVars[87];
  if (MiscellaneousVars[31] < 512) MiscellaneousVars[31] += SeedAmount;
  if (MiscellaneousVars[32] < 512) MiscellaneousVars[32] += SeedAmount;
  if (MiscellaneousVars[33] < 512) MiscellaneousVars[33] += SeedAmount;
  if (MiscellaneousVars[34] < 512) MiscellaneousVars[34] += SeedAmount;
  if (MiscellaneousVars[35] < 512) MiscellaneousVars[35] += SeedAmount;
  if (MiscellaneousVars[36] < 512) MiscellaneousVars[36] += SeedAmount;
 }

 if (SeedType == 9) // Enhanced Seed of Skill [special seed, 16+ AeonPts ]
 {
  SeedAmount = 16;
  SeedAmount *= MiscellaneousVars[87];
  SeedAmount *= MiscellaneousVars[86];
  MiscellaneousVars[25] += SeedAmount;
 }

 if (MiscellaneousVars[31] > 512) MiscellaneousVars[31] = 512;
 if (MiscellaneousVars[32] > 512) MiscellaneousVars[32] = 512;
 if (MiscellaneousVars[33] > 512) MiscellaneousVars[33] = 512;
 if (MiscellaneousVars[34] > 512) MiscellaneousVars[34] = 512;
 if (MiscellaneousVars[35] > 512) MiscellaneousVars[35] = 512;
 if (MiscellaneousVars[36] > 512) MiscellaneousVars[36] = 512;
 NewAeonPts = MiscellaneousVars[25];
 NewAGL = MiscellaneousVars[31];
 NewDEF = MiscellaneousVars[32];
 NewDFT = MiscellaneousVars[33];
 NewSOR = MiscellaneousVars[34];
 NewSTR = MiscellaneousVars[35];
 NewTHE = MiscellaneousVars[36];

 if (NewAeonPts-OldAeonPts > 0)
 {
  MiscellaneousVars[224] += NewAeonPts - OldAeonPts; 
  MiscellaneousVars[2033] = 105; 
 }
 if (NewAGL-OldAGL > 0)
 {
  MiscellaneousVars[225] += NewAGL - OldAGL; 
  MiscellaneousVars[2034] = 105; 
 }
 if (NewDEF-OldDEF > 0)
 {
  MiscellaneousVars[226] += NewDEF - OldDEF; 
  MiscellaneousVars[2035] = 105; 
 }
 if (NewDFT-OldDFT > 0)
 {
  MiscellaneousVars[227] += NewDFT - OldDFT; 
  MiscellaneousVars[2036] = 105; 
 }
 if (NewSOR-OldSOR > 0)
 {
  MiscellaneousVars[228] += NewSOR - OldSOR; 
  MiscellaneousVars[2037] = 105; 
 }
 if (NewSTR-OldSTR > 0)
 {
  MiscellaneousVars[229] += NewSTR - OldSTR; 
  MiscellaneousVars[2038] = 105; 
 }
 if (NewTHE-OldTHE > 0)
 {
  MiscellaneousVars[230] += NewTHE - OldTHE; 
  MiscellaneousVars[2039] = 105; 
 }

 if (SeedType == 0) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Skill!\n\n",
   s:"AeonPts: ",d:OldAeonPts,s:" --> ",d:NewAeonPts
  );
 }

 if (SeedType == 1) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Agility!\n\n",
   s:"Agility: ",d:OldAGL,s:" --> ",d:NewAGL
  );
 }

 if (SeedType == 2) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Defense!\n\n",
   s:"Defense: ",d:OldDEF,s:" --> ",d:NewDEF
  );
 }

 if (SeedType == 3) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Deftness!\n\n",
   s:"Deftness: ",d:OldDFT,s:" --> ",d:NewDFT
  );
 }

 if (SeedType == 4) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Sorcery!\n\n",
   s:"Sorcery: ",d:OldSOR,s:" --> ",d:NewSOR
  );
 }

 if (SeedType == 5) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Strength!\n\n",
   s:"Strength: ",d:OldSTR,s:" --> ",d:NewSTR
  );
 }

 if (SeedType == 6) 
 {
  PrintBold
  (
   s:"You've Ate a Seed of Therapeusis!\n\n",
   s:"Therapeusis: ",d:OldTHE,s:" --> ",d:NewTHE
  );
 }

 if (SeedType == 7) 
 {
  PrintBold
  (
   s:"ZOMG You've Ate a Fygg!!!!\n\n",
   s:"Agility: ",d:OldAGL,s:" --> ",d:NewAGL,
   s:"\nDefense: ",d:OldDEF,s:" --> ",d:NewDEF,
   s:"\nDeftness: ",d:OldDFT,s:" --> ",d:NewDFT,
   s:"\nSorcery: ",d:OldSOR,s:" --> ",d:NewSOR,
   s:"\nStrength: ",d:OldSTR,s:" --> ",d:NewSTR,
   s:"\nTherapeusis: ",d:OldTHE,s:" --> ",d:NewTHE
  );
 }

 if (SeedType == 8) 
 {
  PrintBold
  (
   s:"ZOMG You've Ate a PLATNIUM Fygg!!!!\n\n",
   s:"AeonPts: ",d:OldAeonPts,s:" --> ",d:NewAeonPts,
   s:"\nAgility: ",d:OldAGL,s:" --> ",d:NewAGL,
   s:"\nDefense: ",d:OldDEF,s:" --> ",d:NewDEF,
   s:"\nDeftness: ",d:OldDFT,s:" --> ",d:NewDFT,
   s:"\nSorcery: ",d:OldSOR,s:" --> ",d:NewSOR,
   s:"\nStrength: ",d:OldSTR,s:" --> ",d:NewSTR,
   s:"\nTherapeusis: ",d:OldTHE,s:" --> ",d:NewTHE
  );
 }

 if (SeedType == 9) 
 {
  PrintBold
  (
   s:"You've Ate an Enhanced Seed of Skill!\n\n",
   s:"AeonPts: ",d:OldAeonPts,s:" --> ",d:NewAeonPts
  );
 }

}

//
script "CalculateSpellBaseAngles" (void)
{
 int value;

 value = -1*((GetActorPitch(Player1TID)) / 136);
 // if (value > 64) value = 64;
 // if (value < -63) value = -63;
 // value = -1*((GetActorPitch(Player1TID)) >> 8);
 // value = -1*((GetActorPitch(Player1TID)) * 64 >> 16);
 // Print(d:value); 
 SetResultValue(value);
}

// Checks to Remove Seeds on the Map if too many have been picked up already.
script "SeedLimitChecker" (int SeedType)
{
 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) Thing_Remove(0);
 if (SeedType == 0 && MiscellaneousVars[37] >= MiscellaneousVars[28]) Thing_Remove(0); // Seed of Skill
 if (SeedType == 1 && MiscellaneousVars[30] >= MiscellaneousVars[29]) Thing_Remove(0); // Seed of Agility/Defense/Deftness/Sorcery/Strength/Therapeusis
 if (SeedType == 2 && MiscellaneousVars[27] >= MiscellaneousVars[26]) Thing_Remove(0); // Fygg Fruit
 // SeedType == 3 is a 'blank' type for other Seed type items that aren't covered above, so it will run the script checker
}

// Checks Seed amounts and will randomize dropped seeds.
script "SeedDrop" (int type, int OldRand0, int Forced)
{
 int Rand0, Rand1, Rand2, PX, PY, PZ, FullOnSkill, FullOnSeeds, spawnedaitem, SeedDropChance;

 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) terminate;

 if (ActivatorTID() == 0) Thing_ChangeTID(0,1537);
 PX = GetActorX(1537);
 PY = GetActorY(1537);
 PZ = GetActorZ(1537);
 
 if (Forced == 0)
 {
  if (MiscellaneousVars[37] >= MiscellaneousVars[28]) FullOnSkill = 1;
  if (MiscellaneousVars[30] >= MiscellaneousVars[29]) FullOnSeeds = 1;
 }

 // Spawn Occurance Rate
 if (type == 2)
 {
  Rand0 = 1;
 }
 else
 if (type == 1)
 {
  Rand0 = OldRand0;
 }
 else
 {
  if (MiscellaneousVars[27] < MiscellaneousVars[26])
  {
   // "MiscellaneousVars[6]" is a randomly picked ID number that DV-DS will pick at the Very-First-Run, from (1 to "MiscellaneousVars[7]")
   if (random(1,MiscellaneousVars[7]) == MiscellaneousVars[6])
   {
    if (Forced == 1) SpawnForced("FyggForced",PX,PY,PZ,0,0); else SpawnForced("Fygg",PX,PY,PZ,0,0); 
    Thing_Remove(1537);
    terminate;
   }
  }

  if (GameSkill() == SKILL_VERY_EASY) Rand0 = random(1,70); // 92
  if (GameSkill() == SKILL_EASY) Rand0 = random(1,80); // 104
  if (GameSkill() == SKILL_NORMAL) Rand0 = random(1,90); // 116
  if (GameSkill() == SKILL_HARD) Rand0 = random(1,100); // 128
  if (GameSkill() == SKILL_VERY_HARD) Rand0 = random(1,120); // 152 
  Rand0 = Rand0 * 5 / 2;
 }

 SeedDropChance = 1 + (MiscellaneousVars[33] / 32);

 while (spawnedaitem == 0)
 {
  if (Rand0 <= SeedDropChance)
  {
   if (FullOnSkill == 1)
   {
    if (FullOnSeeds == 1) Rand1 = random(31,40);
    else Rand1 = random(1,40);
   }
   else
   {
    if (FullOnSeeds == 1) Rand1 = random(31,41);
    else Rand1 = random(1,41);
   }

   if (Rand1 > 0 && Rand1 < 6) // Seed of Agility
   {
    if (Forced == 1) SpawnForced("SeedOfAgilityForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfAgility",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 5 && Rand1 < 11) // Seed of Defense
   {
    if (Forced == 1) SpawnForced("SeedOfDefenseForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfDefense",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 10 && Rand1 < 16) // Seed of Deftness
   {
    if (Forced == 1) SpawnForced("SeedOfDeftnessForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfDeftness",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 15 && Rand1 < 21) // Seed of Sorcery
   {
    if (Forced == 1) SpawnForced("SeedOfSorceryForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfSorcery",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 20 && Rand1 < 26)// Seed of Strength
   {
    if (Forced == 1) SpawnForced("SeedOfStrengthForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfStrength",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 25 && Rand1 < 31) // Seed of Therapeusis
   {
    if (Forced == 1) SpawnForced("SeedOfTherapeusisForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfTherapeusis",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 30 && Rand1 < 36) // Seed of Life
   {
    SpawnForced("SeedOfLife",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 > 35 && Rand1 < 41) // Seed of Magic
   {
    SpawnForced("SeedOfMagic",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
   if (Rand1 == 41) // Seed of Skill
   {
    if (Forced == 1) SpawnForced("SeedOfSkillForced",PX,PY,PZ,0,0); else SpawnForced("SeedOfSkill",PX,PY,PZ,0,0);
    spawnedaitem++;
    Thing_Remove(1537);
    terminate;
   }
 
  }
  else // No spawn
  {
   Thing_Remove(1537);
   terminate;
  }
 }

}

// Overall Aeon Point Handling 
script "AeonPointKey" (int type) 
{
 int AeonIncrease = 1;
 int AeonPtChecker = 1;
 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 if (MiscellaneousVars[31] > 511 && MiscellaneousVars[32] > 511 && MiscellaneousVars[33] > 511 && MiscellaneousVars[34] > 511 && MiscellaneousVars[35] > 511 && MiscellaneousVars[36] > 511) terminate;

 // Move Aeon Point Cursor DOWN
 if (type == 0)
 {
  if (MiscellaneousVars[25] > 0 && PlayerLevel >= MiscellaneousVars[197])
  {
   MiscellaneousVars[24] += 1;
   if (MiscellaneousVars[24] > 6) MiscellaneousVars[24] = 1;
  }
  else
  {
   if (MiscellaneousVars[24] != 0) MiscellaneousVars[24] = 0;
  }
 }

 // Move Aeon Point Cursor UP
 if (type == 1)
 {
  if (MiscellaneousVars[25] > 0 && PlayerLevel >= MiscellaneousVars[197])
  {
   MiscellaneousVars[24] -= 1;
   if (MiscellaneousVars[24] < 1) MiscellaneousVars[24] = 6;
  }
  else
  {
   if (MiscellaneousVars[24] != 0) MiscellaneousVars[24] = 0;
  }
 }

 // Use an Aeon Point
 if (type == 2)
 {
  AeonPtChecker = 1;
  if (buttons & BT_SPEED) AeonPtChecker *= 10;
  if (buttons & BT_ZOOM) AeonPtChecker *= 5;
  if (buttons & BT_RELOAD) AeonPtChecker *= 2;
  AeonIncrease *= AeonPtChecker;
 
  if (MiscellaneousVars[25] >= AeonPtChecker && PlayerLevel >= MiscellaneousVars[197])
  {
   if (MiscellaneousVars[24] == 1) { if (MiscellaneousVars[31] < 512) { MiscellaneousVars[31] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Agility
   if (MiscellaneousVars[24] == 2) { if (MiscellaneousVars[32] < 512) { MiscellaneousVars[32] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Defense
   if (MiscellaneousVars[24] == 3) { if (MiscellaneousVars[33] < 512) { MiscellaneousVars[33] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Deftness
   if (MiscellaneousVars[24] == 4) { if (MiscellaneousVars[34] < 512) { MiscellaneousVars[34] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Sorcery
   if (MiscellaneousVars[24] == 5) { if (MiscellaneousVars[35] < 512) { MiscellaneousVars[35] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Strength
   if (MiscellaneousVars[24] == 6) { if (MiscellaneousVars[36] < 512) { MiscellaneousVars[36] += AeonIncrease; MiscellaneousVars[25] -= AeonPtChecker; } else MiscellaneousVars[24] = 0; } // Therapeusis
 
   if (PlayerLevel < MiscellaneousVars[197]) MiscellaneousVars[24] = 0;
   if (MiscellaneousVars[25] < AeonPtChecker) MiscellaneousVars[24] = 0;
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }
}

// Sceptre Twirl Mana/MP Check [to "balance" sceptre alt-fire cheapness >.>]
script "SceptreTwirlManaCheck" (int attacktype) 
{
 int C1, C2, C3;
 // "16" is the sceptre timer for mana consumption
 // "17" is the sceptre timer limit for mana consumption
 MiscellaneousVars[17] = 10;
 if (SceptreActualLevel == 0) MiscellaneousVars[17] = 10;
 if (SceptreActualLevel == 1) MiscellaneousVars[17] = 10;
 if (SceptreActualLevel == 2) MiscellaneousVars[17] = 11;
 if (SceptreActualLevel == 3) MiscellaneousVars[17] = 11;
 if (SceptreActualLevel == 4) MiscellaneousVars[17] = 12;
 if (SceptreActualLevel == 5) MiscellaneousVars[17] = 12;
 if (SceptreActualLevel == 6) MiscellaneousVars[17] = 13;
 if (SceptreActualLevel == 7) MiscellaneousVars[17] = 14;
 if (SceptreActualLevel == 8) MiscellaneousVars[17] = 14;
 if (SceptreActualLevel == 9) MiscellaneousVars[17] = 15;
 if (SceptreActualLevel == 10) MiscellaneousVars[17] = 16;
 if (SceptreActualLevel == 11) MiscellaneousVars[17] = 16;
 if (SceptreActualLevel == 12) MiscellaneousVars[17] = 17;
 if (SceptreActualLevel == 13) MiscellaneousVars[17] = 18;
 if (SceptreActualLevel == 14) MiscellaneousVars[17] = 19;
 if (SceptreActualLevel == 15) MiscellaneousVars[17] = 20;
 if (SceptreActualLevel == 16) MiscellaneousVars[17] = 22;

 //Print(d:attacktype);
 if (attacktype == 1)
 {
  if (SceptreActualLevel <= 4 && CurrentMana >= 5) { CurrentMana -= 5; C2++; }
  if (SceptreActualLevel > 4 && SceptreActualLevel <= 8 && CurrentMana >= 4 ) { CurrentMana -= 4; C2++; }
  if (SceptreActualLevel > 8 && SceptreActualLevel <= 12 && CurrentMana >= 3 ) { CurrentMana -= 3; C2++; }
  if (SceptreActualLevel > 12 && SceptreActualLevel <= 16 && CurrentMana >= 2 ) { CurrentMana -= 2; C2++; }
  if (SceptreActualLevel == 16 && CurrentMana >= 1) { CurrentMana -= 1; C2++; }
  if (CurrentMana < 0) CurrentMana = 0;
  MiscellaneousVars[243] = CurrentMana;
  MiscellaneousVars[238] = CurrentMana;
 }
 else
 {
  if (CurrentMana > 0) C2++;
  if (random(1,16) == 1) MiscellaneousVars[16] += 2; else MiscellaneousVars[16] += 1;
  //Print(d:MiscellaneousVars[16]);
  if (MiscellaneousVars[16] >= MiscellaneousVars[17])
  {
   C3 = random(1,2);
   if (SceptreActualLevel < 8 ) CurrentMana -= 2;
   if (SceptreActualLevel > 8 && SceptreActualLevel < 16) CurrentMana -= C3; C2++;
   if (SceptreActualLevel == 16) CurrentMana -= 1; C2++;
   if (CurrentMana < 0) CurrentMana = 0;
   MiscellaneousVars[16] -= MiscellaneousVars[17];
   MiscellaneousVars[243] = CurrentMana;
   MiscellaneousVars[238] = CurrentMana;
  }
 }

 //Print(d:C2);
 if (C2 > 0)
 {
  SetResultValue(1);
 }
 else 
 {
  MiscellaneousVars[16] = 0;
  SetResultValue(0); 
 }
}

// For Increasing the Strength Level of a Hellcore-type weapon when picking it up
script "IncreaseHellcoreLevel" (int HellcoreWeapon)
{
 if (HellcoreWeapon == 1) MiscellaneousVars[96] += 1;
 if (MiscellaneousVars[96] > 8) MiscellaneousVars[96] = 8;

 if (HellcoreWeapon == 2) MiscellaneousVars[97] += 1;
 if (MiscellaneousVars[97] > 8) MiscellaneousVars[97] = 8;

 if (HellcoreWeapon == 3) MiscellaneousVars[98] += 1;
 if (MiscellaneousVars[98] > 8) MiscellaneousVars[98] = 8;

 if (HellcoreWeapon == 4) MiscellaneousVars[99] += 1;
 if (MiscellaneousVars[99] > 8) MiscellaneousVars[99] = 8;

 if (HellcoreWeapon == 5) MiscellaneousVars[100] += 1;
 if (MiscellaneousVars[100] > 8) MiscellaneousVars[100] = 8;

 if (HellcoreWeapon == 6) MiscellaneousVars[101] += 1;
 if (MiscellaneousVars[101] > 8) MiscellaneousVars[101] = 8;

 if (HellcoreWeapon == 7) MiscellaneousVars[102] += 1;
 if (MiscellaneousVars[102] > 8) MiscellaneousVars[102] = 8;

 if (HellcoreWeapon == 8) MiscellaneousVars[103] += 1;
 if (MiscellaneousVars[103] > 8) MiscellaneousVars[103] = 8;

 if (HellcoreWeapon == 9) MiscellaneousVars[104] += 1;
 if (MiscellaneousVars[104] > 8) MiscellaneousVars[104] = 8;

 if (HellcoreWeapon == 10) MiscellaneousVars[105] += 1;
 if (MiscellaneousVars[105] > 8) MiscellaneousVars[105] = 8;

 if (HellcoreWeapon == 11) MiscellaneousVars[106] += 1;
 if (MiscellaneousVars[106] > 8) MiscellaneousVars[106] = 8;

 if (HellcoreWeapon == 12) MiscellaneousVars[107] += 1;
 if (MiscellaneousVars[107] > 8) MiscellaneousVars[107] = 8;

 if (HellcoreWeapon == 13) MiscellaneousVars[108] += 1;
 if (MiscellaneousVars[108] > 8) MiscellaneousVars[108] = 8;

 if (HellcoreWeapon == 14) MiscellaneousVars[109] += 1;
 if (MiscellaneousVars[109] > 8) MiscellaneousVars[109] = 8;

 if (HellcoreWeapon == 15) MiscellaneousVars[110] += 1;
 if (MiscellaneousVars[110] > 8) MiscellaneousVars[110] = 8;

 if (HellcoreWeapon == 16) MiscellaneousVars[111] += 1;
 if (MiscellaneousVars[111] > 8) MiscellaneousVars[111] = 8;

 if (HellcoreWeapon == 17) MiscellaneousVars[112] += 1;
 if (MiscellaneousVars[112] > 8) MiscellaneousVars[112] = 8;
}

script "CheckAChristinaCheck" (void)
{
 int buttons = GetPlayerInput(0, INPUT_BUTTONS);
 SetResultValue(0); //Always set to this initially!
 if (buttons & BT_RELOAD) //Allow A. Christina's ammo to continue refilling by holding the button
 {
	SetResultValue(3);
 }
 
 if (buttons & BT_ZOOM) //A. Christina weapons fire mode
 {
  if (GetActorVelZ(Player1TID) < 0) //LGA Dodge can activate when Zoom key is pressed and on the ground
  {
	SetResultValue(2); //LGA Dodge can be used
  }
  else
  {
	SetResultValue(1); //Bouncing Beams and Heel Kick are only allowed when airborne
  }
 }
}

// Check if to perform Sceptre's downswing alternate attack while falling or it's spinning alternate while grounded.
script "CheckSceptreAltFire" (void)
{
 if (MiscellaneousVars[2500] != 0) terminate;
 if (PowerupTimer[20] > 0) terminate;
 int buttons = GetPlayerInput(0, INPUT_BUTTONS);

 //PrintBold(d:GetActorVelZ(Player1TID));
 if (GetActorVelZ(Player1TID) < 0)
 {
  if (buttons & BT_JUMP && PlayerLevel >= 13 && SceptreActualLevel >= 4)
  {
   SetResultValue(1);
  }
  else
  {
   if (buttons & BT_MOVELEFT && buttons & BT_MOVERIGHT && MiscellaneousVars[244] > 0)
   {
    SetResultValue(2);
   }
   else
   {
    SetResultValue(0);
   }
  }
 }
 else
 {
  if (buttons & BT_MOVELEFT && buttons & BT_MOVERIGHT && MiscellaneousVars[244] > 0)
  {
   SetResultValue(2);
  }
  else
  {
   SetResultValue(0);
  }
 }
}

// Returns Sceptre Damage [including w/ berserk/other amplication items]
script "GetSceptreDamage" (int attacktype, int attacklevel, int shockwave)
{
 int damage;
 int strengthcounter;
 int sceptrestrbase;
 int sceptrestrmin;
 int sceptrestrmax;
 int PerkFactor;

 SetActivator(Player1TID);
 str weapon = GetWeapon();
 SetActivator(0);

 if (SceptreActualLevel <= 0) damage = random(275,325); // Base Damage Range
 if (SceptreActualLevel == 1) damage = random(280,330); // +5 Damage Range
 if (SceptreActualLevel == 2) damage = random(290,340); // +10 Damage Range
 if (SceptreActualLevel == 3) damage = random(320,370); // +30 Damage Range
 if (SceptreActualLevel == 4) damage = random(340,390); // +20 Damage Range
 if (SceptreActualLevel == 5) damage = random(365,415); // +25 Damage Range
 if (SceptreActualLevel == 6) damage = random(425,475); // +60 Damage Range
 if (SceptreActualLevel == 7) damage = random(425,475); // +0 Damage Range
 if (SceptreActualLevel == 8) damage = random(545,595); // +120 Damage Range
 if (SceptreActualLevel == 9) damage = random(590,640); // +45 Damage Range
 if (SceptreActualLevel == 10) damage = random(640,690); // +50 Damage Range
 if (SceptreActualLevel == 11) damage = random(750,800); // +110 Damage Range
 if (SceptreActualLevel == 12) damage = random(810,860); // +60 Damage Range
 if (SceptreActualLevel == 13) damage = random(875,925); // +65 Damage Range
 if (SceptreActualLevel == 14) damage = random(1015,1065); // +140 Damage Range
 if (SceptreActualLevel == 15) damage = random(1015,1065); // +0 Damage Range
 if (SceptreActualLevel >= 16) damage = random(1255,1305); // +240 Damage Range
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BaseDmg: ",d:damage); }

 // [STRIFE] Stamina Upgrades
 damage = (damage * (4 + MiscellaneousVars[317]) / 4);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StaminaDmg: ",d:damage,s:" StamUpgrades: ",d:MiscellaneousVars[317]); }

 // Strength Stat Check
 for (strengthcounter = 0; strengthcounter < MiscellaneousVars[35]; strengthcounter++)
 {
  sceptrestrbase = ((SceptreActualLevel * (4 + (MiscellaneousVars[35] / 32))) + (16 + (SceptreActualLevel * (2 + (MiscellaneousVars[35] / 64)))));
  sceptrestrmin = sceptrestrbase - (16 + (SceptreActualLevel * (2 + (MiscellaneousVars[35] / 64))));
  sceptrestrmax = sceptrestrbase + (16 + (SceptreActualLevel * (2 + (MiscellaneousVars[35] / 64)))); 

  if (GetCVar("dvdsdebug_showmeleeinformation") > 0)
  {
   PrintBold(s:"StrBase: ",d:sceptrestrbase,
             s:"\nStrMin: ",d:sceptrestrmin,
             s:"\nStrMax: ",d:sceptrestrmax);
  }

  damage += random(sceptrestrmin,sceptrestrmax);
 }

 if (attacktype == 1) damage = damage * 5 / 2; // If performing the Aireal Attack
 if (attacktype == 2)
 {
  if (attacklevel < 0)
  {
   if (SceptreActualLevel <= 0) attacklevel = 0;
   if (SceptreActualLevel == 1) attacklevel = 0;
   if (SceptreActualLevel == 2) attacklevel = 0;
   if (SceptreActualLevel == 3) attacklevel = 0;
   if (SceptreActualLevel == 4) attacklevel = 0;
   if (SceptreActualLevel == 5) attacklevel = 1;
   if (SceptreActualLevel == 6) attacklevel = 1;
   if (SceptreActualLevel == 7) attacklevel = 1;
   if (SceptreActualLevel == 8) attacklevel = 1;
   if (SceptreActualLevel == 9) attacklevel = 1;
   if (SceptreActualLevel == 10) attacklevel = 2;
   if (SceptreActualLevel == 11) attacklevel = 2;
   if (SceptreActualLevel == 12) attacklevel = 2;
   if (SceptreActualLevel == 13) attacklevel = 2;
   if (SceptreActualLevel == 14) attacklevel = 2;
   if (SceptreActualLevel == 15) attacklevel = 3;
   if (SceptreActualLevel >= 16) attacklevel = 3;
  }

  if (attacklevel == 0) damage = damage / 2; // If performing the Spinning Attack [50%]
  else if (attacklevel == 1) damage = damage * 3 / 4; // If performing the Spinning Attack [75%]
  else if (attacklevel == 2) damage = damage * 7 / 8; // If performing the Spinning Attack [87.5%]
  else if (attacklevel == 3) damage = damage * 15 / 16; // If performing the Spinning Attack [93.25%]

  damage = damage / 4;
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BaseDmg: ",d:damage); }

 // Berserk Check
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) damage = damage * 10;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"Berserk: ",d:damage); }

 if (shockwave == 1) damage = damage / 6;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"ShockWave: (",s:weapon,s:") ",d:damage);

 // StamUp Check
 if (MiscellaneousVars[10005] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10005] * 30) + (MiscellaneousVars[10006] * 75)) + 400;
  damage = damage * PerkFactor / 400;
 }

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage);
 SetResultValue(damage);
}

// Returns Sigil Damage
script "GetSigilDamage" (int attacktype, int radiustype)
{
 // MiscellaneousVars[31] = Agility
 // MiscellaneousVars[32] = Defense
 // MiscellaneousVars[33] = Deftness
 // MiscellaneousVars[34] = Sorcery
 // MiscellaneousVars[35] = Strength
 // MiscellaneousVars[36] = Therapeusis
 // MiscellaneousVars[298] = Initial Max HP [at the start of the game] [for Strife mode to help calculate extra Sigil damage]
 int damage, extradmg1, extradmg2, extradmg3, extradmg4, extradmg5, extradmg6, finaldmg;
 int rand1, rand2;
 int perkfactor = 10000;

 // SpectralLightningBaseNew's A_Explode [this affects the explosive-damage/radius of most Sigil attacks]
 if (attacktype == 0)
 {
  if (radiustype == 0) // Damage Calculation
  {
   damage = 32;
   extradmg1 = (MiscellaneousVars[32] * 4) / 1;		// 400% of Defense		[1 pt[s] = 4 more unit[s] of damage]
   extradmg2 = (MiscellaneousVars[33] * 3) / 8;		// 37.5% of Deftness	[8 pt[s] = 3 more unit[s] of damage]
   extradmg3 = (MiscellaneousVars[34] * 7) / 4;		// 150% of Sorcery		[4 pt[s] = 6 more unit[s] of damage]
  }
  else // Radius Calculation
  {
   damage = 32; 
   extradmg1 = (MiscellaneousVars[32] * 2) / 1;		// 200% of Defense		[1 pt[s] = 2 more unit[s] of radius]
   extradmg2 = (MiscellaneousVars[33] * 3) / 16;	// 18.75% of Deftness	[16 pt[s] = 3 more unit[s] of radius]
   extradmg3 = (MiscellaneousVars[34] * 3) / 4;		// 75% of Sorcery		[4 pt[s] = 3 more unit[s] of radius]
  }
 }
 // SpectralLightningBall1New
 if (attacktype == 1)
 {
  damage = 175 + random(-87,87); // 88 to 242
  extradmg1 = (MiscellaneousVars[32] * 21) / 4;		// 525% of Defense		[4 pt[s] = 21 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 21) / 32;	// 65.625% of Deftness	[32 pt[s] = 21 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 63) / 16;	// 393.75% of Sorcery	[16 pt[s] = 63 more unit[s] of damage]
 }
 // SpectralLightningBall2New
 if (attacktype == 2)
 {
  damage = 50 + random(-25,25); // 25 to 75
  extradmg1 = (MiscellaneousVars[32] * 9) / 6;		// 150% of Defense		[6 pt[s] = 9 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 9) / 48;		// 18.75% of Deftness	[48 pt[s] = 9 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 27) / 24;	// 112.5% of Sorcery	[24 pt[s] = 27 more unit[s] of damage]
 }
 // SpectralLightningV1New
 if (attacktype == 3)
 {
  damage = 300 + random(-150,150); // 150 to 450
  extradmg1 = (MiscellaneousVars[32] * 9) / 1;		// 900% of Defense		[1 pt[s] = 9 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 9) / 8;		// 112.5% of Deftness	[8 pt[s] = 9 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 27) / 4;		// 675% of Sorcery		[4 pt[s] = 27 more unit[s] of damage]
 }
 // SpectralLightningV2New
 if (attacktype == 4)
 {
  damage = 150 + random(-75,75); // 75 to 225
  extradmg1 = (MiscellaneousVars[32] * 9) / 2;		// 450% of Defense		[2 pt[s] = 9 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 9) / 16;		// 56.25% of Deftness	[16 pt[s] = 9 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 27) / 8;		// 337.5% of Sorcery	[8 pt[s] = 27 more unit[s] of damage]
 }
 // SpectralLightningH1New
 if (attacktype == 5)
 {
  damage = 175 + random(-87,87); // 88 to 242
  extradmg1 = (MiscellaneousVars[32] * 21) / 4;		// 525% of Defense		[4 pt[s] = 21 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 21) / 32;	// 65.625% of Deftness	[32 pt[s] = 21 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 63) / 16;	// 393.75% of Sorcery	[16 pt[s] = 63 more unit[s] of damage]
 }
 // SpectralLightningH2New
 if (attacktype == 6)
 {
  damage = 50 + random(-25,25); // 25 to 75
  extradmg1 = (MiscellaneousVars[32] * 9) / 6;		// 150% of Defense		[6 pt[s] = 9 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 9) / 48;		// 18.75% of Deftness	[48 pt[s] = 9 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 27) / 24;	// 112.5% of Sorcery	[24 pt[s] = 27 more unit[s] of damage]
 }
 // SpectralLightningH3New
 if (attacktype == 7)
 {
  damage = 25 + random(-12,12); // 13 to 37
  extradmg1 = (MiscellaneousVars[32] * 9) / 12;		// 75% of Defense		[12 pt[s] = 9 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 9) / 96;		// 9.375% of Deftness	[96 pt[s] = 9 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 27) / 48;	// 56.25% of Sorcery	[48 pt[s] = 27 more unit[s] of damage]
 }

 // SpectralLightningBigBall1New
 if (attacktype == 8)
 {
  damage = 325 + random(-162,162); // 163 to 387
  extradmg1 = (MiscellaneousVars[32] * 10) / 1;		// 1000% of Defense		[1 pt[s] = 10 more unit[s] of damage]
  extradmg2 = (MiscellaneousVars[33] * 10) / 8;		// 125% of Deftness	[8 pt[s] = 210 more unit[s] of damage]
  extradmg3 = (MiscellaneousVars[34] * 30) / 4;		// 750% of Sorcery		[4 pt[s] = 30 more unit[s] of damage]
 }

 // Final Calculations
 if (radiustype == 0) // Direct Damage is randomized
 {
  if (IsPointerEqual(AAPTR_TARGET, AAPTR_PLAYER1) == TRUE) // AAPTR_TARGET - the being who fires the shot
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Player Sigil Shot");
   rand1 = (extradmg1 + extradmg2 + extradmg3 + extradmg4 + extradmg5 + extradmg6) * 7 / 10;
   rand2 = (extradmg1 + extradmg2 + extradmg3 + extradmg4 + extradmg5 + extradmg6) * 13 / 10;
   finaldmg = damage + random(rand1,rand2);
   
   if (MiscellaneousVars[317] == 1) finaldmg = finaldmg * 45 / 40; // +12.5% damage
   if (MiscellaneousVars[317] == 2) finaldmg = finaldmg * 51 / 40; // +27.5% damage
   if (MiscellaneousVars[317] == 3) finaldmg = finaldmg * 58 / 40; // +45% damage
   if (MiscellaneousVars[317] == 4) finaldmg = finaldmg * 66 / 40; // +65% damage
   if (MiscellaneousVars[317] == 5) finaldmg = finaldmg * 75 / 40; // +87.5% damage
   if (MiscellaneousVars[317] == 6) finaldmg = finaldmg * 85 / 40; // +112.5% damage
   if (MiscellaneousVars[317] == 7) finaldmg = finaldmg * 96 / 40; // +140% damage
   if (MiscellaneousVars[317] == 8) finaldmg = finaldmg * 108 / 40; // +170% damage
   if (MiscellaneousVars[317] == 9) finaldmg = finaldmg * 121 / 40; // +202.5% damage
   if (MiscellaneousVars[317] == 10) finaldmg = finaldmg * 135 / 40; // +237.5% damage

   if (MiscellaneousVars[318] == 1) finaldmg = finaldmg * 85 / 80; // +6.25% damage
   if (MiscellaneousVars[318] == 2) finaldmg = finaldmg * 91 / 80; // +13.75% damage
   if (MiscellaneousVars[318] == 3) finaldmg = finaldmg * 98 / 80; // +22.5% damage
   if (MiscellaneousVars[318] == 4) finaldmg = finaldmg * 106 / 80; // +32.5% damage
   if (MiscellaneousVars[318] == 5) finaldmg = finaldmg * 115 / 80; // +43.75% damage
   if (MiscellaneousVars[318] == 6) finaldmg = finaldmg * 125 / 80; // +56.25% damage
   if (MiscellaneousVars[318] == 7) finaldmg = finaldmg * 136 / 80; // +70% damage
   if (MiscellaneousVars[318] == 8) finaldmg = finaldmg * 148 / 80; // +85% damage
   if (MiscellaneousVars[318] == 9) finaldmg = finaldmg * 161 / 80; // +101.25% damage
   if (MiscellaneousVars[318] == 10) finaldmg = finaldmg * 175 / 80; // +118.75% damage

   int prefinaldmg = finaldmg;
   int hpextradmg = 100;
   int hpextradmgfactor = (MaxHealthTrue * 100);
   int hpextradmg2 = (hpextradmgfactor / MiscellaneousVars[298]) / 5;
   int hpextradmg3 = (hpextradmg + hpextradmg2);
   finaldmg = (finaldmg * hpextradmg3) / 100;

   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
   {
    PrintBold(s:"Base: ",d:damage,
              s:"\nExtra1: ",d:extradmg1,
              s:"\nExtra2: ",d:extradmg2,
              s:"\nExtra3: ",d:extradmg3,
              s:"\nExtra4: ",d:extradmg4,
              s:"\nExtra5: ",d:extradmg5,
              s:"\nExtra6: ",d:extradmg6,
              s:"\nOriginal Max HP: ",d:MiscellaneousVars[298],
              s:"\nCurrent Max HP: ",d:MaxHealthTrue,
              s:"\nhpextradmg: ",d:hpextradmg,
              s:"\nhpextradmgfactor: ",d:hpextradmgfactor,
              s:"\nhpextradmg2: ",d:hpextradmg2,
              s:"\nhpextradmg3: ",d:hpextradmg3,
              s:"\nRandom: ",d:rand1,s:" - ",d:rand2,
              s:"\nPerkFactor: ",d:perkfactor,
              s:"\nTotal [Pre Max HP Check]: ",d:prefinaldmg,
              s:"\nTotal [Post Max HP Check]: ",d:finaldmg);
   }
  }
  else // If something that's NOT the player shoots it...
  {
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Non-Player/Spectre/Entity Sigil Shot");
   prefinaldmg = damage;
   finaldmg = damage;
   if (attacktype != 0) finaldmg = finaldmg * random(1,4); // +STRIFEDAMAGE calculation
   SetActivatorToTarget(0);
   if (CheckActorClass(0, "EntityBossNew")) finaldmg = finaldmg * 6 / 4;
   if (CheckActorClass(0, "EntitySecondNew")) finaldmg = finaldmg * 6 / 4;
   if (CheckActorClass(0, "EntityAscended")) finaldmg = finaldmg * 9 / 4;
   if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
   {
    PrintBold(s:"Base: ",d:damage,
              s:"\nPreTotal: ",d:prefinaldmg,
              s:"\nTotal: ",d:finaldmg);
   }
  }
 }
 else // Radius is NOT randomized
 {
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
  {
   PrintBold(s:"Base: ",d:damage,
             s:"\nExtra1: ",d:extradmg1,
             s:"\nExtra2: ",d:extradmg2,
             s:"\nExtra3: ",d:extradmg3,
             s:"\nExtra4: ",d:extradmg4,
             s:"\nExtra5: ",d:extradmg5,
             s:"\nExtra6: ",d:extradmg6,
             s:"\nPerkFactor: ",d:perkfactor,
             s:"\nTotal: ",d:finaldmg);
  }
 }
 SetResultValue(finaldmg);
}

script "GetMiscellaneousVar" (int index)
{
 SetResultValue(MiscellaneousVars[index]);
}

script "GetPlayerLevel" (void)
{
 SetResultValue(PlayerLevel);
}

script "GetPunchStaminaUse" (int attacktype)
{
 int stamuse;
 int PerkFactor;
 int temp1, temp2;
 if (attacktype == 0) // Punch [normal]
 {
  if (CharacterClass == 0) stamuse = 225;
  if (CharacterClass == 1) stamuse = 250;
  if (CharacterClass == 2) stamuse = 333;
  if (CharacterClass == 9) stamuse = 298;
 }
 else
 if (attacktype == 1) // Gauntlet Punch [normal]
 {
  if (CharacterClass == 0) stamuse = 562;
  if (CharacterClass == 1) stamuse = 625;
  if (CharacterClass == 2) stamuse = 832;
  if (CharacterClass == 9) stamuse = 732;
 }
 else
 if (attacktype == 2) // Gauntlet Punch [altfire]
 {
  if (CharacterClass == 0) stamuse = 1405;
  if (CharacterClass == 1) stamuse = 1562;
  if (CharacterClass == 2) stamuse = 2081;
  if (CharacterClass == 9) stamuse = 1830;
 }
 else
 if (attacktype == 4) // Punch [uppercut]
 {
  if (CharacterClass == 0) stamuse = 374;
  if (CharacterClass == 1) stamuse = 415;
  if (CharacterClass == 2) stamuse = 553;
  if (CharacterClass == 9) stamuse = 495;
 }
 int whole = stamuse / 100; 
 int modulus = stamuse % 100;
 if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
 {
  if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used [Base]: ",d:whole,s:".0",d:modulus,s:"%");
  else PrintBold(s:"Stamina Used [Base]: ",d:whole,s:".",d:modulus,s:"%");
 }

 if (MiscellaneousVars[10035] > 0)
 {
  temp1 = 0;
  if (MiscellaneousVars[10035] == 1) temp1 = 50;
  if (MiscellaneousVars[10035] == 2) temp1 = 100;
  if (MiscellaneousVars[10035] == 3) temp1 = 175;
  if (MiscellaneousVars[10035] == 4) temp1 = 300;
  if (MiscellaneousVars[10035] >= 5) temp1 = 600;
  temp2 = 0;
  if (MiscellaneousVars[10036] == 1) temp2 = 150;
  if (MiscellaneousVars[10036] == 2) temp2 = 350;
  PerkFactor = 1000 - (temp1 + temp2);
  stamuse = stamuse * PerkFactor / 1000;
 }

 if (MiscellaneousVars[10051] > 0)
 {
  temp1 = 0;
  if (MiscellaneousVars[10051] == 1) temp1 = 50;
  if (MiscellaneousVars[10051] == 2) temp1 = 100;
  if (MiscellaneousVars[10051] == 3) temp1 = 175;
  if (MiscellaneousVars[10051] == 4) temp1 = 300;
  if (MiscellaneousVars[10051] >= 5) temp1 = 600;
  temp2 = 0;
  if (MiscellaneousVars[10052] == 1) temp2 = 150;
  if (MiscellaneousVars[10052] == 2) temp2 = 350;
  PerkFactor = 1000 - (temp1 + temp2);
  stamuse = stamuse * PerkFactor / 1000;
 }

 whole = stamuse / 100; 
 modulus = stamuse % 100;
 if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
 {
  if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used [After Perks]: ",d:whole,s:".0",d:modulus,s:"%");
  else PrintBold(s:"Stamina Used [After Perks]: ",d:whole,s:".",d:modulus,s:"%");
 }

 SetResultValue(stamuse); 
}

script "GetKickStaminaUse" (int attacktype)
{
 int stamuse;
 int PerkFactor;
 int temp1, temp2;
 if (attacktype == 0) // Kick [normal]
 {
  if (CharacterClass == 0) stamuse = 666;
  if (CharacterClass == 1) stamuse = 500;
  if (CharacterClass == 2) stamuse = 450;
  if (CharacterClass == 9) stamuse = 300;
 }
 else
 if (attacktype == 1) // Roundhouse Kick [normal]
 {
  if (CharacterClass == 0) stamuse = 1665;
  if (CharacterClass == 1) stamuse = 1250;
  if (CharacterClass == 2) stamuse = 1125;
  if (CharacterClass == 9) stamuse = 750;
 }
 int whole = stamuse / 100; 
 int modulus = stamuse % 100;
 if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
 {
  if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used [Base]: ",d:whole,s:".0",d:modulus,s:"%");
  else PrintBold(s:"Stamina Used [Base]: ",d:whole,s:".",d:modulus,s:"%");
 }

 if (MiscellaneousVars[10035] > 0)
 {
  temp1 = 0;
  if (MiscellaneousVars[10035] == 1) temp1 = 50;
  if (MiscellaneousVars[10035] == 2) temp1 = 100;
  if (MiscellaneousVars[10035] == 3) temp1 = 175;
  if (MiscellaneousVars[10035] == 4) temp1 = 300;
  if (MiscellaneousVars[10035] >= 5) temp1 = 600;
  temp2 = 0;
  if (MiscellaneousVars[10036] == 1) temp2 = 150;
  if (MiscellaneousVars[10036] == 2) temp2 = 350;
  PerkFactor = 1000 - (temp1 + temp2);
  stamuse = stamuse * PerkFactor / 1000;
 }
 whole = stamuse / 100; 
 modulus = stamuse % 100;
 if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
 {
  if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used [After Perks]: ",d:whole,s:".0",d:modulus,s:"%");
  else PrintBold(s:"Stamina Used [After Perks]: ",d:whole,s:".",d:modulus,s:"%");
 }

 if (MiscellaneousVars[10051] > 0)
 {
  temp1 = 0;
  if (MiscellaneousVars[10051] == 1) temp1 = 50;
  if (MiscellaneousVars[10051] == 2) temp1 = 100;
  if (MiscellaneousVars[10051] == 3) temp1 = 175;
  if (MiscellaneousVars[10051] == 4) temp1 = 300;
  if (MiscellaneousVars[10051] >= 5) temp1 = 600;
  temp2 = 0;
  if (MiscellaneousVars[10052] == 1) temp2 = 150;
  if (MiscellaneousVars[10052] == 2) temp2 = 350;
  PerkFactor = 1000 - (temp1 + temp2);
  stamuse = stamuse * PerkFactor / 1000;
 }

 SetResultValue(stamuse); 
}

script "GetSceptreStaminaUse" (int attacktype)
{
 int stamuse;
 if (attacktype == 0) // Normal Swing
 {
  if (SceptreActualLevel <= 0) stamuse = 575;
  if (SceptreActualLevel == 1) stamuse = 568; // -7
  if (SceptreActualLevel == 2) stamuse = 561; // -7
  if (SceptreActualLevel == 3) stamuse = 554; // -7
  if (SceptreActualLevel == 4) stamuse = 546; // -8
  if (SceptreActualLevel == 5) stamuse = 538; // -8
  if (SceptreActualLevel == 6) stamuse = 530; // -8
  if (SceptreActualLevel == 7) stamuse = 521; // -9
  if (SceptreActualLevel == 8) stamuse = 512; // -9
  if (SceptreActualLevel == 9) stamuse = 503; // -9
  if (SceptreActualLevel == 10) stamuse = 493; // -10
  if (SceptreActualLevel == 11) stamuse = 483; // -10
  if (SceptreActualLevel == 12) stamuse = 473; // -10
  if (SceptreActualLevel == 13) stamuse = 462; // -11
  if (SceptreActualLevel == 14) stamuse = 451; // -11
  if (SceptreActualLevel == 15) stamuse = 440; // -11
  if (SceptreActualLevel >= 16) stamuse = 428; // -12
 }
 else
 if (attacktype == 1) // Aireal Attack
 {
  if (SceptreActualLevel <= 0) stamuse = 575;
  if (SceptreActualLevel == 1) stamuse = 568; // -7
  if (SceptreActualLevel == 2) stamuse = 561; // -7
  if (SceptreActualLevel == 3) stamuse = 554; // -7
  if (SceptreActualLevel == 4) stamuse = 546; // -8
  if (SceptreActualLevel == 5) stamuse = 538; // -8
  if (SceptreActualLevel == 6) stamuse = 530; // -8
  if (SceptreActualLevel == 7) stamuse = 521; // -9
  if (SceptreActualLevel == 8) stamuse = 512; // -9
  if (SceptreActualLevel == 9) stamuse = 503; // -9
  if (SceptreActualLevel == 10) stamuse = 493; // -10
  if (SceptreActualLevel == 11) stamuse = 483; // -10
  if (SceptreActualLevel == 12) stamuse = 473; // -10
  if (SceptreActualLevel == 13) stamuse = 462; // -11
  if (SceptreActualLevel == 14) stamuse = 451; // -11
  if (SceptreActualLevel == 15) stamuse = 440; // -11
  if (SceptreActualLevel >= 16) stamuse = 428; // -12
 }
 else
 if (attacktype == 2) // Spinning Attack
 {
  if (SceptreActualLevel <= 0) stamuse = 1005;
  if (SceptreActualLevel == 1) stamuse = 996;
  if (SceptreActualLevel == 2) stamuse = 987;
  if (SceptreActualLevel == 3) stamuse = 978;
  if (SceptreActualLevel == 4) stamuse = 969;
  if (SceptreActualLevel == 5) stamuse = 960;
  if (SceptreActualLevel == 6) stamuse = 951;
  if (SceptreActualLevel == 7) stamuse = 942;
  if (SceptreActualLevel == 8) stamuse = 933;
  if (SceptreActualLevel == 9) stamuse = 924;
  if (SceptreActualLevel == 10) stamuse = 915;
  if (SceptreActualLevel == 11) stamuse = 903;
  if (SceptreActualLevel == 12) stamuse = 891;
  if (SceptreActualLevel == 13) stamuse = 879;
  if (SceptreActualLevel == 14) stamuse = 867;  
  if (SceptreActualLevel == 15) stamuse = 855;
  if (SceptreActualLevel >= 16) stamuse = 840;
 }
 if (PowerupTimer[10] > 0) stamuse = stamuse * 19 / 20; // Oomph
 if (PowerupTimer[23] > 0) stamuse = stamuse * 7 / 8; // Berserk
 SetResultValue(stamuse);
}

script "GetSceptreLevel" (void)
{
 SetResultValue(SceptreActualLevel);
}

script "SetShieldPieceDist" (int basedist)
{
 int result = basedist;
 if (ClassicDoomType == 5) result = result * 6 / 5; // 1.2x in Doom64 due to scaling up of general maps, etc :V
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Distance: ",d:result,s:"  [Base Dist: ",d:basedist,s:"]");
 SetResultValue(result);
}

script "GetSceptreRange" (int attacktype)
{
 int range;
 int baserange;
 if (attacktype == 0) // Normal Swing
 {
  if (SceptreActualLevel <= 0) range = 104;
  if (SceptreActualLevel == 1) range = 106; // +2
  if (SceptreActualLevel == 2) range = 108; // +2
  if (SceptreActualLevel == 3) range = 110; // +2
  if (SceptreActualLevel == 4) range = 112; // +2
  if (SceptreActualLevel == 5) range = 116; // +4
  if (SceptreActualLevel == 6) range = 118; // +2
  if (SceptreActualLevel == 7) range = 122; // +4
  if (SceptreActualLevel == 8) range = 128; // +6
  if (SceptreActualLevel == 9) range = 132; // +2
  if (SceptreActualLevel == 10) range = 134; // +2
  if (SceptreActualLevel == 11) range = 136; // +2
  if (SceptreActualLevel == 12) range = 138; // +2
  if (SceptreActualLevel == 13) range = 142; // +4
  if (SceptreActualLevel == 14) range = 144; // +2
  if (SceptreActualLevel == 15) range = 148; // +4
  if (SceptreActualLevel >= 16) range = 154; // +6
  range = range * 5 / 4;
 }
 else
 if (attacktype == 1) // Aireal Attack
 {
  if (SceptreActualLevel <= 0) range = 104;
  if (SceptreActualLevel == 1) range = 106; // +2
  if (SceptreActualLevel == 2) range = 108; // +2
  if (SceptreActualLevel == 3) range = 110; // +2
  if (SceptreActualLevel == 4) range = 112; // +2
  if (SceptreActualLevel == 5) range = 116; // +4
  if (SceptreActualLevel == 6) range = 118; // +2
  if (SceptreActualLevel == 7) range = 122; // +4
  if (SceptreActualLevel == 8) range = 128; // +6
  if (SceptreActualLevel == 9) range = 132; // +2
  if (SceptreActualLevel == 10) range = 134; // +2
  if (SceptreActualLevel == 11) range = 136; // +2
  if (SceptreActualLevel == 12) range = 138; // +2
  if (SceptreActualLevel == 13) range = 142; // +4
  if (SceptreActualLevel == 14) range = 144; // +2
  if (SceptreActualLevel == 15) range = 148; // +4
  if (SceptreActualLevel >= 16) range = 154; // +6
  range = range * 5 / 4;
 }
 else
 if (attacktype == 2) // Spinning Attack
 {
  if (SceptreActualLevel <= 0) range = 168;
  if (SceptreActualLevel == 1) range = 173; // +5
  if (SceptreActualLevel == 2) range = 178; // +5
  if (SceptreActualLevel == 3) range = 182; // +4
  if (SceptreActualLevel == 4) range = 187; // +5
  if (SceptreActualLevel == 5) range = 196; // +9
  if (SceptreActualLevel == 6) range = 201; // +5
  if (SceptreActualLevel == 7) range = 209; // +8
  if (SceptreActualLevel == 8) range = 222; // +13
  if (SceptreActualLevel == 9) range = 230; // +8
  if (SceptreActualLevel == 10) range = 236; // +6
  if (SceptreActualLevel == 11) range = 241; // +5
  if (SceptreActualLevel == 12) range = 247; // +6
  if (SceptreActualLevel == 13) range = 256; // +9
  if (SceptreActualLevel == 14) range = 262; // +6
  if (SceptreActualLevel == 15) range = 271; // +9
  if (SceptreActualLevel >= 16) range = 288; // +17
  range = range * 5 / 4;
 }
 baserange = range;
 if (ClassicDoomType == 5) range = range * 6 / 5; // 1.2x in Doom64 due to scaling up of general maps, etc :V
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeRange: ",d:range,s:"  [Base Range:",d:baserange,s:"]");
 SetResultValue(Range);
}

script "MeleeImpactRadius" (int attacktype)
{
 int radius;
 if (attacktype == 0) // Sceptre [Normal]
 {
  if (SceptreActualLevel <= 0) radius = 80 + (MiscellaneousVars[35] * 16 / 16);
  if (SceptreActualLevel == 1) radius = 85 + (MiscellaneousVars[35] * 17 / 16);
  if (SceptreActualLevel == 2) radius = 90 + (MiscellaneousVars[35] * 18 / 16);
  if (SceptreActualLevel == 3) radius = 95 + (MiscellaneousVars[35] * 19 / 16);
  if (SceptreActualLevel == 4) radius = 100 + (MiscellaneousVars[35] * 20 / 16);
  if (SceptreActualLevel == 5) radius = 105 + (MiscellaneousVars[35] * 21 / 16);
  if (SceptreActualLevel == 6) radius = 110 + (MiscellaneousVars[35] * 22 / 16);
  if (SceptreActualLevel == 7) radius = 115 + (MiscellaneousVars[35] * 23 / 16);
  if (SceptreActualLevel == 8) radius = 120 + (MiscellaneousVars[35] * 24 / 16);
  if (SceptreActualLevel == 9) radius = 125 + (MiscellaneousVars[35] * 25 / 16);
  if (SceptreActualLevel == 10) radius = 130 + (MiscellaneousVars[35] * 26 / 16);
  if (SceptreActualLevel == 11) radius = 135 + (MiscellaneousVars[35] * 27 / 16);
  if (SceptreActualLevel == 12) radius = 140 + (MiscellaneousVars[35] * 28 / 16);
  if (SceptreActualLevel == 13) radius = 145 + (MiscellaneousVars[35] * 29 / 16);
  if (SceptreActualLevel == 14) radius = 150 + (MiscellaneousVars[35] * 30 / 16);
  if (SceptreActualLevel == 15) radius = 155 + (MiscellaneousVars[35] * 31 / 16);
  if (SceptreActualLevel >= 16) radius = 160 + (MiscellaneousVars[35] * 32 / 16);
 }
 else
 if (attacktype == 1) // Sceptre [Aireal]
 {
 }
 else
 if (attacktype == 2) // Sceptre [Spinning]
 {
  if (SceptreActualLevel <= 0) radius = 20 + (MiscellaneousVars[35] * 333 / 1000);
  if (SceptreActualLevel == 1) radius = 21 + (MiscellaneousVars[35] * 354 / 1000);
  if (SceptreActualLevel == 2) radius = 23 + (MiscellaneousVars[35] * 375 / 1000);
  if (SceptreActualLevel == 3) radius = 24 + (MiscellaneousVars[35] * 395 / 1000);
  if (SceptreActualLevel == 4) radius = 25 + (MiscellaneousVars[35] * 416 / 1000);
  if (SceptreActualLevel == 5) radius = 26 + (MiscellaneousVars[35] * 437 / 1000);
  if (SceptreActualLevel == 6) radius = 28 + (MiscellaneousVars[35] * 458 / 1000);
  if (SceptreActualLevel == 7) radius = 29 + (MiscellaneousVars[35] * 478 / 1000);
  if (SceptreActualLevel == 8) radius = 30 + (MiscellaneousVars[35] * 500 / 1000);
  if (SceptreActualLevel == 9) radius = 31 + (MiscellaneousVars[35] * 520 / 1000);
  if (SceptreActualLevel == 10) radius = 33 + (MiscellaneousVars[35] * 541 / 1000);
  if (SceptreActualLevel == 11) radius = 34 + (MiscellaneousVars[35] * 562 / 1000);
  if (SceptreActualLevel == 12) radius = 35 + (MiscellaneousVars[35] * 583 / 1000);
  if (SceptreActualLevel == 13) radius = 36 + (MiscellaneousVars[35] * 604 / 1000);
  if (SceptreActualLevel == 14) radius = 38 + (MiscellaneousVars[35] * 624 / 1000);
  if (SceptreActualLevel == 15) radius = 39 + (MiscellaneousVars[35] * 645 / 1000);
  if (SceptreActualLevel >= 16) radius = 40 + (MiscellaneousVars[35] * 666 / 1000);
 }
 else
 if (attacktype == 3) // Punch [unarmed] (normal)
 {
  radius = 16 + (MiscellaneousVars[35] / 8);
 }
 else
 if (attacktype == 4) // Punch [unarmed] (alt-fire)
 {
  radius = 24 + (MiscellaneousVars[35] / 6);
 }
 else
 if (attacktype == 5) // Punch [w/ Gauntlets] (normal)
 {
  radius = 40 + (MiscellaneousVars[35] / 3);
 }
 else
 if (attacktype == 6) // Punch [w/ Gauntlets] (alt-fire)
 {
  radius = 64 + (MiscellaneousVars[35] / 2);
 }
 else
 if (attacktype == 7) // Thrust Kick
 {
  radius = 24 + (MiscellaneousVars[35] / 4);
 }
 else
 if (attacktype == 8) // Spinning/Roundhouse Kick
 {
  radius = 36 + (MiscellaneousVars[35] / 3);
 }
 int baseradius = radius;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [Base]: ",d:radius);
 if (MiscellaneousVars[317] > 0) radius = (radius * (8 + (MiscellaneousVars[317] * 3)) / 8);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [StaminaUpgrades]: ",d:radius);
 if (CharacterClass == 0) radius = radius * 3 / 2;
 if (CharacterClass == 1) radius = radius * 5 / 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [ClassCheck]: ",d:radius);

 if (PowerupTimer[7] > 0) radius = radius * 6 / 5; // 1.2x Radius [Divine Avatar]
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [Divine]: ",d:radius);
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) radius = radius * 7 / 4; // 1.75x Radius [Berserk]
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [Berserk]: ",d:radius);

 if (ClassicDoomType == 5) radius = radius * 6 / 5; // 1.2x in Doom64 due to scaling up of general maps, etc :V
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"EXPLRadius [Final]: ",d:radius,s:" [Base: ",d:baseradius,s:"]");
 SetResultValue(radius);
}

// Quake tremor effects
script "QuakeMeleeIntensity" (int attacktype)
{
 int intensity;
 if (attacktype == 0) // Sceptre [Normal]
 {
  if (SceptreActualLevel <= 0) intensity = 1;
  if (SceptreActualLevel == 1) intensity = 1;
  if (SceptreActualLevel == 2) intensity = 1;
  if (SceptreActualLevel == 3) intensity = 1;
  if (SceptreActualLevel == 4) intensity = 1;
  if (SceptreActualLevel == 5) intensity = 1;
  if (SceptreActualLevel == 6) intensity = 1;
  if (SceptreActualLevel == 7) intensity = 1;
  if (SceptreActualLevel == 8) intensity = 2;
  if (SceptreActualLevel == 9) intensity = 2;
  if (SceptreActualLevel == 10) intensity = 2;
  if (SceptreActualLevel == 11) intensity = 2;
  if (SceptreActualLevel == 12) intensity = 2;
  if (SceptreActualLevel == 13) intensity = 2;
  if (SceptreActualLevel == 14) intensity = 2;
  if (SceptreActualLevel == 15) intensity = 2;
  if (SceptreActualLevel >= 16) intensity = 3;
  intensity = intensity + (MiscellaneousVars[35] / 12);
 }
 else
 if (attacktype == 1) // Sceptre [Aireal]
 {
 }
 else
 if (attacktype == 2) // Sceptre [Spinning]
 {
  if (SceptreActualLevel <= 0) intensity = 0;
  if (SceptreActualLevel == 1) intensity = 0;
  if (SceptreActualLevel == 2) intensity = 0;
  if (SceptreActualLevel == 3) intensity = 0;
  if (SceptreActualLevel == 4) intensity = 0;
  if (SceptreActualLevel == 5) intensity = 0;
  if (SceptreActualLevel == 6) intensity = 0;
  if (SceptreActualLevel == 7) intensity = 0;
  if (SceptreActualLevel == 8) intensity = 0;
  if (SceptreActualLevel == 9) intensity = 0;
  if (SceptreActualLevel == 10) intensity = 0;
  if (SceptreActualLevel == 11) intensity = 0;
  if (SceptreActualLevel == 12) intensity = 0;
  if (SceptreActualLevel == 13) intensity = 0;
  if (SceptreActualLevel == 14) intensity = 0;
  if (SceptreActualLevel == 15) intensity = 0;
  if (SceptreActualLevel >= 16) intensity = 0;
  intensity = intensity + (MiscellaneousVars[35] / 32);
 }
 else
 if (attacktype == 3) // Punch [unarmed] (normal)
 {
  intensity = 0 + (MiscellaneousVars[35] / 32);
 }
 else
 if (attacktype == 4) // Punch [unarmed] (alt-fire/uppercut)
 {
  intensity = 0 + (MiscellaneousVars[35] / 24);
 }
 else
 if (attacktype == 5) // Punch [w/ Gauntlets] (normal)
 {
  intensity = 1 + (MiscellaneousVars[35] / 12);
 }
 else
 if (attacktype == 6) // Punch [w/ Gauntlets] (alt-fire)
 {
  intensity = 1 + (MiscellaneousVars[35] / 8);
 }
 else
 if (attacktype == 7) // Thrust Kick
 {
  intensity = 0 + (MiscellaneousVars[35] / 16);
 }
 else
 if (attacktype == 8) // Spinning/Roundhouse Kick
 {
  intensity = 0 + (MiscellaneousVars[35] / 12);
 }
 int baseintensity = intensity;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Intensity [Base]: ",d:intensity);
 if (MiscellaneousVars[317] > 0) intensity += (MiscellaneousVars[317] / 4);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Intensity [StaminaUpgrades]: ",d:intensity);
 if (CharacterClass == 0) intensity = intensity * 3 / 2;
 if (CharacterClass == 1) intensity = intensity * 5 / 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Intensity [CharacterCheck]: ",d:intensity);

 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) 
 {
  if (intensity <= 0) intensity += 1; else intensity = (intensity * 3) / 2;
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Intensity [Berserk]: ",d:intensity);

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Intensity [Final]: ",d:intensity,s:" [Base: ",d:baseintensity,s:"]");
 SetResultValue(intensity);
}
script "QuakeMeleeDuration" (int attacktype)
{
 int duration;
 if (attacktype == 0) // Sceptre [Normal]
 {
  if (SceptreActualLevel <= 0) duration = 8;
  if (SceptreActualLevel == 1) duration = 8;
  if (SceptreActualLevel == 2) duration = 9;
  if (SceptreActualLevel == 3) duration = 9;
  if (SceptreActualLevel == 4) duration = 10;
  if (SceptreActualLevel == 5) duration = 10;
  if (SceptreActualLevel == 6) duration = 11;
  if (SceptreActualLevel == 7) duration = 11;
  if (SceptreActualLevel == 8) duration = 12;
  if (SceptreActualLevel == 9) duration = 12;
  if (SceptreActualLevel == 10) duration = 13;
  if (SceptreActualLevel == 11) duration = 13;
  if (SceptreActualLevel == 12) duration = 14;
  if (SceptreActualLevel == 13) duration = 14;
  if (SceptreActualLevel == 14) duration = 15;
  if (SceptreActualLevel == 15) duration = 15;
  if (SceptreActualLevel >= 16) duration = 16;
  duration = duration + (MiscellaneousVars[35] / 10);
 }
 else
 if (attacktype == 1) // Sceptre [Aireal]
 {
 }
 else
 if (attacktype == 2) // Sceptre [Spinning]
 {
  if (SceptreActualLevel <= 0) duration = 2;
  if (SceptreActualLevel == 1) duration = 2;
  if (SceptreActualLevel == 2) duration = 2;
  if (SceptreActualLevel == 3) duration = 2;
  if (SceptreActualLevel == 4) duration = 2;
  if (SceptreActualLevel == 5) duration = 2;
  if (SceptreActualLevel == 6) duration = 2;
  if (SceptreActualLevel == 7) duration = 2;
  if (SceptreActualLevel == 8) duration = 3;
  if (SceptreActualLevel == 9) duration = 3;
  if (SceptreActualLevel == 10) duration = 3;
  if (SceptreActualLevel == 11) duration = 3;
  if (SceptreActualLevel == 12) duration = 3;
  if (SceptreActualLevel == 13) duration = 3;
  if (SceptreActualLevel == 14) duration = 3;
  if (SceptreActualLevel == 15) duration = 3;
  if (SceptreActualLevel >= 16) duration = 4;
  duration = duration + (MiscellaneousVars[35] / 40);
 }
 else
 if (attacktype == 3) // Punch [unarmed] (normal)
 {
  duration = 2;
  duration = duration + (MiscellaneousVars[35] / 40);
 }
 else
 if (attacktype == 4) // Punch [unarmed] (alt-fire)
 {
  duration = 3;
  duration = duration + (MiscellaneousVars[35] / 28);
 }
 else
 if (attacktype == 5) // Punch [w/ Gauntlets] (normal)
 {
  duration = 6;
  duration = duration + (MiscellaneousVars[35] / 14);
 }
 else
 if (attacktype == 6) // Punch [w/ Gauntlets] (alt-fire)
 {
  duration = 8;
  duration = duration + (MiscellaneousVars[35] / 10);
 }
 else
 if (attacktype == 7) // Thrust Kick
 {
  duration = 4;
  duration = duration + (MiscellaneousVars[35] / 20);
 }
 else
 if (attacktype == 8) // Spinning/Roundhouse Kick
 {
  duration = 6;
  duration = duration + (MiscellaneousVars[35] / 14);
 }
 int baseduration = duration;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [Base]: ",d:duration);
 if (MiscellaneousVars[317] > 0) duration = (duration * (8 + (MiscellaneousVars[317] * 3)) / 8);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [StaminaUpgrades]: ",d:duration);
 if (CharacterClass == 0) duration = duration * 3 / 2;
 if (CharacterClass == 1) duration = duration * 5 / 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [CharacterCheck]: ",d:duration);

 if (PowerupTimer[7] > 0) duration = duration * 3 / 2;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [DivineAvatar]: ",d:duration);
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) duration *= 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [Berserk]: ",d:duration);

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"Duration [Final]: ",d:duration,s:" [Base: ",d:baseduration,s:"]");
 SetResultValue(duration);
}
script "QuakeMeleeTremrad" (int attacktype)
{
 int tremrad;
 if (attacktype == 0) // Sceptre [Normal]
 {
  if (SceptreActualLevel <= 0) tremrad = 512;
  if (SceptreActualLevel == 1) tremrad = 544;
  if (SceptreActualLevel == 2) tremrad = 576;
  if (SceptreActualLevel == 3) tremrad = 608;
  if (SceptreActualLevel == 4) tremrad = 640;
  if (SceptreActualLevel == 5) tremrad = 672;
  if (SceptreActualLevel == 6) tremrad = 704;
  if (SceptreActualLevel == 7) tremrad = 736;
  if (SceptreActualLevel == 8) tremrad = 768;
  if (SceptreActualLevel == 9) tremrad = 800;
  if (SceptreActualLevel == 10) tremrad = 832;
  if (SceptreActualLevel == 11) tremrad = 864;
  if (SceptreActualLevel == 12) tremrad = 896;
  if (SceptreActualLevel == 13) tremrad = 928;
  if (SceptreActualLevel == 14) tremrad = 960;
  if (SceptreActualLevel == 15) tremrad = 992;
  if (SceptreActualLevel >= 16) tremrad = 1024;
  tremrad = tremrad + (MiscellaneousVars[35] * 4);
 }
 else
 if (attacktype == 1) // Sceptre [Aireal]
 {
 }
 else
 if (attacktype == 2) // Sceptre [Spinning]
 {
  if (SceptreActualLevel <= 0) tremrad = 128;
  if (SceptreActualLevel == 1) tremrad = 136;
  if (SceptreActualLevel == 2) tremrad = 144;
  if (SceptreActualLevel == 3) tremrad = 152;
  if (SceptreActualLevel == 4) tremrad = 160;
  if (SceptreActualLevel == 5) tremrad = 168;
  if (SceptreActualLevel == 6) tremrad = 176;
  if (SceptreActualLevel == 7) tremrad = 184;
  if (SceptreActualLevel == 8) tremrad = 192;
  if (SceptreActualLevel == 9) tremrad = 200;
  if (SceptreActualLevel == 10) tremrad = 208;
  if (SceptreActualLevel == 11) tremrad = 216;
  if (SceptreActualLevel == 12) tremrad = 224;
  if (SceptreActualLevel == 13) tremrad = 232;
  if (SceptreActualLevel == 14) tremrad = 240;
  if (SceptreActualLevel == 15) tremrad = 248;
  if (SceptreActualLevel >= 16) tremrad = 256;
  tremrad = tremrad + (MiscellaneousVars[35]);
 }
 else
 if (attacktype == 3) // Punch [unarmed] (normal)
 {
  tremrad = 256;
  tremrad = tremrad + (MiscellaneousVars[35]);
 }
 else
 if (attacktype == 4) // Punch [unarmed] (alt-fire)
 {
  tremrad = 320;
  tremrad = tremrad + ((MiscellaneousVars[35] * 5) / 4);
 }
 else
 if (attacktype == 5) // Punch [w/ Gauntlets] (normal)
 {
  tremrad = 844;
  tremrad = tremrad + (MiscellaneousVars[35] * 13 / 4);
 }
 else
 if (attacktype == 6) // Punch [w/ Gauntlets] (alt-fire)
 {
  tremrad = 1024;
  tremrad = tremrad + (MiscellaneousVars[35] * 4);
 }
 else
 if (attacktype == 7) // Thrust Kick
 {
  tremrad = 384;
  tremrad = tremrad + ((MiscellaneousVars[35] * 7) / 4);
 }
 else
 if (attacktype == 8) // Spinning/Roundhouse Kick
 {
  tremrad = 480;
  tremrad = tremrad + ((MiscellaneousVars[35] * 13) / 4);
 }
 int basetremrad = tremrad;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [Base]: ",d:tremrad);
 if (MiscellaneousVars[317] > 0) tremrad = (tremrad * (8 + (MiscellaneousVars[317] * 3)) / 8);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [StaminaUpgrades]: ",d:tremrad);
 if (CharacterClass == 0) tremrad = tremrad * 3 / 2;
 if (CharacterClass == 1) tremrad = tremrad * 5 / 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [CharacterCheck]: ",d:tremrad);

 if (PowerupTimer[7] > 0) tremrad = tremrad * 3 / 2;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [DivineAvatar]: ",d:tremrad);
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) tremrad *= 8;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [Berserk]: ",d:tremrad);

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"TremRad [Final]: ",d:tremrad,s:" [Base: ",d:basetremrad,s:"]");
 SetResultValue(tremrad);
}

script "GetPSNCloudVortexSTR" (int CloudSize)
{
 int VortexStrength = 256;
 int Extra;
 if (CloudSize == 0) // Minor
 {
  VortexStrength = 256;
  Extra = (MiscellaneousVars[34] * 4) + (MiscellaneousVars[36] * 2);
 }

 if (CloudSize == 1) // Normal
 {
  VortexStrength = 512; // 200%
  Extra = (MiscellaneousVars[34] * 8) + (MiscellaneousVars[36] * 4);
 }

 if (CloudSize == 2) // Major
 {
  VortexStrength = 1024; // 400%
  Extra = (MiscellaneousVars[34] * 16) + (MiscellaneousVars[36] * 8);
 }

 VortexStrength += Extra;
 VortexStrength *= -1;
 SetResultValue(VortexStrength);
}

script "GetPSNCloudVortexDIST" (int CloudSize, int type, int particlespawn)
{
 int VortexDistance = 80;
 int Extra;
 if (CloudSize == 0) // Minor
 {
  VortexDistance = 80; // 100%
  Extra = (MiscellaneousVars[34] * 2) + (MiscellaneousVars[36] * 1);
 }

 if (CloudSize == 1) // Normal
 {
  VortexDistance = 140; // 175%
  Extra = (MiscellaneousVars[34] * 4) + (MiscellaneousVars[36] * 2);
 }

 if (CloudSize == 2) // Major
 {
  VortexDistance = 260; // 325%
  Extra = (MiscellaneousVars[34] * 8) + (MiscellaneousVars[36] * 4);
 }
 
 VortexDistance += Extra;
 if (type == 1) VortexDistance /= 2;

 if (particlespawn == 1) // Fixed Value
 {
  VortexDistance *= 1.0;
  VortexDistance = VortexDistance>>16;
 }

 SetResultValue(VortexDistance);
}

script "GetPSNCloudDmgRad" (int CloudSize, int Type)
{
 int DmgRad = 40;
 int Extra;
 if (CloudSize == 0) // Minor
 {
  DmgRad = 40;
  Extra = (MiscellaneousVars[34] * 1) + (MiscellaneousVars[36] / 2);
 }

 if (CloudSize == 1) // Normal
 {
  DmgRad = 64;
  Extra = (MiscellaneousVars[34] * 8 / 5) + (MiscellaneousVars[36] * 4 / 5);
 }

 if (CloudSize == 2) // Major
 {
  DmgRad = 88;
  Extra = (MiscellaneousVars[34] * 11 / 5) + (MiscellaneousVars[36] * 7 / 5);
 }

 int DmgFullRad = DmgRad / 4;
 if (Type == 0) SetResultValue(DmgRad);
 else SetResultValue(DmgFullRad);
}

// Melee Range
script "GetMeleeRange" (int type)
{
 int baseresult;
 int result;
 if (type == 0) // Punch [normal]
 {
  result = 64;
 }
 if (type == 1) // Punch [uppercut]
 {
  result = 58;
 }
 if (type == 2) // Gauntlet Punch [normal]
 {
  result = 72;
 }
 if (type == 3) // Gauntlet Punch [alt-fire]
 {
  result = 80;
 }
 if (type == 4) // Kick
 {
  result = 104;
 }
 if (type == 5) // Chainsaw
 {
  result = 65;
 }
 if (type == 6) // Dual-Bladed Chainsaw
 {
  result = random(66,67);
 }

 baseresult = result;
 if (CharacterClass == 2 && MiscellaneousVars[10035] > 0)
 {
  if (MiscellaneousVars[10035] == 1) result = result * random(101,102) / 100;
  if (MiscellaneousVars[10035] == 2) result = result * random(102,104) / 100;
  if (MiscellaneousVars[10035] == 3) result = result * random(103,106) / 100;
  if (MiscellaneousVars[10035] == 4) result = result * random(104,108) / 100;
  if (MiscellaneousVars[10035] == 5) result = result * random(105,110) / 100;
 }

 if (CharacterClass != 2 && MiscellaneousVars[10051] > 0)
 {
  if (MiscellaneousVars[10051] == 1) result = result * random(1005,1010) / 1000;
  if (MiscellaneousVars[10051] == 2) result = result * random(1010,1020) / 1000;
  if (MiscellaneousVars[10051] == 3) result = result * random(1015,1030) / 1000;
  if (MiscellaneousVars[10051] == 4) result = result * random(1020,1040) / 1000;
  if (MiscellaneousVars[10051] == 5) result = result * random(1025,1050) / 1000;
 }

 if (ClassicDoomType == 5) result = result * 6 / 5; // 1.2x in Doom64 due to scaling up of general maps, etc :V
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"Melee Range: ",d:result,s:" [Base: ",d:baseresult,s:"]"); }
 SetResultValue(result);
}

// Fist/Punch Damage Checker
script "GetPunchDamage" (int altfire, int shockwave)
{
 int damage;
 int previousdamage;
 int strengthcounter;

 SetActivator(Player1TID);
 str weapon = GetWeapon();
 SetActivator(0);

 // Character Check [base damage]
 If (StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistFlora") == 0 || StrIcmp(weapon, "FistAilish") == 0 || StrIcmp(weapon, "FistPetra") == 0)
 {
  if (altfire == 0)
  {
   if (CharacterClass == 0) damage = random(18,24);
   if (CharacterClass == 1) damage = random(10,16);
   if (CharacterClass == 2) damage = random(6,12);
  }
  else
  if (altfire == 1)
  {
   if (CharacterClass == 0) damage += random(126,148);
   if (CharacterClass == 1) damage += random(70,112);
   if (CharacterClass == 2) damage += random(42,84);
  }
 }
 else
 {
  if (CharacterClass == 0) damage = random(18,24);
  if (CharacterClass == 1) damage = random(10,16);
  if (CharacterClass == 2) damage = random(6,12);
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BaseDmg: ",d:damage); } //PrintBold(d:damage);

  // Gauntlet Check #1 [base damage]
 previousdamage = damage;
 If (StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
 {
  if (CharacterClass == 0) damage += random(14,18);
  if (CharacterClass == 1) damage += random(10,14);
  if (CharacterClass == 2) damage += random(8,12);
  if (CharacterClass == 9) damage += random(8,12);
  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"GauntDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 }
 
 // [STRIFE] Stamina Upgrades
 previousdamage = damage;
 damage = (damage * (2 + MiscellaneousVars[317]) / 2);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StaminaDmg: ",d:damage,s:" StamUpgrades: ",d:MiscellaneousVars[317],s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Strength Stat Check [7 pts = roughly double the character's base punch damage]
 previousdamage = damage;
 for (strengthcounter = 0; strengthcounter < MiscellaneousVars[35]; strengthcounter++)
 {
  If(StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistFlora") == 0)
  {
   if (altfire == 0)
   {
    if (CharacterClass == 0) damage += random(1,3);
    if (CharacterClass == 1) damage += random(1,2);
    if (CharacterClass == 2) damage += random(0,2);
   }
   if (altfire == 1)
   {
    if (CharacterClass == 0) damage += random(8,12);
    if (CharacterClass == 1) damage += random(8,11);
    if (CharacterClass == 2) damage += random(6,10);
   }
  }
  else
  {
   if (CharacterClass == 0) damage += random(1,3);
   if (CharacterClass == 1) damage += random(1,2);
   if (CharacterClass == 2) damage += random(0,2);
  }
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StrDmg: ",d:damage,s:" - (Strength: ",d:MiscellaneousVars[35],s:")",s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Gauntlet Check #2 [strength stat check] [7 pts = roughly double the character's base gauntlet punch damage]
 previousdamage = damage;
 If(StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
 {
  for (strengthcounter = 0; strengthcounter < MiscellaneousVars[35]; strengthcounter++)
  {
   if (CharacterClass == 0) damage += random(2,3);
   if (CharacterClass == 1) damage += random(1,3);
   if (CharacterClass == 2) damage += random(1,2);
   if (CharacterClass == 9) damage += random(1,2);
  } 
  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"Gaunt2Dmg: ",d:damage,s:" - (Strength: ",d:MiscellaneousVars[35],s:")",s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 }

 // Berserk Check
 previousdamage = damage;
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) damage = damage * 10;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BerserkDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Flora Armor Checks
 previousdamage = damage;
 if (CharacterClass == 2) 
 {
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) Damage = Damage * 4 / 3; // +33.3~% Punch Damage
  if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) Damage = Damage * 7 / 4; // +75% Punch Damage
  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"FloArmorDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 }

 // Gauntlet Check #3
 previousdamage = damage;
 If(StrIcmp(weapon, "SauronGauntlets") == 0 || StrIcmp(weapon, "SauronGauntletsIllucia") == 0 || StrIcmp(weapon, "SauronGauntletsFlora") == 0 || StrIcmp(weapon, "SauronGauntletsAilish") == 0 || StrIcmp(weapon, "SauronGauntletsPetra") == 0)
 {
  if (altfire == 0) damage *= 10;
  if (altfire == 1) damage *= 25;
  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"Gaunt3Dmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 }

 int PerkFactor;
 int temp1, temp2;

 previousdamage = damage;
 if (shockwave > 0)
 {
  if (altfire == 0) damage = damage / 6;
  if (altfire == 1) damage = damage / 5;

  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeDmg [Shockwave]: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Martial Arts Mastery Perk (Shockwave)]");
  previousdamage = damage;
  if (MiscellaneousVars[10035] > 0)
  {
   temp1 = 0;
   if (MiscellaneousVars[10035] == 1) temp1 = 75;
   if (MiscellaneousVars[10035] == 2) temp1 = 225;
   if (MiscellaneousVars[10035] == 3) temp1 = 525;
   if (MiscellaneousVars[10035] == 4) temp1 = 1125;
   if (MiscellaneousVars[10035] >= 5) temp1 = 3375;
   temp2 = 0;
   if (MiscellaneousVars[10036] == 1) temp2 = 1500;
   if (MiscellaneousVars[10036] == 2) temp2 = 3000;
   PerkFactor = 1000 + (temp1 + temp2);
   damage = damage * PerkFactor / 1000;
   if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeDmg [Shockwave]: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Martial Arts Mastery Perk (Shockwave)]");
  }
 }
 else
 {
  previousdamage = damage;
  if (MiscellaneousVars[10035] > 0)
  {
   temp1 = 0;
   if (MiscellaneousVars[10035] == 1) temp1 = 25;
   if (MiscellaneousVars[10035] == 2) temp1 = 75;
   if (MiscellaneousVars[10035] == 3) temp1 = 175;
   if (MiscellaneousVars[10035] == 4) temp1 = 375;
   if (MiscellaneousVars[10035] >= 5) temp1 = 1125;
   temp2 = 0;
   if (MiscellaneousVars[10036] == 1) temp2 = 500;
   if (MiscellaneousVars[10036] == 2) temp2 = 1000;
   PerkFactor = 1000 + (temp1 + temp2);
   damage = damage * PerkFactor / 1000;
   if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Martial Arts Mastery Perk (Non-Shockwave)]");
  }
 }

 previousdamage = damage;
 If(StrIcmp(weapon, "FistDeggaris") == 0 || StrIcmp(weapon, "FistIllucia") == 0 || StrIcmp(weapon, "FistFlora") == 0)
 {
  if (altfire == 0) damage = damage;
  //if (altfire == 1) damage = damage / 4;
 }

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 0) PrintBold(s:"MeleeDmgAltCheck: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Punch]");
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 1) PrintBold(s:"MeleeDmgAltCheck: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Uppercut]");

 // StamUp Check
 if (MiscellaneousVars[10005] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10005] * 30) + (MiscellaneousVars[10006] * 75)) + 400;
  damage = damage * PerkFactor / 400;
 }

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 0) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Punch]");
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 1) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Uppercut]");

 SetResultValue(damage);
}

// Kick Damage Checker
script "GetKickDamage" (int altfire, int shockwave)
{
 int damage;
 int previousdamage;
 int strengthcounter;

 SetActivator(Player1TID);
 str weapon = GetWeapon();
 SetActivator(0);

 if (CharacterClass == 0) damage = random(45,60); // 2.5x
 if (CharacterClass == 1) damage = random(25,40); // 2.5x
 if (CharacterClass == 2) damage = random(26,51); // 4.25x
 if (CharacterClass == 9) damage = random(35,60); // 
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BaseDmg: ",d:damage); } //PrintBold(d:damage);

 // [STRIFE] Stamina Upgrades
 previousdamage = damage;
 damage = (damage * (4 + (MiscellaneousVars[317] * 3)) / 4);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StaminaDmg: ",d:damage,s:" StamUpgrades: ",d:MiscellaneousVars[317],s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Strength Stat Check
 previousdamage = damage;
 for (strengthcounter = 0; strengthcounter < MiscellaneousVars[35]; strengthcounter++)
 {
  if (CharacterClass == 0) damage += random(2,8); // 2.5x
  if (CharacterClass == 1) damage += random(2,5); // 2.5x
  if (CharacterClass == 2) damage += random(3,9); // 4.25x
  if (CharacterClass == 9) damage += random(4,12); //
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StrDmg: ",d:damage,s:" - (Strength: ",d:MiscellaneousVars[35],s:")",s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Reduce Check
 previousdamage = damage;
 if (altfire == 0) damage = (damage * random(5,6)) / 5;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"ReduceDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 
 // Berserk Check
 previousdamage = damage;
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) damage = damage * 10;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"BerserkDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);

 // Flora Armor Checks
 previousdamage = damage;
 if (CharacterClass == 2) 
 {
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) Damage = Damage * 4 / 3; // +33.3~% Kick Damage
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) Damage = Damage * 7 / 4; // +75% Kick Damage
  if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"FloArmorDmg: ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")"); } //PrintBold(d:damage);
 }

 int PerkFactor;
 int temp1, temp2;

 previousdamage = damage;
 if (shockwave > 0)
 {
  if (altfire == 0) damage = damage / 6;
  if (altfire == 1) damage = damage / 5;

  if (MiscellaneousVars[10035] > 0)
  {
   temp1 = 0;
   if (MiscellaneousVars[10035] == 1) temp1 = 75;
   if (MiscellaneousVars[10035] == 2) temp1 = 225;
   if (MiscellaneousVars[10035] == 3) temp1 = 525;
   if (MiscellaneousVars[10035] == 4) temp1 = 1125;
   if (MiscellaneousVars[10035] >= 5) temp1 = 3375;
   temp2 = 0;
   if (MiscellaneousVars[10036] == 1) temp2 = 1500;
   if (MiscellaneousVars[10036] == 2) temp2 = 3000;
   PerkFactor = 1000 + (temp1 + temp2);
   damage = damage * PerkFactor / 1000;
   if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Martial Arts Mastery Perk (Shockwave)]");
  }
 }
 else
 {
  if (MiscellaneousVars[10035] > 0)
  {
   temp1 = 0;
   if (MiscellaneousVars[10035] == 1) temp1 = 25;
   if (MiscellaneousVars[10035] == 2) temp1 = 75;
   if (MiscellaneousVars[10035] == 3) temp1 = 175;
   if (MiscellaneousVars[10035] == 4) temp1 = 375;
   if (MiscellaneousVars[10035] >= 5) temp1 = 1125;
   temp2 = 0;
   if (MiscellaneousVars[10036] == 1) temp2 = 500;
   if (MiscellaneousVars[10036] == 2) temp2 = 1000;
   PerkFactor = 1000 + (temp1 + temp2);
   damage = damage * PerkFactor / 1000;
   if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"MeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Martial Arts Mastery Perk (Non-Shockwave)]");
  }
 }

 previousdamage = damage;
 if (altfire == 0) damage = damage;
 if (altfire == 1) damage = damage / 4;
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 0) PrintBold(s:"MeleeDmgAltCheck: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Kick]");
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 1) PrintBold(s:"MeleeDmgAltCheck: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Roundhouse Kick]");

 // StamUp Check
 if (MiscellaneousVars[10005] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10005] * 30) + (MiscellaneousVars[10006] * 75)) + 400;
  damage = damage * PerkFactor / 400;
 }

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 0) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Kick]");
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0 && altfire == 1) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage,s:" - (Previous Dmg: ",d:previousdamage,s:")",s:" [Roundhouse Kick]");
 SetResultValue(damage);
}

script "EnemyRailgunDamage" (int base)
{
 int damage = base;
 int charge = CheckInventory("RailgunCharge");
 int chargefactor = ( ( (CheckInventory("RailgunCharge") * 2) + (CheckInventory("RailgunCharge") / 3) ) * 10 );
 damage = damage * chargefactor / 100;
 if (damage < 1) damage = 1;
 if (GetCVar("dvdsdebug_showmiscdmginformation") > 0) PrintBold(s:"Damage: ",d:damage,s:" [Base: ",d:base,s:"] [Charge: ",d:charge,s:"% / ",d:chargefactor,s:"]");
 SetResultValue(damage);
}

script "GetRailgunPDuration" (int base, int buildup)
{
 int sparsity = base;
 int sparsityadd = (CheckInventory("RailgunCharge") * buildup / 5);
 sparsity += sparsityadd;
 SetResultValue(sparsity);
 if (GetCVar("dvdsdebug_accuracyspreadisplay") > 0 && ActivatorTID() == Player1TID) PrintBold(s:"Sparsity: ",f:sparsity);
}

script "GetRailgunSparsity" (int type)
{
 int sparsity = 1.0;
 int sparsityadd = 0.01 * CheckInventory("RailgunCharge");
 sparsity += sparsityadd;

 if (GetCVar("dvdsdebug_accuracyspreadisplay") > 0 && ActivatorTID() == Player1TID) PrintBold(s:"Sparsity: ",f:sparsity);
 sparsity = sparsity>>16;
 SetResultValue(sparsity);
}

script "GetRailgunDriftSpeed" (int type)
{
 int driftspeed = 1.0;
 int driftspeedadd = 0.005 * CheckInventory("RailgunCharge");
 driftspeed += driftspeedadd;

 if (GetCVar("dvdsdebug_accuracyspreadisplay") > 0 && ActivatorTID() == Player1TID) PrintBold(s:"DriftSpeed: ",f:driftspeed);
 driftspeed = driftspeed>>16;
 SetResultValue(driftspeed);
}


script "GetHitScanXSpread" (int type)
{
 int spread = 0.0;
 int spreadfactor = 1.0;
 if (type == 1) // Pistol [Single]
 {
  spread = 5.6;
  spreadfactor = 1.0 - ((MiscellaneousVars[10019] * 0.1) + (MiscellaneousVars[10020] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 2) // Pistol [Dual]
 {
  spread = 6.0;
  spreadfactor = 1.0 - ((MiscellaneousVars[10019] * 0.1) + (MiscellaneousVars[10020] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 3) // Shotgun
 {
  spread = 5.6;
  spreadfactor = 1.0 - ((MiscellaneousVars[10021] * 0.1) + (MiscellaneousVars[10022] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 4) // Super Shotgun
 {
  spread = 11.2;
  spreadfactor = 1.0 - ((MiscellaneousVars[10021] * 0.1) + (MiscellaneousVars[10022] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 5) // Plasma Repeater
 {
  spread = 5.0;
  spreadfactor = 1.0 - ((MiscellaneousVars[10023] * 0.1) + (MiscellaneousVars[10024] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 6) // Strife's Electric Arrows
 {
  spread = 5.625;
  spreadfactor = 1.0 - ((MiscellaneousVars[318] * 0.1));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 7) // Strife's Poison Arrows
 {
  spread = 5.625;
  spreadfactor = 1.0 - ((MiscellaneousVars[318] * 0.1));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 8) // RocketLauncher Burst Mode
 {
  spread = 3.75;
  spreadfactor = 1.0 - ((MiscellaneousVars[10025] * 0.1) + (MiscellaneousVars[10026] * 0.25));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 9) // PlasmaRifle Burst Mode
 {
  spread = 7.5;
  spreadfactor = 1.0 - ((MiscellaneousVars[10023] * 0.1) + (MiscellaneousVars[10024] * 0.25));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 10) // Grenades [Burst Mode]
 {
  spread = 7.5;
  spreadfactor = 1.0 - ((MiscellaneousVars[10025] * 0.1) + (MiscellaneousVars[10026] * 0.25));
  spread = FixedMul(spread,spreadfactor);
 }

 // Special
 if (type == 101) // Strife Rebel Shots [checking player's accuracy to set their own] :V
 {
  spread = 8.0;
  spreadfactor = 1.0 - (MiscellaneousVars[318] * 0.1);
  spread = FixedMul(spread,spreadfactor);
 } 

 if (GetCVar("dvdsdebug_accuracyspreadisplay") > 0) PrintBold(f:spread,s:" / ",f:spreadfactor);
 spread = spread>>16;
 SetResultValue(spread);
}

script "GetHitScanYSpread" (int type)
{
 int spread = 0.0;
 int spreadfactor = 1.0;
 if (type == 1) // Pistol [Single]
 {
  spread = 0.0;
  spreadfactor = 1.0 - ((MiscellaneousVars[10019] * 0.1) + (MiscellaneousVars[10020] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 2) // Pistol [Dual]
 {
  spread = 0.4;
  spreadfactor = 1.0 - ((MiscellaneousVars[10019] * 0.1) + (MiscellaneousVars[10020] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 3) // Shotgun
 {
  spread = 0.0;
  spreadfactor = 1.0 - ((MiscellaneousVars[10021] * 0.1) + (MiscellaneousVars[10022] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 4) // Super Shotgun
 {
  spread = 7.1;
  spreadfactor = 1.0 - ((MiscellaneousVars[10021] * 0.1) + (MiscellaneousVars[10022] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }
 if (type == 5) // Plasma Repeater
 {
  spread = 4.0;
  spreadfactor = 1.0 - ((MiscellaneousVars[10023] * 0.1) + (MiscellaneousVars[10024] * 0.15));
  spread = FixedMul(spread,spreadfactor);
 }

 // Special
 if (type == 101) // Strife Rebel Shots [checking player's accuracy to set their own] :V
 {
  spread = 0.0;
  spreadfactor = 1.0 - (MiscellaneousVars[318] * 0.1);
  spread = FixedMul(spread,spreadfactor);
 } 

 if (GetCVar("dvdsdebug_accuracyspreadisplay") > 0) PrintBold(f:spread,s:" / ",f:spreadfactor);
 spread = spread>>16;
 SetResultValue(spread);
}

script "GetBFGTracerAngle" (void)
{
 int result = 90;
 if (MiscellaneousVars[10029] >= 1) result += 22;
 if (MiscellaneousVars[10029] >= 2) result += 23;
 if (MiscellaneousVars[10030] >= 1) result += 33;
 if (MiscellaneousVars[10030] >= 2) result += 34;
 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"BFG Tracer Angle: ",d:result);
 SetResultValue(result);
}

script "GetBFGTracerVAngle" (void)
{
 int result = 32;
 if (MiscellaneousVars[10029] >= 1) result += 8;
 if (MiscellaneousVars[10029] >= 2) result += 8;
 if (MiscellaneousVars[10030] >= 1) result += 12;
 if (MiscellaneousVars[10030] >= 2) result += 12;
 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"BFG Tracer Vertical Angle: ",d:result);
 SetResultValue(result);
}

script "GetBFGTracerRange" (void)
{
 int result = 1024;
 if (MiscellaneousVars[10029] >= 1) result += 256;
 if (MiscellaneousVars[10029] >= 2) result += 256;
 if (MiscellaneousVars[10030] >= 1) result += 384;
 if (MiscellaneousVars[10030] >= 2) result += 384;
 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"BFG Tracer Range: ",d:result);
 SetResultValue(result);
}

script "GetBFGTracers" (void)
{
 int result = 40;
 if (MiscellaneousVars[10029] >= 1) result += 8;
 if (MiscellaneousVars[10029] >= 2) result += 8;
 if (MiscellaneousVars[10030] >= 1) result += 12;
 if (MiscellaneousVars[10030] >= 2) result += 12;
 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"BFG Tracers: ",d:result);
 SetResultValue(result);
}

script "GetGFXEffectLevel" (void)
{
 SetResultValue(GetCVar("dvds_gfxeffectlevel"));
}

// Returns Damage inflicted by certain player attacks
script "GetPlayerATKDMG" (int type, int puff)
{
 // MiscellaneousVars[31] = Agility
 // MiscellaneousVars[32] = Defense
 // MiscellaneousVars[33] = Deftness
 // MiscellaneousVars[34] = Sorcery
 // MiscellaneousVars[35] = Strength
 // MiscellaneousVars[36] = Therapeusis
 int damage, extradmg1, extradmg2, extradmg3, extradmg4, extradmg5, extradmg6, finaldmg;
 int rand1, rand2;
 int flagchecktype = 0;
 int perkfactor = 10000;
 int chargefactor = 10000;
 int playershot = 0;
 perkfactor = 10000;
 if (type == 1) // Pistol [Single]
 {
  perkfactor += ((MiscellaneousVars[10019] * 200) + (MiscellaneousVars[10020] * 1000));
  damage = random(1,4) * random(5,7); // 5 to 28
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 3) / 4; // 75% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 7) / 40; // 17.5% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 2) // Pistol [Dual]
 {
  perkfactor += ((MiscellaneousVars[10019] * 200) + (MiscellaneousVars[10020] * 1000));
  damage = random(2,4) * random(6,7); // 12 to 28
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 7) / 8; // 87.5% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 5; // 20% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 3) // Shotgun
 {
  perkfactor += ((MiscellaneousVars[10021] * 200) + (MiscellaneousVars[10022] * 1000));
  damage = random(2,3) * 5; // 10 to 15
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 1); // 100% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 7) / 80; // 8.75% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 4) // Super Shotgun
 {
  perkfactor += ((MiscellaneousVars[10021] * 200) + (MiscellaneousVars[10022] * 1000));
  damage = random(2,3) * random(5,6); // 10 to 18
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 5) / 4; // 125% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 8; // 12.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 5) // Chaingun
 {
  perkfactor += ((MiscellaneousVars[10019] * 200) + (MiscellaneousVars[10020] * 1000));
  damage = random(1,4) * random(5,7); // 5 to 28
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 7) / 8; // 87.5% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 5; // 20% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 6) // Minigun
 {
  perkfactor += ((MiscellaneousVars[10019] * 200) + (MiscellaneousVars[10020] * 1000));
  damage = random(2,4) * random(6,7); // 12 to 28
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 1); // 100% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 4; // 25% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 7) // Repeater
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(1,3) * 6; // 6 to 18
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 3) / 2; // 150% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 3) / 8; // 37.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 8) // Rocket [main hit]
 {
  perkfactor += ((MiscellaneousVars[10025] * random(700,1400)) + (MiscellaneousVars[10026] * random(1100,2200)));
  damage = random(1,8) * 20; // 20 to 160
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 5) / 2; // 250% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 9) / 8; // 112.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 9) // Rocket [explosion]
 {
  perkfactor += ((MiscellaneousVars[10025] * random(700,1400)) + (MiscellaneousVars[10026] * random(1100,2200)));
  damage = 128;
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 5) / 2; // 250% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 9) / 8; // 112.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 10) // Repeater [explosion]
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = 7; // 7
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 1) / 5; // 20% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 14; // 7.14% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 11) // Plasma
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(1,8) * 5; // 5 to 40
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 15) / 16; // 93.34% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 9) / 20; // 45% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 12) // Plasma1 [BFG2704]
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  perkfactor += ((MiscellaneousVars[10029] * 250) + (MiscellaneousVars[10030] * 1250));
  damage = random(1,8) * 4; // 4 to 32
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 1); // 100% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 11) / 20; // 55% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 13) // Plasma2 [BFG2704]
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  perkfactor += ((MiscellaneousVars[10029] * 250) + (MiscellaneousVars[10030] * 1250));
  damage = random(1,8) * 4; // 4 to 32
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 11) / 10; // 110% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 2; // 50% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 14) // BFG [Main]
 {
  damage = random(1,8) * 100; // 100 to 800
  if (MiscellaneousVars[10029] == 1) damage = random(4,17) * 50; // 200 to 850
  if (MiscellaneousVars[10029] == 2) damage = random(8,20) * 50; // 400 to 1000
  extradmg1 = (MiscellaneousVars[31] * 11); // 1100% of Agility
  if (MiscellaneousVars[10029] == 1) extradmg1 = (MiscellaneousVars[31] * 12); // 1200% of Agility
  if (MiscellaneousVars[10029] == 2) extradmg1 = (MiscellaneousVars[31] * 15); // 1500% of Agility
  extradmg2 = ((MiscellaneousVars[35] * 11) / 2); // 550% of Strength 
  if (MiscellaneousVars[10029] == 1) extradmg2 = ((MiscellaneousVars[35] * 12) / 2); // 600% of Strength 
  if (MiscellaneousVars[10029] == 2) extradmg2 = ((MiscellaneousVars[35] * 15) / 2); // 750% of Strength 
 }
 if (type == 15) // BFG [Tracer]
 {
  damage = random(1,8) + 15; // 16 to 23
  if (MiscellaneousVars[10029] == 1) damage = random(2,9) + 18; // 20 to 27
  if (MiscellaneousVars[10029] == 2) damage = random(3,10) + 22; // 25 to 32
  extradmg1 = (MiscellaneousVars[31] * 11) / 5; // 220% of Agility
  if (MiscellaneousVars[10029] == 1) extradmg1 = (MiscellaneousVars[31] * 12) / 5; // 240% of Agility
  if (MiscellaneousVars[10029] == 2) extradmg1 = (MiscellaneousVars[31] * 15) / 5; // 300% of Agility
  extradmg2 = (MiscellaneousVars[35] * 1); // 100% of Strength 
  if (MiscellaneousVars[10029] == 1) extradmg2 = ((MiscellaneousVars[35] * 7) / 4); // 175% of Strength 
  if (MiscellaneousVars[10029] == 2) extradmg2 = ((MiscellaneousVars[35] * 10) / 4); // 250% of Strength 
 }
 if (type == 16) // KSawBolt
 {
  perkfactor = 10000 + ((MiscellaneousVars[10027] * 2500) + (MiscellaneousVars[10028] * 3750));
  damage = random(1,8) * 12; // 12 to 96
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 11) / 5; // 220% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1); // 100% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 17) // KSawBolt
 {
  perkfactor = 10000 + ((MiscellaneousVars[10027] * 2500) + (MiscellaneousVars[10028] * 3750));
  damage = random(1,8) * 12; // 12 to 96
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 11) / 5; // 220% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1); // 100% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }

 if (type == 18) // DiarisHolyArrow [native]
 {
  perkfactor += ((MiscellaneousVars[10031] * random(900,1500)) + (MiscellaneousVars[10032] * random(3600,6000)));
  damage = 384 + random(-48,192); // 336 to 576 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 5); // 500% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 5; // 20% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;

  damage /= 4;
  extradmg1 /= 4;
  extradmg2 /= 4;
 }
 if (type == 19) // DiarisHolyArrow2XDmg [native]
 {
  perkfactor += ((MiscellaneousVars[10031] * random(900,1500)) + (MiscellaneousVars[10032] * random(3600,6000)));
  damage = 384 + random(-48,192); // 336 to 576 damage
  damage *= 2;
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 22 / 4); // 550% of Agility
  extradmg1 *= 2;
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 4; // 25% of Strength 
  extradmg2 *= 2;
  extradmg2 = extradmg2 * perkfactor / 10000;

  damage /= 4;
  extradmg1 /= 4;
  extradmg2 /= 4;
 }
 if (type == 20) // DiarisHolyArrow3XDmg [native]
 {
  perkfactor += ((MiscellaneousVars[10031] * random(900,1500)) + (MiscellaneousVars[10032] * random(3600,6000)));
  damage = 384 + random(-48,192); // 336 to 576 damage
  damage *= 3;
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 6); // 600% of Agility
  extradmg1 *= 3;
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 3) / 10; // 30% of Strength 
  extradmg2 *= 3;
  extradmg2 = extradmg2 * perkfactor / 10000;

  damage /= 4;
  extradmg1 /= 4;
  extradmg2 /= 4;
 }
 if (type == 21) // CrossbowFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10031] * 600) + (MiscellaneousVars[10032] * 2400));
  damage = 45 + random(-22,22); // 23 to 67 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[31] * 5) / 2); // 250% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[35] * 1) / 10); // 10% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 22) // CrossbowFX2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10031] * 600) + (MiscellaneousVars[10032] * 2400));
  damage = 27 + random(-13,13); // 14 to 40 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[31] * 3) / 2); // 150% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[35] * 3) / 50); // 6% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 23) // CrossbowFX3New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10031] * 600) + (MiscellaneousVars[10032] * 2400));
  damage = 9 + random(-4,4); // 5 to 13 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[31] * 1) / 2); // 50% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[35] * 1) / 50); // 2% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 24) // RipperNew [HERETIC]
 {
  // perkfactor += 0;
  damage = 1 * random(1,8);
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] / 16) * random(1,8)); // 6.7% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] / 64) * random(1,8)); // 1.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 25) // ElectricBoltNew [STRIFE]
 {
  perkfactor += ((MiscellaneousVars[10031] * 600) + (MiscellaneousVars[10032] * 2400));
  damage = 25 + random(-12,12); // 10 to 40 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 4) / 1; // 400% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 8; // 12.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 26) // PoisonBoltNew [STRIFE]
 {
  perkfactor += ((MiscellaneousVars[10031] * 600) + (MiscellaneousVars[10032] * 2400));
  damage = 25 + random(-12,12); // 10 to 40 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 4) / 1; // 400% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 1) / 8; // 12.5% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 27) // BlasterPuffNew [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 18 + random(-9,9); // 4 to 32 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 4); // 25% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 16); // 6.25% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 28) // BlasterFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 9 + random(-4,4); // 2 to 16 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 8); // 12.5% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 32); // 3.125% of Therapeusis
 }
 if (type == 29) // GoldWandPuff1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 8 + random(3,6);
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 4); // 25% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 10); // 10% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 30) // GoldWandPuff2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 5 + random(-3,3); // 1 to 8
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 6); // 16.67% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 15); // 6.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 31) // HornRodFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 14 + random(-7,8); // 7 to 22
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 6); // 16.67% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 24); // 4.1667% of Therapeusis
 }
 if (type == 32) // HornRodFX2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 45 + random(-22,22); // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 3); // 33.3% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 7); // 14.1414% of Therapeusis
 }
 if (type == 33) // PhoenixFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 45 + random(-22,22); // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 2) / 3); // 66.7% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 2) / 7); // 28.571% of Therapeusis
 }
 if (type == 34) // PhoenixFX2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 9 + random(-4,4); // 2 to 16 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 15); // 6.7% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 35); // 2.8571% of Therapeusis
 }
 if (type == 35) // MaceFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 9 + random(-4,4); // 2 to 16 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 15); // 6.7% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 36); // 2.7778% of Therapeusis
 }
 if (type == 36) // MaceFX2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 27 + random(-13,13); // 6 to 48
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 5); // 20% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 12); // 8.333% of Therapeusis
 }
 if (type == 37) // MaceFX3New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 18 + random(-9,9); // 4 to 32
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 10); // 10% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 24); // 4.1666% of Therapeusis
 }
 if (type == 38) // MaceFX4New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 96 + random(-48,-48); // 18 to 144
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 6) / 7); // 83.333% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 2) / 7); // 28.5714% of Therapeusis
 }
 if (type == 39) // Sorcerer2FX1Player [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 45 + random(-22,22); // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 3) / 2); // 150% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 4) / 7); // 57.142% of Therapeusis
 }
 if (type == 40) // Sorcerer2FX3 [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 45 + random(-22,22); // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 3) / 4); // 75% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 2) / 7); // 28.5714% of Therapeusis
 }
 if (type == 41) // GoldWandFX1New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 9 + random(-4,4); // 2 to 16 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 3); // 33.3% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 2) / 15); // 13.34% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 42) // GoldWandFX2New [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 5 + random(-3,3); // 1 to 8 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 6); // 16.67% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 15); // 6.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 43) // RainPillarNew [HERETIC]
 {
  perkfactor += ((MiscellaneousVars[10053] * 1000) + (MiscellaneousVars[10054] * 4000));
  damage = 23 + random(-11,11); // 12 to 34 damage
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] / 6); // 16.67% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] / 15); // 6.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 44 || type == 45) // MageWandMissileNew & MageWandMissile2New
 {
  perkfactor += ((MiscellaneousVars[10053] * 1250) + (MiscellaneousVars[10054] * 5000));
  damage = (6 + random(-3,3)) + random(-MiscellaneousVars[10053],MiscellaneousVars[10053]);
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 5) / 8); // 62.5% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 1) / 6); // 16.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 46) // HubbleBubbleSmall [main]
 {
  perkfactor += ((MiscellaneousVars[10053] * 2000) + (MiscellaneousVars[10054] * 8000));
  damage = (22 + random(-7,8));
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 20) / 4); // 500% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 4) / 3); // 133.33% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 47) // HubbleBubbleLarge [main]
 {
  perkfactor += ((MiscellaneousVars[10053] * 2000) + (MiscellaneousVars[10054] * 8000));
  damage = (67 + random(-22,23));
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 60) / 4); // 1500% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 12) / 3); // 400% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 48) // A. Christina Blast
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(176,293);//234); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 49) // A. Christina Long Range Blast (Weak)
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(54,91);//125); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 50) // Unmaker Laser (Marines & Petra)
 {
  perkfactor += ((MiscellaneousVars[10003] * 750) + (MiscellaneousVars[10004] * 1875));
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  perkfactor += ((MiscellaneousVars[10029] * 250) + (MiscellaneousVars[10030] * 1250));
  damage = random(1,8) * 10; // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 1); // 100% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 10) / 20; // 50% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 51) // Unmaker Laser (Flora & Ailish)
 {
  perkfactor += ((MiscellaneousVars[10003] * 750) + (MiscellaneousVars[10004] * 1875));
  perkfactor += ((MiscellaneousVars[10033] * 250) + (MiscellaneousVars[10034] * 1250));
  perkfactor += ((MiscellaneousVars[10053] * 500) + (MiscellaneousVars[10054] * 2500));
  damage = random(1,8) * 10; // 10 to 80
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 1); // 100% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] * 10) / 20; // 50% of Therapeusis 
  extradmg2 = extradmg2 * perkfactor / 10000;
 } 
 if (type == 52) // Hell Warrior Shield Fireball
 {
  perkfactor += ((MiscellaneousVars[10003] * 750) + (MiscellaneousVars[10004] * 1875)); // MagiUp
  perkfactor += ((MiscellaneousVars[10033] * 500) + (MiscellaneousVars[10004] * 1250)); // Soul Mastery
  perkfactor += ((MiscellaneousVars[10053] * 500) + (MiscellaneousVars[10054] * 1250)); // Wand/Staff Mastery
  damage = random(1,8) * 2; // 2 to 16
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 4) / 5; // 80.0% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[36] * 4) / 10; // 40.0% of Therapeusis 
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 53) // A. Christina Long Range Blast (Normal)
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(136,228);//182); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 54) // A. Christina Long Range Blast (Finale)
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(340,570); //353); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 55) // A. Christina Bouncing Shot (Weak)
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = (random(54,90) / 6);//353); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 56) // A. Christina Bouncing Shot (Normal)
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = (random(135,225) / 6);//353); //
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[34] * 3); // 300% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 2); // 200% of Strength
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 57) // CStaffMissileNew (Serpent Staff projectile)
 {
  perkfactor += ((MiscellaneousVars[10053] * 1250) + (MiscellaneousVars[10054] * 5000));
  damage = (random(1,8) * 5) + random(-MiscellaneousVars[10053],MiscellaneousVars[10053]);
  damage = damage * perkfactor / 10000;
  extradmg1 = ((MiscellaneousVars[34] * 5) / 8); // 62.5% of Sorcery
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = ((MiscellaneousVars[36] * 1) / 6); // 16.67% of Therapeusis
  extradmg2 = extradmg2 * perkfactor / 10000;
 }
 if (type == 58) // Railgun [Player]
 {
  perkfactor += ((MiscellaneousVars[10023] * 200) + (MiscellaneousVars[10024] * 1000));
  damage = random(9,11) * 5; // 45 to 55
  damage = damage * perkfactor / 10000;
  extradmg1 = (MiscellaneousVars[31] * 15) / 8; // 187.5% of Agility
  extradmg1 = extradmg1 * perkfactor / 10000;
  extradmg2 = (MiscellaneousVars[35] * 18) / 20; // 90% of Strength 
  extradmg2 = extradmg2 * perkfactor / 10000;

  chargefactor = ( ( (CheckActorInventory(Player1TID,"RailgunCharge") * 2) + (CheckActorInventory(Player1TID,"RailgunCharge") / 3) ) * 10 );
  damage = damage * chargefactor / 100;
  extradmg1 = extradmg1 * chargefactor / 100;
  extradmg2 = extradmg2 * chargefactor / 100;
  playershot += 1;
 }

 if (IsPointerEqual(AAPTR_TARGET, AAPTR_PLAYER1) == TRUE || puff == 1) playershot += 1; // AAPTR_TARGET - the being who fires the shot
 if (playershot > 0)
 {
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Player Shot");

  if (type == 45) // Reduce Sapphire Alt-Fire damage by 33%
  {
   damage = (damage * 2) / 3;
   extradmg1 = (extradmg1 * 2) / 3;
   extradmg2 = (extradmg2 * 2) / 3;
   extradmg3 = (extradmg3 * 2) / 3;
   extradmg4 = (extradmg4 * 2) / 3;
   extradmg5 = (extradmg5 * 2) / 3;
   extradmg6 = (extradmg6 * 2) / 3;
  }

  rand1 = (extradmg1 + extradmg2 + extradmg3 + extradmg4 + extradmg5 + extradmg6) * 4 / 5;
  rand2 = (extradmg1 + extradmg2 + extradmg3 + extradmg4 + extradmg5 + extradmg6) * 6 / 5;
  finaldmg = damage + random(rand1,rand2);

  int misc1 = 1000;
  if (type == 29 || type == 30 || type == 31 || type == 32 || type == 41 || type == 42 || type == 44 || type == 45 || type == 51 || type == 52)
  {
   if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) misc1 += 125;
   if (CheckActorInventory(Player1TID,"BalrogRing") > 0) misc1 += 125;
   finaldmg = (finaldmg * misc1) / 1000;
  }

  int misc2 = 1000;
  if (type == 52)
  {
   if (CheckActorInventory(Player1TID,"SauronHelmet") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"SauronGauntlets") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"SauronGauntletsIllucia") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"SauronGauntletsFlora") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"SauronGauntletsAilish") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"SauronGauntletsPetra") > 0) misc2 += 125;
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0) misc2 += 500;
   finaldmg = (finaldmg * misc2) / 1000;
  }
  
  str actorname = GetActorClass(0);
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
  {
   PrintBold(s:"Actor Class: ",s:actorname,
             s:"\nBType#: ",d:type,
             s:"\nBPuff?: ",d:puff,
             s:"\n",
             s:"\nBase: ",d:damage,
             s:"\nExtra1: ",d:extradmg1,
             s:"\nExtra2: ",d:extradmg2,
             s:"\nExtra3: ",d:extradmg3,
             s:"\nExtra4: ",d:extradmg4,
             s:"\nExtra5: ",d:extradmg5,
             s:"\nExtra6: ",d:extradmg6,
             s:"\nRandom: ",d:rand1,s:" - ",d:rand2,
             s:"\nPerkFactor: ",d:perkfactor,
             s:"\nChargeFactor: ",d:chargefactor,
             s:"\n",
             s:"\nMisc1: ",d:misc1,
             s:"\nMisc2: ",d:misc2,
             s:"\nTotal: ",d:finaldmg);
  }
 }
 else // Not the player
 {
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1) PrintBold(s:"Non-Player Shot");
  finaldmg = damage;
  
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
  {
   PrintBold(s:"Actor Class: ",s:actorname,
             s:"\n",
             s:"\nBase: ",d:damage,
             s:"\nTotal: ",d:finaldmg);
  }
 }

 if (CheckActorInventory(Player1TID,"DodgeMeleeBoost") > 0)
 {
  int preboostdmg = finaldmg;
  finaldmg = finaldmg * 11 / 10;
  if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
  {
  PrintBold(s:"PreBoost: ",d:preboostdmg,
            s:"\nTotal: ",d:finaldmg);
  }
 }
 SetResultValue(finaldmg);
}

script "GetSapphireWandAltSpread" (int type)
{
 int result = 400;
 if (MiscellaneousVars[10053] == 1) result = result * 5 / 6;
 if (MiscellaneousVars[10053] == 2) result = result * 4 / 6;
 if (MiscellaneousVars[10053] == 3) result = result * 3 / 6;
 if (MiscellaneousVars[10053] == 4) result = result * 2 / 6;
 if (MiscellaneousVars[10053] == 5) result = result * 1 / 6;
 if (type == -1) result *= -1;
 SetResultValue(result);
}

// Returns Damage inflicted by misc attacks
script "GetMiscDMG" (int type)
{
 int damage;
 int actorname = GetActorClass(0);

 if (type == 1) // Minor Magic Missile [particle]
 {
  if (random(1,1000) > 667) damage = (1 + random(-1,0));
                       else damage = (2 + random(-1,1));
 }

 if (type == 2) // Magic Missile [particle]
 {
  if (random(1,1000) > 667) damage = (4 + random(-1,2));
                       else damage = (12 + random(-3,3));
 }

 if (type == 3) // Major Magic Missile [particle]
 {
  if (random(1,1000) > 667) damage = (18 + random(-3,4));
                       else damage = (30 + random(-7,8));
 }

 if (type == 4) // Ultra Magic Missile [particle]
 {
  if (random(1,1000) > 667) damage = (54 + random(-13,14));
                       else damage = (90 + random(-22,23));
 }

 if (GetCVar("dvdsdebug_showmiscdmginformation") > 0) PrintBold(s:"MM Particle Dmg: (",s:actorname,s:") ",d:damage);
 SetResultValue(damage);
}

// Returns Chainsaw Damage
script "GetChainsawDamage" (int sawtype)
{
 int damage;
 int PerkFactor;
 SetActivator(Player1TID);
 str weapon = GetWeapon();
 SetActivator(0);

 if (sawtype <= 1) // Normal Chainsaw
 {
  damage = ((2 + (MiscellaneousVars[35] / 10)) * random(1,10)); // 2 - 20 + (Strength * 10%)
 }
 if (sawtype >= 2) // Double-Bladed Chainsaw
 {
  damage = (((9 / 2) + (MiscellaneousVars[35] * 9 / 40)) * random(3,12)); // 13.5 - 54 + (Strength * 22.5%)
 }
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"BaseDmg: (",s:weapon,s:") ",d:damage);

 // [STRIFE] Stamina Upgrades
 damage = (damage * (3 + MiscellaneousVars[317]) / 3);
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) { PrintBold(s:"StaminaDmg: ",d:damage,s:" StamUpgrades: ",d:MiscellaneousVars[317]); }

 // Berserk Check
 if (CheckActorInventory(Player1TID,"PowerStrength") > 0) damage = damage * 7 / 4; // 175% Damage when Berserked
 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"BerserkMeleeDmg: (",s:weapon,s:") ",d:damage);

 // StamUp Check
 if (MiscellaneousVars[10005] > 0)
 {
  PerkFactor = ((MiscellaneousVars[10005] * 30) + (MiscellaneousVars[10006] * 75)) + 400;
  damage = damage * PerkFactor / 400;
 }

 if (GetCVar("dvdsdebug_showmeleeinformation") > 0) PrintBold(s:"FinalMeleeDmg: (",s:weapon,s:") ",d:damage);
 SetResultValue(damage);
}

// Damage Indicators
function int pow (int x, int n)
{
 int y = 1;
 while (n-- > 0) y *= x;
 return y;
}

function int GetDigit(int Num, int Digit) 
{
 return (Num / pow(10, Digit)) % 10 ;
}

// For Monsters/Non-Players
script "DamageDisplays" (void)
{
 int healpalused;
 int dmgpalused;
 int critdmgpalused;
 int xpos, ypos, zpos;
 int PlayerCrit;
 int dmgind_delay = GetCVAR("dvds_dmgind_delay");
 if (dmgind_delay < 1) dmgind_delay = 1;
 if (dmgind_delay > 35) dmgind_delay = 35;
 while (GetCVar("dvds_dmgindicator") == 1)
 {
  if (CheckInventory("MonsterDisplayDMG") == 0) terminate;
  int ActorWidth = GetActorProperty(0,APROP_Radius);
  int ActorHeight = GetActorProperty(0,APROP_Height);
  int PreviousHealth = GetActorProperty(0,APROP_Health);

  int totaldelay = ((1 + (GetLevelInfo(LEVELINFO_TOTAL_MONSTERS) / 160) ) * dmgind_delay);
  if (GetCVar("dvds_gfxeffectlevel") == 0) totaldelay *= 1;
  else if (GetCVar("dvds_gfxeffectlevel") == 1) totaldelay *= 4;
  else if (GetCVar("dvds_gfxeffectlevel") == 2) totaldelay *= 16;
  delay(totaldelay); // 1
  If (GetActorProperty(0,APROP_Health) != PreviousHealth)
  {
	 PlayerCrit = 0;
     if (CheckInventory("TookCriticalHit") > 0) 
	 {
	  PlayerCrit = 1;
	  TakeInventory("TookCriticalHit",0x7FFFFFFF);
	 }
     if (GetCVar("dvdsdebug_showcriticalhitstuff") > 0 && PlayerCrit > 0) PrintBold(s:"PLAYER CRITICAL HIT");

     int DmgIndDisplayValue = PreviousHealth - GetActorProperty(0,APROP_Health);
     int DmgIndDisplayType;

     DmgIndDisplayType = 0; // 0 = Damage, 1 = Healing.
     If (DmgIndDisplayValue < 0)
     {
      DmgIndDisplayValue *= -1;
      DmgIndDisplayType = 1;
     }

     if (DmgIndDisplayValue > 9999999) DmgIndDisplayValue = 9999999;

     If (DmgIndDisplayValue > 0)
     {
      int Digit1 = GetDigit(DmgIndDisplayValue, 0);
      int Digit2 = GetDigit(DmgIndDisplayValue, 1);
      int Digit3 = GetDigit(DmgIndDisplayValue, 2);
      int Digit4 = GetDigit(DmgIndDisplayValue, 3);
      int Digit5 = GetDigit(DmgIndDisplayValue, 4);
      int Digit6 = GetDigit(DmgIndDisplayValue, 5);
      int Digit7 = GetDigit(DmgIndDisplayValue, 6);
      int DigitBG;

      int WidthPos = ActorWidth / 2;
      int WidthNeg = ActorWidth * -1 / 2;
      int x = GetActorX(0) + random(WidthNeg,WidthPos);
      int y = GetActorY(0) + random(WidthNeg,WidthPos);
      int z;
      If (ActorHeight > 0) 
          z = GetActorZ(0) + ActorHeight + Random(-4.0,4.0);
      else
          z = GetActorZ(0) + GetActorProperty(0, APROP_HEIGHT) + Random(-4.0,4.0);

      int NumberID = Random(7000, 8000);
      int NumberID2 = NumberID + 1;
      str DigitSpawn;

      //DmgIndDisplayType = 1;
      if (DmgIndDisplayType == 1) // Healing
      {
       if (DmgIndDisplayValue >= 0) DigitSpawn = StrParam(s:"HealBurst1");
       if (DmgIndDisplayValue >= 10) DigitSpawn = StrParam(s:"HealBurst2");
       if (DmgIndDisplayValue >= 100) DigitSpawn = StrParam(s:"HealBurst3");
       if (DmgIndDisplayValue >= 1000) DigitSpawn = StrParam(s:"HealBurst4");
       if (DmgIndDisplayValue >= 10000) DigitSpawn = StrParam(s:"HealBurst5");
       if (DmgIndDisplayValue >= 100000) DigitSpawn = StrParam(s:"HealBurst6");
       if (DmgIndDisplayValue >= 1000000) DigitSpawn = StrParam(s:"HealBurst7");
      }
      else // Damage
      {
       if (PlayerCrit > 0)
       {
        if (DmgIndDisplayValue >= 0) DigitSpawn = StrParam(s:"DamageBurstCritical1");
        if (DmgIndDisplayValue >= 10) DigitSpawn = StrParam(s:"DamageBurstCritical2");
        if (DmgIndDisplayValue >= 100) DigitSpawn = StrParam(s:"DamageBurstCritical3");
        if (DmgIndDisplayValue >= 1000) DigitSpawn = StrParam(s:"DamageBurstCritical4");
        if (DmgIndDisplayValue >= 10000) DigitSpawn = StrParam(s:"DamageBurstCritical5");
        if (DmgIndDisplayValue >= 100000) DigitSpawn = StrParam(s:"DamageBurstCritical6");
        if (DmgIndDisplayValue >= 1000000) DigitSpawn = StrParam(s:"DamageBurstCritical7");
       }
       else
       {
        if (DmgIndDisplayValue >= 0) DigitSpawn = StrParam(s:"DamageBurst1");
        if (DmgIndDisplayValue >= 10) DigitSpawn = StrParam(s:"DamageBurst2");
        if (DmgIndDisplayValue >= 100) DigitSpawn = StrParam(s:"DamageBurst3");
        if (DmgIndDisplayValue >= 1000) DigitSpawn = StrParam(s:"DamageBurst4");
        if (DmgIndDisplayValue >= 10000) DigitSpawn = StrParam(s:"DamageBurst5");
        if (DmgIndDisplayValue >= 100000) DigitSpawn = StrParam(s:"DamageBurst6");
        if (DmgIndDisplayValue >= 1000000) DigitSpawn = StrParam(s:"DamageBurst7");
       }
      }
      Spawn(DigitSpawn, x, y, z, NumberID, 0);


      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit1Num", d:Digit1); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical1Num", d:Digit1); else DigitSpawn = StrParam(s:"DmgDigit1Num", d:Digit1); } // Damage
      if (DmgIndDisplayValue >= 0) Spawn(DigitSpawn, x, y, z, NumberID2, 0);

      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit2Num", d:Digit2); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical2Num", d:Digit2); else DigitSpawn = StrParam(s:"DmgDigit2Num", d:Digit2); } // Damage
      if (DmgIndDisplayValue >= 10) Spawn(DigitSpawn, x, y, z, NumberID2, 0);

      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit3Num", d:Digit3); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical3Num", d:Digit3); else DigitSpawn = StrParam(s:"DmgDigit3Num", d:Digit3); } // Damage
      if (DmgIndDisplayValue >= 100) Spawn(DigitSpawn, x, y, z, NumberID2, 0);

      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit4Num", d:Digit4); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical4Num", d:Digit4); else DigitSpawn = StrParam(s:"DmgDigit4Num", d:Digit4); } // Damage
      if (DmgIndDisplayValue >= 1000) Spawn(DigitSpawn, x, y, z, NumberID2, 0);

      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit5Num", d:Digit5); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical5Num", d:Digit5); else DigitSpawn = StrParam(s:"DmgDigit5Num", d:Digit5); } // Damage
      if (DmgIndDisplayValue >= 10000) Spawn(DigitSpawn, x, y, z, NumberID2, 0);

      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit6Num", d:Digit6); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical6Num", d:Digit6); else DigitSpawn = StrParam(s:"DmgDigit6Num", d:Digit6); } // Damage
      if (DmgIndDisplayValue >= 100000) Spawn(DigitSpawn, x, y, z, NumberID2, 0);
	  
      if (DmgIndDisplayType == 1) DigitSpawn = StrParam(s:"HealDigit7Num", d:Digit7); // Healing
	  else { if (PlayerCrit > 0)  DigitSpawn = StrParam(s:"DigitCritical7Num", d:Digit7); else DigitSpawn = StrParam(s:"DmgDigit7Num", d:Digit7); } // Damage
      if (DmgIndDisplayValue >= 1000000) Spawn(DigitSpawn, x, y, z, NumberID2, 0);
	  
	  int xvel, yvel, zvel;
      if (PlayerCrit > 0)
      {
       PlaySound(Player1TID,"player/criticalhit",CHAN_BODY,1.0,0,ATTN_NORM);
       if (DmgIndDisplayType == 1) { xvel = random(-1.0,1.0); yvel = random(-1.0,1.0); zvel = random(0.25,0.5); } // Healing cannot be critical'd
	   else { xvel = random(-0.5,0.5); yvel = random(-0.5,0.5); zvel = random(-0.50,-0.25); }
      }
      else
      {
	   xvel = random(-1.0,1.0); yvel = random(-1.0,1.0); zvel = random(0.25,0.5);
      }
      SetActorVelocity(NumberID, xvel, yvel, zvel, 0, 0);
      SetActorVelocity(NumberID2, xvel, yvel, zvel, 0, 0);
     }
  }
  else
  {
   if (CheckInventory("TookCriticalHit") > 0) { TakeInventory("TookCriticalHit",0x7FFFFFFF); PlayerCrit = 0; }
  }
 }
}

// Used by DECORATE to check for the player's crit item
script "CheckCritRate" (void)
{
 if (CheckActorInventory(Player1TID,"DealCriticalHit") > 0) SetResultValue(1); else SetResultValue(0);
}

// Used for testing SetHudSize customization in-game.
script "TestHudSize" (int screenX, int screenY, int usehud)
{
 MiscellaneousVars[76] = screenX;
 MiscellaneousVars[77] = screenY;
 MiscellaneousVars[78] = usehud;
}

// Used for testing coordinate/alignments on specfic "HudMessage" usages in-game.
script "TestHudAlign" (int X, int Y, int X2, int Y2)
{
 X *= 1.0;
 Y *= 1.0;
 X2 *= 0.1;
 Y2 *= 0.1;
 MiscellaneousVars[74] = X + X2;
 MiscellaneousVars[75] = Y + Y2;
 Print(f:X,s:" ",f:Y,s:" ",f:X2,s:" ",f:Y2);
}

// Test Script for Toggling pages for armor display lists
script "ChangeArmorPage" (int Page)
{
 MiscellaneousVars[55] += Page;
}

/*
   HudMessage IDs:
   901		-	Main List for Armor Display Menu
   902		-	Top Line for Armor Display Menu
   903		-	Armor Icon
   904		-	Background Tint for Menus/Armor-Display
*/
// Show Armor Stats
script "ShowArmorStats" ENTER
{
 int misc1, misc2, misc3, misc4, misc5;
 str ArmorString1, ArmorString2, ArmorString3, ArmorString4, ArmorString5, ArmorString6, ArmorString7, ArmorString8, ArmorString9, ArmorString10, ArmorString11, ArmorString12, ArmorString13, ArmorString14, ArmorString15, ArmorString16, ArmorString17, ArmorString18, ArmorString19, ArmorString20;
 str DivineShieldString1, DivineShieldString2;

 // [55] is the Armor Page to display
 if (MiscellaneousVars[55] != 0)
 {
  SetHudSize(512,384,0); // SetHudSize(MiscellaneousVars[76],MiscellaneousVars[77],MiscellaneousVars[78]);
  // Checks the Armor Info/Durability of the Marine's armor only.
  if (MiscellaneousVars[55] == 1) // Current Armor [Deggaris and Illucia only]
  {
   if (CharacterClass == 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CurrentArmorClass == 0) MiscellaneousVars[55] += 1;
    if (CurrentArmorClass == 1)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+2.5% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+3.75% Chance of Not Consuming Ammo\n";

     SetFont("ARM1A1");
     HudMessage(s:"A"; 0, 903, 0, 210.0, 50.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Green Armor"; 0, 902, CR_WHITE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+33.3% Normal Damage Protection\n",
                s:"\cd+2.5% Unbreakable Damage Protection\n",
                s:"\cd+35% Total Damage Protection\n",
                s:"Up to 100 Durability Points\n",
                s:"\cd+15% Bullet Resistance\n",

                s:"\cd+2% Fire Resistance\n",
                s:"\cd+1% Explosive Resistance\n",
                s:"\cg-4% Maximum Mana Regeneration Rate\n",
                s:"\cd+1.2% Stamina Regeneration\n",
                s:"\cd+(4 + 1%) Balance\n",

                s:"\cd+0.5% Survival Chance\n",
                s:"\cg-3.3% Jump Strength\n",
                s:"\cd-5% EXP Combo Timer Speed\n",
                s:"\cd+1.25% Maximum Stamina\n",
                s:"\cd+3.125% Magic-Focus Strength\n",

                s:ArmorString1,
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }

    if (CurrentArmorClass == 2)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+4% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+6% Chance of Not Consuming Ammo\n";

     SetFont("ARM2A1");
     HudMessage(s:"A"; 0, 903, 0, 214.0, 55.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Blue Armor"; 0, 902, CR_WHITE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+50% Normal Damage Protection\n",
                s:"\cd+5% Unbreakable Damage Protection\n",
                s:"\cd+52.5% Total Damage Protection\n",
                s:"Up to 200 Durability Points\n",
                s:"\cd+25% Bullet Resistance\n",

                s:"\cd+10% Fire Resistance\n",
                s:"\cd+4% Explosive Resistance\n",
                s:"\cg-8% Maximum Mana Regeneration Rate\n",
                s:"\cd+2.5% Stamina Regeneration\n",
                s:"\cd+(8 + 2%) Balance\n",

                s:"\cd+1% Survival Chance\n",
                s:"\cg-5% Jump Strength\n",
                s:"\cd-10% EXP Combo Timer Speed\n",
                s:"\cd+2.5% Maximum Stamina\n",
                s:"\cd+6.25% Magic-Focus Strength\n",

                s:ArmorString1,
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }

    if (CurrentArmorClass == 3)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+6.5% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+9.75% Chance of Not Consuming Ammo\n";

     SetFont("STSKA1");
     HudMessage(s:"A"; 0, 903, 0, 195.0, 50.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Stone Skin Armor"; 0, 902, CR_BRICK, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+66.67% Normal Damage Protection\n",
                s:"\cd+12.5% Unbreakable Damage Protection\n",
                s:"\cd+70.84% Total Damage Protection\n",
                s:"Up to 500 Durability Points\n",
                s:"\cd+40% Bullet Resistance\n",

                s:"\cd+27.5% Fire Resistance\n",
                s:"\cg-12.5% Ice Resistance\n",
                s:"\cd+15% Explosive Resistance\n",
                s:"\cg-10% Maximum Mana Regeneration Rate\n",
                s:"\cd+5% Stamina Regeneration\n",

                s:"\cd+(12 + 4%) Balance\n",
                s:"\cd+1.6% Survival Chance\n",
                s:"\cg-6.7% Jump Strength\n",
                s:"\cd-15% EXP Combo Timer Speed\n",
                s:"\cd+5% Maximum Stamina\n",

                s:"\cd+9.375% Magic-Focus Strength\n",
                s:ArmorString1,
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }

    if (CurrentArmorClass == 4)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+10% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+15% Chance of Not Consuming Ammo\n";

     SetFont("DISKA1");
     HudMessage(s:"A"; 0, 903, 0, 190.0, 55.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Diamond Skin Armor"; 0, 902, CR_BRICK, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+90% Damage Protection\n",
                s:"\cd+37.5% Unbreakable Damage Protection\n",
                s:"\cd+93.75% Total Damage Protection\n",
                s:"Up to 1250 Durability Points\n",
                s:"\cd+47.5% Bullet Resistance\n",

                s:"\cd+37.5% Fire Resistance\n",
                s:"\cd+7.5% Ice Resistance\n",
                s:"\cd+7.5% Explosive Resistance\n",
                s:"\cg-14% Maximum Mana Regeneration Rate\n",
                s:"\cd+10% Stamina Regeneration\n",

                s:"\cd+(16 + 8%) Balance\n",
                s:"\cd+4.4% Survival Chance\n",
                s:"\cg-9% Jump Strength\n",
                s:"\cd-20% EXP Combo Timer Speed\n",
                s:"\cd+10% Maximum Stamina\n",

                s:"\cd+12.5% Magic-Focus Strength\n",
                s:ArmorString1,
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }

    if (CurrentArmorClass == 5)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+15% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+22.5% Chance of Not Consuming Ammo\n";

     SetFont("STSKB1");
     HudMessage(s:"A"; 0, 903, 0, 174.0, 50.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Divine Stone Skin Armor"; 0, 902, CR_GOLD, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+83.3334% Normal Damage Protection\n",
                s:"\cd+25% Unbreakable Damage Protection\n",
                s:"\cd+87.5% Total Damage Protection\n",
                s:"Up to 2000 Durability Points\n",
                s:"\cd+5% Overall Resistance\n",

                s:"\cd+40% Bullet Resistance\n",
                s:"\cd+27.5% Fire Resistance\n",
                s:"\cg-12.5% Ice Resistance\n",
                s:"\cd+30% Explosive Resistance\n",
                s:"\cg-12% Maximum Mana Regeneration Rate\n",

                s:"\cd+7.5% Stamina Regeneration\n",
                s:"\cd+(12 + 12%) Balance\n",
                s:"\cd+6.6% Survival Chance\n",
                s:"\cg-8.3% Jump Strength\n",
                s:"\cd-25% EXP Combo Timer Speed\n",

                s:"\cd+12.5% Maximum Stamina\n",
                s:"\cd+15.625% Magic-Focus Strength\n",
                s:ArmorString1,
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }

    if (CurrentArmorClass == 6)
    {
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     if (ModType == 0) ArmorString1 = "\cd+25% Chance of Not Consuming Ammo\n";
                  else ArmorString1 = "\cd+37.5% Chance of Not Consuming Ammo\n";

     SetFont("DISKB1");
     HudMessage(s:"A"; 0, 903, 0, 167.0, 55.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Divine Diamond Skin Armor"; 0, 902, CR_GOLD, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+95% Normal Damage Protection\n",
                s:"\cd+75% Unbreakable Damage Protection\n",
                s:"\cd+98.75% Total Damage Protection\n",
                s:"Up to 5000 Durability Points\n",
                s:"\cd+10% Overall Resistance\n",

                s:"\cd+47.5% Bullet Resistance\n",
                s:"\cd+37.5% Fire Resistance\n",
                s:"\cd+7.5% Ice Resistance\n",
                s:"\cd+35% Explosive Resistance\n",
                s:"\cg-16% Maximum Mana Regeneration Rate\n",

                s:"\cd+15% Stamina Regeneration\n",
                s:"\cd+(16 + 24%) Balance\n",
                s:"\cd+17.6% Survival Chance\n",
                s:"\cg-9.5% Jump Strength\n",
                s:"\cd-30% EXP Combo Timer Speed\n",

                s:"\cd+25% Maximum Stamina\n",
                s:"\cd+18.75% Magic-Focus Strength\n",
                s:ArmorString1,
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
   }
  }

  // Checks the Armor Info of Sauron's Helmet. [all characters]
  if (MiscellaneousVars[55] == 2)
  {   
   if (CheckActorInventory(Player1TID,"SauronHelmet") > 0)
   {
    if (CharacterClass == 0) ArmorString1 = "\cd+12.5% Mana Regeneration Rate\n";
    if (CharacterClass == 1) ArmorString1 = "\cd+25% Mana Regeneration Rate\n";
    if (CharacterClass == 2) ArmorString1 = "\cd+37.5% Mana Regeneration Rate\n";

    ArmorString2 = " \n";
    if (CharacterClass == 2) ArmorString2 = "\cg+34% Hellcore Heating Speed\n";

    if (ModType == 0) ArmorString3 = "\cd+7.5% Chance of Not Consuming Ammo\n";
                 else ArmorString3 = "\cd+9.375% Chance of Not Consuming Ammo\n";

    // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
    SetFont("BLACKBAR");
    HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

    SetFont("SHEMC0");
    HudMessage(s:"A"; 0, 903, 0, 190.0, 25.0, 0.03);
    SetFont("DVDSSMLFONT");
    HudMessage(s:"Sauron's Helmet"; 0, 902, CR_DARKGRAY, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd-25% Damage Received\n",
                s:"\cd-16.67% Damage from Bullets/Pellets\n",
                s:"\cd+12.5% Healing Spell Effect\n",
                s:ArmorString1,
                s:"\cg-25% Maximum Mana Regeneration Rate\n",

                s:"\cg-10% Stamina Regeneration\n",
                s:"\cd+12.5% Mana Gain from Items\n",
                s:"\cd+(17 + 17%) Balance\n",
                s:"\cd+17.5% Survival Chance\n",
                s:"\cg-10% Jump Strength\n",

                s:"\cg-1.56% Chance to Completely Evade an Attack\n",
                s:"\cdMarginally Increases Evasion Based on Agility & Deftness\n",
                s:ArmorString3,
                s:ArmorString2,
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

   }
   else MiscellaneousVars[55] += 1;
  }

  // Checks the Armor Info of Sauron's Gauntlets. [all characters]
  if (MiscellaneousVars[55] == 3)
  {   
   if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0)
   {
    if (CharacterClass == 0) ArmorString1 = "\cd+(5 + 5%) Balance\n";
    if (CharacterClass == 1) ArmorString1 = "\cd+(6 + 6%) Balance\n";
    if (CharacterClass == 2) ArmorString1 = "\cd+(4 + 4%) Balance\n";

    if (CharacterClass == 0) ArmorString2 = "\cd+5% Survival Chance\n";
    if (CharacterClass == 1) ArmorString2 = "\cd+6% Survival Chance\n";
    if (CharacterClass == 2) ArmorString2 = "\cd+4% Survival Chance\n";

    ArmorString3 = " \n";
    if (CharacterClass == 2) ArmorString3 = "\cg+34% Hellcore Heating Speed\n";

    if (ModType == 0) ArmorString4 = "\cd+7.5% Chance of Not Consuming Ammo\n";
                 else ArmorString4 = "\cd+9.375% Chance of Not Consuming Ammo\n";

    // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
    SetFont("BLACKBAR");
    HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

    SetFont("WGNTC0");
    HudMessage(s:"A"; 0, 903, 0, 170.0, 30.0, 0.03);
    SetFont("DVDSSMLFONT");
    HudMessage(s:"Sauron's Gauntlets"; 0, 902, CR_DARKGRAY, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+12.5% Healing Spell Effect\n",
                s:"\cd+25% Mana Regeneration Rate\n",
                s:"\cg-10% Maximum Mana Regeneration Rate\n",
                s:"\cg-10% Stamina Regeneration\n",
                s:"\cd+25% Mana Gain from Items\n",

                s:"\cg-1.56% Chance to Completely Evade an Attack (when equipped)\n",
                s:"\cdMarginally Increases Evasion Based on Agility & Deftness\n",
                s:ArmorString1,
                s:ArmorString2,
                s:"\cg-5% Jump Strength\n",

                s:"Recovers some health/mana with each hit [up to 200% maximum of each]\n",
                s:"Alt-Fire will throw a stronger, slower blow\n",
                s:ArmorString4,
                s:ArmorString3,
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

   }
   else MiscellaneousVars[55] += 1;
  }

  // Checks the Armor Info of The One Ring [all characters]
  if (MiscellaneousVars[55] == 4)
  {   
   if (CheckActorInventory(Player1TID,"TheOneRing") > 0)
   {
    if (CharacterClass == 0) ArmorString1 = "\cg+25% Mana Cost\n";
    if (CharacterClass == 1) ArmorString1 = "\cg+25% Mana Cost\n";
    if (CharacterClass == 2) ArmorString1 = "\cd-18.75% Mana Cost\n";

    if (CharacterClass == 0) ArmorString2 = "\cg-37.5% Mana Regeneration Rate\n";
    if (CharacterClass == 1) ArmorString2 = "\cg-25% Mana Regeneration Rate\n";
    if (CharacterClass == 2) ArmorString2 = "\cg-12.5% Mana Regeneration Rate\n";

    if (CharacterClass == 0) ArmorString3 = "\cg-50% Mana Gain from Items\n";
    if (CharacterClass == 1) ArmorString3 = "\cg-50% Mana Gain from Items\n";
    if (CharacterClass == 2) ArmorString3 = "\cd+25% Mana Gain from Items\n";

    if (CharacterClass == 2)
    {
     if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) ArmorString4 = "\cqIncrease Fear Effect Chance from '\cnAnubis Cufflinks\cq' to 33.3%\n";
                                           else ArmorString4 = "\ck(?)\n";
    }
    else
    {
     if (CharacterClass == 0) ArmorString4 = "\cdYou Become Ghostly, Making Attacks Sometimes Pass Through You\n";
     if (CharacterClass == 1) ArmorString4 = "\cdYou Appear as a Shadow, Throwing Attacks off Course\n";
    }

    if (ModType == 0) ArmorString5 = "\cd+25% Chance of Not Consuming Ammo\n";
                 else ArmorString5 = "\cd+31.25% Chance of Not Consuming Ammo\n";

    // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
    SetFont("BLACKBAR");
    HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

    SetFont("LOTRD0");
    HudMessage(s:"A"; 0, 903, 0, 195.0, 30.0, 0.03);
    SetFont("DVDSSMLFONT");
    HudMessage(s:"The One Ring"; 0, 902, CR_ORANGE, 256.0, 31.0, 0.03);

     HudMessage(
                s:ArmorString1,
                s:"\cd+150% Healing Spell Effect\n",
                s:ArmorString2,
                s:"\cd+50% Maximum Mana Regeneration Rate\n",
                s:"\cd+25% Extra Chance of a Gain to Each Stat on Level Up\n",

                s:ArmorString3,
                s:"\cd+10% Balance\n",
                s:"\cd+33.3% Survival Chance\n",
                s:"\cd+50% Movement Speed\n",
                s:"\cd+150% Damage Inflicted by All Attacks\n",

                s:"\cd-60% Damage Received\n",
                s:"\cd+6.25% Chance to Completely Evade an Attack\n",
                s:"\cdSlightly Increases Evasion Based on Agility & Deftness\n",
                s:"\cdAllows You to See The Entire Map\n",
                s:"\cdAllows You to See All Creatures and Items on The Map\n",

                s:ArmorString4,
                s:"\cd-20% EXP Combo Timer Speed\n",
                s:ArmorString5,
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

   }
   else MiscellaneousVars[55] += 1;
  }

  // Checks the Armor Info of the Safe Tea Boots [Flora only]
  if (MiscellaneousVars[55] == 5)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";

     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMA0");
     HudMessage(s:"A"; 0, 903, 0, 188.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Safe Tea Shoes"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+3% Armor Class\n",
                s:ArmorString3,
                s:"\cd+10% Stamina Regeneration\n",
                s:"\cd+1 Balance\n",
                s:"\cd+1.25% Magic Resistance\n",

                s:"\cd+75% Damage Done By Kicks\n",
                s:"\cd+25% Chance to Not Incur Slime/etc Damage\n",
                s:"\cd-0.5% Hellcore Heating Speed\n",
                s:"\cd+3.75% Chance to Completely Evade an Attack\n",
                s:"\cd+10% Jump Strength\n",

                s:ArmorString1,
                s:ArmorString2,
                s:"\cd+5%-10% Extra EXP Gained\n",
                s:"\cd+5%-10% Extra Sceptre EXP Gained\n",
                s:"\cd-60% Stamina Use when Dashing/Air-Dashing\n",

                s:"\cd-25% Dash/Air-Dash Cooldown Time\n",
                s:"\cd-10% EXP Combo Timer Speed\n",
                s:ArmorString4,
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Pearly Corset [Flora only]
  if (MiscellaneousVars[55] == 6)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"PearlyCorset") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMB0");
     HudMessage(s:"A"; 0, 903, 0, 190.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Pearly Corset"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+7% Armor Class\n",
                s:ArmorString3,
                s:"\cd+3 Balance\n",
                s:"\cd+2.5% Magic Resistance\n",
                s:"\cd+2% Fire-Elemental Resistance\n",

                s:"\cd+2% Ice-Elemental Resistance\n",
                s:"\cd+25% Bullet Resistance\n",
                s:"\cd-2.5% Hellcore Heating Speed\n",
                s:"\cd+0.5% Jump Strength\n",
                s:"\cd+20% HP Regen Speed\n",

                s:"\cd-10% HP Degen Speed (only if above 100% Maximum HP)\n",
                s:"\cd+30%-45% Extra EXP Gained\n",
                s:"\cd+30%-45% Extra Sceptre EXP Gained\n",
                s:"\cd+20% Max HP Gained From Max HP Bonuses/Seeds of Life\n",
                s:"\cd+0.75% Chance to Completely Evade an Attack\n",

                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString4,
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Water Flying Dress [Flora only]
  if (MiscellaneousVars[55] == 7)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMC0");
     HudMessage(s:"A"; 0, 903, 0, 173.0, 31.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Water Flying Dress"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+8% Armor Class\n",
                s:ArmorString3,
                s:"\cd+4 Balance\n",
                s:"\cd+25% Magic Resistance\n",
                s:"\cd+30% Fire-Elemental Resistance\n",

                s:"\cd+20% Area-Of-Effect Resistance\n",
                s:"\cd+15% Bullet Resistance\n",
                s:"\cd-7.5% Hellcore Heating Speed\n",
                s:"\cd+0.5% Jump Strength\n",
                s:"\cd+1.25% Chance to Completely Evade an Attack\n",

                s:"\cd+10% Maximum Stamina\n",
                s:"\cd+66.6% Stamina Recovery From Items\n",
                s:"\cd+66.6% Hellcore Cooldown From Items\n",
                s:ArmorString1,
                s:ArmorString2,

                s:ArmorString4,
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";

                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Evenstar Necklace [Flora only]
  if (MiscellaneousVars[55] == 8)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMD0");
     HudMessage(s:"A"; 0, 903, 0, 174.0, 28.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Evenstar Necklace"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+2% Armor Class\n",
                s:ArmorString3,
                s:"\cd+1 Balance\n",
                s:"\cd-(10 + 10%) Mana Cost\n",
                s:"\cd+20% Magic Resistance\n",

                s:"\cd+20% Fire-Elemental Resistance\n",
                s:"\cd+20% Ice-Elemental Resistance\n",
                s:"\cd+20% Thunder-Elemental Resistance\n",
                s:"\cd+20% Magic Damage\n",
                s:"\cd+50% Fire-Elemental Damage\n",

                s:"\cd+50% Ice-Elemental Damage\n",
                s:"\cd+50% Thunder-Elemental Damage\n",
                s:"\cd+50% Holy-Elemental Damage\n",
                s:"\cd+10% HP Regen Speed\n",
                s:"\cd-5% HP Degen Speed (only if above 100% Maximum HP)\n",

                s:"\cd-13.5% Hellcore Heating Speed\n",
                s:"\cd+1.25% Jump Strength\n",
                s:"\cd+25% Maximum Mana Regeneration Rate\n",
                s:"\cd+33% Movement Speed While Drawing '\cfDiaris Bow\cd'\n",
                s:"\cd+2.5% Chance to Completely Evade an Attack\n",

                s:"\cd+6.25% Magic-Focus Strength\n",
                s:"\cdSlightly speeds up Debuff Timers\n",
                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString4,

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Cloak Of Evasion [Flora only]
  if (MiscellaneousVars[55] == 9)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMME0");
     HudMessage(s:"A"; 0, 903, 0, 180.0, 31.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Cloak Of Evasion"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+4% Armor Class\n",
                s:ArmorString3,
                s:"\cd+3 Balance\n",
                s:"\cd+5% Ice-Elemental Resistance\n",
                s:"\cd+2.5% Thunder-Elemental Resistance\n",

                s:"\cd+10% Bullet Resistance\n",
                s:"\cd+12.5% Chance to Not Incur Slime/etc Damage\n",
                s:"\cd+10% Movement Speed\n",
                s:"\cd+12.5% Chance to Completely Evade an Attack\n",
                s:"\cd+2.5% Jump Strength\n",

                s:"\cd-1.5% Hellcore Heating Speed\n",
                s:ArmorString1,
                s:ArmorString2,
                s:"\cd-5% EXP Combo Timer Speed\n",
                s:ArmorString4,

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Falcon Knife Earrings [Flora only]
  if (MiscellaneousVars[55] == 10)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0) ArmorString3 = "\cd+33.3% Damage Done By Punches and Gauntlet Punches\n";
                                               else ArmorString3 = "\cd+33.3% Damage Done By Punches\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\ck(?)\n";
                                                        else ArmorString4 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString5 = "\n";
                                                        else ArmorString5 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMK0");
     HudMessage(s:"A"; 0, 903, 0, 167.0, 31.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Falcon Knife Earrings"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+5% Armor Class\n",
                s:ArmorString4,
                s:"\cd+1 Balance\n",
                s:"\cd+100% Damage Inflicted by All Attacks\n",
                s:"\cd+3.75% Jump Strength\n",

                s:"\cd-4.5% Hellcore Heating Speed\n",
                s:"\cd+1.25% Chance to Completely Evade an Attack\n",
                s:"\cd+17.5% Maximum Stamina\n",
                s:"\cd-25% Stamina Consumption for Attacks/Dashing/Whistling\n",
                s:"\cd-10% Stamina Comsumption for Focusing/Psyching Up\n",

                s:"\cd+6.25% Magic-Focus Strength\n",
                s:ArmorString3,
                s:"\cd+33.3% Damage Done By Kicks and Uppercuts\n",
                s:ArmorString1,
                s:ArmorString2,

                s:ArmorString5,
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Anubis Cufflinks [Flora only]
  if (MiscellaneousVars[55] == 11)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (CheckActorInventory(Player1TID,"SauronGauntletsItem") > 0) ArmorString3 = "\cd+75% Damage Done By Punches and Gauntlet Punches\n";
                                               else ArmorString3 = "\cd+75% Damage Done By Punches\n";
     
     if (CheckActorInventory(Player1TID,"TheOneRing") > 0) ArmorString4 = "\cd+33.3% Chance to Induce Fear On Enemies and Make Them Hesitate\n";
                                      else ArmorString4 = "\cd+20% Chance to Induce Fear On Enemies and Make Them Hesitate\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString5 = "\ck(?)\n";
                                                        else ArmorString5 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString6 = "\n";
                                                        else ArmorString6 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMF0");
     HudMessage(s:"A"; 0, 903, 0, 181.0, 32.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Anubis Cufflinks"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+5% Armor Class\n",
                s:ArmorString5,
                s:"\cd+2.5% Stamina Regeneration\n",
                s:"\cd+2 Balance\n",
                s:"\cd-(2 + 2%) Mana Cost\n",

                s:ArmorString4,
                s:"\cd+6.25% Thunder-Elemental Resistance\n",
                s:"\cd+10% Survival Chance\n",
                s:"\cd+15% HP Regen Speed\n",
                s:"\cd-7.5% HP Degen Speed (only if above 100% Maximum HP)\n",

                s:"\cd+1.25% Jump Strength\n",
                s:"\cd-3.5% Hellcore Heating Speed\n",
                s:"\cd+62% Maximum Mana Regeneration Rate\n",
                s:"\cd+0.5% Chance to Completely Evade an Attack\n",
                s:"\cd+10% EXP given from ally Monsters killing enemy Monsters\n",
                s:ArmorString3,

                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString6,
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Kissa's Armored Brassiere [Flora only]
  if (MiscellaneousVars[55] == 12)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"KissaBra") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMG0");
     HudMessage(s:"A"; 0, 903, 0, 151.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Kissa's Armored Brassiere"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+6% Armor Class\n",
                s:ArmorString3,
                s:"\cd+7.5% Stamina Regeneration\n",
                s:"\cd+1 Balance\n",
                s:"\cd+20% Bullet Resistance\n",

                s:"\cd+10% Max HP Gained From Max HP Bonuses/Seeds of Life\n",
                s:"\cd+25% Survival Chance\n",
                s:"\cqMaximum Survival Chance increases from 87.5% to 93.8%\n",
                s:"\cd+38% Maximum Mana Regeneration Rate\n",
                s:"\cd+2.5% Jump Strength\n",

                s:"\cd-6.5% Hellcore Heating Speed\n",
                s:"\cd+1% Chance to Completely Evade an Attack\n",
                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString4,

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Ruinous Shield [Flora only]
  if (MiscellaneousVars[55] == 13)
  {

   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"RuinousShield") > 0)
    {
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+4 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMML0");
     HudMessage(s:"A"; 0, 903, 0, 192.0, 31.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Ruinous Shield"; 0, 902, CR_DARKRED, 256.0, 31.0, 0.03);

     HudMessage(
                s:ArmorString3,
                s:"\cg-(10 + 50%) Balance\n",
                s:"\cgSurvival Chance is cut by 4/5ths it's usual value\n",
                s:"\cg-61% Damage Inflicted \c-[except Hellcore weapons]\n",
                s:"\cg-61% Damage Resistance\n",

                s:"\cg+100% Hellcore Heating Speed\n",
                s:"\cg+50% Mana Cost for Spells\n",
                s:"\cg-62.5% HP Regeneration Speed\n",
                s:"\cg-62.5% MP Regeneration Speed\n",
                s:"\cg-62.5% Stamina Regeneration Speed\n",

                s:"\cgEvasion Chance reduced by 5/8ths it's usual value\n",
                s:"\cdHellcore Weapons drop at 3x the normal rate\n",
                s:"Taking Damage Will Help Progress the Shield's Uncursing Process\n",
                s:"Shield Will Also Slowly Uncurse Itself Over Time On It's Own\n",
                s:"Killing Enemies Will Also Gradually Uncurse the Shield Over Time\n",

                s:"\cg-0.3% to -1.55% HP Degeneration Every Second\n",
                s:"\cg-0.3% to -1.55% MP Degeneration Every Second\n",
                s:"\cgEXP Combo Timer Speed Doubled\n",
                s:ArmorString4,
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Divine Shield [Flora only]
  if (MiscellaneousVars[55] == 14)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"DivineShield") > 0)
    {
     misc1 = 0;
     if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"PearlyCorset") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"CloakOfEvasion") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"KissaBra") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"BalrogRing") > 0) misc1 += 1;
     if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) misc1 += 1;

     misc2 = 15 + (misc1 * 2);
     misc3 = 7 + (misc1 * 7);

     ArmorString1 = "% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
     ArmorString2 = "% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";

     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMH0");
     HudMessage(s:"A"; 0, 903, 0, 194.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Divine Shield"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+16% Armor Class\n",
                s:ArmorString3,
                s:"\cd+12.5% Stamina Regeneration\n",
                s:"\cd+(10 + 10%) Balance\n",
                s:"\cd+30% Magic Resistance\n",

                s:"\cd+25% Fire-Elemental Resistance\n",
                s:"\cd+25% Ice-Elemental Resistance\n",
                s:"\cd+25% Thunder-Elemental Resistance\n",
                s:"\cd-12.5% Hellcore Heating Speed\n",
                s:"\cd+0.625% Jump Strength\n",

                s:"\cdEvasion Chance increased by 11/10ths it's usual value\n",
                s:"\cq",d:misc2,s:ArmorString1,
                s:"\cq+",d:misc3,s:ArmorString2,
                s:"\cd-15% EXP Combo Timer Speed\n",
                s:"\cd+5% Maximum Stamina\n",

                s:ArmorString4,
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Balrog's Ring [Flora only]
  if (MiscellaneousVars[55] == 15)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"BalrogRing") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "\ck(?)\n";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMI0");
     HudMessage(s:"A"; 0, 903, 0, 199.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Balrog's Ring"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+2% Armor Class\n",
                s:ArmorString3,
                s:"\cd+1 Balance\n",
                s:"\cd-(5 + 5%) Mana Cost\n",
                s:"\cd+15% Max HP Gained From Max HP Bonuses/Seeds of Life\n",

                s:"\cd+15% Fire-Elemental Resistance\n",
                s:"\cd+22.5% Ice-Elemental Resistance\n",
                s:"\cd+25% Area-Of-Effect Resistance\n",
                s:"\cd+25% HP Regen Speed\n",
                s:"\cd-12.5% HP Degen Speed (only if above 100% Maximum HP)\n",

                s:"\cd+25% Maximum Mana Regeneration Rate\n",
                s:"\cd-8.5% Hellcore Heating Speed\n",
                s:"\cd+1.25% Jump Strength\n",
                s:"\cd+0.5% Chance to Completely Evade an Attack\n",
                s:"\cd+12.5% Maximum Stamina\n",

                s:"\cd+6.25% Magic-Focus Strength\n",
                s:"\cdSlightly speeds up Debuff Timers\n",
                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString4,

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  // Checks the Armor Info of the Dove's Ribbon [Flora only]
  if (MiscellaneousVars[55] == 16)
  {
   if (CharacterClass != 2) MiscellaneousVars[55] += 1;
   else
   {
    if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
    {
     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString1 = "\cq+7% Damage Reduced by '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability.\n";
                                        else ArmorString1 = "\ck(?)\n";

     if (CheckActorInventory(Player1TID,"DivineShield") > 0) ArmorString2 = "\cq+2% Chance for '\cnDivine Shield's\cq' '\cuOmniblock\cq' ability to activate.\n";
                                        else ArmorString2 = "\ck(?)\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString3 = "";
                                                        else ArmorString3 = "\cd+9 Max Level Cap\n";
     
     if (GetCVar("dvds_flora_ignorearmormadelevelcap") == 1) ArmorString4 = "\n";
                                                        else ArmorString4 = "";
     
     misc4 = (PlayerLevel / 50) + 1;

     // Dims the screen without using Fade-based commands that'll interfere with other flashes/etc
     SetFont("BLACKBAR");
     HudMessage(s:"A"; HUDMSG_ALPHA, 904, 0, 160.0, 120.0, 0.03, 0.667);

     SetFont("ARMMJ0");
     HudMessage(s:"A"; 0, 903, 0, 192.0, 30.0, 0.03);
     SetFont("DVDSSMLFONT");
     HudMessage(s:"Dove's Ribbon"; 0, 902, CR_LIGHTBLUE, 256.0, 31.0, 0.03);

     HudMessage(
                s:"\cd+9% Armor Class\n",
                s:ArmorString3,
                s:"\cd+5% Stamina Regeneration\n",
                s:"\cd+2 Balance\n",
                s:"\cd+15% Survival Chance\n",

                s:"\cd+6.25% Magic Resistance\n",
                s:"\cd+1.25% Fire-Elemental Resistance\n",
                s:"\cd+6.25% Ice-Elemental Resistance\n",
                s:"\cd+15% Thunder-Elemental Resistance\n",
                s:"\cd+5% Bullet Resistance\n",

                s:"\cd+15% Movement Speed\n",
                s:"\cd+20% Magic Damage\n",
                s:"\cd+2 to 4 Mana Regeneration Rate\n",
                s:"\cd+",d:misc4,s:" HP Regeneration per Second, Up to 200% Maximum HP\n",
                s:"\cdHP will no longer Degenerate when above 100% Maximum HP\n",

                s:"\cd-5.5% Hellcore Heating Speed\n",
                s:"\cd+5% Jump Strength\n",
                s:"\cd+1.75% Chance to Completely Evade an Attack\n",
                s:"\cqDamage Suffered from Hellcore-Overheat Cut by 50%\n",
                s:"\cdIncreases Maximum Evasion Chance from 75% to 92.5%\n",

                s:"\cd+5%-10% Extra EXP Gained\n",
                s:"\cd+5%-10% Extra Sceptre EXP Gained\n",
                s:ArmorString1,
                s:ArmorString2,
                s:ArmorString4,

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",

                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n",
                s:" \n";
                0, 901, CR_WHITE, 256.4, 212.0, 0.03);

    }
    else MiscellaneousVars[55] += 1;
   }
  }

  if (MiscellaneousVars[55] > 16) MiscellaneousVars[55] = 0; // Void Page
 }

 Delay(1);
 Restart;
}

script "CheckWeaponFlash" (int modulous, int increment)
{
 int result;
 if (increment != 0)
 {
  MiscellaneousVars[51] += increment;
  if (MiscellaneousVars[51] >= modulous) MiscellaneousVars[51] = 0;
 }
 else
 {
  result = MiscellaneousVars[51] % modulous;
  SetResultValue(result);
 }
 //PrintBold(d:MiscellaneousVars[51],s:" / ",d:modulous,s:"    [",d:increment,s:"]");
}

script "CheckPlayerHealth" (void)
{
 SetResultValue(GetActorProperty(Player1TID,APROP_Health));
}

script "LifebarOptionChecker" ENTER
{
 If(GetCVar("dvds_actorlifebars") == 1) ACS_NamedExecuteAlways ("LifebarDisplayClientSide",0,0,0,0);
}

script "CheckBFG2704" (void)
{
 SetResultValue(GetCVar("dvds_BFG2704"));
}

str dvds_monsternames[420][3] =
{
  {"PracticeTarget", "Practicing Target", ""},
  {"PracticeTarget2", "Practicing Target", ""},
// DOOM 1/2
  // Monsters
  {"DSHelperDog", "Attack Dog", ""},
  {"DSZombieman", "Zombieman", ""},
  {"PlasmaGuy", "Plasma Dude", ""},
  {"RepeaterZombie", "Repeater Guy", ""},
  {"KarasawaGuy", "'Sawa Man", ""},
  {"RocketLauncherGuy", "Rocketeer Zombie", ""},
  {"DSShotgunGuy", "Shotgun Guy", ""},
  {"SuperShotgunGuy", "SuperShotgun Guy", ""},
  {"FemaleRailZombie", "Railgunner Captain", ""},
  {"DSChaingunGuy", "Chaingun Guy", ""},
  {"Minigunner", "Minigun Zombie", ""},
  {"BFGGuy", "BFG Commando", ""},
  {"SuicideBomber", "Suicide Bomber", ""},
  {"DSDoomImp", "Imp", ""},
  {"DarkImp", "Dark Imp", ""},
  {"STDarkImp", "Dark Imp [Weak]", ""},
  {"VoidDarkImp", "Dark Imp [Strong]", ""},
  {"NetherDarkImp", "Nether Dark Imp", ""},
  {"DSDemon", "Pinky Demon", ""},
  {"DSSpectre", "Pinky Spectre", ""},
  {"BloodDemon", "Blood Pinky", ""},
  {"BloodSpectre", "Blood Spectre", ""},
  {"ChaingunDemon", "Blood Pinky [Chaingun]", ""},
  {"ChaingunSpectre", "Blood Spectre [Chaingun]", ""},
  {"DSWolfensteinSS", "SS Nazi", ""},
  {"DSLostSoul", "Lost Soul", ""},
  {"DSLostSoul2", "Annoying Lost Soul", ""},
  {"DSPainElemental", "Pain Elemental", ""},
  {"DSCacoDemon", "Cacodemon", ""},
  {"Cacolantern", "Cacolantern", ""},
  {"Abaddon", "Abaddon", ""},
  {"DSHellKnight", "Hell Knight", ""},
  {"DSBaronofHell", "Baron of Hell", ""},
  {"HellWarrior", "Hell Warrior", ""},
  {"Belphegor", "Belphegor", ""},
  {"BruiserDemon", "Bruiser Demon", ""},
  {"ArchonofHell", "Archon of Hell", ""},
  {"PyroDemon", "Pyro Demon", ""},
  {"DSRevenant", "Revenant", ""},
  {"DeathIncarnate", "Death Incarnate", ""},
  {"DSFatso", "Mancubus", ""},
  {"Hectebus", "Hectebus", ""},
  {"Daedabus", "Daedabus", ""},
  {"DSArachnotron", "Arachnotron", ""},
  {"DSRailArachnotron", "Arachnotron", ""},
  {"ArachnotronMK2", "Augmented Arachnotron", ""},
  {"FusionArachnotron", "Fusion Arachnotron", ""},
  {"DSArchvile", "Arch Vile", ""},
  {"Diabloist", "Diabloist", ""},
  {"DSSpiderMastermind", "Spider Mastermind", ""},
  {"Demolisher", "Spider-Demolisher", ""},
  {"DSCyberdemon", "Cyber Demon", ""},
  {"Annihilator", "Cyber-Annhilator", ""},
  {"DSScriptedMarine", "UAC Marine Buddy", ""},
  {"HadesSphere", "Hades Sphere", ""},
  {"HSOverlord", "Hades Sphere", ""},
  {"WeakenedFlyingBalrog", "Flying Balrog", ""},
  {"FlyingBalrog", "Flying Balrog", ""},
  {"CyBruiser", "CyBruiser", ""},
  {"HellCleric", "Hell Cleric", ""},
  {"HadesElemental", "Hades Elemental", ""},
  {"HadesOverlord", "Hades Overlord", ""},
  {"Hierophant", "Hierophant", ""},
  {"DSBossBrain", "\cfJohn Romero", ""},

  {"FZombieman", "Zombieman", ""},
  {"FPlasmaGuy", "Plasma Dude", ""},
  {"FRocketLauncherGuy", "Rocketeer Zombie", ""},
  {"FRepeaterZombie", "Repeater Guy", ""},
  {"FKarasawaGuy", "'Sawa Man", ""},

  {"FShotgunGuy", "Shotgun Guy", ""},
  {"FSuperShotgunGuy", "SuperShotgun Guy", ""},
  {"FChaingunGuy", "Chaingun Guy", ""},
  {"FBFGGuy", "BFG Commando", ""},
  {"FWolfensteinSS", "SS Nazi", ""},

  {"FDoomImp", "Imp", ""},
  {"FDarkImp", "Dark Imp", ""},
  {"FSTDarkImp", "Dark Imp [Weak]", ""},
  {"FVoidDarkImp", "Dark Imp [Strong]", ""},
  {"FNetherDarkImp", "Nether Dark Imp", ""},
  {"FDemon", "Pinky Demon", ""},
  {"FSpectre", "Pinky Spectre", ""},
  {"FBloodDemon", "Blood Pinky", ""},

  {"FBloodSpectre", "Blood Spectre", ""},
  {"FChaingunDemon", "Blood Spectre [Chaingun]", ""},
  {"FChaingunSpectre", "Blood Spectre [Chaingun]", ""},
  {"FRevenant", "Revenant", ""},
  {"FDeathIncarnate", "Death Incarnate", ""},
  {"FLostSoul1", "Lost Soul", ""},
  {"FLostSoul2", "Annoying Lost Soul", ""},
  {"FHadesSphere", "Hades Sphere", ""},

  {"FHSOverlord", "Hades Sphere", ""},
  {"FCacoDemon", "Cacodemon", ""},
  {"FCacolantern", "Cacolantern", ""},
  {"FAbaddon", "Abaddon", ""},
  {"FPainElemental", "Pain Elemental", ""},

  {"FHadesElemental", "Hades Elemental", ""},
  {"FHadesOverlord", "Hades Overlord", ""},
  {"FArachnotron", "Arachnotron", ""},
  {"FRailArachnotron", "Arachnotron", ""},
  {"FArachnotronMK2", "Augmented Arachnotron", ""},
  {"FFusionArachnotron", "Fusion Arachnotron", ""},

  {"FHellKnight", "Hell Knight", ""},
  {"FBaronofHell", "Baron of Hell", ""},
  {"FBelphegor", "Belphegor", ""},
  {"FBruiserDemon", "Bruiser Demon", ""},
  {"FCyBruiser", "CyBruiser", ""},
  {"FArchonofHell", "Archon of Hell", ""},

  {"FPyroDemon", "Pyro Demon", ""},
  {"FFatso", "Mancubus", ""},
  {"FHectebus", "Hectebus", ""},
  {"FDaedabus", "Daedabus", ""},
  {"FArchvile", "Arch Vile", ""},
  {"FDiabloist", "Diabloist", ""},

  {"FSpiderMastermind", "Spider Mastermind", ""},
  {"FDemolisher", "Spider-Demolisher", ""},
  {"FCyberdemon", "Cyber Demon", ""},
  {"FAnnihilator", "Cyber-Annhilator", ""},
  {"FHellCleric", "Hell Cleric", ""},
  {"FHierophant", "Hierophant", ""},

  {"FFlyingBalrog", "Flying Balrog", ""},

// Bosses
  // Sitnalta
  {"Zakachi", "\cfZakachi Daemonbourne\c-", ""},

  // DV1 Bosses & MiniBosses
  {"SauronEyeWeak", "Lesser Sauron Eye", ""},
  {"SauronEyeStrong1", "Greater Sauron Eye", ""},
  {"SauronEyeStrong2", "Greater Sauron Eye", ""},
  {"SauronEyeMain", "\cfSauron's Mightiest Eye\c-", ""},
  {"Sauravatar", "\cfGreater Sauravatar\c-", ""},

// Non-Standard Doom Monsters
  // Happy Time Circus [both] 
  {"BeefyNew", "Beefy The Clown", ""},
  {"MiniFluffyNew", "Fluffy [mini]", ""},
  {"FluffyNew", "Fluffy", ""},
  {"BulbyNew", "Bulby [mini]", ""},
  {"MegaBulbyNew", "Bulby", ""},
  {"TinyBingoNew", "Tiny Bingo", ""},
  {"BingoNew", "Bingo", ""},
  {"EvilDeadHandNew", "Evil Dead Hand", ""},
  {"ClownGhostNew", "Clown Ghost Balloon", ""},
  {"ClownGhost2New", "Ghost Clown Face", ""},
  {"JumpingSkullNew", "Bouncing Skull", ""},
  {"JumpingSkull2New", "Bouncing Skull", ""},
  {"PossessedBalloonNew", "Possessed Balloon", ""},
  {"BigBerthaNew", "Big Bertha", ""},
  {"ClownHeadNew", "Freaky Clown Head", ""},
  {"GoreWormNew", "Gore Worm", ""},
  {"BigBertha2New", "Big Bertha", ""},
  {"BlackBearNew", "Tiny Black Bear", ""},
  {"BouncingClownNew", "Giant Bouncing Clown", ""},
  {"BabyClownNew", "Baby Bouncing Clown", ""},
  {"BabyClown2New", "Baby Bouncing Clown", ""},
  {"SuperBerthaNew", "\cfSUPER Big Bertha\c-", ""},
  {"PennywiseHeadNew", "Flying Pennywise Head", ""},
  {"PennywiseHead2New", "Flying Pennywise Head", ""},
  // Boss
  {"PennywiseBoss", "\cfPennywise The Dancing Clown\c-", ""},

// Heretic Monsters

  // Neutral
  {"ChickenNew", "Chicken", ""},

  // Monsters
  {"HereticImpNew", "Gargoyle", ""},
  {"HereticImpLeaderNew", "NitroGargoyle", ""},
  {"PlagueImp", "Plague Gargoyle", ""},
  {"WatcherImp", "Watcher Gargoyle", ""},
  {"MummyNew", "Golem", ""},
  {"MummyLeaderNew", "NitroGolem", ""},
  {"MummyGhostNew", "Golem (Ghost)", ""},
  {"MummyLeaderGhostNew", "NitroGolem (Ghost)", ""},
  {"IceGolem", "Ice Golem", ""},
  {"IceGolemGhost", "Ice Golem (Ghost)", ""},
  {"KnightNew", "Undead Warrior", ""},
  {"KnightGhostNew", "Undead Warrior (Ghost)", ""},
  {"WizardNew", "Disciple of D'Sparil", ""},
  {"Banshee", "Abyssal Banshee", ""},
  {"IronlichNew", "Iron Lich", ""},
  {"IceLich", "Ice Lich", ""},
  {"GoldLich", "Gold Lich", ""},
  {"FakeGoldLich", "'Gold Lich'", ""},
  {"BloodLich", "Blood Lich", ""},
  {"ClinkNew", "Sabreclaw", ""},
  {"BeastNew", "Were-Dragon", ""},
  {"MaulotaurNew", "Maulotaur", ""},
  {"SnakeNew", "Ophidian", ""},
  {"DeathKnight", "Death Knight", ""},
  {"DeathKnightGhost", "Death Knight (Ghost)", ""},
  {"HellGuard", "Abyssal Guard", ""},

  // Bosses
  {"DSparilMountedNew", "\cfD'Sparil\c- (w/ Chaos Serpent Mount)", ""},
  {"DSparilUnmountedNew", "\cfD'Sparil\c-", ""},

  // Friendlies
  {"FHereticImp", "Gargoyle", ""},
  {"FHereticImpLeader", "NitroGargoyle", ""},
  {"FMummy", "Golem", ""},
  {"FMummyLeader", "NitroGolem", ""},
  {"FMummyGhost", "Golem (Ghost)", ""},
  {"FMummyLeaderGhost", "NitroGolem (Ghost)", ""},
  {"FKnight", "Undead Warrior", ""},
  {"FKnightGhost", "Undead Warrior (Ghost)", ""},
  {"FWizard", "Disciple of D'Sparil", ""},
  {"FBanshee", "Abyssal Banshee", ""},
  {"FIronlich", "Iron Lich", ""},
  {"FClink", "Sabreclaw", ""},
  {"FBeast", "Were-Dragon", ""},
  {"FMaulotaur", "Maulotaur", ""},
  {"FSnake", "Ophidian", ""},

// Hexen Monsters

  // Neutral
  {"PigNew", "Pig", ""},

  // Monsters
  {"EttinNew", "Ettin", ""},
  {"EttinCommander", "Ettin Commander", ""},
  {"Bormereth", "Bormereth", ""},
  {"FireDemonNew", "Afrit", ""},
  {"FireDemonLeader", "Afrit Leader", ""},
  {"FireDemonCommander", "Afrit Commander", ""},
  {"FireDemonQueen", "Afrit Queen", ""},
  {"FireDemonQueenClone", "Afrit Queen", ""},
  {"CentaurNew", "Centaur", ""},
  {"SlaughtaurNew", "Slaughtaur", ""},
  {"BishopNew", "Dark Bishop", ""},
  {"DarkDisciple", "Dark Disciple", ""},
  {"VampireDVDS", "Vampire", ""},
  {"StalkerNew", "Stalker", ""},
  {"StalkerLeaderNew", "Alpha Stalker", ""},
  {"IceStalker", "Ice Stalker", ""},
  {"IceStalkerLeader", "Alpha Ice Stalker", ""},
  {"GreenChaosSerpentNew", "Chaos Serpent [Green]", ""},
  {"BrownChaosSerpentNew", "Chaos Serpent [Brown]", ""},
  {"MagmaChaosSerpentNew", "Chaos Serpent [Magma]", ""},
  {"BlackChaosSerpentNew", "Chaos Serpent [Black]", ""},
  {"EtherealChaosSerpentNew", "Chaos Serpent [Ethereal]", ""},
  {"IceGuyNew", "Wendigo", ""},
  {"WraithNew", "Reiver", ""},
  {"WraithBuriedNew", "Reiver", ""},
  {"DragonNew", "Death Wyvern", ""},
  {"HeresiarchNew", "Heresiarch", ""},

  // Bosses
  {"ClericBossNew", "\cfTraductus, Grand Patriarch of the Church\c-", ""},
  {"FighterBossNew", "\cfZedek, Grand Marshal of the Legion\c-", ""},
  {"MageBossNew", "\cfMenelkir, Arch Mage of the Arcanum\c-", ""},
  {"KoraxNew", "\cfKorax\c-", ""},

  // Friendlies
  {"FEttin", "Ettin", ""},
  {"FEttinCommander", "Ettin Commander", ""},
  {"FBormereth", "Bormereth", ""},
  {"FFireDemon", "Afrit", ""},
  {"FFireDemonLeader", "Afrit Leader", ""},
  {"FFireDemonCommander", "Afrit Commander", ""},
  {"FFireDemonQueen", "Afrit Queen", ""},
  {"FFireDemonQueenClone", "Afrit Queen", ""},
  {"FCentaur", "Centaur", ""},
  {"FSlaughtaur", "Slaughtaur", ""},
  {"FBishop", "Dark Bishop", ""},
  {"FDarkDisciple", "Dark Disciple", ""},
  {"FVampire", "Vampire", ""},
  {"FStalker", "Stalker", ""},
  {"FStalkerLeader", "Alpha Stalker", ""},
  {"FGreenChaosSerpent", "Chaos Serpent [Green]", ""},
  {"FBrownChaosSerpent", "Chaos Serpent [Brown]", ""},
  {"FMagmaChaosSerpentNew", "Chaos Serpent [Magma]", ""},
  {"FBlackChaosSerpentNew", "Chaos Serpent [Black]", ""},
  {"FEtherealChaosSerpentNew", "Chaos Serpent [Ethereal]", ""},
  {"FWraith", "Reiver", ""},
  {"FIceGuy", "Wendigo", ""},
  {"FDragon", "Death Wyvern", ""},
  {"FHeresiarch", "Heresiarch", ""},

// Strife Monsters

  // Peasants
  {"PeasantNew", "\cbPeasant\c-", ""},
  {"Peasant1New", "\cbPeasant\c-", ""},
  {"Peasant2New", "\cbPeasant\c-", ""},
  {"Peasant3New", "\cbPeasant\c-", ""},
  {"Peasant4New", "\cbPeasant\c-", ""},
  {"Peasant5New", "\cbPeasant\c-", ""},
  {"Peasant6New", "\cbPeasant\c-", ""},
  {"Peasant7New", "\cbPeasant\c-", ""},
  {"Peasant8New", "\cbPeasant\c-", ""},
  {"Peasant9New", "\cbPeasant\c-", ""},
  {"Peasant10New", "\cbPeasant\c-", ""},
  {"Peasant11New", "\cbPeasant\c-", ""},
  {"Peasant12New", "\cbPeasant\c-", ""},
  {"Peasant13New", "\cbPeasant\c-", ""},
  {"Peasant14New", "\cbPeasant\c-", ""},
  {"Peasant15New", "\cbPeasant\c-", ""},
  {"Peasant16New", "\cbPeasant\c-", ""},
  {"Peasant17New", "\cbPeasant\c-", ""},
  {"Peasant18New", "\cbPeasant\c-", ""},
  {"Peasant19New", "\cbPeasant\c-", ""},
  {"Peasant20New", "\cbPeasant\c-", ""},
  {"Peasant21New", "\cbPeasant\c-", ""},
  {"Peasant22New", "\cbPeasant\c-", ""},

  // Beggars
  {"BeggarNew", "\cbBeggar\c-", ""},
  {"Beggar1New", "\cbBeggar\c-", ""},
  {"Beggar2New", "\cbBeggar\c-", ""},
  {"Beggar3New", "\cbBeggar\c-", ""},
  {"Beggar4New", "\cbBeggar\c-", ""},
  {"Beggar5New", "\cbBeggar\c-", ""},

  // Merchants
  {"MerchantNew", "\cbMerchant\c-", ""},
  {"ArmorerNew", "\cbArmorer\c-", ""},
  {"BarKeepNew", "\cbBartender\c-", ""},
  {"MedicNew", "\cbMedic\c-", ""},
  {"WeaponSmithNew", "\cbWeapon Smith\c-", ""},

  // Front Rebels
  {"RebelNew", "Front Rebel", ""},
  {"Rebel1New", "Front Rebel", ""},
  {"Rebel2New", "Front Rebel", ""},
  {"Rebel3New", "Front Rebel", ""},
  {"Rebel4New", "Front Rebel", ""},
  {"Rebel5New", "Front Rebel", ""},
  {"Rebel6New", "Front Rebel", ""},

  // Hostile Monsters
  {"AcolyteBlueNew", "Order Acolyte", ""},
  {"AcolyteDGreenNew", "Order Acolyte", ""},
  {"AcolyteGoldNew", "Order Acolyte", ""},
  {"AcolyteGrayNew", "Order Acolyte", ""},
  {"AcolyteLGreenNew", "Order Acolyte", ""},
  {"AcolyteRedNew", "Order Acolyte", ""},
  {"AcolyteRustNew", "Order Acolyte", ""},
  {"AcolyteShadowNew", "Shadow Acolyte", ""},
  {"AcolyteTanNew", "Order Acolyte", ""},
  {"AcolyteNew", "Order Acolyte", ""},
  {"OStalkerNew", "Order Stalker", ""},
  {"SentinelNew", "Order Sentinel", ""},
  {"CrusaderNew", "Order Crusader", ""},
  {"TemplarNew", "Order Templar", ""},
  {"CeilingTurretNew", "Ceiling Turret", ""},
  {"ReaverNew", "Order Reaver", ""},
  {"InquisitorNew", "Order Inquisitor", ""},
  {"DarkInquisitor", "Order Dark Inquisitor", ""},

  // Special
  {"AlienSpectre1Model", "\cfGhost of The Programmer's Spectre\c-", ""},
  {"AlienSpectre2Model", "\cfGhost of The Bishop's Spectre\c-", ""},
  {"AlienSpectre3Model", "\cfGhost of The Oracle's Spectre\c-", ""},
  {"AlienSpectre4Model", "\cfGhost of Macil's Spectre\c-", ""},
  {"AlienSpectre5Model", "\cfGhost of The Loremaster's Spectre\c-", ""},
  
  // Special or Boss Monsters
  {"ProgrammerNew", "\cfThe Programmer\c-", ""},
  {"StrifeBishopNew", "\cfThe Bishop\c-", ""},
  {"OracleNew", "\cfThe Oracle\c-", ""},
  {"Macil1New", "\cfMacil, Leader of the Front\c-", ""},
  {"Macil2New", "\cfMacil, Leader of the Front\c-", ""},
  {"LoremasterNew", "\cfThe Loremaster\c-", ""},
  {"AlienSpectre1New", "\cfThe Programmer's Spectre\c-", ""},
  {"AlienSpectre2New", "\cfThe Bishop's Spectre\c-", ""},
  {"AlienSpectre3New", "\cfThe Oracle's Spectre\c-", ""},
  {"AlienSpectre4New", "\cfMacil's Spectre\c-", ""},
  {"AlienSpectre5New", "\cfThe Loremaster's Spectre\c-", ""},
  {"EntityBossNew", "\cfThe Entity: The One God\c-", ""},
  {"EntitySecondNew", "\cfMiniature Entity\c-", ""},
  {"EntityAscended", "\cfThe Entity: The One God: Ascendant\c-", ""},
  
// Touhou Doom Characters/Monsters

  // Minions
  {"Fairy1New", "Lesser Fairy [blue]", ""},
  {"Fairy2New", "Greater Fairy [blue]", ""},
  {"Fairy3New", "Lesser Fairy [pink]", ""},
  {"Fairy4New", "Greater Fairy [pink]", ""},
  {"Fairy5New", "Greater Fairy [red]", ""},

  // Bosses and Mid-Bosses
  {"RumiaMidBossNew", "Rumia", ""},
  {"RumiaNew", "Rumia", ""},
  {"DaiyouseiNew", "Daiyousei", ""},
  {"CirnoNew", "Cirno", ""},
  {"MeilingMidBossNew", "Hong Meiling", ""},
  {"MeilingNew", "Hong Meiling", ""},

// TCOTD2 Monsters

  // Monsters and Creepy-Crawlies
  {"MiniSpiderNew", "Spider [smaller]", ""},
  {"ShotgunCultistNew", "Darkmoon Cultist [shotgun]", ""},
  {"TommyGunCultistNew", "Darkmoon Cultist [tommy gun]", ""},
  {"ThrallNew", "Darkmoon Cultist [magician]", ""},
  {"NightmareNew", "Nightmare", ""},
  {"SirenNightmareNew", "MEGA Nightmare", ""},
  {"VulgarNew", "Vulgar", ""},
  {"ClayDevilNew", "Clay Devil", ""},
  {"SoulHarvesterNew", "Soul Harvester", ""},
  {"ESoulNew", "Ethereal Soul", ""},
  {"DEWraithNew", "Wraith of the Eclipse", ""},
  {"ButcherZombieNew", "Bloated Butcher", ""},
  {"BloodZombieNew", "Axe Zombie", ""},

  // Mini Bosses
  {"HellHoundNew", "Hell Hound", ""},
  {"LargeSpiderNew", "Spider [huge]", ""},
  {"TCOTDAShadowNew", "Grand Shadow Creature", ""},
  {"ApprenticeNew", "Darkmoon Grand Apprentice", ""},

  // Final Bosses
  {"ThamuzNew", "\cfThamuz, The Dark God\c-", ""},
  {"TchernobogNew", "\cfTchernobog, The One That Binds\c-", ""},

  // KDIZD Monsters
  {"KDIZDChaingunner", "Chaingun Guy", ""},
  {"DemonCube", "Demon Cube", ""},
  {"HellsFury", "Hell's Fury", ""},
  {"MaulerDemon", "Mauler Pinky", ""},
  {"RapidFireTrooper", "Rapid Assault Zombieman", ""},
  {"RifleZombie", "Rifle Zombie", ""},
  {"StoneImp", "Stone Imp", ""},
  {"Magmantis", "\cfMagmantis, Guardian of Deimos\c-", ""},

// Unloved Monsters  

  // Monsters
  {"ChainsawZombieNew", "Chainsaw Zombie", ""},
  {"BloodFiendNew", "Blood Fiend Pinky", ""},
  {"LurkerNew", "Blood Fiend Lurker", ""},
  {"BatFamiliarNew", "Bat Familiar", ""},
  {"DragonFamiliarNew", "Dragon Familiar", ""},
  {"LordofHeresyNew", "Heresy Lord", ""},
  {"ImpWarlordNew", "Imp Warlord", ""},
  {"SatyrNew", "Satyr", ""},
  {"ShadowNew", "Shadow", ""},
  {"CultistNew", "Cultist", ""},
  {"UnlovedAcolyteNew", "Acolyte", ""},
  {"UnlovedDiscipleNew", "Disciple", ""},
  {"UnlovedApprenticeNew", "Apprentice", ""},
  {"WickedNew", "Wicked", ""},
  {"AvatarNew", "\cfThe Avatar\c-", ""},

// Epic 2
  {"StrangeAlien", "Strange Alien Creature", ""},
  
// DUMP3
  {"AdolfHitlerDS", "\cfAdolf Hitler", ""},
  {"Benellus1DS", "\cfBenellus, God of Shotguns", ""},
  {"Benellus2DS", "\cfBenellus, God of Shotguns", ""},
  {"Benellus3DS", "\cfBenellus, God of Shotguns", ""},

// Doom 64 Retribution
  {"DSZombieman64", "Zombieman", ""},
  {"DSShotgunGuy64", "Shotgun Guy", ""},
  {"DSDoomImp64", "Imp", ""},
  {"DSNightmareImp64", "Nightmare Imp", ""},
  {"DSDemon64", "Pinky Demon", ""},
  {"DSSpectre64", "Spectre", ""},
  {"DSLostSoul64", "Lost Soul", ""},
  {"DSLostSoul642", "REALLY Annoying Lost Soul", ""},
  {"DSCacodemon64", "Cacodemon", ""},
  {"DSHellKnight64", "Hell Knight", ""},
  {"DSBaronofHell64", "Baron of Hell", ""},
  {"DSArachnotron64", "Arachnotron", ""},
  {"DSPainElemental64", "Pain Elemental", ""},
  {"DSFatso64", "Mancubus", ""},
  {"DSCyberdemon64", "Cyberdemon", ""},
  {"DSMotherDemon64", "\cfThe Mother of all Demons", ""},

// The Ultimate Torment and Torture

  // Allied Marines
  {"FistMarine", "Space Marine [Grappler]", ""},
  {"BerserkMarine", "Space Marine [Berserked]", ""},
  {"PistolMarine", "Space Marine [Pistol]", ""},
  {"ShotgunMarine", "Space Marine [Shotgun]", ""},
  {"SuperShotgunMarine", "Space Marine [Super Shotgun]", ""},
  {"ChaingunMarine", "Space Marine [Chaingun]", ""},
  {"RocketMarine", "Space Marine [Rocket Launcher]", ""},
  {"PlasmaRifleMarine", "Space Marine [Plasma Rifle]", ""},
  {"RailgunMarine", "Space Marine [Railgun]", ""},
  {"BFGMarine", "Space Marine [BFG9000]", ""},
  // Monsters
  {"TNTSpider", "Giant Spider", ""},
  {"TNTMiniSpider", "Small Spider", ""},
  {"SourceGuardian", "\cgGuardian of the Source", ""},
  {"TheSource", "\cfThe Source of All Evil", ""}
  
};

Script "LifebarDisplayClientSide" (void) CLIENTSIDE
{
 While(GetCVar("dvds_actorlifebars") == 1 && GetActorProperty(Player1TID,APROP_Health) > 0)
 {
  int activator;
  activator = ActivatorTid();
  SetActivatorToTarget(0);
  int OldActivator;
  OldActivator = ActivatorTid();
  Delay(1);

  int class_index;
  int xpos = 0.0;
  int ypos = 0.0;

  for (int i = 0; i < 420; i++)
  {
   if (CheckActorClass(0, dvds_monsternames[i][0])) class_index = i;
  }

  int hpcritlevel = GetUserVariable(0, "user_HPCritRange");
  int hplowlevel = GetUserVariable(0, "user_HPLowRange");
  int hphalflevel = (GetUserVariable(0, "user_MaxHP") / 2);
  if (GetCVar("dvdsdebug_lifebardisplaystuff") == 1)
  {
   PrintBold(s:"CritLevel: ",d:hpcritlevel,
             s:"\nLowLevel: ",d:hplowlevel,
             s:"\nHalfLevel: ",d:hphalflevel);
  }

  int actormaxhp;
  int actorcurrhp;
  int hppercentdisp;

  int nonstatmonster = 0;
  if (GetActorClass(0) == "PracticeTarget") nonstatmonster = 1;
  if (GetActorClass(0) == "PracticeTarget2") nonstatmonster = 1;
  If(ActivatorTID() != Activator && nonstatmonster == 0)
  {
   actormaxhp = GetUserVariable(0, "user_MaxHP");
   actorcurrhp = GetActorProperty(0, APROP_Health);
   if (GetCVar("dvdsdebug_lifebardisplaystuff") == 1) PrintBold(s:"Activator [1]: ",d:Activator,s:"  ActorMaxHP: ",d:actormaxhp,s:"");
   SetActivator(Activator);

   If (MenuSystemVars[0] == 0 && actormaxhp != 0)
   {
    if (GetCVar("dvdsdebug_lifebardisplaystuff") == 1) PrintBold(s:"ActorMaxHP: ",d:actormaxhp,s:"");
    hppercentdisp = (actorcurrhp * 100 / actormaxhp);
    if (hppercentdisp < 0) hppercentdisp = 0;
    if (hppercentdisp > 100) hppercentdisp = 100;
	
    int acounter;
    int bcounter;
    SetActivatorToTarget(0);
    If(ActivatorTID() != Activator)
    {
     if (GetCVar("dvdsdebug_lifebardisplaystuff") == 1) PrintBold(s:"Activator [2]: ",d:Activator,s:"");
     If (CheckActorProperty(0, APROP_Friendly, 0)) SetFont ("MNRHPBAR");
     else If (CheckActorProperty(0, APROP_Friendly, 1)) SetFont ("MNGHPBAR");
     int stealthcheck = GetUserVariable(0, "user_isstealth");
     str stealthcheck2 = ""; if (stealthcheck > 0) stealthcheck2 = "?";
     int levelcheck = GetUserVariable(0, "user_monsterlevel");
     int leveldifference = levelcheck - PlayerLevel;
	 
	 int Speed = GetActorProperty(0,APROP_Speed); //Set's Final Speed values
     int Attack = GetActorProperty(0,APROP_DamageMultiplier); 
     int Defense = GetActorProperty(0,APROP_DamageFactor); 
     int Balance = GetActorProperty(0,APROP_Mass); 

     str monstercolor = "";
     If (CheckActorProperty(0, APROP_Friendly, 0)) monstercolor = "\c[Red]";
     else If (CheckActorProperty(0, APROP_Friendly, 1)) monstercolor = "\c[Green]";
	 str isfriendly = "";
     If (CheckActorProperty(0, APROP_Friendly, 0)) isfriendly = "";
     else If (CheckActorProperty(0, APROP_Friendly, 1)) isfriendly = " \cn(Friend)";
	 str islegendary = "";
     If (GetUserVariable(0, "user_legendaryevolved") > 0) islegendary = " \c[purple](LEGENDARY)";
     ypos = MiscFixedVars[1] + 0.0;
	 SetActivator(Activator);
     SetHudSize (800,600,0);
     HudMessage (s:"a"; 0, 201, CR_GREEN, 400.0, 100.0, 0.05);
     SetFont ("DVDSSMLFONT");
     SetHudSize (800,600,0);
     if (GetCVar("dvds_actorlifebarhp") == 1)
	 {
	  HudMessage (d:actorcurrhp, s:"/", d:actormaxhp; 0, 199, CR_WHITE, 400.0, 100.0, 0.05);
	 }
     if (GetCVar("dvds_actorlifebarnames") == 1)
	 {
	  if (GetCVar("dvdsdebug_lifebardisplaystuff") == 1) HudMessage (s:monstercolor,s:dvds_monsternames[class_index][1],s:stealthcheck2,s:isfriendly,s:islegendary,s:" [",d:OldActivator,s:"]"; 0, 198, CR_WHITE, 400.0, 115.0, 0.05);
	                                                else HudMessage (s:monstercolor,s:dvds_monsternames[class_index][1],s:stealthcheck2,s:isfriendly,s:islegendary; 0, 198, CR_WHITE, 400.0, 115.0, 0.05); 
	 }
     if (GetCVar("dvds_actorlifebarstats") == 1)
	 {
 	  HudMessage (s:"\c[LightBlue]Speed: ",f:Speed,s:"\n",
	                  s:"\c[Olive]Balance: ",d:Balance,s:"\n",
	                  s:"\c[Brick]Damage Dealt: ",f:Attack,s:"x\n",
				      s:"\c[Green]Damage Taken: ",f:Defense,s:"x"; 0, 196, CR_WHITE, 400.0, 70.0, 0.05);
	 }
     SetFont ("DVDSBIGFONT");
     xpos = 274.2; //400.0;
     ypos = 100.0; //115.0;
     str textcolor = "";
     if (leveldifference <= 0) textcolor = CR_LIGHTBLUE;
     if (leveldifference >= 0 && leveldifference <= 20) textcolor = CR_GOLD;
     if (leveldifference >= 21 && leveldifference <= 50) textcolor = CR_ORANGE;
     if (leveldifference >= 51 && leveldifference <= 100) textcolor = CR_RED;
     if (leveldifference >= 101 && leveldifference <= 250) textcolor = CR_DARKRED;
     if (leveldifference >= 251) textcolor = CR_PURPLE;
     HudMessage (d:levelcheck; 0, 197, textcolor, xpos, ypos, 0.05);

     SetFont ("DVDSSMLFONT");
     for (acounter = 0; acounter <= hppercentdisp; acounter++)
     {
      bcounter = bcounter + 2.0;
      SetActivatorToTarget(0);

      if (actorcurrhp > hphalflevel) 
	  {
	   SetFont ("FILLNORM");
	  }
      else 
	  if (actorcurrhp > hplowlevel && actorcurrhp <= hphalflevel) 
	  {
	   SetFont ("FILLCAUT");
	  }
      else 
	  if (actorcurrhp > hpcritlevel && actorcurrhp <= hplowlevel) 
	  { 
	   SetFont ("FILLDANG"); 
	  }
      else 
	  if (actorcurrhp <= hpcritlevel) 
	  { 
	   SetFont ("FILLCRIT"); 
	  }

      SetActivator(Activator);
      SetHudSize (800,600,0);

      If(actorcurrhp > 0)
      {
	   hudmessage(s:"a"; 0, acounter+202, CR_GREEN, 303.0 + bcounter, 100.0, 0.05, 1.0);
	  }
     }
     bcounter = 0;
     acounter = 0;
     Restart;
    }
   }
  }
 }
 If(GetCVar("dvds_actorlifebars") == 1 && GetActorProperty(Player1TID,APROP_Health) > 0) Restart;
}

script "CheckShotgunnerSpreads" (void)
{
 SetResultValue(GetCVar("dvds_shotgunnerspread"));
}

script "CheckMinigunHeat" (int save)
{
 int heatsave;
 if (save > 0) 
 { 
  MiscellaneousVars[191] = CheckActorInventory(Player1TID,"MinigunHeat") / save; 
  if (MiscellaneousVars[191] < 1) MiscellaneousVars[191] = 1;
  //PrintBold(d:MiscellaneousVars[191],s:" - ",d:save);
 }
 else
 {
  if (MiscellaneousVars[191] > 0) TakeActorInventory(Player1TID,"MinigunHeat",MiscellaneousVars[191]);
  //PrintBold(s:"- ",d:MiscellaneousVars[191]);
 }
}

script "CheckCrisisAttackType" (void)
{
 SetResultValue(GetCVar("dvds_monstercrisisattacks"));
}

// Extends the 'lifespan' of Ultra Magic Missiles based on both Sorcery and Therapeusis stats
script "GetUltraMagicMissileFuse" (void)
{
 int Fuse, Extra;
 Fuse = 117;

 Extra = MiscellaneousVars[34] / 5; // 5 Sorcery = 1 point for the fuse
 Fuse += Extra;

 Extra = MiscellaneousVars[36] / 5; // 5 Therapeusis = 1 point for the fuse
 Fuse += Extra;
 SetResultValue(Fuse);
}

// Quickuse a Vimstone
script "QuickuseVimstone" (void)
{
 int check = 0;
 if (CheckActorInventory(Player1TID,"LesserVimstone") > 0) check++;
 if (CheckActorInventory(Player1TID,"GreaterVimstone") > 0) check++;
 if (check > 0)
  {
  if (MiscellaneousVars[181] >= 7) { PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM); } // If Tension is Maxed, do not use an item.
  else
  {
   if (MiscellaneousVars[181] >= 4) // If Tension is "100" or above, prioritize a Greater Vimstone only.
   {
    if (CheckActorInventory(Player1TID,"GreaterVimstone") > 0) { ACS_NamedExecuteAlways("UseCustomInventoryItem",0,7); }
    else { PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM); }
   }
   else
   {
    if (CheckActorInventory(Player1TID,"LesserVimstone") > 0) { ACS_NamedExecuteAlways("UseCustomInventoryItem",0,6); }
    else 
    {
     if (CheckActorInventory(Player1TID,"GreaterVimstone") > 0) { ACS_NamedExecuteAlways("UseCustomInventoryItem",0,7); }
     else { PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM); }
    }
   }
  } 
 }
 else { PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM); }
 terminate;
}

// For actual items that are stored in the inventory
script "UseCustomInventoryItem" (int type)
{
 int temp1, temp2, temp3, check1, check2, check3;
 int healmax;
 int perktemp1, perktemp2, perktemp3, perktemp4;
 int perkhealthlimit, perkstaminalimit, perkmanalimit;
 int PerkFactor;
 int CurrentHealth = GetActorProperty(Player1TID,APROP_HEALTH);
 int perkbasemulti = 16;
 int MaxHealthLimit = MaxHealthTrue * 2;
 
 if (type == -7 && CheckActorInventory(Player1TID,"ArtiInvisibilityNew") > 0) // Icon of the Defender
 {
  perktemp4 = (35 * 90);
  perktemp4 = perktemp4 * (MiscellaneousVars[10050] + 4) / 4;
  PowerupTimer[1] += perktemp4;
  check1 += 1;
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   TakeActorInventory(Player1TID,"ArtiInvisibilityNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == -6 && CheckActorInventory(Player1TID,"ArtiInvulnerabilityNew") > 0) // Ring of Invincibility
 {
  perktemp4 = (35 * 45);
  perktemp4 = perktemp4 * (MiscellaneousVars[10050] + 4) / 4;
  PowerupTimer[4] += perktemp4;
  check1 += 1;
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   TakeActorInventory(Player1TID,"ArtiInvulnerabilityNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == -5 && CheckActorInventory(Player1TID,"ArtiInvulnerability2New") > 0) // Icon of the Defender
 {
  perktemp4 = (35 * 45);
  perktemp4 = perktemp4 * (MiscellaneousVars[10050] + 4) / 4;
  PowerupTimer[4] += perktemp4;
  check1 += 1;
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   TakeActorInventory(Player1TID,"ArtiInvulnerability2New",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == -4 && CheckActorInventory(Player1TID,"ArtiHealingRadiusNew") > 0) // Mystic Ambit Incant
 {
  // Heal HP/Health [62.5%] up to 200%
  temp1 = CurrentHealth;
  healmax = MaxHealthLimit;
  if (temp1 < healmax)
  {
   check1 += 1;
   temp1 += (MaxHealthTrue * 5 / 8);
   if (temp1 > healmax) temp1 = healmax;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }

  // Heal MP/Mana [62.5%] up to 200%
  healmax = MaxMana * 2;
  if (CurrentMana < healmax)
  {
   check1 += 1;
   CurrentMana += (MaxMana * 5 / 8);
   if (CurrentMana > healmax) CurrentMana = healmax;
  }

  // Heal Stamina [125%] up to 500%
  healmax = ((MiscellaneousVars[22] * 5000) / 1000);
  if (MiscellaneousVars[21] < healmax)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * 12500) / 10000;
   perktemp1 = temp2;
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp1 = perktemp1 * PerkFactor / 10000;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   temp2 = perktemp1;
   MiscellaneousVars[21] += temp2;
   if (MiscellaneousVars[21] > healmax) MiscellaneousVars[21] = healmax;
  }

  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(192,128,192,0.55,192,128,192,0.01,0.77);
   TakeActorInventory(Player1TID,"ArtiHealingRadiusNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == -3 && CheckActorInventory(Player1TID,"ArtiBoostManaNew") > 0) // Krater of Might [Hexen]
 {
  if (CheckActorInventory(Player1TID,"Mana1") < 500)
  {
   check1 += 1;
   GiveActorInventory(Player1TID,"Mana1",500);
  }
  if (CheckActorInventory(Player1TID,"Mana2") < 500)
  {
   check1 += 1;
   GiveActorInventory(Player1TID,"Mana2",500);
  }
  if (CurrentMana < MaxMana * 2)
  {
   check1 += 1;
   CurrentMana = MaxMana * 2;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.55,16,255,16,0.01,0.77);
   TakeActorInventory(Player1TID,"ArtiBoostManaNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == -2 && CheckActorInventory(Player1TID,"ArtiSuperHealthNew") > 0) // Mystic Urn [Heretic AND Hexen]
 {
  // Heal Health [~100 to 110% HP] up to 192.5% Max HP
  temp1 = CurrentHealth;
  healmax = ((MaxHealthTrue * 1925) / 1000);
  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  healmax = healmax * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
  if (healmax > (MaxHealthLimit)) healmax = MaxHealthLimit;

  if (temp1 < healmax)
  {
   check1 += 1;
   temp1 += (MaxHealthTrue * random(100,110)) / 100;
   if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   temp1 = temp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
   if (temp1 > healmax) temp1 = healmax;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }
  // Heal Stamina [62.50%] up to 500%
  healmax = ((MiscellaneousVars[22] * 5000) / 1000);
  if (MiscellaneousVars[21] < healmax)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * 6250) / 10000;
   perktemp1 = temp2;
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp1 = perktemp1 * PerkFactor / 10000;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   temp2 = perktemp1;
   MiscellaneousVars[21] += temp2;
   if (MiscellaneousVars[21] > healmax) MiscellaneousVars[21] = healmax;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.55,16,255,16,0.01,0.77);
   TakeActorInventory(Player1TID,"ArtiSuperHealthNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == -1 && CheckActorInventory(Player1TID,"ArtiHealthNew") > 0) // Quartz Flask [Heretic AND Hexen]
 {
  // Heal Health [~25 to 30% HP] up to 105% Max HP
  temp1 = CurrentHealth;
  healmax = ((MaxHealthTrue * 1050) / 1000);
  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  healmax = healmax * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
  if (healmax > MaxHealthLimit) healmax = MaxHealthLimit;

  if (temp1 < healmax)
  {
   check1 += 1;
   temp1 += (MaxHealthTrue * random(25,30)) / 100;
   if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   temp1 = temp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
   if (temp1 > healmax) temp1 = healmax;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }

  // Heal Stamina [12.5%]
  healmax = MiscellaneousVars[22];
  if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  healmax = healmax * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < healmax)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * 1250) / 10000;
   perktemp1 = temp2;
   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp1 = perktemp1 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp1 = perktemp1 * PerkFactor / 10000;
   if (CharacterClass == 0 | CharacterClass == 1 | CharacterClass == 9) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   temp2 = perktemp1;
   MiscellaneousVars[21] += temp2;
   if (MiscellaneousVars[21] > healmax) MiscellaneousVars[21] = healmax;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.55,16,255,16,0.01,0.77);
   TakeActorInventory(Player1TID,"ArtiHealthNew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == 1 && CheckActorInventory(Player1TID,"MedicinalHerb") > 0) // Medicinal Herb
 {
  // Heal Health [~25-35 HP]
  temp1 = CurrentHealth;
  perkhealthlimit = MaxHealthTrue;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (temp1 < perkhealthlimit)
  {
   check1 += 1;
   temp2 = random(25,35);
   perktemp1 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:perkhealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                          s:"\nHealth Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   temp1 += perktemp1;
   if (temp1 > perkhealthlimit) temp1 = perkhealthlimit;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }
  // Heal Stamina [~7.5% - ~10.5%]
  perkstaminalimit = MiscellaneousVars[22];

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkstaminalimit = perkstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < perkstaminalimit)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * random(75,105)) / 1000;
   perktemp2 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp2 = perktemp2 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp2 = perktemp2 * PerkFactor / 10000;
   MiscellaneousVars[21] += perktemp2;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:perkstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp2,s:" VS [",d:temp2,s:"]");
   if (MiscellaneousVars[21] > perkstaminalimit) MiscellaneousVars[21] = perkstaminalimit;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.33,16,255,16,0.01,0.66);
   TakeActorInventory(Player1TID,"MedicinalHerb",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == 2 && CheckActorInventory(Player1TID,"StrongMedicine") > 0) // Strong Medicin(al Herb)
 {
  // Heal Health [~55-65 HP]
  temp1 = CurrentHealth;
  perkhealthlimit = MaxHealthTrue;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (temp1 < perkhealthlimit)
  {
   check1 += 1;
   temp2 = random(55,65);
   perktemp1 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   temp1 += perktemp1;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:perkhealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                          s:"\nHealth Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   if (temp1 > perkhealthlimit) temp1 = perkhealthlimit;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }

  // Heal Stamina [~16.5% - ~19.5%]
  perkstaminalimit = MiscellaneousVars[22];

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkstaminalimit = perkstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < perkstaminalimit)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * random(165,195)) / 1000;
   perktemp2 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp2 = perktemp2 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp2 = perktemp2 * PerkFactor / 10000;
   MiscellaneousVars[21] += perktemp2;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:perkstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp2,s:" VS [",d:temp2,s:"]");
   if (MiscellaneousVars[21] > perkstaminalimit) MiscellaneousVars[21] = perkstaminalimit;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.55,16,255,16,0.01,0.77);
   TakeActorInventory(Player1TID,"StrongMedicine",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }


 if (type == 3 && CheckActorInventory(Player1TID,"SpecialMedicine") > 0) // Special Medicin(al Herb)
 {
  temp1 = CurrentHealth;
  perkhealthlimit = MaxHealthTrue;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (temp1 < perkhealthlimit)
  {
   // Heal Health [~85-105 HP]
   check1 += 1;
   temp2 = random(85,105);
   perktemp1 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   temp1 += perktemp1;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:perkhealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                          s:"\nHealth Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   if (temp1 > perkhealthlimit) temp1 = perkhealthlimit;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }

  // Heal Stamina [~25.5% - ~31.5%]
  perkstaminalimit = MiscellaneousVars[22];

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkstaminalimit = perkstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < perkstaminalimit)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * random(255,315)) / 1000;
   perktemp2 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp2 = perktemp2 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp2 = perktemp2 * PerkFactor / 10000;
   MiscellaneousVars[21] += perktemp2;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:perkstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp2,s:" VS [",d:temp2,s:"]");
   if (MiscellaneousVars[21] > perkstaminalimit) MiscellaneousVars[21] = perkstaminalimit;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.70,16,255,16,0.01,0.88);
   TakeActorInventory(Player1TID,"SpecialMedicine",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == 4 && CheckActorInventory(Player1TID,"YggdrasilDew") > 0) // Yggdrasil Dew
 {
  temp1 = CurrentHealth;
  perkhealthlimit = MaxHealthTrue;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (temp1 < perkhealthlimit)
  {
   // Heal Health [90.0% - 110.0%]
   check1 += 1;
   temp2 = ((MaxHealthTrue * random(900,1100)) / 1000);
   perktemp1 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   temp1 += perktemp1;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:perkhealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                          s:"\nHealth Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   if (temp1 > perkhealthlimit) temp1 = perkhealthlimit;
   SetActorProperty(Player1TID,APROP_Health,temp1);
  }

  // Heal Mana [22.5% - 27.5%]
  perkmanalimit = MaxMana;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkmanalimit = perkmanalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (CurrentMana < perkmanalimit)
  {
   check1 += 1;
   temp2 = (MaxMana * random(225,275)) / 1000;
   perktemp3 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp3 = perktemp3 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   temp3 = perktemp3;
   CurrentMana += temp3;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Mana Limit: ",d:perkmanalimit,s:" VS [",d:MaxMana,s:"]",
                                                          s:"\nMana Restored: ",d:perktemp3,s:" VS [",d:temp2,s:"]");
   if (CurrentMana > perkmanalimit) CurrentMana = perkmanalimit;
  }

  // Heal Stamina [90.0% - 110.0%]
  perkstaminalimit = MiscellaneousVars[22];

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkstaminalimit = perkstaminalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (MiscellaneousVars[21] < perkstaminalimit)
  {
   check1 += 1;
   temp2 = (MiscellaneousVars[22] * random(900,1100)) / 1000;
   perktemp2 = temp2;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp2 = perktemp2 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (CheckActorInventory(Player1TID,"WaterFlyingDress") > 0 && CharacterClass == 2) perktemp2 = perktemp2 * 5 / 3;
   PerkFactor = ((MiscellaneousVars[10017] * 2000) + (MiscellaneousVars[10018] * 5000)) + 10000;
   perktemp2 = perktemp2 * PerkFactor / 10000;
   MiscellaneousVars[21] += perktemp2;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Stamina Limit: ",d:perkstaminalimit,s:" VS [",d:MiscellaneousVars[22],s:"]",
                                                          s:"\nStamina Restored: ",d:perktemp2,s:" VS [",d:temp2,s:"]");
   if (MiscellaneousVars[21] > perkstaminalimit) MiscellaneousVars[21] = perkstaminalimit;
  }
  if (check1 > 0)
  {
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.85,16,255,16,0.02,1.12);
   TakeActorInventory(Player1TID,"YggdrasilDew",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == 5 && CheckActorInventory(Player1TID,"PaxaPunch") > 0) // Paxa Punch
 {
  temp1 = CurrentHealth;
  perktemp2 = 6300;
  perktemp2 = perktemp2 * (MiscellaneousVars[10050] + 4) / 4;
  if (temp1 > 0 && PowerupTimer[10] < perktemp2 && PowerupTimer[11] < perktemp2)
  {
   // Oomph and Buff for a full minute
   perktemp4 = (35 * 60);
   perktemp4 = perktemp4 * (MiscellaneousVars[10050] + 4) / 4;
   PowerupTimer[10] += perktemp4;
   PowerupTimer[11] += perktemp4;
   PlaySound(Player1TID,"use_paxa",CHAN_BODY,1.0,0,ATTN_NORM);
   ActivatorSound("use_paxa2",127);
   MiscellaneousVars[2040] = 70;
   MiscellaneousVars[2045] = 3;
   TakeActorInventory(Player1TID,"PaxaPunch",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 } 

 if (type == 6 && CheckActorInventory(Player1TID,"LesserVimstone") > 0) // Lesser Vimstone
 {
  if (MiscellaneousVars[181] < 4) // Cooldown Timer is 0 and Tension is less than "100" [tier 4]
  {
   ACS_NamedExecuteAlways("SetTensionLevel",0,2,1);
   PlaySound(Player1TID,"use_lesservimstone",CHAN_BODY,1.0,0,ATTN_NORM);
   TakeActorInventory(Player1TID,"LesserVimstone",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 } 

 if (type == 7 && CheckActorInventory(Player1TID,"GreaterVimstone") > 0) // Greater Vimstone
 {
  if (MiscellaneousVars[181] < 7) // Cooldown Timer is 0 and Tension is less than "1000" [tier 7]
  {
   ACS_NamedExecuteAlways("SetTensionLevel",0,4,2);
   PlaySound(Player1TID,"use_greatervimstone",CHAN_BODY,1.0,0,ATTN_NORM);
   TakeActorInventory(Player1TID,"GreaterVimstone",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 } 

 if (type == 8 && CheckActorInventory(Player1TID,"MercuryBandana") > 0) // Mercury Bandana
 {
  temp1 = CurrentHealth;
  perktemp2 = 6300;
  perktemp2 = perktemp2 * (MiscellaneousVars[10050] + 4) / 4;
  if (temp1 > 0 && PowerupTimer[12] < perktemp2)
  {
   // Acceleratle for a full minute
   perktemp4 = (35 * 60);
   perktemp4 = perktemp4 * (MiscellaneousVars[10050] + 4) / 4;
   PowerupTimer[12] += perktemp4;
   PlaySound(Player1TID,"use_mercurybandana",CHAN_BODY,1.0,0,ATTN_NORM);
   MiscellaneousVars[2040] = 70;
   MiscellaneousVars[2045] = 2;
   TakeActorInventory(Player1TID,"MercuryBandana",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 } 

 if (type == 9 && CheckActorInventory(Player1TID,"MagicWater") > 0) // Magic Water
 {
  perkmanalimit = MaxMana;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkmanalimit = perkmanalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (CurrentMana < perkmanalimit)
  {
   temp1 = (random(30,35) + ((MaxMana * 5) / 100));
   perktemp1 = temp1;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Mana Limit: ",d:perkmanalimit,s:" VS [",d:MaxMana,s:"]",
                                                          s:"\nMana Restored: ",d:perktemp1,s:" VS [",d:temp1,s:"]");
   CurrentMana += perktemp1;
   if (CurrentMana > perkmanalimit) CurrentMana = perkmanalimit;
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.14,16,255,16,0.01,0.33);
   TakeActorInventory(Player1TID,"MagicWater",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == 10 && CheckActorInventory(Player1TID,"SageElixir") > 0) // Sage Elixir
 {
  perkmanalimit = MaxMana;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkmanalimit = perkmanalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (CurrentMana < perkmanalimit)
  {
   temp1 = (random(90,105) + ((MaxMana * 15) / 100));
   perktemp1 = temp1;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Mana Limit: ",d:perkmanalimit,s:" VS [",d:MaxMana,s:"]",
                                                          s:"\nMana Restored: ",d:perktemp1,s:" VS [",d:temp1,s:"]");
   CurrentMana += perktemp1;
   if (CurrentMana > perkmanalimit) CurrentMana = perkmanalimit;
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.28,16,255,16,0.01,0.44);
   TakeActorInventory(Player1TID,"SageElixir",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == 11 && CheckActorInventory(Player1TID,"ElfinElixir") > 0) // Elfin Elixir
 {
  temp1 = (MaxMana * 9) / 8;
  perkmanalimit = temp1;

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkmanalimit = perkmanalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (CurrentMana < perkmanalimit)
  {
   temp1 = MaxMana;
   perktemp1 = temp1;

   if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
   perktemp1 = perktemp1 * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Mana Limit: ",d:perkmanalimit,s:" VS [",d:MaxMana,s:"]",
                                                          s:"\nMana Restored: ",d:perktemp1,s:" VS [",d:temp1,s:"]");
   CurrentMana += perktemp1;
   if (CurrentMana > perkmanalimit) CurrentMana = perkmanalimit;
   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.43,16,255,16,0.01,0.55);
   TakeActorInventory(Player1TID,"ElfinElixir",1);
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }

 if (type == 12 && CheckActorInventory(Player1TID,"MiraclePotion") > 0) // Miracle Potion
 {
  perkhealthlimit = MaxHealthTrue;
  perkmanalimit = MaxMana;

  if (CharacterClass == 8) // Ailish gets 25% more healing to both HP/MP [so up to 125% of maximum :V]
  {
   perkhealthlimit = perkhealthlimit * 5 / 4;
   perkmanalimit = perkmanalimit * 5 / 4;
  }

  if (CharacterClass == 2 | CharacterClass == 8) { perkbasemulti = 8; } else { perkbasemulti = 16; }
  perkhealthlimit = perkhealthlimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;
  perkmanalimit = perkmanalimit * (perkbasemulti + MiscellaneousVars[10049]) / perkbasemulti;

  if (CurrentHealth >= perkhealthlimit && (CurrentMana >= perkmanalimit))
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
  else
  {
   if (CurrentHealth < perkhealthlimit) SetActorProperty(Player1TID,APROP_HEALTH,perkhealthlimit);
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Healing Limit: ",d:perkhealthlimit,s:" VS [",d:MaxHealthTrue,s:"]",
                                                          s:"\nHealth Restored: ",d:perktemp1,s:" VS [",d:temp2,s:"]");
   if (CurrentMana < perkmanalimit) CurrentMana = perkmanalimit;
   if (GetCVar("dvdsdebug_healitemdisplays") > 0) PrintBold(s:"Mana Limit: ",d:perkmanalimit,s:" VS [",d:MaxMana,s:"]",
                                                          s:"\nMana Restored: ",d:perktemp3,s:" VS [",d:temp2,s:"]");

   PlaySound(Player1TID,"misc/invuse",CHAN_BODY,1.0,0,ATTN_NORM);
   PlaySound(Player1TID,"healing_dq",CHAN_BODY,1.0,0,ATTN_NORM);
   FadeRange(12,255,12,0.43,16,255,16,0.01,0.55);
   TakeActorInventory(Player1TID,"MiraclePotion",1);
  }
 }
}

// Scripts for Footsteps

//------------------------------------------------------------------------
//------------------------------------------------------------------------
// The credits go to Ryan Cordell for posting this as a resource <3
// He also credits
// "Credit goes to SolarSnowfall for the base, HotWax for optimization 
// on the script, Isle for further optimization, Kate for even further 
// optimization"
//------------------------------------------------------------------------

// #library "FOOTSTEP"
// #include "zcommon.acs"

#define V_OFFSET	20

int feet[8];		//footsteps on or off?
int v[8];			//velocity per player
int x;
int y;
int z;

FUNCTION int GetVelocity (void)
{
   int len;
   x = GetActorVelX(0);
   y = GetActorVelY(0);
   z = GetActorVelZ(0);

   int ang = vectorangle(x,y);
   if(((ang+0.125)%0.5) > 0.25) len = fixeddiv(y, sin(ang));
   else len = fixeddiv(x, cos(ang));

/*
   ang = vectorangle(len, z);
   if(((ang+0.125)%0.5) > 0.25) len = fixeddiv(z, sin(ang));
   else len = fixeddiv(len, cos(ang));
*/

   return len;
}

SCRIPT "FootSteps_PlayerEntersLevel" ENTER
{
   feet[PlayerNumber ()] = ON;
   ACS_NamedExecuteAlways ("FootSteps_SoundTables", 0);
   ACS_NamedExecuteAlways ("FootSteps_GetVelocity", 0);
   ACS_NamedExecuteAlways ("FootSteps_DoTheMaths", 0);
}

SCRIPT "FootSteps_PlayerRespawning" RESPAWN
{
   feet[PlayerNumber ()] = ON;
   ACS_NamedExecuteAlways ("FootSteps_SoundTables", 0);
   ACS_NamedExecuteAlways ("FootSteps_GetVelocity", 0);
   ACS_NamedExecuteAlways ("FootSteps_DoTheMaths", 0);
}

//This is the script that tracks the player's velocity.

SCRIPT "FootSteps_GetVelocity" (VOID)
{
   int p_num = PlayerNumber ();
   MiscellaneousVars[47] = 1;

   while (feet[p_num])
   {
      delay(1);

      v[p_num] = GetVelocity ()>>16;
   }
}

//=====================
// Do the floor maths.
//=====================

#DEFINE NUMFLOORTYPES 20

str FloorSound[NUMFLOORTYPES][250];

SCRIPT "FootSteps_DoTheMaths" (VOID)
{
   int i, counter;
   int delay_time = 2;
   int volume;
   MiscellaneousVars[47] = 1;

   while (feet[PlayerNumber ()])
   {
    delay_time = V_OFFSET -(3) - v[PlayerNumber ()]/2;
    if(delay_time<=0)
     delay_time=1;
    volume = (v[PlayerNumber ()] * 7);

      if (GetActorZ (0) == GetActorFloorZ (0))
      {
         // Loop through the different floor types
         for (i=0; i<NUMFLOORTYPES; i++) 
         {
            counter = 1;

            // Check through all the listed textures for this floor type
            while (counter < 250 && FloorSound[i][counter] != NULLSTR) {
               if (CheckActorFloorTexture(0, FloorSound[i][counter]))
               {
                  ActivatorSound (FloorSound[i][0], volume);

                  // No reason to keep looking
                  counter = 250;
               }
               counter++;
            }
         }
      }
      delay(delay_time+1);
   }
}

SCRIPT "FootSteps_SoundTables" OPEN
{
   // Initialize the array of floor sounds

   // Tile [1]
   FloorSound[0][0] = "floor/tile";
   FloorSound[0][1] = "CEIL1_3";
   FloorSound[0][2] = "CEIL3_3";
   FloorSound[0][3] = "CEIL3_4";
   FloorSound[0][4] = "CONS1_1";
   FloorSound[0][5] = "CONS1_5";
   FloorSound[0][6] = "CONS1_7";
   FloorSound[0][7] = "COMP01";
   FloorSound[0][8] = "FLAT2";
   FloorSound[0][9] = "FLAT3";
   FloorSound[0][10] = "FLAT8";
   FloorSound[0][11] = "FLAT9";
   FloorSound[0][12] = "FLAT17";
   FloorSound[0][13] = "FLAT18";
   FloorSound[0][14] = "FLAT19";
   FloorSound[0][15] = "FLOOR0_5";
   FloorSound[0][16] = "FLOOR0_6";
   FloorSound[0][17] = "FLOOR0_7";
   FloorSound[0][18] = "FLOOR3_3";
   FloorSound[0][19] = "FLOOR4_1";
   FloorSound[0][20] = "FLOOR4_5";
   FloorSound[0][21] = "TLITE6_1";
   FloorSound[0][22] = "TLITE6_4";
   FloorSound[0][23] = "TLITE6_5";
   FloorSound[0][24] = "FLOOR5_1";
   FloorSound[0][25] = "FLOOR5_2";
   FloorSound[0][26] = "FLOOR5_3";
   FloorSound[0][27] = "FLOOR7_2";
   FloorSound[0][28] = "ADEL_F08"; //Check
   FloorSound[0][29] = "ADEL_F14"; //Check
   FloorSound[0][30] = "ADEL_F31"; //Check
   FloorSound[0][31] = "ADEL_F49"; //Check
   FloorSound[0][32] = "ADEL_F55"; //Check
   FloorSound[0][33] = "ADEL_F56"; //Check
   FloorSound[0][34] = "ADEL_F63"; //Check
   FloorSound[0][35] = "ADEL_J06"; //Check
   FloorSound[0][36] = "ADEL_J07"; //Check
   FloorSound[0][37] = "ADEL_J12"; //Check
   FloorSound[0][38] = "ADEL_J15"; //Check
   FloorSound[0][39] = "CFLOOR2"; //Check
   FloorSound[0][40] = "CFLOOR3"; //Check
   FloorSound[0][41] = "CFLOOR4"; //Check
   FloorSound[0][42] = "CITYF01"; //Check
   FloorSound[0][43] = "CITYF02"; //Check
   FloorSound[0][44] = "CITYF03"; //Check
   FloorSound[0][45] = "CITYF04"; //Check
   FloorSound[0][46] = "CITYF05"; //Check
   FloorSound[0][47] = "CITYF06"; //Check
   FloorSound[0][48] = "CITYF07"; //Check
   FloorSound[0][49] = "CITYF08"; //Check
   FloorSound[0][50] = "CITYF09"; //Check
   FloorSound[0][51] = "CITYF10"; //Check
   FloorSound[0][52] = "CITYF13"; //Check
   FloorSound[0][53] = "CITYF14"; //Check
   FloorSound[0][54] = "CITYF15"; //Check
   FloorSound[0][55] = "CITYF16"; //Check
   FloorSound[0][56] = "CITYF17"; //Check
   FloorSound[0][57] = "CITYF18"; //Check
   FloorSound[0][58] = "IKTCR05B"; //Check
   FloorSound[0][59] = "IKTCR05C"; //Check
   FloorSound[0][60] = "IKTKP11C"; //Check
   FloorSound[0][61] = "IKTKP18A"; //Check
   FloorSound[0][62] = "IKTKP18B"; //Check
   FloorSound[0][63] = "IKTKWL2B"; //Check
   FloorSound[0][64] = "NICK_A01"; //Check
   FloorSound[0][65] = "NICK_A07"; //Check
   FloorSound[0][66] = "NICK_A10"; //Check
   FloorSound[0][67] = "QFLAT02"; //Check
   FloorSound[0][68] = "QFLAT03"; //Check
   FloorSound[0][69] = "QFLAT04"; //Check
   FloorSound[0][70] = "QFLAT05"; //Check
   FloorSound[0][71] = "QFLAT06"; //Check
   FloorSound[0][72] = "QFLAT07"; //Check
   FloorSound[0][73] = "WALLF1"; //Check
   FloorSound[0][74] = "WALLF2"; //Check
   FloorSound[0][75] = "WALLF3"; //Check
   FloorSound[0][76] = "CONS1_3"; //Check
   FloorSound[0][77] = "GRNLITE1"; //Check
   FloorSound[0][78] = "NFBRGN01"; //Check
   FloorSound[0][79] = "NFBRKA03"; //Check
   FloorSound[0][80] = "NFCL31GN"; //Check
   FloorSound[0][81] = "NFCL31GR"; //Check
   FloorSound[0][82] = "NFCL32GN"; //Check
   FloorSound[0][83] = "NFCL32GR"; //Check
   FloorSound[0][84] = "NFCL33GN"; //Check
   FloorSound[0][85] = "NFCL33GR"; //Check
   FloorSound[0][86] = "NFCL41GN"; //Check
   FloorSound[0][87] = "NFCL41RD"; //Check
   FloorSound[0][88] = "NFCL42GN"; //Check
   FloorSound[0][89] = "NFCL42GR"; //Check
   FloorSound[0][90] = "NFCL42RD"; //Check
   FloorSound[0][91] = "NFCL43GN"; //Check
   FloorSound[0][92] = "NFCL43GR"; //Check
   FloorSound[0][93] = "NFCL52GN"; //Check
   FloorSound[0][94] = "NFCL52GR"; //Check
   FloorSound[0][95] = "NFCNS1_3"; //Check
   FloorSound[0][96] = "NFCSPN01"; //Check
   FloorSound[0][97] = "NFCSPN02"; //Check
   FloorSound[0][98] = "NFCSPN04"; //Check
   FloorSound[0][99] = "NFDM15BR"; //Check
   FloorSound[0][100] = "NFDM15GR"; //Check
   FloorSound[0][101] = "NFDM16BR"; //Check
   FloorSound[0][102] = "NFFL03GN"; //Check
   FloorSound[0][103] = "NFFL06BR"; //Check
   FloorSound[0][104] = "NFFL06GN"; //Check
   FloorSound[0][105] = "NFFL33GR"; //Check
   FloorSound[0][106] = "NFFL41GN"; //Check
   FloorSound[0][107] = "NFFL41GR"; //Check
   FloorSound[0][108] = "NFFL45GN"; //Check
   FloorSound[0][109] = "NFFL45GR"; //Check
   FloorSound[0][110] = "NFFL46GN"; //Check
   FloorSound[0][111] = "NFFL46GR"; //Check
   FloorSound[0][112] = "NFFL48B"; //Check
   FloorSound[0][113] = "NFFL52B"; //Check
   FloorSound[0][114] = "NFFL53B"; //Check
   FloorSound[0][115] = "NFFL54GN"; //Check
   FloorSound[0][116] = "NFFL54GR"; //Check
   FloorSound[0][117] = "NFFL54H"; //Check
   FloorSound[0][118] = "NFFL72GR"; //Check
   FloorSound[0][119] = "NFFT1BR"; //Check
   FloorSound[0][120] = "NFFT1GN"; //Check
   FloorSound[0][121] = "NFFT5GN"; //Check
   FloorSound[0][122] = "NFFT5GR"; //Check
   FloorSound[0][123] = "NFFT11GR"; //Check
   FloorSound[0][124] = "NFFT13GN"; //Check
   FloorSound[0][125] = "NFFT13GR"; //Check
   FloorSound[0][126] = "NFFT20BR"; //Check
   FloorSound[0][127] = "NFFT20GN"; //Check
   FloorSound[0][128] = "NFFT55GN"; //Check
   FloorSound[0][129] = "NFFT72BR"; //Check
   FloorSound[0][130] = "NFFT72GR"; //Check
   FloorSound[0][131] = "NFFT72RD"; //Check
   FloorSound[0][132] = "NFGCN1_1"; //Check
   FloorSound[0][133] = "NFGCN1_3"; //Check
   FloorSound[0][134] = "NFRR09GN"; //Check
   FloorSound[0][135] = "NFRR09GR"; //Check
   FloorSound[0][136] = "NFRR10GN"; //Check
   FloorSound[0][137] = "NFRR10GR"; //Check
   FloorSound[0][138] = "NFRR13BR"; //Check
   FloorSound[0][139] = "NFRR16GR"; //Check
   FloorSound[0][140] = "NFSL14GN"; //Check
   FloorSound[0][141] = "NFSL15GN"; //Check
   FloorSound[0][142] = "NFSPHT01"; //Check
   FloorSound[0][143] = "NFSTBN12"; //Check
   FloorSound[0][144] = "NFSTEP03"; //Check
   FloorSound[0][145] = "NFSTGN12"; //Check
   FloorSound[0][146] = "NFSTGY12"; //Check
   FloorSound[0][147] = "NFSTSK02"; //Check
   FloorSound[0][148] = "NFSTTN12"; //Check
   FloorSound[0][149] = "SLIME14"; //Check
   FloorSound[0][150] = "SLIME15"; //Check
   FloorSound[0][151] = "SLIME16"; //Check
   FloorSound[0][152] = "FLOOR0_1"; //Check - Doom (Pre-D2)
   FloorSound[0][153] = "FLOOR0_3"; //Check - Doom (Pre-D2)
   FloorSound[0][154] = "FLOOR0_6"; //Check - Doom (Pre-D2)
   FloorSound[0][155] = "FLOOR1_1"; //Check - Doom (Pre-D2)
   FloorSound[0][156] = "FLOOR1_7"; //Check - Doom (Pre-D2)
   FloorSound[0][157] = "FLOOR4_6"; //Check - Doom (Pre-D2)
   FloorSound[0][158] = "FLOOR4_8"; //Check - Doom (Pre-D2)
   FloorSound[0][159] = "RROCK25"; //Check - DVI Tile
   FloorSound[0][160] = "RROCK26"; //Check - DVI Tile
   FloorSound[0][161] = "RROCK28"; //Check - DVI Tile
   FloorSound[0][162] = "RROCK30"; //Check - DVI Tile
   FloorSound[0][163] = "RROCK31"; //Check - DVI Tile
   FloorSound[0][164] = "RROCK32"; //Check - DVI Tile
   FloorSound[0][165] = "RROCK33"; //Check - DVI Tile
   FloorSound[0][166] = "RROCK36"; //Check - DVI Tile
   FloorSound[0][167] = "AVFLAT10"; //Check - DVI Tile
   FloorSound[0][168] = "AVFLAT25"; //Check - DVI Tile
   FloorSound[0][169] = "AVFLAT26"; //Check - DVI Tile
   FloorSound[0][170] = "AVFLAT33"; //Check - DVI Tile
   FloorSound[0][171] = "R_01"; //Check - DVII Tile
   FloorSound[0][172] = "R_01A"; //Check - DVII Tile
   FloorSound[0][173] = "R_01D"; //Check - DVII Tile
   FloorSound[0][174] = "R_01G"; //Check - DVII Tile
   FloorSound[0][175] = "TILE_00"; //Check - DVII Tile
   FloorSound[0][176] = "TILE_01"; //Check - DVII Tile
   FloorSound[0][177] = "TILE_01B"; //Check - DVII Tile
   FloorSound[0][178] = "TILE_02"; //Check - DVII Tile
   FloorSound[0][179] = "TILE_03"; //Check - DVII Tile
   FloorSound[0][180] = "TILE_04"; //Check - DVII Tile
   FloorSound[0][181] = "TILE_05"; //Check - DVII Tile
   FloorSound[0][182] = "TILE_06"; //Check - DVII Tile
   FloorSound[0][183] = "TILE_07"; //Check - DVII Tile
   FloorSound[0][184] = "TILE_08"; //Check - DVII Tile
   FloorSound[0][185] = "TILE_09"; //Check - DVII Tile
   FloorSound[0][186] = "TILE_10"; //Check - DVII Tile
   FloorSound[0][187] = "TILE_11"; //Check - DVII Tile
   FloorSound[0][188] = "TILE_12"; //Check - DVII Tile
   FloorSound[0][189] = "TILE_12A"; //Check - DVII Tile
   FloorSound[0][190] = "TILE_13"; //Check - DVII Tile
   FloorSound[0][191] = "TILE_14"; //Check - DVII Tile
   FloorSound[0][192] = "TILE_15"; //Check - DVII Tile
   FloorSound[0][193] = "TILE_15B"; //Check - DVII Tile
   FloorSound[0][194] = "TILE_18"; //Check - DVII Tile
   FloorSound[0][195] = "TILE_19"; //Check - DVII Tile
   FloorSound[0][196] = "BRK_19"; //Check - DVII Tile
   FloorSound[0][197] = "BRK_21"; //Check - DVII Tile
   FloorSound[0][198] = "BRK_22"; //Check - DVII Tile
   FloorSound[0][199] = "GREEN_C1"; //Check - DVII Tile
   FloorSound[0][200] = "GREEN_C2"; //Check - DVII Tile
   FloorSound[0][201] = "RY_05"; //Check - DVII Tile
   FloorSound[0][202] = "HEXTILE1"; //Check - DVII Tile
   FloorSound[0][203] = "X14TUA1"; //Check - DVII Tile
   FloorSound[0][204] = "X14TUA2"; //Check - DVII Tile
   FloorSound[0][205] = "X14TUB2"; //Check - DVII Tile
   FloorSound[0][206] = "X14TUC1"; //Check - DVII Tile
   FloorSound[0][207] = "X14WA1"; //Check - DVII Tile
   FloorSound[0][208] = "X14WA2"; //Check - DVII Tile
   FloorSound[0][209] = "X14WB1"; //Check - DVII Tile
   FloorSound[0][210] = "X14WB2"; //Check - DVII Tile
   FloorSound[0][211] = "X14XA1"; //Check - DVII Tile
   FloorSound[0][212] = "X14XA2"; //Check - DVII Tile
   FloorSound[0][213] = "X14XB1"; //Check - DVII Tile
   FloorSound[0][214] = "X14XB2"; //Check - DVII Tile
   FloorSound[0][215] = "X14WA1"; //Check - DVII Tile
   FloorSound[0][216] = "X14WA2"; //Check - DVII Tile
   FloorSound[0][217] = "X14WB1"; //Check - DVII Tile
   FloorSound[0][218] = "X25T1A"; //Check - DVII Tile
   FloorSound[0][219] = "X25T1B"; //Check - DVII Tile
   FloorSound[0][220] = "X25T1C"; //Check - DVII Tile
   FloorSound[0][221] = "X25T2A"; //Check - DVII Tile
   FloorSound[0][222] = "X25T2B"; //Check - DVII Tile
   FloorSound[0][223] = "X25T2C"; //Check - DVII Tile
   FloorSound[0][224] = "TF_01"; //Check - DVII Tile
   FloorSound[0][225] = "TF_02"; //Check - DVII Tile
   FloorSound[0][226] = "X_KACH1"; // TCOTD
   FloorSound[0][227] = "X_KACH2"; // TCOTD
   FloorSound[0][228] = "BKACH01"; // TCOTD
   FloorSound[0][229] = "BKACH02"; // TCOTD
   FloorSound[0][230] = "BKACH04"; // TCOTD
   FloorSound[0][231] = "BKACH05"; // TCOTD
   FloorSound[0][232] = "AKACH01"; // TCOTD
   FloorSound[0][233] = "AKACH02"; // TCOTD
   FloorSound[0][234] = "AKACH03"; // TCOTD
   FloorSound[0][235] = "AKACH04"; // TCOTD
   FloorSound[0][236] = "AKACH08"; // TCOTD
   FloorSound[0][237] = "AKACH09"; // TCOTD
   FloorSound[0][238] = -1;

   // Tile 2
   FloorSound[1][0] = "floor/tile2";
   FloorSound[1][1] = "DEM1_1";
   FloorSound[1][2] = "DEM1_2";
   FloorSound[1][3] = "DEM1_3";
   FloorSound[1][4] = "DEM1_4";
   FloorSound[1][5] = "DEM1_5";
   FloorSound[1][6] = "DEM1_6";
   FloorSound[1][7] = "FLOOR4_6";
   FloorSound[1][8] = "FLOOR4_8";
   FloorSound[1][9] = "ADEL_F65"; //Check
   FloorSound[1][10] = "ADEL_F66"; //Check
   FloorSound[1][11] = "ADEL_F84"; //Check
   FloorSound[1][12] = "ADEL_J08"; //Check
   FloorSound[1][13] = "ADEL_J09"; //Check
   FloorSound[1][14] = "ADEL_J10"; //Check
   FloorSound[1][15] = "ADEL_J11"; //Check
   FloorSound[1][16] = "CFLOOR1"; //Check
   FloorSound[1][17] = "COLMF3"; //Check
   FloorSound[1][18] = "Q2FLAT05"; //Check
   FloorSound[1][19] = "Q2FLAT06"; //Check
   FloorSound[1][20] = "Q2FLAT07"; //Check
   FloorSound[1][21] = "Q2FLAT08"; //Check
   FloorSound[1][22] = "LITE7"; //Check
   FloorSound[1][23] = "NFLTB04H"; //Check
   FloorSound[1][24] = "NFLTB04V"; //Check
   FloorSound[1][25] = "NFLTW03H"; //Check
   FloorSound[1][26] = "NFLTW03V"; //Check
   FloorSound[1][27] = "NFLTW05H"; //Check
   FloorSound[1][28] = "NFLTW05V"; //Check
   FloorSound[1][29] = "MISC_01"; //Check
   FloorSound[1][30] = "ABRWN04"; // TCOTD
   FloorSound[1][31] = "BKACH06"; // TCOTD
   FloorSound[1][32] = -1;

   // Wood
   FloorSound[2][0] = "floor/wood";
   FloorSound[2][1] = "CEIL1_1";
   FloorSound[2][2] = "CRATOP1";
   FloorSound[2][3] = "CRATOP2";
   FloorSound[2][4] = "FLAT5_1";
   FloorSound[2][5] = "FLAT5_2";
   FloorSound[2][6] = "ADEL_F12"; //Check
   FloorSound[2][7] = "ADEL_F13"; //Check
   FloorSound[2][8] = "ADEL_F54"; //Check
   FloorSound[2][9] = "ADEL_F67"; //Check
   FloorSound[2][10] = "ADEL_F68"; //Check
   FloorSound[2][11] = "ADEL_F71"; //Check
   FloorSound[2][12] = "ADEL_F72"; //Check
   FloorSound[2][13] = "ADEL_J18"; //Check
   FloorSound[2][14] = "ADEL_J19"; //Check
   FloorSound[2][15] = "DUNGF1"; //Check
   FloorSound[2][16] = "DUNGF2"; //Check
   FloorSound[2][17] = "DUNGF3"; //Check
   FloorSound[2][18] = "DUNGF4"; //Check
   FloorSound[2][19] = "FTUB1"; //Check
   FloorSound[2][20] = "FTUB2"; //Check
   FloorSound[2][21] = "FTUB3"; //Check
   FloorSound[2][22] = "NFWOOD"; //Check
   FloorSound[2][23] = "NICK_A02"; //Check
   FloorSound[2][24] = "NICK_A03"; //Check
   FloorSound[2][25] = "NICK_A06"; //Check
   FloorSound[2][26] = "NICK_A08"; //Check
   FloorSound[2][27] = "NICK_A09"; //Check
   FloorSound[2][28] = "OLA_F_01"; //Check
   FloorSound[2][29] = "OLA_F_02"; //Check
   FloorSound[2][30] = "SWITCH1"; //Check
   FloorSound[2][31] = "SWITCH2"; //Check
   FloorSound[2][32] = "SWITCH3"; //Check
   FloorSound[2][32] = "SWITCH4"; //Check
   FloorSound[2][34] = "WOODF1"; //Check
   FloorSound[2][35] = "WOODF2"; //Check
   FloorSound[2][36] = "WOODF3"; //Check
   FloorSound[2][37] = "WOODF4"; //Check
   FloorSound[2][38] = "WOODF5"; //Check
   FloorSound[2][39] = "WOODF6"; //Check
   FloorSound[2][40] = "WOODF7"; //Check
   FloorSound[2][41] = "WOODF8"; //Check
   FloorSound[2][42] = "NFPANL01"; //Check
   FloorSound[2][43] = "FLAT6"; //Check - DVI Texture
   FloorSound[2][44] = "FLAT7"; //Check - DVI Texture
   FloorSound[2][45] = "AVFLAT22"; //Check - DVI Tile
   FloorSound[2][46] = "AVFLAT37"; //Check - DVI Tile
   FloorSound[2][47] = "AVFLAT38"; //Check - DVI Tile
   FloorSound[2][48] = "WD_00A"; //Check - DVII Tile
   FloorSound[2][49] = "WD_00D"; //Check - DVII Tile
   FloorSound[2][50] = "WD_00F"; //Check - DVII Tile
   FloorSound[2][51] = "WD_00H"; //Check - DVII Tile
   FloorSound[2][52] = "WD_01"; //Check - DVII Tile
   FloorSound[2][53] = "WD_02"; //Check - DVII Tile
   FloorSound[2][54] = "WD_03"; //Check - DVII Tile
   FloorSound[2][55] = "WD_04"; //Check - DVII Tile
   FloorSound[2][56] = "WD_05"; //Check - DVII Tile
   FloorSound[2][57] = "WD_06"; //Check - DVII Tile
   FloorSound[2][58] = "WD_08"; //Check - DVII Tile
   FloorSound[2][59] = "WD_09"; //Check - DVII Tile
   FloorSound[2][60] = "WD_10"; //Check - DVII Tile
   FloorSound[2][61] = "WD_11"; //Check - DVII Tile
   FloorSound[2][62] = "WD_12"; //Check - DVII Tile
   FloorSound[2][63] = "WD_13"; //Check - DVII Tile
   FloorSound[2][64] = "WD_13J"; //Check - DVII Tile
   FloorSound[2][65] = "WD_13L"; //Check - DVII Tile
   FloorSound[2][66] = "WD_13P"; //Check - DVII Tile
   FloorSound[2][67] = "WD_13T"; //Check - DVII Tile
   FloorSound[2][68] = "WD_14"; //Check - DVII Tile
   FloorSound[2][69] = "WD_15"; //Check - DVII Tile
   FloorSound[2][70] = "WD_16"; //Check - DVII Tile
   FloorSound[2][71] = "WD_17"; //Check - DVII Tile
   FloorSound[2][72] = "WD_18"; //Check - DVII Tile
   FloorSound[2][73] = "WD_19"; //Check - DVII Tile
   FloorSound[2][74] = "WD_20"; //Check - DVII Tile
   FloorSound[2][75] = "WD_21"; //Check - DVII Tile
   FloorSound[2][76] = "CRT_01"; //Check
   FloorSound[2][77] = "CRT_01C"; //Check
   FloorSound[2][78] = "CRATOP3"; //Check
   FloorSound[2][79] = "WD01A"; //Check - DVII Tile
   FloorSound[2][80] = "WD01B"; //Check - DVII Tile
   FloorSound[2][81] = "WD01C"; //Check - DVII Tile
   FloorSound[2][82] = "WD01D"; //Check - DVII Tile
   FloorSound[2][83] = "WD02A"; //Check - DVII Tile
   FloorSound[2][84] = "WD02B"; //Check - DVII Tile
   FloorSound[2][85] = "WD02C"; //Check - DVII Tile
   FloorSound[2][86] = "WD02D"; //Check - DVII Tile
   FloorSound[2][87] = "WD03A"; //Check - DVII Tile
   FloorSound[2][88] = "WD03B"; //Check - DVII Tile
   FloorSound[2][89] = "WD04A"; //Check - DVII Tile
   FloorSound[2][90] = "WD04B"; //Check - DVII Tile
   FloorSound[2][91] = "WD05A"; //Check - DVII Tile
   FloorSound[2][92] = "WD06A"; //Check - DVII Tile
   FloorSound[2][93] = "BMINE01"; // TCOTD
   FloorSound[2][94] = "BMINE02"; // TCOTD
   FloorSound[2][95] = "BMINE03"; // TCOTD
   FloorSound[2][96] = "BMINE05"; // TCOTD
   FloorSound[2][97] = "BWOOD01"; // TCOTD
   FloorSound[2][98] = "BWOOD02"; // TCOTD
   FloorSound[2][99] = "BWOOD03"; // TCOTD
   FloorSound[2][100] = "BWOOD04"; // TCOTD
   FloorSound[2][101] = "BWOOD08"; // TCOTD
   FloorSound[2][102] = "BWOOD10"; // TCOTD
   FloorSound[2][103] = "BWOOD11"; // TCOTD
   FloorSound[2][104] = "BWOOD12"; // TCOTD
   FloorSound[2][105] = "BWOOD13"; // TCOTD
   FloorSound[2][106] = "BWOOD14"; // TCOTD
   FloorSound[2][107] = "BWOOD15"; // TCOTD
   FloorSound[2][108] = "BWOOD21"; // TCOTD
   FloorSound[2][109] = "BWOOD22"; // TCOTD
   FloorSound[2][110] = "BWOOD32"; // TCOTD
   FloorSound[2][111] = "BWOOD67"; // TCOTD
   FloorSound[2][112] = "BWOOD99"; // TCOTD
   FloorSound[2][113] = "AKISTE01"; // TCOTD
   FloorSound[2][114] = "AKISTE02"; // TCOTD
   FloorSound[2][115] = "BMIDG05"; // TCOTD
   FloorSound[2][116] = "AWOOD01"; // TCOTD
   FloorSound[2][117] = "AWOOD02"; // TCOTD
   FloorSound[2][118] = "AWOOD03"; // TCOTD
   FloorSound[2][119] = "AWOOD04"; // TCOTD
   FloorSound[2][120] = "AWOOD08"; // TCOTD
   FloorSound[2][121] = "AWOOD22"; // TCOTD
   FloorSound[2][122] = "AWOOD32"; // TCOTD
   FloorSound[2][123] = -1;

   // Hard Floors, First Section ---FULL, NO MORE ADDING TO THIS---
   FloorSound[3][0] = "floor/hard";
   FloorSound[3][1] = "CEIL3_1";
   FloorSound[3][2] = "CEIL3_2";
   FloorSound[3][3] = "CEIL3_5";
   FloorSound[3][4] = "CEIL3_6";
   FloorSound[3][5] = "CEIL5_1";
   FloorSound[3][6] = "CEIL5_2";
   FloorSound[3][7] = "FLAT5";
   FloorSound[3][8] = "FLOOR0_1";
   FloorSound[3][9] = "FLOOR0_2";
   FloorSound[3][10] = "FLOOR0_3";
   FloorSound[3][11] = "FLOOR1_6";
   FloorSound[3][12] = "FLOOR1_7";
   FloorSound[3][13] = "FLOOR7_1";
   FloorSound[3][14] = "GRNLITE1";
   FloorSound[3][15] = "MFLR8_1";
   FloorSound[3][16] = "ADEL_F62"; //Check
   FloorSound[3][17] = "ALTARF1"; //Check
   FloorSound[3][18] = "ALTARF2"; //Check
   FloorSound[3][19] = "M5"; //Check
   FloorSound[3][20] = "QFLAT01"; //Check
   FloorSound[3][21] = "NFGSTN01"; //Check
   FloorSound[3][22] = "NFPANL02"; //Check
   FloorSound[3][23] = "RROCK34"; //Check - DVI Tile
   FloorSound[3][24] = "AVFLAT01"; //Check - DVI Tile
   FloorSound[3][25] = "AVFLAT02"; //Check - DVI Tile
   FloorSound[3][26] = "AVFLAT04"; //Check - DVI Tile
   FloorSound[3][27] = "AVFLAT05"; //Check - DVI Tile
   FloorSound[3][28] = "AVFLAT07"; //Check - DVI Tile
   FloorSound[3][29] = "AVFLAT08"; //Check - DVI Tile
   FloorSound[3][30] = "AVFLAT09"; //Check - DVI Tile
   FloorSound[3][31] = "AVFLAT13"; //Check - DVI Tile
   FloorSound[3][32] = "AVFLAT14"; //Check - DVI Tile
   FloorSound[3][33] = "AVFLAT15"; //Check - DVI Tile
   FloorSound[3][34] = "AVFLAT17"; //Check - DVI Tile
   FloorSound[3][35] = "AVFLAT18"; //Check - DVI Tile
   FloorSound[3][36] = "AVFLAT19"; //Check - DVI Tile
   FloorSound[3][37] = "AVFLAT27"; //Check - DVI Tile
   FloorSound[3][38] = "AVFLAT29"; //Check - DVI Tile
   FloorSound[3][39] = "AVFLAT31"; //Check - DVI Tile
   FloorSound[3][40] = "AVFLAT32"; //Check - DVI Tile
   FloorSound[3][41] = "AVFLAT34"; //Check - DVI Tile
   FloorSound[3][42] = "BLU"; //Check - DVI Tile
   FloorSound[3][43] = "BLU_01"; //Check - DVII Tile
   FloorSound[3][44] = "BLU_02"; //Check - DVII Tile
   FloorSound[3][45] = "BLU_03"; //Check - DVII Tile
   FloorSound[3][46] = "BLU_05"; //Check - DVII Tile
   FloorSound[3][47] = "BLU_06"; //Check - DVII Tile
   FloorSound[3][48] = "BRK_01"; //Check - DVII Tile
   FloorSound[3][49] = "BRK_02"; //Check - DVII Tile
   FloorSound[3][50] = "BRK_04"; //Check - DVII Tile
   FloorSound[3][51] = "BRK_05"; //Check - DVII Tile
   FloorSound[3][52] = "BRK_5B"; //Check - DVII Tile
   FloorSound[3][53] = "BRK_06"; //Check - DVII Tile
   FloorSound[3][54] = "BRK_07"; //Check - DVII Tile
   FloorSound[3][55] = "BRK_7B"; //Check - DVII Tile
   FloorSound[3][56] = "BRK_08"; //Check - DVII Tile
   FloorSound[3][57] = "BRK_09"; //Check - DVII Tile
   FloorSound[3][58] = "BRK_10"; //Check - DVII Tile
   FloorSound[3][59] = "BRK_10B"; //Check - DVII Tile
   FloorSound[3][60] = "BRK_12"; //Check - DVII Tile
   FloorSound[3][61] = "BRK_12B"; //Check - DVII Tile
   FloorSound[3][62] = "BRK_13"; //Check - DVII Tile
   FloorSound[3][63] = "BRK_13B"; //Check - DVII Tile
   FloorSound[3][64] = "BRK_14"; //Check - DVII Tile
   FloorSound[3][65] = "BRK_14B"; //Check - DVII Tile
   FloorSound[3][66] = "BRK_15"; //Check - DVII Tile
   FloorSound[3][67] = "BRK_15B"; //Check - DVII Tile
   FloorSound[3][68] = "BRK_16"; //Check - DVII Tile
   FloorSound[3][69] = "BRK_16B"; //Check - DVII Tile
   FloorSound[3][70] = "BRK_16E"; //Check - DVII Tile
   FloorSound[3][71] = "BRK_16F"; //Check - DVII Tile
   FloorSound[3][72] = "PINK_02"; //Check - DVII Tile
   FloorSound[3][73] = "PINK_03"; //Check - DVII Tile
   FloorSound[3][74] = "R_03"; //Check - DVII Tile
   FloorSound[3][75] = "R_05"; //Check - DVII Tile
   FloorSound[3][76] = "R_06"; //Check - DVII Tile
   FloorSound[3][77] = "BRK_17"; //Check - DVII Tile
   FloorSound[3][78] = "CEMENT0"; //Check - DVII Tile
   FloorSound[3][79] = "CRK_02"; //Check - DVII Tile
   FloorSound[3][80] = "BLU_09"; //Check - DVII Tile
   FloorSound[3][81] = "R_09"; //Check - DVII Tile
   FloorSound[3][82] = "R_10"; //Check - DVII Tile
   FloorSound[3][83] = "R_15"; //Check - DVII Tile
   FloorSound[3][84] = "R_11"; //Check - DVII Tile
   FloorSound[3][85] = "R_13"; //Check - DVII Tile
   FloorSound[3][86] = "R_22"; //Check - DVII Tile
   FloorSound[3][87] = "R_04"; //Check - DVII Tile
   FloorSound[3][88] = "R_28"; //Check - DVII Tile
   FloorSound[3][89] = "R_25"; //Check - DVII Tile
   FloorSound[3][90] = "R_26"; //Check - DVII Tile
   FloorSound[3][91] = "R_27"; //Check - DVII Tile
   FloorSound[3][92] = "R_22A"; //Check - DVII Tile
   FloorSound[3][93] = "R_09A"; //Check - DVII Tile
   FloorSound[3][94] = "R_13A"; //Check - DVII Tile
   FloorSound[3][95] = "R_03A"; //Check - DVII Tile
   FloorSound[3][96] = "R_05A"; //Check - DVII Tile
   FloorSound[3][97] = "R_16"; //Check - DVII Tile
   FloorSound[3][98] = "R_02"; //Check - DVII Tile
   FloorSound[3][99] = "R_19J"; //Check - DVII Tile
   FloorSound[3][100] = "R_29"; //Check - DVII Tile
   FloorSound[3][101] = "R_30"; //Check - DVII Tile
   FloorSound[3][102] = "R_28J"; //Check - DVII Tile
   FloorSound[3][103] = "R_28L"; //Check - DVII Tile
   FloorSound[3][104] = "R_28N"; //Check - DVII Tile
   FloorSound[3][105] = "R_28O"; //Check - DVII Tile
   FloorSound[3][106] = "R_20"; //Check - DVII Tile
   FloorSound[3][107] = "PUZZ_2A"; //Check - DVII Tile
   FloorSound[3][108] = "PUZZ_4A"; //Check - DVII Tile
   FloorSound[3][109] = "BLU_04"; //Check - DVII Tile
   FloorSound[3][110] = "BLU_08"; //Check - DVII Tile
   FloorSound[3][111] = "BLU_09C"; //Check - DVII Tile
   FloorSound[3][112] = "BLU_11"; //Check - DVII Tile
   FloorSound[3][113] = "BLU_12"; //Check - DVII Tile
   FloorSound[3][114] = "BLU_12B"; //Check - DVII Tile
   FloorSound[3][115] = "BLU_13"; //Check - DVII Tile
   FloorSound[3][116] = "BLU_15"; //Check - DVII Tile
   FloorSound[3][117] = "BLU_19"; //Check - DVII Tile
   FloorSound[3][118] = "BLU_20"; //Check - DVII Tile
   FloorSound[3][119] = "BLU_21"; //Check - DVII Tile
   FloorSound[3][120] = "BLU_22"; //Check - DVII Tile
   FloorSound[3][121] = "BLU_22J"; //Check - DVII Tile
   FloorSound[3][122] = "BLU_23"; //Check - DVII Tile
   FloorSound[3][123] = "BLU_24"; //Check - DVII Tile
   FloorSound[3][124] = "BLU_24J"; //Check - DVII Tile
   FloorSound[3][125] = "BLU_24L"; //Check - DVII Tile
   FloorSound[3][126] = "BLU_24N"; //Check - DVII Tile
   FloorSound[3][127] = "BLU_24O"; //Check - DVII Tile
   FloorSound[3][128] = "BLU_25"; //Check - DVII Tile
   FloorSound[3][129] = "BLU_26"; //Check - DVII Tile
   FloorSound[3][130] = "PANEL_01"; //Check - DVII Tile
   FloorSound[3][131] = "PANEL_02"; //Check - DVII Tile
   FloorSound[3][132] = "PANEL_3"; //Check - DVII Tile
   FloorSound[3][133] = "CRK_07"; //Check - DVII Texture
   FloorSound[3][134] = "CRK_08"; //Check - DVII Texture
   FloorSound[3][135] = "CRK_09"; //Check - DVII Texture
   FloorSound[3][136] = "CRK_11"; //Check - DVII Texture
   FloorSound[3][137] = "CRK_13"; //Check - DVII Texture
   FloorSound[3][138] = "CRK_14"; //Check - DVII Texture
   FloorSound[3][139] = "TLITE6_A"; //Check - DVII Texture
   FloorSound[3][140] = "TLITE7_1"; //Check - DVII Texture
   FloorSound[3][141] = "TLITE7_2"; //Check - DVII Texture
   FloorSound[3][142] = "TLITE7_3"; //Check - DVII Texture
   FloorSound[3][143] = "TLITE7_4"; //Check - DVII Texture
   FloorSound[3][144] = "TLITE9_1"; //Check - DVII Texture
   FloorSound[3][145] = "TLITE9_2"; //Check - DVII Texture
   FloorSound[3][146] = "TLITE9_3"; //Check - DVII Texture
   FloorSound[3][147] = "TLITE9_4"; //Check - DVII Texture
   FloorSound[3][148] = "TLITE9_5"; //Check - DVII Texture
   FloorSound[3][149] = "TLITE9_6"; //Check - DVII Texture
   FloorSound[3][150] = "TLITEA_1"; //Check - DVII Texture
   FloorSound[3][151] = "TLITEA_2"; //Check - DVII Texture
   FloorSound[3][152] = "TLITEA_3"; //Check - DVII Texture
   FloorSound[3][153] = "TLITEA_4"; //Check - DVII Texture
   FloorSound[3][154] = "TLITE_B1"; //Check - DVII Texture
   FloorSound[3][155] = "TLITE_B3"; //Check - DVII Texture
   FloorSound[3][156] = "TLITE_B5"; //Check - DVII Texture
   FloorSound[3][157] = "TLITE_B7"; //Check - DVII Texture
   FloorSound[3][158] = "TLITE_B9"; //Check - DVII Texture
   FloorSound[3][159] = "TLITE_BB"; //Check - DVII Texture
   FloorSound[3][160] = "TLITE_G1"; //Check - DVII Texture
   FloorSound[3][161] = "TLITE_G3"; //Check - DVII Texture
   FloorSound[3][162] = "TLITE_G5"; //Check - DVII Texture
   FloorSound[3][163] = "TLITE_G7"; //Check - DVII Texture
   FloorSound[3][164] = "TLITE_G9"; //Check - DVII Texture
   FloorSound[3][165] = "TLITE_GB"; //Check - DVII Texture
   FloorSound[3][166] = "TLITE_R1"; //Check - DVII Texture
   FloorSound[3][167] = "TLITE_R3"; //Check - DVII Texture
   FloorSound[3][168] = "TLITE_R5"; //Check - DVII Texture
   FloorSound[3][169] = "TLITE_R7"; //Check - DVII Texture
   FloorSound[3][170] = "TLITE_R9"; //Check - DVII Texture
   FloorSound[3][171] = "TLITE_RB"; //Check - DVII Texture
   FloorSound[3][172] = "TLITE_W1"; //Check - DVII Texture
   FloorSound[3][173] = "TLITE_W3"; //Check - DVII Texture
   FloorSound[3][174] = "TLITE_W5"; //Check - DVII Texture
   FloorSound[3][175] = "TLITE_W7"; //Check - DVII Texture
   FloorSound[3][176] = "TLITE_W9"; //Check - DVII Texture
   FloorSound[3][177] = "TLITE_WB"; //Check - DVII Texture
   FloorSound[3][178] = "TLITE_Y1"; //Check - DVII Texture
   FloorSound[3][179] = "TLITE_Y3"; //Check - DVII Texture
   FloorSound[3][180] = "TLITE_Y5"; //Check - DVII Texture
   FloorSound[3][181] = "TLITE_Y7"; //Check - DVII Texture
   FloorSound[3][182] = "TLITE_Y9"; //Check - DVII Texture
   FloorSound[3][183] = "TLITE_YB"; //Check - DVII Texture
   FloorSound[3][184] = "TLITE_BW"; //Check - DVII Texture
   FloorSound[3][185] = "TLITE_BX"; //Check - DVII Texture
   FloorSound[3][186] = "TLITE_BZ"; //Check - DVII Texture
   FloorSound[3][187] = "TLITE_GW"; //Check - DVII Texture
   FloorSound[3][188] = "TLITE_GX"; //Check - DVII Texture
   FloorSound[3][189] = "TLITE_GZ"; //Check - DVII Texture
   FloorSound[3][190] = "TLITE_RW"; //Check - DVII Texture
   FloorSound[3][191] = "TLITE_RX"; //Check - DVII Texture
   FloorSound[3][192] = "TLITE_RZ"; //Check - DVII Texture
   FloorSound[3][193] = "TLITE_YW"; //Check - DVII Texture
   FloorSound[3][194] = "TLITE_YX"; //Check - DVII Texture
   FloorSound[3][195] = "TLITE_YZ"; //Check - DVII Texture
   FloorSound[3][196] = "CEMENT_2"; //Check - DVII Texture
   FloorSound[3][197] = "CEMENT_3"; //Check - DVII Texture
   FloorSound[3][198] = "CEMENT_4"; //Check - DVII Texture
   FloorSound[3][199] = "CEMENT_5"; //Check - DVII Texture
   FloorSound[3][200] = "CEMENT_6"; //Check - DVII Texture
   FloorSound[3][201] = "CEMENT_7"; //Check - DVII Texture
   FloorSound[3][202] = "CEMENT_8"; //Check - DVII Texture
   FloorSound[3][203] = "CEMENT_9"; //Check - DVII Texture
   FloorSound[3][204] = "CEMENT_A"; //Check - DVII Texture
   FloorSound[3][205] = "CEMENT_B"; //Check - DVII Texture
   FloorSound[3][206] = "CEMENT_C"; //Check - DVII Texture
   FloorSound[3][207] = "CEMENT_D"; //Check - DVII Texture
   FloorSound[3][208] = "CEMENT_E"; //Check - DVII Texture
   FloorSound[3][209] = "CEMENT_F"; //Check - DVII Texture
   FloorSound[3][210] = "CEMENT_G"; //Check - DVII Texture
   FloorSound[3][211] = "CEMENT_H"; //Check - DVII Texture
   FloorSound[3][212] = "CEMENT_I"; //Check - DVII Texture
   FloorSound[3][213] = "CEMENT_J"; //Check - DVII Texture
   FloorSound[3][214] = "CEMENT_K"; //Check - DVII Texture
   FloorSound[3][215] = "CEMENT_L"; //Check - DVII Texture
   FloorSound[3][216] = "CEMENT_M"; //Check - DVII Texture
   FloorSound[3][217] = "CEMENT_N"; //Check - DVII Texture
   FloorSound[3][218] = "CEMENT_O"; //Check - DVII Texture
   FloorSound[3][219] = "CEMENT_P"; //Check - DVII Texture
   FloorSound[3][220] = "BRIK_26"; //Check - DVII Texture
   FloorSound[3][221] = "BRK_09C"; //Check - DVII Texture
   FloorSound[3][222] = "BRK_09D"; //Check - DVII Texture
   FloorSound[3][223] = "BRK_09E"; //Check - DVII Texture
   FloorSound[3][224] = "BRK_16D"; //Check - DVII Texture
   FloorSound[3][225] = "BRK_18"; //Check - DVII Texture
   FloorSound[3][226] = "BRK_20"; //Check - DVII Texture
   FloorSound[3][227] = "BRK_23"; //Check - DVII Texture
   FloorSound[3][228] = "BRK_24"; //Check - DVII Texture
   FloorSound[3][229] = "BRK_25"; //Check - DVII Texture
   FloorSound[3][230] = "BRK_26"; //Check - DVII Texture
   FloorSound[3][231] = "BRK_27"; //Check - DVII Texture
   FloorSound[3][232] = "BRK_28"; //Check - DVII Texture
   FloorSound[3][233] = "BRK_28B"; //Check - DVII Texture
   FloorSound[3][234] = "BRK_30"; //Check - DVII Texture
   FloorSound[3][235] = "BRK_30B"; //Check - DVII Texture
   FloorSound[3][236] = "BRK_31"; //Check - DVII Texture
   FloorSound[3][237] = "BRK_31B"; //Check - DVII Texture
   FloorSound[3][238] = "BRK_31E"; //Check - DVII Texture
   FloorSound[3][239] = "BRK_31F"; //Check - DVII Texture
   FloorSound[3][240] = "BRK_32"; //Check - DVII Texture
   FloorSound[3][241] = "BRK_32B"; //Check - DVII Texture
   FloorSound[3][242] = "BRK_32E"; //Check - DVII Texture
   FloorSound[3][243] = "BRK_32F"; //Check - DVII Texture
   FloorSound[3][244] = "GREEN_05"; //Check - DVII Texture
   FloorSound[3][245] = "GREEN_08"; //Check - DVII Texture
   FloorSound[3][246] = "GREEN_11"; //Check - DVII Texture
   FloorSound[3][247] = "GREEN_12"; //Check - DVII Texture
   FloorSound[3][248] = "GREEN_16"; //Check - DVII Texture
   FloorSound[3][249] = -1;

   // Carpet
   FloorSound[4][0] = "floor/carpet";
   FloorSound[4][1] = "CEIL4_1";
   FloorSound[4][2] = "CEIL4_2";
   FloorSound[4][3] = "CEIL4_3";
   FloorSound[4][4] = "FLAT5_3";
   FloorSound[4][5] = "FLAT5_4";
   FloorSound[4][6] = "FLAT5_5";
   FloorSound[4][7] = "FLAT14";
   FloorSound[4][8] = "FLOOR1_1";
   FloorSound[4][9] = "CRATEF1"; //Check
   FloorSound[4][10] = "CRATEF2"; //Check
   FloorSound[4][12] = "IKFLAT02"; //Check
   FloorSound[4][13] = "IKFLAT2"; //Check
   FloorSound[4][14] = "IKFLAT4"; //Check
   FloorSound[4][15] = "TRAV_F01"; //Check
   FloorSound[4][16] = "TRAV_F02"; //Check
   FloorSound[4][17] = "TRAV_F04"; //Check
   FloorSound[4][18] = "N5FL14RD"; //Check
   FloorSound[4][19] = "NFBRLT01"; //Check
   FloorSound[4][20] = "NFBRWN01"; //Check
   FloorSound[4][21] = "NFBRWN02"; //Check
   FloorSound[4][22] = "NFCTOP03"; //Check
   FloorSound[4][23] = "NFFT14RD"; //Check
   FloorSound[4][24] = "NFFT19BR"; //Check
   FloorSound[4][25] = "NFFT19GN"; //Check
   FloorSound[4][26] = "NFGNL1H"; //Check
   FloorSound[4][27] = "NFGRLT01"; //Check
   FloorSound[4][28] = "NFRDLT01"; //Check
   FloorSound[4][29] = "CARP_01"; //Check - DVII Texture
   FloorSound[4][30] = "CARP_02"; //Check - DVII Texture
   FloorSound[4][31] = "CARP_03"; //Check - DVII Texture
   FloorSound[4][32] = "CARP_04A"; //Check - DVII Texture
   FloorSound[4][33] = "CARP_04C"; //Check - DVII Texture
   FloorSound[4][34] = "CARP_05"; //Check - DVII Texture
   FloorSound[4][35] = "CARP_06"; //Check - DVII Texture
   FloorSound[4][36] = "CARP_07"; //Check - DVII Texture
   FloorSound[4][37] = "CARP_08"; //Check - DVII Texture
   FloorSound[4][38] = "CARP_09"; //Check - DVII Texture
   FloorSound[4][39] = "CARP_10"; //Check - DVII Texture
   FloorSound[4][40] = "CARP_11"; //Check - DVII Texture
   FloorSound[4][41] = "CARP_11C"; //Check - DVII Texture
   FloorSound[4][42] = "CARP_12"; //Check - DVII Texture
   FloorSound[4][43] = "CARP_12C"; //Check - DVII Texture
   FloorSound[4][44] = "CARP_13"; //Check - DVII Texture
   FloorSound[4][45] = "X25C01"; //Check - DVII Tile
   FloorSound[4][46] = "X25C02"; //Check - DVII Tile
   FloorSound[4][47] = "X25C03"; //Check - DVII Tile
   FloorSound[4][48] = "X25C04"; //Check - DVII Tile
   FloorSound[4][49] = "BBRWN44"; // TCOTD
   FloorSound[4][50] = "BBRWN64"; // TCOTD
   FloorSound[4][51] = "ATEP01"; // TCOTD
   FloorSound[4][52] = "ATEP04"; // TCOTD
   FloorSound[4][53] = "ATEP05"; // TCOTD
   FloorSound[4][54] = "ATEP07"; // TCOTD
   FloorSound[4][55] = "ATEPP01"; // TCOTD
   FloorSound[4][56] = "ATEPP02"; // TCOTD
   FloorSound[4][57] = "ATEPP03"; // TCOTD
   FloorSound[4][58] = "ATEPP06"; // TCOTD
   FloorSound[4][59] = -1;

   // Rock Floors, First Section
   FloorSound[5][0] = "floor/rock";
   FloorSound[5][1] = "FLAT1_1";
   FloorSound[5][2] = "FLAT1_2";
   FloorSound[5][3] = "FLAT5_6";
   FloorSound[5][4] = "FLAT5_7";
   FloorSound[5][5] = "FLAT5_8";
   FloorSound[5][6] = "FLOOR5_4";
   FloorSound[5][7] = "GRNROCK";
   FloorSound[5][8] = "RROCK03";
   FloorSound[5][9] = "RROCK04";
   FloorSound[5][10] = "RROCK09";
   FloorSound[5][11] = "RROCK10";
   FloorSound[5][12] = "RROCK11";
   FloorSound[5][13] = "RROCK12";
   FloorSound[5][14] = "RROCK13";
   FloorSound[5][15] = "RROCK14";
   FloorSound[5][16] = "RROCK15";
   FloorSound[5][17] = "SLIME13";
   FloorSound[5][18] = "ADEL_F47"; //Check
   FloorSound[5][19] = "ADEL_F48"; //Check
   FloorSound[5][20] = "CITYF20"; //Check
   FloorSound[5][21] = "ROCKF1"; //Check
   FloorSound[5][22] = "ROCKF2"; //Check
   FloorSound[5][23] = "ROCKF3"; //Check
   FloorSound[5][24] = "ROCKF4"; //Check
   FloorSound[5][25] = "ROCKF5"; //Check
   FloorSound[5][26] = "ROCKF6"; //Check
   FloorSound[5][27] = "ROCKF7"; //Check
   FloorSound[5][28] = "ROCKF8"; //Check
   FloorSound[5][29] = "STONEF"; //Check
   FloorSound[5][30] = "NFRR01GR"; //Check
   FloorSound[5][31] = "RROCK01"; //Check
   FloorSound[5][32] = "RROCK16"; //Check
   FloorSound[5][33] = "RROCK17"; //Check
   FloorSound[5][34] = "RROCK18"; //Check
   FloorSound[5][35] = "RROCK19"; //Check
   FloorSound[5][36] = "AVFLAT05"; //Check - DV1 Texture
   FloorSound[5][37] = "ROSA04"; //Check - DV1 Texture
   FloorSound[5][38] = "RROCK21"; //Check - DV1 Texture
   FloorSound[5][39] = "RROCK22"; //Check - DV1 Texture
   FloorSound[5][40] = "RROCK23"; //Check - DV1 Texture
   FloorSound[5][41] = "RROCK24"; //Check - DV1 Texture
   FloorSound[5][42] = "RROCK27"; //Check - DV1 Texture
   FloorSound[5][43] = "RROCKB"; //Check - DV1 Texture
   FloorSound[5][44] = "RROCKG"; //Check - DV1 Texture
   FloorSound[5][45] = "MUTX01"; //Check - DV1 Texture
   FloorSound[5][46] = "MUTX02"; //Check - DV1 Texture
   FloorSound[5][47] = "MUTX03"; //Check - DV1 Texture
   FloorSound[5][48] = "MUTX04"; //Check - DV1 Texture
   FloorSound[5][49] = "RROCK35"; //Check - DVI Tile
   FloorSound[5][50] = "AVFLAT03"; //Check - DVI Tile
   FloorSound[5][51] = "AVFLAT16"; //Check - DVI Tile
   FloorSound[5][52] = "AVFLAT23"; //Check - DVI Tile
   FloorSound[5][53] = "AVFLAT24"; //Check - DVI Tile
   FloorSound[5][54] = "AVFLAT36"; //Check - DVI Tile
   FloorSound[5][55] = "GREEN_04"; //Check - DVII Texture
   FloorSound[5][56] = "MISC_02"; //Check - DVII Texture
   FloorSound[5][57] = "MFLR8_5"; //Check - DVII Texture
   FloorSound[5][58] = "SOIL_01"; //Check - DVII Texture
   FloorSound[5][59] = "R_19"; //Check - DVII Texture
   FloorSound[5][60] = "R_19A"; //Check - DVII Texture
   FloorSound[5][61] = "R_17"; //Check - DVII Texture
   FloorSound[5][62] = "R_23"; //Check - DVII Texture
   FloorSound[5][63] = "R_19B"; //Check - DVII Texture
   FloorSound[5][64] = "R_19O"; //Check - DVII Texture
   FloorSound[5][65] = "R_22E"; //Check - DVII Texture
   FloorSound[5][66] = "BLU_17"; //Check - DVII Texture
   FloorSound[5][67] = "RK_02"; //Check - DVII Texture
   FloorSound[5][68] = "RK_03"; //Check - DVII Texture
   FloorSound[5][69] = "RK_04"; //Check - DVII Texture
   FloorSound[5][70] = "RK_05"; //Check - DVII Texture
   FloorSound[5][71] = "RK_06"; //Check - DVII Texture
   FloorSound[5][72] = "RK_07"; //Check - DVII Texture
   FloorSound[5][73] = "RK_08"; //Check - DVII Texture
   FloorSound[5][74] = "RK_09"; //Check - DVII Texture
   FloorSound[5][75] = "RK_10"; //Check - DVII Texture
   FloorSound[5][76] = "RK_11"; //Check - DVII Texture
   FloorSound[5][77] = "RK_11J"; //Check - DVII Texture
   FloorSound[5][78] = "RK_11O"; //Check - DVII Texture
   FloorSound[5][79] = "CRK_04"; //Check - DVII Texture
   FloorSound[5][80] = "CRK_05"; //Check - DVII Texture
   FloorSound[5][81] = "CRK_06"; //Check - DVII Texture
   FloorSound[5][82] = "CRK_10"; //Check - DVII Texture
   FloorSound[5][83] = "RROCK01A"; //Check
   FloorSound[5][84] = "RROCK02B"; //Check
   FloorSound[5][85] = "RROCK04A"; //Check
   FloorSound[5][86] = "RROCK13B"; //Check
   FloorSound[5][87] = "GREEN_14"; //Check
   FloorSound[5][88] = "BSTON01"; // TCOTD
   FloorSound[5][89] = "BBRICK06"; // TCOTD
   FloorSound[5][90] = "BROCK40"; // TCOTD
   FloorSound[5][91] = "BROCK43"; // TCOTD
   FloorSound[5][92] = "BROCK68"; // TCOTD
   FloorSound[5][93] = "BROCK74"; // TCOTD
   FloorSound[5][94] = "BSTON01"; // TCOTD
   FloorSound[5][95] = "BSTON11"; // TCOTD
   FloorSound[5][96] = "BSTON32"; // TCOTD
   FloorSound[5][97] = "BSTON65"; // TCOTD
   FloorSound[5][98] = "BSTON87"; // TCOTD
   FloorSound[5][99] = "ASTON13"; // TCOTD
   FloorSound[5][100] = "ASTON14"; // TCOTD
   FloorSound[5][101] = "BBRICK10"; // TCOTD
   FloorSound[5][102] = "BBRICK11"; // TCOTD
   FloorSound[5][103] = "BBRICK18"; // TCOTD
   FloorSound[5][104] = "BBRICK19"; // TCOTD
   FloorSound[5][105] = "BBRICK44"; // TCOTD
   FloorSound[5][106] = "BBRICK47"; // TCOTD
   FloorSound[5][107] = "BBRICK67"; // TCOTD
   FloorSound[5][108] = "BBRICK77"; // TCOTD
   FloorSound[5][109] = "AGRN01"; // TCOTD
   FloorSound[5][110] = "AGRN02"; // TCOTD
   FloorSound[5][111] = -1;

   // Metal 1, First Section ---FULL, NO MORE ADDING TO THIS---
   FloorSound[6][0] = "floor/metal";
   FloorSound[6][1] = "CEIL1_2";
   FloorSound[6][2] = "FLAT1_3";
   FloorSound[6][3] = "FLAT4";
   FloorSound[6][4] = "FLAT20";
   FloorSound[6][5] = "FLAT22";
   FloorSound[6][6] = "FLAT23";
   FloorSound[6][7] = "GATE1";
   FloorSound[6][8] = "GATE2";
   FloorSound[6][9] = "GATE3";
   FloorSound[6][10] = "GATE4";
   FloorSound[6][11] = "STEP1";
   FloorSound[6][12] = "STEP2";
   FloorSound[6][13] = "MFLR8_2";
   FloorSound[6][14] = "16X16"; //Check
   FloorSound[6][15] = "T_FL01"; //Check
   FloorSound[6][16] = "T_FL02"; //Check
   FloorSound[6][17] = "16X16LT"; //Check
   FloorSound[6][18] = "A-DAN1"; //Check
   FloorSound[6][19] = "A-DAN2"; //Check
   FloorSound[6][20] = "A-DAN3"; //Check
   FloorSound[6][21] = "A-DAN4"; //Check
   FloorSound[6][22] = "A-DAN5"; //Check
   FloorSound[6][23] = "ADEL_F09"; //Check
   FloorSound[6][24] = "ADEL_F16"; //Check
   FloorSound[6][25] = "ADEL_F33"; //Check
   FloorSound[6][26] = "ADEL_F34"; //Check
   FloorSound[6][27] = "ADEL_F36"; //Check
   FloorSound[6][28] = "ADEL_F50"; //Check
   FloorSound[6][29] = "ADEL_F51"; //Check
   FloorSound[6][30] = "ADEL_F52"; //Check
   FloorSound[6][31] = "ADEL_F53"; //Check
   FloorSound[6][32] = "ADEL_F57"; //Check
   FloorSound[6][33] = "ADEL_F58"; //Check
   FloorSound[6][34] = "ADEL_F59"; //Check
   FloorSound[6][35] = "ADEL_F60"; //Check
   FloorSound[6][36] = "ADEL_F61"; //Check
   FloorSound[6][37] = "ADEL_F64"; //Check
   FloorSound[6][38] = "ADEL_F73"; //Check
   FloorSound[6][39] = "ADEL_F74"; //Check
   FloorSound[6][40] = "ADEL_F80"; //Check
   FloorSound[6][41] = "ADEL_F81"; //Check
   FloorSound[6][42] = "ADEL_F82"; //Check
   FloorSound[6][43] = "ADEL_F83"; //Check
   FloorSound[6][44] = "ADEL_J03"; //Check
   FloorSound[6][45] = "ADEL_J13"; //Check
   FloorSound[6][46] = "ADEL_J16"; //Check
   FloorSound[6][47] = "BRFLR1"; //Check
   FloorSound[6][48] = "BRFLR2"; //Check
   FloorSound[6][49] = "BRFLR2B"; //Check
   FloorSound[6][50] = "BRFLR3"; //Check
   FloorSound[6][51] = "BRFLR3B"; //Check
   FloorSound[6][52] = "BRFLR4"; //Check
   FloorSound[6][53] = "BRFLR4B"; //Check
   FloorSound[6][54] = "BRFLR4B"; //Check
   FloorSound[6][55] = "COPF01"; //Check
   FloorSound[6][56] = "COPF02"; //Check
   FloorSound[6][57] = "COPF03"; //Check
   FloorSound[6][58] = "COPF04"; //Check
   FloorSound[6][59] = "COPF05"; //Check
   FloorSound[6][60] = "COPF06"; //Check
   FloorSound[6][61] = "COPF07"; //Check
   FloorSound[6][62] = "COPF08"; //Check
   FloorSound[6][63] = "COPF09"; //Check
   FloorSound[6][64] = "COPF10"; //Check
   FloorSound[6][65] = "COPF11"; //Check
   FloorSound[6][66] = "COPF12"; //Check
   FloorSound[6][67] = "ECOPF1"; //Check
   FloorSound[6][68] = "ECOPF2"; //Check
   FloorSound[6][69] = "ECOPF3"; //Check
   FloorSound[6][70] = "ECOPF4"; //Check
   FloorSound[6][71] = "ECOPF5"; //Check
   FloorSound[6][72] = "FLOOR1"; //Check
   FloorSound[6][73] = "FLOOR2"; //Check
   FloorSound[6][74] = "FLOOR3"; //Check
   FloorSound[6][75] = "FLOOR4"; //Check
   FloorSound[6][76] = "GRIDR"; //Check
   FloorSound[6][77] = "IKLITE2"; //Check
   FloorSound[6][78] = "IKLITE3"; //Check
   FloorSound[6][79] = "IKLITF01"; //Check
   FloorSound[6][80] = "IKLITF07"; //Check
   FloorSound[6][81] = "IKMTWL02"; //Check
   FloorSound[6][82] = "IKMTWL04"; //Check
   FloorSound[6][83] = "IKTKPN2"; //Check
   FloorSound[6][84] = "IKTKPN3"; //Check
   FloorSound[6][85] = "IKTKPN4"; //Check
   FloorSound[6][86] = "IKTPN02B"; //Check
   FloorSound[6][87] = "IKTPW06A"; //Check
   FloorSound[6][88] = "IKTPW06B"; //Check
   FloorSound[6][89] = "IKTPW06C"; //Check
   FloorSound[6][90] = "LITEF01"; //Check
   FloorSound[6][91] = "LITEF02"; //Check
   FloorSound[6][92] = "LITEF03"; //Check
   FloorSound[6][93] = "LITEF04"; //Check
   FloorSound[6][94] = "LITEF05"; //Check
   FloorSound[6][95] = "LITEF06"; //Check
   FloorSound[6][96] = "LITEF07"; //Check
   FloorSound[6][97] = "LITEF08"; //Check
   FloorSound[6][98] = "LITEF09"; //Check
   FloorSound[6][99] = "LITEF10"; //Check
   FloorSound[6][100] = "LITEF11"; //Check
   FloorSound[6][101] = "LITEF12"; //Check
   FloorSound[6][102] = "LITEF13"; //Check
   FloorSound[6][103] = "LITEF14"; //Check
   FloorSound[6][104] = "LITEF15"; //Check
   FloorSound[6][105] = "METALF01"; //Check
   FloorSound[6][106] = "METALF02"; //Check
   FloorSound[6][107] = "METALF03"; //Check
   FloorSound[6][108] = "METALF04"; //Check
   FloorSound[6][109] = "METALF05"; //Check
   FloorSound[6][110] = "METALF06"; //Check
   FloorSound[6][111] = "METALF07"; //Check
   FloorSound[6][112] = "METALF08"; //Check
   FloorSound[6][113] = "METALF09"; //Check
   FloorSound[6][114] = "METALF10"; //Check
   FloorSound[6][115] = "METALF11"; //Check
   FloorSound[6][116] = "METALF12"; //Check
   FloorSound[6][117] = "METALF13"; //Check
   FloorSound[6][118] = "METALF14"; //Check
   FloorSound[6][119] = "METALF15"; //Check
   FloorSound[6][120] = "METALF16"; //Check
   FloorSound[6][121] = "METALF17"; //Check
   FloorSound[6][122] = "METALF18"; //Check
   FloorSound[6][123] = "METALF19"; //Check
   FloorSound[6][124] = "METALF20"; //Check
   FloorSound[6][125] = "METALF21"; //Check
   FloorSound[6][126] = "METALF22"; //Check
   FloorSound[6][127] = "METALF23"; //Check
   FloorSound[6][128] = "METALF24"; //Check
   FloorSound[6][129] = "NMTRC1"; //Check
   FloorSound[6][130] = "NMTRC2"; //Check
   FloorSound[6][131] = "NMTRC5"; //Check
   FloorSound[6][132] = "PLATF1"; //Check
   FloorSound[6][133] = "PLATF2"; //Check
   FloorSound[6][134] = "QFLAT09"; //Check
   FloorSound[6][135] = "QFLAT10"; //Check
   FloorSound[6][136] = "QSLIP1"; //Check
   FloorSound[6][137] = "QSLIP2"; //Check
   FloorSound[6][138] = "QSLIP3"; //Check
   FloorSound[6][139] = "QSLIP4"; //Check
   FloorSound[6][140] = "QSLIP5"; //Check
   FloorSound[6][141] = "QSLIP6"; //Check
   FloorSound[6][142] = "QSLIP7"; //Check
   FloorSound[6][143] = "SFLOOR1"; //Check
   FloorSound[6][144] = "SFLOOR2"; //Check
   FloorSound[6][145] = "SFLOOR3"; //Check
   FloorSound[6][146] = "SFLOOR4"; //Check
   FloorSound[6][147] = "SFLOOR5"; //Check
   FloorSound[6][148] = "SFLOOR6"; //Check
   FloorSound[6][149] = "SLIPBOT"; //Check
   FloorSound[6][150] = "SLIPTOP"; //Check
   FloorSound[6][151] = "TECHBR1D"; //Check
   FloorSound[6][152] = "TECHBR1E"; //Check
   FloorSound[6][153] = "TECHBR2C"; //Check
   FloorSound[6][154] = "TECHBR2D"; //Check
   FloorSound[6][155] = "TECHF1"; //Check
   FloorSound[6][156] = "TECHF2"; //Check
   FloorSound[6][157] = "TECHF3"; //Check
   FloorSound[6][158] = "TECHF4"; //Check
   FloorSound[6][159] = "TECHF5"; //Check
   FloorSound[6][160] = "TECHFL2"; //Check
   FloorSound[6][161] = "TECHG"; //Check
   FloorSound[6][162] = "TELETOP"; //Check
   FloorSound[6][163] = "NFFL48W"; //Check
   FloorSound[6][164] = "NFFT22GN"; //Check
   FloorSound[6][165] = "NFFT22GR"; //Check
   FloorSound[6][166] = "NFFT22OR"; //Check
   FloorSound[6][167] = "NFFT22RD"; //Check
   FloorSound[6][168] = "NFGF22GN"; //Check
   FloorSound[6][169] = "NFGF22RD"; //Check
   FloorSound[6][170] = "NFGF23"; //Check
   FloorSound[6][171] = "NFMETA03"; //Check
   FloorSound[6][172] = "NFMETA05"; //Check
   FloorSound[6][173] = "NFMETA06"; //Check
   FloorSound[6][174] = "NFMETA45"; //Check
   FloorSound[6][175] = "NFMTPN04"; //Check
   FloorSound[6][176] = "NFMTPN05"; //Check
   FloorSound[6][177] = "NFMTPN06"; //Check
   FloorSound[6][178] = "NFMTSH00"; //Check
   FloorSound[6][179] = "NFMTSV00"; //Check
   FloorSound[6][180] = "NFMTTK01"; //Check
   FloorSound[6][181] = "NFMTTK12"; //Check
   FloorSound[6][182] = "NFMTTK13"; //Check
   FloorSound[6][183] = "NFMTTK14"; //Check
   FloorSound[6][184] = "NFMTTK15"; //Check
   FloorSound[6][185] = "NFMTWL01"; //Check
   FloorSound[6][186] = "NFMTWL02"; //Check
   FloorSound[6][187] = "NFMTWL03"; //Check
   FloorSound[6][188] = "NFSILV3A"; //Check
   FloorSound[6][189] = "NFSVPP01"; //Check
   FloorSound[6][190] = "NFSVPP02"; //Check
   FloorSound[6][191] = "NFSVPP04"; //Check
   FloorSound[6][192] = "NFTKGN00"; //Check
   FloorSound[6][193] = "NFTKGN01"; //Check
   FloorSound[6][194] = "NFTL65BL"; //Check
   FloorSound[6][195] = "NFTL65GN"; //Check
   FloorSound[6][196] = "NFTL65OR"; //Check
   FloorSound[6][197] = "NFTL65WT"; //Check
   FloorSound[6][198] = "NFTL65YL"; //Check
   FloorSound[6][199] = "NFTLTE01"; //Check
   FloorSound[6][200] = "NFTLTE02"; //Check
   FloorSound[6][201] = "VADFLR1"; //Check
   FloorSound[6][202] = "VADFLR2"; //Check
   FloorSound[6][203] = "AVFLAT06"; //Check - DVI Tile
   FloorSound[6][204] = "MT_01"; //Check - DVI Tile
   FloorSound[6][205] = "R_07"; //Check - DVI Tile
   FloorSound[6][206] = "R_08"; //Check - DVI Tile
   FloorSound[6][207] = "IRON_01"; //Check - DVI Tile
   FloorSound[6][208] = "IRON_02"; //Check - DVI Tile
   FloorSound[6][209] = "IRON_03"; //Check - DVI Tile
   FloorSound[6][210] = "IRON_03A"; //Check - DVI Tile
   FloorSound[6][211] = "IRON_04"; //Check - DVI Tile
   FloorSound[6][212] = "IRON_05"; //Check - DVI Tile
   FloorSound[6][213] = "IRON_05B"; //Check - DVI Tile
   FloorSound[6][214] = "IRON_05C"; //Check - DVI Tile
   FloorSound[6][215] = "IRON_05D"; //Check - DVI Tile
   FloorSound[6][216] = "IRON_05F"; //Check - DVI Tile
   FloorSound[6][217] = "IRON_05H"; //Check - DVI Tile
   FloorSound[6][218] = "IRON_05J"; //Check - DVI Tile
   FloorSound[6][219] = "IRON_05L"; //Check - DVI Tile
   FloorSound[6][220] = "IRON_05N"; //Check - DVI Tile
   FloorSound[6][221] = "IRON_06"; //Check - DVI Tile
   FloorSound[6][222] = "IRON_06B"; //Check - DVI Tile
   FloorSound[6][223] = "IRON_08"; //Check - DVI Tile
   FloorSound[6][224] = "IRON_09"; //Check - DVI Tile
   FloorSound[6][225] = "IRON_10"; //Check - DVI Tile
   FloorSound[6][226] = "IRON_11"; //Check - DVI Tile
   FloorSound[6][227] = "IRON_11D"; //Check - DVI Tile
   FloorSound[6][228] = "IRON_12"; //Check - DVI Tile
   FloorSound[6][229] = "IRON_13"; //Check - DVI Tile
   FloorSound[6][230] = "IRON_14"; //Check - DVI Tile
   FloorSound[6][231] = "IRON_14J"; //Check - DVI Tile
   FloorSound[6][232] = "IRON_14O"; //Check - DVI Tile
   FloorSound[6][233] = "IRON_15"; //Check - DVI Tile
   FloorSound[6][234] = "IRON_15J"; //Check - DVI Tile
   FloorSound[6][235] = "IRON_16"; //Check - DVI Tile
   FloorSound[6][236] = "IRON_16J"; //Check - DVI Tile
   FloorSound[6][237] = "IRON_17A"; //Check - DVI Tile
   FloorSound[6][238] = "IRON_17B"; //Check - DVI Tile
   FloorSound[6][239] = "IRON_17E"; //Check - DVI Tile
   FloorSound[6][240] = "IRON_17F"; //Check - DVI Tile
   FloorSound[6][241] = "IRON_17O"; //Check - DVI Tile
   FloorSound[6][242] = "IRON_17Q"; //Check - DVI Tile
   FloorSound[6][243] = "IRON_17S"; //Check - DVI Tile
   FloorSound[6][244] = "IRON_17V"; //Check - DVI Tile
   FloorSound[6][245] = "IRON_17W"; //Check - DVI Tile
   FloorSound[6][246] = "IRON_17X"; //Check - DVI Tile
   FloorSound[6][247] = "IRON_17Y"; //Check - DVI Tile
   FloorSound[6][248] = "IRON_17Z"; //Check - DVI Tile
   FloorSound[6][249] = -1;

   // Dirt
   FloorSound[7][0] = "floor/dirt";
   FloorSound[7][1] = "FLAT10";
   FloorSound[7][2] = "GRASS1";
   FloorSound[7][3] = "GRASS2";
   FloorSound[7][4] = "RROCK16";
   FloorSound[7][5] = "RROCK17";
   FloorSound[7][6] = "RROCK18";
   FloorSound[7][7] = "RROCK19";
   FloorSound[7][8] = "RROCK20";
   FloorSound[7][9] = "MFLR8_4";
   FloorSound[7][10] = "ADEL_J02"; //Check
   FloorSound[7][11] = "ADEL_J04"; //Check
   FloorSound[7][12] = "ADEL_J05"; //Check
   FloorSound[7][13] = "NICK_A04"; //Check
   FloorSound[7][14] = "QGRASS"; //Check
   FloorSound[7][15] = "RROCK29"; //Check - DVI Texture
   FloorSound[7][16] = "DIRT_01"; //Check - DVII Texture
   FloorSound[7][17] = "DIRT_1C"; //Check - DVII Texture
   FloorSound[7][18] = "DIRT_02"; //Check - DVII Texture
   FloorSound[7][19] = "DIRT_03"; //Check - DVII Texture
   FloorSound[7][20] = "DIRT_04"; //Check - DVII Texture
   FloorSound[7][21] = "DIRT_05"; //Check - DVII Texture
   FloorSound[7][22] = "DIRT_05J"; //Check - DVII Texture
   FloorSound[7][23] = "DIRT_06"; //Check - DVII Texture
   FloorSound[7][24] = "DIRT_07"; //Check - DVII Texture
   FloorSound[7][25] = "DIRT_08"; //Check - DVII Texture
   FloorSound[7][26] = "DIRT_09"; //Check - DVII Texture
   FloorSound[7][27] = "DIRT_10"; //Check - DVII Texture
   FloorSound[7][28] = "DIRT_11"; //Check - DVII Texture
   FloorSound[7][29] = "DIRT_12"; //Check - DVII Texture
   FloorSound[7][30] = "DIRT_12C"; //Check - DVII Texture
   FloorSound[7][31] = "DIRT_12J"; //Check - DVII Texture
   FloorSound[7][32] = "DIRT_12L"; //Check - DVII Texture
   FloorSound[7][33] = "DIRT_13"; //Check - DVII Texture
   FloorSound[7][34] = "DIRT_13C"; //Check - DVII Texture
   FloorSound[7][35] = "DIRT_13F"; //Check - DVII Texture
   FloorSound[7][36] = "DIRT_13J"; //Check - DVII Texture
   FloorSound[7][37] = "DIRT_14"; //Check - DVII Texture
   FloorSound[7][38] = "DIRT_16"; //Check - DVII Texture
   FloorSound[7][39] = "DIRT_17"; //Check - DVII Texture
   FloorSound[7][40] = "DIRT_17C"; //Check - DVII Texture
   FloorSound[7][41] = "DIRT_17J"; //Check - DVII Texture
   FloorSound[7][42] = "DIRT_18"; //Check - DVII Texture
   FloorSound[7][43] = "DIRT_19"; //Check - DVII Texture
   FloorSound[7][44] = "DIRT_20"; //Check - DVII Texture
   FloorSound[7][45] = "DIRT_21"; //Check - DVII Texture
   FloorSound[7][46] = "DIRT_22"; //Check - DVII Texture
   FloorSound[7][47] = "DIRT_23"; //Check - DVII Texture
   FloorSound[7][48] = "DIRT_24"; //Check - DVII Texture
   FloorSound[7][49] = "DIRT_25"; //Check - DVII Texture
   FloorSound[7][50] = "DIRT_26"; //Check - DVII Texture
   FloorSound[7][51] = "DIRT_27"; //Check - DVII Texture
   FloorSound[7][52] = "DIRT_28"; //Check - DVII Texture
   FloorSound[7][53] = "PUZZ_3A"; //Check - DVII Texture
   FloorSound[7][54] = "PUZZ_3B"; //Check - DVII Texture
   FloorSound[7][55] = "PUZZ_3C"; //Check - DVII Texture
   FloorSound[7][56] = "PUZZ_3D"; //Check - DVII Texture
   FloorSound[7][57] = "SAND_01"; //Check - DVII Texture
   FloorSound[7][58] = "X_DIRT01"; //Check - TCOTD:A
   FloorSound[7][59] = "X_DIRT02"; //Check - TCOTD:A
   FloorSound[7][60] = -1;

   // Gravel
   FloorSound[8][0] = "floor/gravel";
   FloorSound[8][1] = "FLOOR6_1";
   FloorSound[8][2] = "FLOOR6_2";
   FloorSound[8][3] = "MFLR8_3";
   FloorSound[8][4] = "ADEL_F04"; //Check
   FloorSound[8][5] = "ADEL_F75"; //Check
   FloorSound[8][6] = "ADEL_F76"; //Check
   FloorSound[8][7] = "ADEL_J01"; //Check
   FloorSound[8][8] = "ADEL_J17"; //Check
   FloorSound[8][9] = "CITYF11"; //Check
   FloorSound[8][10] = "CITYF12"; //Check
   FloorSound[8][11] = "CITYF19"; //Check
   FloorSound[8][12] = "CITYF21"; //Check
   FloorSound[8][13] = "COLMF1"; //Check
   FloorSound[8][14] = "COLMF2"; //Check
   FloorSound[8][15] = "COLMF4"; //Check
   FloorSound[8][16] = "GRAVE01"; //Check
   FloorSound[8][17] = "GRAVE02"; //Check
   FloorSound[8][18] = "GRAVE03"; //Check
   FloorSound[8][19] = "GRAVE04"; //Check
   FloorSound[8][20] = "GRAVE05"; //Check
   FloorSound[8][21] = "GRAVE06"; //Check
   FloorSound[8][22] = "GRAVE07"; //Check
   FloorSound[8][23] = "GRAVE08"; //Check
   FloorSound[8][24] = "GRAVE09"; //Check
   FloorSound[8][25] = "GRAVE10"; //Check
   FloorSound[8][26] = "GRAVE11"; //Check
   FloorSound[8][27] = "GRAVE12"; //Check
   FloorSound[8][28] = "GROUND1"; //Check
   FloorSound[8][29] = "GROUND2"; //Check
   FloorSound[8][30] = "GROUND3"; //Check
   FloorSound[8][31] = "GROUND4"; //Check
   FloorSound[8][32] = "NFMF82BR"; //Check
   FloorSound[8][33] = "NFMF82GN"; //Check
   FloorSound[8][34] = "NFMF82GR"; //Check
   FloorSound[8][35] = "FLOOR6G"; //Check - DVI Texture
   FloorSound[8][36] = "FLOOR6B"; //Check - DVI Texture
   FloorSound[8][37] = "MUTX05"; //Check - DVI Texture
   FloorSound[8][38] = "GREEN_02"; //Check - DVII Texture
   FloorSound[8][39] = "PINK_01"; //Check - DVII Tile
   FloorSound[8][40] = "RK_01"; //Check - DVII Tile
   FloorSound[8][41] = "CRK_03"; //Check - DVII Tile
   FloorSound[8][42] = "R_18"; //Check - DVII Texture
   FloorSound[8][43] = "CRK_12"; //Check - DVII Texture
   FloorSound[8][44] = -1;

   // Metal 2
   FloorSound[9][0] = "floor/met2";
   FloorSound[9][1] = "SLIME14";
   FloorSound[9][2] = "SLIME15";
   FloorSound[9][3] = "SLIME16";
   FloorSound[9][4] = "ADEL_F70"; //Check
   FloorSound[9][5] = "PUZZ_1A"; //Check - DVII Texture
   FloorSound[9][6] = "PUZZ_1B"; //Check - DVII Texture
   FloorSound[9][7] = "PUZZ_1C"; //Check - DVII Texture
   FloorSound[9][8] = "PUZZ_1D"; //Check - DVII Texture
   FloorSound[9][9] = "BLU_10A"; //Check - DVII Texture
   FloorSound[9][10] = "D64_01"; //Check - DVII Texture
   FloorSound[9][11] = "D64_02"; //Check - DVII Texture
   FloorSound[9][12] = "D64_03"; //Check - DVII Texture
   FloorSound[9][13] = "D64_04"; //Check - DVII Texture
   FloorSound[9][14] = "D64_05"; //Check - DVII Texture
   FloorSound[9][15] = "D64_06"; //Check - DVII Texture
   FloorSound[9][16] = "D64_07"; //Check - DVII Texture
   FloorSound[9][17] = "D64_08"; //Check - DVII Texture
   FloorSound[9][18] = "STEP0"; //Check - DVII Texture
   FloorSound[9][19] = "STEP00"; //Check - DVII Texture
   FloorSound[9][20] = "STEP000"; //Check - DVII Texture
   FloorSound[9][21] = "STEP0000"; //Check - DVII Texture
   FloorSound[9][22] = "GATE3A"; //Check - DVII Texture
   FloorSound[9][23] = "GATE4"; //Check - DVII Texture
   FloorSound[9][24] = "GATE4A"; //Check - DVII Texture
   FloorSound[9][25] = "GATE5"; //Check - DVII Texture
   FloorSound[9][26] = "GATE5A"; //Check - DVII Texture
   FloorSound[9][27] = "GATE6"; //Check - DVII Texture
   FloorSound[9][28] = "GATE6A"; //Check - DVII Texture
   FloorSound[9][29] = "GATE7"; //Check - DVII Texture
   FloorSound[9][30] = "GATE7A"; //Check - DVII Texture
   FloorSound[9][31] = "GATE8"; //Check - DVII Texture
   FloorSound[9][32] = "GATE8A"; //Check - DVII Texture
   FloorSound[9][33] = "GATE9"; //Check - DVII Texture
   FloorSound[9][34] = "GATE9A"; //Check - DVII Texture
   FloorSound[9][35] = "ARUST40"; // TCOTD
   FloorSound[9][36] = "BRUST01"; // TCOTD
   FloorSound[9][37] = "BRUST02"; // TCOTD
   FloorSound[9][38] = "BRUST03"; //Check - DVII Texture
   FloorSound[9][39] = "BRUST04"; //Check - DVII Texture
   FloorSound[9][40] = "BRUST05"; //Check - DVII Texture
   FloorSound[9][41] = "BRUST06"; //Check - DVII Texture
   FloorSound[9][42] = "BRUST10"; //Check - DVII Texture
   FloorSound[9][43] = "BRUST12"; //Check - DVII Texture
   FloorSound[9][44] = "BRUST13"; //Check - DVII Texture
   FloorSound[9][45] = "BMETA01"; //Check - DVII Texture
   FloorSound[9][46] = "BMETAL01"; //Check - DVII Texture
   FloorSound[9][47] = "BMETAL05"; //Check - DVII Texture
   FloorSound[9][48] = "BMETAL06"; //Check - DVII Texture
   FloorSound[9][49] = "BMETAL09"; //Check - DVII Texture
   FloorSound[9][50] = "BMETAL2A"; //Check - DVII Texture
   FloorSound[9][51] = "BMETAL2B"; //Check - DVII Texture
   FloorSound[9][52] = "BMETAL99"; //Check - DVII Texture
   FloorSound[9][53] = -1;

   // Slimey/Fleshy Surfaces
   FloorSound[10][0] = "floor/slimy";
   FloorSound[10][1] = "BLOOD1";
   FloorSound[10][2] = "BLOOD2";
   FloorSound[10][3] = "BLOOD3";
   FloorSound[10][4] = "SLIME01";
   FloorSound[10][5] = "SLIME02";
   FloorSound[10][6] = "SLIME03";
   FloorSound[10][7] = "SLIME04";
   FloorSound[10][8] = "SLIME05";
   FloorSound[10][9] = "SLIME06";
   FloorSound[10][10] = "SLIME07";
   FloorSound[10][11] = "SLIME08";
   FloorSound[10][12] = "AQUAFLAT"; //Check
   FloorSound[10][13] = "NICK_A05"; //Check
   FloorSound[10][14] = "ORG11B"; //Check
   FloorSound[10][15] = "ORG9"; //Check
   FloorSound[10][16] = "QSLIME1"; //Check
   FloorSound[10][17] = "QSLIME9"; //Check
   FloorSound[10][18] = "SLIME05B"; //Check
   FloorSound[10][19] = "W3SNAKE"; //Check
   FloorSound[10][20] = "WBLOOD"; //Check
   FloorSound[10][21] = "SFLR6_1"; //Check
   FloorSound[10][22] = "SFLR6_4"; //Check
   FloorSound[10][23] = "SFLR7_1"; //Check
   FloorSound[10][24] = "SFLR7_4"; //Check
   FloorSound[10][25] = "SNAK7_1"; //Check
   FloorSound[10][26] = "SNAK8_1"; //Check
   FloorSound[10][27] = "HELL5_1"; //Check
   FloorSound[10][28] = "HELL5_2"; //Check
   FloorSound[10][29] = "HELL6_2"; //Check
   FloorSound[10][30] = "HELL6_3"; //Check
   FloorSound[10][31] = "HELL8_1"; //Check
   FloorSound[10][32] = "HELL8_2"; //Check
   FloorSound[10][33] = "HELL8_4"; //Check
   FloorSound[10][34] = "SPINE3_1"; //Check
   FloorSound[10][35] = "SPINE3_2"; //Check
   FloorSound[10][36] = "SPINE4_1"; //Check
   FloorSound[10][37] = "BFALL1"; //Check
   FloorSound[10][38] = "BFALL2"; //Check
   FloorSound[10][39] = "BFALL3"; //Check
   FloorSound[10][40] = "RW47_3"; //Check
   FloorSound[10][41] = "RW47_4"; //Check
   FloorSound[10][42] = "RW48_1"; //Check
   FloorSound[10][43] = "RW48_2"; //Check
   FloorSound[10][44] = "RW48_3"; //Check
   FloorSound[10][45] = "RW48_4"; //Check
   FloorSound[10][46] = "AVFLAT28"; //Check - DVI Texture
   FloorSound[10][47] = "MISC_03"; //Check - DVI Texture
   FloorSound[10][48] = "BRAIN_01"; //Check - DVI Texture
   FloorSound[10][49] = "SKINN1"; //Check - DVI Texture
   FloorSound[10][50] = "SKINN2"; //Check - DVI Texture
   FloorSound[10][51] = "PNK_BD"; //Check - DVI Texture
   FloorSound[10][52] = "SKT1A"; //Check - DVI Texture
   FloorSound[10][53] = "SKT1B"; //Check - DVI Texture
   FloorSound[10][54] = "SKT2A"; //Check - DVI Texture
   FloorSound[10][55] = "SKT2B"; //Check - DVI Texture
   FloorSound[10][56] = "ATEPP99"; // TCOTD
   FloorSound[10][57] = "ABLOOD01"; // TCOTD
   FloorSound[10][58] = -1;

   // Water Floors
   FloorSound[11][0] = "floor/water";
   FloorSound[11][1] = "FWATER1";
   FloorSound[11][2] = "FWATER2";
   FloorSound[11][3] = "FWATER3";
   FloorSound[11][4] = "FWATER4";
   FloorSound[11][5] = "NUKAGE1";
   FloorSound[11][6] = "NUKAGE2";
   FloorSound[11][7] = "NUKAGE3";
   FloorSound[11][8] = "LAVA1";
   FloorSound[11][9] = "LAVA2";
   FloorSound[11][10] = "LAVA3";
   FloorSound[11][11] = "LAVA4";
   FloorSound[11][12] = "ADEL_J14"; //Check
   FloorSound[11][13] = "QFWAT"; //Check
   FloorSound[11][14] = "QLAVA"; //Check
   FloorSound[11][15] = "QLAVA2"; //Check
   FloorSound[11][16] = "QLAVA7"; //Check
   FloorSound[11][17] = "QWATER1"; //Check
   FloorSound[11][18] = "QWATER2"; //Check
   FloorSound[11][19] = "QWATER3"; //Check
   FloorSound[11][20] = "QWATER3A"; //Check
   FloorSound[11][21] = "QWATERT6"; //Check
   FloorSound[11][22] = "SB_FLAT3"; //Check
   FloorSound[11][23] = "SB_FLAT4"; //Check
   FloorSound[11][24] = "W3LAVA"; //Check
   FloorSound[11][25] = "WLAVA"; //Check
   FloorSound[11][26] = "WNUKAGE"; //Check
   FloorSound[11][27] = "WSLIME2"; //Check
   FloorSound[11][28] = "WSLIME"; //Check
   FloorSound[11][29] = "WWATER"; //Check
   FloorSound[11][30] = "ZB3_01"; //Check
   FloorSound[11][31] = "ZB3_02"; //Check
   FloorSound[11][32] = "ZB3_03"; //Check
   FloorSound[11][33] = "ZB3_99"; //Check
   FloorSound[11][34] = "ZB4_01"; //Check
   FloorSound[11][35] = "ZB4_02"; //Check
   FloorSound[11][36] = "ZB4_03"; //Check
   FloorSound[11][37] = "ZB4_99"; //Check
   FloorSound[11][38] = "ZB5_01"; //Check
   FloorSound[11][39] = "ZB5_02"; //Check
   FloorSound[11][40] = "ZB5_03"; //Check
   FloorSound[11][41] = "ZB5_99"; //Check
   FloorSound[11][42] = "ZB6_01"; //Check
   FloorSound[11][43] = "ZB6_02"; //Check
   FloorSound[11][44] = "ZB6_99"; //Check
   FloorSound[11][45] = "ZG3_01"; //Check
   FloorSound[11][46] = "ZG3_02"; //Check
   FloorSound[11][47] = "ZG3_03"; //Check
   FloorSound[11][48] = "ZG3_99"; //Check
   FloorSound[11][49] = "ZG4_01"; //Check
   FloorSound[11][50] = "ZG4_02"; //Check
   FloorSound[11][51] = "ZG4_03"; //Check
   FloorSound[11][52] = "ZG4_99"; //Check
   FloorSound[11][53] = "ZG5_01"; //Check
   FloorSound[11][54] = "ZG5_02"; //Check
   FloorSound[11][55] = "ZG5_03"; //Check
   FloorSound[11][56] = "ZG5_99"; //Check
   FloorSound[11][57] = "ZG6_01"; //Check
   FloorSound[11][58] = "ZG6_02"; //Check
   FloorSound[11][59] = "ZG6_99"; //Check
   FloorSound[11][60] = "ZM1_01"; //Check
   FloorSound[11][61] = "ZM1_02"; //Check
   FloorSound[11][62] = "ZM1_03"; //Check
   FloorSound[11][63] = "ZM1_99"; //Check
   FloorSound[11][64] = "ZM2_01"; //Check
   FloorSound[11][65] = "ZM2_02"; //Check
   FloorSound[11][66] = "ZM2_99"; //Check
   FloorSound[11][67] = "ZM3_01"; //Check
   FloorSound[11][68] = "ZM3_02"; //Check
   FloorSound[11][69] = "ZM3_03"; //Check
   FloorSound[11][70] = "ZM3_99"; //Check
   FloorSound[11][71] = "ZM4_01"; //Check
   FloorSound[11][72] = "ZM4_02"; //Check
   FloorSound[11][73] = "ZM4_03"; //Check
   FloorSound[11][74] = "ZM4_04"; //Check
   FloorSound[11][75] = "ZM4_05"; //Check
   FloorSound[11][76] = "ZM4_06"; //Check
   FloorSound[11][77] = "ZM4_99"; //Check
   FloorSound[11][78] = "ZM5_01"; //Check
   FloorSound[11][79] = "ZM5_02"; //Check
   FloorSound[11][80] = "ZM5_03"; //Check
   FloorSound[11][81] = "ZM5_99"; //Check
   FloorSound[11][82] = "ZR3_01"; //Check
   FloorSound[11][83] = "ZR3_02"; //Check
   FloorSound[11][84] = "ZR3_03"; //Check
   FloorSound[11][85] = "ZR3_99"; //Check
   FloorSound[11][86] = "ZR4_01"; //Check
   FloorSound[11][87] = "ZR4_02"; //Check
   FloorSound[11][88] = "ZR4_03"; //Check
   FloorSound[11][89] = "ZR4_99"; //Check
   FloorSound[11][90] = "ZR5_01"; //Check
   FloorSound[11][91] = "ZR5_02"; //Check
   FloorSound[11][92] = "ZR5_03"; //Check
   FloorSound[11][93] = "ZR5_99"; //Check
   FloorSound[11][94] = "ZR6_01"; //Check
   FloorSound[11][95] = "ZR6_02"; //Check
   FloorSound[11][96] = "ZR6_99"; //Check
   FloorSound[11][97] = "ZY3_01"; //Check
   FloorSound[11][98] = "ZY3_02"; //Check
   FloorSound[11][99] = "ZY3_03"; //Check
   FloorSound[11][100] = "ZY3_99"; //Check
   FloorSound[11][101] = "ZY5_01"; //Check
   FloorSound[11][102] = "ZY5_02"; //Check
   FloorSound[11][103] = "ZY5_03"; //Check
   FloorSound[11][104] = "ZY5_99"; //Check
   FloorSound[11][105] = "ZY6_01"; //Check
   FloorSound[11][106] = "ZY6_02"; //Check
   FloorSound[11][107] = "ZY6_99"; //Check
   FloorSound[11][108] = "ZO1_01"; //Check
   FloorSound[11][109] = "ZO1_02"; //Check
   FloorSound[11][110] = "ZO1_03"; //Check
   FloorSound[11][111] = "ZO1_99"; //Check
   FloorSound[11][112] = "ZO2_01"; //Check
   FloorSound[11][113] = "ZO2_02"; //Check
   FloorSound[11][114] = "ZO2_03"; //Check
   FloorSound[11][115] = "ZO2_99"; //Check
   FloorSound[11][116] = "ZO3_01"; //Check
   FloorSound[11][117] = "ZO3_02"; //Check
   FloorSound[11][118] = "ZO3_03"; //Check
   FloorSound[11][119] = "ZO3_99"; //Check
   FloorSound[11][120] = "ZO4_01"; //Check
   FloorSound[11][121] = "ZO4_02"; //Check
   FloorSound[11][122] = "ZO4_03"; //Check
   FloorSound[11][123] = "ZO4_04"; //Check
   FloorSound[11][124] = "ZO4_05"; //Check
   FloorSound[11][125] = "ZO4_06"; //Check
   FloorSound[11][126] = "ZO4_07"; //Check
   FloorSound[11][127] = "ZO4_08"; //Check
   FloorSound[11][128] = "ZO4_09"; //Check
   FloorSound[11][129] = "ZO4_99"; //Check
   FloorSound[11][130] = "AWATER01"; //Check
   FloorSound[11][131] = "AWATER02"; //Check
   FloorSound[11][132] = "AWATER03"; //Check
   FloorSound[11][133] = "AWATER04"; //Check
   FloorSound[11][134] = "AWATER05"; //Check
   FloorSound[11][135] = "AWATER06"; //Check
   FloorSound[11][136] = "AWATER07"; //Check
   FloorSound[11][137] = "AWATER08"; //Check
   FloorSound[11][138] = "AWATER09"; //Check
   FloorSound[11][139] = "AWATER10"; //Check
   FloorSound[11][140] = "BWATER01"; //Check
   FloorSound[11][141] = "BWATER02"; //Check
   FloorSound[11][142] = "BWATER03"; //Check
   FloorSound[11][143] = "BWATER04"; //Check
   FloorSound[11][144] = "BWATER05"; //Check
   FloorSound[11][145] = "BWATER06"; //Check
   FloorSound[11][146] = "BWATER07"; //Check
   FloorSound[11][147] = "BWATER08"; //Check
   FloorSound[11][148] = "BWATER09"; //Check
   FloorSound[11][149] = "BWATER10"; //Check
   FloorSound[11][150] = -1;

   // Snow Floors, First Section
   FloorSound[12][0] = "floor/snow";
   FloorSound[12][1] = "SNOW";
   FloorSound[12][2] = "SNOW3";
   FloorSound[12][3] = "SB_FLAT5";
   FloorSound[12][4] = "ICE";
   FloorSound[12][5] = "ICE2";
   FloorSound[12][6] = "ICE3";
   FloorSound[12][7] = "ICE4";
   FloorSound[12][8] = "ICE5";
   FloorSound[12][9] = "ICRETE5";
   FloorSound[12][10] = "ASNOW01";
   FloorSound[12][11] = -1;

   // Metal 1, Second Section ---ADD TO THIS ONE---
   FloorSound[13][0] = "floor/metal"; //Check - DVII Tile
   FloorSound[13][1] = "IRON_19"; //Check - DVII Tile
   FloorSound[13][2] = "IRON_20"; //Check - DVII Tile
   FloorSound[13][3] = "IRON_20B"; //Check - DVII Tile
   FloorSound[13][4] = "IRON_21"; //Check - DVII Tile
   FloorSound[13][5] = "IRON_21B"; //Check - DVII Tile
   FloorSound[13][6] = "IRON_21C"; //Check - DVII Tile
   FloorSound[13][7] = "IRON_24"; //Check - DVII Tile
   FloorSound[13][8] = "IRON_24J"; //Check - DVII Tile
   FloorSound[13][9] = "IRON_24M"; //Check - DVII Tile
   FloorSound[13][10] = "IRON_24O"; //Check - DVII Tile
   FloorSound[13][11] = "IRON_25"; //Check - DVII Tile
   FloorSound[13][12] = "IRON_25J"; //Check - DVII Tile
   FloorSound[13][13] = "IRON_25M"; //Check - DVII Tile
   FloorSound[13][14] = "IRON_25O"; //Check - DVII Tile
   FloorSound[13][15] = "R_12"; //Check - DVII Tile
   FloorSound[13][16] = "R_31"; //Check - DVII Tile
   FloorSound[13][17] = "R_32"; //Check - DVII Tile
   FloorSound[13][18] = "R_33"; //Check - DVII Tile
   FloorSound[13][19] = "R_34"; //Check - DVII Tile
   FloorSound[13][20] = "R_35"; //Check - DVII Tile
   FloorSound[13][21] = "R_36"; //Check - DVII Tile
   FloorSound[13][22] = "R_37"; //Check - DVII Tile
   FloorSound[13][23] = "R_38"; //Check - DVII Tile
   FloorSound[13][24] = "R_39"; //Check - DVII Tile
   FloorSound[13][25] = "R_40"; //Check - DVII Tile
   FloorSound[13][26] = "R_41"; //Check - DVII Tile
   FloorSound[13][27] = "R_42"; //Check - DVII Tile
   FloorSound[13][28] = "R_43"; //Check - DVII Tile
   FloorSound[13][29] = "R_44"; //Check - DVII Tile
   FloorSound[13][31] = "IRON_18"; //Check - DVII Tile
   FloorSound[13][32] = "BLU_10"; //Check - DVII Tile
   FloorSound[13][33] = "BLU_27"; //Check - DVII Tile
   FloorSound[13][34] = "BLU_28"; //Check - DVII Tile
   FloorSound[13][35] = "BLU_29"; //Check - DVII Tile
   FloorSound[13][36] = "BLU_30"; //Check - DVII Tile
   FloorSound[13][37] = "BLU_31"; //Check - DVII Tile
   FloorSound[13][38] = "BLU_32"; //Check - DVII Tile
   FloorSound[13][39] = "BLU_33"; //Check - DVII Tile
   FloorSound[13][40] = "BLU_34"; //Check - DVII Tile
   FloorSound[13][41] = "BLU_35"; //Check - DVII Tile
   FloorSound[13][42] = "BLU_36"; //Check - DVII Tile
   FloorSound[13][43] = "BLU_37"; //Check - DVII Tile
   FloorSound[13][44] = "BLU_38"; //Check - DVII Tile
   FloorSound[13][45] = "BLU_39"; //Check - DVII Tile
   FloorSound[13][46] = "BLU_40"; //Check - DVII Tile
   FloorSound[13][47] = "MISC_06"; //Check - DVII Tile
   FloorSound[13][48] = "MISC_08"; //Check - DVII Tile
   FloorSound[13][49] = "MISC_08J"; //Check - DVII Tile
   FloorSound[13][50] = "MISC_08N"; //Check - DVII Tile
   FloorSound[13][51] = "MISC_08O"; //Check - DVII Tile
   FloorSound[13][52] = "MISC_08R"; //Check - DVII Tile
   FloorSound[13][53] = "MISC_08S"; //Check - DVII Tile
   FloorSound[13][54] = "MISC_08T"; //Check - DVII Tile
   FloorSound[13][55] = "MISC_08U"; //Check - DVII Tile
   FloorSound[13][56] = "MISC_08W"; //Check - DVII Tile
   FloorSound[13][57] = "MISC_08Y"; //Check - DVII Tile
   FloorSound[13][58] = "MISC_09"; //Check - DVII Tile
   FloorSound[13][59] = "MISC_10"; //Check - DVII Tile
   FloorSound[13][60] = "MISC_11"; //Check - DVII Tile
   FloorSound[13][61] = "MISC_14"; //Check - DVII Tile
   FloorSound[13][62] = "MISC_15"; //Check - DVII Tile
   FloorSound[13][63] = "MISC_15J"; //Check - DVII Tile
   FloorSound[13][64] = "MISC_15O"; //Check - DVII Tile
   FloorSound[13][65] = "MISC_16"; //Check - DVII Tile
   FloorSound[13][66] = "MISC_16J"; //Check - DVII Tile
   FloorSound[13][67] = "MISC_17"; //Check - DVII Tile
   FloorSound[13][68] = "MISC_18"; //Check - DVII Tile
   FloorSound[13][69] = "MISC_19A"; //Check - DVII Tile
   FloorSound[13][70] = "MISC_19B"; //Check - DVII Tile
   FloorSound[13][71] = "MISC_19C"; //Check - DVII Tile
   FloorSound[13][72] = "MISC_19D"; //Check - DVII Tile
   FloorSound[13][73] = "MISC_19E"; //Check - DVII Tile
   FloorSound[13][74] = "MISC_19F"; //Check - DVII Tile
   FloorSound[13][75] = "MISC_19G"; //Check - DVII Tile
   FloorSound[13][76] = "MISC_19H"; //Check - DVII Tile
   FloorSound[13][77] = "MISC_20A"; //Check - DVII Tile
   FloorSound[13][78] = "MISC_20B"; //Check - DVII Tile
   FloorSound[13][79] = "MISC_20C"; //Check - DVII Tile
   FloorSound[13][80] = "MISC_20D"; //Check - DVII Tile
   FloorSound[13][81] = "MISC_20E"; //Check - DVII Tile
   FloorSound[13][82] = "MISC_20F"; //Check - DVII Tile
   FloorSound[13][83] = "MISC_20G"; //Check - DVII Tile
   FloorSound[13][84] = "MISC_20H"; //Check - DVII Tile
   FloorSound[13][85] = "MT_02"; //Check - DVII Tile
   FloorSound[13][86] = "MT_03"; //Check - DVII Tile
   FloorSound[13][87] = "MT_04"; //Check - DVII Tile
   FloorSound[13][88] = "MT_05"; //Check - DVII Tile
   FloorSound[13][89] = "MT_06"; //Check - DVII Tile
   FloorSound[13][90] = "MT_06E"; //Check - DVII Tile
   FloorSound[13][91] = "MT_07"; //Check - DVII Tile
   FloorSound[13][92] = "MT_08"; //Check - DVII Tile
   FloorSound[13][93] = "MT_09"; //Check - DVII Tile
   FloorSound[13][94] = "MT_10"; //Check - DVII Tile
   FloorSound[13][95] = "MT_11"; //Check - DVII Tile
   FloorSound[13][96] = "MT_12"; //Check - DVII Tile
   FloorSound[13][97] = "MT_13"; //Check - DVII Tile
   FloorSound[13][98] = "MT_14"; //Check - DVII Tile
   FloorSound[13][99] = "MT_15"; //Check - DVII Tile
   FloorSound[13][100] = "MT_16"; //Check - DVII Tile
   FloorSound[13][101] = "MT_17"; //Check - DVII Tile
   FloorSound[13][102] = "MT_18"; //Check - DVII Tile
   FloorSound[13][103] = "MT_19"; //Check - DVII Tile
   FloorSound[13][104] = "MT_20"; //Check - DVII Tile
   FloorSound[13][105] = "MT_20C"; //Check - DVII Tile
   FloorSound[13][106] = "MT_21"; //Check - DVII Tile
   FloorSound[13][107] = "MT_21C"; //Check - DVII Tile
   FloorSound[13][108] = "MT_22"; //Check - DVII Tile
   FloorSound[13][109] = "MT_22C"; //Check - DVII Tile
   FloorSound[13][110] = "MT_22E"; //Check - DVII Tile
   FloorSound[13][111] = "MT_22G"; //Check - DVII Tile
   FloorSound[13][112] = "MT_23"; //Check - DVII Tile
   FloorSound[13][113] = "MT_23C"; //Check - DVII Tile
   FloorSound[13][114] = "MT_23E"; //Check - DVII Tile
   FloorSound[13][115] = "MT_23G"; //Check - DVII Tile
   FloorSound[13][116] = "GREEN_06"; //Check - DVII Tile
   FloorSound[13][117] = "GREEN_E1"; //Check - DVII Tile
   FloorSound[13][118] = "GREEN_E3"; //Check - DVII Tile
   FloorSound[13][119] = "GREEN_E5"; //Check - DVII Tile
   FloorSound[13][120] = "GREEN_E7"; //Check - DVII Tile
   FloorSound[13][121] = "GREEN_E9"; //Check - DVII Tile
   FloorSound[13][122] = "GREEN_EA"; //Check - DVII Tile
   FloorSound[13][123] = "GREEN_EC"; //Check - DVII Tile
   FloorSound[13][124] = "GREEN_EE"; //Check - DVII Tile
   FloorSound[13][125] = "GREEN_EG"; //Check - DVII Tile
   FloorSound[13][126] = "GREEN_EI"; //Check - DVII Tile
   FloorSound[13][127] = "GREEN_EK"; //Check - DVII Tile
   FloorSound[13][128] = "GREEN_EM"; //Check - DVII Tile
   FloorSound[13][129] = "GREEN_EO"; //Check - DVII Tile
   FloorSound[13][130] = "GREEN_EQ"; //Check - DVII Tile
   FloorSound[13][131] = "GREEN_G1"; //Check - DVII Tile
   FloorSound[13][132] = "GREEN_J1"; //Check - DVII Tile
   FloorSound[13][133] = "GREEN_J2"; //Check - DVII Tile
   FloorSound[13][134] = "TKEYB_1A"; //Check - DVII Tile
   FloorSound[13][135] = "TKEYB_1B"; //Check - DVII Tile
   FloorSound[13][136] = "TKEYB_1C"; //Check - DVII Tile
   FloorSound[13][137] = "TKEYB_1D"; //Check - DVII Tile
   FloorSound[13][138] = "TKEYB_2A"; //Check - DVII Tile
   FloorSound[13][139] = "TKEYB_2B"; //Check - DVII Tile
   FloorSound[13][140] = "TKEYB_2C"; //Check - DVII Tile
   FloorSound[13][141] = "TKEYB_2D"; //Check - DVII Tile
   FloorSound[13][142] = "TKEYR_1A"; //Check - DVII Tile
   FloorSound[13][143] = "TKEYR_1B"; //Check - DVII Tile
   FloorSound[13][144] = "TKEYR_1C"; //Check - DVII Tile
   FloorSound[13][145] = "TKEYR_1D"; //Check - DVII Tile
   FloorSound[13][146] = "TKEYR_2A"; //Check - DVII Tile
   FloorSound[13][147] = "TKEYR_2B"; //Check - DVII Tile
   FloorSound[13][148] = "TKEYR_2C"; //Check - DVII Tile
   FloorSound[13][149] = "TKEYR_2D"; //Check - DVII Tile
   FloorSound[13][150] = "TKEYY_1A"; //Check - DVII Tile
   FloorSound[13][151] = "TKEYY_1B"; //Check - DVII Tile
   FloorSound[13][152] = "TKEYY_1C"; //Check - DVII Tile
   FloorSound[13][153] = "TKEYY_1D"; //Check - DVII Tile
   FloorSound[13][154] = "TKEYY_2A"; //Check - DVII Tile
   FloorSound[13][155] = "TKEYY_2B"; //Check - DVII Tile
   FloorSound[13][156] = "TKEYY_2C"; //Check - DVII Tile
   FloorSound[13][157] = "TKEYY_2D"; //Check - DVII Tile
   FloorSound[13][158] = "STES1"; //Check - DVII Tile
   FloorSound[13][159] = "STES2"; //Check - DVII Tile
   FloorSound[13][160] = "CONS2_1"; //Check - DVII Tile
   FloorSound[13][161] = "CONS2_2"; //Check - DVII Tile
   FloorSound[13][162] = "CONS2_3"; //Check - DVII Tile
   FloorSound[13][163] = "CONS2_4"; //Check - DVII Tile
   FloorSound[13][164] = "RY_12"; //Check - DVII Tile
   FloorSound[13][165] = "TLRA1"; //Check - DVII Tile
   FloorSound[13][166] = "TLRA2"; //Check - DVII Tile
   FloorSound[13][167] = "TLRA3"; //Check - DVII Tile
   FloorSound[13][168] = "TLRA4"; //Check - DVII Tile
   FloorSound[13][169] = "TLRB1"; //Check - DVII Tile
   FloorSound[13][170] = "TLRB2"; //Check - DVII Tile
   FloorSound[13][171] = "TLRB3"; //Check - DVII Tile
   FloorSound[13][172] = "TLRB4"; //Check - DVII Tile
   FloorSound[13][173] = "STET1"; //Check - DVII Tile
   FloorSound[13][174] = "STET2"; //Check - DVII Tile
   FloorSound[13][175] = "TFH_01"; //Check - DVII Tile
   FloorSound[13][176] = "ZB1_01"; //Check - DVII Tile
   FloorSound[13][177] = "ZB1_02"; //Check - DVII Tile
   FloorSound[13][178] = "ZB1_03"; //Check - DVII Tile
   FloorSound[13][179] = "ZB1_04"; //Check - DVII Tile
   FloorSound[13][180] = "ZB1_05"; //Check - DVII Tile
   FloorSound[13][181] = "ZB1_99"; //Check - DVII Tile
   FloorSound[13][182] = "ZB2_01"; //Check - DVII Tile
   FloorSound[13][183] = "ZB2_02"; //Check - DVII Tile
   FloorSound[13][184] = "ZB2_03"; //Check - DVII Tile
   FloorSound[13][185] = "ZB2_04"; //Check - DVII Tile
   FloorSound[13][186] = "ZB2_05"; //Check - DVII Tile
   FloorSound[13][187] = "ZB2_99"; //Check - DVII Tile
   FloorSound[13][188] = "ZR1_01"; //Check - DVII Tile
   FloorSound[13][189] = "ZR1_02"; //Check - DVII Tile
   FloorSound[13][190] = "ZR1_03"; //Check - DVII Tile
   FloorSound[13][191] = "ZR1_04"; //Check - DVII Tile
   FloorSound[13][192] = "ZR1_05"; //Check - DVII Tile
   FloorSound[13][193] = "ZR1_99"; //Check - DVII Tile
   FloorSound[13][194] = "ZR2_01"; //Check - DVII Tile
   FloorSound[13][195] = "ZR2_02"; //Check - DVII Tile
   FloorSound[13][196] = "ZR2_03"; //Check - DVII Tile
   FloorSound[13][197] = "ZR2_04"; //Check - DVII Tile
   FloorSound[13][198] = "ZR2_05"; //Check - DVII Tile
   FloorSound[13][199] = "ZR2_99"; //Check - DVII Tile
   FloorSound[13][200] = "ZY1_01"; //Check - DVII Tile
   FloorSound[13][201] = "ZY1_02"; //Check - DVII Tile
   FloorSound[13][202] = "ZY1_03"; //Check - DVII Tile
   FloorSound[13][203] = "ZY1_04"; //Check - DVII Tile
   FloorSound[13][204] = "ZY1_05"; //Check - DVII Tile
   FloorSound[13][205] = "ZY1_99"; //Check - DVII Tile
   FloorSound[13][206] = "ZY2_01"; //Check - DVII Tile
   FloorSound[13][207] = "ZY2_02"; //Check - DVII Tile
   FloorSound[13][208] = "ZY2_03"; //Check - DVII Tile
   FloorSound[13][209] = "ZY2_04"; //Check - DVII Tile
   FloorSound[13][210] = "ZY2_05"; //Check - DVII Tile
   FloorSound[13][211] = "ZY2_99"; //Check - DVII Tile
   FloorSound[13][212] = "ZG1_01"; //Check - DVII Tile
   FloorSound[13][213] = "ZG1_02"; //Check - DVII Tile
   FloorSound[13][214] = "ZG1_03"; //Check - DVII Tile
   FloorSound[13][215] = "ZG1_04"; //Check - DVII Tile
   FloorSound[13][216] = "ZG1_05"; //Check - DVII Tile
   FloorSound[13][217] = "ZG1_99"; //Check - DVII Tile
   FloorSound[13][218] = "ZG2_01"; //Check - DVII Tile
   FloorSound[13][219] = "ZG2_02"; //Check - DVII Tile
   FloorSound[13][220] = "ZG2_03"; //Check - DVII Tile
   FloorSound[13][221] = "ZG2_04"; //Check - DVII Tile
   FloorSound[13][222] = "ZG2_05"; //Check - DVII Tile
   FloorSound[13][223] = "ZG2_99"; //Check - DVII Tile
   FloorSound[13][224] = "U25P01"; //Check - DVII Tile
   FloorSound[13][225] = -1;

   // Hard Floors, Second Section ---ADD TO THIS ONE---
   FloorSound[14][0] = "floor/hard";
   FloorSound[14][1] = "GREEN_17"; //Check - DVII Tile
   FloorSound[14][2] = "GREEN_18"; //Check - DVII Tile
   FloorSound[14][3] = "GREEN_19"; //Check - DVII Tile
   FloorSound[14][4] = "GREEN_24"; //Check - DVII Tile
   FloorSound[14][5] = "GREEN_26"; //Check - DVII Tile
   FloorSound[14][6] = "GREEN_27"; //Check - DVII Tile
   FloorSound[14][7] = "GREEN_A1"; //Check - DVII Tile
   FloorSound[14][8] = "GREEN_A2"; //Check - DVII Tile
   FloorSound[14][9] = "GREEN_B1"; //Check - DVII Tile
   FloorSound[14][10] = "GREEN_B2"; //Check - DVII Tile
   FloorSound[14][11] = "GREEN_A1"; //Check - DVII Tile
   FloorSound[14][12] = "GREEN_C5"; //Check - DVII Tile
   FloorSound[14][13] = "GREEN_D1"; //Check - DVII Tile
   FloorSound[14][14] = "GREEN_D3"; //Check - DVII Tile
   FloorSound[14][15] = "CEMENS0"; //Check - DVII Tile
   FloorSound[14][16] = "CEMENS0J"; //Check - DVII Tile
   FloorSound[14][17] = "CEMENS0M"; //Check - DVII Tile
   FloorSound[14][18] = "CEMENS1"; //Check - DVII Tile
   FloorSound[14][19] = "CEMENS2"; //Check - DVII Tile
   FloorSound[14][20] = "CEMENS2B"; //Check - DVII Tile
   FloorSound[14][21] = "C01"; //Check - DVII Tile
   FloorSound[14][22] = "C02"; //Check - DVII Tile
   FloorSound[14][23] = "C03"; //Check - DVII Tile
   FloorSound[14][24] = "C04"; //Check - DVII Tile
   FloorSound[14][25] = "AZTC_01"; //Check - DVII Tile
   FloorSound[14][26] = "AZTC_02"; //Check - DVII Tile
   FloorSound[14][27] = "AZTC_03"; //Check - DVII Tile
   FloorSound[14][28] = "AZTC_04"; //Check - DVII Tile
   FloorSound[14][29] = "DEM1_7"; //Check - DVII Tile
   FloorSound[14][30] = "DEM2_1"; //Check - DVII Tile
   FloorSound[14][31] = "DEM2_2"; //Check - DVII Tile
   FloorSound[14][32] = "DEM2_3"; //Check - DVII Tile
   FloorSound[14][33] = "DEM2_4"; //Check - DVII Tile
   FloorSound[14][34] = "ROCK21"; //Check - DVII Tile
   FloorSound[14][35] = "RY_04"; //Check - DVII Tile
   FloorSound[14][36] = "RY_06"; //Check - DVII Tile
   FloorSound[14][37] = "RY_13"; //Check - DVII Tile
   FloorSound[14][38] = "RY_15"; //Check - DVII Tile
   FloorSound[14][39] = "RY_19"; //Check - DVII Tile
   FloorSound[14][40] = "RY_20"; //Check - DVII Tile
   FloorSound[14][41] = "RY_21"; //Check - DVII Tile
   FloorSound[14][42] = "RY_22"; //Check - DVII Tile
   FloorSound[14][43] = "EH01A"; //Check - DVII Tile
   FloorSound[14][44] = "EH01B"; //Check - DVII Tile
   FloorSound[14][45] = "EH01C"; //Check - DVII Tile
   FloorSound[14][46] = "EH01D"; //Check - DVII Tile
   FloorSound[14][47] = "EH02A"; //Check - DVII Tile
   FloorSound[14][48] = "EH02B"; //Check - DVII Tile
   FloorSound[14][49] = "EH02C"; //Check - DVII Tile
   FloorSound[14][50] = "EH02D"; //Check - DVII Tile
   FloorSound[14][51] = "EH03A"; //Check - DVII Tile
   FloorSound[14][52] = "EH03B"; //Check - DVII Tile
   FloorSound[14][53] = "EH04A"; //Check - DVII Tile
   FloorSound[14][54] = "EH04B"; //Check - DVII Tile
   FloorSound[14][55] = "EH05A"; //Check - DVII Tile
   FloorSound[14][56] = "EH06A"; //Check - DVII Tile
   FloorSound[14][57] = "EH07A"; //Check - DVII Tile
   FloorSound[14][58] = "EH07B"; //Check - DVII Tile
   FloorSound[14][59] = "EH07C"; //Check - DVII Tile
   FloorSound[14][60] = "EH07D"; //Check - DVII Tile
   FloorSound[14][61] = "EH07E"; //Check - DVII Tile
   FloorSound[14][62] = "EH07F"; //Check - DVII Tile
   FloorSound[14][63] = "EH07G"; //Check - DVII Tile
   FloorSound[14][64] = "EH07H"; //Check - DVII Tile
   FloorSound[14][65] = "EH08A"; //Check - DVII Tile
   FloorSound[14][66] = "EH08B"; //Check - DVII Tile
   FloorSound[14][67] = "EH08C"; //Check - DVII Tile
   FloorSound[14][68] = "EH08D"; //Check - DVII Tile
   FloorSound[14][69] = "EH08E"; //Check - DVII Tile
   FloorSound[14][70] = "EH08F"; //Check - DVII Tile
   FloorSound[14][71] = "EH08G"; //Check - DVII Tile
   FloorSound[14][72] = "EH08H"; //Check - DVII Tile
   FloorSound[14][73] = "EG01A"; //Check - DVII Tile
   FloorSound[14][74] = "EG01B"; //Check - DVII Tile
   FloorSound[14][75] = "EG01C"; //Check - DVII Tile
   FloorSound[14][76] = "EG01D"; //Check - DVII Tile
   FloorSound[14][77] = "EG02A"; //Check - DVII Tile
   FloorSound[14][78] = "EG02B"; //Check - DVII Tile
   FloorSound[14][79] = "EG02C"; //Check - DVII Tile
   FloorSound[14][80] = "EG02D"; //Check - DVII Tile
   FloorSound[14][81] = "EG03A"; //Check - DVII Tile
   FloorSound[14][82] = "EG03B"; //Check - DVII Tile
   FloorSound[14][83] = "EG04A"; //Check - DVII Tile
   FloorSound[14][84] = "EG04B"; //Check - DVII Tile
   FloorSound[14][85] = "EG05A"; //Check - DVII Tile
   FloorSound[14][86] = "EG06A"; //Check - DVII Tile
   FloorSound[14][87] = "EG07A"; //Check - DVII Tile
   FloorSound[14][88] = "EG07B"; //Check - DVII Tile
   FloorSound[14][89] = "EG07C"; //Check - DVII Tile
   FloorSound[14][90] = "EG07D"; //Check - DVII Tile
   FloorSound[14][91] = "EG07E"; //Check - DVII Tile
   FloorSound[14][92] = "EG07F"; //Check - DVII Tile
   FloorSound[14][93] = "EG07G"; //Check - DVII Tile
   FloorSound[14][94] = "EG07H"; //Check - DVII Tile
   FloorSound[14][95] = "EG08A"; //Check - DVII Tile
   FloorSound[14][96] = "EG08B"; //Check - DVII Tile
   FloorSound[14][97] = "EG08C"; //Check - DVII Tile
   FloorSound[14][98] = "EG08D"; //Check - DVII Tile
   FloorSound[14][99] = "EG08E"; //Check - DVII Tile
   FloorSound[14][100] = "EG08F"; //Check - DVII Tile
   FloorSound[14][101] = "EG08G"; //Check - DVII Tile
   FloorSound[14][102] = "EG08H"; //Check - DVII Tile
   FloorSound[14][103] = "EG11A"; //Check - DVII Tile
   FloorSound[13][104] = "EG11B"; //Check - DVII Tile
   FloorSound[14][105] = "EG12A"; //Check - DVII Tile
   FloorSound[14][106] = "EG12B"; //Check - DVII Tile
   FloorSound[14][107] = "X14TA1"; //Check - DVII Tile
   FloorSound[14][108] = "X14TA2"; //Check - DVII Tile
   FloorSound[14][109] = "X14TB1"; //Check - DVII Tile
   FloorSound[14][110] = "X14TB2"; //Check - DVII Tile
   FloorSound[14][111] = "X22M01A"; //Check - DVII Tile
   FloorSound[14][112] = "X22M01B"; //Check - DVII Tile
   FloorSound[14][113] = "X22M01C"; //Check - DVII Tile
   FloorSound[14][114] = "X22M01D"; //Check - DVII Tile
   FloorSound[14][115] = "X22M02A"; //Check - DVII Tile
   FloorSound[14][116] = "X22M02B"; //Check - DVII Tile
   FloorSound[14][117] = "X22M02C"; //Check - DVII Tile
   FloorSound[14][118] = "X22M02D"; //Check - DVII Tile
   FloorSound[14][119] = "X22M03A"; //Check - DVII Tile
   FloorSound[14][120] = "X22M03B"; //Check - DVII Tile
   FloorSound[14][121] = "X22M03C"; //Check - DVII Tile
   FloorSound[14][122] = "X22M03D"; //Check - DVII Tile
   FloorSound[14][123] = "O_CRETE"; //Check - DVII Tile
   FloorSound[14][124] = "TANF01"; //Check - DVII Tile
   FloorSound[14][125] = "TANF02"; //Check - DVII Tile
   FloorSound[14][126] = "ZB7_01"; //Check - DVII Tile
   FloorSound[14][127] = "ZB7_02"; //Check - DVII Tile
   FloorSound[14][128] = "ZB7_03"; //Check - DVII Tile
   FloorSound[14][129] = "ZB7_04"; //Check - DVII Tile
   FloorSound[14][130] = "ZB7_05"; //Check - DVII Tile
   FloorSound[14][131] = "ZB7_99"; //Check - DVII Tile
   FloorSound[14][132] = "ZG7_01"; //Check - DVII Tile
   FloorSound[14][133] = "ZG7_02"; //Check - DVII Tile
   FloorSound[14][134] = "ZG7_03"; //Check - DVII Tile
   FloorSound[14][135] = "ZG7_04"; //Check - DVII Tile
   FloorSound[14][136] = "ZG7_05"; //Check - DVII Tile
   FloorSound[14][137] = "ZG7_99"; //Check - DVII Tile
   FloorSound[14][138] = "ZR7_01"; //Check - DVII Tile
   FloorSound[14][139] = "ZR7_02"; //Check - DVII Tile
   FloorSound[14][140] = "ZR7_03"; //Check - DVII Tile
   FloorSound[14][141] = "ZR7_04"; //Check - DVII Tile
   FloorSound[14][142] = "ZR7_05"; //Check - DVII Tile
   FloorSound[14][143] = "ZR7_99"; //Check - DVII Tile
   FloorSound[14][144] = "ZP1_01"; //Check - DVII Tile
   FloorSound[14][145] = "ZP1_02"; //Check - DVII Tile
   FloorSound[14][146] = "ZP1_03"; //Check - DVII Tile
   FloorSound[14][147] = "ZP1_04"; //Check - DVII Tile
   FloorSound[14][148] = "ZP1_05"; //Check - DVII Tile
   FloorSound[14][149] = "ZP1_99"; //Check - DVII Tile
   FloorSound[14][150] = "ZP2_01"; //Check - DVII Tile
   FloorSound[14][151] = "ZP2_02"; //Check - DVII Tile
   FloorSound[14][152] = "ZP2_03"; //Check - DVII Tile
   FloorSound[14][153] = "ZP2_04"; //Check - DVII Tile
   FloorSound[14][154] = "ZP2_05"; //Check - DVII Tile
   FloorSound[14][155] = "ZP2_99"; //Check - DVII Tile
   FloorSound[14][156] = "ZP3_01"; //Check - DVII Tile
   FloorSound[14][157] = "ZP3_02"; //Check - DVII Tile
   FloorSound[14][158] = "ZP3_03"; //Check - DVII Tile
   FloorSound[14][159] = "ZP3_04"; //Check - DVII Tile
   FloorSound[14][160] = "ZP3_05"; //Check - DVII Tile
   FloorSound[14][161] = "ZP3_99"; //Check - DVII Tile
   FloorSound[14][162] = "AROCK33"; //Check - DVII Tile
   FloorSound[14][163] = "BGREY50"; //Check - DVII Tile
   FloorSound[14][164] = -1;

   // Grassy Floors ---ADD TO THIS ONE---
   FloorSound[15][0] = "floor/grass";
   FloorSound[15][1] = "ZIMMER2"; //Check - TCOTD:A
   FloorSound[15][2] = "ZIMMER7"; //Check - TCOTD:A
   FloorSound[15][3] = "AHEU02"; //Check - TCOTD:A
   FloorSound[15][4] = -1;

   // Grates Floors ---ADD TO THIS ONE---
   FloorSound[16][0] = "floor/grate";
   FloorSound[16][1] = "BSCHACH1"; //Check - TCOTD:A
   FloorSound[16][2] = "BSCHACH2"; //Check - TCOTD:A
   FloorSound[16][3] = -1;
}

SCRIPT "FootSteps_PlayerDeath" DEATH
{
   feet[PlayerNumber ()] = OFF;
}

//*******************
//***Named Scripts***
//*******************

script "EntityAscendantDies" (void)
{
 MiscellaneousVars[299]++;
}

// Emulates the various special scripts in Doom 1/2 mode [E1M8 (Barons), E2M8 (Cyberdemons), E3M8 (SpiderMasterminds), E4M6 (Cyberdemons again), MAP07 (Mancubi/Arachnotrons), etc]
script "DoomMonsterDeathEmulation" OPEN
{
 int LevelTime, TotalCount1, TotalCount2, TotalCount3, Script1Done, Script1Delay, Script2Done, Script2Delay, Script3Done, Script3Delay, CheckAllScripts;

 LevelTime = Timer();
 if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife / Doom64
 {
  if (ClassicDoomType == 4) // Strife
  {
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 29) // Entity's Lair
   {
    if (LevelTime > 2 && MiscellaneousVars[299] >= 3 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Exit_Normal(0); Script1Done++; }
    }
   }
  }
  else if (ClassicDoomType == 3) // Hexen
  {
  }
  else if (ClassicDoomType == 2) // Heretic
  {
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 8) // E1M8 [Liches (tag666)]
   {
    TotalCount1 = ThingCountName("IronLich", 0);
    TotalCount1 += ThingCountName("IronLichNew", 0);
    TotalCount1 += ThingCountName("IceLich", 0);
    TotalCount1 += ThingCountName("GoldLich", 0);
    TotalCount1 += ThingCountName("BloodLich", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 18) // E2M8 [Maulotaurs (tag666)]
   {
    TotalCount1 = ThingCountName("Minotaur", 0);
    TotalCount1 += ThingCountName("MaulotaurNew", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 38) // E4M8 [Liches (tag666)]
   {
    TotalCount1 = ThingCountName("IronLich", 0);
    TotalCount1 += ThingCountName("IronLichNew", 0);
    TotalCount1 += ThingCountName("IceLich", 0);
    TotalCount1 += ThingCountName("GoldLich", 0);
    TotalCount1 += ThingCountName("BloodLich", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 48) // E5M8 [Maulotaurs (tag666)]
   {
    TotalCount1 = ThingCountName("Minotaur", 0);
    TotalCount1 += ThingCountName("MaulotaurNew", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
  }
  else if (ClassicDoomType == 1) // Doom 1
  {
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 8) // E1M8 [Barons (tag666)]
   {
    TotalCount1 = ThingCountName("HellKnight", 0);
    TotalCount1 += ThingCountName("DSHellKnight", 0);
    TotalCount1 += ThingCountName("BaronofHell", 0);
    TotalCount1 += ThingCountName("DSBaronofHell", 0);
    TotalCount1 += ThingCountName("HellWarrior", 0);
    TotalCount1 += ThingCountName("Belphegor", 0);
    TotalCount1 += ThingCountName("BruiserDemon", 0);
    TotalCount1 += ThingCountName("ArchonOfHell", 0);
    TotalCount1 += ThingCountName("CyBruiser", 0);
    TotalCount1 += ThingCountName("PyroDemon", 0);
    TotalCount1 += ThingCountName("WeakenedFlyingBalrog", 0);
    TotalCount1 += ThingCountName("FlyingBalrog", 0);
    TotalCount1 += ThingCountName("Hierophant", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 18) // E2M8 [Cyberdemons (endlevel)]
   {
    TotalCount1 = ThingCountName("Cyberdemon", 0);
    TotalCount1 += ThingCountName("DSCyberdemon", 0);
    TotalCount1 += ThingCountName("Annihilator", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 139) { Exit_Normal(0); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 28) // E3M8 [Spider Masterminds (endlevel)]
   {
    TotalCount1 = ThingCountName("SpiderMastermind", 0);
    TotalCount1 += ThingCountName("DSSpiderMastermind", 0);
    TotalCount1 += ThingCountName("Demolisher", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 139) { Exit_Normal(0); Script1Done++; }
    }
    // PrintBold(d:LevelTime,s:" ",d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" ",d:Script2Done,s:" ",d:Script2Done,s:" ",d:Script3Done,s:" ",d:Script3Done);
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 36) // E4M6 [Cyberdemons (tag666)]
   {
    TotalCount1 = ThingCountName("Cyberdemon", 0);
    TotalCount1 += ThingCountName("DSCyberdemon", 0);
    TotalCount1 += ThingCountName("Annihilator", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Ceiling_RaiseToNearest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 38) // E4M8 [Spider Masterminds (tag666)]
   {
    TotalCount1 = ThingCountName("SpiderMastermind", 0);
    TotalCount1 += ThingCountName("DSSpiderMastermind", 0);
    TotalCount1 += ThingCountName("Demolisher", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToLowest(666, 10); Script1Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
  }
  else if (ClassicDoomType == 0 || ClassicDoomType == 5) // Doom 2 or Doom 64
  {
   if (GetLevelInfo(LEVELINFO_LEVELNUM) == 7) // MAP07 [Mancubi (tag666) and Arachnotrons (tag667)]
   {
    // Mancubi (tag666)
    TotalCount1 = ThingCountName("Fatso", 0);
    TotalCount1 += ThingCountName("DSFatso", 0);
    TotalCount1 += ThingCountName("Hectebus", 0);
    TotalCount1 += ThingCountName("Daedabus", 0);
    if (LevelTime > 2 && TotalCount1 <= 0 && Script1Done == 0) 
    { 
     Script1Delay++;
     if (Script1Delay > 34) { Floor_LowerToNearest(666, 10); Script1Done++; }
    }

    // Arachnotrons (tag667)
    TotalCount2 = ThingCountName("Arachnotron", 0);
    TotalCount2 += ThingCountName("DSArachnotron", 0);
    TotalCount2 += ThingCountName("FusionArachnotron", 0);
    TotalCount2 += ThingCountName("ArachnotronMK2", 0);
    TotalCount2 += ThingCountName("DSRailArachnotron", 0);
    if (LevelTime > 2 && TotalCount2 <= 0 && Script2Done == 0) 
    { 
     Script2Delay++;
     if (Script2Delay > 34) { Floor_RaiseByTexture(667, 10); Script2Done++; }
    }
/*
    PrintBold(d:LevelTime,s:" \n",
              d:TotalCount1,s:" ",d:Script1Done,s:" ",d:Script1Delay,s:" \n",
              d:TotalCount2,s:" ",d:Script2Done,s:" ",d:Script2Delay,s:" \n",
              d:TotalCount3,s:" ",d:Script3Done,s:" ",d:Script3Delay);
*/
   }
  }
 }

 Delay(1);
 Restart;
}

// For the Sceptre's Spin Attack & HellCore Weapons
script "WeaponAngleLoop" (int type, int cap, int setangle, int addangle)
{
 int result;
 if (setangle == 0) // check the cap
 {
  if (MiscellaneousVars[20] >= cap) { SetResultValue(1); MiscellaneousVars[20] = 0; }
  else SetResultValue(0);
 }
 else // increment
 {
  MiscellaneousVars[20] += type;
  if (setangle > 0) result = MiscellaneousVars[20];
  if (addangle != 0) result += addangle;

  // Print(d:addangle);
  SetResultValue(result);
 }

 // Print(d:MiscellaneousVars[20],s:"/",d:cap);
}

// For the Sceptre's Spin Attack & HellCore Weapons
script "WeaponAngleLoopSecondary" (int type, int cap, int setangle, int addangle)
{
 int result;
 if (setangle == 0) // check the cap
 {
  if (MiscellaneousVars[163] >= cap) { SetResultValue(1); MiscellaneousVars[163] = 0; }
  else SetResultValue(0);
 }
 else // increment
 {
  MiscellaneousVars[163] += type;
  if (setangle > 0) result = MiscellaneousVars[163];
  if (addangle != 0) result += addangle;

  // Print(d:addangle);
  SetResultValue(result);
 }

 //Print(d:MiscellaneousVars[163],s:"/",d:cap);
}

script "ChangeMana" (int setadd, int value)
{
 if (setadd == 0) // Sets the stat to a fixed value
 {
  CurrentMana = value;
 }
 else // Adds/Subtracts the stat
 {
  CurrentMana += value;
 }
}

// DEBUG SCRIPT: Cheat to set stats (pukename "GiveStats" [type] [set/add] [value])
// [TYPE]
// 0 = Aeon Points
// 1 = Agility
// 2 = Defense
// 3 = Deftness
// 4 = Sorcery
// 5 = Strength
// 6 = Therapeusis
// 7 = Hit Points/Health
// 8 = Magic Points/Mana
// [SETADD]
// 0 = Sets [value] to a Fixed Number
// 1 = Adds/Subtracts the Value by [value]

script "GiveStats" (int type, int setadd, int value)
{
 if (setadd == 0) // Sets the stat to a fixed value
 {
  if (type == 0) MiscellaneousVars[25] = value; // Set Aeon Points
  if (type == 1) MiscellaneousVars[31] = value; // Set Agility
  if (type == 2) MiscellaneousVars[32] = value; // Set Defense
  if (type == 3) MiscellaneousVars[33] = value; // Set Deftness
  if (type == 4) MiscellaneousVars[34] = value; // Set Sorcery
  if (type == 5) MiscellaneousVars[35] = value; // Set Strength
  if (type == 6) MiscellaneousVars[36] = value; // Set Therapeusis
  if (type == 7) 
  {
   MaxHealthTrue = value;
   if (MaxHealthTrue < 1) MaxHealthTrue = 1;
   SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);
  }
  if (type == 8) MaxMana = value;

 }
 else // Adds/Subtracts the stat
 {
  if (type == 0) // Add Aeon Points
  { 
   MiscellaneousVars[25] += value; 
   MiscellaneousVars[224] += value;
   MiscellaneousVars[2033] = 105;
  }
  if (type == 1) // Add Agility
  {
   MiscellaneousVars[31] += value; 
   MiscellaneousVars[225] += value; 
   MiscellaneousVars[2034] = 105; 
  }
  if (type == 2) // Add Defense
  { 
   MiscellaneousVars[32] += value; 
   MiscellaneousVars[226] += value; 
   MiscellaneousVars[2035] = 105; 
  }
  if (type == 3) // Add Deftness
  { 
   MiscellaneousVars[33] += value; 
   MiscellaneousVars[227] += value; 
   MiscellaneousVars[2036] = 105; 
  }
  if (type == 4) // Add Sorcery 
  { 
   MiscellaneousVars[34] += value; 
   MiscellaneousVars[228] += value; 
   MiscellaneousVars[2037] = 105; 
  }
  if (type == 5) // Add Strength
  { 
   MiscellaneousVars[35] += value; 
   MiscellaneousVars[229] += value; 
   MiscellaneousVars[2038] = 105; 
  }
  if (type == 6) // Add Therapeusis
  {
   MiscellaneousVars[36] += value; 
   MiscellaneousVars[230] += value; 
   MiscellaneousVars[2039] = 105; 
  }
  if (type == 7) // Add MaxHP
  {
   MaxHealthTrue += value;
   MiscellaneousVars[222] += value;
   MiscellaneousVars[2031] = 105;
   if (MaxHealthTrue < 1) MaxHealthTrue = 1;
   SetActorProperty(Player1TID,APROP_SPAWNHEALTH,MaxHealthTrue);
  }
  if (type == 8) // Add MaxMP
  {
   MaxMana += value;
   MiscellaneousVars[223] += value;
   MiscellaneousVars[2032] = 105;
  }
 }

 // Lower End Limits
 if (MiscellaneousVars[25] < 0) MiscellaneousVars[25] = 0;
 if (MiscellaneousVars[31] < 0) MiscellaneousVars[31] = 0;
 if (MiscellaneousVars[32] < 0) MiscellaneousVars[32] = 0;
 if (MiscellaneousVars[33] < 0) MiscellaneousVars[33] = 0;
 if (MiscellaneousVars[34] < 0) MiscellaneousVars[34] = 0;
 if (MiscellaneousVars[35] < 0) MiscellaneousVars[35] = 0;
 if (MiscellaneousVars[36] < 0) MiscellaneousVars[36] = 0;
 if (MaxMana < 1) MaxMana = 1;
 

 // Higher End Limits
 if (MiscellaneousVars[25] > 3072) MiscellaneousVars[25] = 3072;
 if (MiscellaneousVars[31] > 512) MiscellaneousVars[31] = 512;
 if (MiscellaneousVars[32] > 512) MiscellaneousVars[32] = 512;
 if (MiscellaneousVars[33] > 512) MiscellaneousVars[33] = 512;
 if (MiscellaneousVars[34] > 512) MiscellaneousVars[34] = 512;
 if (MiscellaneousVars[35] > 512) MiscellaneousVars[35] = 512;
 if (MiscellaneousVars[36] > 512) MiscellaneousVars[36] = 512;
}

// DEBUG SCRIPT: "Pukename ExpCheat [number of experience to add/subtract/set to] [EXP type] [EXP Increment Type]"
script "ExpCheat" (int EXPAmount, int EXPType, int EXPIncType)
{
 // EXPType = 0 is Normal EXP, 1 is Sceptre EXP, 2 is Both Types
 // EXPIncType = 0 is to add, 1 is to subtract, 2 is to set
 if (EXPType == 0)
 {
  if (EXPIncType == 0) Experience += EXPAmount;
  if (EXPIncType == 1) Experience -= EXPAmount;
  if (EXPIncType == 2) Experience = EXPAmount;
  if (Experience < 0) Experience = 0;
 }
 if (EXPType == 1)
 {
  if (EXPIncType == 0) SceptreLevelEXP += EXPAmount;
  if (EXPIncType == 1) SceptreLevelEXP -= EXPAmount;
  if (EXPIncType == 2) SceptreLevelEXP = EXPAmount;
  if (SceptreLevelEXP < 0) SceptreLevelEXP = 0;
 }
 if (EXPType == 2)
 {
  if (EXPIncType == 0) Experience += EXPAmount;
  if (EXPIncType == 1) Experience -= EXPAmount;
  if (EXPIncType == 2) Experience = EXPAmount;
  if (Experience < 0) Experience = 0;
  if (EXPIncType == 0) SceptreLevelEXP += EXPAmount;
  if (EXPIncType == 1) SceptreLevelEXP -= EXPAmount;
  if (EXPIncType == 2) SceptreLevelEXP = EXPAmount;
  if (SceptreLevelEXP < 0) SceptreLevelEXP = 0;
 }
}

script "HellcoreFireMode" (int Check, int WeaponID)
{
 int a;
 // Print(d:Check,s:" ",d:WeaponID);
 if (Check > 0)
 {
  if (WeaponID == 0) { SetResultValue(MiscellaneousVars[132]); a = MiscellaneousVars[132]; } // Bruiser Fist
  if (WeaponID == 1) { SetResultValue(MiscellaneousVars[133]); a = MiscellaneousVars[133]; } // Archon Fist
  if (WeaponID == 2) { SetResultValue(MiscellaneousVars[134]); a = MiscellaneousVars[134]; } // Pyro Fist
  if (WeaponID == 3) { SetResultValue(MiscellaneousVars[135]); a = MiscellaneousVars[135]; } // Diabloist Hand
  //PrintBold(d:a);
 }
 else
 {
  if (WeaponID == 0) // Bruiser Fist
  {
   MiscellaneousVars[132]++;
   if (MiscellaneousVars[132] > 2) MiscellaneousVars[132] = 0;
   if (MiscellaneousVars[132] == 0) Print(s:"'Spread Wave' Selected.");
   if (MiscellaneousVars[132] == 1) Print(s:"'Bruiser Blast' Selected.");
   if (MiscellaneousVars[132] == 2) Print(s:"'Ground Wave' Selected.");
  }
  if (WeaponID == 1) // Archon Fist
  {
   MiscellaneousVars[133]++;
   if (MiscellaneousVars[133] > 2) MiscellaneousVars[133] = 0;
   if (MiscellaneousVars[133] == 0) Print(s:"'Tri-Plasma' Selected.");
   if (MiscellaneousVars[133] == 1) Print(s:"'Plasma Wave' Selected.");
   if (MiscellaneousVars[133] == 2) Print(s:"'Comet Attack' Selected.");
  }
  if (WeaponID == 2) // Pyro Fist
  {
   MiscellaneousVars[134]++;
   if (MiscellaneousVars[134] > 3) MiscellaneousVars[134] = 0;
   if (MiscellaneousVars[134] == 0) Print(s:"'Pyromatic Shot' Selected.");
   if (MiscellaneousVars[134] == 1) Print(s:"'Pyroball' Selected.");
   if (MiscellaneousVars[134] == 2) Print(s:"'Pyromatic Firebomb' Selected.");
   if (MiscellaneousVars[134] == 3) Print(s:"'Pyroportation' Selected.");
  }
  if (WeaponID == 3) // Diabloist Hand
  {
   MiscellaneousVars[135]++;
   if (MiscellaneousVars[135] > 4) MiscellaneousVars[135] = 0;
   if (MiscellaneousVars[135] == 0) Print(s:"'Gravitaton Glare' Selected.");
   if (MiscellaneousVars[135] == 1) Print(s:"'Diabloic Immolation' Selected.");
   if (MiscellaneousVars[135] == 2) Print(s:"'Fire Thrower' Selected.");
   if (MiscellaneousVars[135] == 3) Print(s:"'Fire Blast' Selected.");
   if (MiscellaneousVars[135] == 4) Print(s:"'Snakes of Fire' Selected.");
  }
 }
}

script "GetRecoil" (int type)
{
 int result;
 if (type == 1) // Phoenix Rod
 {
  result = 4;
  if (MiscellaneousVars[10053] == 1) result = result * 5 / 6;
  if (MiscellaneousVars[10053] == 2) result = result * 4 / 6;
  if (MiscellaneousVars[10053] == 3) result = result * 3 / 6;
  if (MiscellaneousVars[10053] == 4) result = result * 2 / 6;
  if (MiscellaneousVars[10053] == 5) result = result * 1 / 6;
 }
 if (type == 2) // Dual Phoenix Rods
 {
  result = 9;
  if (MiscellaneousVars[10053] == 1) result = result * 5 / 6;
  if (MiscellaneousVars[10053] == 2) result = result * 4 / 6;
  if (MiscellaneousVars[10053] == 3) result = result * 3 / 6;
  if (MiscellaneousVars[10053] == 4) result = result * 2 / 6;
  if (MiscellaneousVars[10053] == 5) result = result * 1 / 6;
 }
 //PrintBold(s:"Recoil: ",d:result);
 SetResultValue(result);
}

// Allows the player to hold an arrow in the Diaris Longbow or unprime it to avoid wasting ammo.
script "BowAntics" (int type)
{
  int buttons;
  if (MiscellaneousVars[2500] != 0) terminate;
  if (PowerupTimer[20] > 0) terminate;
  buttons = GetPlayerInput(0, INPUT_BUTTONS); 
  if (buttons & BT_ALTATTACK) SetResultValue(1);
  else if (buttons & BT_ATTACK) SetResultValue(2);
  else SetResultValue(0);
}

// Allows you to hold back the sceptre if holding down the primary fire to time a swing. :V
script "SceptreHold" (int type)
{
  int buttons;
  if (MiscellaneousVars[2500] != 0) terminate;
  if (PowerupTimer[20] > 0) terminate;
  buttons = GetPlayerInput(0, INPUT_BUTTONS); 
  if (buttons & BT_ALTATTACK) SetResultValue(1);
  else if (buttons & BT_ATTACK) SetResultValue(2);
  else SetResultValue(0);
}

// Allows DECORATE to check the value of a specfic "MiscellaneousVars[]" value for checks
script "MiscVarCheckDECORATE" (int perkvalue)
{
 int result = MiscellaneousVars[perkvalue];
 SetResultValue(result);
}

// Allows DECORATE to SET the value of a specfic "MiscellaneousVars[]" value
script "MiscVarSetDECORATE" (int DMV, int perkvalue)
{
 MiscellaneousVars[DMV] = perkvalue;
}

// Checks the option to see if Flora uses MP outright instead of ammo for Heretic's weapons
script "CheckManaAmmoHeretic" (void)
{
 SetResultValue(GetCVar("dvds_florausesmagicheretic"));
}

// Consumes a set amount of MP/MANA when called or checks for that much for an A_JumpIf call (for Heretic's Tome-fire modes)
script "UseManaAttack" (int amount, int check)
{
 // Check 0 = Takes MP without a return value.
 // Check 1 = Takes NO MP and gives a return value [for just checking]
 // Check 2 = Takes MP if applicable and gives a return value
 if (check > 0)
 {
  if (CheckActorInventory(Player1TID,"RandomInfiniteAmmo") > 0 || CheckActorInventory(Player1TID,"PowerInfiniteAmmo") > 0)
  {
   SetResultValue(1); 
  }
  else
  {
   if (CurrentMana >= amount) 
   {
    if (check > 1)
    {
     CurrentMana -= amount;
     if (CurrentMana < 1) CurrentMana = 0;
     MiscellaneousVars[243] = CurrentMana;
     MiscellaneousVars[238] = CurrentMana;
    }
    SetResultValue(1); 
   }
   else SetResultValue(0);
  }
 }
 else
 {
  CurrentMana -= amount;
  if (CurrentMana < 1) CurrentMana = 0;
  MiscellaneousVars[243] = CurrentMana;
  MiscellaneousVars[238] = CurrentMana;
 }
}

// Consumes a set amount of Stamina when called [1 = 0.01% stamina consumed, etc] or checks for that much for an A_JumpIf call
script "UseStaminaAttack" (int amount, int check)
{
 if (GetCVar("dvds_musou_powertripmode") == 1) amount = amount / 5;
 if (GetCVar("dvds_musou_powertripmode") == 2) amount = amount / 10;
 if (PowerupTimer[10] > 0) amount = amount * 4 / 5; // Oomph [80% consumption]
 if (PowerupTimer[11] > 0) amount = amount * 4 / 5; // Buff [80% consumption]
 if (PowerupTimer[12] > 0) amount = amount * 4 / 5; // Acceleratle [80% consumption]
 if (PowerupTimer[13] > 0) amount = amount * 6 / 5; // Blunt [120% consumption]
 if (PowerupTimer[14] > 0) amount = amount * 6 / 5; // Sap [120% consumption]
 if (PowerupTimer[15] > 0) amount = amount * 6 / 5; // Deceleratle [120% consumption]
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) amount = amount * 3 / 4; // Falcon Knife Earrings [75% Consumption]

 int whole = amount / 100; 
 int modulus = amount % 100;
 if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
 {
  if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used: ",d:whole,s:".0",d:modulus,s:"%");
  else PrintBold(s:"Stamina Used: ",d:whole,s:".",d:modulus,s:"%");
 }

 if (check > 0)
 {
  if (MiscellaneousVars[21] >= amount) 
  {
   if (check > 1)
   {
    MiscellaneousVars[21] -= amount;
    if (MiscellaneousVars[21] < 1) MiscellaneousVars[21] = 0;
   }
   SetResultValue(1); 
  }
  else SetResultValue(0);
 }
 else
 {
  MiscellaneousVars[21] -= amount;
  if (MiscellaneousVars[21] < 1) MiscellaneousVars[21] = 0;
 }
}

script "MaxHPDropChance" (void)
{
 int Chance, roll;

 if (GameSkill() == SKILL_VERY_EASY) Chance = 144; // 9 out of 16
 else if (GameSkill() == SKILL_EASY) Chance = 128; // 8 out of 16
 else if (GameSkill() == SKILL_NORMAL) Chance = 112; // 7 out of 16
 else if (GameSkill() == SKILL_HARD) Chance = 96; // 6 out of 16
 else if (GameSkill() == SKILL_VERY_HARD) Chance = 64; // 4 out of 16
 else Chance = 112;

 roll = random(1,256);
 // PrintBold(d:roll,s:"/",d:Chance);
 SetResultValue(0);
 if (roll <= Chance) SetResultValue(1);
 if (ModType == 0 && GetCVar("dvds_canseedsappear") == 0) SetResultValue(0);
}

script "CheckPlayerIfDead" (void)
{
 if (GetActorProperty(Player1TID,APROP_HEALTH) < 1) SetResultValue(1);
 else SetResultValue(0);
 //PrintBold(s:"1");
}

// Checks and Removes Tension Aura-generators that are at level 0
script "TensionAuraCheckVisual" (void)
{
 if (MiscellaneousVars[181] == 0) Thing_Remove(2001);
}

// CHEAT/DEBUG: Sets Tension level to the specfied amount
script "SetTensionLevel" (int level, int vimstone)
{
 int templevel;
 if (vimstone > 0)
 {
  templevel = MiscellaneousVars[181];
  if (vimstone == 1) 
  {
   templevel += level;
   if (templevel > 4) templevel = 4;
  }
  if (vimstone == 2) 
  {
   templevel += level;
   if (templevel > 7) templevel = 7;
  }
  level = templevel;
 }

 if (level < 0) level = 0;
 if (level > 7) level = 7;

      if (level == 1) FadeRange(254,104,253,0.33,254,104,253,0,1.25);
 else if (level == 2) FadeRange(254,104,253,0.44,254,104,253,0,1.375);
 else if (level == 3) FadeRange(254,104,253,0.55,254,104,253,0,1.5);
 else if (level == 4) FadeRange(254,104,253,0.66,254,104,253,0,1.625);
 else if (level == 5) FadeRange(254,104,253,0.77,254,104,253,0,1.75);
 else if (level == 6) FadeRange(254,104,253,0.88,254,104,253,0,1.875);
 else if (level == 7) FadeRange(254,104,253,0.99,254,104,253,0,2.0);

 SetActivator(Player1TID);
 if (level >= 1 && level <= 3)
 {
  ActivatorSound("tensionincrease",127);
 }
 else if (level >= 4 && level <= 5)
 {
  ActivatorSound("tensionhigh1",127);
  if (CharacterClass == 2 && level == 4 && random(1,3) == 1) PlaySound(Player1TID,"FloraEnterHighTension1",CHAN_VOICE,1.0,0,ATTN_NORM);
  if (CharacterClass == 2 && level == 5 && random(1,2) == 1) PlaySound(Player1TID,"FloraEnterHighTension2",CHAN_VOICE,1.0,0,ATTN_NORM);
 }
 else if (level == 6)
 { 
  ActivatorSound("tensionhigh2",127);
  if (CharacterClass == 2) PlaySound(Player1TID,"FloraEnterHighTension2",CHAN_VOICE,1.0,0,ATTN_NORM);
 }
 else if (level == 7) 
 {
  ActivatorSound("tensionhigh3",127); 
  if (CharacterClass == 2) PlaySound(Player1TID,"FloraEnterHighTension3",CHAN_VOICE,1.0,0,ATTN_NORM);
 }
 else if (MiscellaneousVars[181] > 0 && level == 0)
 {
  PlaySound(Player1TID,"tensionrevert",CHAN_BODY,1.0,0,ATTN_NORM);
 }

 if (level == 1) SpawnProjectile(0, "PlayerTension5BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 2) SpawnProjectile(0, "PlayerTension20BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 3) SpawnProjectile(0, "PlayerTension50BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 4) SpawnProjectile(0, "PlayerTension100BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 5) SpawnProjectile(0, "PlayerTension250BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 6) SpawnProjectile(0, "PlayerTension500BlastRadius", 0, 0, 0, 0, 2102);
 if (level == 7) SpawnProjectile(0, "PlayerTension1000BlastRadius", 0, 0, 0, 0, 2102);
 int project_RealZ = GetActorZ(Player1TID) + (GetActorViewHeight(Player1TID) * 39 / 50) + 8.0;
 SetActorVelocity(2102, 0, 0, 0, 0, 0);
 SetActorAngle(2102, 0.0);
 SetActorPosition(2102, GetActorX(Player1TID), GetActorY(Player1TID), project_RealZ, 0);
 Thing_ChangeTID(2102,4443);

 SetActivator(0);
 MiscellaneousVars[181] = level;

 if (MiscellaneousVars[181] == 1) MiscellaneousVars[183] = 3600;
 if (MiscellaneousVars[181] == 2) MiscellaneousVars[183] = 4320;
 if (MiscellaneousVars[181] == 3) MiscellaneousVars[183] = 5184;
 if (MiscellaneousVars[181] == 4) MiscellaneousVars[183] = 6221;
 if (MiscellaneousVars[181] == 5) MiscellaneousVars[183] = 7465;
 if (MiscellaneousVars[181] == 6) MiscellaneousVars[183] = 8958;
 if (MiscellaneousVars[181] == 7) MiscellaneousVars[183] = 10750;

 MiscellaneousVars[184] = 0; // Resets Tension Countdown to idle.
 MiscellaneousVars[186] = 0; // Resets Tension Cooldown to idle.

 // Tension Aura Actor Control
 // TID 2001 - Aura
 str TensionAuraLight;
 int SpawnFixedX;
 int SpawnFixedY;
 int SpawnFixedZ;
 int TensionAuraSpawnHeight;
 int TensionAuraXScale;
 int TensionAuraYScale;
 int TensionAuraAlpha;
 int TensionAuraAlphaInvis;
 if (MiscellaneousVars[181] > 0)
 {
  SpawnFixedX = GetActorX(Player1TID);
  SpawnFixedY = GetActorY(Player1TID);
  SpawnFixedZ = GetActorZ(Player1TID);
  if (CharacterClass == 0) TensionAuraSpawnHeight = 28 * 65536;
  if (CharacterClass == 1) TensionAuraSpawnHeight = 26 * 65536;
  if (CharacterClass == 2) TensionAuraSpawnHeight = 25 * 65536;
  if (CharacterClass == 8) TensionAuraSpawnHeight = 25 * 65536;
  if (CharacterClass == 9) TensionAuraSpawnHeight = 23 * 65536;
  TensionAuraSpawnHeight += SpawnFixedZ;

  int TensionAuraXScaleExtra = 1.0;
  int TensionAuraYScaleExtra = 1.0;
  if (ClassicDoomType == 5)
  {
   TensionAuraXScaleExtra = 1.1;
   TensionAuraYScaleExtra = 1.375;
  }
  
  if (MiscellaneousVars[181] == 1)
  {
   TensionAuraLight = "TensionAuraLight5"; 
   TensionAuraXScale = fixedmul(0.5,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.75,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.20;
   TensionAuraAlphaInvis = 0.02;
   if (ThingCountName("TensionAuraLight5", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 2)
  {
   TensionAuraLight = "TensionAuraLight20";
   TensionAuraXScale = fixedmul(0.5555,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.8333,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.26;
   TensionAuraAlphaInvis = 0.026;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 3) 
  { 
   TensionAuraLight = "TensionAuraLight50"; 
   TensionAuraXScale = fixedmul(0.6111,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(0.9116,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.32;
   TensionAuraAlphaInvis = 0.032;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 4)
  {
   TensionAuraLight = "TensionAuraLight100"; 
   TensionAuraXScale = fixedmul(0.6667,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.0,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.38;
   TensionAuraAlphaInvis = 0.038;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 5) 
  {
   TensionAuraLight = "TensionAuraLight250";
   TensionAuraXScale = fixedmul(0.7222,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.0833,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.44;
   TensionAuraAlphaInvis = 0.044;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 6) 
  {
   TensionAuraLight = "TensionAuraLight500"; 
   TensionAuraXScale = fixedmul(0.7777,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.1666,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.5;
   TensionAuraAlphaInvis = 0.05;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
   if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
  }
  if (MiscellaneousVars[181] == 7) 
  {
   TensionAuraLight = "TensionAuraLight1000";
   TensionAuraXScale = fixedmul(0.8333,TensionAuraXScaleExtra);
   TensionAuraYScale = fixedmul(1.25,TensionAuraYScaleExtra);
   TensionAuraAlpha = 0.36;
   TensionAuraAlphaInvis = 0.056;
   if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
   if (ThingCountName("TensionAuraLight1000", 1502) < 1) SpawnForced(TensionAuraLight,SpawnFixedX,SpawnFixedY,TensionAuraSpawnHeight,1502,0);
  }

  if (CharacterClass == 0) { TensionAuraXScale = TensionAuraXScale * 112 / 100;  TensionAuraYScale = TensionAuraYScale * 123 / 100; }
  if (CharacterClass == 1) { TensionAuraXScale = TensionAuraXScale * 104 / 100;  TensionAuraYScale = TensionAuraYScale * 108 / 100; }
  if (CharacterClass == 2) { TensionAuraXScale = TensionAuraXScale * 100 / 100;  TensionAuraYScale = TensionAuraYScale * 100 / 100; }
  if (CharacterClass == 8) { TensionAuraXScale = TensionAuraXScale * 100 / 100;  TensionAuraYScale = TensionAuraYScale * 100 / 100; }
  if (CharacterClass == 9) { TensionAuraXScale = TensionAuraXScale * 96 / 100;  TensionAuraYScale = TensionAuraYScale * 96 / 100; }

  if (ThingCountName("TensionAuraLooper", 1501) < 1) SpawnForced("TensionAuraLooper",SpawnFixedX,SpawnFixedY,SpawnFixedZ,1501,0);
  if (ThingCountName("TensionAuraLooper", 1501) > 0)
  {
   SetActorProperty(1501,APROP_ScaleX,TensionAuraXScale);
   SetActorProperty(1501,APROP_ScaleY,TensionAuraYScale);
   if (PowerupTimer[1] > 0) SetActorProperty(1501,APROP_Alpha,TensionAuraAlphaInvis);
   else SetActorProperty(1501,APROP_Alpha,TensionAuraAlpha);
  }
 }
 else
 {
  if (ThingCountName("TensionAuraLooper", 1501) > 0) Thing_Remove(1501);
  if (ThingCountName("TensionAuraLight5", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight20", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight50", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight100", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight250", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight500", 1502) > 0) Thing_Remove(1502);
  if (ThingCountName("TensionAuraLight1000", 1502) > 0) Thing_Remove(1502);
 }
}

// Check Tension Type for Aura Settings on Aura Actors
script "CheckTensionLevel" (void)
{
 //PrintBold(d:MiscellaneousVars[181]);
 SetResultValue(MiscellaneousVars[181]);
}

// Check invisiblity for Tension lights
script "CheckTensionInvis" (void)
{
 if (PowerupTimer[1] > 0)
 {
  //PrintBold(s:"1");
  SetResultValue(1);
 }
 else
 {
  //PrintBold(s:"0");
  SetResultValue(0); 
 }
}

// When an attack or a healing ability is activated while Tension is active, starts the countdown for it to fade.
script "StartTensionCountDown" (void)
{
 int random1;
 if (MiscellaneousVars[181] > 0)
 {
  if (MiscellaneousVars[184] == 0) // If the timer is not activated
  {
   if (random(1,1000) > 10) // 1% An attack will NOT start the countdown
   {
    MiscellaneousVars[184] = 1;
    random1 = random(1,10);
    if (random1 == 1) MiscellaneousVars[183] = MiscellaneousVars[183] * 3 / 4; // 10% Chance for the timer to be cut by 25%
   }
  }
 }
}

script "TensionParticleSpawnChance" (void)
{
 // 256 means never spawn, 0 means ALWAYS spawn
 if (MiscellaneousVars[181] == 0) SetResultValue(224);
 if (MiscellaneousVars[181] == 1) SetResultValue(220); // -4
 if (MiscellaneousVars[181] == 2) SetResultValue(215); // -5
 if (MiscellaneousVars[181] == 3) SetResultValue(209); // -6
 if (MiscellaneousVars[181] == 4) SetResultValue(195); // -14
 if (MiscellaneousVars[181] == 5) SetResultValue(187); // -8
 if (MiscellaneousVars[181] == 6) SetResultValue(176); // -9
 if (MiscellaneousVars[181] == 7) SetResultValue(156); // -20
}

// Sets the player's amount of kills [or if a negative value is entered, will print the current amount of their kills]
script "SetKillCount" (int amount)
{
 if (amount >= 0) MiscellaneousVars[167] = amount;
 PrintBold(d:MiscellaneousVars[167]);
}

// New Method of adding EXP when certain kills or actions are performed, and searches for specfic things like +FRIENDLY of if the player killed said enemy, etc
script "AddEXP" (int baseamount, int flags, int incrementcombo)
{
 int baseexp, finalexpamount, overkillhp, overkillhp2;
 int Exp1, Exp2, ExpMultiFactor, RealExpGain;
 int ComboMultiplier;
 int KillExpMultiplier;
 int KilledByPlayer = 1;
 int fakedeath;
 int random1;

 if (flags & 2) fakedeath = 1;

 int MapCheck = GetLevelInfo(LEVELINFO_LEVELNUM);
 //PrintBold(s:"MapNumber: ",d:MapCheck);
 int MonsterX = GetActorX(0);
 int MonsterY = GetActorY(0);
 int MonsterZ = GetActorZ(0);

 int RandomArmorDropChance;
 int RandomArmorDropMulti;

 if (ClassicDoomType == 4) // Strife
 {
    // Enemies in the Degnin Mines or levels in the factory HUB can sometimes drop Degnin Ore depending on the area
    if (MapCheck == 14) // Degnin Mines
	{
     if (random(1,768) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,384) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,192) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,96) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,72) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,48) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,24) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,12) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP14]");
	}
	if (MapCheck == 20) // Factory: Receiving
	{
     if (random(1,4096) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,1024) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,256) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,64) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP20]");
	}
	if (MapCheck == 21) // Factory: Manufacturing
	{
     if (random(1,4096) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,1024) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,256) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,64) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP21]");
	}
	if (MapCheck == 22) // Factory: Forge
	{
     if (random(1,192) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,160) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,128) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,96) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,64) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,32) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,16) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP22]");
	}
	if (MapCheck == 24) // Factory: Conversion Chapel
	{
     if (random(1,4096) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,1024) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,256) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,64) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP24]");
	}
	if (MapCheck == 26) // Proving Grounds
	{
     if (random(1,7168) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,1536) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,384) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,96) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP26]");
	}
	if (MapCheck == 27) // The Lab [Loremaster boss]
	{
     if (random(1,8192) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,2048) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,512) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,128) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [MAP27]");
	}
	if (CheckActorInventory(Player1TID,"QuestItem29") > 0) // Destroying the Transmitter allows any other enemy in the game to have a chance to drop Degnin Ore [any level]
	{
     if (random(1,4096) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,1024) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (random(1,256) == 1) DropItem(0,"DegninOrePickup",1,256);
     if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Degnin Ore Drop Attempt [Post-Transmitter]");
	}
 }


 if (GameSkill() == SKILL_VERY_EASY) RandomArmorDropMulti = 75;
 else if (GameSkill() == SKILL_EASY) RandomArmorDropMulti = 90;
 else if (GameSkill() == SKILL_NORMAL) RandomArmorDropMulti = 100;
 else if (GameSkill() == SKILL_HARD) RandomArmorDropMulti = 110;
 else if (GameSkill() == SKILL_VERY_HARD) RandomArmorDropMulti = 125;

 KilledByPlayer = 1;
 KillExpMultiplier = 20; // 20 = 100% [1 = 5%]
 int KillerTID = GetActorProperty(0,APROP_TargetTID);
 if (GetCVar("dvds_exppropercredit") == 1)
 { 
  if (IsPointerEqual(AAPTR_TARGET, AAPTR_PLAYER1) == FALSE)
  {
   // TODO: Detect if a friendly monster/summon is the killer of the monster to give EXP credit to the player
   if (CheckFlag(KillerTID,"FRIENDLY") == 1)
   {
    KilledByPlayer = 0;
    KillExpMultiplier = random(13,18); // [65 to 90%]
	if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) KillExpMultiplier += 2;
   }
   else
   {
    if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Passed Player/Friendly-Monster Credit Check: NO");
    terminate;
   }
  }
 }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  if (KilledByPlayer == 1) PrintBold(s:"Passed Player/Friendly-Monster Credit Check: YES (PLAYER)");
  else PrintBold(s:"Passed Player/Friendly-Monster Credit Check: YES (FRIENDLY ACTOR)");
 }

 if (GetActorProperty(Player1TID,APROP_Health) <= 0)  
 {
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Passed Player-Alive Check: NO"); 
  terminate; 
 }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Passed Player-Alive Check: YES");

 if (CheckFlag(0,"FRIENDLY") == 1) // Any "FRIENDLY" flagged monster who runs the script will not get beyond this point UNLESS they have bit 1 enabled.
 {
  if (flags & 1) { }
  else
  {
   if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Passed FRIENDLY Check: NO");
   terminate;
  }
 }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Passed FRIENDLY Check: YES");

 int HellCoreRuinousDropChance = 5;
 if (CheckActorInventory(Player1TID,"RuinousShield") > 0) HellCoreRuinousDropChance *= 3; // Ruinous Shield triples drop rate
 if (DVDSSpecialArrayValue[3] > 0) HellCoreRuinousDropChance *= 4; // Playing Unloved sets this to drop 4x as often
 if (CharacterClass != 2) HellCoreRuinousDropChance = 0;
 // Monster Unique Drop Rates [Hellcore weapons]
 if (CheckActorClass(0,"DSDoomImp") == 1) 		DropItem(0,"ImpClawCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DarkImp") == 1) 		DropItem(0,"DarkImpClawCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DSCacodemon") == 1) 	DropItem(0,"CacodemonEyeCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"Cacolantern") == 1) 	DropItem(0,"CacolanternEyeCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"Abaddon") == 1) 		DropItem(0,"AbaddonEyeCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DSHellKnight") == 1) 	DropItem(0,"KnightFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DSBaronofHell") == 1) 	DropItem(0,"BaronFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"Belphegor") == 1) 		DropItem(0,"BelphegorFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"BruiserDemon") == 1) 	DropItem(0,"BruiserFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"ArchonOfHell") == 1) 	DropItem(0,"ArchonFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"PyroDemon") == 1) 		DropItem(0,"PyroFistCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DeathIncarnate") == 1) 	DropItem(0,"IncarnateSkullCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"DSArchvile") == 1) 		DropItem(0,"ArchvileHandCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"Diabloist") == 1) 		DropItem(0,"DiabloistHandCI",1,HellCoreRuinousDropChance);
 if (CheckActorClass(0,"FlyingBalrog") == 1) 	DropItem(0,"BalrogFistCI",1,HellCoreRuinousDropChance);
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(d:HellCoreRuinousDropChance);

 int uncursethreshold;
 int uncursethreshold2;
 int uncursepts;
 // Ruinous Shield Checks
 if (IsPointerEqual(AAPTR_TARGET, AAPTR_PLAYER1) == TRUE) 
 {
  if (CharacterClass == 2 && CheckActorInventory(Player1TID,"RuinousShield") > 0) // Flora
  {
   if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(d:MiscellaneousVars[202]);
   // Increase Ruinous Shield Counter by 1 or 2 pts [this allows the player to uncurse the shield slowly by killing enemies.
   uncursethreshold = 9375;
   uncursethreshold2 = 6250;
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0)
   {
    uncursethreshold -= 625;
    uncursethreshold2 -= 1250;
   }
   if (PowerupTimer[7] > 0) 
   { 
    uncursethreshold = uncursethreshold * 9 / 10; 
	uncursethreshold2 = uncursethreshold2 * 9 / 10; 
   }
   if (random(1,1000) <= uncursethreshold)
   {
    if (random(1,1000) <= uncursethreshold2) uncursepts = 1; else uncursepts = 2;
   }
   else
   {
    if (random(1,1000) <= uncursethreshold2) uncursepts = 4; else uncursepts = 8;
   }
   if (CheckActorInventory(Player1TID,"DoveRibbon") > 0) uncursepts *= (2 * random(1,2));
   if (KilledByPlayer != 1) uncursepts /= 4;
   if (uncursepts < 1) uncursepts = 1;
   MiscellaneousVars[202] += uncursepts;
   if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Uncurse Pts: ",d:MiscellaneousVars[202],s:" [+",d:uncursepts,s:"]");
  }

  int donotincreasekills = 0;
  if (CheckActorClass(0,"DSBossBrain") == 1) { donotincreasekills = 1; }
  if (CheckActorClass(0,"ClayDevilNew") == 1) { donotincreasekills = 1; }
  if (donotincreasekills == 0) 
  {
   MiscellaneousVars[167] += 1; // Increases Player's actual total kill count by 1
   if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"Kills: ",d:MiscellaneousVars[167]);
  }
 }

 if (ModType == 0) // Classic Doom 1-2/Heretic/Hexen/Strife mode :P
 {
   if (CharacterClass == 2) // Flora
   {
    if (MiscellaneousVars[167] == 20) // 20 enemies killed, high chance of spawning an armor item for Flora
    {
     // 75% chance
     RandomArmorDropChance = 25 * RandomArmorDropMulti / 100;
     if (random(1,100) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 200) // 200 enemies killed, fair chance of spawning an armor item for Flora
    {
     // 50% chance
     RandomArmorDropChance = 50 * RandomArmorDropMulti / 100;
     if (random(1,100) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 800) // 800 enemies killed, low chance of spawning an armor item for Flora
    {
     // 25% chance
     RandomArmorDropChance = 75 * RandomArmorDropMulti / 100;
     if (random(1,100) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 1400) // 1400 enemies killed, low chance of spawning an armor item for Flora
    {
     // 25% chance
     RandomArmorDropChance = 75 * RandomArmorDropMulti / 100;
     if (random(1,100) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 2000) // 2000 enemies killed, low chance of spawning an armor item for Flora
    {
     // 12.5% chance
     RandomArmorDropChance = 875 * RandomArmorDropMulti / 1000;
     if (random(1,1000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 2800) // 2800 enemies killed, low chance of spawning an armor item for Flora
    {
     // 12.5% chance
     RandomArmorDropChance = 875 * RandomArmorDropMulti / 1000;
     if (random(1,1000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 3600) // 3600 enemies killed, low chance of spawning an armor item for Flora
    {
     // 6.25% chance
     RandomArmorDropChance = 9375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 4600) // 4600 enemies killed, low chance of spawning an armor item for Flora
    {
     // 6.25% chance
     RandomArmorDropChance = 9375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 5600) // 5600 enemies killed, low chance of spawning an armor item for Flora
    {
     // 6.25% chance
     RandomArmorDropChance = 9375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 6600) // 6600 enemies killed, low chance of spawning an armor item for Flora
    {
     // 6.25% chance
     RandomArmorDropChance = 9375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 7600) // 7600 enemies killed, low chance of spawning an armor item for Flora
    {
     // 6.25% chance
     RandomArmorDropChance = 9375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 8800) // 8800 enemies killed, fair chance of spawning an armor item for Flora
    {
     // 36.25% chance
     RandomArmorDropChance = 6375 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
    if (MiscellaneousVars[167] == 10000) // 10000 enemies killed, huge chance of spawning an armor item for Flora
    {
     // 92.5% chance
     RandomArmorDropChance = 750 * RandomArmorDropMulti / 10000;
     if (random(1,10000) > RandomArmorDropChance) SpawnForced("FloraRandomArmorAlwaysDrop",GetActorX(0),GetActorY(0),GetActorZ(0)+(8*65536),0,0);
    }
   }
 }
 int randomdropsallowed = 1;
 int experiessencefactor = 1;
 // Drops
 if (CheckFlag(0,"BOSS") == 1) experiessencefactor = random(8,16);
 if (CheckFlag(0,"FRIENDLY") == 1) { randomdropsallowed = 0; experiessencefactor = 0; }
 if (CheckActorClass(0,"DSBossBrain") == 1) { randomdropsallowed = 0; experiessencefactor = 0; }
 if (CheckActorClass(0,"ClayDevilNew") == 1) { randomdropsallowed = 0; experiessencefactor = 0; }
 if (CheckActorClass(0,"FakeGoldLich") == 1) { randomdropsallowed = 0; experiessencefactor = 0; }
 if (CheckActorClass(0,"FireDemonQueenClone") == 1) { randomdropsallowed = 0; experiessencefactor = 0; }
 if (fakedeath > 0) { randomdropsallowed = 0; experiessencefactor = 0; }

 if (randomdropsallowed > 0)
 {
  if (random(1,128) <= experiessencefactor) DropItem(0,"Experiessence",1,256);
  if (random(1,512) <= experiessencefactor) DropItem(0,"Experiessence",1,256);
  if (random(1,2048) <= experiessencefactor) DropItem(0,"Experiessence",1,256);
  if (random(1,512) <= experiessencefactor) DropItem(0,"LargeExperiessence",1,256);
  if (random(1,2048) <= experiessencefactor) DropItem(0,"LargeExperiessence",1,256);
  if (random(1,8192) <= experiessencefactor) DropItem(0,"LargeExperiessence",1,256);
  if (random(1,2048) <= experiessencefactor) DropItem(0,"HugeExperiessence",1,256);
  if (random(1,8192) <= experiessencefactor) DropItem(0,"HugeExperiessence",1,256);
  if (random(1,32768) <= experiessencefactor) DropItem(0,"HugeExperiessence",1,256);
  
  if (random(1,131072) == 1) DropItem(0,"TheOneRing",1,256);
  if (random(1,16384) == 1) DropItem(0,"ElfinElixir",1,256);
  if (random(1,16384) == 1) DropItem(0,"MonsterMunchies",1,256);
  if (random(1,16384) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,16384) == 1 && CharacterClass == 2) DropItem(0,"SapphireWandNew",1,256);
  if (random(1,8192) == 1) DropItem(0,"RandomMagicSpawner",1,256);
  if (random(1,8192) == 1) DropItem(0,"RandomHerbSpawner",1,256);
  if (random(1,8192) == 1) DropItem(0,"GreaterVimstone",1,256);
  if (random(1,8192) == 1) DropItem(0,"LesserVimstone",1,256);
  if (random(1,8192) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,8192) == 1 && CharacterClass == 2) DropItem(0,"SapphireWandNew",1,256);
  if (random(1,4096) == 1) DropItem(0,"MonsterMunchies",1,256);
  if (random(1,4096) == 1) DropItem(0,"SageElixir",1,256);
  if (random(1,4096) == 1) DropItem(0,"PaxaPunch",1,256);
  if (random(1,4096) == 1) DropItem(0,"MercuryBandana",1,256);
  if (random(1,4096) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,4096) == 1) DropItem(0,"RandomSeedDropAlways",1,256);
  if (random(1,2048) == 1 && CharacterClass == 2) DropItem(0,"SapphireWandNew",1,256);
  if (random(1,2048) == 1) DropItem(0,"RandomHerbSpawner",1,256);
  if (random(1,2048) == 1) DropItem(0,"RandomMagicSpawner",1,256);
  if (random(1,2048) == 1) DropItem(0,"YggdrasilDew",1,256);
  if (random(1,2048) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,1024) == 1) DropItem(0,"MonsterMunchies",1,256);
  if (random(1,1024) == 1) DropItem(0,"MagicWater",1,256);
  if (random(1,1024) == 1) DropItem(0,"RandomPowerupSpawner",1,256);
  if (random(1,1024) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,1024) == 1) DropItem(0,"MiraclePotion",1,256);
  if (random(1,512) == 1) DropItem(0,"RandomHerbSpawner",1,256);
  if (random(1,512) == 1) DropItem(0,"RockBombShard",1,256);
  if (random(1,256) == 1) DropItem(0,"MonsterMunchies",1,256);
  if (random(1,256) == 1) DropItem(0,"RockBombShard",1,256);
  if (ModType == 0) // Classic Mode
  {
   if (ClassicDoomType == 0 || ClassicDoomType == 1|| ClassicDoomType == 5) // Doom 2 or Doom 1 or Doom64
   {
    if (random(1,16384) == 1) DropItem(0,"Berserk2",1,256);
    if (random(1,8192) == 1) DropItem(0,"Berserk2",1,256);
    if (random(1,4096) == 1) DropItem(0,"MiniBerserk",1,256);
    if (random(1,2048) == 1) DropItem(0,"MiniBerserk",1,256);
    if (random(1,1024) == 1) DropItem(0,"Medikit2",1,256);
    if (random(1,512) == 1) DropItem(0,"Medikit2",1,256);
    if (random(1,256) == 1) DropItem(0,"Stimpack2",1,256);
    if (random(1,128) == 1) DropItem(0,"Stimpack2",1,256);
    if (CheckActorClass(0,"HellCleric") == 1 && random(1,256) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"FlyingBalrog") == 1 && random(1,256) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"DSSpiderMastermind") == 1 && random(1,64) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"Demolisher") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"DSCyberdemon") == 1 && random(1,64) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"Annihilator") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
	if (CharacterClass == 0 || CharacterClass == 1) // Deggaris & Illucia Specfic Drops
	{
     if (random(1,16384) == 1) DropItem(0,"DiamondSkinGA",1,256);
     if (random(1,8192) == 1) DropItem(0,"StoneSkinGA",1,256);
     if (random(1,4096) == 1) DropItem(0,"DiamondSkin",1,256);
     if (random(1,2048) == 1) DropItem(0,"StoneSkin",1,256);
     if (random(1,1024) == 1) DropItem(0,"BlueArmorDS",1,256);
     if (random(1,512) == 1) DropItem(0,"GreenArmorDS",1,256);
     if (random(1,256) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,128) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,64) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,32) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,16) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,8) == 1) DropItem(0,"ArmorBonusDS2",1,256);
     if (random(1,512) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipBoxNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellBoxNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketBoxNew",1,256);
	  if (random1 == 8) DropItem(0,"CellPackNew",1,256);
	 }
     if (random(1,256) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipBoxNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellBoxNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketBoxNew",1,256);
	  if (random1 == 8) DropItem(0,"CellPackNew",1,256);
	 }
     if (random(1,128) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipBoxNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellBoxNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketBoxNew",1,256);
	  if (random1 == 8) DropItem(0,"CellPackNew",1,256);
	 }
     if (random(1,64) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketAmmoNew",1,256);
	  if (random1 == 8) DropItem(0,"CellNew",1,256);
	 }
     if (random(1,32) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketAmmoNew",1,256);
	  if (random1 == 8) DropItem(0,"CellNew",1,256);
	 }
     if (random(1,16) == 1)
	 {
	  random1 = random(1,8);
	  if (random1 >= 1 && random1 <= 3) DropItem(0,"ClipNew",1,256);
	  if (random1 >= 4 && random1 <= 6) DropItem(0,"ShellNew",1,256);
	  if (random1 == 7) DropItem(0,"RocketAmmoNew",1,256);
	  if (random1 == 8) DropItem(0,"CellNew",1,256);
	 }
	}
   }
   if (ClassicDoomType == 2 || ClassicDoomType == 3) // BOTH Heretic AND Hexen
   {
    if (random(1,2048) == 1) DropItem(0,"ArtiSuperHealthNew",1,256);
    if (random(1,2048) == 1 && CharacterClass == 2) DropItem(0,"SapphireWandNew",1,256);
    if (random(1,1024) == 1) DropItem(0,"ArtiSuperHealthNew",1,256);
    if (random(1,512) == 1) DropItem(0,"ArtiHealthNew",1,256);
    if (random(1,256) == 1) DropItem(0,"ArtiHealthNew",1,256);
    if (random(1,256) == 1) DropItem(0,"CrystalVialNew",1,256);
    if (random(1,128) == 1) DropItem(0,"CrystalVialNew",1,256);
   }
   if (ClassicDoomType == 2) // Heretic Only
   {
    if (random(1,32768) == 1) DropItem(0,"DSparilStaff",1,256);
    if (random(1,8192) == 1) DropItem(0,"RockBombShard",1,256);
    if (random(1,2048) == 1) DropItem(0,"RockBombShard",1,256);
    if (random(1,512) == 1) DropItem(0,"RockBombShard",1,256);
    if (CheckActorClass(0,"IronlichNew") == 1 && random(1,96) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"IceLich") == 1 && random(1,96) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"GoldLich") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"BloodLich") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"MaulotaurNew") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"DSparilMountedNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"DSparilUnmountedNew") == 1 && random(1,16) == 1) DropItem(0,"SeedofSkillForced",1,256);

    if (random(1,1024) == 1)
	{
	 random1 = random(1,7);
	 if (random1 == 1) DropItem(0,"GoldWandNew",1,256);
	 if (random1 == 2) DropItem(0,"CrossbowNew",1,256);
	 if (random1 == 3) DropItem(0,"DragonClawNew",1,256);
	 if (random1 == 4) DropItem(0,"HellStaffNew",1,256);
	 if (random1 == 5) DropItem(0,"PhoenixRodNew",1,256);
	 if (random1 == 6) DropItem(0,"FiremaceNew",1,256);
	 if (random1 == 7) DropItem(0,"SuperCrossbowNew",1,256);
	}

	if (random(1,2048) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandHeftyNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowHeftyNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterHeftyNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodHeftyNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodHeftyNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceHeftyNew",1,256);
	}
    if (random(1,1024) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandHeftyNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowHeftyNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterHeftyNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodHeftyNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodHeftyNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceHeftyNew",1,256);
	}
    if (random(1,512) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandHeftyNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowHeftyNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterHeftyNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodHeftyNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodHeftyNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceHeftyNew",1,256);
	}
    if (random(1,256) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandAmmoNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowAmmoNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterAmmoNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodAmmoNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodAmmoNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceAmmoNew",1,256);
	}
    if (random(1,128) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandAmmoNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowAmmoNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterAmmoNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodAmmoNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodAmmoNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceAmmoNew",1,256);
	}
    if (random(1,64) == 1)
	{
	 random1 = random(1,12);
	 if (random1 >= 1 && random1 <= 3) DropItem(0,"GoldWandAmmoNew",1,256);
	 if (random1 >= 4 && random1 <= 6) DropItem(0,"CrossbowAmmoNew",1,256);
	 if (random1 >= 7 && random1 <= 9) DropItem(0,"BlasterAmmoNew",1,256);
	 if (random1 == 10) DropItem(0,"PhoenixRodAmmoNew",1,256);
	 if (random1 == 11) DropItem(0,"SkullRodAmmoNew",1,256);
	 if (random1 == 12) DropItem(0,"MaceAmmoNew",1,256);
	}
   }
   if (ClassicDoomType == 3) // Hexen Only
   {
    if (random(1,8192) == 1) DropItem(0,"ArtiBoostManaNew",1,256);
    if (random(1,4096) == 1) DropItem(0,"ArtiBoostManaNew",1,256);
    if (random(1,4096) == 1) DropItem(0,"RockBombShard",1,256);
    if (random(1,1024) == 1) DropItem(0,"RockBombShard",1,256);
    if (random(1,256) == 1) DropItem(0,"RockBombShard",1,256);
    if (CheckActorClass(0,"DragonNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"HeresiarchNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"FighterBossNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"ClericBossNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"MageBossNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"KoraxNew") == 1 && random(1,16) == 1) DropItem(0,"SeedofSkillForced",1,256);
   }
   if (ClassicDoomType == 4) // Strife
   {
    if (random(1,16384) == 1) DropItem(0,"RandomSeedDropAlways",1,256);
    if (random(1,8192) == 1) DropItem(0,"RandomSeedDropAlways",1,256);
    if (random(1,4096) == 1) DropItem(0,"ElfinElixir",1,256);
    if (random(1,4096) == 1) DropItem(0,"PoisonBoltsNew",1,256);
    if (random(1,4096) == 1) DropItem(0,"SurgeryKitNew",1,256);
    if (random(1,4096) == 1 && CharacterClass == 2) DropItem(0,"SapphireWandNew",1,256);
    if (random(1,4096) == 1) DropItem(0,"RandomSeedDropAlways",1,256);
    if (random(1,2048) == 1) DropItem(0,"RandomHerbSpawner",1,256);
    if (random(1,2048) == 1) DropItem(0,"ElectricBoltsNew",1,256);
    if (random(1,2048) == 1) DropItem(0,"SurgeryKitNew",1,256);
    if (random(1,1024) == 1) DropItem(0,"RandomSeedDropAlways",1,256);
    if (random(1,1024) == 1) DropItem(0,"RandomPowerupSpawner",1,256);
    if (random(1,1024) == 1) DropItem(0,"MedicalKitNew",1,256);
    if (random(1,1024) == 1) DropItem(0,"SageElixir",1,256);
    if (random(1,512) == 1) DropItem(0,"RandomHerbSpawner",1,256);
    if (random(1,512) == 1) DropItem(0,"MedicalKitNew",1,256);
    if (random(1,256) == 1) DropItem(0,"MedPatchNew",1,256);
    if (random(1,256) == 1) DropItem(0,"MagicWater",1,256);
    if (random(1,128) == 1) DropItem(0,"MedPatchNew",1,256);
    if (CheckActorClass(0,"ProgrammerNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"StrifeBishopNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"Macil2New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"LoreMasterNew") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"AlienSpectre1New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"AlienSpectre2New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"AlienSpectre3New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"AlienSpectre4New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"AlienSpectre5New") == 1 && random(1,32) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"EntityBossNew") == 1 && random(1,16) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"EntitySecondNew") == 1 && random(1,16) == 1) DropItem(0,"SeedofSkillForced",1,256);
    if (CheckActorClass(0,"EntityAscended") == 1 && random(1,8) == 1) DropItem(0,"SeedofSkillForced",1,256);
   }
  }
  else // DVI/DVII mode
  {
   if (random(1,16384) == 1) DropItem(0,"Berserk2",1,256);
   if (random(1,8192) == 1) DropItem(0,"Berserk2",1,256);
   if (random(1,4096) == 1) DropItem(0,"MiniBerserk",1,256);
   if (random(1,2048) == 1) DropItem(0,"MiniBerserk",1,256);
   if (random(1,1024) == 1) DropItem(0,"Medikit2",1,256);
   if (random(1,512) == 1) DropItem(0,"Medikit2",1,256);
   if (random(1,256) == 1) DropItem(0,"Stimpack2",1,256);
   if (random(1,128) == 1) DropItem(0,"Stimpack2",1,256);
   if (CheckActorClass(0,"HellCleric") == 1 && random(1,256) == 1) DropItem(0,"SeedofSkillForced",1,256);
   if (CheckActorClass(0,"FlyingBalrog") == 1 && random(1,256) == 1) DropItem(0,"SeedofSkillForced",1,256);
   if (CheckActorClass(0,"DSSpiderMastermind") == 1 && random(1,64) == 1) DropItem(0,"SeedofSkillForced",1,256);
   if (CheckActorClass(0,"Demolisher") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
   if (CheckActorClass(0,"DSCyberdemon") == 1 && random(1,64) == 1) DropItem(0,"SeedofSkillForced",1,256);
   if (CheckActorClass(0,"Annihilator") == 1 && random(1,48) == 1) DropItem(0,"SeedofSkillForced",1,256);
  }
 }
 
 if (ModType == 0 && GetCVar("dvds_noexpgains") != 0) 
 {
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP Gains: STOPPED");
  terminate; // If in Classic mode and the EXP Gain option is turned off, stop script here.
 }
 //**********************
 //* START OF EXP GAINS *
 //**********************
 int EXPTimerIncrease;
 // Increment the kill combo timer
 if (GetCVar("dvds_expcombosystem") == 1)
 {
  if (incrementcombo == 1)
  {
   if (MiscellaneousVars[157] <= 0) // If not set, set to 4 seconds, if already set, add 1 second
   {
    EXPTimerIncrease = 2800; // 140 tics [20 units / tic]
    EXPTimerIncrease += (MiscellaneousVars[31] * 16); // 1 point of Agility = 0.8 tics [or 16 units] [5 points = 4 tics (or 80 units)]
    EXPTimerIncrease += (MiscellaneousVars[33] * 4); // 1 point of Deftness = 0.2 tics [or 4 units] [20 points = 4 tics (or 80 units)]
   }
   else
   {
    EXPTimerIncrease = 700; // 35 tics [20 units / tic]
    EXPTimerIncrease += (MiscellaneousVars[31] * 4); // 1 point of Agility = 0.2 tics [or 4 units] [5 points = 1 tic (or 20 units)]
    EXPTimerIncrease += (MiscellaneousVars[33] * 1); // 1 point of Deftness = 0.05 tics [or 1 unit] [20 points = 1 tic (or 20 units)]
   }

   // "Higher Learning" Grand Mastery Perk
   if (MiscellaneousVars[11001] == 1) EXPTimerIncrease = EXPTimerIncrease * 23 / 20; 
   if (MiscellaneousVars[11001] == 2) EXPTimerIncrease = EXPTimerIncrease * 13 / 10; 

   if (PowerupTimer[7] > 0) EXPTimerIncrease = EXPTimerIncrease * 5 / 4;
   MiscellaneousVars[157] += EXPTimerIncrease;
   if (PowerupTimer[7] > 0) 
   {
    if (MiscellaneousVars[157] >= 7000) MiscellaneousVars[157] = 7000; // Combo Timer maxes at 8 seconds.
   }
   else
   {
    if (MiscellaneousVars[157] >= 5600) MiscellaneousVars[157] = 5600; // Combo Timer maxes at 8 seconds.
   }
   MiscellaneousVars[158] += 1; // Increment Kill Combo Count by 1
  }
 }

 // Check Base Experience to see if it's a fixed amount or if it should be based on spawnhealth/user_MaxHP
 if (baseamount == -2) // Base on the menu option
 {
  if (GetCVar("dvds_monsterexpbase") == 1)
  {
   if (GetUserVariable(0,"user_MaxHP") <= 0)
   {
    baseexp = GetActorProperty(0,APROP_SpawnHealth);
   }
   else
   {
    baseexp = GetUserVariable(0,"user_MaxHP");
   }
  }
  else
  {
   baseexp = GetActorProperty(0,APROP_SpawnHealth);
  }
 }
 else
 if (baseamount == -1) // ALWAYS use SpawnHealth and not user_MaxHP [if you always want it based only on their base HP and not their recalculated HP]
 {
  baseexp = GetActorProperty(0,APROP_SpawnHealth);
 }
 else
 if (baseamount == 0) // Checks for user_MaxHP first, but will use SpawnHealth if it's not been set
 {
  if (GetUserVariable(0,"user_MaxHP") <= 0)
  {
   baseexp = GetActorProperty(0,APROP_SpawnHealth);
  }
  else
  {
   baseexp = GetUserVariable(0,"user_MaxHP");
  }
 }
 else
 if (baseamount > 0) // Sets the EXP to the defined value as a fixed amount
 {
  baseexp = baseamount;
 }

 if (CheckActorClass(0,"DSBossBrain") == 1)
 {
  finalexpamount = finalexpamount * random(3,5);
 }
 
 if (CheckActorClass(0,"Banshee") == 1 || CheckActorClass(0,"DeathKnight") == 1)
 {
  finalexpamount = (finalexpamount * random(3,5)) / 2;
  if (random(1,4) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,16) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,64) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
 }
 if (CheckActorClass(0,"Bormereth") == 1 || CheckActorClass(0,"EtherealChaosSerpentNew") == 1)
 {
  finalexpamount = (finalexpamount * random(5,7)) / 2;
  if (random(1,1) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,4) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,16) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
 }
 if (CheckActorClass(0,"IceGolem") == 1 || CheckActorClass(0,"IceGolemGhost") == 1 || CheckActorClass(0,"VampireDVDS") == 1)
 {
  finalexpamount = (finalexpamount * random(2,4)) / 2;
  if (random(1,24) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,96) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
  if (random(1,384) == 1) DropItem(0,"RandomSeedDropForcedAlways",1,256);
 }
 
 finalexpamount = baseexp;
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP1: ",d:finalexpamount,s:" [Base EXP]");

 if (fakedeath > 0) // Fake deaths [Death Incarnate, etc] cut EXP gain by 75%
 {
  finalexpamount = finalexpamount / 4;
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP: ",d:finalexpamount,s:" [Fake-Death]");
 }
 
 finalexpamount = finalexpamount * KillExpMultiplier / 20;
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP2: ",d:finalexpamount,s:" [Multiplier: ",d:KillExpMultiplier,s:" / 20]");

  // Check for Fast Monsters setting
 if (GetCVar("sv_fastmonsters") == 1)
 {
  finalexpamount = finalexpamount * 11 / 8; // [+37.5%]
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP: ",d:finalexpamount,s:" [Fast Monsters On]");
 }

 // Check Proper Flags
 if (GetUserVariable(0, "user_isstealth") > 0)
 {
  if (CheckActorInventory(Player1TID,"TheOneRing") > 0) finalexpamount = finalexpamount * 9 / 8;	// DV-DS Style Stealth = [+12.5%]
  else finalexpamount = finalexpamount * 15 / 8;	// DV-DS Style Stealth = [+87.5%]
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP: ",d:finalexpamount,s:" [Was Stealth]");
 }
 if (CheckFlag(0,"STEALTH") == 1) // ZDoom Style STEALTH = [+100%]
 {
  finalexpamount = finalexpamount * 2;
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP: ",d:finalexpamount,s:" [Has ZDoom(tm) Stealth]");
 }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"EXP3: ",d:finalexpamount);
 }

 // If LEGENDARY [LDL Compatiblity]
 If (GetUserVariable(0, "user_legendaryevolved") > 0)
 {
  finalexpamount = (finalexpamount * 5) / 2;
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1) PrintBold(s:"EXP: ",d:finalexpamount,s:" [Is a 'Legendary' Monster? (LDL)]");
 }
 
 if (GetUserVariable(0,"user_MaxHP") <= 0) { overkillhp = GetActorProperty(0,APROP_SpawnHealth) * -1; }
 else { overkillhp = GetUserVariable(0,"user_MaxHP") * -1; }

 if (GetUserVariable(0,"user_MaxHP") <= 0) { overkillhp2 = GetActorProperty(0,APROP_SpawnHealth) * -4; }
 else { overkillhp2 = GetUserVariable(0,"user_MaxHP") * -4; }

 if (GetActorProperty(0,APROP_Health) <= overkillhp) // Overkilled [+25%]
 {
  finalexpamount = finalexpamount * 9 / 8; 
  MiscellaneousVars[2022] = 1; // OVERKILL display color
  MiscellaneousVars[2023] = 39; // OVERKILL Timer Tics
 }
 if (GetActorProperty(0,APROP_Health) <= overkillhp2) // Super-Overkilled [+25%]
 {
  finalexpamount = finalexpamount * 9 / 8; 
  MiscellaneousVars[2022] = 2; // OVERKILL display color 
  MiscellaneousVars[2023] = 52; // OVERKILL Timer Tics 
 }
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"EXP4: ",d:finalexpamount);
 }

 ExpMultiFactor = GetExpMultiFactor(); // FUNCTION CALL
 finalexpamount = GetExperience(finalexpamount,ExpMultiFactor); // FUNCTION CALL
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"EXP5: ",d:finalexpamount);
 }

 int levelcheck = GetUserVariable(0, "user_monsterlevel") * 7; // Lvl 100 = +70% EXP (Lvl 200 = +140% EXP)
 levelcheck += 1000;
 if (levelcheck < 1000) levelcheck = 1000;
 if (levelcheck > 3000) levelcheck = 3000;
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"levelcheck: ",d:levelcheck);
 }
 finalexpamount = finalexpamount * levelcheck / 1000;
 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"EXP6: ",d:finalexpamount);
 }

 int PreComboEXP = finalexpamount;
 // EXP Combo Counter
 // [158] = number of enemies killed in current combo
 // [159] = current multiplier amount [xxx.xx% format]
 // [162] = Exp Combo Base Multipler
 if (MiscellaneousVars[158] > 1)
 {
  if (MiscellaneousVars[158] < 11)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 16;
   // Each enemy = +0.16% to the bonus multiplier [2-11 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 10 && MiscellaneousVars[158] < 21)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 17;
   // Each enemy = +0.17% to the bonus multiplier [11-20 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 20 && MiscellaneousVars[158] < 36)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 20;
   // Each enemy = +0.20% to the bonus multiplier [21-35 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 35 && MiscellaneousVars[158] < 61)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 24;
   // Each enemy = +0.24% to the bonus multiplier [36-60 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 60 && MiscellaneousVars[158] < 101)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 28;
   // Each enemy = +0.28% to the bonus multiplier [61-100 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 100 && MiscellaneousVars[158] < 201)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 34;
   // Each enemy = +0.34% to the bonus multiplier [101-200 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 200 && MiscellaneousVars[158] < 501)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 40;
   // Each enemy = +0.40% to the bonus multiplier [201-500 enemies killed]
  }
  else
  if (MiscellaneousVars[158] > 500)
  {
   MiscellaneousVars[159] = MiscellaneousVars[158] * 52;
   // Each enemy = +0.52% to the bonus multiplier [501+ enemies killed]
  }
  MiscellaneousVars[159] = MiscellaneousVars[159] * GetCVar("dvds_expcombobasemultiplier") / 100;
  if (MiscellaneousVars[159] < 1) MiscellaneousVars[159] = 1;
  MiscellaneousVars[159] = MiscellaneousVars[159] + 10000;

  //if (MiscellaneousVars[159] > 30000) MiscellaneousVars[159] = 30000;
  //if (finalexpamount > 200000) finalexpamount = 200000;

  finalexpamount = (finalexpamount * MiscellaneousVars[159]) / 10000;
  if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
  {
   PrintBold(s:"Combo %: ",d:MiscellaneousVars[159],
             s:"\nEXP7: ",d:finalexpamount);
  }
 }

 if (finalexpamount < 1) finalexpamount = 1;
 Experience += finalexpamount;

 if (GetCVar("dvdsdebug_showexpdebugstuff") == 1)
 {
  PrintBold(s:"LstHPAmt: ",d:GetActorProperty(0,APROP_Health),s:" / OverkillHP: ",d:overkillhp,s:"\n",
            s:"BaseEXP: ",d:baseexp,s:" / FinalEXP: ",d:finalexpamount,s:"\n",
            s:"'Friendly' Multiplier: ",d:KillExpMultiplier,s:" / 20]");
 }

 MiscellaneousVars[2024] = finalexpamount; // Total EXP for kill [for new HUD]
 MiscellaneousVars[2025] = PreComboEXP; // Total EXP for kill [for new HUD]
 MiscellaneousVars[2026] = 52; 
 SetHudSize(640,480,0);
 if (GetActorProperty(0,APROP_Health) <= overkillhp2)
 {
  SetActivator(0,AAPTR_PLAYER1);
  if (MiscellaneousVars[2000] == 0) // Show this version of the "OVERKILL!" message in old-style HUD mode only
  {
   if (finalexpamount-PreComboEXP > 1) HudMessage(s:"+",d:finalexpamount,s:" EXP \cn[+",d:finalexpamount-PreComboEXP,s:"]\c-";0,3418,cr_gold,59.0,6.0,1.5);
   else HudMessage(s:"+",d:finalexpamount,s:" EXP";0,3418,cr_gold,51.0,6.0,1.5);
   HudMessage(s:"\cjOVERKILL!";0,3421,cr_red,51.0,15.0,1.5);
  }
 }
 else
 {
  if (GetActorProperty(0,APROP_Health) <= overkillhp)
  {
   SetActivator(0,AAPTR_PLAYER1);
   if (MiscellaneousVars[2000] == 0) // Show this version of the "OVERKILL!" message in old-style HUD mode only
   {
    if (finalexpamount-PreComboEXP > 1) HudMessage(s:"+",d:finalexpamount,s:" EXP \cn[+",d:finalexpamount-PreComboEXP,s:"]\c-";0,3418,cr_gold,59.0,6.0,1.5);
    else HudMessage(s:"+",d:finalexpamount,s:" EXP";0,3418,cr_gold,51.0,6.0,1.5);
    HudMessage(s:"\cgOVERKILL!";0,3421,cr_red,51.0,15.0,1.5);
   }
  }
  else
  {
   SetActivator(0,AAPTR_PLAYER1);
   if (MiscellaneousVars[2000] == 0) // Show this version of the "OVERKILL!" message in old-style HUD mode only
   {
    if (finalexpamount-PreComboEXP > 1) HudMessage(s:"+",d:finalexpamount,s:" EXP \cn[+",d:finalexpamount-PreComboEXP,s:"]\c-";0,3418,cr_gold,59.0,11.0,1.5);
    else HudMessage(s:"+",d:finalexpamount,s:" EXP";0,3418,cr_gold,51.0,6.0,1.5);
    HudMessage(s:"";0,3421,cr_red,51.0,11.0,1.5);
   }
  }
 }

 if (GetCVar("dvds_expcombosystem") == 1 && incrementcombo == 1)
 {
  MiscellaneousVars[160] += finalexpamount;
 }
}

script "CheckDVIIMonstersOption" (void)
{
 SetResultValue(GetCVar("dvds_classicdviimonsters"));
}

script "CheckBombersOption" (void)
{
 SetResultValue(GetCVar("dvds_suicidebombers"));
}

// Activate's the player's whistle ability, which will awaken as many monsters as possible in a certain area
script "UseWhistle" (void)
{
 int FreezePlayer = 0;
 int WhistleStamUse = 200;
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) WhistleStamUse = WhistleStamUse * 3 / 4;

 if (PowerupTimer[20] > 0) FreezePlayer += 1;
 if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
 if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[168] == 0 && MiscellaneousVars[21] >= WhistleStamUse && FreezePlayer == 0)
 {
  SpawnForced("PlayerWhistle",GetActorX(Player1TID),GetActorY(Player1TID),GetActorZ(Player1TID)+(32*65536),0,0);
  NoiseAlert(Player1TID,Player1TID);
  MiscellaneousVars[21] -= WhistleStamUse;
  MiscellaneousVars[168] = 24; // Set's cooldown for whistling
 }
}

// Checks the first Chainsaw to become the Sceptre of Empyrea if playing on a Sceptre-less start mode.
script "SawCheckSceptre" (void)
{
 int Result = 0;
 if (CharacterClass == 2)
 {
  if (GetCVar("dvds_florastartsceptre") == 0 && GetCVar("dvds_florasceptrecandrop") != 0)
  {
   if (CheckActorInventory(Player1TID,"SceptreOfEmpyrea") == 0 && ThingCountName("SceptreOfEmpyrea", 0) < 1)
   {
    Result = 1;
   }
  }
 }

 SetResultValue(Result);
}

// Checks the Berserk Pack to become the Sceptre of Empyrea if playing on a Sceptre-less start mode.
script "BerserkCheckSceptre" (void)
{
 int Result = 0;
 if (CharacterClass == 2 && random(1,4) == 1)
 {
  if (GetCVar("dvds_florastartsceptre") == 0 && GetCVar("dvds_florasceptrecandrop") != 0)
  {
   if (CheckActorInventory(Player1TID,"SceptreOfEmpyrea") == 0 && ThingCountName("SceptreOfEmpyrea", 0) < 1)
   {
    Result = 1;
   }
  }
 }
 SetResultValue(Result);
}

// Gets the Type of Classic Doom mode being used
script "CheckDoomType" (void)
{
 // 0 = Doom 2
 // 1 = Doom 1
 // 2 = Heretic
 // 3 = Hexen
 // 4 = Strife
 // 5 = Doom64
 SetResultValue(ClassicDoomType);
}

// Returns Damage inflicted by Raging Spirit ghosts.
script "GetRagingSpiritDMG" (void)
{
 int lowcap = 1;
 int lowcaprand = 2;
 int damagedivider;

 int basedamage = (((5 + random(0,2)) * random(4,8))); // 5-7 * 4-8 + ? / 5 = 4-14
 int extradamage = (((MiscellaneousVars[34] + MiscellaneousVars[36]) / 4) * random(30,50) / 40);
 int damage = basedamage + extradamage;
 if (PowerupTimer[7] > 0) 
 {
  damagedivider = random(5,6);
  lowcap = 3; 
  lowcaprand = 6; 
 }
 else
 {
  damagedivider = random(9,11);
  lowcap = 1; 
  lowcaprand = 2; 
 }
 damage /= damagedivider;
 if (damage < lowcap) { damage = random(lowcap,lowcaprand); }
 int postdamage1 = damage;
 
 if (CharacterClass == 0) damage = damage * 10 / 4; // Deggaris gives a 2.5x damage boost
 if (CharacterClass == 1) damage = damage * 3 / 4; // Illucia gets a -25% damage loss
 if (CharacterClass == 2) damage = damage * 16 / 4; // Flora gives a 4.0x damage boost
 if (CharacterClass == 8) damage = damage * 9 / 4; // Ailish gives a 3.25x damage boost
 if (CharacterClass == 9) damage = damage * 11 / 4; // Petra gives a 3.75x damage boost
 int postdamage2 = damage;

 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) damage = damage * 3 / 2; // Evenstar Necklace give 50% damage boost
 if (damage < lowcap) damage = random(lowcap,lowcaprand);
 int postdamage3 = damage;

 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
 {
    PrintBold(s:"Raging Spirit Damage:",
              s:"\n\n",
              s:"\nFinalDamage: ",d:damage,
              s:"\n\n",
              s:"\nBaseDamage: ",d:basedamage,
              s:"\nExtraDamage: ",d:extradamage,
              s:"\n\n",
              s:"\nDamageDivider: ",d:damagedivider,
              s:"\n\n",
              s:"\nPostDamage1 [LowCapCheck]: ",d:postdamage1,
              s:"\nPostDamage2 [CharCheck]: ",d:postdamage2,
              s:"\nPostDamage3 [EvenNeck]: ",d:postdamage3,
              s:"\nLowCap: ",d:lowcap,
              s:"\nLowCapRand: ",d:lowcaprand,
              s:"\n\n");
 }
 SetResultValue(damage);
}

// Returns Damage inflicted by Poison Clouds.
script "GetPoisonCloudDMG" (int level)
{
 int basedamage;
 int damage;
 int extradamage;
 int postdamage1;
 int postdamage2;
 int postdamage3;
 int lowcap;
 int lowcaprand;

 if (Level == 0) { basedamage = random(16,24); lowcap = 8; } // Minor
 if (Level == 1) { basedamage = random(36,48); lowcap = 16; } // Normal
 if (Level == 2) { basedamage = random(72,88); lowcap = 32; } // Major

 if (Level == 3) { basedamage = random(4,6); lowcap = 2; } // Minor [left]
 if (Level == 4) { basedamage = random(9,12); lowcap = 4; } // Normal [left]
 if (Level == 5) { basedamage = random(18,22); lowcap = 8; } // Major [left]
 lowcaprand = lowcap * 3 / 2;
 damage = basedamage;

 if (CharacterClass == 0) postdamage1 = damage * 32 / 10;
 if (CharacterClass == 1) postdamage1 = damage * 21 / 10;
 if (CharacterClass == 2) postdamage1 = damage * 10 / 10;
 if (CharacterClass == 8) postdamage1 = damage * 24 / 10;
 if (CharacterClass == 9) postdamage1 = damage * 16 / 10;
 damage = postdamage1;

 if (CharacterClass == 0) extradamage = damage * (MiscellaneousVars[34] / 2) / 60;
 if (CharacterClass == 1) extradamage = damage * (MiscellaneousVars[34] / 2) / 68;
 if (CharacterClass == 2) extradamage = damage * (MiscellaneousVars[34] / 2) / 76;
 if (CharacterClass == 8) extradamage = damage * (MiscellaneousVars[34] / 2) / 64;
 if (CharacterClass == 9) extradamage = damage * (MiscellaneousVars[34] / 2) / 70;
 damage += extradamage;

 if (damage < lowcap) damage = random(lowcap,lowcaprand);

 if (GetCVar("dvdsdebug_showplayeratkinformation") == 1)
 {
    PrintBold(s:"Poison Cloud Damage:",
              s:"\n\n",
              s:"\nFinalDamage: ",d:damage,
              s:"\n\n",
              s:"\nBaseDamage: ",d:basedamage,
              s:"\nExtraDamage: ",d:extradamage,
              s:"\nPostDamage1: ",d:postdamage1,
              s:"\nLowCap: ",d:lowcap,
              s:"\nLowCapRand: ",d:lowcaprand,
              s:"\n\n");
 }
 SetResultValue(damage);
}

// Returns the Character ID
script "CheckCharacterClass" (void)
{
 SetResultValue(CharacterClass);
}

// -----------------------------------------------------------------------------
//
// Side dashing / dodging scripts by KeksDose
//
// 23 / June / 2013
//
// This script allows you to double tap your strafing buttons to execute some
// mad side dash. Kinda like the sidestep spring in GoldenEye 007
// and Perfect Dark.
//
// Edit 20 / April / 2014:
//
// Condensed script to 80 character limit, improved some stuff. Dashing on the
// ground is more powerful, air dash adds a little jump. Using the resurrect
// cheat will no longer disable dashing. You can now dash with the turn buttons.
// And the dash sound will no longer play in the whole map. Now works like
// Unreal's dashing.
//
// Reuse and modify these scripts as you wish, just credit me somewhere.
//
// -----------------------------------------------------------------------------

// Preprocessor and global constants:

#libdefine SD_TIMEFRAME		8		// Tics during which you must double press
#libdefine SD_DASHDELAY		30		// Tics before being able to dash again
#libdefine SD_DASHSPEED		9.0		// Dash speed whilst in the air
#libdefine SD_DASHJUMP		10.0	// Adds a little z-velocity while in the air
#libdefine SD_DASHSTRONG	20.0	// And dash speed whilst grounded
#libdefine SD_SOUNDVOLUME	1.0		// How loud the dash sound is played

str dashSound;
str dashGruntSound;

// Global variables:

int settings[4][2] = 
{
 { BT_FORWARD,		0.00 	},
 { BT_MOVELEFT,		0.25	}, // Yeah, I don't like dashing by accident when I combine TURNLEFT w/ MOVELEFT, so TURNLEFT doesn't apply in DV-DS's version
 { BT_BACK,			0.50	},
 { BT_MOVERIGHT,	0.75	} // Yeah, I don't like dashing by accident when I combine TURNRIGHT w/ MOVERIGHT, so TURNRIGHT doesn't apply in DV-DS's version
};

function int IsButtonPressed (int input, int oldInput, int mask)
{
 return (input & ~oldInput) & mask;
}

script "KD-SideDodge" enter
{
 int input, oldInput, taps, tics, last, angle, velX, velY, velZ;
 int dashstamina, cooldownreduction;

 int dashtapwindow = 8;			// Same type of var/define as SD_TIMEFRAME, but made to be editable
 int dashcooldown = 30;			// Same type of var/define as SD_DASHDELAY, but made to be editable
 int airdashvel = 20.0;			// Same type of var/define as SD_DASHSPEED, but made to be editable 
 int dashjumpstrength = 5.0;	// Same type of var/define as SD_DASHJUMP, but made to be editable
 int floordashvel = 25.0;		// Same type of var/define as SD_DASHSTRONG, but made to be editable
 int dashsoundvolume = 0.67;	// Same type of var/define as SD_SOUNDVOLUME, but made to be editable
 int dashgruntsoundvolume = 1.0;

 int FreezePlayer = 0;
 while(GetActorProperty(0, APROP_HEALTH) > 0)
 { 
  input = GetPlayerInput(-1, INPUT_BUTTONS);
  oldInput = GetPlayerInput(-1, INPUT_OLDBUTTONS);

  dashcooldown = 30;
  cooldownreduction = 0;
  if (PlayerLevel >= 25) cooldownreduction += 1 + ((PlayerLevel - 25) / 50); // Max of -8 [22 left]
  if (MiscellaneousVars[31] >= 10) cooldownreduction += (MiscellaneousVars[31] / 10);
  dashcooldown -= cooldownreduction;
  if (dashcooldown < 4) dashcooldown = 4;
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) dashcooldown = dashcooldown * 3 / 4; // Dash-Cooldown time cut by 25%

  if (GetActorZ(0) - GetActorFloorZ(0) > 0) { dashstamina = 625; } else { dashstamina = 500; }
  if (GetCVar("dvds_musou_powertripmode") == 1) dashstamina = dashstamina / 5;
  if (GetCVar("dvds_musou_powertripmode") == 2) dashstamina = dashstamina / 10; 
  if (CheckActorInventory(Player1TID,"SafeTeaShoes") > 0) dashstamina = dashstamina * 2 / 5; // Stamina require for dash/air-dash cut by 60%
  if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) dashstamina = dashstamina * 3 / 4;
  if (CharacterClass == 0) dashstamina -= ((MiscellaneousVars[31] * 5) / 6);
  if (CharacterClass == 1) dashstamina -= ((MiscellaneousVars[31] * 6) / 6);
  if (CharacterClass == 2) dashstamina -= ((MiscellaneousVars[31] * 7) / 6);
  if (CharacterClass == 8) dashstamina -= ((MiscellaneousVars[31] * 8) / 6);
  if (CharacterClass == 9) dashstamina -= ((MiscellaneousVars[31] * 5) / 6);
  if (GetActorZ(0) - GetActorFloorZ(0) > 0) 
  {
   if (dashstamina < 50) dashstamina = 50;
  } 
  else 
  { 
   if (dashstamina < 40) dashstamina = 40;
  }

  int candash = 1;
  if (DVDSSpecialArrayValue[0] == 1) candash--;
  if (DVDSSpecialArrayValue[9] == 1) candash--;
  for (int i = 0; i < 4; i++)
  {
   if (candash > 0)
   {
			int chordDashing = (input & (settings[i][0] | BT_USER3)) == (settings[i][0] | BT_USER3);
			
	   if ((chordDashing || IsButtonPressed(input, oldInput, settings[i][0])) && MiscellaneousVars[21] >= dashstamina && GetCVar("dvds_allowdashing") > 0) // DV-DS version also requires a minimal amount of Stamina and the Dash option on to perform
	   {
		if (GetCVar("dvds_doubledash"))
		{
			taps++;
			tics = dashtapwindow;
		}

		if (chordDashing || (taps == 2 && last == i))
		{
		 taps = 0;
		 angle = GetActorAngle(0) + settings[i][1];

		 if (GetActorZ(0) - GetActorFloorZ(0) > 0)
		 {
		  velX = FixedMul(cos(angle), airdashvel);
		  velY = FixedMul(sin(angle), airdashvel);
		  velZ = -GetActorVelZ(0) + dashjumpstrength;
		  dashSound = "player/airjump";
		  if (CharacterClass == 0) dashGruntSound = "DeggarisDash";
		  if (CharacterClass == 1) dashGruntSound = "IlluciaDash";
		  if (CharacterClass == 2) dashGruntSound = "FloraDash";
		  //if (CharacterClass == 8) dashGruntSound = "AilishDash";
		  if (CharacterClass == 9) dashGruntSound = "PetraDash";
		 }
		 else
		 {
		  velX = FixedMul(cos(angle), floordashvel);
		  velY = FixedMul(sin(angle), floordashvel);
		  velZ = 0.0;
		  dashSound = "player/dash";
		  if (CharacterClass == 0) dashGruntSound = "DeggarisDash";
		  if (CharacterClass == 1) dashGruntSound = "IlluciaDash";
		  if (CharacterClass == 2) dashGruntSound = "FloraDash";
		  //if (CharacterClass == 8) dashGruntSound = "AilishDash";
		  if (CharacterClass == 9) dashGruntSound = "PetraDash";
		 }

		 FreezePlayer = 0;
		 if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;
		 if (PowerupTimer[20] > 0) FreezePlayer += 1;
		 if (FreezePlayer == 0)
		 {
		  MiscellaneousVars[21] -= dashstamina;
          int whole = dashstamina / 100; 
          int modulus = dashstamina % 100;
          if (GetCVar("dvdsdebug_showstaminausestuff") > 0)
          {
           if (modulus > -1 && modulus < 10) PrintBold(s:"Stamina Used: ",d:whole,s:".0",d:modulus,s:"%");
           else PrintBold(s:"Stamina Used: ",d:whole,s:".",d:modulus,s:"%");
          }
		  if (MiscellaneousVars[21] < 0) MiscellaneousVars[21] = 0;
		  SetActorVelocity(0, velX, velY, velZ, true, false);
		  PlaySound(0, dashSound, CHAN_BODY, dashsoundvolume);
		  if (random(1,100) <= GetCVar("dvds_dashgruntchance")) PlaySound(0, dashGruntSound, CHAN_VOICE, dashgruntsoundvolume);
		  MiscellaneousVars[166] = 18; // Set Dash Timer 
		  Delay(dashcooldown);
		 }

		 while(GetActorVelZ(0) < 0.0)
		 {
		  Delay(const:1);
		 }
		}

		last = i;
	   }
   }
  }

  if(tics)
  {
   tics--;

   if(!tics)
   {
    taps = 0;
   }
  }

  if (GetCVar("dvdsdebug_showdashinformation") > 0)
  {
   PrintBold(s:"i: ",d:i,
             s:"\ncandash?: ",d:candash,
             s:"\ninput: ",d:input,
             s:"\noldInput: ",d:oldInput,
             s:"\ntics: ",d:tics,
             s:"\nlast: ",d:last,
             s:"\ntaps: ",d:taps,
             s:"\ncooldownreduction: ",d:cooldownreduction,
             s:"\ndashcooldown: ",d:dashcooldown);
  }
  Delay(const:1);
 }
}

script "KD-ResurrectSideDodge" death
{
 while(GetActorProperty(0, APROP_HEALTH) <= 0)
  Delay(const:1);
 
 ACS_NamedExecuteAlways("KD-SideDodge", 0);
}

script "KD-ReactivateSideDodge" respawn
{
 ACS_NamedExecuteAlways("KD-SideDodge", 0);
}

// Crisis Attack Damage Multiplier
script "CrisisMultiplierMonsters" (void)
{
 int canusecrisisatk = 0;
 if (GetCVar("dvds_monstercrisisattacks") == 1)
 {
  if(GetActorProperty(0,APROP_Health) <= GetUserVariable(0,"user_HPLowRange"))
  {
   if(GetActorProperty(0,APROP_Health) <= GetUserVariable(0,"user_HPCritRange"))
   {
    canusecrisisatk = 1;
   }
   else
   {
    if (random(1,4) == 4) { canusecrisisatk = 1; }
   }
  }
 }

 if (canusecrisisatk > 0)
 {
  SetResultValue(GetCVar("dvds_monstercrisismulti"));
 }
 else
 {
  SetResultValue(1);
 }
}

script "CrisisMultiplier" (int type)
{
 int base = 1;
 if (type <= 1) type = 1;
 if (GetCVar("dvds_monstercrisisattacks") == 1)
 {
  base = GetCVar("dvds_monstercrisismulti");
  base /= type;
  if (base <= 1) base = 1;
 }
 if (GetCVar("dvdsdebug_showmiscdmginformation") > 0) 
 {
   PrintBold(s:"Crisis Multiplier: ",d:GetCVar("dvds_monstercrisismulti"),
             s:"\ndivider: ",d:type,
             s:"\n\nResult: ",d:base);
 }
 SetResultValue(base);
}

// Mana Drain script
script "ManaDrain" (int baseamount, int draintype, int ignoredefense, int exceedmax)
{
 int MaxManaDouble = MaxMana * 2;
 int basedrain = baseamount;
 int firstmana = CurrentMana;
 
 // type 1 drains a % of magic instead of a set amount
 if (draintype == 1) { baseamount = (baseamount * MaxMana) / 100; } 

 int manalossreduction = 100;
 if (CheckActorInventory(Player1TID,"EvenstarNecklace") > 0) { manalossreduction -= 10; } // Evenstar Necklace [Reduces Mana loss by 10%]
 if (CheckActorInventory(Player1TID,"AnubisCufflinks") > 0) { manalossreduction -= 2; } // Anubis Cufflinks [MP reduction of 2 + 2%]
 if (CheckActorInventory(Player1TID,"BalrogRing") > 0) { manalossreduction -= 5; } // Balrog's Ring [MP reduction of 5 + 5%]
 if (ignoredefense == 0) baseamount = baseamount * manalossreduction / 100;

 if (baseamount != 0) CurrentMana -= baseamount;
 
 if (CurrentMana < 1) CurrentMana = 0;
 if (CurrentMana > MaxMana && exceedmax == 0) CurrentMana = MaxMana;
 if (CurrentMana > MaxManaDouble && exceedmax == 1) CurrentMana = MaxManaDouble;
 
 if (GetCVar("dvdsdebug_showmiscdmginformation") > 0) 
 {
    PrintBold(s:"Base Drain: ",d:basedrain,
			  s:"\nTrue Drain: ",d:baseamount,
			  s:"\n\n",
			  s:"\nMana Loss Reduction: ",d:manalossreduction,
			  s:"\n",
			  s:"\nMax Mana: ",d:MaxMana,
			  s:"\nMax Mana [Double]: ",d:MaxManaDouble,
			  s:"\n",
			  s:"\nMana [Before]: ",d:firstmana,
			  s:"\nMana [After]: ",d:CurrentMana,
	          s:"\n");
 }

}

// Pain Sound Check [Flora]
script "FloraPainScreams" (void)
{
  int CurrentHealth = GetActorProperty(Player1TID,APROP_Health);
  int HealthRatio = CurrentHealth * 1000 / MaxHealthTrue;
  //StopSound(Player1TID,CHAN_VOICE); 
  if (HealthRatio >= 667) PlaySound(Player1TID,"FloraPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
  if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"FloraPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
  if (HealthRatio <= 333 && CurrentHealth > 0) PlaySound(Player1TID,"FloraPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
}

// Pain Sound Check [Ailish]
script "AilishPainScreams" (void)
{
  int CurrentHealth = GetActorProperty(Player1TID,APROP_Health);
  int HealthRatio = CurrentHealth * 1000 / MaxHealthTrue;
  //StopSound(Player1TID,CHAN_VOICE); 
  if (HealthRatio >= 667) PlaySound(Player1TID,"AilishPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
  if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"AilishPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
  if (HealthRatio <= 333 && CurrentHealth > 0) PlaySound(Player1TID,"AilishPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
}

// Pain Sound Check [Petra]
script "PetraPainScreams" (void)
{
  int CurrentHealth = GetActorProperty(Player1TID,APROP_Health);
  int HealthRatio = CurrentHealth * 1000 / MaxHealthTrue;
  //StopSound(Player1TID,CHAN_VOICE); 
  if (HealthRatio >= 667) PlaySound(Player1TID,"PetraPainSet1",CHAN_VOICE,1.0,0,ATTN_NORM); 
  if (HealthRatio >= 334 && HealthRatio <= 666) PlaySound(Player1TID,"PetraPainSet2",CHAN_VOICE,1.0,0,ATTN_NORM);
  if (HealthRatio <= 333 && CurrentHealth > 0) PlaySound(Player1TID,"PetraPainSet3",CHAN_VOICE,1.0,0,ATTN_NORM);
}

// STRIFE Compatibility [Stamina Upgrades]
script "StrifeStaminaUpgrade" (void)
{
 int OldStamina = MiscellaneousVars[317] * 10;

 MiscellaneousVars[317] += 1;
 if (MiscellaneousVars[317] < 0) MiscellaneousVars[317] = 0;
 if (MiscellaneousVars[317] > 10) MiscellaneousVars[317] = 10;

 int NewStamina = MiscellaneousVars[317] * 10;

 PrintBold(s:"Stamina Level increased from ",d:OldStamina,s:" to ",d:NewStamina,s:"!");
}

// STRIFE Compatibility [Accuracy Upgrades]
script "StrifeAccuracyUpgrade" (void)
{
 int OldAccuracy = GetActorProperty(Player1TID,APROP_Accuracy);
 int NewAccuracy = OldAccuracy+10;
 int tempaeonpts;
 MiscellaneousVars[318] += 1;
 if (MiscellaneousVars[318] < 0) MiscellaneousVars[318] = 0;
 if (MiscellaneousVars[318] > 11) MiscellaneousVars[318] = 11;

 if (MiscellaneousVars[318] == 1) tempaeonpts += 11;
 if (MiscellaneousVars[318] == 2) tempaeonpts += 13;
 if (MiscellaneousVars[318] == 3) tempaeonpts += 15;
 if (MiscellaneousVars[318] == 4) tempaeonpts += 17;
 if (MiscellaneousVars[318] == 5) tempaeonpts += 19;
 if (MiscellaneousVars[318] == 6) tempaeonpts += 21;
 if (MiscellaneousVars[318] == 7) tempaeonpts += 23;
 if (MiscellaneousVars[318] == 8) tempaeonpts += 25;
 if (MiscellaneousVars[318] == 9) tempaeonpts += 27;
 if (MiscellaneousVars[318] == 10) tempaeonpts += 29;

 tempaeonpts *= MiscellaneousVars[86];
 MiscellaneousVars[25] += tempaeonpts;
 MiscellaneousVars[2033] = 105;
 
 SetActorProperty(Player1TID,APROP_Accuracy,NewAccuracy);
 if (GetActorProperty(Player1TID,APROP_Accuracy) > 100) { SetActorProperty(Player1TID,APROP_Accuracy,100); NewAccuracy = 100; }
 
 PrintBold(s:"Accuracy Level increased from ",d:OldAccuracy,s:" to ",d:NewAccuracy,s:"!");
}

// STRIFE Compatibility [Stamina/Accuracy Combo Upgrades]
script "StrifeComboUpgrade" (void)
{
 int OldStamina = MiscellaneousVars[317] * 10;

 MiscellaneousVars[317] += 1;
 if (MiscellaneousVars[317] < 0) MiscellaneousVars[317] = 0;
 if (MiscellaneousVars[317] > 10) MiscellaneousVars[317] = 10;

 int NewStamina = MiscellaneousVars[317] * 10;

 int OldAccuracy = GetActorProperty(Player1TID,APROP_Accuracy);
 int NewAccuracy = OldAccuracy+10;
 int tempaeonpts;
 MiscellaneousVars[318] += 1;
 if (MiscellaneousVars[318] < 0) MiscellaneousVars[318] = 0;
 if (MiscellaneousVars[318] > 11) MiscellaneousVars[318] = 11;

 if (MiscellaneousVars[318] == 1) tempaeonpts += 11;
 if (MiscellaneousVars[318] == 2) tempaeonpts += 13;
 if (MiscellaneousVars[318] == 3) tempaeonpts += 15;
 if (MiscellaneousVars[318] == 4) tempaeonpts += 17;
 if (MiscellaneousVars[318] == 5) tempaeonpts += 19;
 if (MiscellaneousVars[318] == 6) tempaeonpts += 21;
 if (MiscellaneousVars[318] == 7) tempaeonpts += 23;
 if (MiscellaneousVars[318] == 8) tempaeonpts += 25;
 if (MiscellaneousVars[318] == 9) tempaeonpts += 27;
 if (MiscellaneousVars[318] == 10) tempaeonpts += 29;

 tempaeonpts *= MiscellaneousVars[86];
 MiscellaneousVars[25] += tempaeonpts;
 MiscellaneousVars[2033] = 105;

 SetActorProperty(Player1TID,APROP_Accuracy,NewAccuracy);
 if (GetActorProperty(Player1TID,APROP_Accuracy) > 100) { SetActorProperty(Player1TID,APROP_Accuracy,100); NewAccuracy = 100; }
 
 PrintBold(s:"Stamina Level increased from ",d:OldStamina,s:" to ",d:NewStamina,s:"!\n",
           s:"Accuracy Level increased from ",d:OldAccuracy,s:" to ",d:NewAccuracy,s:"!");
}

//
script "FlameCount" (int type, int value)
{
 if (type == 0) // Set
 {
  MiscellaneousVars[297] = value;
 }
 if (type == 1) // Add/Sub
 {
  MiscellaneousVars[297] += value;
 }
 if (type == 2) // Get
 {
  SetResultValue(MiscellaneousVars[297]);
 }
 //PrintBold(s:"FlameCount: ",d:MiscellaneousVars[297]);
}




//**********************************************************
//*SIGIL STUFF - Code by "FishyClockwork" from ZDoom forums*
//**********************************************************

Script "NNSigilDamageUser" (int damage)
{
   int currenthealth = GetActorProperty(Player1TID,APROP_HEALTH);
   // damage = % of damage taken instead of a direct value [DV-DS specfic]
   damage = MaxHealthTrue * damage / 100;

   int ignorecommand = 0;
   if (MiscellaneousVars[195] > 0) ignorecommand++; // If in mercy invincibility, no effect
   if (CheckActorInventory(Player1TID,"InvulnerabilitySpell") > 0) ignorecommand++; // if invulnerable, no effect
   if (GetActorProperty(Player1TID,APROP_INVULNERABLE) > 0) ignorecommand++; // if invulnerable, no effect
   if (ignorecommand == 0)
   {
    //PrintBold(d:damage);
    SetActorProperty(Player1TID,APROP_HEALTH,currenthealth-damage);  
	// Thing_Damage2(0, damage, "NNSigilUse");
	// DamageActor(Player1TID, AAPTR_PLAYER1, 0, AAPTR_NULL, damage, "NNSigilUse");
   }
}

Script "NNSigilPieceCount" (void)
{
   SetResultValue( GetSigilPieces() );
}

bool monitoring_players[8];
bool players_returned[8];

Script "NNSigilMonitor" ENTER
{
   int current_pieces;
   int previous_pieces = GetSigilPieces(); //Takes care of first time visits
                                        //(related to bug #3 mentioned in EDIT4)
   int player = PlayerNumber();

   if ( monitoring_players[player] )   //Make sure there's only one instance
      terminate;                        //of this script running per player.
   monitoring_players[player] = true;   //(as some goof might try to puke this)

   while( monitoring_players[player] )
   {
      players_returned[player] = false;
      Delay(1);

      if ( GetActorProperty(0, APROP_Health) <= 0 )
         continue; //Don't terminate if dead (could be a COOP or DM game)

      current_pieces = GetSigilPieces();
      //If you find this next part undesirable, you can
      //just put 'continue;' right after the 'if' statement.
      if ( !current_pieces )
      {
         if ( CheckInventory("NNSigil") )   //If you don't have the real one
            TakeInventory("NNSigil", 1);   //you can't have the NN one
         continue;
      }
      else if ( !CheckInventory("NNSigil") )
         GiveInventory("NNSigil", 1);
      
      if ( CheckWeapon("Sigil") )
      {
         SetWeapon("NNSigil");
         continue;
      }

      if ( previous_pieces != current_pieces )
      {
         previous_pieces = current_pieces;
         if ( players_returned[player] ) //Takes care of subsequent visits
            continue;                    //(related to bug #3 mentioned in EDIT4)

         if ( CheckWeapon("NNSigil") ) //Don't run upgrade animation hack
            SetWeapon("Sigil");   //if player is holding another weapon.
      }
   }
}

Script "NNSigilStopMonitoring" (int player) DISCONNECT
{
   monitoring_players[player] = false;
}

Script "NNSigilPlayerReturned" RETURN
{
   players_returned[PlayerNumber()] = true;
}

//And now for some multiplayer related nonsense, bleh.

Script "NNSigilPlayerDeath" DEATH
{
   if ( !(GetCVar("dmflags2") & 2) || !CheckWeapon("NNSigil") )
      terminate;

   int piece = GetSigilPieces();
   if ( !piece ) piece = 1; //Shouldn't happen, but better safe than sorry
   SpawnSpot( strparam(s:"Sigil", d:piece), 0 );
}



// Healing for NON-Players [via Healing Projectiles]
Script "Healing_Actor" (int type, int returntype)
{
 int HealCap, HealAmount;
 int oldhealthvalue, finalhealvalue;

 ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
 if (Type == 0) // Minor Healing
 {
   HealCap = GetUserVariable(0,"user_MaxHP");
   HealAmount = random(GetHealingValue(0,0),GetHealingValue(0,1));

   if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
   else ActivatorSound("HealSpell1",127); 
   if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
 }
 if (Type == 1) // Healing
 {
  HealCap = GetUserVariable(0,"user_MaxHP");
  HealAmount = random(GetHealingValue(1,0),GetHealingValue(1,1));

  if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
  else ActivatorSound("HealSpell1",127); 
  if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantMidHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
 }
 if (Type == 2) // Major Healing
 {
  HealCap = GetUserVariable(0,"user_MaxHP") * 2;
  HealAmount = random(GetHealingValue(2,0),GetHealingValue(2,1));

  if (CharacterClass == 2) ActivatorSound("healing_dq",127); 
  else ActivatorSound("HealSpell1",127); 
  if (CharacterClass == 2 && random(1,16) == 1) PlaySound(Player1TID,"FloraChantMoreHeal",CHAN_VOICE,1.0,0,ATTN_NORM);
 }

 if (returntype == 0)
 {
  oldhealthvalue = GetActorProperty(0,APROP_HEALTH);
  finalhealvalue = oldhealthvalue + HealAmount;
  if (oldhealthvalue < HealCap)
  {
   ACS_NamedExecuteAlways("StartTensionCountDown",0,0,0,0);
   if (finalhealvalue < 1) finalhealvalue = 1; // Prevents the gaming from killing the target when trying to heal >__>;
   if (finalhealvalue > HealCap) finalhealvalue = HealCap;
   SetActorProperty(0,APROP_HEALTH,finalhealvalue);
  }
 }
 else
 {
  SetResultValue(HealAmount);
 }
}

// For showing Quest Item progress in Strife mode :V
script "DebugStrifeFlags" (void)
{
 int flag1, flag2, flag3, flag4, flag5, flag6, flag7, flag8, flag9, flag10, flag11, flag12, flag13, flag14, flag15, flag16;
 int flag17, flag18, flag19, flag20, flag21, flag22, flag23, flag24, flag25, flag26, flag27, flag28, flag29, flag30, flag31, flag32;

 flag1 = CheckActorInventory(Player1TID,"QuestItem1");
 flag2 = CheckActorInventory(Player1TID,"QuestItem2");
 flag3 = CheckActorInventory(Player1TID,"QuestItem3");
 flag4 = CheckActorInventory(Player1TID,"QuestItem4");
 flag5 = CheckActorInventory(Player1TID,"QuestItem5");
 flag6 = CheckActorInventory(Player1TID,"QuestItem6");
 flag7 = CheckActorInventory(Player1TID,"QuestItem7");
 flag8 = CheckActorInventory(Player1TID,"QuestItem8");
 flag9 = CheckActorInventory(Player1TID,"QuestItem9");
 flag10 = CheckActorInventory(Player1TID,"QuestItem10");
 flag11 = CheckActorInventory(Player1TID,"QuestItem11");
 flag12 = CheckActorInventory(Player1TID,"QuestItem12");
 flag13 = CheckActorInventory(Player1TID,"QuestItem13");
 flag14 = CheckActorInventory(Player1TID,"QuestItem14");
 flag15 = CheckActorInventory(Player1TID,"QuestItem15");
 flag16 = CheckActorInventory(Player1TID,"QuestItem16");
 flag17 = CheckActorInventory(Player1TID,"QuestItem17");
 flag18 = CheckActorInventory(Player1TID,"QuestItem18");
 flag19 = CheckActorInventory(Player1TID,"QuestItem19");
 flag20 = CheckActorInventory(Player1TID,"QuestItem20");
 flag21 = CheckActorInventory(Player1TID,"QuestItem21");
 flag22 = CheckActorInventory(Player1TID,"QuestItem22");
 flag23 = CheckActorInventory(Player1TID,"QuestItem23");
 flag24 = CheckActorInventory(Player1TID,"QuestItem24");
 flag25 = CheckActorInventory(Player1TID,"QuestItem25");
 flag26 = CheckActorInventory(Player1TID,"QuestItem26");
 flag27 = CheckActorInventory(Player1TID,"QuestItem27");
 flag28 = CheckActorInventory(Player1TID,"QuestItem28");
 flag29 = CheckActorInventory(Player1TID,"QuestItem29");
 flag30 = CheckActorInventory(Player1TID,"QuestItem30");
 flag31 = CheckActorInventory(Player1TID,"QuestItem31");
 PrintBold(
           s:"               Flag 1 [Beldin's Ring]: ",d:flag1,s:"\n",
           s:"               Flag 2 [Stole Chalice]: ",d:flag2,s:"\n",
           s:"             Flag 3 [Can Visit Irale]: ",d:flag3,s:"\n",
           s:"               Flag 4 ['Messy' Chore]: ",d:flag4,s:"\n",
           s:"              Flag 5 ['Bloody' Chore]: ",d:flag5,s:"\n",
           s:"          Flag 6 [Destroyed Coupling]: ",d:flag6,s:"\n",
           s:"        Flag 7 [Killed Scanning Team]: ",d:flag7,s:"\n",
           s:"   Flag 8 [Got Broken Power Coupling]: ",d:flag8,s:"\n",
           s:"                Flag 9 [Derwin's Ear]: ",d:flag9,s:"\n",
           s:"                Flag 10 [Prison Pass]: ",d:flag10,s:"\n",
           s:"                 Flag 11 [Prison Key]: ",d:flag11,s:"\n",
           s:"            Flag 12 [Wolfnick's Hand]: ",d:flag12,s:"\n",
           s:"             Flag 13 [Free Prisoners]: ",d:flag13,s:"\n",
           s:"          Flag 14 [Destroyed Crystal]: ",d:flag14,s:"\n",
           s:"            Flag 15 [Weran's Uniform]: ",d:flag15,s:"\n",
           s:"             Flag 16 [Destroyed Gate]: ",d:flag16,s:"\n",
		   s:"              Flag 17 [Macil's Story]: ",d:flag17,s:"\n",
		   s:"                Flag 18 [Oracle Pass]: ",d:flag18,s:"\n",
		   s:"           Flag 19 [Talked to Quincy]: ",d:flag19,s:"\n",
		   s:"                     Flag 20 [Unused]: ",d:flag20,s:"\n",
		   s:"              Flag 21 [Killed Bishop]: ",d:flag21,s:"\n",
		   s:"Flag 22 [Killed Oracle (post Bishop)]: ",d:flag22,s:"\n",
		   s:"              Flag 23 [Killed Oracle]: ",d:flag23,s:"\n",
		   s:"               Flag 24 [Killed Macil]: ",d:flag24,s:"\n",
		   s:"        Flag 25 [Destroyed Converter]: ",d:flag25,s:"\n",
		   s:"          Flag 26 [Killed Loremaster]: ",d:flag26,s:"\n",
		   s:"         Flag 27 [Destroyed Computer]: ",d:flag27,s:"\n",
		   s:"               Flag 28 [Catacomb Key]: ",d:flag28,s:"\n",
		   s:"      Flag 29 [Destroyed Transmitter]: ",d:flag29,s:"\n",
		   s:"                     Flag 30 [Unused]: ",d:flag30,s:"\n",
		   s:"                     Flag 31 [Unused]: ",d:flag31
		  );
}

Script "AttackTarget" (void) NET
{
 int FreezePlayer = 0;
 int WhistleStamUse = 200;
 if (CheckActorInventory(Player1TID,"FalconKnifeEarrings") > 0) WhistleStamUse = WhistleStamUse * 3 / 4;

 if (PowerupTimer[20] > 0) FreezePlayer += 1;
 if (MiscellaneousVars[2500] > 0) FreezePlayer += 1;

 int oldTID, target;
 if(SetActivator(0,AAPTR_PLAYER_GETTARGET)) // Get the target of the activator. If it fails because there is none nothing will happen.
 { 
  if (GetActorProperty(Player1TID,APROP_Health) > 0 && MiscellaneousVars[168] == 0 && MiscellaneousVars[21] >= WhistleStamUse && FreezePlayer == 0)
  {
   oldTID = ActivatorTID(); // Save the TID of the target.
   if (CheckFlag(oldTID, "FRIENDLY") == FALSE) // Don't set target to another ally. :V
   {
    target = UniqueTID(); // Get a new unique TID for the target actor.
    Thing_ChangeTID(0, target); // Set that TID to the actor.
    SetActivator(1000); // Set the activator to the actor with the given TID.
    SetPointer(AAPTR_TARGET, target); // Give a new target to it.
    Thing_ChangeTID(target,oldTID); // Restore the previous TID, because it might be used already by other scripts.
    SpawnForced("PlayerWhistle",GetActorX(Player1TID),GetActorY(Player1TID),GetActorZ(Player1TID)+(32*65536),0,0);
    MiscellaneousVars[21] -= WhistleStamUse;
    MiscellaneousVars[168] = 24; // Set's cooldown for whistling
   }
   else
   {
    PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
   }
  }
  else
  {
   PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
  }
 }
 else
 {
  PlaySound(Player1TID,"inv_fail",CHAN_BODY,1.0,0,ATTN_NORM);
 }
}

script "GetPlayerHeight" (int checktype)
{
 int height;
 int viewheight;
 int finalresult;

 height = GetActorProperty(Player1TID,APROP_Height);
 viewheight = GetActorProperty(Player1TID,APROP_ViewHeight);
 height = height>>16;
 viewheight = viewheight>>16;
 if (checktype == 0) // Just Full Height
 {
  finalresult = height;
 }
 if (checktype == 1) // View Height
 {
  finalresult = viewheight;
 }
 if (checktype == 2) // Half Height
 {
  finalresult = (height / 2);
 }
 //PrintBold(d:finalresult);
 SetResultValue(finalresult);
}

script "PopBubbles" (void)
{
 SetActorState(5001,"Pop",TRUE);
}

script "SetSceptreShieldLevel" (int level)
{
 MiscellaneousVars[397] = level;
}

script "GameSkill" (void)
{
 SetResultValue(GameSkill());
}