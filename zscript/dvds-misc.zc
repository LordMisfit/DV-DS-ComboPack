class PlayerStatItem : Inventory 
{
	const SKILL_VERY_EASY = 0;
	const SKILL_EASY = 1;
	const SKILL_NORMAL = 2;
	const SKILL_HARD = 3;
	const SKILL_VERY_HARD = 4;
	const SKILL_EXTREME = 5;
	const SKILL_HORRIBLE = 6;
	const SKILL_IMPOSSIBLE = 7;
	const SKILL_OMEGA = 8;

	const minxymoveneg = -3.814697266;
	const minxymovepos = 3.814697266;
	const minzmoveneg = -1.907348633;
	const minzmovepos = 1.907348633;
	
	mixin Tension;
	mixin DamageMessages;
	mixin HealingChecker;
	
	Array<int> SpellCostsBase;
	
	double ArmorML;
	double ArmorM;
	
	int CanTalkUnderwater;
	int HPRegenBonPenTimer;
	int MPRegenBonPenTimer;
	int StamRegenBonPenTimer;
	int HLCRCoolBonPenTimer;
	int HPRegenBonPenMulti;
	int MPRegenBonPenMulti;
	int StamRegenBonPenMulti;
	int HLCRCoolBonPenMulti;
	
	int BaseStamPenalty;

	int PrevTimeFreezeTimer;
	int InitEXPTables;
	int InitSceptreEXPTables;
	int SceptreLvl1Req;
	int SceptreLvl2Req;
	int SceptreLvl3Req;
	int SceptreLvl4Req;
	int SceptreLvl5Req;
	int SceptreLvl6Req;
	int SceptreLvl7Req;
	int SceptreLvl8Req;
	int SceptreLvl9Req;
	int SceptreLvl10Req;
	int SceptreLvl11Req;
	int SceptreLvl12Req;
	int SceptreLvl13Req;
	int SceptreLvl14Req;
	int SceptreLvl15Req;
	int SceptreLvl16Req;
	int SceptreActualLevel;
	int LevelCap;
	int ClassCheck;
	int outputdamage;
	int CharacterClass;
	int jiggle_jump, jiggle_crouch, jiggle_left, jiggle_right, jiggle_up, jiggle_down;
	
	int LevelupSpeechTimer1;
	int LevelupSpeechTimer2;
	int PrevBackPacksCollected;
	int optimizefactortics;
	int optimizefactortics2;

	int UsingInGameMenu;
	
	int DashTimer, MaxDashTimer;
	int SceptreShieldLevel;
	int AeonPtMulti;
	int LvlStatMulti;

	int IfDivAvCast;
	int NVLightTimer;
	int InvisibilityTimer;
	int FlightTimer;
	int StealthTimer;
	int InvulnerabilityTimer;
	int TimeFreezeTimer;
	int FearAuraTimer;
	int DivineAvatarTimer;
	int SpreadAura1Timer;
	int SpreadAura2Timer;
	int DQOomphTimer;
	int DQBuffTimer;
	int DQAcceleratleTimer;
	int DQBluntTimer;
	int DQSapTimer;
	int DQDeceleratleTimer;
	int PoisonedTimer;
	int CorrosionTimer;
	int FatigueTimer;
	int BlindTimer;
	int SleepTimer;
	int SilenceTimer;
	int RadSuitTimer;
	int BerserkTimer;
	int RegenerationTimer;
	int GoETimer;

	string ownername;

	// Strife Flag Checks
	int StrifeQuestFlag25, StrifeQuestFlag26, StrifeQuestFlag29;
	
	int EXPComboTimer, MaxEXPCombotimer, ComboTimerDelay;
	
	double HPRegenTimer, HPDelayInterval;
	double HPDegenTimer, HPDelayInterval2;
	double MPRegenTimer, MPDelayInterval;
	double RuinousShieldDegenTimer, CursedShieldDegenTimer;
	double DivineRegenTimer, DivineRegenInterval;
	double DoveRegenTimer, DoveRegenInterval;
	double PoisonTimer, PoisonMaxInterval;
	double RuinousPtsCurrent, RuinousPtsNeeded;
	double UncurseInterval, UncurseMaxInterval;

	int LifeUpPerkComboCheck;
	int LifeUpPerkFactor;
	int LifeUpPerkBaseFactor;
	int MagiUpPerkComboCheck;
	int MagiUpPerkFactor;
	int MagiUpPerkBaseFactor;
	int StamUpgradeHPComboCheck;
	int StamUpgradeHPPerkFactor;
	int StamUpgradeHPPerkBaseFactor;
	int StamUpgradeMPComboCheck;
	int StamUpgradeMPPerkFactor;
	int StamUpgradeMPPerkBaseFactor;

	int landdmgbonus;
	int heldtime;
	int PrevHealthRatio;
	int PoisonHits;
	int SceptreEXPRatio;
	
	int TensionLevel; // [181]
	int TensionTimer; // [183]
	int TensionWarmupTimer; // [185]
	int TensionCooldownTimer; // [186]
	int TensionChargeLoopTimer; // [189]
	int TensionActivePulseTimer; // [190]
	int TensionBackgroundAuraTimer; // [246]
	int TensionOverPsycheTimer; // [250]
	int TensionOverchargeTimer; // [251]
	int TensionMaxOverchargeTimer; // [261]
	int TensionMaxOverPsycheTimer; // [262]
	int TensionSpeedRatio; // [193]
	
	int DeathCheck, WasDead;
	int ArcanaRegenDelay;

	String nm, nn, no, np;
	String pm, pn, po, pp;
	
	int PlayerLevel;
	int MaxHealthTrue;
	int MaxHealthLimit;
	int CurrentMana;
	int MaxMana;
	int PlayerAGL;
	int PlayerDEF;
	int PlayerDFT;
	int PlayerSOR;
	int PlayerSTR;
	int PlayerTHE;
	int PlayerJUMP;
	int PlayerAeonPts;
	int CurrentStamina;
	int MaximumStamina;
	int MegaMaxStamina;
	int PlayerCurrentMP;
	int PlayerCurrentHealth;
	int IsFocusOn;
	int FocusTimer;
	int FocusHumTimer;
	int BaseSceptreEXP;
	int SceptreLevelEXP;

	int SkillFactor;
	int TrueGameSkill;
	int CurrentArmorClass;
	int CurrentMaxArmor;
	int HellcoreOverheatLevel;
	double HellcoreCooldownSpeed;
	int HellcoreCooldownTimer;
	int ClassicDoomType;
	int ModType;
	
	int buttons;
	int oldbuttons;
	int FreezePlayer;
	int Player1TID;
	
	int EvasionRate; // Based on 0.1% to 100.0% [though the displays only show full %]
	double AglEvadeCheck, DftEvadeCheck;

	int ArmorResistance;
	int BasePerkFactor;
	int PerkFactor;
	double PerkFactor2;
	int TotalMass, BaseMass, PreBuffMass;
	int delaycount;
	int HealthRatio;
	int previousdelaycount;
	int ArmorBits;
	
	int minigunheat;
	int minigunheatmax;

	int MortalHitSurviveRate;
	int AGL, DEF, DFT, SOR, STR, THE, AeonPts;

	int HellcoreCoolRatio;
	
	int perks3mastered;
	int aeonptsperksused;
	int LifeUpPerkLvl;
	int LifeUpExPerkLvl;
	int MagiUpPerkLevel;
	int MagiUpEXPerkLevel;
	int StamUpPerkLvl;
	int StamUpEXPerkLvl;
	int DodgeMorePerkLvl;
	int DodgeMoreEXPerkLvl;
	int JmpMorePerkLvl;
	int JmpMoreEXPerkLvl;
	int PsychFstPerkLvl;
	int PsychFstEXPerkLvl;
	int RegHPFstPerkLvl;
	int RegHPFstEXPerkLvl;
	int RegMPFstPerkLvl;
	int RegMPFstEXPerkLvl;
	int RegStamFastLvl;
	int RegStamFastEXLvl;

	int BulletAccPerkLvl;
	int BulletAccEXPerkLvl;
	int DemolitionsExpertPerkLevel;
	int DemolitionsExpertEXPerkLevel;

	int ArcheryMasteryPerkLevel;
	int ArcheryMasteryEXPerkLevel;
	int SoulMasteryPerkLevel;
	int SoulMasteryEXPerkLevel;
	int MartialArtsMastery;
	int MartialArtsMasteryEx;
	int BerserkerFit;
	int BerserkerFitEX;
	//
	int DeathRagePerkLvl;
	int DeathRageEXPerkLvl;
	int OTMPerkLvl;
	int OTMEXPerkLvl;
	//
	int WandMasteryPerkLevel;
	int WandMasteryEXPerkLevel;
	int ClearMindPerkLvl;
	int ClearMindEXPerkLvl;
	
	int StrifeStamLvl;
	int StrifeAccuLvl;
	
	int DeathRageTimer;
	int DeathRageMaxTimer;
	int DeathRageTimerCooldown;
	
	int HellWarriorShieldLevel;

	default 
	{
		+Inventory.PERSISTENTPOWER;
		+Inventory.UNDROPPABLE;
		+Inventory.UNTOSSABLE;
	}

	private class<Inventory> APPackToken, APPackCheck, APPackCheck2, APPackCheck3, APPackCheck4;
	private class<Inventory> iDTech1Check, iDTech1Check2, iDTech1Check3, iDTech1Check4;
	
	bool A_CheckBerserk()
	{
		bool check = false;
		if (owner)
		{
			if (owner.CountInv("PowerStrength") || 
					owner.CountInv("AetheriusPowerStrength")) check = true;
		}
		return check;
	}
	
	override void DoEffect()
	{
		Player1TID = 1001;
		optimizefactortics = dvdsdebug_optimizefactortics;
		optimizefactortics2 = dvdsdebug_optimizefactortics2;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (!playeractor) { owner.A_SetInventory("PlayerStatItem",0); super.DoEffect(); } // Removes itself if given to a non-Aetherius Player Class
		else if (level.time == 0) owner.ChangeTID(Player1TID);

		let weapon = owner.player.ReadyWeapon;
		buttons = owner.GetPlayerInput(INPUT_BUTTONS);
		oldbuttons = owner.GetPlayerInput(INPUT_OLDBUTTONS);
		
		DVDSPreInitStuff();
		
		//**********************
		//*Initialization Stuff*
		//**********************
		DVDSInitStuff();
		
		// HUD/Weapon Mana Costs
		A_PSI1DoEffectWeaponManaCostCheck();
		
		//**********************
		//**Misc Option Checks**
		//**********************
		A_PSI1DoEffectMiscOptions();
		
		//****************************************
		//**Checks for Aeon Point Cost for Perks**
		//****************************************
		CallACS("MiscVarSetDECORATE",280,dvdsperks_costratio);
		
		//****************************************************************************************************************************************************************
		//**Checks "user_PlayerDVDSSpecial[]" array on the player actors [used for various things, including disjointed MAP-specific ACS scripts (TCOTD:A, Unloved, etc)]**
		//****************************************************************************************************************************************************************
		A_PSI1DoEffectSpecialArray();
		
		//*****************************************************
		//*Checks Flora's EXP for using the Sceptre of Empyrea*
		//*****************************************************
		A_PSI1DoEffectSceptreEXPTables();
		
		//******************************
		//** Armor Resistance Numbers **
		//******************************
		A_PSI1DoEffectArmorResNums();
		
		//***********************
		//** Wand Guard Chance **
		//***********************
		A_PSI1DoEffectWandGuard();
		
		//********************
		//**Level Cap Checks**
		//********************
		A_PSI1DoEffectLevelCaps();
		
		//*****************************
		//* RadSuit Effects via Armor *
		//*****************************
		A_PSI1DoEffectIronFeetArmor();
		
		//****************************
		//*Strife Sigil & Flag Checks*
		//****************************
		A_PSI1DoEffectSigilStuff();
		
		//*********************
		//*Grand-Mastery Perks*
		//*********************
		A_PSI1DoEffectMasterPerkCheck();
		
		//*********************
		//*HP & MP Perk Checks*
		//*********************
		A_PSI1DoEffectHPMPPerkCheck();
		
		//****************************
		//*Check EXP Kill Combo Timer*
		//****************************
		A_PSI1DoEffectEXPComboTimer();
		
		//****************************************
		//*Get Health Ratio & Health Level Checks*
		//****************************************
		A_PSI1DoEffectHealthRatios();
		
		//********************
		//*Skill Level Checks*
		//********************
		A_PSI1DoEffectSkillChecker();
		
		//**********************
		//**RadiusDamageFactor**
		//**********************
		A_PSI1DoEffectRadDmgFactor();
		
		//*************
		//**Mass Calc**
		//*************
		A_PSI1DoEffectMassCalc();
		
		//**************
		//**JumpZ Calc**
		//**************
		A_PSI1DoEffectJumpCalc();
		
		//**********************
		//**Survival Rate Calc**
		//**********************
		A_PSI1DoEffectSurviveCalc();
		
		//*******************
		//*RUINOUS SHIELD D:*
		//*******************
		A_PSI1DoEffectUncurseShield();
		
		//******************
		//*Hellcore Checker*
		//******************
		A_PSI1DoEffectHellcoreChecker();
		
		//******************************************************
		//*Hellcore Cooldown Process [25 tics = 1% of cooldown]*
		//******************************************************
		A_PSI1DoEffectHellcoreCool();
		
		//**************************
		//**Critical Hit Calc/Roll**
		//**************************
		A_PSI1DoEffectCritCalc();
		
		//*********************************
		//*Check Sauron Equipment Directly*
		//*********************************
		A_PSI1DoEffectSauronEquipCheck();
		
		//***********************
		//*Infinite Ammo Chances*
		//***********************
		A_PSI1DoEffectInfAmmo();
		
		//****************************************
		//**IronFeet/Mask Implementation Effects**
		//****************************************
		A_PSI1DoEffectIronFeet();
		
		//***********
		//**Evasion**
		//***********
		A_PSI1DoEffectEvasionStuff();
		
		//*********************
		//*Check Tension Level*
		//*********************
		A_PSI1DoEffectTensionStuff();
		
		//*********************
		//*Check Tension Auras*
		//*********************
		A_PSI1DoEffectTensionAuras();
		
		//*************************************
		//*Blacken Screen if Blinded or Asleep*
		//*************************************
		if (playeractor)
		{
			if (BlindTimer > 0) owner.A_SetBlend("00 00 00", 0.975, 25); // Constant Run
			if (SleepTimer > 0) owner.A_SetBlend("00 00 00", 0.9875, 25); // Constant Run
		}
		
		//***********************
		//* Check Armor Amounts *
		//***********************
		if (playeractor)
		{
			let playerarmor = BasicArmor(Owner.FindInventory("BasicArmor"));
			if (playerarmor != null)
			{
				if (dvdsdebug_armorbonusdisplays) 
				{
					Console.Printf("ArmorType: %s", playerarmor.ArmorType);
					if (playerarmor.ArmorType != 'None')
					{
						Console.Printf("SavePercent: %6f", (playerarmor.SavePercent*100));
						Console.Printf("Amount / MaxAmount: %d / %d", playerarmor.Amount, playerarmor.MaxAmount);
						if (playerarmor.bonuscount != 0) Console.Printf("BonusCount: %d", playerarmor.BonusCount);
						if (playerarmor.MaxAbsorb != 0) Console.Printf("MaxAbsorb: %d", playerarmor.MaxAbsorb);
						if (playerarmor.MaxFullAbsorb != 0) Console.Printf("MaxFullAbsorb: %d", playerarmor.MaxFullAbsorb);
						if (playerarmor.AbsorbCount != 0) Console.Printf("AbsorbCount: %d", playerarmor.AbsorbCount);
					}
				}
			}
		}
		
		//*******************
		//*Whistle Countdown*
		//*******************
		if (playeractor && PlayerCurrentHealth > 0 && CallACS("MiscVarCheckDECORATE",168) > 0) CallACS("MiscVarSetDECORATE",168,-1,1);
		
		//**************************************************************************************************************
		//*DQ-Style Seed System [DROPPED Versions only, naturally added Seeds/etc do not get despawned via this system]*
		//**************************************************************************************************************
		A_PSI1DoEffectSeedChecks();
		
		//**************************
		//*Character Checks Misc #1*
		//**************************
		A_PSI1DoEffectCharacterChecks();
		
		//****************
		//**Stamina Calc**
		//****************
		A_PSI1DoEffectStaminaCalc();
		
		//*************************
		//*All Regen/Degen Effects*
		//*************************
		A_PSI1DoEffectRegenDegenEffects();
		
		//*********************
		//*Check Aerial Damage*
		//*********************
		A_PSI1DoEffectLandDamage();
		
		//**************************************
		//***Inventory/Ammo Limit Enforcement***
		//**************************************
		A_PSI1DoEffectInvAmmoLimits();
		
		//****************************
		//** EXP Table Calculations **
		//****************************
		A_PSI1DoEffectEXPTables();
		
		//*******************
		//** LEVEL UP CODE **
		//*******************
		A_PSI1DoEffectLevelUp();
		
		//*******************************************
		// Gets Values for Accquired Kills & Secrets*
		//*******************************************
		A_PSI1DoEffectCountKSI();
		
		//************************************************
		//*Marine's Armor Checks (for color translations)*
		//************************************************
		A_PSI1DoEffectArmorChecks();
		
		//***********************
		//***Vimstone Quickuse***
		//***********************
		A_PSI1DoEffectQuickuseVimstone();
		
		//******************
		//***Unspec Perks***
		//******************
		A_PSI1DoEffectUnspecPerks();
		
		//******************
		//***Dash Control***
		//******************
		A_PSI1DoEffectDashControl();
		
		//************************
		//***In-Game Menu Debug***
		//************************
		A_PSI1DoEffectInGameMenuDebug();
		
		//***********************
		//***Rapid-Cast Delays***
		//***********************
		A_PSIDoEffectRapidCastDelay();
		
		//**************************************
		//***Affects Powerup Timer Countdowns***
		//**************************************
		A_PSI1DoEffectBuffTimerCountdown();
		
		// Final Stuff
		owner.Stamina = MaxHealthTrue - owner.SpawnHealth();
		double StaminaRatioFull = CurrentStamina;
		StaminaRatioFull /= MaximumStamina;
		StaminaRatioFull *= 10000;
		int StaminaRatioTrue = StaminaRatioFull;
		//Console.Printf("StaminaRatioFull: %4f, StaminaRatioTrue: %d", StaminaRatioFull, StaminaRatioTrue);
		CallACS("MiscVarSetDECORATE",8,StaminaRatioTrue);
		
		//
		A_PSI1DoEffectHealValueCheck();
		
		//
		A_PSI1DoEffectSpellCostCheck();
		
		//
		A_PSI1DoEffectFinalCalls();
		
		//
		CallACS("MiscVarSetDECORATE",300,HellWarriorShieldLevel);
		
		// Class Check is done six times for randomization purposes.
		if (ClassCheck < 6) CallACS("OtherVarSetDECORATE",4,1,1);
		
		super.DoEffect();
	}
	
	void EndStuff()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
	}
	
	void DVDSPreInitStuff()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			DeathRageTimer = playeractor.DeathRageTimer;
			DeathRageMaxTimer = playeractor.DeathRageMaxTimer;
			DeathRageTimerCooldown = playeractor.DeathRageTimerCooldown;
		}
		HPRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",92);
		MPRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",93);
		StamRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",94);
		HLCRCoolBonPenTimer = CallACS("MiscVarCheckDECORATE",95);

		HPRegenBonPenMulti = frandompick[statitem](4.0,4.25,4.5,4.75,5.0);
		MPRegenBonPenMulti = frandompick[statitem](4.0,4.25,4.5,4.75,5.0);
		StamRegenBonPenMulti = frandompick[statitem](4.0,4.25,4.5,4.75,5.0);
		HLCRCoolBonPenMulti = frandompick[statitem](4.0,4.25,4.5,4.75,5.0);

		CharacterClass = CallACS("CheckCharacterClass");
		TensionLevel = CallACS("MiscVarCheckDECORATE",181);
		TensionSpeedRatio = dvds_tensionspeed;
		PlayerLevel = CallACS("StatCheck",0);
		MaxHealthTrue = CallACS("StatCheck",1);
		MaxHealthLimit = MaxHealthTrue * 2;
		MaxMana = CallACS("StatCheck",2);
		PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25);
		PlayerAGL = CallACS("MiscVarCheckDECORATE",31);
		PlayerDEF = CallACS("MiscVarCheckDECORATE",32);
		PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
		PlayerSOR = CallACS("MiscVarCheckDECORATE",34);
		PlayerSTR = CallACS("MiscVarCheckDECORATE",35);
		PlayerTHE = CallACS("MiscVarCheckDECORATE",36);
		PlayerJUMP = CallACS("MiscVarCheckDECORATE",200);
		CurrentStamina = CallACS("MiscVarCheckDECORATE",21);
		MaximumStamina = CallACS("MiscVarCheckDECORATE",22);
		MegaMaxStamina = CallACS("MiscVarCheckDECORATE",164);
		CurrentMana = CallACS("StatCheck",14);
		PlayerCurrentHealth = owner.health;
		IsFocusOn = CallACS("MiscVarCheckDECORATE",212);
		FocusTimer = CallACS("MiscVarCheckDECORATE",231);

		BaseStamPenalty = 35 * random[statitem](8,12);
		CallACS("MiscVarSetDECORATE",46,BaseStamPenalty);

		ClassCheck = CallACS("OtherVarCheckDECORATE",4);
		CurrentArmorClass = CallACS("OtherVarCheckDECORATE",5);
		HellcoreOverheatLevel = CallACS("OtherVarCheckDECORATE",6);
		ClassicDoomType = CallACS("OtherVarCheckDECORATE",7);
		ModType = CallACS("OtherVarCheckDECORATE",8);
		TrueGameSkill = dvds_gendifficultycurve + Skill;

		BasePerkFactor = 0;
		PerkFactor = 0;
		TotalMass = 100;
		previousdelaycount = 0;

		minigunheat = Owner.CountInv("MinigunHeat");
		minigunheatmax = 100;
		
		// Perks
		perks3mastered;
		LifeUpPerkLvl = CallACS("MiscVarCheckDECORATE",10001);
		LifeUpExPerkLvl = CallACS("MiscVarCheckDECORATE",10002);
		MagiUpPerkLevel = CallACS("MiscVarCheckDECORATE",10003);
		MagiUpEXPerkLevel = CallACS("MiscVarCheckDECORATE",10004);
		StamUpPerkLvl = CallACS("MiscVarCheckDECORATE",10005);
		StamUpEXPerkLvl = CallACS("MiscVarCheckDECORATE",10006);
		DodgeMorePerkLvl = CallACS("MiscVarCheckDECORATE",10007);
		DodgeMoreEXPerkLvl = CallACS("MiscVarCheckDECORATE",10008);
		JmpMorePerkLvl = CallACS("MiscVarCheckDECORATE",10009);
		JmpMoreEXPerkLvl = CallACS("MiscVarCheckDECORATE",10010);
		PsychFstPerkLvl = CallACS("MiscVarCheckDECORATE",10011);
		PsychFstEXPerkLvl = CallACS("MiscVarCheckDECORATE",10012);
		RegHPFstPerkLvl = CallACS("MiscVarCheckDECORATE",10013);
		RegHPFstEXPerkLvl = CallACS("MiscVarCheckDECORATE",10014);
		RegMPFstPerkLvl = CallACS("MiscVarCheckDECORATE",10015);
		RegMPFstEXPerkLvl = CallACS("MiscVarCheckDECORATE",10016);
		RegStamFastLvl = CallACS("MiscVarCheckDECORATE",10017);
		RegStamFastEXLvl = CallACS("MiscVarCheckDECORATE",10018);
		BulletAccPerkLvl = CallACS("MiscVarCheckDECORATE",10019);
		BulletAccEXPerkLvl = CallACS("MiscVarCheckDECORATE",10020);
		//
		DemolitionsExpertPerkLevel = CallACS("MiscVarCheckDECORATE",10025);
		DemolitionsExpertEXPerkLevel = CallACS("MiscVarCheckDECORATE",10026);
		//
		ArcheryMasteryPerkLevel = CallACS("MiscVarCheckDECORATE",10031);
		ArcheryMasteryEXPerkLevel = CallACS("MiscVarCheckDECORATE",10032);
		SoulMasteryPerkLevel = CallACS("MiscVarCheckDECORATE",10033);
		SoulMasteryEXPerkLevel = CallACS("MiscVarCheckDECORATE",10034);
		MartialArtsMastery = CallACS("MiscVarCheckDECORATE",10035);
		MartialArtsMasteryEX = CallACS("MiscVarCheckDECORATE",10036);
		
		//
		DeathRagePerkLvl = CallACS("MiscVarCheckDECORATE",10043);
		DeathRageEXPerkLvl = CallACS("MiscVarCheckDECORATE",10044);
		OTMPerkLvl = CallACS("MiscVarCheckDECORATE",10045);
		OTMEXPerkLvl = CallACS("MiscVarCheckDECORATE",10046);
		//
		BerserkerFit = CallACS("MiscVarCheckDECORATE",10051);
		BerserkerFitEX = CallACS("MiscVarCheckDECORATE",10052);
		WandMasteryPerkLevel = CallACS("MiscVarCheckDECORATE",10053);
		WandMasteryEXPerkLevel = CallACS("MiscVarCheckDECORATE",10054);
		ClearMindPerkLvl = CallACS("MiscVarCheckDECORATE",10055);
		ClearMindEXPerkLvl = CallACS("MiscVarCheckDECORATE",10056);
		
		// Strife
		StrifeStamLvl = CallACS("MiscVarCheckDECORATE",317);
		StrifeAccuLvl = CallACS("MiscVarCheckDECORATE",318);
		
		// Menu Checks
		UsingInGameMenu = CallACS("MenuVarCheckDECORATE",0);

		DashTimer = CallACS("MiscVarCheckDECORATE",166);
		SceptreShieldLevel = CallACS("MiscVarCheckDECORATE",397);
		IfDivAvCast = CallACS("MiscVarCheckDECORATE",14);

		// Buff Checks
		NVLightTimer = CallACS("GetBuffTimer",0);
		InvisibilityTimer = CallACS("GetBuffTimer",1);
		FlightTimer = CallACS("GetBuffTimer",2);
		StealthTimer = CallACS("GetBuffTimer",3);
		InvulnerabilityTimer = CallACS("GetBuffTimer",4);
		TimeFreezeTimer = CallACS("GetBuffTimer",5);
		FearAuraTimer = CallACS("GetBuffTimer",6);
		DivineAvatarTimer = CallACS("GetBuffTimer",7);
		SpreadAura1Timer = CallACS("GetBuffTimer",8);
		SpreadAura2Timer = CallACS("GetBuffTimer",9);
		DQOomphTimer = CallACS("GetBuffTimer",10);
		DQBuffTimer = CallACS("GetBuffTimer",11);
		DQAcceleratleTimer = CallACS("GetBuffTimer",12);
		DQBluntTimer = CallACS("GetBuffTimer",13);
		DQSapTimer = CallACS("GetBuffTimer",14);
		DQDeceleratleTimer = CallACS("GetBuffTimer",15);
		PoisonedTimer = CallACS("GetBuffTimer",16);
		CorrosionTimer = CallACS("GetBuffTimer",17);
		FatigueTimer = CallACS("GetBuffTimer",18);
		BlindTimer = CallACS("GetBuffTimer",19);
		SleepTimer = CallACS("GetBuffTimer",20);
		SilenceTimer = CallACS("GetBuffTimer",21);
		RadSuitTimer = CallACS("GetBuffTimer",22);
		BerserkTimer = CallACS("GetBuffTimer",23);
		RegenerationTimer = CallACS("GetBuffTimer",24);
		GoETimer = CallACS("GetBuffTimer",129);
		
		HellWarriorShieldLevel = owner.CountInv("HellWarriorShieldLevel");
		
		// In-Game Menu Interval Delays
		CallACS("MiscVarSetDECORATE",445,4);
		CallACS("MiscVarSetDECORATE",446,12);
		CallACS("MiscVarSetDECORATE",447,8);
	}
	
	void DVDSInitStuff()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			ownername = owner.GetClassName();
			if (dvds_showdamagemessageactortags) ownername = owner.GetTag("");

			if (level.totaltime == 0 || (level.time % 2100) == 0) A_PSI1DoEffectSetSpellCostBase(); // initializes the Spell Cost Tables at the start of a new game, once each time you start a map, or every 30 minutes into a single map

			if (level.totaltime == 0 || (level.time % 210) == 0)
			{
				if (!owner.CountInv("DamageTracker")) 
				{
					owner.SetInventory("DamageTracker",1);
					if (dvdsdebug_damnumdisplays) Console.Printf("\cy - %s [PlayPawn]", owner.GetClassName());
				}
				else
				{
					if (owner.CountInv("DamageTracker") > 1) 
					{
						owner.TakeInventory("DamageTracker",1);
						if (dvdsdebug_damnumdisplays) Console.Printf("Extra DamageTracker Removed");
					}
				}
			}

			if (ClassCheck == 0) // Will run the check only once at the beginning of a new game
			{
				CallACS("MiscVarSetDECORATE",2000,1); // 
			}
			if (ClassCheck == 1) // Will run the check only once at the beginning of a new game
			{
				// Hacky Way to assume the player has some trace of all ammo items in their inventory listing [so it can be counted on the stats screen before getting ammo proper]
				pm = "DiarisArrow"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "PoisonNeedleAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "Clip"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "Shell"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "RocketAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "Cell"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "GoldWandAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "CrossbowAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "BlasterAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "PhoenixRodAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "SkullRodAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "MaceAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "ElectricBolts"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "PoisonBolts"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "ClipOfBullets"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "MiniMissiles"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "EnergyPod"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "HEGrenadeRounds"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "PhosphorusGrenadeRounds"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "RifleAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "PopcornPiece"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "GoreBalloons"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "CGrenadeAmmo"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "ClownSouls"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }
				pm = "CZBall"; iDTech1Check = pm; if (CountInv(iDTech1Check) <= 0) { owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1); }

				owner.A_GiveInventory("GreaterVimstone",1);  owner.A_TakeInventory("GreaterVimstone",1);
				owner.A_GiveInventory("LesserVimstone",1);  owner.A_TakeInventory("LesserVimstone",1);
				owner.A_GiveInventory("MonsterMunchies",1);  owner.A_TakeInventory("MonsterMunchies",1);
				owner.A_GiveInventory("MercuryBandana",1);  owner.A_TakeInventory("MercuryBandana",1);
				owner.A_GiveInventory("PaxaPunch",1);  owner.A_TakeInventory("PaxaPunch",1);
				owner.A_GiveInventory("RockbombShard",1);  owner.A_TakeInventory("RockbombShard",1);
				owner.A_GiveInventory("YggdrasilDew",1);  owner.A_TakeInventory("YggdrasilDew",1);
				owner.A_GiveInventory("MiraclePotion",1);  owner.A_TakeInventory("MiraclePotion",1);
				owner.A_GiveInventory("ElfinElixir",1);  owner.A_TakeInventory("ElfinElixir",1);
				owner.A_GiveInventory("SageElixir",1);  owner.A_TakeInventory("SageElixir",1);
				owner.A_GiveInventory("MagicWater",1);  owner.A_TakeInventory("MagicWater",1);
				owner.A_GiveInventory("SpecialMedicine",1);  owner.A_TakeInventory("SpecialMedicine",1);
				owner.A_GiveInventory("StrongMedicine",1);  owner.A_TakeInventory("StrongMedicine",1);
				owner.A_GiveInventory("MedicinalHerb",1);  owner.A_TakeInventory("MedicinalHerb",1);
				if (ClassicDoomType == 2) // Heretic
				{
					pm = "ArtiInvulnerabilityNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiInvisibilityNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiEggNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiTeleportNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiSuperHealthNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiHealthNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
				}
				if (ClassicDoomType == 3) // Hexen
				{
					pm = "ArtiInvulnerability2New"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiPorkNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiDarkServantNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiTeleportOtherNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiTeleportNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiBoostManaNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiSuperHealthNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiHealingRadiusNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ArtiHealthNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
				}
				if (ClassicDoomType == 4) // Strife
				{
					pm = "DegninOreNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "TeleporterBeaconNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ShadowArmorNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "EnvironmentalSuitNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "TargeterNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "ScannerNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "SurgeryKitNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "MedicalKitNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					pm = "MedPatchNew"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);

					pm = "Coin"; iDTech1Check = pm; owner.A_GiveInventory(iDTech1Check,1);  owner.A_TakeInventory(iDTech1Check,1);
					if (TrueGameSkill <= SKILL_VERY_EASY) owner.A_GiveInventory(iDTech1Check,random[statitem](175,225));
					if (TrueGameSkill == SKILL_EASY) owner.A_GiveInventory(iDTech1Check,random[statitem](150,200));
					if (TrueGameSkill == SKILL_NORMAL) owner.A_GiveInventory(iDTech1Check,random[statitem](125,175));
					if (TrueGameSkill == SKILL_HARD) owner.A_GiveInventory(iDTech1Check,random[statitem](100,150));
					if (TrueGameSkill == SKILL_VERY_HARD) owner.A_GiveInventory(iDTech1Check,random[statitem](50,100));
					if (TrueGameSkill == SKILL_EXTREME) owner.A_GiveInventory(iDTech1Check,random[statitem](40,80));
					if (TrueGameSkill == SKILL_HORRIBLE) owner.A_GiveInventory(iDTech1Check,random[statitem](30,60));
					if (TrueGameSkill == SKILL_IMPOSSIBLE) owner.A_GiveInventory(iDTech1Check,random[statitem](20,40));
					if (TrueGameSkill >= SKILL_OMEGA) owner.A_GiveInventory(iDTech1Check,random[statitem](10,20));
				}
				
				// Checks initial actorname of the player's PlayerPawn actor in order to assess the right class #. If you want to try to define extra characters, make sure you use the character's Player-class name.
				if (playeractor.GetClassName() == "DeggarisMontegger") CharacterClass = 0;
				else if (playeractor.GetClassName() == "IlluciaHendershot") CharacterClass = 1;
				else if (playeractor.GetClassName() == "FloraBriscoletti") CharacterClass = 2;
				else if (playeractor.GetClassName() == "Corvus") CharacterClass = 3;
				else if (playeractor.GetClassName() == "Baratus") CharacterClass = 4;
				else if (playeractor.GetClassName() == "Parias") CharacterClass = 5;
				else if (playeractor.GetClassName() == "Daedolon") CharacterClass = 6;
				else if (playeractor.GetClassName() == "StrifeGuy") CharacterClass = 7;
				else if (playeractor.GetClassName() == "AilishEstdale") CharacterClass = 8;
				else if (playeractor.GetClassName() == "PetraLagerkvist") CharacterClass = 9;
				else { CharacterClass = -1; MaxHealthTrue = 100; }
				if (dvdsdebug_initdisplays) Console.Printf("Class Init: %s, %d", playeractor.GetClassName(), CharacterClass);
				CallACS("CheckCharacterClass",1,CharacterClass); // Sets CharacterClass directly
				/* Class IDs
				0 = Deggaris Montegger [Aetherius (Secondary Class)] / Doomguy [Doom]
				1 = Illucia Hendershot [Aetherius (Secondary Class)]
				2 = Flora Briscoletti [Aetherius (Main Class)]
				3 = Corvus [Heretic]
				4 = Baratus [Hexen]
				5 = Parias [Hexen]
				6 = Daedolon [Hexen]
				7 = Strife Mercenary/Strifeguy [Strife]
				8 = Ailish Estdale [Aetherius (Expansion Pack)]
				9 = Petra Johanna Lagerkvist [Aetherius (Expansion Pack)]
				10 = Dinah Wyck [Explosive Expedition/Dynamite Duchess (Main Class)]
				11 = Delila Dorsey [Explosive Expedition/Dynamite Duchess (Secondary Class)]
				12 = Frieda Fairchild [Explosive Expedition/Dynamite Duchess (Secondary Class)]
				13 = Haig Holbrooke [Explosive Expedition/Dynamite Duchess (Secondary Class)]
				15 = ??????? ????? [Kampoulchhr (Main Class)]
				*/
				
				// Initial Stat Calculations
				if (CharacterClass == 0) // Deggaris
				{
					// HP Range // 95-137 HP [103 Base]
					MaxHealthTrue = 103; 
					MaxHealthTrue += random[statitem](-4,12); // 99-115
					MaxHealthTrue *= frandom[statitem](0.9,1.1); // 89-127
					MaxHealthTrue += random[statitem](6,10); // 95-137

					// MP Range // 2-36 MP [20 Base]
					MaxMana = 20;
					MaxMana += random[statitem](-18,8); // 2-28
					MaxMana *= frandom[statitem](1.08,1.16); // 2-32
					MaxMana += random[statitem](0,4); // 2-36
					
					// Mortal Hit Survivability Rate [x.x% format] (Deggaris is the second lowest ranking in Base Survivability)
					MortalHitSurviveRate = 32 + random[statitem](-16,16); // [1.6%-4.8%]

					// Seed Stat Randomization
					AGL = randompick[statitem](1,2,2,2,3); // Agility [31]
					DEF = randompick[statitem](4,5,5,5,6); // Defense [32]
					DFT = randompick[statitem](2,3,3,3,4); // Deftness [33]
					SOR = randompick[statitem](1,2,2,2,3); // Sorcery [34]
					STR = randompick[statitem](5,6,6,6,7); // Strength [35]
					THE = randompick[statitem](2,3,3,3,4); // Therapeusis [36]

					// Mod Type Checks
					if (ModType == 0) // Classic Mode
					{
						if (dvds_marinesstartweapons == 0)
						{
							owner.A_SetInventory("FistDeggaris",1);
							owner.A_SelectWeapon("FistDeggaris");
							owner.A_SetInventory("Pistol2",0);
							owner.A_SetInventory("Clip",0);
							owner.A_SetInventory("DualPistols",0);
							owner.A_SetInventory("Shotgun2",0);
							owner.A_SetInventory("Shell",0);
							owner.A_SetInventory("RocketAmmo",0);
							owner.A_SetInventory("Cell",0);
						}
						if (dvds_marinesstartweapons == 1)
						{
							owner.A_SelectWeapon("Pistol2");
							owner.A_SetInventory("DualPistols",0);
							owner.A_SetInventory("Shotgun2",0);
							owner.A_SetInventory("Shell",0);
							owner.A_SetInventory("RocketAmmo",0);
							owner.A_SetInventory("Cell",0);
						}
						if (dvds_marinesstartweapons == 2)
						{
							owner.A_SelectWeapon("DualPistols");
						}
					}
				}
				if (CharacterClass == 1) // Illucia
				{
					// HP Range // 69-105 HP [81 Base]
					MaxHealthTrue = 81;
					MaxHealthTrue += random[statitem](-8,8); // 73-89
					MaxHealthTrue *= frandom[statitem](0.9,1.1); // 66-98
					MaxHealthTrue += random[statitem](3,7); // 69-105
					
					// MP Range // 19-65 MP [26 Base]
					MaxMana = 26;
					MaxMana += random[statitem](-13,13); // 13-39
					MaxMana *= frandom[statitem](1.16,1.32); // 16-58
					MaxMana += random[statitem](3,7); // 19-65
					
					// Mortal Hit Survivability Rate [x.x% format] (Illucia is the second highest ranking in Base Survivability)
					MortalHitSurviveRate = 48 + random[statitem](-24,24); // [2.4%-7.2%]

					// Seed Stat Randomization
					AGL = randompick[statitem](3,4,4,4,5); // Agility [31]
					DEF = randompick[statitem](2,3,3,3,4); // Defense [32]
					DFT = randompick[statitem](2,3,3,3,4); // Deftness [33]
					SOR = randompick[statitem](3,4,4,4,5); // Sorcery [34]
					STR = randompick[statitem](3,4,4,4,5); // Strength [35]
					THE = randompick[statitem](2,3,3,3,4); // Therapeusis [36]

					// Mod Type Checks
					if (ModType == 0) // Classic Mode
					{
						if (dvds_marinesstartweapons == 0)
						{
							owner.A_SetInventory("FistIllucia",1);
							owner.A_SelectWeapon("FistIllucia");
							owner.A_SetInventory("Pistol2",0);
							owner.A_SetInventory("Clip",0);
							owner.A_SetInventory("Shell",0);
							owner.A_SetInventory("Shotgun2",0);
							owner.A_SetInventory("RocketAmmo",0);
							owner.A_SetInventory("PlasmaRifle2",0);
							owner.A_SetInventory("Cell",0);
						}
						if (dvds_marinesstartweapons == 1)
						{
							owner.A_SelectWeapon("Pistol2");
							owner.A_SetInventory("Shell",0);
							owner.A_SetInventory("Shotgun2",0);
							owner.A_SetInventory("RocketAmmo",0);
							owner.A_SetInventory("PlasmaRifle2",0);
							owner.A_SetInventory("Cell",0);
						}
						if (dvds_marinesstartweapons == 2)
						{
							owner.A_SelectWeapon("Shotgun2");
						}
					}
				}
				//
				// 3526346345635235425@TYY - Start
				// Deggaris and Illucia get the same randomizations to stats and armor type setups
				if (CharacterClass == 0 || CharacterClass == 1)
				{
					int ArmorAmt;
					if (TrueGameSkill <= SKILL_VERY_EASY) // 33-57
					{
						CallACS("OtherVarSetDECORATE",9,200); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,2); // CurrentArmorClass
						owner.A_SetInventory("DSBlueArmorClass", 1);
						ArmorAmt = 200;
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSBlue", 1);
					}
					if (TrueGameSkill == SKILL_EASY) // 21-45
					{
						CallACS("OtherVarSetDECORATE",9,200); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,2); // CurrentArmorClass
						owner.A_SetInventory("DSBlueArmorClass", 1);
						ArmorAmt = 150; 
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSBlue", 1);
					}
					if (TrueGameSkill == SKILL_NORMAL) // 15-45
					{
						if (random[statitem](0,1) == 0)
						{
							CallACS("OtherVarSetDECORATE",9,200); // CurrentMaxArmor
							CallACS("OtherVarSetDECORATE",5,2); // CurrentArmorClass
							owner.A_SetInventory("DSBlueArmorClass", 1);
							ArmorAmt = 100;
							for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSBlue", 1);
						}
						else
						{
							CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
							CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
							owner.A_SetInventory("DSGreenArmorClass", 1);
							ArmorAmt = 100; 
							for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
						}
					}
					if (TrueGameSkill == SKILL_HARD) // 15-39
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 50;
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					if (TrueGameSkill == SKILL_VERY_HARD) // 9-33
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 25; 
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					if (TrueGameSkill == SKILL_EXTREME) // 9-33
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 20;
						for(int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					if (TrueGameSkill == SKILL_HORRIBLE) // 9-33
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 15;
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					if (TrueGameSkill == SKILL_IMPOSSIBLE) // 9-33
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 10;
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					if (TrueGameSkill >= SKILL_OMEGA) // 9-33
					{
						CallACS("OtherVarSetDECORATE",9,100); // CurrentMaxArmor
						CallACS("OtherVarSetDECORATE",5,1); // CurrentArmorClass
						owner.A_SetInventory("DSGreenArmorClass", 1);
						ArmorAmt = 5;
						for (int i = 0; i < ArmorAmt; i++) owner.A_GiveInventory("ArmorBonusDSGreen", 1);
					}
					CurrentMaxArmor = CallACS("OtherVarCheckDECORATE",9); // Refresh Max Armor amt
					CurrentArmorClass = CallACS("OtherVarCheckDECORATE",5); // Refresh Current Armor amt
					if (dvdsdebug_armortrackdisplays) Console.Printf("---> CurrentArmorClass: %d, CurrentMaxArmor: %d", CurrentArmorClass, CurrentMaxArmor);
				}
				if (CharacterClass == 2) // Flora
				{
					// HP Range // 55-89 HP [73 Base]
					MaxHealthTrue = 73;
					MaxHealthTrue += random[statitem](-12,4); // 61-77
					MaxHealthTrue *= frandom[statitem](0.9,1.1); // 55-85
					MaxHealthTrue += random[statitem](0,4); // 55-89
					
					// MP Range // 42-97 MP [35 Base]
					MaxMana = 35;
					MaxMana += random[statitem](-8,18); // 27-53
					MaxMana *= frandom[statitem](1.24,1.48); // 36-87
					MaxMana += random[statitem](6,10); // 42-97
					
					// Mortal Hit Survivability Rate [x.x% format] (Flora is the middle ranking in Base Survivability)
					MortalHitSurviveRate = 40 + random[statitem](-20,20); // [2.0%-6.0%]
					
					// Seed Stat Randomization
					AGL = randompick[statitem](5,6,6,6,7); // Agility [31]
					DEF = randompick[statitem](1,2,2,2,3); // Defense [32]
					DFT = randompick[statitem](4,5,5,5,6); // Deftness [33]
					SOR = randompick[statitem](4,5,5,5,6); // Sorcery [34]
					STR = randompick[statitem](1,2,2,2,3); // Strength [35]
					THE = randompick[statitem](3,4,4,4,5); // Therapeusis [36]
					BaseSceptreEXP = 312;
					
					// Ensures Flora will not start off with armor. :P
					CallACS("OtherVarSetDECORATE",9,0); // CurrentMaxArmor
					CallACS("OtherVarSetDECORATE",5,0); // CurrentArmorClass
					owner.A_SetInventory("DSNoArmorClass", 1);
					
					SceptreLevelEXP = BaseSceptreEXP * SceptreEXPRatio;
					CallACS("OtherVarSetDECORATE",10,SceptreLevelEXP);
					
					// Mod Type Checks
					if (ModType == 0) // Classic Mode
					{
						if (dvds_florastartpoisonneedle)
						{
							owner.A_SetInventory("PoisonNeedle",1);
							if (dvds_florastartextrapoisonneedles) owner.A_SetInventory("PoisonNeedleAmmo",dvds_florastartextrapoisonneedles);
							if (owner.CountInv("SceptreOfEmpyrea") < 1) owner.A_SelectWeapon("PoisonNeedle");
						}
						if (dvds_florastartsapphirewand)
						{
							owner.A_SetInventory("SapphireWandNew",1);
							if (dvds_florastartsapphirewand > 1) owner.A_SetInventory("DualSapphireWandsNew",1);
						}
						if (dvds_florastartdiarislongbow > 0)
						{
							owner.A_SetInventory("DiarisLongbow",1);
							if (dvds_florastartdiarislongbow == 1) owner.A_SetInventory("DiarisArrow",0);
							if (dvds_florastartdiarislongbow == 2) owner.A_SetInventory("DiarisArrow",3);
							if (dvds_florastartdiarislongbow == 3) owner.A_SetInventory("DiarisArrow",999999);
						}
					
						// Individual Game Checks
						if (ClassicDoomType == 2) // Heretic
						{
							if (dvds_florastartelvenwands >= 1) 
							{
								nm = "GoldWandNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartelvenwands >= 2) 
							{
								nm = "DualGoldWandNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartcrossbows >= 1) 
							{
								nm = "CrossbowNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartcrossbows >= 2) 
							{
								nm = "DualCrossbowNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartscrossbows >= 1) 
							{
								nm = "SuperCrossbowNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartscrossbows >= 2) 
							{
								nm = "DualSuperCrossbowNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartdragonclaws >= 1) 
							{
								nm = "DragonClawNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartdragonclaws >= 2) 
							{
								nm = "DualDragonClawNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastarthellstaves >= 1) 
							{
								nm = "HellStaffNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastarthellstaves >= 2) 
							{
								nm = "DualHellStaffNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartphoenixrods >= 1) 
							{
								nm = "PhoenixRodNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartphoenixrods >= 2) 
							{
								nm = "DualPhoenixRodNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartfiremaces >= 1) 
							{
								nm = "FiremaceNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartfiremaces >= 2) 
							{
								nm = "DualFiremaceNew"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartdsparilstaves >= 1) 
							{
								nm = "DSparilStaff"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
							if (dvds_florastartdsparilstaves >= 2) 
							{
								nm = "DualDSparilStaff"; APPackCheck = nm;
								owner.A_SetInventory(APPackCheck,1);
							}
						}
					}
					
					if (CallACS("DVDSSpecialArrayCheckDECORATE",3) > 0 || Owner.CountInv("PlayingUnloved"))
					{
						owner.A_SetInventory("SceptreOfEmpyrea",0);
						owner.A_SelectWeapon("FistFlora");
					}
					else
					{
						if (dvds_florastartsceptre || ModType != 0)
						{
							owner.A_SetInventory("SceptreOfEmpyrea",1);
							owner.A_SelectWeapon("SceptreOfEmpyrea");
						}
					}
					if (ClassicDoomType == 4)
					{
						owner.A_SetInventory("SceptreOfEmpyrea",0);
						owner.A_SetInventory("PoisonNeedle",1);
						owner.A_SetInventory("PoisonNeedleAmmo",0);
						if (owner.CountInv("SceptreOfEmpyrea") < 1) owner.A_SelectWeapon("PoisonNeedle");
					}
				}
				if (CharacterClass == 8) // Ailish
				{
					// HP Range // 46-77 HP [63 Base]
					MaxHealthTrue = 63;
					MaxHealthTrue += random[statitem](-12,4); // 51-67
					MaxHealthTrue *= frandom[statitem](0.9,1.1); // 46-74
					MaxHealthTrue += random[statitem](0,3); // 46-77
					
					// MP Range // 52-105 MP [43 Base]
					MaxMana = 43;
					MaxMana += random[statitem](-8,18); // 35-61
					MaxMana *= frandom[statitem](1.20,1.40); // 46-95
					MaxMana += random[statitem](6,10); // 52-105
					
					// Mortal Hit Survivability Rate [x.x% format] (Ailish's survivability rate is the lowest of the playables at this point)
					MortalHitSurviveRate = 24 + random[statitem](-12,12); // [1.2%-3.6%]
					
					// Seed Stat Randomization
					AGL = randompick[statitem](5,6,6,6,7); // Agility [31]
					DEF = randompick[statitem](1,2,2,2,3); // Defense [32]
					DFT = randompick[statitem](4,5,5,5,6); // Deftness [33]
					SOR = randompick[statitem](4,5,5,5,6); // Sorcery [34]
					STR = randompick[statitem](1,2,2,2,3); // Strength [35]
					THE = randompick[statitem](3,4,4,4,5); // Therapeusis [36]
					
					// Ensures Ailish will not start off with armor. :P
					CallACS("OtherVarSetDECORATE",9,0); // CurrentMaxArmor
					CallACS("OtherVarSetDECORATE",5,0); // CurrentArmorClass
					owner.A_SetInventory("DSNoArmorClass", 1);
				}
				if (CharacterClass == 9) // Petra
				{
					// HP Range // 92-137 HP [102 Base]
					MaxHealthTrue = 102;
					MaxHealthTrue += random[statitem](-4,12); // 98-114
					MaxHealthTrue *= frandom[statitem](0.9,1.1); // 88-125
					MaxHealthTrue += random[statitem](4,12); // 92-137
					
					// MP Range // 17-52 MP [25 Base]
					MaxMana = 25;
					MaxMana += random[statitem](-12,12); // 13-37
					MaxMana *= frandom[statitem](1.12,1.24); // 14-45
					MaxMana += random[statitem](3,7); // 17-52
					
					// Mortal Hit Survivability Rate [x.x% format] (Petra's is the highest of the playables at this point)
					MortalHitSurviveRate = 56 + random[statitem](-28,28); // [2.8%-8.4%]
					
					// Seed Stat Randomization
					AGL = randompick[statitem](3,4,4,4,5); // Agility [31]
					DEF = randompick[statitem](4,5,5,5,6); // Defense [32]
					DFT = randompick[statitem](3,4,4,4,5); // Deftness [33]
					SOR = randompick[statitem](2,3,3,3,4); // Sorcery [34]
					STR = randompick[statitem](4,5,5,5,6); // Strength [35]
					THE = randompick[statitem](1,2,2,2,3); // Therapeusis [36]

					//Like Flora and Ailish, Petra can't use Marine armor.
					CallACS("OtherVarSetDECORATE",9,0); // CurrentMaxArmor
					CallACS("OtherVarSetDECORATE",5,0); // CurrentArmorClass
					owner.A_SetInventory("DSNoArmorClass", 1);
				}
				// 3526346345635235425@TYY - End
				
				if (TrueGameSkill <= SKILL_VERY_EASY) // 33-57
				{
					AGL += random[statitem](3,5); // Agility
					DEF += random[statitem](3,5); // Defense
					DFT += random[statitem](3,5); // Deftness
					SOR += random[statitem](3,5); // Sorcery
					STR += random[statitem](3,5); // Strength
					THE += random[statitem](3,5); // Therapeusis
					BaseSceptreEXP = 240;
				}
				if (TrueGameSkill == SKILL_EASY) // 25-48
				{
					AGL += random[statitem](1,3); // Agility
					DEF += random[statitem](1,3); // Defense
					DFT += random[statitem](1,3); // Deftness
					SOR += random[statitem](1,3); // Sorcery
					STR += random[statitem](1,3); // Strength
					THE += random[statitem](1,3); // Therapeusis
					BaseSceptreEXP = 288;
				}
				if (TrueGameSkill == SKILL_EASY) // 25-48
				{
					AGL += random[statitem](0,3); // Agility
					DEF += random[statitem](0,3); // Defense
					DFT += random[statitem](0,3); // Deftness
					SOR += random[statitem](0,3); // Sorcery
					STR += random[statitem](0,3); // Strength
					THE += random[statitem](0,3); // Therapeusis
					BaseSceptreEXP = 312;
				}
				if (TrueGameSkill == SKILL_NORMAL) // 19-48
				{
					AGL += random[statitem](0,3); // Agility
					DEF += random[statitem](0,3); // Defense
					DFT += random[statitem](0,3); // Deftness
					SOR += random[statitem](0,3); // Sorcery
					STR += random[statitem](0,3); // Strength
					THE += random[statitem](0,3); // Therapeusis
					BaseSceptreEXP = 312;
				}
				if (TrueGameSkill == SKILL_HARD) // 19-42
				{
					AGL += random[statitem](0,2); // Agility
					DEF += random[statitem](0,2); // Defense
					DFT += random[statitem](0,2); // Deftness
					SOR += random[statitem](0,2); // Sorcery
					STR += random[statitem](0,2); // Strength
					THE += random[statitem](0,2); // Therapeusis
					BaseSceptreEXP = 336;
				}
				if (TrueGameSkill == SKILL_VERY_HARD) // 13-36
				{
					AGL += random[statitem](0,1); // Agility
					DEF += random[statitem](0,1); // Defense
					DFT += random[statitem](0,1); // Deftness
					SOR += random[statitem](0,1); // Sorcery
					STR += random[statitem](0,1); // Strength
					THE += random[statitem](0,1); // Therapeusis
					BaseSceptreEXP = 384;
				}
				if (TrueGameSkill == SKILL_EXTREME) // 13-36
				{
					AGL += random[statitem](-1,0); // Agility
					DEF += random[statitem](-1,0); // Defense
					DFT += random[statitem](-1,0); // Deftness
					SOR += random[statitem](-1,0); // Sorcery
					STR += random[statitem](-1,0); // Strength
					THE += random[statitem](-1,0); // Therapeusis
					BaseSceptreEXP = 408;
				}
				if (TrueGameSkill == SKILL_HORRIBLE) // 9-33
				{
					AGL += random[statitem](-2,0); // Agility
					DEF += random[statitem](-2,0); // Defense
					DFT += random[statitem](-2,0); // Deftness
					SOR += random[statitem](-2,0); // Sorcery
					STR += random[statitem](-2,0); // Strength
					THE += random[statitem](-2,0); // Therapeusis
					BaseSceptreEXP = 432;
				}
				if (TrueGameSkill == SKILL_IMPOSSIBLE) // 9-33
				{
					AGL += random[statitem](-2,-1); // Agility
					DEF += random[statitem](-2,-1); // Defense
					DFT += random[statitem](-2,-1); // Deftness
					SOR += random[statitem](-2,-1); // Sorcery
					STR += random[statitem](-2,-1); // Strength
					THE += random[statitem](-2,-1); // Therapeusis
					BaseSceptreEXP = 456;
				}
				if (TrueGameSkill >= SKILL_OMEGA) // 9-33
				{
					AGL += random[statitem](-3,-1); // Agility
					DEF += random[statitem](-3,-1); // Defense
					DFT += random[statitem](-3,-1); // Deftness
					SOR += random[statitem](-3,-1); // Sorcery
					STR += random[statitem](-3,-1); // Strength
					THE += random[statitem](-3,-1); // Therapeusis
					BaseSceptreEXP = 480;
				}
				
				// Final Set for Survival Rate
				CallACS("MiscVarSetDECORATE",0,MortalHitSurviveRate);
				
				// Post Initial Stat Calculations
				AeonPts += dvds_startingaeonpts;
				AeonPts = (AeonPts * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				AGL = (AGL * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				DEF = (DEF * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				DFT = (DFT * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				SOR = (SOR * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				STR = (STR * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				THE = (THE * dvds_startotherstatsfactor) / 100; // Check Start Other Stats Factor
				CallACS("MiscVarSetDECORATE",25,AeonPts);	PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
				CallACS("MiscVarSetDECORATE",31,AGL);			PlayerAGL = CallACS("MiscVarCheckDECORATE",31); // Refreshes Agility
				CallACS("MiscVarSetDECORATE",32,DEF);			PlayerDEF = CallACS("MiscVarCheckDECORATE",32); // Refreshes Defense
				CallACS("MiscVarSetDECORATE",33,DFT);			PlayerDFT = CallACS("MiscVarCheckDECORATE",33); // Refreshes Deftness
				CallACS("MiscVarSetDECORATE",34,SOR);			PlayerSOR = CallACS("MiscVarCheckDECORATE",34); // Refreshes Sorcery
				CallACS("MiscVarSetDECORATE",35,STR);			PlayerSTR = CallACS("MiscVarCheckDECORATE",35); // Refreshes Stregth
				CallACS("MiscVarSetDECORATE",36,THE);			PlayerTHE = CallACS("MiscVarCheckDECORATE",36); // Refreshes Therapeusis

				MaxMana = (MaxMana * dvds_starthpmanafactor) / 100; // Check Start Mana Factor
				if (MaxMana < 1) MaxMana = 1;
				CallACS("OtherVarSetDECORATE",1,MaxMana); // MaxMana
				MaxMana = CallACS("StatCheck",2); // Refresh Var for MaxMP Value
				CallACS("OtherVarSetDECORATE",2,MaxMana); // CurrentMana
				CurrentMana = CallACS("StatCheck",14); // Refreshs Current MP amount
				
				
				if (CharacterClass == 2 || CharacterClass == 8) MaxHealthTrue = floor(MaxHealthTrue * (frandom[statitem](1.20,1.40) - (TrueGameSkill * 0.1))); // Deggaris, Illucia and Petra have an extra randomization to their HP, while Flora and Ailish have a slightly more varied randomization which works more to her favor on easier skill levels.
																									 else MaxHealthTrue = floor(MaxHealthTrue * (frandom[statitem](1.00,1.20) - (TrueGameSkill * 0.05)));

				MaxHealthTrue = floor((MaxHealthTrue * dvds_starthpmanafactor) / 100); // Check Start HP Factor
				if (MaxHealthTrue < 1) MaxHealthTrue = 1;
				owner.player.health = owner.player.mo.health = MaxHealthTrue;
				CallACS("OtherVarSetDECORATE",0,MaxHealthTrue);
				MaxHealthTrue = CallACS("StatCheck",1); // Refresh Var Check for MaxHP
				CallACS("MiscVarSetDECORATE",241,MaxHealthTrue);
				CallACS("MiscVarSetDECORATE",298,MaxHealthTrue); // Set the game's starting Max HP for Sigil damage calculations
				
				if (dvds_startunmaker > 0)
				{
					owner.A_SetInventory("UnmakerDVDS", 1);
					owner.A_SetInventory("UnmakerUpgrades", (dvds_startunmaker-1));
				}
				
				if (dvds_startsigil > 0 && ClassicDoomType != 4)
				{
					int SigilPieces = 0;
					owner.A_SetInventory("Sigil", 1);
					let sigl = owner.FindInventory("Sigil");
					if (sigl != null)
					{
						sigl.health = dvds_startsigil;
						//Console.Printf("Sigil Pieces: %d", sigl.health);
						if (sigl.health == 1) owner.A_SetInventory("SigilPhase1", 1); else owner.A_SetInventory("SigilPhase1",0);
						if (sigl.health == 2) owner.A_SetInventory("SigilPhase2", 1); else owner.A_SetInventory("SigilPhase2",0);
						if (sigl.health == 3) owner.A_SetInventory("SigilPhase3", 1); else owner.A_SetInventory("SigilPhase3",0);
						if (sigl.health == 4) owner.A_SetInventory("SigilPhase4", 1); else owner.A_SetInventory("SigilPhase4",0);
						if (sigl.health == 5) owner.A_SetInventory("SigilComplete", 1); else owner.A_SetInventory("SigilComplete",0);
						SigilPieces = sigl.health;
						owner.A_SetInventory("SigilModeType", SigilPieces);
					}
				}

				if (dvds_starthwshield > -1)
				{
					owner.A_SetInventory("EvilWarriorShield", 1);
					owner.A_SetInventory("HellWarriorShieldLevel", dvds_starthwshield);
					
				}
			}
			if (ClassCheck == 2) { }
			if (ClassCheck == 3) { }
			if (ClassCheck == 4) { }
			if (ClassCheck == 5) { }
			if (ClassCheck < 6)
			{
				if (PlayerAGL < 0) 
				{
					CallACS("MiscVarSetDECORATE",31,0);
					PlayerAGL = CallACS("MiscVarCheckDECORATE",31); // Refreshes Agility
				}
				if (PlayerDEF < 0) 
				{
					CallACS("MiscVarSetDECORATE",32,0);
					PlayerDEF = CallACS("MiscVarCheckDECORATE",32); // Refreshes Defense
				}
				if (PlayerDFT < 0) 
				{
					CallACS("MiscVarSetDECORATE",33,0);
					PlayerDFT = CallACS("MiscVarCheckDECORATE",33); // Refreshes Deftness
				}
				if (PlayerSOR < 0) 
				{
					CallACS("MiscVarSetDECORATE",34,0);
					PlayerSOR = CallACS("MiscVarCheckDECORATE",34); // Refreshes Sorcery
				}
				if (PlayerSTR < 0) 
				{
					CallACS("MiscVarSetDECORATE",35,0);
					PlayerSTR = CallACS("MiscVarCheckDECORATE",35); // Refreshes Stregth
				}
				if (PlayerTHE < 0) 
				{
					CallACS("MiscVarSetDECORATE",36,0);
					PlayerTHE = CallACS("MiscVarCheckDECORATE",36); // Refreshes Therapeusis
				}
				CallACS("MiscVarSetDECORATE",21,MaximumStamina);
				CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
				if (dvdsdebug_initdisplays) Console.Printf("\cxClassCheck:\c- %d", ClassCheck);
			}
			// Mod Type Checks
			if (ClassCheck <= 2)
			{
				owner.A_SetInventory("PlayingDoom2",0);
				owner.A_SetInventory("PlayingDoom1",0);
				owner.A_SetInventory("PlayingHeretic",0);
				owner.A_SetInventory("PlayingHexen",0);
				owner.A_SetInventory("PlayingStrife",0);
				owner.A_SetInventory("PlayingDoom64",0);
				owner.A_SetInventory("PlayingPSXDoom",0);
				owner.A_SetInventory("PlayingDeusVultI",0);
				owner.A_SetInventory("PlayingDeusVultII",0);
				if (ModType == 0) // Classic Mode
				{
					// Individual Game Checks
					if (ClassicDoomType == 0) { owner.A_SetInventory("PlayingDoom2",1); } // Doom 2
					if (ClassicDoomType == 1) { owner.A_SetInventory("PlayingDoom1",1); } // Doom 1
					if (ClassicDoomType == 2) { owner.A_SetInventory("PlayingHeretic",1); } // Heretic
					if (ClassicDoomType == 3) { owner.A_SetInventory("PlayingHexen",1); } // HeXen
					if (ClassicDoomType == 4) { owner.A_SetInventory("PlayingStrife",1); } // Strife
					if (ClassicDoomType == 5) { owner.A_SetInventory("PlayingDoom64",1); } // Doom64
					if (ClassicDoomType == 6) { owner.A_SetInventory("PlayingPSXDoom",1); } // PSXDoom
				}
				else if (ModType == 1) { owner.A_SetInventory("PlayingDeusVultI",1); } // DVI
				else if (ModType == 2) { owner.A_SetInventory("PlayingDeusVultII",1); } // DVII
			}
		}
	}

	void A_PSI1DoEffectHealValueCheck()
	{
		if ((level.totaltime % optimizefactortics) == 0)
		{
			CallACS("MiscVarSetDECORATE",281,F_GetHealingValue(0,0));
			CallACS("MiscVarSetDECORATE",282,F_GetHealingValue(0,1));
			CallACS("MiscVarSetDECORATE",283,F_GetHealingValue(1,0));
			CallACS("MiscVarSetDECORATE",284,F_GetHealingValue(1,1));
			CallACS("MiscVarSetDECORATE",285,F_GetHealingValue(2,0));
			CallACS("MiscVarSetDECORATE",286,F_GetHealingValue(2,1));
			CallACS("MiscVarSetDECORATE",321,F_GetStamHealValue(0,0));
			CallACS("MiscVarSetDECORATE",322,F_GetStamHealValue(0,1));
			CallACS("MiscVarSetDECORATE",323,F_GetStamHealValue(0,2));
			CallACS("MiscVarSetDECORATE",324,F_GetStamHealValue(1,0));
			CallACS("MiscVarSetDECORATE",325,F_GetStamHealValue(1,1));
			CallACS("MiscVarSetDECORATE",326,F_GetStamHealValue(1,2));
			CallACS("MiscVarSetDECORATE",327,F_GetStamHealValue(2,0));
			CallACS("MiscVarSetDECORATE",328,F_GetStamHealValue(2,1));
			CallACS("MiscVarSetDECORATE",329,F_GetStamHealValue(2,2));
		}
	}
	
	void A_PSI1DoEffectSetSpellCostBase()
	{
		CallACS("MiscVarSetDECORATE",275,(35*random[statitem](4,6))); // Base Tics for MP Regen Penalty when casting a spell [for 100% spell cost]
		CallACS("MiscVarSetDECORATE",276,random[statitem](4,5)); // Sets Lowest accumulation for MP Regen Penalty Time from a spell cast

		//Console.Printf("SpellCostsBase");
		SpellCostsBase.Resize(59);
		SpellCostsBase[0] = 1;			// Minor Magic Missile
		SpellCostsBase[1] = 5;			// Minor Healing
		SpellCostsBase[2] = 5;			// Minor Night Vision
		SpellCostsBase[3] = 5;			// Chill Touch
		SpellCostsBase[4] = 15;			// Minor Invisibility
		SpellCostsBase[5] = 10;			// Minor Flight
		SpellCostsBase[6] = 15;			// Minor Poison Cloud
		SpellCostsBase[7] = 10;			// Minor Fireball
		SpellCostsBase[8] = 50;			// Enhanced Strength
		SpellCostsBase[9] = 15;			// Minor Ice Blast
		SpellCostsBase[10] = 50;			// Summon Weak Monster
		SpellCostsBase[11] = 20;			// Magic Missile
		SpellCostsBase[12] = 20;			// Fireball
		SpellCostsBase[13] = 30;			// Explosive Glyph
		SpellCostsBase[14] = 15;			// Healing
		SpellCostsBase[15] = 40;			// Fireball Nova
		SpellCostsBase[16] = 125;		// Attack Booster
		SpellCostsBase[17] = 75;			// Minor Raging Spirits
		SpellCostsBase[18] = 75;			// Invisibility
		SpellCostsBase[19] = 25;			// Acid Rain
		SpellCostsBase[20] = 85;			// Minor Terrorization Aura
		SpellCostsBase[21] = 40;			// Night-Vision
		SpellCostsBase[22] = 75;			// Flight
		SpellCostsBase[23] = 50;			// Major Magic Missile
		SpellCostsBase[24] = 125;		// Summon Monster
		SpellCostsBase[25] = 100;		// Ice Nova
		SpellCostsBase[26] = 75;			// Poison Cloud
		SpellCostsBase[27] = 75;			// Minor Lightning
		SpellCostsBase[28] = 100;		// Stone Skin
		SpellCostsBase[29] = 55;			// Major Healing
		SpellCostsBase[30] = 100;		// Major Night-Vision
		SpellCostsBase[31] = 50;			// Ice Blast
		SpellCostsBase[32] = 150;		// Farsight
		SpellCostsBase[33] = 150;		// Lightning Nova
		SpellCostsBase[34] = 120;		// Minor Time Freeze
		SpellCostsBase[35] = 125;			// Defense Booster
		SpellCostsBase[36] = 150;		// Major Invisibility
		SpellCostsBase[37] = 150;		// Major Flight
		SpellCostsBase[38] = 125;		// Lightning
		SpellCostsBase[39] = 220;		// Summon Strong Monster
		SpellCostsBase[40] = 200;		// Diamond Skin
		SpellCostsBase[41] = 50;			// Major Fireball
		SpellCostsBase[42] = 75;			// Major Ice Blast
		SpellCostsBase[43] = 130;		// Major Poison Cloud
		SpellCostsBase[44] = 175;		// Major Lightning
		SpellCostsBase[45] = 200;		// Invulnerability
		SpellCostsBase[46] = 125;		// Speed Booster
		SpellCostsBase[47] = 150;		// Raging Spirits
		SpellCostsBase[48] = 250;		// Summon Archvile
		SpellCostsBase[49] = 160;		// Ultra Magic Missile
		SpellCostsBase[50] = 325;		// Time Freezer
		SpellCostsBase[51] = 225;		// Terror Aura
		SpellCostsBase[52] = 300;		// Create Lotso Ammo
		SpellCostsBase[53] = 0;			// Divine Avatar [value doesn't matter since it auto-calculates based on max MP]
		SpellCostsBase[54] = 500;		// Summon Cyberdemon
		SpellCostsBase[55] = 1025;		// Spreader Aura Lv. 2
		SpellCostsBase[56] = 80;			// Oomph
		SpellCostsBase[57] = 30;			// Buff
		SpellCostsBase[58] = 80;			// Desperato Damsel
	}

	int F_SpellCostCheck(int SpellIsSelected = 0, int initialcost = 0)
	{
		int FinalSpellCost, LevelSpellCostReductionFactor, LvlSpellCostReducePercent, SecretSplCostReduceBonus, BaseSpellCostReduceBonus, Check1, Check2;
		int OriginalSpellCost; 
		int spellcostdebug = dvdsdebug_showspellcoststuff;
		double DivineAvatarPercentCost;
		
		FinalSpellCost = initialcost;
		if (SpellIsSelected == 53) // Divine Avatar Costs at most ~90% of Mana Supply by Default
		{
			DivineAvatarPercentCost = 80 + (TrueGameSkill * 2.5);
			if (DivineAvatarTimer > 0 && IfDivAvCast > 0) DivineAvatarPercentCost *= 2;
			
			FinalSpellCost = MaxMana * DivineAvatarPercentCost / 100;
		}
		else if (SpellIsSelected == 40 && CharacterClass == 2) FinalSpellCost = 575; // Diamond Skin [Marines] / Spreader Aura Lv. 1 [Flora]
		else if (SpellIsSelected == 15 && CharacterClass == 9) FinalSpellCost = SpellCostsBase[58];	// Fireball Nova [Most] / Desperado Damsel [Petra]

		OriginalSpellCost = FinalSpellCost;
		if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [\c[Gold]Original Base\c-]", SpellIsSelected, FinalSpellCost);
		
		int manacostbaselevelreq = dvds_manacostbaselevelreq;
		// manacostbaselevelreq = Number of Levels needed to be gained before the spell begins to decline in cost at every level up
		if (SpellIsSelected >= 0 && SpellIsSelected <= 1) manacostbaselevelreq += 0; // (Minor Magic Missile / Minor Healing) Level 0
		if (SpellIsSelected >= 2 && SpellIsSelected <= 3) manacostbaselevelreq += 1; // (Minor Night Vision / Chill Touch) Level 1
		if (SpellIsSelected >= 4 && SpellIsSelected <= 5) manacostbaselevelreq += 2; // (Minor Invisibility / Minor Flight) Level 2
		if (SpellIsSelected == 6) manacostbaselevelreq += 3; // (Minor Poison Cloud) Level 3
		if (SpellIsSelected == 7) manacostbaselevelreq += 4; // (Minor Fireball) Level 4
		if (SpellIsSelected == 8) manacostbaselevelreq += 5; // (Enhanced Strength) Level 5
		if (SpellIsSelected == 9) manacostbaselevelreq += 6; // (Minor Ice Blast) Level 6
		if (SpellIsSelected >= 10 && SpellIsSelected <= 11) manacostbaselevelreq += 7; // (Summon Weak Monster / Magic Missile) Level 7
		if (SpellIsSelected == 12) manacostbaselevelreq += 8; // (Fireball) Level 8
		if (SpellIsSelected >= 13 && SpellIsSelected <= 14) manacostbaselevelreq += 9; // (Explosive Glyph / Healing) Level 9
		if (SpellIsSelected == 15) manacostbaselevelreq += 10; // (Fireball Nova) or (Desperado Damsel) [Petra] Level 10
		if (SpellIsSelected >= 16 && SpellIsSelected <= 18) manacostbaselevelreq += 11; // (Attack Booster / Minor Raging Spirits / Invisibility) Level 11
		if (SpellIsSelected >= 19 && SpellIsSelected <= 20) manacostbaselevelreq += 12; // (Acid Rain / Minor Terrorization Aura) Level 12
		if (SpellIsSelected >= 21 && SpellIsSelected <= 22) manacostbaselevelreq += 13; // (Night-Vision / Flight) Level 13
		if (SpellIsSelected == 23) manacostbaselevelreq += 14; // (Major Magic Missile) Level 14
		if (SpellIsSelected == 24) manacostbaselevelreq += 15; // (Summon Monster) Level 15
		if (SpellIsSelected >= 25 && SpellIsSelected <= 26) manacostbaselevelreq += 16; // (Icy Nova / Poison Cloud) Level 16
		if (SpellIsSelected == 27) manacostbaselevelreq += 17; // (Minor Lightning) Level 17
		if (SpellIsSelected >= 28 && SpellIsSelected <= 29) manacostbaselevelreq += 18; // (Stone Skin / Major Healing) Level 18
		if (SpellIsSelected == 30) manacostbaselevelreq += 19; // (Major Night-Vision) Level 19
		if (SpellIsSelected >= 31 && SpellIsSelected <= 33) manacostbaselevelreq += 20; // (Ice Blast / Farsight / Lightning Nova) Level 20
		if (SpellIsSelected >= 34 && SpellIsSelected <= 37) manacostbaselevelreq += 21; // (Minor Time Freezer / Defense Booster / Major Invisibility / Major Flight) Level 21
		if (SpellIsSelected == 38) manacostbaselevelreq += 22; // (Lightning) Level 22
		if (SpellIsSelected == 39) manacostbaselevelreq += 23; // (Summon Strong Monster) Level 23
		if (SpellIsSelected == 40) manacostbaselevelreq += 24; // (Diamond Skin) [Deggaris/Illucia] or (Spreader Aura Lv. 1) [Flora] Level 24
		if (SpellIsSelected >= 41 && SpellIsSelected <= 44) manacostbaselevelreq += 25; // (Major Fireball / Major Ice Blast / Major Poison Cloud / Major Lightning) Level 25
		if (SpellIsSelected >= 45 && SpellIsSelected <= 46) manacostbaselevelreq += 26; // (Invulnerability / Speed Booster) Level 26
		if (SpellIsSelected == 47) manacostbaselevelreq += 27; // (Raging Spirits) Level 27
		if (SpellIsSelected == 48) manacostbaselevelreq += 28; // (Summon Arch-Vile) Level 28
		if (SpellIsSelected == 49) manacostbaselevelreq += 29; // (Ultra Magic Missile) Level 29
		if (SpellIsSelected >= 50 && SpellIsSelected <= 52) manacostbaselevelreq += 30; // (Time Freezer / Terrorization Aura / Create Lotso Ammo) Level 30
		if (SpellIsSelected >= 53 && SpellIsSelected <= 54) manacostbaselevelreq += 31; // (Divine Avatar / Summon Cyberdemon) Level 31
		if (SpellIsSelected == 55) manacostbaselevelreq += 56; // (Spreader Aura Lv. 2) Level 56 [Flora Only]
		
		manacostbaselevelreq *= (1.00 + (TrueGameSkill * 0.25));
		
		// Base Spell Cost Reduction Factor [level-based] 
		LevelSpellCostReductionFactor = PlayerLevel - manacostbaselevelreq;
		LevelSpellCostReductionFactor = clamp(LevelSpellCostReductionFactor, 0, LevelSpellCostReductionFactor);
	
		LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.0667; // This is for any class that is not one of the below otherwise ignore this line
		if (CharacterClass == 0) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.0555; // 5.55% [Deggaris]
		if (CharacterClass == 1) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.0625; // 6.25% [Illucia]
		if (CharacterClass == 2) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.1111; // 11.1% [Flora]
		if (CharacterClass == 8) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.1; // 10% [Ailish]
		if (CharacterClass == 9) LevelSpellCostReductionFactor = LevelSpellCostReductionFactor * 0.0833; // 8.33% [Petra]
		
		LvlSpellCostReducePercent = 100;
		LvlSpellCostReducePercent -= LevelSpellCostReductionFactor;
		FinalSpellCost = ceil(FinalSpellCost * LvlSpellCostReducePercent / 100);
		if (SpellIsSelected != -1 && spellcostdebug && LvlSpellCostReducePercent != 100) Console.Printf("FinalSpellCost (%d): %d MP [LevelCostReduce], LvlSpellCostReducePercent: [%d / 100]", SpellIsSelected, FinalSpellCost, LvlSpellCostReducePercent);
		
		if (SpellIsSelected == 34) // Minor Time Freezer Costs at least 10% of Mana Supply by Default (Deggaris and Illucia Only)
		{
			LevelSpellCostReductionFactor = MaxMana * 0.1;
			FinalSpellCost += LevelSpellCostReductionFactor;
			if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [TimeFreezerCheck]", SpellIsSelected, FinalSpellCost);
		}
		
		if (SpellIsSelected == 50) // Time Freezer Costs at least 25% of Mana Supply by Default (Deggaris and Illucia Only)
		{
			LevelSpellCostReductionFactor = MaxMana * 0.25;
			FinalSpellCost += LevelSpellCostReductionFactor;
			if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [TimeFreezerCheck]", SpellIsSelected, FinalSpellCost);
		}
		
		// Check for having The Ring in you inventory
		if (owner.CountInv("TheOneRing"))
		{
			if (CharacterClass == 2 || CharacterClass == 8) FinalSpellCost = ceil(FinalSpellCost * 0.8125); // 81.25% MP Cost (Flora and Ailish are the only ones who doesn't have their MP Costs increased by the One Ring)
																								 else FinalSpellCost = ceil(FinalSpellCost * 1.25); // 125% MP Cost (Deggaris and Illucia)
			if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [The One Ring]", SpellIsSelected, FinalSpellCost);
		}
		
		int SpellCostMinimum;
		
		if (CharacterClass == 2)
		{
			Check1 = 0; // Check1 is an exact value
			Check2 = 1000; // Check2 is a % value
			if (owner.CountInv("EvenstarNecklace")) { Check1 += 10; Check2 -= 50; } // Evenstar Necklace [MP reduction of 10 + 5%]
			if (owner.CountInv("AnubisCufflinks")) { Check1 += 2; Check2 -= 10; } // Anubis Cufflinks [MP reduction of 2 + 1%]
			if (owner.CountInv("BalrogRing")) { Check1 += 5; Check2 -= 25; } // Balrog's Ring [MP reduction of 5 + 2.5%]
	
			FinalSpellCost -= Check1;
			FinalSpellCost = ceil(FinalSpellCost * Check2 / 1000);
	
			// Ruinous Shield = +50% MP Consumption
			if (owner.CountInv("RuinousShield")) FinalSpellCost = ceil(FinalSpellCost * 1.5);
			if (SpellIsSelected != -1 && spellcostdebug && (Check1 != 0 || Check2 != 1000)) Console.Printf("FinalSpellCost (%d): %d MP [FloraArmors] (-%d & %d)", SpellIsSelected, FinalSpellCost, Check1, Check2);
		}

		int MaxManaDouble = MaxMana * 2;
		if (SpellIsSelected == 53 && DivineAvatarTimer > 0) FinalSpellCost = clamp(FinalSpellCost, FinalSpellCost, MaxManaDouble);
																									 else FinalSpellCost = clamp(FinalSpellCost, FinalSpellCost, MaxMana);

		if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [MaxManaClamp]", SpellIsSelected, FinalSpellCost);
		
		SpellCostMinimum = ceil(OriginalSpellCost * (0.51 + (TrueGameSkill * 0.04))); // (0.42 + (TrueGameSkill * 0.07))
		if (SpellCostMinimum < 1) SpellCostMinimum = 1;
		
		// Clamp Minimum Mana Cost
		if (FinalSpellCost < SpellCostMinimum) FinalSpellCost = SpellCostMinimum;
		if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [CostMinimumClamp]", SpellIsSelected, FinalSpellCost);
		
		double SpellCostMinimum2 = 0.0;
		// Clear of Mind & MagiUp Perks
		if (MagiUpPerkLevel > 0 || ClearMindPerkLvl > 0)
		{
			SpellCostMinimum2 = (MagiUpPerkLevel * 1) + (MagiUpEXPerkLevel * 2) + (ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5);
			if (MagiUpEXPerkLevel >= 2) SpellCostMinimum2 += 1;
			if (ClearMindPerkLvl >= 2) SpellCostMinimum2 += 1;
			if (ClearMindPerkLvl >= 4) SpellCostMinimum2 += 2;
			if (ClearMindEXPerkLvl >= 2) SpellCostMinimum2 += 5;
			SpellCostMinimum2 *= -1;
			SpellCostMinimum2 += 100;
			FinalSpellCost = ceil((FinalSpellCost * SpellCostMinimum2) / 100);
			if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [ClearMind/MagiUp], SpellCostMinimum2: [%d / 100]", SpellIsSelected, FinalSpellCost, SpellCostMinimum2);
		}
		
		double StatManaCostReduction;
		// ((Sorcery + Therapeusis) / 20) = -0.01% Final Mana Cost [circumvents Clamp]
		int manacostbasestatreq = dvds_manacostbasestatreq;
		if (manacostbasestatreq < 1) manacostbasestatreq = 1;
		StatManaCostReduction = 1.00 - (ceil((PlayerSOR + PlayerTHE) / manacostbasestatreq) * 0.01);
		StatManaCostReduction = clamp(StatManaCostReduction, 0.25, StatManaCostReduction);
		FinalSpellCost = ceil(FinalSpellCost * StatManaCostReduction);
		if (SpellIsSelected != -1 && spellcostdebug && StatManaCostReduction != 1.00) Console.Printf("FinalSpellCost (%d): %d MP [SorcTherChecks], StatManaCostReduction: [%.2f]", SpellIsSelected, FinalSpellCost, StatManaCostReduction);
		
		// Checks Mana Cost Rate Menu Option [circumvents Clamp]
		FinalSpellCost = ceil(FinalSpellCost * dvds_manacostgmultiplier / 100);
		if (SpellIsSelected != -1 && spellcostdebug) Console.Printf("FinalSpellCost (%d): %d MP [CostRateOption]", SpellIsSelected, FinalSpellCost);
		
		FinalSpellCost = clamp(FinalSpellCost, 1, FinalSpellCost);
		if (SpellIsSelected == 53 && DivineAvatarTimer > 0 && IfDivAvCast > 0)
		{
			FinalSpellCost = clamp(FinalSpellCost, FinalSpellCost, MaxManaDouble);
		}
		else
		{
			FinalSpellCost = clamp(FinalSpellCost, FinalSpellCost, MaxMana);
		}
		if (spellcostdebug) Console.Printf("FinalSpellCost (%d): %d / %d MP [\cxFinalClamps]", SpellIsSelected, FinalSpellCost, OriginalSpellCost);
		
		return FinalSpellCost;
	}
	
	void A_PSI1DoEffectSpellCostCheck()
	{
		int spellcostdebug = dvdsdebug_showspellcoststuff;
		if ((level.totaltime % optimizefactortics2) == 0) 
		{
			if (UsingInGameMenu == 0)
			{
				CallACS("MiscVarSetDECORATE",2989,
								F_SpellCostCheck(CallACS("OtherVarCheckDECORATE",15),
								SpellCostsBase[CallACS("OtherVarCheckDECORATE",15)])); // Selected Spell
				if ((CallACS("QuickSpellCheckDECORATE",0) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2990,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",0) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",0) - 1)])); // QuickSpell 1
				}
				if ((CallACS("QuickSpellCheckDECORATE",1) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2991,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",1) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",1) - 1)])); // QuickSpell 2
				}
				if ((CallACS("QuickSpellCheckDECORATE",2) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2992,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",2) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",2) - 1)])); // QuickSpell 3
				}
				if ((CallACS("QuickSpellCheckDECORATE",3) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2993,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",3) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",3) - 1)])); // QuickSpell 4
				}
				if ((CallACS("QuickSpellCheckDECORATE",4) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2994,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",4) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",4) - 1)])); // QuickSpell 5
				}
				if ((CallACS("QuickSpellCheckDECORATE",5) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2995,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",5) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",5) - 1)])); // QuickSpell 6
				}
				if ((CallACS("QuickSpellCheckDECORATE",6) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2996,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",6) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",6) - 1)])); // QuickSpell 7
				}
				if ((CallACS("QuickSpellCheckDECORATE",7) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2997,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",7) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",7) - 1)])); // QuickSpell 8
				}
				if ((CallACS("QuickSpellCheckDECORATE",8) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2998,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",8) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",8) - 1)])); // QuickSpell 9
				}
				if ((CallACS("QuickSpellCheckDECORATE",9) - 1) >= 0)
				{
					CallACS("MiscVarSetDECORATE",2999,
									F_SpellCostCheck((CallACS("QuickSpellCheckDECORATE",9) - 1),
									SpellCostsBase[(CallACS("QuickSpellCheckDECORATE",9) - 1)])); // QuickSpell [1]0
				}
				if (spellcostdebug)
				{
					Console.Printf("Selected: %d", CallACS("MiscVarCheckDECORATE",2989));
					Console.Printf("QS1: %d [%d]", CallACS("MiscVarCheckDECORATE",2990), (CallACS("QuickSpellCheckDECORATE",0) - 1));
					Console.Printf("QS2: %d [%d]", CallACS("MiscVarCheckDECORATE",2991), (CallACS("QuickSpellCheckDECORATE",1) - 1));
					Console.Printf("QS3: %d [%d]", CallACS("MiscVarCheckDECORATE",2992), (CallACS("QuickSpellCheckDECORATE",2) - 1));
					Console.Printf("QS4: %d [%d]", CallACS("MiscVarCheckDECORATE",2993), (CallACS("QuickSpellCheckDECORATE",3) - 1));
					Console.Printf("QS5: %d [%d]", CallACS("MiscVarCheckDECORATE",2994), (CallACS("QuickSpellCheckDECORATE",4) - 1));
					Console.Printf("QS6: %d [%d]", CallACS("MiscVarCheckDECORATE",2995), (CallACS("QuickSpellCheckDECORATE",5) - 1));
					Console.Printf("QS7: %d [%d]", CallACS("MiscVarCheckDECORATE",2996), (CallACS("QuickSpellCheckDECORATE",6) - 1));
					Console.Printf("QS8: %d [%d]", CallACS("MiscVarCheckDECORATE",2997), (CallACS("QuickSpellCheckDECORATE",7) - 1));
					Console.Printf("QS9: %d [%d]", CallACS("MiscVarCheckDECORATE",2998), (CallACS("QuickSpellCheckDECORATE",8) - 1));
					Console.Printf("QS0: %d [%d]", CallACS("MiscVarCheckDECORATE",2999), (CallACS("QuickSpellCheckDECORATE",9) - 1));
				}
			}
			if (CallACS("MenuVarCheckDECORATE",4) == 2) 
			{
				if (CallACS("MenuVarCheckDECORATE",5) == 0)
				{
					for (int i = 0; i <= 8; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 1)
				{
					for (int i = 9; i <= 17; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
					if (CharacterClass == 9) CallACS("MiscVarSetDECORATE",(58+3000),F_SpellCostCheck(58,SpellCostsBase[58]));
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 2)
				{
					for (int i = 18; i <= 26; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 3)
				{
					for (int i = 27; i <= 35; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 4)
				{
					for (int i = 36; i <= 44; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 5)
				{
					for (int i = 45; i <= 53; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
				if (CallACS("MenuVarCheckDECORATE",5) == 6)
				{
					for (int i = 54; i <= 55; i++)
					{
						CallACS("MiscVarSetDECORATE",(i+3000),F_SpellCostCheck(i,SpellCostsBase[i]));
					}
				}
			}
		}
	}

	void A_PSI1DoEffectFinalCalls()
	{
		if (dvdsdebug_regenbonustimedisplay)
		{
			if (HPRegenBonPenTimer) Console.Printf("  \caHPRegenBonPenTimer: %d", HPRegenBonPenTimer);
			if (MPRegenBonPenTimer) Console.Printf("  \cnMPRegenBonPenTimer: %d", MPRegenBonPenTimer);
			if (StamRegenBonPenTimer) Console.Printf("  \cdStamRegenBonPenTimer: %d", StamRegenBonPenTimer);
			if (HLCRCoolBonPenTimer) Console.Printf("  \crHLCRCoolBonPenTimer: %d", HLCRCoolBonPenTimer);
		}

		int CurseTimeMultiplier = 1;
		int maxrollchance1 = 256;
		int maxrollchance2 = 256;
		int maxtics = 1050; // 30 Seconds
		int healticmax = random[statitem](192,228); // per 100%
		int healtimeincrease;

		if (CallACS("MiscVarCheckDECORATE",260) > 0)
		{
			healtimeincrease = (CallACS("MiscVarCheckDECORATE",260) * healticmax) / MaxHealthTrue;
			healtimeincrease *= frandom[statitem](0.999,1.001);
			if (healtimeincrease < random[statitem](1,2)) healticmax = random[statitem](1,2);
			if (dvdsdebug_regenpenaltydisplay) Console.Printf("HPBonusTimeAdd: %d", healtimeincrease);
			CallACS("MiscVarSetDECORATE",92,healtimeincrease,1); // HPRegenBonPenTimer
			HPRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",92);
			CallACS("MiscVarSetDECORATE",260,0);
		}
		if (CallACS("MiscVarCheckDECORATE",234) > 0)
		{
			if ((dvds_showdamagemessages & 1)) A_PrintHealingMessage(owner, CallACS("MiscVarCheckDECORATE",234));
			CallACS("MiscVarSetDECORATE",234,0);
		}

		if (owner.CountInv("RuinousShield")) 
		{
			CurseTimeMultiplier = ((2 + floor(TrueGameSkill * frandompick[statitem](0.2,0.225,0.25))) + randompick[statitem](-1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3));
			if (CurseTimeMultiplier < 1) CurseTimeMultiplier = 1;
		}
		if (owner.health > 0)
		{
			if (HPRegenBonPenTimer > maxtics) HPRegenBonPenTimer = maxtics;
			if (HPRegenBonPenTimer < -maxtics) HPRegenBonPenTimer = -maxtics;
			if (HPRegenBonPenTimer > 0 && random[statitem](1,maxrollchance1) > 1) 
			{
				HPRegenBonPenTimer -= CurseTimeMultiplier;
				if (HPRegenBonPenTimer < 0) HPRegenBonPenTimer = 0;
			}
			else
			if (HPRegenBonPenTimer < 0 && random[statitem](1,maxrollchance2) > 1) 
			{
				if (random[statitem](1,CurseTimeMultiplier) <= 1) HPRegenBonPenTimer += 1;
				if (HPRegenBonPenTimer > 0) HPRegenBonPenTimer = 0;
			}

			if (MPRegenBonPenTimer > maxtics) MPRegenBonPenTimer = maxtics;
			if (MPRegenBonPenTimer < -maxtics) MPRegenBonPenTimer = -maxtics;
			if (MPRegenBonPenTimer > 0 && random[statitem](1,maxrollchance1) > 1)
			{
				MPRegenBonPenTimer -= CurseTimeMultiplier;
				if (MPRegenBonPenTimer < 0) MPRegenBonPenTimer = 0;
			}
			else
			if (MPRegenBonPenTimer < 0 && random[statitem](1,maxrollchance2) > 1) 
			{
				if (random[statitem](1,CurseTimeMultiplier) <= 1) MPRegenBonPenTimer += 1;
				if (MPRegenBonPenTimer > 0) MPRegenBonPenTimer = 0;
			}

			if (StamRegenBonPenTimer > maxtics) StamRegenBonPenTimer = maxtics;
			if (StamRegenBonPenTimer < -maxtics) StamRegenBonPenTimer = -maxtics;
			if (StamRegenBonPenTimer > 0 && random[statitem](1,maxrollchance1) > 1)
			{
				StamRegenBonPenTimer -= CurseTimeMultiplier;
				if (StamRegenBonPenTimer < 0) StamRegenBonPenTimer = 0;
			}
			else
			if (StamRegenBonPenTimer < 0 && random[statitem](1,maxrollchance2) > 1)
			{
				if (random[statitem](1,CurseTimeMultiplier) <= 1) StamRegenBonPenTimer += 1;
				if (StamRegenBonPenTimer > 0) StamRegenBonPenTimer = 0;
			}

			if (HLCRCoolBonPenTimer > maxtics) HLCRCoolBonPenTimer = maxtics;
			if (HLCRCoolBonPenTimer < -maxtics) HLCRCoolBonPenTimer = -maxtics;
			if (HLCRCoolBonPenTimer > 0 && random[statitem](1,maxrollchance1) > 1)
			{
				HLCRCoolBonPenTimer -= CurseTimeMultiplier;
				if (HLCRCoolBonPenTimer < 0) HLCRCoolBonPenTimer = 0;
			}
			else
			if (HLCRCoolBonPenTimer < 0 && random[statitem](1,maxrollchance2) > 1)
			{
				if (random[statitem](1,CurseTimeMultiplier) <= 1) HLCRCoolBonPenTimer += 1;
				if (HLCRCoolBonPenTimer > 0) HLCRCoolBonPenTimer = 0;
			}
		}
		else
		{
			HPRegenBonPenTimer = 0;
			MPRegenBonPenTimer = 0;
			StamRegenBonPenTimer = 0;
			HLCRCoolBonPenTimer = 0;
		}
		CallACS("MiscVarSetDECORATE",92,HPRegenBonPenTimer); // Change HPRegenBonPenTimer
		CallACS("MiscVarSetDECORATE",93,MPRegenBonPenTimer); // Change MPRegenBonPenTimer
		CallACS("MiscVarSetDECORATE",94,StamRegenBonPenTimer); // Change StamRegenBonPenTimer
		CallACS("MiscVarSetDECORATE",95,HLCRCoolBonPenTimer); // Change HLCRCoolBonPenTimer

		int temp;
		if ((level.totaltime % optimizefactortics) == 0)
		{
			CallACS("MiscVarSetDECORATE",25001,PlayerCurrentHealth);
			
			CallACS("MiscVarSetDECORATE",25003,Owner.WaterLevel);
			CallACS("MiscVarSetDECORATE",25004,Owner.CountInv("RLMode"));
			CallACS("MiscVarSetDECORATE",25005,Owner.CountInv("PRMode"));
			CallACS("MiscVarSetDECORATE",25006,Owner.CountInv("UnmakerAmmoType"));
			CallACS("MiscVarSetDECORATE",25007,Owner.CountInv("UnmakerUpgrades"));
			pm = "EtherStock"; iDTech1Check = pm; CallACS("MiscVarSetDECORATE",25008,Owner.CountInv(iDTech1Check));
			CallACS("MiscVarSetDECORATE",25009,Owner.CountInv("MinigunHeat"));
			CallACS("MiscVarSetDECORATE",25010,Owner.CountInv("RailgunCharge"));
			CallACS("MiscVarSetDECORATE",25011,Owner.CountInv("FlameCount"));
			CallACS("MiscVarSetDECORATE",25012,Owner.CountInv("DualFlameCount"));
			CallACS("MiscVarSetDECORATE",25013,Owner.CountInv("FistPlayerBlockItem"));
			CallACS("MiscVarSetDECORATE",25014,Owner.CountInv("InvulnerabilitySpell"));
			CallACS("MiscVarSetDECORATE",25037,Owner.CountInv("BasicArmor"));
			CallACS("MiscVarSetDECORATE",25041,Owner.CountInv("PrimingSceptre"));
			CallACS("MiscVarSetDECORATE",25042,Owner.CountInv("DrawingDiarisBow"));
			CallACS("MiscVarSetDECORATE",25043,Owner.CountInv("HWShieldBlockHold"));
			CallACS("MiscVarSetDECORATE",25044,Owner.CountInv("PoisonNeedleAmmo"));
			Owner.A_SetInventory("InGameMenu",UsingInGameMenu);
			if (owner.player.cheats & CF_GODMODE) CallACS("MiscVarSetDECORATE",25045,1); else CallACS("MiscVarSetDECORATE",25045,0);
			if (owner.player.cheats & CF_GODMODE2) CallACS("MiscVarSetDECORATE",25046,1); else CallACS("MiscVarSetDECORATE",25046,0);
			
			pm = "CGrenadeAmmo"; iDTech1Check = pm;
			pm = "ClownGrenadeNew"; iDTech1Check2 = pm;
			if (Owner.CountInv(iDTech1Check) > 0 && !Owner.CountInv(iDTech1Check2)) Owner.A_GiveInventory(iDTech1Check2,1);
		}

		temp = 25036;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			Owner.A_GiveInventory("AllMap");
			Owner.A_GiveInventory("FarsightScanner");
		}

		if (owner.CountInv("FloraArmorFloorGuard") || 
				owner.CountInv("PowerIronFeet") || 
				owner.CountInv("AetheriusPowerIronFeet") || 
				owner.CountInv("PowerMask") || 
				owner.CountInv("AetheriusPowerMask"))
		{
			CallACS("MiscVarSetDECORATE",25032,1);
		}
		else
		{
			CallACS("MiscVarSetDECORATE",25032,0);
		}

		if ((level.totaltime % optimizefactortics) == 0)
		{
			CallACS("MiscVarSetDECORATE",25101,owner.CountInv("SauronHelmet"));
			CallACS("MiscVarSetDECORATE",25102,owner.CountInv("SauronGauntletsItem"));
			CallACS("MiscVarSetDECORATE",25103,owner.CountInv("TheOneRing"));
			CallACS("MiscVarSetDECORATE",25104,owner.CountInv("SafeTeaShoes"));
			CallACS("MiscVarSetDECORATE",25105,owner.CountInv("PearlyCorset"));
			CallACS("MiscVarSetDECORATE",25106,owner.CountInv("WaterFlyingDress"));
			CallACS("MiscVarSetDECORATE",25107,owner.CountInv("EvenstarNecklace"));
			CallACS("MiscVarSetDECORATE",25108,owner.CountInv("CloakofEvasion"));
			CallACS("MiscVarSetDECORATE",25109,owner.CountInv("AnubisCufflinks"));
			CallACS("MiscVarSetDECORATE",25110,owner.CountInv("KissaBra"));
			CallACS("MiscVarSetDECORATE",25111,owner.CountInv("DivineShield"));
			CallACS("MiscVarSetDECORATE",25112,owner.CountInv("RuinousShield"));
			CallACS("MiscVarSetDECORATE",25113,owner.CountInv("BalrogRing"));
			CallACS("MiscVarSetDECORATE",25114,owner.CountInv("DoveRibbon"));
			CallACS("MiscVarSetDECORATE",25115,owner.CountInv("FalconKnifeEarrings"));
		}
		
		temp = 25201;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(211);
			owner.A_StartSound("inv_fail",211,CHANF_DEFAULT,1.0,ATTN_NORM);
		}
		temp = 25202;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(212);
			owner.A_StartSound("debuffed",212,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25203;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(213);
			owner.A_StartSound("marines/armorbroken",213,CHANF_DEFAULT,1.0,ATTN_NORM);
		}
		temp = 25204;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(213);
			owner.A_StartSound("marines/armordamaged",213,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25206;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_VOICE);
			owner.A_StartSound("FloraChantHeal",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25207;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_VOICE);
			owner.A_StartSound("FloraChantMidHeal",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25208;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{	
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_VOICE);
			owner.A_StartSound("FloraChantMoreHeal",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25209;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_VOICE);
			owner.A_StartSound("FloraSummon",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25210;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_VOICE);
			owner.A_StartSound("FloraChantDivineAvatar",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
		}

		temp = 25211;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			if (CharacterClass == 2)
			{
				owner.A_StopSound(CHAN_VOICE);
				owner.A_StartSound("FloraEnterHighTension1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
		}

		temp = 25212;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			if (CharacterClass == 2)
			{
				owner.A_StopSound(CHAN_VOICE);
				owner.A_StartSound("FloraEnterHighTension2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
		}

		temp = 25213;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			if (CharacterClass == 2)
			{
				owner.A_StopSound(CHAN_VOICE);
				owner.A_StartSound("FloraEnterHighTension3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
		}

		temp = 25214;
		if (CallACS("MiscVarCheckDECORATE",temp) > 0)
		{
			CallACS("MiscVarSetDECORATE",temp,0);
			owner.A_StopSound(CHAN_BODY);
			owner.A_StartSound("tensionrevert",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
		}
	}
	
	// Rapid Cast Delay
	void A_PSIDoEffectRapidCastDelay()
	{
		double rapidcastdelay = 11.0;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && dvds_rapidcast)
		{
			if (CharacterClass == 0 || CharacterClass == 9) rapidcastdelay = 12;
			if (CharacterClass == 1) rapidcastdelay = 11;
			if (CharacterClass == 2 || CharacterClass == 8) rapidcastdelay = 10;
			if (dvdsdebug_rapidcastdisplays) Console.Printf("RapidCastDelay [Base]: %.8f", rapidcastdelay);
			
			// Stats
			rapidcastdelay -= ((PlayerSOR + PlayerTHE) * (1.0 / 80)); // Max of -6
			if (dvdsdebug_rapidcastdisplays) Console.Printf("RapidCastDelay [Sor+The]: %.8f", rapidcastdelay);

			// Perks
			rapidcastdelay -= (MagiUpPerkLevel * 0.5); // Max of -2.5
			rapidcastdelay -= (MagiUpEXPerkLevel * 1.25); // Max of -2.5
			if (dvdsdebug_rapidcastdisplays) Console.Printf("RapidCastDelay [MagiUp+Ex]: %.8f", rapidcastdelay);
			rapidcastdelay -= (WandMasteryPerkLevel * 0.4); // Max of -2
			rapidcastdelay -= (WandMasteryEXPerkLevel * 1.0); // Max of -2
			if (dvdsdebug_rapidcastdisplays) Console.Printf("RapidCastDelay [WandMastery]: %.8f", rapidcastdelay);

			// Buffs
			if (DQAcceleratleTimer) rapidcastdelay *= 0.67;
			if (DQDeceleratleTimer) rapidcastdelay *= 1.5;
			if (dvdsdebug_rapidcastdisplays) Console.Printf("RapidCastDelay [Buffs]: %.8f", rapidcastdelay);

			rapidcastdelay = clamp(rapidcastdelay, 2.0, rapidcastdelay);
			int truerapidcastdelay = round(rapidcastdelay);
			if (dvds_rapidcast) CallACS("MiscVarSetDECORATE",48,truerapidcastdelay);
			if (dvdsdebug_rapidcastdisplays) Console.Printf("TrueRapidCastDelay: %d", truerapidcastdelay);
		}
	}
	// InGameMenu Debug
	void A_PSI1DoEffectInGameMenuDebug()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (dvdsdebug_ingamemenudisplay && UsingInGameMenu != 0)
			{
				Console.Printf("[0] Main Menu = %d; [1] Main Selection = %d; [2] Secondary Selection = %d; [3] Tritary Selection = %d; [4] Menu Type = %d; [5] SubMenu Type = %d; [6] SubSubMenu Type = %d; [10001] Use Tic Timer = %d; [10002] Up Tic Timer = %d; [10003] Down Tic Timer = %d; [10004] Left Tic Timer = %d; [10005] Right Tic Timer = %d; [10006] Back Tic Timer = %d", UsingInGameMenu, CallACS("MenuVarCheckDECORATE",1), CallACS("MenuVarCheckDECORATE",2), CallACS("MenuVarCheckDECORATE",3), CallACS("MenuVarCheckDECORATE",4), CallACS("MenuVarCheckDECORATE",5), CallACS("MenuVarCheckDECORATE",6), CallACS("MenuVarCheckDECORATE",10001), CallACS("MenuVarCheckDECORATE",10002), CallACS("MenuVarCheckDECORATE",10003), CallACS("MenuVarCheckDECORATE",10004), CallACS("MenuVarCheckDECORATE",10005), CallACS("MenuVarCheckDECORATE",10006));
			}
		}
	}

	// HUD/Weapon Mana Costs
	void A_PSI1DoEffectWeaponManaCostCheck()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (buttons & BT_ZOOM) owner.A_SetInventory("AltItemSpellUseMode",1);
												else owner.A_SetInventory("AltItemSpellUseMode",0);
		}

		let weapon = owner.player.ReadyWeapon;
		int result;
		int result2;
		bool lowcap = false;
		bool lowcap2 = false;
		CallACS("MiscVarSetDECORATE",1501,0);
		CallACS("MiscVarSetDECORATE",1502,0);
		double resextra = 0.0;
		if (playeractor && optimizefactortics2)
		{
			// Weapon Checks
			nm = "EvilWarriorShield"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = ceil(((10 * (16 - (WandMasteryPerkLevel + (WandMasteryEXPerkLevel * 2.5)))) / 16) * (1.0 + (HellWarriorShieldLevel * 0.025)));
				result2 = 0; // no altfire costs
				lowcap = true;
				lowcap2 = false;
			}
			nm = "SapphireWandNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = ceil((2 * (14 - (WandMasteryPerkLevel + (WandMasteryEXPerkLevel * 2.5))) / 14 ));
				result2 = ceil(result * 3);
				lowcap = true;
				lowcap2 = true;
			}
			nm = "DualSapphireWandsNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = ceil((4 * (14 - (WandMasteryPerkLevel + (WandMasteryEXPerkLevel * 2.5))) / 14 ));
				result2 = ceil(result * 3);
				lowcap = true;
				lowcap2 = true;
			}
			nm = "ImpalerXBow"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = ceil(1 * (12 - (WandMasteryPerkLevel + (WandMasteryEXPerkLevel * 2.5))) / 12);
				result2 = ceil(result * 10);
				lowcap = true;
				lowcap2 = true;
			}
			nm = "DualImpalerXBow"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = ceil(2 * (12 - (WandMasteryPerkLevel + (WandMasteryEXPerkLevel * 2.5))) / 12);
				result2 = ceil(result * 10);
				lowcap = true;
				lowcap2 = true;
			}
			nm = "ScepterOfSouls"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 1;
				result2 = result * 2;
				lowcap = true;
				lowcap2 = true;
			}
			nm = "DualScepterOfSouls"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 2;
				result2 = result * 2;
				lowcap = true;
				lowcap2 = true;
			}
			nm = "PoisonNeedle"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(CallACS("StatCheck",2) * ((12.5 - ((MartialArtsMastery * 1.0) + (MartialArtsMasteryEx * 2.5)) - ((WandMasteryPerkLevel * 0.5) + (WandMasteryEXPerkLevel * 1.25))) * 0.01));
				lowcap = false;
				lowcap2 = true;
				if (!dvds_florathrownneedlemode) { result2 = 0; lowcap2 = false; }
			}
			nm = "GoldWandNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((2 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualGoldWandNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((2 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "CrossbowNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((4 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualCrossbowNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((4 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "SuperCrossbowNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((9 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualSuperCrossbowNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((9 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DragonClawNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((3 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualDragonClawNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((3 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "HellStaffNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((8 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualHellStaffNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((8 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "PhoenixRodNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((2 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualPhoenixRodNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((2 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "FiremaceNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((50 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualFiremaceNew"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((50 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DSparilStaff"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((20 * dvds_floratomedmpcostratio) / 100));
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "DualDSparilStaff"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				result2 = ceil(((20 * dvds_floratomedmpcostratio) / 100) * 2);
				result2 = ceil(result2 * (1.00 - (WandMasteryPerkLevel * 0.02) + (WandMasteryEXPerkLevel * 0.05)));
				lowcap = false;
				lowcap2 = true;
			}
			nm = "SerpentStaffAilish"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 1;
				result2 = 1;
				lowcap = true;
				lowcap2 = true;
			}
			nm = "UnmakerDVDS"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				if (owner.CountInv("UnmakerAmmoType") == 0)
				{
					result = 3;
					result2 = 0;
					lowcap = true;
					lowcap2 = false;
				}
			}
			nm = "NNSigil"; APPackCheck = nm;
			if (weapon is APPackCheck)
			{
				result = 0;
				lowcap = false;

				int ignorecommand = 0;
				if (CallACS("MiscVarCheckDECORATE",195) > 0) ignorecommand++; // If in mercy invincibility, no effect
				if (CallACS("MiscVarCheckDECORATE",25014) > 0) ignorecommand++; // if invulnerable, no effect
				if (CallACS("MiscVarCheckDECORATE",25040) > 0) ignorecommand++; // if invulnerable, no effect
				if (CallACS("MiscVarCheckDECORATE",25045) > 0) ignorecommand++; // if GodMode, no effect
				if (CallACS("MiscVarCheckDECORATE",25046) > 0) ignorecommand++; // if GodMode2, no effect
				if (ignorecommand == 0)
				{
					result = MaxHealthTrue * (CallACS("MiscVarCheckDECORATE",25047) * 4) / 100;
					result2 = 0;
					lowcap = true;
					lowcap2 = false;
				}
			}
			else
			{
				if (CharacterClass == 2)
				{
					if (Owner.CountInv("EvenstarNecklace")) resextra += 0.05;
					if (Owner.CountInv("AnubisCufflinks")) resextra += 0.01;
					if (Owner.CountInv("BalrogRing")) resextra += 0.025;
					
					nm = "PoisonNeedle"; APPackCheck = nm;
					if (weapon is APPackCheck) resextra *= 2;

					result = ceil(result * (1.00 - resextra));
					result2 = ceil(result2 * (1.00 - resextra));
				}
			}

			round(result);
			round(result2);
			if (lowcap == true && result < 1) result = 1;
			if (lowcap2 == true && result2 < 1) result2 = 1;
			CallACS("MiscVarSetDECORATE",1501,result);
			CallACS("MiscVarSetDECORATE",1502,result2);
			owner.A_SetInventory("NormFireManaCost",result);
			owner.A_SetInventory("AltFireManaCost",result2);
		}
	}
	
	// Hellcore Cooling
	void A_PSI1DoEffectHellcoreChecker()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		if (playeractor)
		{
			if ((level.totaltime % optimizefactortics) == 0)
			{
				// Check if player has specific Hellcore Souls, but has 0 for their level
				if (Owner.CountInv("ImpSoul") && CallACS("MiscVarCheckDECORATE",96) <= 0) CallACS("MiscVarSetDECORATE",96,1);
				if (Owner.CountInv("DarkImpSoul") && CallACS("MiscVarCheckDECORATE",97) <= 0) CallACS("MiscVarSetDECORATE",97,1);
				if (Owner.CountInv("CacodemonSoul") && CallACS("MiscVarCheckDECORATE",98) <= 0) CallACS("MiscVarSetDECORATE",98,1);
				if (Owner.CountInv("CacolanternSoul") && CallACS("MiscVarCheckDECORATE",99) <= 0) CallACS("MiscVarSetDECORATE",99,1);
				if (Owner.CountInv("AbaddonSoul") && CallACS("MiscVarCheckDECORATE",100) <= 0) CallACS("MiscVarSetDECORATE",100,1);
				if (Owner.CountInv("KnightSoul") && CallACS("MiscVarCheckDECORATE",101) <= 0) CallACS("MiscVarSetDECORATE",101,1);
				if (Owner.CountInv("BaronSoul") && CallACS("MiscVarCheckDECORATE",102) <= 0) CallACS("MiscVarSetDECORATE",102,1);
				if (Owner.CountInv("BelphegorSoul") && CallACS("MiscVarCheckDECORATE",103) <= 0) CallACS("MiscVarSetDECORATE",103,1);
				if (Owner.CountInv("BruiserSoul") && CallACS("MiscVarCheckDECORATE",104) <= 0) CallACS("MiscVarSetDECORATE",104,1);
				if (Owner.CountInv("ArchonSoul") && CallACS("MiscVarCheckDECORATE",105) <= 0) CallACS("MiscVarSetDECORATE",105,1);
				if (Owner.CountInv("PyroDemonSoul") && CallACS("MiscVarCheckDECORATE",106) <= 0) CallACS("MiscVarSetDECORATE",106,1);
				if (Owner.CountInv("IncarnateSoul") && CallACS("MiscVarCheckDECORATE",107) <= 0) CallACS("MiscVarSetDECORATE",107,1);
				if (Owner.CountInv("ArchvileSoul") && CallACS("MiscVarCheckDECORATE",108) <= 0) CallACS("MiscVarSetDECORATE",108,1);
				if (Owner.CountInv("DiabloistSoul") && CallACS("MiscVarCheckDECORATE",109) <= 0) CallACS("MiscVarSetDECORATE",109,1);
				if (Owner.CountInv("BalrogSoul") && CallACS("MiscVarCheckDECORATE",110) <= 0) CallACS("MiscVarSetDECORATE",110,1);
				if (Owner.CountInv("HElementalSoul") && CallACS("MiscVarCheckDECORATE",111) <= 0) CallACS("MiscVarSetDECORATE",111,1);
				if (Owner.CountInv("HOverlordSoul") && CallACS("MiscVarCheckDECORATE",112) <= 0) CallACS("MiscVarSetDECORATE",112,1);

				// Check if player LACKS specific Hellcore Souls, but has >0 for their level [i.e. Death Exits]
				if (Owner.CountInv("ImpSoul") <= 0 && CallACS("MiscVarCheckDECORATE",96) > 0) CallACS("MiscVarSetDECORATE",96,0);
				if (Owner.CountInv("DarkImpSoul") <= 0 && CallACS("MiscVarCheckDECORATE",97) > 0) CallACS("MiscVarSetDECORATE",97,0);
				if (Owner.CountInv("CacodemonSoul") <= 0 && CallACS("MiscVarCheckDECORATE",98) > 0) CallACS("MiscVarSetDECORATE",98,0);
				if (Owner.CountInv("CacolanternSoul") <= 0 && CallACS("MiscVarCheckDECORATE",99) > 0) CallACS("MiscVarSetDECORATE",99,0);
				if (Owner.CountInv("AbaddonSoul") <= 0 && CallACS("MiscVarCheckDECORATE",100) > 0) CallACS("MiscVarSetDECORATE",100,0);
				if (Owner.CountInv("KnightSoul") <= 0 && CallACS("MiscVarCheckDECORATE",101) > 0) CallACS("MiscVarSetDECORATE",101,0);
				if (Owner.CountInv("BaronSoul") <= 0 && CallACS("MiscVarCheckDECORATE",102) > 0) CallACS("MiscVarSetDECORATE",102,0);
				if (Owner.CountInv("BelphegorSoul") <= 0 && CallACS("MiscVarCheckDECORATE",103) > 0) CallACS("MiscVarSetDECORATE",103,0);
				if (Owner.CountInv("BruiserSoul") <= 0 && CallACS("MiscVarCheckDECORATE",104) > 0) CallACS("MiscVarSetDECORATE",104,0);
				if (Owner.CountInv("ArchonSoul") <= 0 && CallACS("MiscVarCheckDECORATE",105) > 0) CallACS("MiscVarSetDECORATE",105,0);
				if (Owner.CountInv("PyroDemonSoul") <= 0 && CallACS("MiscVarCheckDECORATE",106) > 0) CallACS("MiscVarSetDECORATE",106,0);
				if (Owner.CountInv("IncarnateSoul") <= 0 && CallACS("MiscVarCheckDECORATE",107) > 0) CallACS("MiscVarSetDECORATE",107,0);
				if (Owner.CountInv("ArchvileSoul") <= 0 && CallACS("MiscVarCheckDECORATE",108) > 0) CallACS("MiscVarSetDECORATE",108,0);
				if (Owner.CountInv("DiabloistSoul") <= 0 && CallACS("MiscVarCheckDECORATE",109) > 0) CallACS("MiscVarSetDECORATE",109,0);
				if (Owner.CountInv("BalrogSoul") <= 0 && CallACS("MiscVarCheckDECORATE",110) > 0) CallACS("MiscVarSetDECORATE",110,0);
				if (Owner.CountInv("HElementalSoul") <= 0 && CallACS("MiscVarCheckDECORATE",111) > 0) CallACS("MiscVarSetDECORATE",111,0);
				if (Owner.CountInv("HOverlordSoul") <= 0 && CallACS("MiscVarCheckDECORATE",112) > 0) CallACS("MiscVarSetDECORATE",112,0);
			}
		}
	}

	// Hellcore Cooling
	void A_PSI1DoEffectHellcoreCool()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		int hellcoreheatdebug = dvdsdebug_hellcoreheatdisplay;
		
		//******************************************************
		//*Hellcore Cooldown Process [25 tics = 1% of cooldown]*
		//******************************************************
		if (playeractor && UsingInGameMenu == 0)
		{
			HellcoreCooldownSpeed = 1.0;
			if (HellcoreOverheatLevel > 0 && PlayerCurrentHealth)
			{
				HellcoreCoolRatio = 400; // 0.04%
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 1 - Cooldown Increment (Base)]: %d\c-, Heat Level:", HellcoreCoolRatio, HellcoreOverheatLevel);
				
				// Dove Ribbon quickly cools down Hellcore meter.
				previousdelaycount = HellcoreCoolRatio;
				if (Owner.CountInv("DoveRibbon")) HellcoreCoolRatio *= 3;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 2 - Cooldown Increment (Dove Ribbon)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Divine Avatar speeds up cooldown by 100%
				previousdelaycount = HellcoreCoolRatio;
				if (DivineAvatarTimer > 0) HellcoreCoolRatio *= 2;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 3 - Cooldown Increment (Divine Avatar)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);

				// ????? speeds up cooldown by 400%
				previousdelaycount = HellcoreCoolRatio;
				if (GoETimer > 0) HellcoreCoolRatio *= 5;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 3a - Cooldown Increment (GoE)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Fatigue = 0.2x cooldown speed
				previousdelaycount = HellcoreCoolRatio;
				if (FatigueTimer > 0) HellcoreCoolRatio /= 5;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 4 - Cooldown Increment (Fatigue)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Sleep VERY quickly cools down Hellcore meter.
				previousdelaycount = HellcoreCoolRatio;
				if (SleepTimer > 0) HellcoreCoolRatio *= 5; 
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 5 - Cooldown Increment (Sleep)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Soul Mastery
				PerkFactor = 200;
				previousdelaycount = HellcoreCoolRatio;
				if (SoulMasteryPerkLevel > 0)
				{
					PerkFactor = 200 + ((SoulMasteryPerkLevel * 6) + (SoulMasteryEXPerkLevel * 15));
					HellcoreCoolRatio = HellcoreCoolRatio * PerkFactor / 200;
				}
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 6 - Cooldown Increment (Soul Mastery)]: %d\c-, Previous: %d, PerkFactor %d / 200", HellcoreCoolRatio, previousdelaycount, PerkFactor);
				
				// "Cleared of Mind: Perk
				PerkFactor = 80;
				previousdelaycount = HellcoreCoolRatio;
				if (ClearMindPerkLvl > 0)
				{
					PerkFactor = 80 + ((ClearMindPerkLvl * 6) + (ClearMindEXPerkLvl * 15));
					HellcoreCoolRatio = HellcoreCoolRatio * PerkFactor / 80;
				}
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 7 - Cooldown Increment (Cleared of Mind)]: %d\c-, Previous: %d, PerkFactor %d / 80", HellcoreCoolRatio, previousdelaycount, PerkFactor);
				
				// Check Hellcore Cooldown Multiplier in Options
				previousdelaycount = HellcoreCoolRatio;
				HellcoreCoolRatio = (HellcoreCoolRatio * dvds_helccoolmultiplier) / 100;
				HellcoreCoolRatio = clamp(HellcoreCoolRatio, 1, HellcoreCoolRatio);
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 8 - Cooldown Increment (Menu Option)]: %d\c-, Previous: %d, Multiplier %d%", HellcoreCoolRatio, previousdelaycount, dvds_helccoolmultiplier);
				
				// ???????
				previousdelaycount = HellcoreCoolRatio;
				if (Owner.CountInv("IsHaSatanNow")) HellcoreCoolRatio = HellcoreCoolRatio * 16;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 9 - Cooldown Increment (???????)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Playing Unloved [2x Cooldown Speed]
				previousdelaycount = HellcoreCoolRatio;
				if (CallACS("DVDSSpecialArrayCheckDECORATE",3) > 0 || Owner.CountInv("PlayingUnloved")) HellcoreCoolRatio = HellcoreCoolRatio * 2;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 10a - Cooldown Increment (Playing Unloved)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);

				// Playing The City of the Damned: Apocalypse [5x Cooldown Speed]
				previousdelaycount = HellcoreCoolRatio;
				if (CallACS("DVDSSpecialArrayCheckDECORATE",4) > 0 || Owner.CountInv("PlayingTCOTDA")) HellcoreCoolRatio = (HellcoreCoolRatio * 5) / 4;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 10b - Cooldown Increment (Playing TCOTD:A)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);

				// Playing Happy Time Circus 2 [3x Cooldown Speed]
				previousdelaycount = HellcoreCoolRatio;
				if (CallACS("DVDSSpecialArrayCheckDECORATE",5) > 0 || Owner.CountInv("PlayingCircus2")) HellcoreCoolRatio = (HellcoreCoolRatio * 3) / 2;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 10c - Cooldown Increment (Playing Happy Time Circus 2)]: %d\c-, Previous: %d", HellcoreCoolRatio, previousdelaycount);
				
				// Power Trip "Cheat"
				previousdelaycount = HellcoreCoolRatio;
				if (dvds_musou_powertripmode == 1) HellcoreCoolRatio *= 2.5; // 250%
				if (dvds_musou_powertripmode == 2) HellcoreCoolRatio *= 5; // 500%
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 11 - Cooldown Increment (Power Trip Mode [%d])]: %d\c-, Previous: %d", dvds_musou_powertripmode, HellcoreCoolRatio, previousdelaycount);

				// Using Focus
				previousdelaycount = HellcoreCoolRatio;
				double tempdouble;
				if (IsFocusOn > 0)
				{
					tempdouble = (0.000285714 * FocusTimer);
					if (CallACS("DVDSSpecialArrayCheckDECORATE",3) > 0 || Owner.CountInv("PlayingUnloved")) tempdouble *= 2;
					if (CallACS("DVDSSpecialArrayCheckDECORATE",4) > 0 || Owner.CountInv("PlayingTCOTDA")) tempdouble *= 5;
					if (CallACS("DVDSSpecialArrayCheckDECORATE",5) > 0 || Owner.CountInv("PlayingCircus2")) tempdouble *= 3;
					HellcoreCoolRatio *= (1.0 + (0.25 + tempdouble));
					if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 12 - Cooldown Increments]: %d\c-, New Heat Level: %d\c-, Old Heat Level: %d", HellcoreCoolRatio, HellcoreOverheatLevel, previousdelaycount);
				}
				
				// ?
				// Cooldown Gradually Speeds up when not in use
				if (HellcoreCooldownTimer > 0)
				{
					previousdelaycount = HellcoreCoolRatio;
					double speedlimit = (Owner.CountInv("DoveRibbon") ? 14.0625 : 6.25);
					HellcoreCooldownSpeed = (1.0 + double(double(HellcoreCooldownTimer * (Owner.CountInv("DoveRibbon") ? 0.7401315789473685 : 0.3289473684210527)) / TICRATE));
					if (HellcoreCooldownSpeed > speedlimit) HellcoreCooldownSpeed = speedlimit;
					if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 13a - Cooldown Speed]: %.8f, Timer: %d\c-", HellcoreCooldownSpeed, HellcoreCooldownTimer);
					
					HellcoreCoolRatio *= HellcoreCooldownSpeed;
					if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 13b - Cooldown Speed]: %d\c-, New Heat Level: %d\c-, Old Heat Level: %d", HellcoreCoolRatio, HellcoreOverheatLevel, previousdelaycount);
				}

				previousdelaycount = HellcoreOverheatLevel;
				if (HLCRCoolBonPenTimer > 0) HellcoreCoolRatio *= HLCRCoolBonPenMulti;
				if (HLCRCoolBonPenTimer < 0) HellcoreCoolRatio *= (1.0 / HLCRCoolBonPenMulti);
				HellcoreOverheatLevel -= HellcoreCoolRatio;
				HellcoreCooldownTimer++;
				if (hellcoreheatdebug) Console.Printf("    \crHellcore Cooldown [Step 14 - Cooldown Increments]: New Heat Level: %d\c-, Old Heat Level: %d", HellcoreOverheatLevel, previousdelaycount);
			}
			if (HellcoreOverheatLevel <= 0) 
			{
				HellcoreOverheatLevel = 0;
				HellcoreCooldownTimer = 0;
				HellcoreCooldownSpeed = 1.0;
			}
			CallACS("OtherVarSetDECORATE",6,HellcoreOverheatLevel);
			HellcoreOverheatLevel = CallACS("OtherVarCheckDECORATE",6);
			
			// Check For If Using Hellcore Weapon
			SkillFactor = 0;
			if (weapon is "ImpSoul" || weapon is "DarkImpSoul" ||
					weapon is "CacodemonSoul" || weapon is "CacolanternSoul" || weapon is "AbaddonSoul") SkillFactor += 1; 
			if (weapon is "KnightSoul" || weapon is "BaronSoul" || weapon is "BelphegorSoul" ||
					weapon is "BruiserSoul" || weapon is "ArchonSoul" || weapon is "PyroDemonSoul") SkillFactor += 1; 
			if (weapon is "IncarnateSoul" || weapon is "ArchvileSoul" || 
					weapon is "DiabloistSoul" || weapon is "BalrogSoul") SkillFactor += 1;  
			if (weapon is "HElementalSoul" || weapon is "HOverlordSoul") SkillFactor += 1; 
			if (SkillFactor > 0) { Owner.A_SetInventory("FloraUsingHellcoreWeapon",1); } else { Owner.A_SetInventory("FloraUsingHellcoreWeapon",0); }
			
			if (CharacterClass == 2) 
			{
				if (HellcoreOverheatLevel < 250000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",1);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 249999 && HellcoreOverheatLevel < 500000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",1);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 499999 && HellcoreOverheatLevel < 750000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",1);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 749999 && HellcoreOverheatLevel < 1000000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",1);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 999999 && HellcoreOverheatLevel < 2500000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",1);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 2499999 && HellcoreOverheatLevel < 5000000) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",1);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",0);
				}
				if (HellcoreOverheatLevel > 4999999) 
				{
					Owner.A_SetInventory("FloraHellcoreNotOverheated",0);
					Owner.A_SetInventory("FloraHellcore25PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore50PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore75PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore100PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore250PercentOverheated",0);
					Owner.A_SetInventory("FloraHellcore500PercentOverheated",1);
				}
			}
			
			// Melee Weapon Inv Check
			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
			SkillFactor = 0;
			if (weapon is "Fist" || weapon is "FistDeggaris" || 
					weapon is "FistIllucia" || weapon is "FistFlora") SkillFactor += 1;
			if (weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || 
					weapon is "SauronGauntletsFlora" || weapon is APPackCheck || 
					weapon is APPackCheck2 || weapon is "SceptreOfEmpyrea" || weapon is "PoisonNeedle") SkillFactor += 1;
			if (weapon is "Chainsaw" || weapon is "Chainsaw2" || weapon is "DoubleBladedChainsaw") SkillFactor += 1; 
			if (SkillFactor > 0) { Owner.A_SetInventory("UsingMeleeWeapon",1); } else { Owner.A_SetInventory("UsingMeleeWeapon",0); }
		}
	}
	

	// Regen/Degen Effects
	void A_PSI1DoEffectRegenDegenEffects()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		int DegenMinimumHPFactor = 10; 
		int DegenMinimumManaFactor = 80;
		int DegenMinimumHP;
		int DegenMinimumMana;
		int CursedShieldDegenInterval;
		int DegenValue;
		int DivineRegenAmount;
		int DoveRegenAmount;
		int RegenMaxHealth;
		int StamUpgradeDelay;
		int StaminaInputFactor;
		int HPRegenAmount;
		int HPDegenAmount;
		int PoisonIncrement;
		int PoisonHealth;
		int PoisonHealthThreshold;
		int PoisonDmg;
		int PoisonFlashColor;
		int SkillLevelManaDelay, ManaReDelay;
		int RegenedMana, regenedmanabasereq;
		int MaxRegenableMana, EquippedRegenCap;
		int MaxManaLimit;
		int ArcanaRegenDelaySkill, ArcanaRegenAmount;
		int staminaregenbase, staminaregenfinal;
		int defenddivisor;
		int debugehealthregen = dvdsdebug_showhpregenstuff;

		if (playeractor && UsingInGameMenu == 0)
		{
			//***********************
			//*Check for Magic Focus*
			//***********************
			int FocusDrain;
			FreezePlayer = 0;
			if (UsingInGameMenu > 0) FreezePlayer += 1;
			if (FatigueTimer > 0 && random[statitem](1,5) > 2) FreezePlayer += 1;
			if (SleepTimer > 0) FreezePlayer += 1;
			if (SilenceTimer > 0 && random[statitem](1,5) > 2) FreezePlayer += 1;
			buttons = owner.GetPlayerInput(INPUT_BUTTONS);
			//Console.Printf("    \cnFocusing [Step 0 - Input]: %d\c-", buttons);
			if (CurrentMana < MaxMana && buttons & BT_ZOOM && buttons & BT_SPEED && CurrentStamina >= FocusDrain && FreezePlayer == 0)
			{
				if (random[statitem](1,25) == 1) FocusDrain = (random[statitem](1,2) * 4);
																		else FocusDrain = (random[statitem](4,8) * 5);
				if (StrifeStamLvl > 0) FocusDrain = ceil(FocusDrain * (100 - (StrifeStamLvl * 3.375)) / 100);
				if (Owner.CountInv("FalconKnifeEarrings")) FocusDrain = ceil(FocusDrain * 0.9);
				//Console.Printf("    \cnFocusing [Step 1 - Base Drain]: %d\c-", FocusDrain);
				
				if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious"))
				{
					CallACS("MiscVarSetDECORATE",212,0); // "Focus" off
					CallACS("MiscVarSetDECORATE",231,0);
					owner.A_RemoveChildren(true,RMVF_MISC,"FocusParticleSource");
				}
				else // If Player is "Conscious", allow Focus to activate
				{
					previousdelaycount = CurrentStamina;
					CurrentStamina -= FocusDrain;
					BaseStamPenalty = (BaseStamPenalty * FocusDrain) / MaximumStamina;
					if (BaseStamPenalty <= random[statitem](1,2)) BaseStamPenalty = random[statitem](1,2);
					if (dvdsdebug_regenpenaltydisplay) Console.Printf("StamPenaltyTimeAdd: %d", BaseStamPenalty);
					CallACS("MiscVarSetDECORATE",94,BaseStamPenalty,2);  // StamRegenBonPenTimer
					StamRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",94);

					if (CurrentStamina < 0) CurrentStamina = 0;
					CallACS("MiscVarSetDECORATE",21,CurrentStamina);
					CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
					//Console.Printf("    \cnFocusing [Step 2 - Reduce Stamina]: Current: %d\c-, Previous: %d, DrainAmt: %d", CurrentStamina, previousdelaycount, FocusDrain);
				
					CallACS("MiscVarSetDECORATE",212,1); // "Focus" on
					CallACS("MiscVarSetDECORATE",231,1,1); // Increment Focus Timer

					// Focus Generator
					if (FocusTimer == 1)
					{
						owner.A_SpawnItemEx("FocusParticleSource",0,0,0,0.0,0.0,0.0,0,SXF_SETMASTER);
					}
				}
			}
			else
			{
				CallACS("MiscVarSetDECORATE",212,0); // "Focus" off
				CallACS("MiscVarSetDECORATE",231,0);
				owner.A_RemoveChildren(true,RMVF_MISC,"FocusParticleSource");
			}
			if (IsFocusOn > 0) // Focusing
			{
				if (PlayerCurrentHealth > 0) 
				{
					owner.A_SetBlend("00 00 30", 0.9375, 25); // Constant Run
					//Console.Printf("Focusing");
				}
			}
			
			
			//************************************************************************
			//**Ruinous Shield Degeneration Effect [will NOT kill the player though]**
			//************************************************************************
			if (Owner.CountInv("RuinousShield"))
			{
				// Determines how low HP/MP can degenerate to when the Ruinous Shield is equipped. [used as Divisors]
				DegenMinimumHPFactor = 8 - (TrueGameSkill * frandom[statitem](0.9,1.0)); 
				DegenMinimumManaFactor = 16 - ((TrueGameSkill * 2) * frandom[statitem](0.95,1.0));
				DegenMinimumHPFactor = ceil(DegenMinimumHPFactor * 0.75);
				DegenMinimumManaFactor = ceil(DegenMinimumManaFactor * 0.75);
				DegenMinimumHP = floor((MaxHealthTrue * DegenMinimumHPFactor) / 100);
				if (DegenMinimumHP < 1) DegenMinimumHP = 1;
				DegenMinimumMana = floor((MaxMana * DegenMinimumManaFactor) / 100);
				if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 1 - Base Divisors]: DegenMinimumHPFactor: %d, DegenMinimumManaFactor: %d\c-, DegenMinimumHP: %d, DegenMinimumMana: %d", DegenMinimumHPFactor, DegenMinimumManaFactor, DegenMinimumHP, DegenMinimumMana);
			
				// Set Curse Degeneration Intervals
				CursedShieldDegenInterval = (4 + (TrueGameSkill * 0.25));
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1;
				if (SleepTimer > 0) FreezePlayer += 1;
				if (FreezePlayer == 0)
				{
					if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 1.2);
					if (buttons & BT_ATTACK || buttons & BT_ALTATTACK) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 1.3);
					if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 1.4);
					if ((buttons & BT_JUMP) && sv_allowjump) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 1.2);
					if ((buttons & BT_CROUCH) && sv_allowcrouch) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 0.4);
				}
				if (random[statitem](1,16) == 1) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 2);
				if (random[statitem](1,64) == 1) CursedShieldDegenInterval = floor(CursedShieldDegenInterval * 2);
				if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 2 - Base Degen Intervals (\cyInput: %d\cn)]: Interval: %d, Frozen?: %d", buttons, CursedShieldDegenInterval, FreezePlayer);
				
				// Checks Armor Items and other types for Degen speed.
				SkillFactor = 200;
				if (CharacterClass == 2)
				{
					if (Owner.CountInv("PearlyCorset")) SkillFactor -= 20;
					if (Owner.CountInv("EvenstarNecklace")) SkillFactor -= 10;
					if (Owner.CountInv("AnubisCufflinks")) SkillFactor -= 15;
					if (Owner.CountInv("BalrogRing")) SkillFactor -= 25;
					// total of -34 = 66% speed with all four items
				}
				CursedShieldDegenInterval = ceil(CursedShieldDegenInterval * SkillFactor / 200);
				if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 3 - Degen Intervals (Post-Armor)]: %d, Factor: %d / 200", CursedShieldDegenInterval, SkillFactor);
				
				// Final Degen Interval
				if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 4 - Degen Intervals (MenuCheck)]: %d", CursedShieldDegenInterval);

				RuinousShieldDegenTimer += CursedShieldDegenInterval;
				if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 5 - Degen Intervals Timer]: %d / %d", RuinousShieldDegenTimer, CursedShieldDegenTimer);

				// Curse Effect Execution
				if (RuinousShieldDegenTimer >= CursedShieldDegenTimer)
				{
					PlayerCurrentHealth = owner.health;
					if (PlayerCurrentHealth > DegenMinimumHP)
					{
						// HP Degeneration
						DegenValue = ceil(MaxHealthTrue * frandompick[statitem](0.015,0.0075,0.0075,0.005,0.005,0.005,0.005,0.00375,0.00375,0.003));
						if (DegenValue < 1) DegenValue = 1;
						PlayerCurrentHealth -= DegenValue;
						if (PlayerCurrentHealth < DegenMinimumHP) PlayerCurrentHealth = DegenMinimumHP;

						owner.player.health = owner.player.mo.health = PlayerCurrentHealth;
						CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
						CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);
						if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 6a - HP Degen]: %d", DegenValue);
					}
				
					if (CurrentMana > DegenMinimumMana)
					{
						// MP Degeneration
						DegenValue = ceil(MaxMana * frandompick[statitem](0.015,0.0075,0.0075,0.005,0.005,0.005,0.005,0.00375,0.00375,0.003));
						if (DegenValue < 1) DegenValue = 1;
						CurrentMana -= DegenValue;
						if (CurrentMana < DegenMinimumMana) CurrentMana = DegenMinimumMana;

						CallACS("OtherVarSetDECORATE",2,CurrentMana);
						CurrentMana = CallACS("StatCheck",14); // Refreshs Current MP amount
						CallACS("MiscVarSetDECORATE",243,CurrentMana);
						CallACS("MiscVarSetDECORATE",238,CurrentMana);
						if (dvdsdebug_cursedmgdisplay) Console.Printf("    \cnCurse Degeneration [Step 6b - MP Degen]: %d", DegenValue);
					}
					
					DegenValue = 0;
					RuinousShieldDegenTimer = 0;
					CursedShieldDegenTimer = 175 + ((5 + (TrueGameSkill * 1.0675)) * random[statitem](-3,3));
				}
			}
			else
			{
				DegenValue = 0;
				RuinousShieldDegenTimer = 0;
				CursedShieldDegenTimer = 175 + ((5 + (TrueGameSkill * 1.0675)) * random[statitem](-3,3));
			}
		
		
			//***************************
			//** Divine Avatar HP Regen**
			//***************************
			if (PlayerCurrentHealth > 0 && DivineAvatarTimer > 0)
			{
				if (PlayerCurrentHealth < MaxHealthLimit)
				{
					delaycount = 20;
					if (debugehealthregen && PlayerCurrentHealth < MaxHealthLimit) Console.Printf("    \caDivineAvatar HP Regen [Step 1 - Base Interval Delay]: %d\c-", delaycount);
					
					previousdelaycount = delaycount;
					if (GoETimer > 0) delaycount = floor(delaycount * 5);
					if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caDivineAvatar HP Regen [Step 1b - Interval Delay (GoE)]: %d, Previous: %d\c-", delaycount, previousdelaycount);
					
					if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
					else // If Player is "Conscious", allow their HP regen timer to count
					{
						DivineRegenTimer += delaycount;
						if (debugehealthregen) Console.Printf("    \caDivineAvatar HP Regen [Step 2 - Increment Count]: %d / %d\c-, DelayCount: %d", DivineRegenTimer, DivineRegenInterval, delaycount);
					}
				}
				
				if (PlayerCurrentHealth > 0)
				{
					if (DivineRegenTimer >= DivineRegenInterval)
					{
						if (PlayerCurrentHealth < MaxHealthLimit)
						{
							DivineRegenAmount = floor(MaxHealthLimit * frandompick[statitem2](0.015,0.012,0.01,0.0085,0.0075));
							DivineRegenAmount = clamp(DivineRegenAmount, 1, DivineRegenAmount);
							if (debugehealthregen && PlayerCurrentHealth < MaxHealthLimit) Console.Printf("    \caDivineAvatar HP Regen [Step R1 - Base Regen Amount]: %d\c-", DivineRegenAmount);
						
							previousdelaycount = DivineRegenAmount;
							if (Owner.CountInv("SauronGauntletsItem")) DivineRegenAmount = floor(DivineRegenAmount * 1.0625);
							if (debugehealthregen && DivineRegenAmount != previousdelaycount) Console.Printf("    \caDivineAvatar HP Regen [Step R2 - Regen Amount (Gauntlets)]: %d\c-, Previous: %d", DivineRegenAmount, previousdelaycount);
						
							previousdelaycount = DivineRegenAmount;
							if (Owner.CountInv("TheOneRing")) DivineRegenAmount = floor(DivineRegenAmount * 1.125);
							if (debugehealthregen && DivineRegenAmount != previousdelaycount) Console.Printf("    \caDivineAvatar HP Regen [Step R3 - Regen Amount (The One Ring)]: %d\c-, Previous: %d", DivineRegenAmount, previousdelaycount);
						
							PlayerCurrentHealth = owner.health;
							PlayerCurrentHealth += DivineRegenAmount;
							if (PlayerCurrentHealth > MaxHealthLimit) PlayerCurrentHealth = MaxHealthLimit;
							owner.player.health = owner.player.mo.health = PlayerCurrentHealth;
							CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
							CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);
							
							DivineRegenInterval = random[statitem](30,35) * 20;
							DivineRegenTimer -= DivineRegenInterval;
							if (DivineRegenTimer < 0) DivineRegenTimer = 0;
						}
						else
						{
							DivineRegenInterval = random[statitem](30,35) * 20;
							DivineRegenTimer = 0;
						}
					}
				}
			}
			else
			{
				DivineRegenTimer = 0;
				DivineRegenInterval = random[statitem](30,35) * 20;
			}
			
			
			//***************************
			//** Dove's Ribbon HP Regen**
			//***************************
			if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) // Flora
			{
				double countfactor = 1.00;
				if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
				else // If Player is "Conscious", allow Dove Ribbon HP Regen Timer to count
				{
					if (PlayerCurrentHealth < MaxHealthLimit)
					{
						delaycount = 20;
						if (debugehealthregen && PlayerCurrentHealth < MaxHealthLimit) Console.Printf("    \caDoveRibbon HP Regen [Step 1 - Base Interval Delay]: %d\c-", delaycount);
						
						previousdelaycount = delaycount;
						if (Owner.CountInv("SafeTeaShoes")) countfactor += 0.1;
						if (Owner.CountInv("PearlyCorset")) countfactor += 0.1;
						if (Owner.CountInv("DivineShield")) countfactor += 0.3;
						if (Owner.CountInv("CloakOfEvasion")) countfactor += 0.1;
						delaycount = floor(delaycount * countfactor);
						if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caDoveRibbon HP Regen [Step 1b - Interval Delay (Armor Items)]: %d, Previous: %d, CountFactor: %.8f\c-", delaycount, previousdelaycount, countfactor);
						
						previousdelaycount = delaycount;
						if (GoETimer > 0) delaycount = floor(delaycount * 5);
						if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caDoveRibbon HP Regen [Step 1c - Interval Delay (GoE)]: %d\c-, Previous: %d", delaycount, previousdelaycount);
						
						DoveRegenTimer += delaycount;
						if (debugehealthregen) Console.Printf("    \caDoveRibbon HP Regen [Step 2 - Increment Count]: %d / %d\c-, DelayCount: %d", DoveRegenTimer, DivineRegenInterval, delaycount);
					}
				}
	
				if (PlayerCurrentHealth > 0)
				{
					if (DoveRegenTimer >= DoveRegenInterval)
					{
						if (PlayerCurrentHealth < MaxHealthLimit)
						{
							DoveRegenAmount = floor(((PlayerLevel * frandom[statitem2](0.9,1.1)) / RandomPick[statitem](40,45,50,55,60)) + RandomPick[statitem](1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2));
							DoveRegenAmount = clamp(DoveRegenAmount, 1, DoveRegenAmount);
							if (debugehealthregen && PlayerCurrentHealth < MaxHealthLimit) Console.Printf("    \caDoveRibbon HP Regen [Step R1 - Base Regen Amount]: %d\c-", DoveRegenAmount);

							previousdelaycount = DoveRegenAmount;
							if (Owner.CountInv("SauronGauntletsItem")) DoveRegenAmount = floor(DoveRegenAmount * 1.0625);
							if (debugehealthregen && DoveRegenAmount != previousdelaycount) Console.Printf("    \caDoveRibbon HP Regen [Step R2 - Regen Amount (Gauntlets)]: %d\c-, Previous: %d", DoveRegenAmount, previousdelaycount);

							previousdelaycount = DoveRegenAmount;
							if (Owner.CountInv("TheOneRing")) DoveRegenAmount = floor(DoveRegenAmount * 1.125);
							if (debugehealthregen && DoveRegenAmount != previousdelaycount) Console.Printf("    \caDoveRibbon HP Regen [Step R3 - Regen Amount (The One Ring)]: %d\c-, Previous: %d", DoveRegenAmount, previousdelaycount);

							PlayerCurrentHealth = owner.health;
							PlayerCurrentHealth += DoveRegenAmount;
							PlayerCurrentHealth = clamp(PlayerCurrentHealth, PlayerCurrentHealth, MaxHealthLimit);
							owner.player.health = owner.player.mo.health = PlayerCurrentHealth;
							CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
							CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);

							DoveRegenInterval = random[statitem](27,32) * 20;
							DoveRegenTimer -= DoveRegenInterval;
							if (DoveRegenTimer < 0) DoveRegenTimer = 0;
						}
						else
						{
							DoveRegenTimer = 0;
							DoveRegenInterval = random[statitem](27,32) * 20;
						}
					}
				}
			}
			else
			{
				DoveRegenTimer = 0;
				DoveRegenInterval = random[statitem](27,32) * 20;
			}
			
			
			//****************
			//**Health Regen**
			//****************
			HPDelayInterval = 140;
			if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
			// Base Character Interval Max
			if (CharacterClass == 0) HPDelayInterval = 118; // Deggaris Regenerates the second Fastest [3.54 seconds]
			if (CharacterClass == 1) HPDelayInterval = 140; // Illucia has an even speed of Regeneration [4 seconds]
			if (CharacterClass == 2) HPDelayInterval = 162; // Flora Regenerates slower than Illucia [4.46 seconds]
			if (CharacterClass == 8) HPDelayInterval = 175; // Ailish Regenerates the slowest [5 seconds]
			if (CharacterClass == 9) HPDelayInterval = 81; // Petra Regenerates the fastest [2.314285714 seconds]
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step 1a - Base Interval Delay]: %d\c-", HPDelayInterval);
			
			// Level Check [Interval Delay]
			previousdelaycount = HPDelayInterval;
			if (TrueGameSkill <= SKILL_VERY_EASY) HPDelayInterval -= 6;
			if (TrueGameSkill == SKILL_EASY) HPDelayInterval -= 2;
			if (TrueGameSkill == SKILL_NORMAL) HPDelayInterval += 0;
			if (TrueGameSkill == SKILL_HARD) HPDelayInterval += 2;
			if (TrueGameSkill == SKILL_VERY_HARD) HPDelayInterval += 6;
			if (TrueGameSkill == SKILL_EXTREME) HPDelayInterval += 8;
			if (TrueGameSkill == SKILL_HORRIBLE) HPDelayInterval += 12;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) HPDelayInterval += 14;
			if (TrueGameSkill >= SKILL_OMEGA) HPDelayInterval += 16;
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth && HPDelayInterval != previousdelaycount) Console.Printf("    \caHP Regen [Step 1b - Interval Delay (Difficulty)]: %d\c-, Previous: %d", HPDelayInterval, previousdelaycount);
			
			previousdelaycount = HPDelayInterval;
			HPDelayInterval -= floor(PlayerLevel * 0.14286); 
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth && HPDelayInterval != previousdelaycount) Console.Printf("    \caHP Regen [Step 1c - Interval Delay (PlayerLevel)]: %d\c-, Previous: %d", HPDelayInterval, previousdelaycount);
			
			previousdelaycount = HPDelayInterval;
			HPDelayInterval *= 20;
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth && HPDelayInterval != previousdelaycount) Console.Printf("    \caHP Regen [Step 1d - Interval Delay (Final Calc)]: %d\c-, Previous: %d", HPDelayInterval, previousdelaycount);
			
			PlayerCurrentHealth = owner.health;
			if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step 2 - Check Max Health Cap (Dove?)]: %d\c-, Current Health: %d", RegenMaxHealth, PlayerCurrentHealth);
			
			
			
			// Base Delay Count
			SkillFactor = 0;
			delaycount = 20;
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step 3 - Get Base RegenTimer Increment]: %d\c-", delaycount);
			
			// Character Delay Count
			previousdelaycount = delaycount;
			SkillFactor = 0;
			if (CharacterClass == 0) SkillFactor = ceil(PlayerDEF / 8); // 8pts of Defense will decrease regen wait by 1 tic each [Deggaris]
			if (CharacterClass == 1) SkillFactor = ceil(PlayerDEF / 10); // 10pts of Defense will decrease regen wait by 1 tic each [Illucia]
			if (CharacterClass == 2) SkillFactor = ceil(PlayerDEF / 12); // 12pts of Defense will decrease regen wait by 1 tic each [Flora]
			if (CharacterClass == 8) SkillFactor = ceil(PlayerDEF / 12); // 12pts of Defense will decrease regen wait by 1 tic each [Ailish]
			if (CharacterClass == 9) SkillFactor = ceil(PlayerDEF / 6); // 6pts of Defense will decrease regen wait by 1 tic each [Petra]
			delaycount += SkillFactor;
			if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Regen [Step 4 - Get Character RegenTimer Increment]: %d\c-, Added: %d", delaycount, SkillFactor);
			
			// Hellcore Heat
			previousdelaycount = delaycount;
			if (owner.CountInv("FloraHellcoreNotOverheated")) delaycount *= 1.0;
			if (owner.CountInv("FloraHellcore25PercentOverheated")) delaycount *= 0.96875;
			if (owner.CountInv("FloraHellcore50PercentOverheated")) delaycount *= 0.9375;
			if (owner.CountInv("FloraHellcore75PercentOverheated")) delaycount *= 0.875;
			if (owner.CountInv("FloraHellcore100PercentOverheated")) delaycount *= 0.75;
			if (owner.CountInv("FloraHellcore250PercentOverheated")) delaycount *= 0.50;
			if (owner.CountInv("FloraHellcore500PercentOverheated")) delaycount *= 0.25;
			if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Regen [Step ? - Hellcore Heat]: %d\c-, Previous: %d", delaycount, previousdelaycount);
			
			// Stamina Upgrades [Strife]
			previousdelaycount = delaycount;
			SkillFactor = ceil(StrifeStamLvl * 1.6);
			delaycount += SkillFactor;
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth && StrifeStamLvl != 0) Console.Printf("    \caHP Regen [Step 5 - Get Strife Stamina RegenTimer Inc]: %d\c-, Added: %d", delaycount, SkillFactor);
			
			// Accelerates HP Regen when Tension is Boosted
			previousdelaycount = delaycount;
			SkillFactor = 20;
			if (TensionLevel >= 1) SkillFactor += 1; // "5" = +1 [+5%]
			if (TensionLevel >= 2) SkillFactor += 2; // "20" = +3 [+15%]
			if (TensionLevel >= 3) SkillFactor += 2; // "50" = +5 [+25%]
			if (TensionLevel >= 4) SkillFactor += 3; // "100" = +8 [+40%]
			if (TensionLevel >= 5) SkillFactor += 3; // "250" = +11 [+55%]
			if (TensionLevel >= 6) SkillFactor += 4; // "500" = +15 [+75%]
			if (TensionLevel >= 7) SkillFactor += 5; // "500" = +20 [+100%]
			delaycount = floor((delaycount * SkillFactor) / 20);
			if (TensionLevel >= 5 && CallACS("MiscVarCheckDECORATE",184) == 0) delaycount = ceil(delaycount * frandompick[statitem2](1.0,1.0625,1.125,1.1875,1.25)); // +~25%
			if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Regen [Step 6 - Get Tension RegenTimer Inc]: %d\c-, Multiplier: %d / 20", delaycount, SkillFactor);
			
			// Focusing will slightly accelerate HP regeneration on Strife Mode
			previousdelaycount = delaycount;
			SkillFactor = 0;
			double HPFocusMulti = frandompick[statitem](0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.225,0.225,0.225,0.225,0.25,0.25);
			if (Owner.CountInv("DoveRibbon")) HPFocusMulti = ceil(HPFocusMulti * 1.0625);
			int FocusIncrements = 105;
			if (Owner.CountInv("PearlyCorset")) FocusIncrements -= 14;
			if (Owner.CountInv("DoveRibbon")) FocusIncrements -= 21;
			if (IsFocusOn > 0 && StrifeStamLvl > 0)
			{
				if (FocusTimer >= (FocusIncrements * 1) && StrifeStamLvl >= 1) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 0.5));
				if (FocusTimer >= (FocusIncrements * 2) && StrifeStamLvl >= 1) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 1));
				if (FocusTimer >= (FocusIncrements * 3) && StrifeStamLvl >= 2) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 1.5));
				if (FocusTimer >= (FocusIncrements * 4) && StrifeStamLvl >= 2) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 2));
				if (FocusTimer >= (FocusIncrements * 5) && StrifeStamLvl >= 3) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 2.5));
				if (FocusTimer >= (FocusIncrements * 6) && StrifeStamLvl >= 3) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 3));
				if (FocusTimer >= (FocusIncrements * 7) && StrifeStamLvl >= 4) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 3.5));
				if (FocusTimer >= (FocusIncrements * 8) && StrifeStamLvl >= 4) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 4));
				if (FocusTimer >= (FocusIncrements * 9) && StrifeStamLvl >= 5) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 4.5));
				if (FocusTimer >= (FocusIncrements * 10) && StrifeStamLvl >= 5) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 5));
				if (FocusTimer >= (FocusIncrements * 11) && StrifeStamLvl >= 6) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 5.5));
				if (FocusTimer >= (FocusIncrements * 12) && StrifeStamLvl >= 6) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 6));
				if (FocusTimer >= (FocusIncrements * 13) && StrifeStamLvl >= 7) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 6.5));
				if (FocusTimer >= (FocusIncrements * 14) && StrifeStamLvl >= 7) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 7));
				if (FocusTimer >= (FocusIncrements * 15) && StrifeStamLvl >= 8) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 7.5));
				if (FocusTimer >= (FocusIncrements * 16) && StrifeStamLvl >= 8) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 8));
				if (FocusTimer >= (FocusIncrements * 17) && StrifeStamLvl >= 9) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 8.5));
				if (FocusTimer >= (FocusIncrements * 18) && StrifeStamLvl >= 9) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 9));
				if (FocusTimer >= (FocusIncrements * 19) && StrifeStamLvl >= 10) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 9.5));
				if (FocusTimer >= (FocusIncrements * 20) && StrifeStamLvl >= 10) SkillFactor += floor(StrifeStamLvl * (HPFocusMulti * 10));
			}
			delaycount += SkillFactor;
			if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Regen [Step 7 - Get Focus/StrifeStam RegenTimer Inc]: %d\c-, Added: %d, FocusTimer: %d", delaycount, SkillFactor, FocusTimer);
			
			// Check Musou Power Trip Mode
			SkillFactor = delaycount;
			if (dvds_musou_powertripmode == 1) delaycount = floor(delaycount * 2.5); // 250%
			if (dvds_musou_powertripmode == 2) delaycount = floor(delaycount * 5); // 500%
			if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 8 - Get Power Trip Inc]: %d\c-, Previous: %d", delaycount, SkillFactor);

			// Check Movement Inputs
			StaminaInputFactor = 100;
			if (PlayerCurrentHealth < RegenMaxHealth)
			{
				SkillFactor = delaycount;
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1;
				if (SleepTimer > 0) FreezePlayer += 1;
				if (FreezePlayer == 0)
				{
					if (!(Owner.CountInv("ShieldDefense") || Owner.CountInv("ShieldDefense2") || Owner.CountInv("ShieldDefense3")))
					{
						if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) StaminaInputFactor = floor(StaminaInputFactor * 0.4);
						if (buttons & BT_ATTACK || buttons & BT_ALTATTACK) StaminaInputFactor = floor(StaminaInputFactor * 0.5);
						if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) StaminaInputFactor = floor(StaminaInputFactor * 0.6);
						if (owner.player.jumpTics < 0) StaminaInputFactor = floor(StaminaInputFactor * 0.4);
						if (owner.player.jumpTics > 0) StaminaInputFactor = floor(StaminaInputFactor * 0.7);
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StaminaInputFactor = floor(StaminaInputFactor * 1.8);
					}
					else
					{
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StaminaInputFactor = floor(StaminaInputFactor * 1.4);
					}
				}
				delaycount = (delaycount * StaminaInputFactor) / 100;
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 9 - Regen Intervals (\cyInput: %d\ca)]: Interval: %d\c-, Previous: %d, InputFactor: %d / 100, Frozen?: %d", buttons, delaycount, SkillFactor, StaminaInputFactor, FreezePlayer);
				
				// Checks Armor Items and other types for regen speed.
				SkillFactor = delaycount;
				int ArmorFactor = 100;
				if (CharacterClass == 2)
				{
					if (Owner.CountInv("PearlyCorset")) ArmorFactor += 20;
					if (Owner.CountInv("EvenstarNecklace")) ArmorFactor += 10;
					if (Owner.CountInv("AnubisCufflinks")) ArmorFactor += 15;
					if (Owner.CountInv("BalrogRing")) ArmorFactor += 25;
					// total of 70 = 170% speed with all four items
				}
				delaycount = floor((delaycount * ArmorFactor) / 100);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 10 - Regen Intervals (Armor)]: Interval: %d\c-, Previous: %d, ArmorFactor: %d / 100", delaycount, SkillFactor, ArmorFactor);
				
				// Divine Avatar = 200% Total Regeneration Speed
				SkillFactor = delaycount;
				if (DivineAvatarTimer > 0) delaycount = floor(delaycount * 2);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 11a - Regen Intervals (Divine Avatar)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// GoE = 500% Total Regeneration Speed
				SkillFactor = delaycount;
				if (GoETimer > 0) delaycount = floor(delaycount * 5);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 11b - Regen Intervals (GoE)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// Acceleratle = 125% regen speed
				SkillFactor = delaycount;
				if (DQAcceleratleTimer > 0) delaycount = floor(delaycount * 1.25);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 12a - Regen Intervals (Acceleratle)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

				// Deceleratle = 80% regen speed
				SkillFactor = delaycount;
				if (DQDeceleratleTimer > 0) delaycount = floor(delaycount * 0.8);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 12b - Regen Intervals (Deceleratle)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// Poison = random 0.25/0.375.0.5/0.625/0.75x regen speed
				SkillFactor = delaycount;
				if (PoisonedTimer > 0) delaycount = floor((delaycount * (random[statitem](2,6) * 0.125)));
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 13 - Regen Intervals (Poison)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// Fatigue = 0.2x regen speed
				SkillFactor = delaycount;
				if (FatigueTimer > 0) delaycount = floor(delaycount * 0.2);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 14 - Regen Intervals (Fatigue)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// Sleep = x5 regen speed
				SkillFactor = delaycount;
				PerkFactor = 10000;
				if (SleepTimer > 0)
				{
					delaycount = floor(delaycount * 5);
					PerkFactor = ((RegHPFstPerkLvl * 2000) + (RegHPFstEXPerkLvl * 5000)) + 10000;
					delaycount = floor(delaycount * PerkFactor / 10000); // "RegenHPFast" and "RegenHPFast EX" perks.
				}
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 15 - Regen Intervals (Sleep)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 10000", delaycount, SkillFactor, PerkFactor);
				
				// Berserk = +100% Regen
				SkillFactor = delaycount;
				if (BerserkTimer > 0) delaycount = floor(delaycount * 2);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 16 - Regen Intervals (Berserk)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

				// Buff = +50% Regen
				SkillFactor = delaycount;
				if (DQBuffTimer > 0) delaycount = floor(delaycount * 1.5);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 17 - Regen Intervals (Buff)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

				// Flora's Regeneration Speed is reduced by 5/8s [62.5%] when holding the Ruinous Shield [curse effect]
				SkillFactor = delaycount;
				if (CharacterClass == 2 && Owner.CountInv("RuinousShield")) delaycount = floor(delaycount * 0.375);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 18 - Regen Intervals (Ruinous Shield)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// RegenHPFast perks
				SkillFactor = delaycount;
				PerkFactor = 10;
				if (RegHPFstPerkLvl > 0)
				{
					PerkFactor = ((RegHPFstPerkLvl * 2) + (RegHPFstEXPerkLvl * 5)) + 10;
					delaycount = ceil(delaycount * PerkFactor / 10); // "RegenHPFast" and "RegenHPFast EX" perks.
				}
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 19 - Regen Intervals (Regen HP Fast)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 10", delaycount, SkillFactor, PerkFactor);
				
				// "Death Rage" Perk
				SkillFactor = delaycount;
				if (DeathRageTimer > 0)
				{
					if (DeathRageTimer <= 1) delaycount = ceil(delaycount * 2);
					if (DeathRageTimer == 2) delaycount = ceil(delaycount * 4);
					if (DeathRageTimer >= 3) delaycount = ceil(delaycount * 8);
				}
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 20 - Regen Intervals (Death Rage)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				// "Cleared of Mind" Perks
				SkillFactor = delaycount;
				PerkFactor = 80;
				if (ClearMindPerkLvl > 0)
				{
					perkfactor = ((ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5)) + 80;
					delaycount = ceil((delaycount * perkfactor) / 80);
				}
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 21 - Regen Intervals (Cleared of Mind)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 80", delaycount, SkillFactor, PerkFactor);
				
				// If Defending via Fists/PoisonNeedle
				SkillFactor = delaycount;
				PerkFactor = 20;
				if (Owner.CountInv("FistPlayerBlockItem")) PerkFactor = RandomPick[statitem](24,26,26,28,28,28,30,30,30,30,32,32,32,34,34,36);
				delaycount = floor((delaycount * PerkFactor) / 20);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 22 - Regen Intervals (Fist - Defend)]: Interval: %d\c-, Previous: %d, Factor: %d / 20", delaycount, SkillFactor, PerkFactor);
				
				// If Defending via Sceptre Shielding Alt-fire
				SkillFactor = delaycount;
				PerkFactor = 20;
				if (Owner.CountInv("ShieldDefense")) PerkFactor = random[statitem](28,32);
				if (Owner.CountInv("ShieldDefense2")) PerkFactor = random[statitem](34,38);
				if (Owner.CountInv("ShieldDefense3")) PerkFactor = random[statitem](40,44);
				delaycount = floor((delaycount * PerkFactor) / 20);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 23 - Regen Intervals (Sceptre - Defend)]: Interval: %d\c-, Previous: %d, Factor: %d / 20", delaycount, SkillFactor, PerkFactor);

				// Checks Health Regen Rate Menu Option
				SkillFactor = delaycount;
				delaycount = floor((delaycount * dvds_healthregenmultiplier) / 100);
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 24 - Regen Intervals (Menu Option)]: Interval: %d\c-, Previous: %d, Multiplier: %d / 100", delaycount, SkillFactor, dvds_healthregenmultiplier);
				
				// Low Cap to 1 Tics
				if (HPRegenBonPenTimer > 0) delaycount *= HPRegenBonPenMulti;
				if (HPRegenBonPenTimer < 0) delaycount *= (1.0 / HPRegenBonPenMulti);
				SkillFactor = delaycount;
				if (delaycount < 1) delaycount = 1;
				if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step 25 - Regen Intervals (LOWCap)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
				
				if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
				else // If Player is "Conscious", allow their HP regen timer to count
				{
					HPRegenTimer += delaycount;
				}
			}
			else 
			{
				// Reset the Timer
				HPRegenTimer = 20 * random[statitem](-2,2);
			}
			if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step 26 - Regen Intervals (Timers)]: HPRegenTimer %d / %d", HPRegenTimer, HPDelayInterval);

			if (HPRegenTimer >= HPDelayInterval)
			{
				// Base of 1 HP regen
				HPRegenAmount = 1;
				if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step R1 - Regen Amount (Base)]: %d", HPRegenAmount);

				// Every 50 Levels = +1 HP Regen
				SkillFactor = HPRegenAmount;
				HPRegenAmount += floor(PlayerLevel * 0.02);
				if (debugehealthregen && HPRegenAmount != SkillFactor) Console.Printf("    \caHP Regen [Step R2 - Regen Amount (PlayerLevel)]: %d\c-, Previous: %d", HPRegenAmount, SkillFactor);

				// Every 15 Pts of Strength = +1 HP Regen
				SkillFactor = HPRegenAmount;
				HPRegenAmount += floor(PlayerSTR / 15);
				if (debugehealthregen && HPRegenAmount != SkillFactor) Console.Printf("    \caHP Regen [Step R3 - Regen Amount (PlayerSTR)]: %d\c-, Previous: %d", HPRegenAmount, SkillFactor);

				// Makes having the Dove Ribbon allow HP Regen up to 200% maximum
				if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
				if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step R4 - Check Max Health Cap (Dove?)]: %d\c-, Current Health: %d", RegenMaxHealth, PlayerCurrentHealth);

				// Set Health [uptick]
				if (PlayerCurrentHealth > 0)
				{
					PlayerCurrentHealth += HPRegenAmount;
					PlayerCurrentHealth = clamp(PlayerCurrentHealth, PlayerCurrentHealth, RegenMaxHealth);
					owner.player.health = owner.player.mo.health = PlayerCurrentHealth;
					CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
					CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);
					if (debugehealthregen && PlayerCurrentHealth < RegenMaxHealth) Console.Printf("    \caHP Regen [Step R5 - Increment HP]: %d, Current Health: %d / %d", HPRegenAmount, PlayerCurrentHealth, MaxHealthTrue);
				}

				// Reset the Timer
				HPRegenTimer -= HPDelayInterval;
				if (HPRegenTimer < 0) HPRegenTimer = 0;
				HPRegenTimer += (20 * random[statitem](-2,2));
			}
			//****************
			//**Health Degen**
			//****************
			if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
			if (dvds_healthdegenmode == 1 && PlayerCurrentHealth > RegenMaxHealth)
			{
				// Base Character Interval Max
				if (CharacterClass == 0) HPDelayInterval2 = 41; // Deggaris Degenerates the Slowest [1.17 seconds]
				if (CharacterClass == 1) HPDelayInterval2 = 35; // Illucia has an even speed of Degeneration [1 second]
				if (CharacterClass == 2) HPDelayInterval2 = 29; // Flora Degenerates the second fastest [0.83 seconds]
				if (CharacterClass == 8) HPDelayInterval2 = 25; // Ailish Degenerates the fastest
				if (CharacterClass == 9) HPDelayInterval2 = 52; // Petra Degenerates even slower than Deggaris
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 1a - Base Interval Delay]: %d\c-", HPDelayInterval2);
				
				// Level Check [Interval Delay]
				previousdelaycount = HPDelayInterval2;
				if (TrueGameSkill <= SKILL_VERY_EASY) HPDelayInterval2 += 3;
				if (TrueGameSkill == SKILL_EASY) HPDelayInterval2 += 1;
				if (TrueGameSkill == SKILL_NORMAL) HPDelayInterval2 += 0;
				if (TrueGameSkill == SKILL_HARD) HPDelayInterval2 -= 1;
				if (TrueGameSkill == SKILL_VERY_HARD) HPDelayInterval2 -= 3;
				if (TrueGameSkill == SKILL_EXTREME) HPDelayInterval2 -= 4;
				if (TrueGameSkill == SKILL_HORRIBLE) HPDelayInterval2 -= 6;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) HPDelayInterval2 -= 7;
				if (TrueGameSkill >= SKILL_OMEGA) HPDelayInterval2 -= 8;
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth && HPDelayInterval2 != previousdelaycount) Console.Printf("    \caHP Degen [Step 1b - Interval Delay (Difficulty)]: %d\c-, Previous: %d", HPDelayInterval2, previousdelaycount);
				
				// Level
				previousdelaycount = HPDelayInterval2;
				SkillFactor = floor(PlayerLevel * 0.07143); // up to +14
				HPDelayInterval2 += SkillFactor; 
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth && HPDelayInterval2 != previousdelaycount) Console.Printf("    \caHP Degen [Step 1c - Interval Delay (PlayerLevel)]: %d\c-, Previous: %d", HPDelayInterval2, previousdelaycount);

				// Final Interval Calc
				previousdelaycount = HPDelayInterval2;
				HPDelayInterval2 = ceil(HPDelayInterval2 * 20);
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 1d - Interval Delay (Final Calc)]: %d\c-, Previous: %d", HPDelayInterval2, previousdelaycount);

				// Dove Ribbon Health Limit Check
				PlayerCurrentHealth = owner.health;
				if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 2 - Check Max Health Cap (Dove?)]: %d\c-, Current Health: %d", RegenMaxHealth, PlayerCurrentHealth);

				// Base Delay Count
				SkillFactor = 0;
				delaycount = 20;
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 3 - Get Base RegenTimer Increment]: %d\c-", delaycount);
				
				// Character Delay Count
				previousdelaycount = delaycount;
				SkillFactor = 0;
				if (CharacterClass == 0) SkillFactor = floor(PlayerDEF / 16); // 16pts of Defense will increase degen wait by 1 tic each [Deggaris]
				if (CharacterClass == 1) SkillFactor = floor(PlayerDEF / 20); // 20pts of Defense will increase degen wait by 1 tic each [Illucia]
				if (CharacterClass == 2) SkillFactor = floor(PlayerDEF / 24); // 24pts of Defense will increase degen wait by 1 tic each [Flora]
				if (CharacterClass == 8) SkillFactor = floor(PlayerDEF / 24); // 24pts of Defense will increase degen wait by 1 tic each [Ailish]
				if (CharacterClass == 9) SkillFactor = floor(PlayerDEF / 12); // 12pts of Defense will increase degen wait by 1 tic each [Petra]
				delaycount -= SkillFactor;
				if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Degen [Step 4 - Get Character RegenTimer Increment]: %d\c-, Added: %d", delaycount, SkillFactor);
				
			
				// Hellcore Heat
				previousdelaycount = delaycount;
				if (owner.CountInv("FloraHellcoreNotOverheated")) delaycount *= (1.0 / 1.0);
				if (owner.CountInv("FloraHellcore25PercentOverheated")) delaycount *= (1.0 / 0.96875);
				if (owner.CountInv("FloraHellcore50PercentOverheated")) delaycount *= (1.0 / 0.9375);
				if (owner.CountInv("FloraHellcore75PercentOverheated")) delaycount *= (1.0 / 0.875);
				if (owner.CountInv("FloraHellcore100PercentOverheated")) delaycount *= (1.0 / 0.75);
				if (owner.CountInv("FloraHellcore250PercentOverheated")) delaycount *= (1.0 / 0.50);
				if (owner.CountInv("FloraHellcore500PercentOverheated")) delaycount *= (1.0 / 0.25);
				if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Degen [Step ? - Hellcore Heat]: %d\c-, Previous: %d", delaycount, previousdelaycount);

				// Stamina Upgrades [Strife]
				SkillFactor = floor(StrifeStamLvl * 0.625);
				delaycount -= SkillFactor;
				if (debugehealthregen && StrifeStamLvl != 0) Console.Printf("    \caHP Degen [Step 5 - Get Strife Stamina RegenTimer Inc]: %d\c-, Added: %d", delaycount, SkillFactor);

				// Accelerates HP Regen when Tension is Boosted
				SkillFactor = 20;
				previousdelaycount = delaycount;
				if (TensionLevel >= 1) SkillFactor -= 0; // "5" = -0 [-0%]
				if (TensionLevel >= 2) SkillFactor -= 1; // "20" = -1 [-5%]
				if (TensionLevel >= 3) SkillFactor -= 1; // "50" = -2 [-10%]
				if (TensionLevel >= 4) SkillFactor -= 2; // "100" = -3 [-15%]
				if (TensionLevel >= 5) SkillFactor -= 2; // "250" = -5 [-25%]
				if (TensionLevel >= 6) SkillFactor -= 2; // "500" = -7 [-35%]
				if (TensionLevel >= 7) SkillFactor -= 3; // "500" = -10 [-50%]
				delaycount = ceil((delaycount * SkillFactor) / 20);
				if (TensionLevel >= 5 && CallACS("MiscVarCheckDECORATE",184) == 0) delaycount = ceil(delaycount * frandompick[statitem2](1.0,0.95,0.9,0.85,0.8,0.75)); // +~25%
				if (debugehealthregen && delaycount != previousdelaycount) Console.Printf("    \caHP Degen [Step 6 - Get Tension RegenTimer Inc]: %d\c-, Multiplier: %d / 20", delaycount, SkillFactor);
				
				// Check Musou Power Trip Mode
				SkillFactor = delaycount;
				if (dvds_musou_powertripmode == 1) delaycount = ceil(delaycount * 0.4); // 40%
				if (dvds_musou_powertripmode == 2) delaycount = ceil(delaycount * 0.2); // 20%
				if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 7 - Get Power Trip Inc]: %d\c-, Previous: %d", delaycount, SkillFactor);

				// Check Movement Inputs
				StaminaInputFactor = 100;
				if (PlayerCurrentHealth > RegenMaxHealth)
				{
					SkillFactor = delaycount;
					FreezePlayer = 0;
					if (UsingInGameMenu > 0) FreezePlayer += 1;
					if (SleepTimer > 0) FreezePlayer += 1;
					if (FreezePlayer == 0)
					{
						if (!(Owner.CountInv("ShieldDefense") || Owner.CountInv("ShieldDefense2") || Owner.CountInv("ShieldDefense3")))
						{
							if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) StaminaInputFactor = ceil(StaminaInputFactor * 2.5);
							if (buttons & BT_ATTACK || buttons & BT_ALTATTACK) StaminaInputFactor = ceil(StaminaInputFactor * 2);
							if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) StaminaInputFactor = ceil(StaminaInputFactor * 100 / 60);
							if (owner.player.jumpTics < 0) StaminaInputFactor = ceil(StaminaInputFactor * 2.5);
							if (owner.player.jumpTics > 0) StaminaInputFactor = ceil(StaminaInputFactor * 1.75);
							if ((buttons & BT_CROUCH) && sv_allowcrouch) StaminaInputFactor = ceil(StaminaInputFactor * 100 / 180);
						}
						else
						{
							if ((buttons & BT_CROUCH) && sv_allowcrouch) StaminaInputFactor = ceil(StaminaInputFactor * 100 / 140);
						}
					}
					delaycount = ceil((delaycount * StaminaInputFactor) / 100);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 8 - Degen Intervals (\cyInput: %d\ca)]: Interval: %d\c-, Previous: %d, InputFactor: %d / 100, Frozen?: %d", buttons, delaycount, SkillFactor, StaminaInputFactor, FreezePlayer);
					
					// Checks Armor Items and other types for regen speed.
					SkillFactor = delaycount;
					int ArmorFactor = 200;
					if (CharacterClass == 2)
					{
						if (Owner.CountInv("PearlyCorset")) ArmorFactor -= 20;
						if (Owner.CountInv("EvenstarNecklace")) ArmorFactor -= 10;
						if (Owner.CountInv("AnubisCufflinks")) ArmorFactor -= 15;
						if (Owner.CountInv("BalrogRing")) ArmorFactor -= 25;
						// total of 70 = 170% speed with all four items
					}
					delaycount = ceil((delaycount * ArmorFactor) / 200);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 9 - Degen Intervals (Armor)]: Interval: %d\c-, Previous: %d, ArmorFactor: %d / 200", delaycount, SkillFactor, ArmorFactor);
					
					// Divine Avatar = 31.25% Total Degeneration Speed
					SkillFactor = delaycount;
					if (DivineAvatarTimer > 0) delaycount = ceil(delaycount * 0.3125);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Regen [Step 10a - Degen Intervals (Divine Avatar)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// GoE = 12.5% Total Degeneration Speed
					SkillFactor = delaycount;
					if (GoETimer > 0) delaycount = ceil(delaycount * 0.125);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 10b - Degen Intervals (GoE)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// Acceleratle = 125% degen speed
					SkillFactor = delaycount;
					if (DQAcceleratleTimer > 0) delaycount = ceil(delaycount * 1.25);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 11a - Degen Intervals (Acceleratle)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// Deceleratle = 80% degen speed
					SkillFactor = delaycount;
					if (DQDeceleratleTimer > 0) delaycount = floor(delaycount * 0.8);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 11b - Degen Intervals (Deceleratle)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// Poison = random 4.0/2.666~/2/1.6/1.333~x degen speed
					SkillFactor = delaycount;
					if (PoisonedTimer > 0) delaycount = ceil((delaycount * 8) / random[statitem](2,6));
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 12 - Degen Intervals (Poison)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// Fatigue = 5x degen speed
					SkillFactor = delaycount;
					if (FatigueTimer > 0) delaycount = ceil(delaycount * 5);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 13 - Degen Intervals (Fatigue)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// Sleep = x0.2 degen speed
					SkillFactor = delaycount;
					PerkFactor = 10000;
					if (SleepTimer > 0)
					{
						delaycount = ceil(delaycount * 0.2);
						PerkFactor = 10000 - ((RegHPFstPerkLvl * 2000) + (RegHPFstEXPerkLvl * 5000));
						delaycount = ceil(delaycount * PerkFactor / 10000); // "RegenHPFast" and "RegenHPFast EX" perks.
					}
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 14 - Degen Intervals (Sleep)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 10000", delaycount, SkillFactor, PerkFactor);
					
					// Berserk = -50% Degen
					SkillFactor = delaycount;
					if (BerserkTimer > 0) delaycount = floor(delaycount * 0.5);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 15 - Degen Intervals (Berserk)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					

					// Buff = -33% Degen
					SkillFactor = delaycount;
					if (DQBuffTimer > 0) delaycount = floor(delaycount * 0.667);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 16 - Regen Intervals (Buff)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

					// Flora's Degeneration Speed is multiplied by 2.667 when holding the Ruinous Shield [curse effect]
					SkillFactor = delaycount;
					if (CharacterClass == 2 && Owner.CountInv("RuinousShield")) delaycount = ceil(delaycount * 2.667);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 17 - Degen Intervals (Ruinous Shield)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);
					
					// RegenHPFast perks
					SkillFactor = delaycount;
					PerkFactor = 10;
					if (RegHPFstPerkLvl > 0)
					{
						PerkFactor = 10 - ((RegHPFstPerkLvl * 2) + (RegHPFstEXPerkLvl * 5));
						delaycount = floor(delaycount * PerkFactor / 10); // "RegenHPFast" and "RegenHPFast EX" perks.
					}
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 18 - Degen Intervals (Regen HP Fast)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 10", delaycount, SkillFactor, PerkFactor);
					
					// "Death Rage" Perk
					SkillFactor = delaycount;
					if (DeathRageTimer > 0)
					{
						if (DeathRageTimer <= 1) delaycount = floor(delaycount * 0.5);
						if (DeathRageTimer == 2) delaycount = floor(delaycount * 0.25);
						if (DeathRageTimer >= 3) delaycount = floor(delaycount * 0.125);
					}
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 19 - Degen Intervals (Death Rage)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

					// "Cleared of Mind" Perks
					SkillFactor = delaycount;
					PerkFactor = 80;
					if (ClearMindPerkLvl > 0)
					{
						perkfactor = 80 - ((ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5));
						delaycount = floor(delaycount * perkfactor / 80);
					}
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 20 - Degen Intervals (Cleared of Mind)]: Interval: %d\c-, Previous: %d, PerkFactor: %d / 80", delaycount, SkillFactor, PerkFactor);
					
					// If Defending via Fists/PoisonNeedle
					SkillFactor = delaycount;
					PerkFactor = 20;
					if (Owner.CountInv("FistPlayerBlockItem")) PerkFactor = RandomPick[statitem](24,26,26,28,28,28,30,30,30,30,32,32,32,34,34,36);
					delaycount = ceil((delaycount * 20) / PerkFactor);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 21 - Degen Intervals (Fist - Defend)]: Interval: %d\c-, Previous: %d, Factor: 20 / %d", delaycount, SkillFactor, PerkFactor);
					
					// If Defending via Sceptre Shielding Alt-fire
					SkillFactor = delaycount;
					PerkFactor = 20;
					if (Owner.CountInv("ShieldDefense")) PerkFactor = random[statitem](28,32);
					if (Owner.CountInv("ShieldDefense2")) PerkFactor = random[statitem](34,38);
					if (Owner.CountInv("ShieldDefense3")) PerkFactor = random[statitem](40,44);
					delaycount = ceil((delaycount * 20) / PerkFactor);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 22 - Degen Intervals (Sceptre - Defend)]: Interval: %d\c-, Previous: %d, Factor: %d / 20", delaycount, SkillFactor, PerkFactor);

					// Checks Health Regen Rate Menu Option
					SkillFactor = delaycount;
					delaycount = ceil(delaycount * dvds_healthdegenmultiplier / 100);
					if (debugehealthregen && delaycount != SkillFactor) Console.Printf("    \caHP Degen [Step 23 - Degen Intervals (Menu Option)]: Interval: %d\c-, Previous: %d, Multiplier: %d / 100", delaycount, SkillFactor, dvds_healthdegenmultiplier);
					
					// Low Cap to 1 Tics
					if (HPRegenBonPenTimer > 0) delaycount *= (1.0 / HPRegenBonPenMulti);
					if (HPRegenBonPenTimer < 0) delaycount *= HPRegenBonPenMulti;
					SkillFactor = delaycount;
					if (delaycount < 1) delaycount = 1;
					if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 24 - Degen Intervals (LOWCap)]: Interval: %d\c-, Previous: %d", delaycount, SkillFactor);

					if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
					else // If Player is "Conscious", allow their HP degen timer to count
					{
						HPDegenTimer += delaycount;
					}
				}
				else 
				{
					// Reset the Timer
					HPDegenTimer = 20 * random[statitem](-2,2);
				}
				if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step 25 - Degen Intervals (Timers)]: HPDegenTimer %d / %d", HPDegenTimer, HPDelayInterval2);

				if (HPDegenTimer >= HPDelayInterval2)
				{
					// Base of 1 HP Degen
					HPDegenAmount = 1;
					if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Regen [Step D1 - Degen Amount (Base)]: %d", HPDegenAmount);

					// Makes having the Dove Ribbon allow HP Regen up to 200% maximum
					if (CharacterClass == 2 && Owner.CountInv("DoveRibbon")) RegenMaxHealth = MaxHealthLimit; else RegenMaxHealth = MaxHealthTrue;
					if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step D2 - Check Max Health Cap (Dove?)]: %d\c-, Current Health: %d", RegenMaxHealth, PlayerCurrentHealth);

					// Set Health [uptick]
					if (PlayerCurrentHealth > 0)
					{
						PlayerCurrentHealth -= HPDegenAmount;
						PlayerCurrentHealth = clamp(PlayerCurrentHealth, RegenMaxHealth, PlayerCurrentHealth);
						owner.player.health = owner.player.mo.health = PlayerCurrentHealth;
						CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
						CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);
						if (debugehealthregen && PlayerCurrentHealth > RegenMaxHealth) Console.Printf("    \caHP Degen [Step D3 - Decrement HP]: %d, Current Health: %d / %d", HPDegenAmount, PlayerCurrentHealth, MaxHealthTrue);
					}

					// Reset the Timer
					HPDegenTimer -= HPDelayInterval2;
					if (HPDegenTimer < 0) HPDegenTimer = 0;
					HPDegenTimer += (20 * random[statitem](-2,2));
				}
			}
			
			
			//****************
			//*POISON AILMENT*
			//****************
			// Base Max Increment
			int debugpoison = dvdsdebug_poisonailmentdisplays;
			PoisonMaxInterval = 12;
			if (CharacterClass == 0) PoisonMaxInterval = floor(21 + (PlayerDEF * 0.21) + (PlayerSTR * 0.105));
			if (CharacterClass == 1) PoisonMaxInterval = floor(24 + (PlayerDEF * 0.24) + (PlayerSTR * 0.12));
			if (CharacterClass == 2) PoisonMaxInterval = floor(12 + (PlayerDEF * 0.12) + (PlayerSTR * 0.06));
			if (CharacterClass == 8) PoisonMaxInterval = floor(15 + (PlayerDEF * 0.15) + (PlayerSTR * 0.075));
			if (CharacterClass == 9) PoisonMaxInterval = floor(27 + (PlayerDEF * 0.27) + (PlayerSTR * 0.135));
			PoisonMaxInterval = floor(PoisonMaxInterval * 20);
			if (debugpoison) Console.Printf("    \cuPoison Damage [Step 1 - Max Interval Base]: %d\c-, DEF: %d, STR: %d", PoisonMaxInterval, PlayerDEF, PlayerSTR);

			// Difficulty Level
			previousdelaycount = PoisonMaxInterval;
			PoisonMaxInterval = floor(PoisonMaxInterval * (2.2 - (TrueGameSkill * 0.1)));
			if (debugpoison && PoisonMaxInterval != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 2 - Max Interval (Difficulty)]: %d\c-, Previous: %d", PoisonMaxInterval, previousdelaycount);

			// Check for Poison [-Invuln]
			if (PoisonedTimer > 0 && InvulnerabilityTimer == 0) // Being invulnerable will prevent poison damage from occuring.
			{
				// Base Increment
				PoisonIncrement = 18;
				if (CharacterClass == 0) PoisonIncrement = 16;
				if (CharacterClass == 1) PoisonIncrement = 14;
				if (CharacterClass == 2) PoisonIncrement = 18;
				if (CharacterClass == 8) PoisonIncrement = 10;
				if (CharacterClass == 9) PoisonIncrement = 8;
				previousdelaycount = PoisonIncrement;
				PoisonIncrement += ceil((PlayerDEF * (0.01 * PoisonIncrement)) + (PlayerSTR * (0.005 * PoisonIncrement)));
				if (debugpoison) Console.Printf("    \cuPoison Damage [Step 3 - Count Interval Base]: %d (%d)\c-", PoisonIncrement, previousdelaycount);
				
				// Input Alterations
				previousdelaycount = PoisonIncrement;
				SkillFactor = 100;
				if (UsingInGameMenu > 0) FreezePlayer += 1;
				if (SleepTimer > 0) FreezePlayer += 1;
				if (FreezePlayer == 0)
				{
					if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) SkillFactor = ceil(SkillFactor * 1.25);
					if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) SkillFactor = ceil(SkillFactor * 1.125);
					if ((buttons & BT_JUMP) && sv_allowjump) SkillFactor = ceil(SkillFactor * 1.25);
					if ((buttons & BT_CROUCH) && sv_allowcrouch) SkillFactor = ceil(SkillFactor * 0.75);
					PoisonIncrement = ceil((PoisonIncrement * SkillFactor) / 100);
				}
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 4 - Count Interval (\cyInput: %d\cu)]: %d\c-, Previous: %d, InputFactor: %d / 100, Frozen?: %d", buttons, PoisonIncrement, previousdelaycount, SkillFactor, FreezePlayer);
				
				// Check Characters & Armor
				previousdelaycount = PoisonIncrement;
				if (CharacterClass == 2)
				{
					SkillFactor = 1000;
					if (Owner.CountInv("PearlyCorset")) SkillFactor -= 83;
					if (Owner.CountInv("DoveRibbon")) SkillFactor -= 334;
					if (Owner.CountInv("DivineShield")) SkillFactor -= 83;
					PoisonIncrement = ceil((PoisonIncrement * SkillFactor) / 1000);
					if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 4 - Count Interval (Armor, Flora)]: %d\c-, Previous: %d, InputFactor: %d / 1000", PoisonIncrement, previousdelaycount, SkillFactor);
				}
				else
				if (CharacterClass == 0 || CharacterClass == 1)
				{
					SkillFactor = 100;
					if (Owner.CountInv("DSGreenArmorClass")) SkillFactor -= 4; // (-4% for Green Armor)
					if (Owner.CountInv("DSBlueArmorClass")) SkillFactor -= 8; // (-8% for Blue Armor)
					if (Owner.CountInv("DSStoneArmorClass1")) SkillFactor -= 10; // (-10% for Stone Armor 1)
					if (Owner.CountInv("DSDiamondArmorClass1")) SkillFactor -= 14; // (-14% for Diamond Armor 1)
					if (Owner.CountInv("DSStoneArmorClass2")) SkillFactor -= 12; // (-12% for Stone Armor 2)
					if (Owner.CountInv("DSDiamondArmorClass2")) SkillFactor -= 16; // (-16% for Diamond Armor 2)
					PoisonIncrement = ceil((PoisonIncrement * SkillFactor) / 100);
					if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 4 - Count Interval (Armor, Marines)]: %d\c-, Previous: %d, InputFactor: %d / 100", PoisonIncrement, previousdelaycount, SkillFactor);
				}
				
				// Buffs
				previousdelaycount = PoisonIncrement;
				if (DQAcceleratleTimer > 0) PoisonIncrement = ceil(PoisonIncrement * 1.25); // Acceleratle = 125% Speed
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 5a - Count Interval (Acceleratle)]: %d\c-, Previous: %d", PoisonIncrement, previousdelaycount);
				
				previousdelaycount = PoisonIncrement;
				if (DQDeceleratleTimer > 0) PoisonIncrement = ceil(PoisonIncrement * 0.8); // Deceleratle = 80% Speed
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 5b - Count Interval (Deceleratle)]: %d\c-, Previous: %d", PoisonIncrement, previousdelaycount);
				
				previousdelaycount = PoisonIncrement;
				if (FatigueTimer > 0) PoisonIncrement = ceil(PoisonIncrement * 1.8); // Fatigue = 180% Speed
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 6 - Count Interval (Fatigue)]: %d\c-, Previous: %d", PoisonIncrement, previousdelaycount);
				
				previousdelaycount = PoisonIncrement;
				if (SleepTimer > 0) PoisonIncrement = ceil(PoisonIncrement * 0.2); // Sleep = 20% Speed
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 7 - Count Interval (Sleep)]: %d\c-, Previous: %d", PoisonIncrement, previousdelaycount);
				
				previousdelaycount = PoisonIncrement;
				if (BerserkTimer > 0) PoisonIncrement = ceil(PoisonIncrement * 2.25); // Berserk = 225% Speed
				if (debugpoison && PoisonIncrement != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 8 - Count Interval (Berserk)]: %d\c-, Previous: %d", PoisonIncrement, previousdelaycount);
				
				PoisonTimer += PoisonIncrement;
				if (debugpoison) Console.Printf("    \cuPoison Damage [Step 9 - Timer]: %d / %d\c-, Increment: %d", PoisonTimer, PoisonMaxInterval, PoisonIncrement);

				if (HPRegenBonPenTimer > 0) PoisonIncrement *= (1.0 / HPRegenBonPenMulti);
				if (HPRegenBonPenTimer < 0) PoisonIncrement *= HPRegenBonPenMulti;

				// Poison Damage
				if (PoisonTimer >= PoisonMaxInterval)
				{
					PoisonHealth = PlayerCurrentHealth;
					PoisonHealthThreshold = ceil(MaxHealthTrue * (0.03 - (TrueGameSkill * 0.025)));
					if (PoisonHealthThreshold < 1) PoisonHealthThreshold = 1;
					if (debugpoison) Console.Printf("    \cuPoison Damage [Step 9 - Get Poison LowCap]: %d\c-, Health: %d", PoisonHealthThreshold, PoisonHealth);
					if (PoisonHealth > PoisonHealthThreshold)
					{
						PoisonDmg = ceil(MaxHealthTrue * (0.005 + (TrueGameSkill * 0.00125)));
						
						if (random[statitem](1,16) > 1 && PoisonDmg < 1) PoisonDmg = 1;
						if (debugpoison) Console.Printf("    \cuPoison Damage [Step 10 - Base Poison Dmg]: %d\c-", PoisonDmg);

						if (PoisonDmg > 0)
						{
							previousdelaycount = PoisonDmg;
							if (random[statitem](1,8) == 8)
							{
								if (random[statitem](1,8) == 8) PoisonDmg = ceil(PoisonDmg * 3); else PoisonDmg = ceil(PoisonDmg * 2);
							}
							if (debugpoison && PoisonDmg != previousdelaycount) Console.Printf("    \cuPoison Damage [Step 11 - Random 2/3x Multi]: %d\c-, Previous: %d", PoisonDmg, previousdelaycount);
							
							// Flash Screen and Deal damage
							int PoisonFlash = random[statitem](1,5);
							string PoisonFlashClr = "00 DF 00";
							if (PoisonFlash == 1) PoisonFlashClr = "00 BF 00";
							if (PoisonFlash == 2) PoisonFlashClr = "00 CF 00";
							if (PoisonFlash == 3) PoisonFlashClr = "00 DF 00";
							if (PoisonFlash == 4) PoisonFlashClr = "00 EF 00";
							if (PoisonFlash == 5) PoisonFlashClr = "00 FF 00";
							owner.A_SetBlend(PoisonFlashClr,0.125,17);
							PoisonHealth -= PoisonDmg;
							if (PoisonHealth < PoisonHealthThreshold) PoisonHealth = PoisonHealthThreshold;
							owner.player.health = owner.player.mo.health = PoisonHealth;
							PlayerCurrentHealth = owner.player.health;
							if (debugpoison) Console.Printf("    \cuPoison Damage [Step 12 - Deal Damage]: Health %d\c-, Damage Dealt: %d", PoisonHealth, PoisonDmg);
							if ((dvds_showdamagemessages & 1) && PoisonDmg) 
							{
								string PoisonDmgMessage = "";
								PoisonDmgMessage.AppendFormat(" * \cy%d\c- damage dealt to \cx%s\c- from \c[green]Poison!\c-", PoisonDmg, ownername);
								if (dvds_showdamagemessagedebug) PoisonDmgMessage.AppendFormat(" (%d)", gametic);
								Console.Printf("%s", PoisonDmgMessage);
							}
							
							// Pain Sounds
							PoisonHits++;
							if (debugpoison) Console.Printf("    \cuPoison Damage [Step 13 - Hit Count], Hits: %d", PoisonHits);
							if (PoisonHits >= 3)
							{
								PoisonHits = 0;
								if (random[statitem](1,16) == 16)
								{
									if (debugpoison) Console.Printf("    \cyPoison Damage [Step 14 - Play Voice]", PoisonHits);
									owner.A_StopSound(CHAN_VOICE);
									if (CharacterClass == 9)
									{
										if (HealthRatio >= 667) owner.A_StartSound("PetraPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); 
										else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("PetraPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										else if (HealthRatio < 334 && PoisonHealth > 0) owner.A_StartSound("PetraPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
									}
									else
									if (CharacterClass == 8)
									{
										if (HealthRatio >= 667) owner.A_StartSound("AilishPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); 
										else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("AilishPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										else if (HealthRatio < 334 && PoisonHealth > 0) owner.A_StartSound("AilishPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
									}
									else
									if (CharacterClass == 2)
									{
										if (HealthRatio >= 667) owner.A_StartSound("FloraPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("FloraPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										else if (HealthRatio < 334 && PoisonHealth > 0) owner.A_StartSound("FloraPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
									}
									else
									if (CharacterClass == 1)
									{
										if (PoisonHealth > 0) owner.A_StartSound("illucia/pain",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
									}
									else
									if (CharacterClass == 0)
									{
										if (PoisonHealth > 0) owner.A_StartSound("deggaris/pain",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
									}
								}
							}
						}
						else
						{
							if (debugpoison) Console.Printf("    \cyPoison Damage [Step 11x - No Damage Dealt]");
						}
					}
					
					PoisonTimer -= PoisonMaxInterval;
					if (PoisonTimer < 0) PoisonTimer = 0;
				}
			}
			else
			{
				PoisonDmg = 0;
				PoisonTimer = 0;
				PoisonHits = 0;
			}
			
			
			//*********************
			//**Magic Regen/Degen**
			//*********************
			// Base Delay Count
			int debugmanaregen = dvdsdebug_showmanaregenstuff;
			if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
			else // If Player is "Conscious", allow their MP regen timer to count
			{
				if (CurrentMana < MaxMana)
				{
					delaycount = 20;
					if (debugmanaregen) Console.Printf("    \cnMP Regen [Step 1 - Base Count]: %d\c-", delaycount);
					
					// Sceptre Shielding
					if (Owner.CountInv("UsingSceptreAltFire"))
					{
						previousdelaycount = delaycount;
						delaycount *= (1.0 + ((CallACS("OtherVarCheckDECORATE",11) - 1) * frandompick[statitem](0,0.003125,0.00625,0.009375,0.0125)));
						if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 2 - Sceptre Alt-Fire]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					}

					// Stamina Upgrades [Strife]
					previousdelaycount = delaycount;
					SkillFactor = floor(StrifeStamLvl * 0.667);
					delaycount += SkillFactor;
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 3 - Strife - Stamina Upgrade]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					// Accelerates MP Regen when Tension is Boosted
					previousdelaycount = delaycount;
					if (TensionLevel >= 1) delaycount += 1; // "5" = +1 [+5%]
					if (TensionLevel >= 2) delaycount += 2; // "20" = +3 [+15%]
					if (TensionLevel >= 3) delaycount += 2; // "50" = +5 [+25%]
					if (TensionLevel >= 4) delaycount += 3; // "100" = +8 [+40%]
					if (TensionLevel >= 5) delaycount += 3; // "250" = +11 [+55%]
					if (TensionLevel >= 6) delaycount += 4; // "500" = +15 [+75%]
					if (TensionLevel >= 7) delaycount += 5; // "1000" = +20 [+100%]
					if (TensionLevel >= 5 && CallACS("MiscVarCheckDECORATE",184) == 0) delaycount = floor(delaycount * frandompick[statitem2](1.0,1.05,1.1,1.15,1.2,1.25)); // +~25%
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 4 - Tension]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					// PowerTrip Mode
					previousdelaycount = delaycount;
					if (dvds_musou_powertripmode == 1) delaycount = floor(delaycount * 2.5); // 250%
					if (dvds_musou_powertripmode == 2) delaycount = floor(delaycount * 5.0); // 500%
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 5 - Musou/Power Trip Mode]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (DQAcceleratleTimer > 0) delaycount = floor(delaycount * 1.25); // Acceleratle = 1.25x regen speed
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 6a - Acceleratle]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (DQDeceleratleTimer > 0) delaycount = floor(delaycount * 0.8); // Deceleratle = 0.8x regen speed
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 6b - Deceleratle]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (FatigueTimer > 0) delaycount = floor(delaycount * 0.2); // Fatigue = 0.2x regen speed
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 7 - Fatigue]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (GoETimer > 0) delaycount = floor(delaycount * 5); // GoE 5x regen speed
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 8a - GoE]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (DivineAvatarTimer > 0) delaycount = floor(delaycount * 1.125); // Divine Avatar = 1.125x regen speed
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 8b - Divine Avatar]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					previousdelaycount = delaycount;
					if (SleepTimer > 0)
					{
						delaycount *= 5; // Sleep = 5x regen speed
						PerkFactor = ceil(((RegMPFstPerkLvl * 2000) + (RegMPFstEXPerkLvl * 5000)) + 10000);
						delaycount = floor(delaycount * PerkFactor / 10000); // "RegenMPFast" and "RegenMPFast EX" perks.
					}
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 9 - Sleep]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					// Ruinous Shield - greatly reduces MP regeneration speed
					previousdelaycount = delaycount;
					if (CharacterClass == 2 && Owner.CountInv("RuinousShield")) delaycount = floor(delaycount * 0.375); // 37.5%
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 10a - Ruinous Shield]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					// Other Armor Items of Flora's/etc
					previousdelaycount = delaycount;
					PerkFactor2 = 1.0;
					if (CharacterClass == 2)
					{
						if (Owner.CountInv("EvenstarNecklace")) PerkFactor2 += 0.0334;
						if (Owner.CountInv("AnubisCufflinks")) PerkFactor2 += 0.0334;
						if (Owner.CountInv("BalrogRing")) PerkFactor2 += 0.0334;
					}
					else
					if (CharacterClass == 0 || CharacterClass == 1)
					{
						if (CurrentArmorClass == 1) PerkFactor2 -= 0.015;
						if (CurrentArmorClass == 2) PerkFactor2 += 0.015;
						if (CurrentArmorClass == 3) PerkFactor2 += 0.0375;
						if (CurrentArmorClass == 4) PerkFactor2 += 0.075;
						if (CurrentArmorClass == 5) PerkFactor2 += 0.05625;
						if (CurrentArmorClass == 6) PerkFactor2 += 0.150;
					}
					delaycount *= PerkFactor2;
					if (debugmanaregen) Console.Printf("    \cnMP Regen [Step 10b - Armor Items]: %d\c-, Previous: %d, PerkFactor2: %4f", delaycount, previousdelaycount, PerkFactor2);

					// RegenMPFast perks
					previousdelaycount = delaycount;
					perkfactor = 10;
					if (RegMPFstPerkLvl > 0)
					{
						PerkFactor = 10 + ((RegMPFstPerkLvl * 2) + (RegMPFstEXPerkLvl * 5));
						delaycount = ceil(delaycount * PerkFactor / 10); // "RegenMPFast" and "RegenMPFast EX" perks.
					}
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 11 - Regen MP Fast]: %d\c-, Previous: %d, Factor: %d / 10", delaycount, previousdelaycount, PerkFactor);
					
					// "Cleared of Mind" Perks
					previousdelaycount = delaycount;
					perkfactor = 80;
					if (ClearMindPerkLvl > 0)
					{
						perkfactor = 80 + ((ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5));
						delaycount = ceil(delaycount * perkfactor / 80);
					}
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 12 - Cleared of Mind]: %d\c-, Previous: %d, Factor: %d / 80", delaycount, previousdelaycount, PerkFactor);
					
					// Checks Mana Regen Rate Menu Option
					previousdelaycount = delaycount;
					delaycount = floor(delaycount * dvds_manaregenratemultiplier / 100);
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 13 - RegenMultiplier]: %d\c-, Previous: %d, Multiplier: %d%", delaycount, previousdelaycount, dvds_manaregenratemultiplier);
					
					// Focusing
					int FocusIncrements = 35;
					if (Owner.CountInv("EvenstarNecklace")) FocusIncrements -= 3;
					if (Owner.CountInv("AnubisCufflinks")) FocusIncrements -= 1;
					if (Owner.CountInv("BalrogRing")) FocusIncrements -= 2;
					previousdelaycount = delaycount;
					if (IsFocusOn > 0)
					{
						// Slowly increases the speed of regen as focus lasts longer
						if (FocusTimer >= (FocusIncrements * 4)) delaycount += 1; // [4 seconds]
						if (FocusTimer >= (FocusIncrements * 7)) delaycount += 1; // [7 seconds]
						if (FocusTimer >= (FocusIncrements * 10)) delaycount += 2; // [10 seconds]
						if (FocusTimer >= (FocusIncrements * 14)) delaycount += 2; // [14 seconds]
						if (FocusTimer >= (FocusIncrements * 18)) delaycount += 3; // [18 seconds]
						if (FocusTimer >= (FocusIncrements * 22)) delaycount += 3; // [22 seconds]
						if (FocusTimer >= (FocusIncrements * 28)) delaycount += 4; // [28 seconds]
						if (FocusTimer >= (FocusIncrements * 34)) delaycount += 4; // [34 seconds]
						if (FocusTimer >= (FocusIncrements * 42)) delaycount += 5; // [42 seconds]
						if (FocusTimer >= (FocusIncrements * 50)) delaycount += 5; // [50 seconds]
						if (FocusTimer >= (FocusIncrements * 60)) delaycount += 6; // [60 seconds]
						if (FocusTimer >= (FocusIncrements * 70)) delaycount += 6; // [70 seconds]
						if (FocusTimer >= (FocusIncrements * 82)) delaycount += 7; // [82 seconds]
						if (FocusTimer >= (FocusIncrements * 94)) delaycount += 7; // [94 seconds]
						if (FocusTimer >= (FocusIncrements * 108)) delaycount += 8; // [108 seconds]
						if (FocusTimer >= (FocusIncrements * 122)) delaycount += 8; // [122 seconds]
						if (FocusTimer >= (FocusIncrements * 60)) delaycount = floor(delaycount * 1.5); // [60 seconds]
						if (FocusTimer >= (FocusIncrements * 120)) delaycount = floor(delaycount * 1.5); // [120 seconds]
						if (FocusTimer >= (FocusIncrements * 180)) delaycount = floor(delaycount * 1.5); // [180 seconds]
						if (FocusTimer >= (FocusIncrements * 240)) delaycount = floor(delaycount * 1.5); // [240 seconds]
					
						if (StrifeStamLvl > 0)
						{
							if (FocusTimer >= (FocusIncrements * 10)) delaycount += floor(StrifeStamLvl * 0.25); // [10 Seconds]
							if (FocusTimer >= (FocusIncrements * 20) && StrifeStamLvl >= 2) delaycount += floor(StrifeStamLvl * 0.25); // [20 Seconds]
							if (FocusTimer >= (FocusIncrements * 30) && StrifeStamLvl >= 4) delaycount += floor(StrifeStamLvl * 0.33334); // [30 Seconds]
							if (FocusTimer >= (FocusIncrements * 40) && StrifeStamLvl >= 6) delaycount += floor(StrifeStamLvl * 0.33334); // [40 Seconds]
							if (FocusTimer >= (FocusIncrements * 50) && StrifeStamLvl >= 8) delaycount += floor(StrifeStamLvl * 0.5); // [50 Seconds]
							if (FocusTimer >= (FocusIncrements * 60) && StrifeStamLvl >= 10) delaycount += floor(StrifeStamLvl * 0.5); // [60 Seconds]
						}
					
						if (random[statitem](1,25) == 1) delaycount = floor(delaycount * 8); else delaycount  = floor(delaycount * 4);
					
						FocusHumTimer = FocusTimer % 25;
						if (FocusTimer >= (FocusIncrements * 4)) FocusHumTimer = FocusTimer % 24;
						if (FocusTimer >= (FocusIncrements * 7)) FocusHumTimer = FocusTimer % 23;
						if (FocusTimer >= (FocusIncrements * 9)) FocusHumTimer = FocusTimer % 22;
						if (FocusTimer >= (FocusIncrements * 10)) FocusHumTimer = FocusTimer % 21;
						if (FocusTimer >= (FocusIncrements * 14)) FocusHumTimer = FocusTimer % 19;
						if (FocusTimer >= (FocusIncrements * 18)) FocusHumTimer = FocusTimer % 17;
						if (FocusTimer >= (FocusIncrements * 26)) FocusHumTimer = FocusTimer % 15;
						if (FocusTimer >= (FocusIncrements * 60)) FocusHumTimer = FocusTimer % 12;
					
						if (FocusHumTimer == 1) owner.A_StartSound("focushum",7,CHANF_DEFAULT,1.125);
					}
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 14 - Focusing]: %d\c-, Previous: %d, FocusHumTimer: %d, FocusTimer: %d", delaycount, previousdelaycount, FocusHumTimer, FocusTimer);
					
					// Weapons
					previousdelaycount = delaycount;
					If (weapon is "SapphireWandNew")
					{
						if (WandMasteryPerkLevel <= 0) delaycount = floor(delaycount * 1.05);
						if (WandMasteryPerkLevel == 1) delaycount = floor(delaycount * 1.25);
						if (WandMasteryPerkLevel == 2) delaycount = floor(delaycount * 1.45);
						if (WandMasteryPerkLevel == 3) delaycount = floor(delaycount * 1.65);
						if (WandMasteryPerkLevel == 4) delaycount = floor(delaycount * 1.85);
						if (WandMasteryPerkLevel >= 5) delaycount = floor(delaycount * 2.05);
					}
					If (weapon is "DualSapphireWandsNew")
					{
						if (WandMasteryPerkLevel <= 0) delaycount = floor(delaycount * 1.10);
						if (WandMasteryPerkLevel == 1) delaycount = floor(delaycount * 1.50);
						if (WandMasteryPerkLevel == 2) delaycount = floor(delaycount * 1.90);
						if (WandMasteryPerkLevel == 3) delaycount = floor(delaycount * 2.30);
						if (WandMasteryPerkLevel == 4) delaycount = floor(delaycount * 2.70);
						if (WandMasteryPerkLevel >= 5) delaycount = floor(delaycount * 3.10);
					}
					if (debugmanaregen && delaycount != previousdelaycount) Console.Printf("    \cnMP Regen [Step 15 - Weapon Checking]: %d\c-, Previous: %d", delaycount, previousdelaycount);
					
					// Final Checks
					if (MPRegenBonPenTimer > 0) delaycount *= MPRegenBonPenMulti;
					if (MPRegenBonPenTimer < 0) delaycount *= (1.0 / MPRegenBonPenMulti);
					previousdelaycount = delaycount;
					if (delaycount < 1) delaycount = 1;
					// If Player is "Conscious" and Mana is below Max
					MPRegenTimer += delaycount;
					if (debugmanaregen) Console.Printf("    \cnMP Regen [Step 16 - Timer Check]: %d / %d\c-, delaycount: %d, Previous: %d", MPRegenTimer, MPDelayInterval, delaycount, previousdelaycount);
				}
				else
				{
					delaycount = 0;
					if (debugmanaregen) Console.Printf("    \cjMP Neutral\c-: %d / %d", CurrentMana, MaxMana);
				}
			}
			
			RegenedMana = 0;
			if (MPRegenTimer >= MPDelayInterval)
			{
				if (CurrentMana < MaxMana && PlayerCurrentHealth > 0)
				{
					// A combined total of 12-20 points of Sorcery/Theraphesuis are needed for an extra point of MP regen.
					regenedmanabasereq = floor(dvds_regenmanabasestatreq * (0.75 + (TrueGameSkill * 0.125)));
					if (TrueGameSkill <= SKILL_VERY_EASY) RegenedMana = 2;
					if (TrueGameSkill == SKILL_EASY) RegenedMana = randompick[statitem](1,2,2,2);
					if (TrueGameSkill == SKILL_NORMAL) RegenedMana = randompick[statitem](1,2);
					if (TrueGameSkill == SKILL_HARD) RegenedMana = randompick[statitem](1,1,1,2);
					if (TrueGameSkill >= SKILL_VERY_HARD) RegenedMana = 1;
					RegenedMana += floor((PlayerSOR + PlayerTHE) / regenedmanabasereq);
				}
				if (debugmanaregen) Console.Printf("    \cnMP Regen [Step x1 - Base Regen Amount]: %d\c-, Required (SOR+THE) Pts: %d", RegenedMana, regenedmanabasereq);

				previousdelaycount = RegenedMana;
				if (DivineAvatarTimer > 0) // Divine Avatar
				{
					SkillFactor = floor(PlayerLevel * 0.1);
					RegenedMana += SkillFactor;
					if (random[statitem](0,100) < 26)
					{
						RegenedMana = floor(RegenedMana * 1.25);
					}
					else
					{
						if (random[statitem](0,100) < 51)
						{
							RegenedMana = floor(RegenedMana * 1.125);
						}
					}
				}
				else
				{
					SkillFactor = floor(PlayerLevel * 0.04);
					RegenedMana += SkillFactor;
					if (random[statitem](0,100) < 26)
					{
						RegenedMana = floor(RegenedMana * 1.0625);
					}
					else
					{
						if (random[statitem](0,100) < 51)
						{
							RegenedMana = floor(RegenedMana * 1.03125);
						}
					}
				}
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x2 - Divine Avatar Check]: %d\c-, Previous: %d, Added: %d", RegenedMana, previousdelaycount, SkillFactor);
	
				// Character-Based regen factors
				previousdelaycount = RegenedMana;
				if (CharacterClass == 0) RegenedMana = floor(RegenedMana * (random[statitem](15,17) * 0.0625)); // Deggaris (93.75% - 106.25%)
				if (CharacterClass == 1) RegenedMana = floor(RegenedMana * (random[statitem](19,21) * 0.0625)); // Illucia (118.75% - 131.25%)
				if (CharacterClass == 2) RegenedMana = floor(RegenedMana * (random[statitem](23,25) * 0.0625)); // Flora (143.75% - 156.25%)
				if (CharacterClass == 8) RegenedMana = floor(RegenedMana * (random[statitem](23,25) * 0.0625)); // Ailish (143.75% - 156.25%)
				if (CharacterClass == 9) RegenedMana = floor(RegenedMana * (random[statitem](17,19) * 0.0625)); // Petra (106.25% - 118.75%)
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x3 - Character Check]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
	
				// Sauron's Helmet
				previousdelaycount = RegenedMana;
				if (Owner.CountInv("SauronHelmet"))
				{
					if (CharacterClass == 0) RegenedMana = floor(RegenedMana * 1.375); // Deggaris w/ Helmet (137.5%)
					if (CharacterClass == 1) RegenedMana = floor(RegenedMana * 1.25); // Illucia w/ Helmet (125%)
					if (CharacterClass == 2) RegenedMana = floor(RegenedMana * 1.125); // Flora w/ Helmet (112.5%)
					if (CharacterClass == 8) RegenedMana = floor(RegenedMana * 1.125); // Flora w/ Helmet (112.5%)
					if (CharacterClass == 9) RegenedMana = floor(RegenedMana * 1.5); // Petra w/ Helmet (150%)
					if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x4a - Sauron's Helmet]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
				}

				// Sauron's Gauntlets
				previousdelaycount = RegenedMana;
				if (Owner.CountInv("SauronGauntletsItem"))
				{
					if (CharacterClass == 0) RegenedMana = floor(RegenedMana * 1.25); // Deggaris w/ Gauntlets (125%)
					if (CharacterClass == 1) RegenedMana = floor(RegenedMana * 1.25); // Illucia w/ Gauntlets (125%)
					if (CharacterClass == 2) RegenedMana = floor(RegenedMana * 1.25); // Flora w/ Gauntlets (125%)
					if (CharacterClass == 8) RegenedMana = floor(RegenedMana * 1.25); // Ailish w/ Gauntlets (125%)
					if (CharacterClass == 9) RegenedMana = floor(RegenedMana * 1.25); // Petra w/ Gauntlets (125%)
					if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x4b - Sauron's Gauntlets]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
				}

				// The One Ring
				previousdelaycount = RegenedMana;
				if (Owner.CountInv("TheOneRing"))
				{
					if (CharacterClass == 0) RegenedMana = floor(RegenedMana * 0.625); // Deggaris w/ Ring (62.5%)
					if (CharacterClass == 1) RegenedMana = floor(RegenedMana * 0.75); // Illucia w/ Ring (75%)
					if (CharacterClass == 2) RegenedMana = floor(RegenedMana * 0.875); // Flora w/ Ring (87.5%)
					if (CharacterClass == 8) RegenedMana = floor(RegenedMana * 0.875); // Ailish w/ Ring (87.5%)
					if (CharacterClass == 9) RegenedMana = floor(RegenedMana * 0.625); // Petra w/ Ring (62.5%)
					if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x4c - The One Ring]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
				}

				previousdelaycount = RegenedMana;
				if (DQAcceleratleTimer > 0) RegenedMana = floor(RegenedMana * 1.25); // Acceleratle = +25% Regen
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x5a - Acceleratle]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
				previousdelaycount = RegenedMana;
				if (DQDeceleratleTimer > 0) RegenedMana = floor(RegenedMana * 0.8); // Deceleratle = -20% Regen
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x5b - Deceleratle]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);

				// Poison = +8.334% Regen
				previousdelaycount = RegenedMana;
				if (PoisonedTimer > 0 && InvulnerabilityTimer == 0) RegenedMana = floor(RegenedMana * 1.08334);
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x6 - Poison]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);

				// Checks Mana Regen Rate Menu Option
				previousdelaycount = RegenedMana;
				RegenedMana = floor(RegenedMana * dvds_manaregenmultiplier / 100);
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x7 - RegenMultiplier]: %d\c-, Previous: %d, Multiplier: %d%", RegenedMana, previousdelaycount, dvds_manaregenmultiplier);
					
				// Weapons
				previousdelaycount = RegenedMana;
				If (weapon is "SapphireWandNew")
				{
					if (WandMasteryPerkLevel == 1) RegenedMana = floor(RegenedMana * 1.025);
					if (WandMasteryPerkLevel == 2) RegenedMana = floor(RegenedMana * 1.075);
					if (WandMasteryPerkLevel == 3) RegenedMana = floor(RegenedMana * 1.125);
					if (WandMasteryPerkLevel == 4) RegenedMana = floor(RegenedMana * 1.2);
					if (WandMasteryPerkLevel == 5) RegenedMana = floor(RegenedMana * 1.275);
				}
				If (weapon is "DualSapphireWandsNew")
				{
					if (WandMasteryPerkLevel == 1) RegenedMana = floor(RegenedMana * 1.05);
					if (WandMasteryPerkLevel == 2) RegenedMana = floor(RegenedMana * 1.15);
					if (WandMasteryPerkLevel == 3) RegenedMana = floor(RegenedMana * 1.25);
					if (WandMasteryPerkLevel == 4) RegenedMana = floor(RegenedMana * 1.4);
					if (WandMasteryPerkLevel == 5) RegenedMana = floor(RegenedMana * 1.55);
				}
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x8 - Weapon Checking]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
	
				previousdelaycount = RegenedMana;
				if (RegenedMana < 1) RegenedMana = 1;
				if (debugmanaregen) Console.Printf("    \cnMP Regen [Step x9 - LOWCap 1]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
	
				// New Addition = Caps Maximum Mana Regeneration to a certain amount based on Difficulty and armor-type items.
				MaxRegenableMana = floor(MaxMana * 0.5);
				if (TrueGameSkill <= SKILL_VERY_EASY) MaxRegenableMana = floor(MaxMana * 0.61); 	// (61% of Max)
				if (TrueGameSkill == SKILL_EASY) MaxRegenableMana = floor(MaxMana * 0.55); 				// (55% of Max)
				if (TrueGameSkill == SKILL_NORMAL) MaxRegenableMana = floor(MaxMana * 0.5); 			// (50% of Max)
				if (TrueGameSkill == SKILL_HARD) MaxRegenableMana = floor(MaxMana * 0.45); 				// (45% of Max)
				if (TrueGameSkill == SKILL_VERY_HARD) MaxRegenableMana = floor(MaxMana * 0.39); 	// (39% of Max)
				if (TrueGameSkill == SKILL_EXTREME) MaxRegenableMana = floor(MaxMana * 0.36); 		// (36% of Max)
				if (TrueGameSkill == SKILL_HORRIBLE) MaxRegenableMana = floor(MaxMana * 0.33); 		// (33% of Max)
				if (TrueGameSkill == SKILL_IMPOSSIBLE) MaxRegenableMana = floor(MaxMana * 0.30); 	// (30% of Max)
				if (TrueGameSkill >= SKILL_OMEGA) MaxRegenableMana = floor(MaxMana * 0.27); 			// (27% of Max)
				if (debugmanaregen) Console.Printf("    \cnMP Regen [Step x10 - Get Max Regen]: %d\c-, MaxRegen: %d", RegenedMana, MaxRegenableMana);
	
				EquippedRegenCap = 100; // in percent
				// All-Character Specific Items
				if (Owner.CountInv("SauronHelmet")) EquippedRegenCap -= 25;  // (-25% extension if Sauron's Helmet is equipped)
				if (Owner.CountInv("SauronGauntlets")) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
				if (Owner.CountInv("SauronGauntletsIllucia")) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
				if (Owner.CountInv("SauronGauntletsFlora")) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
				nm = "SauronGauntletsAilish"; APPackCheck = nm; 
				if (Owner.CountInv(APPackCheck)) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
				nm = "SauronGauntletsPetra"; APPackCheck2 = nm; 
				if (Owner.CountInv(APPackCheck2)) EquippedRegenCap -= 10;  // (-10% extension if Sauron's Gauntlets are equipped)
				if (Owner.CountInv("TheOneRing")) EquippedRegenCap += 50;  // (+50% extension if The One Ring is equipped)
				// Marine Specific Items (between -4% and -16%, since only one can be equipped at once
				if (Owner.CountInv("DSGreenArmorClass")) EquippedRegenCap -= 4; // (-4% for Green Armor)
				if (Owner.CountInv("DSBlueArmorClass")) EquippedRegenCap -= 8; // (-8% for Blue Armor)
				if (Owner.CountInv("DSStoneArmorClass1")) EquippedRegenCap -= 10; // (-10% for Stone Armor 1)
				if (Owner.CountInv("DSDiamondArmorClass1")) EquippedRegenCap -= 14; // (-14% for Diamond Armor 1)
				if (Owner.CountInv("DSStoneArmorClass2")) EquippedRegenCap -= 12; // (-12% for Stone Armor 2)
				if (Owner.CountInv("DSDiamondArmorClass2")) EquippedRegenCap -= 16; // (-16% for Diamond Armor 2)
				// Flora Specific Items (up to +150%)
				if (Owner.CountInv("EvenstarNecklace")) EquippedRegenCap += 25;  // (+25% extension if Evenstar Necklace is equipped)
				if (Owner.CountInv("AnubisCufflinks")) EquippedRegenCap += 62;  // (+62% extension if Anubis Cufflinks are equipped)
				if (Owner.CountInv("KissaBra")) EquippedRegenCap += 38; // (+38% extension if Kissa's Armor Brassiere is equipped)
				if (Owner.CountInv("BalrogRing")) EquippedRegenCap += 25; // (+25% extension if Balrog's Ring is equipped)
				if (debugmanaregen && EquippedRegenCap != 100) Console.Printf("    \cnMP Regen [Step x11 - Get Equip Regen Cap]: %d\c-, EquipRegenCap: %d", RegenedMana, EquippedRegenCap);
	
				if (EquippedRegenCap < 20) EquippedRegenCap = 20;
				if (EquippedRegenCap > 640) EquippedRegenCap = 640;
				MaxRegenableMana = floor(MaxRegenableMana * EquippedRegenCap / 100);
				if (debugmanaregen && EquippedRegenCap != 100) Console.Printf("    \cnMP Regen [Step x12 - Misc]: %d\c-, EquipRegenCap: %d, MaxRegenableMana: %d", RegenedMana, EquippedRegenCap, MaxRegenableMana);

				// Caps Mana Regeneration to a certain % of the maximum based on difficulty level
				previousdelaycount = RegenedMana;
				if (RegenedMana > MaxRegenableMana) RegenedMana = MaxRegenableMana;
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x13 - HighCap 1]: %d\c-, Previous: %d, MaxRegenableMana: %d%", RegenedMana, previousdelaycount, MaxRegenableMana);
	
				// Dove's Ribbon [Increases MP Regeneration]
				previousdelaycount = RegenedMana;
				if (CharacterClass == 2)
				{
					if (Owner.CountInv("DoveRibbon"))
					{
						RegenedMana += random[statitem](2,4); // Only Flora can use the Dove's Ribbon (100% Chance of Extra 2-4 Mana)
						if (random[statitem](1,4) == 1) RegenedMana += random[statitem](1,2); // Only Flora can use the Dove's Ribbon (25% Chance of extra 1-2 Mana)
						if (random[statitem](1,16) == 1) RegenedMana += random[statitem](1,2); // Only Flora can use the Dove's Ribbon (6.25% Chance of extra 1-2 Mana)
						if (random[statitem](1,64) == 1) RegenedMana += random[statitem](1,2); // Only Flora can use the Dove's Ribbon (1.5625% Chance of extra 1-2 Mana)
					}
				}
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x14 - Dove's Ribbon]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
	
				previousdelaycount = RegenedMana;
				SkillFactor = 36;
				// Focus = 12.5% more mana per interval
				if (IsFocusOn > 0)
				{
					if (CharacterClass == 2)
					{
						if (Owner.CountInv("EvenstarNecklace")) SkillFactor += 2;
						if (Owner.CountInv("BalrogRing")) SkillFactor += 2;
						if (Owner.CountInv("FalconKnifeEarrings")) SkillFactor += 2;
					}
					else
					{
						if (Owner.CountInv("DSGreenArmorClass")) SkillFactor += 1;
						if (Owner.CountInv("DSBlueArmorClass")) SkillFactor += 2;
						if (Owner.CountInv("DSStoneArmorClass1")) SkillFactor += 3;
						if (Owner.CountInv("DSDiamondArmorClass1")) SkillFactor += 4;
						if (Owner.CountInv("DSStoneArmorClass2")) SkillFactor += 5;
						if (Owner.CountInv("DSDiamondArmorClass2")) SkillFactor += 6;
					}
					RegenedMana = floor(RegenedMana * SkillFactor / 20);
				}
				if (debugmanaregen && RegenedMana != previousdelaycount) Console.Printf("    \cnMP Regen [Step x15 - Focusing]: %d\c-, Previous: %d, Factor: %d / 20", RegenedMana, previousdelaycount, SkillFactor);
	
				previousdelaycount = RegenedMana;
				if (RegenedMana < 1) RegenedMana = 1;
				if (debugmanaregen) Console.Printf("    \cnMP Regen [Step x16 - LOWCap 2]: %d\c-, Previous: %d", RegenedMana, previousdelaycount);
	
				// The actual Regeneration Part
				CurrentMana += RegenedMana;
				CurrentMana = clamp(CurrentMana, CurrentMana, MaxMana);

				MaxManaLimit = floor(MaxMana * 2);
				if (CurrentMana > MaxManaLimit) CurrentMana = MaxManaLimit;
				CallACS("OtherVarSetDECORATE",2,CurrentMana); // Sets MaxMana in ACS
				CurrentMana = CallACS("StatCheck",14); // Refreshs Current MP amount
				CallACS("MiscVarSetDECORATE",243,CurrentMana); // Sets "LastManaValue" in ACS
				CallACS("MiscVarSetDECORATE",238,CurrentMana); // Sets "NewManaValue" in ACS

				// Reset Regen Delay
				if (TrueGameSkill <= SKILL_VERY_EASY) SkillLevelManaDelay = 600; // 30 tics
				if (TrueGameSkill == SKILL_EASY) SkillLevelManaDelay = 660; // 33 tics
				if (TrueGameSkill == SKILL_NORMAL) SkillLevelManaDelay = 740; // 37 tics
				if (TrueGameSkill == SKILL_HARD) SkillLevelManaDelay = 840; // 42 tics
				if (TrueGameSkill == SKILL_VERY_HARD) SkillLevelManaDelay = 960; // 48 tics
				if (TrueGameSkill == SKILL_EXTREME) SkillLevelManaDelay = 1020; // 51 tics
				if (TrueGameSkill == SKILL_HORRIBLE) SkillLevelManaDelay = 1080; // 54 tics
				if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillLevelManaDelay = 1140; // 57 tics
				if (TrueGameSkill >= SKILL_OMEGA) SkillLevelManaDelay = 1260; // 63 tics

				if (CharacterClass == 0) SkillLevelManaDelay += ceil(20 * random[statitem](-3,5)); 
				if (CharacterClass == 1) SkillLevelManaDelay += ceil(20 * random[statitem](-4,4));
				if (CharacterClass == 2) SkillLevelManaDelay += ceil(20 * random[statitem](-5,3));
				if (CharacterClass == 8) SkillLevelManaDelay += ceil(20 * random[statitem](-5,3));
				if (CharacterClass == 9) SkillLevelManaDelay += ceil(20 * random[statitem](-4,4));

				if (CharacterClass == 0) ManaReDelay = floor(PlayerLevel * 0.03334); // Deggaris (up to 3/6)
				if (CharacterClass == 1) ManaReDelay = floor(PlayerLevel * 0.04); // Illucia (up to 4/8)
				if (CharacterClass == 2) ManaReDelay = floor(PlayerLevel * 0.05); // Flora (up to 5/10) 
				if (CharacterClass == 8) ManaReDelay = floor(PlayerLevel * 0.04762); // Ailish 
				if (CharacterClass == 9) ManaReDelay = floor(PlayerLevel * 0.04); // Petra (up to 4/8)
				MPDelayInterval = SkillLevelManaDelay - ManaReDelay;

				// A combined total of 15 points of Sorcery/Theraphesuis are needed for a tic-point of faster regen time.
				ManaReDelay = floor((PlayerSOR + PlayerTHE) / 300);
				MPDelayInterval -= ManaReDelay;

				if (TrueGameSkill <= SKILL_VERY_EASY) if (MPDelayInterval < 20) MPDelayInterval = 20;
				if (TrueGameSkill == SKILL_EASY) if (MPDelayInterval < 40) MPDelayInterval = 40;
				if (TrueGameSkill == SKILL_NORMAL) if (MPDelayInterval < 80) MPDelayInterval = 80;
				if (TrueGameSkill == SKILL_HARD) if (MPDelayInterval < 140) MPDelayInterval = 140;
				if (TrueGameSkill == SKILL_VERY_HARD) if (MPDelayInterval < 220) MPDelayInterval = 220;
				if (TrueGameSkill == SKILL_EXTREME) if (MPDelayInterval < 240) MPDelayInterval = 240;
				if (TrueGameSkill == SKILL_HORRIBLE) if (MPDelayInterval < 260) MPDelayInterval = 260;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) if (MPDelayInterval < 280) MPDelayInterval = 280;
				if (TrueGameSkill >= SKILL_OMEGA) if (MPDelayInterval < 300) MPDelayInterval = 300;
				
				MPRegenTimer -= MPDelayInterval;
				if (MPRegenTimer < 0) MPRegenTimer = 0;
			}
			
			
			//******************************
			//**Arcana Gauge Regen (Petra)**
			//******************************
			int ArcanaPoints = CallACS("MiscVarCheckDECORATE",5001);
			if (CharacterClass == 9)
			{
				if (TrueGameSkill <= SKILL_VERY_EASY) { ArcanaRegenDelaySkill = 8; }
				if (TrueGameSkill == SKILL_EASY) { ArcanaRegenDelaySkill = 16; }
				if (TrueGameSkill == SKILL_NORMAL) { ArcanaRegenDelaySkill = 24; }
				if (TrueGameSkill == SKILL_HARD) { ArcanaRegenDelaySkill = 32; }
				if (TrueGameSkill == SKILL_VERY_HARD) { ArcanaRegenDelaySkill = 40; }
				if (TrueGameSkill == SKILL_EXTREME) { ArcanaRegenDelaySkill = 44; }
				if (TrueGameSkill == SKILL_HORRIBLE) { ArcanaRegenDelaySkill = 48; }
				if (TrueGameSkill == SKILL_IMPOSSIBLE) { ArcanaRegenDelaySkill = 52; }
				if (TrueGameSkill >= SKILL_OMEGA) { ArcanaRegenDelaySkill = 56; }
			}
			
			if (ArcanaPoints < 900) 
			{
				ArcanaRegenDelay += 1;
				if (ArcanaRegenDelay >= ArcanaRegenDelaySkill)
				{
					ArcanaPoints += 1;
					ArcanaRegenDelay -= ArcanaRegenDelaySkill;
					if (ArcanaPoints == 100 || ArcanaPoints == 200 || ArcanaPoints == 300 || ArcanaPoints == 400 || ArcanaPoints == 500 || ArcanaPoints == 600 || ArcanaPoints == 700 || ArcanaPoints == 800 || ArcanaPoints == 900 )
					{
						owner.A_StartSound("ArcanaGaugeLevelup",CHAN_7);
					}
				}
			}
			else ArcanaRegenDelay = 0;
			CallACS("MiscVarSetDECORATE",5001,ArcanaPoints);
			//Console.Printf("Arcana Regen: %d / %d, Points: %d", ArcanaRegenDelay, ArcanaRegenDelaySkill, ArcanaPoints);
			
			
			//***********************
			//**Stamina Regen/Degen**
			//***********************
			int debugstamregen = dvdsdebug_showstaminaregenstuff;
			CurrentStamina = CallACS("MiscVarCheckDECORATE",21);
			if (CurrentStamina < MaximumStamina)
			{
				staminaregenfinal = randompick[statitem](0,0,0,0,0,0,0,0,0,1,1,1,2);
				// Base
				if (CharacterClass == 0) staminaregenbase = 15; // Deggaris (0.15%/tic = 5.25%/sec)
				if (CharacterClass == 1) staminaregenbase = 13; // Illucia (0.13%/tic = 4.55%/sec)
				if (CharacterClass == 2) staminaregenbase = 9; // Flora (0.09%/tic = 3.15%/sec)
				if (CharacterClass == 8) staminaregenbase = 8; // Ailish (0.08%/tic = 2.80%/sec)
				if (CharacterClass == 9) staminaregenbase = 14; // Petra (0.14%/tic = 4.90%/sec)
				staminaregenfinal += staminaregenbase;
				if (debugstamregen) Console.Printf("    \cdStamina Regeneration [Step 1: Character Base]: %d\c-, Increase: %d", staminaregenfinal, staminaregenbase);
				
				if (CharacterClass == 0) staminaregenbase = floor(PlayerLevel * 0.07693);
				if (CharacterClass == 1) staminaregenbase = floor(PlayerLevel * 0.07143);
				if (CharacterClass == 2) staminaregenbase = floor(PlayerLevel * 0.1);
				if (CharacterClass == 8) staminaregenbase = floor(PlayerLevel * 0.09091);
				if (CharacterClass == 9) staminaregenbase = floor(PlayerLevel * 0.08334);
				staminaregenfinal += staminaregenbase;
				if (debugstamregen) Console.Printf("    \cdStamina Regeneration [Step 2: Level Addition]: %d\c-, Increase: %d", staminaregenfinal, staminaregenbase);
				
				// Stamina Bonuses [Strife]
				staminaregenbase = floor(StrifeStamLvl * 0.125);
				staminaregenfinal += staminaregenbase;
				if (debugstamregen && StrifeStamLvl != 0) Console.Printf("    \cdStamina Regeneration [Step 3: Strife - Stamina Bonuses]: %d\c-, Increase: %d", staminaregenfinal, staminaregenbase);

				// Check Input for Bonus/Penalties
				staminaregenbase = staminaregenfinal;
				int StamMoveMultiplier = 100;
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1; // Menus are on
				if (SleepTimer > 0) FreezePlayer += 1; // Sleeping
				if (FreezePlayer == 0)
				{
					if (!(Owner.CountInv("ShieldDefense") || Owner.CountInv("ShieldDefense2") || Owner.CountInv("ShieldDefense3")))
					{
						if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) StamMoveMultiplier = floor(StamMoveMultiplier * 0.76);
						if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) StamMoveMultiplier = floor(StamMoveMultiplier * 0.84);
						if ((buttons & BT_JUMP) && sv_allowjump) StamMoveMultiplier = floor(StamMoveMultiplier * 0.76);
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StamMoveMultiplier = floor(StamMoveMultiplier * 1.20);
					}
					else
					{
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StamMoveMultiplier = floor(StamMoveMultiplier * 1.10);
					}
		
					staminaregenfinal = floor(staminaregenfinal * StamMoveMultiplier / 100);
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 4: Input Checking]: (%d)\c-, Multiplier: %d%, NewValue: %d, PreviousValue: %d", buttons, StamMoveMultiplier, staminaregenfinal, staminaregenbase);
				
				// Check Armor for Bonus/Penalties
				staminaregenbase = 1000;
				// Marine Specific Armors
				if (Owner.CountInv("DSGreenArmorClass"))		staminaregenbase += 12; 
				if (Owner.CountInv("DSBlueArmorClass"))			staminaregenbase += 25; 
				if (Owner.CountInv("DSStoneArmorClass1"))		staminaregenbase += 50; 
				if (Owner.CountInv("DSDiamondArmorClass1"))	staminaregenbase += 100;  
				if (Owner.CountInv("DSStoneArmorClass2"))		staminaregenbase += 75;  
				if (Owner.CountInv("DSDiamondArmorClass2"))	staminaregenbase += 150; 
				// Sauron Stuff
				if (Owner.CountInv("SauronHelmet"))					staminaregenbase -= 100; 
				if (Owner.CountInv("SauronGauntletsItem"))	staminaregenbase -= 100; 
				// Flora's Stuff
				if (Owner.CountInv("RuinousShield"))				staminaregenbase -= 625;
				if (Owner.CountInv("SafeTeaShoes"))					staminaregenbase += 100;  
				if (Owner.CountInv("AnubisCufflinks"))			staminaregenbase += 25;  
				if (Owner.CountInv("KissaBra"))							staminaregenbase += 75;  
				if (Owner.CountInv("DivineShield"))					staminaregenbase += 125;  
				if (Owner.CountInv("DoveRibbon"))						staminaregenbase += 50;  
				if (staminaregenbase < 125) staminaregenbase = 125;
				staminaregenfinal = floor(staminaregenfinal * staminaregenbase / 1000);
				if (debugstamregen && staminaregenbase != 1000) Console.Printf("    \cdStamina Regeneration [Step 5: Armor Checking]: %d\c-, Multiplier: %d / 1000", staminaregenfinal, staminaregenbase);
				
				// Initia1 Stat Check = 8pts of Strength = +1% Stamina Regen Speed
				int basestatdivisor = 8;
				if (TrueGameSkill <= SKILL_VERY_EASY) basestatdivisor = 8;
				if (TrueGameSkill == SKILL_EASY) basestatdivisor = 8;
				if (TrueGameSkill == SKILL_NORMAL) basestatdivisor = 8;
				if (TrueGameSkill == SKILL_HARD) basestatdivisor = 9;
				if (TrueGameSkill == SKILL_VERY_HARD) basestatdivisor = 9;
				if (TrueGameSkill == SKILL_EXTREME) basestatdivisor = 9;
				if (TrueGameSkill == SKILL_HORRIBLE) basestatdivisor = 10;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) basestatdivisor = 10;
				if (TrueGameSkill >= SKILL_OMEGA) basestatdivisor = 10;
				staminaregenbase = floor(PlayerSTR / basestatdivisor);
				// Secondary Stat Check = 8pts of [?] = +1% Stamina Regen Speed
				int basestatdivisor2 = 8;
				if (TrueGameSkill <= SKILL_VERY_EASY) basestatdivisor2 = 8;
				if (TrueGameSkill == SKILL_EASY) basestatdivisor2 = 8;
				if (TrueGameSkill == SKILL_NORMAL) basestatdivisor2 = 8;
				if (TrueGameSkill == SKILL_HARD) basestatdivisor2 = 9;
				if (TrueGameSkill == SKILL_VERY_HARD) basestatdivisor2 = 9;
				if (TrueGameSkill == SKILL_EXTREME) basestatdivisor2 = 9;
				if (TrueGameSkill == SKILL_HORRIBLE) basestatdivisor2 = 10;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) basestatdivisor2 = 10;
				if (TrueGameSkill >= SKILL_OMEGA) basestatdivisor2 = 10;
				if (CharacterClass == 0) staminaregenbase += floor(PlayerSTR / basestatdivisor2); // Deggaris's Secondary Stat is also strength, making it work doubly for him overall. :P
				if (CharacterClass == 1) staminaregenbase += floor(PlayerDEF / basestatdivisor2); // Illucia's Secondary Stat is Defense. :P
				if (CharacterClass == 2) staminaregenbase += floor(PlayerAGL / basestatdivisor2); // Flora's Secondary Stat is Agility. :P
				if (CharacterClass == 8) staminaregenbase += floor(PlayerAGL / basestatdivisor2); // Ailish's Secondary Stat is Agility. :P
				if (CharacterClass == 9) staminaregenbase += floor(PlayerDEF / basestatdivisor2); // Petra's Secondary Stat is Defense. :P
				staminaregenbase += 100;
				staminaregenfinal = floor(staminaregenfinal * staminaregenbase / 100);
				if (debugstamregen) Console.Printf("    \cdStamina Regeneration [Step 6: Stat Checking]: %d\c-, Multiplier: %d / 100, BaseDivisor: %d", staminaregenfinal, staminaregenbase, basestatdivisor);
				
				// Tension
				staminaregenbase = staminaregenfinal;
				if (TensionLevel == 1) staminaregenfinal = floor(staminaregenfinal * 1.025);
				if (TensionLevel == 2) staminaregenfinal = floor(staminaregenfinal * 1.05);
				if (TensionLevel == 3) staminaregenfinal = floor(staminaregenfinal * 1.1);
				if (TensionLevel == 4) staminaregenfinal = floor(staminaregenfinal * 1.25);
				if (TensionLevel == 5) staminaregenfinal = floor(staminaregenfinal * 1.5);
				if (TensionLevel == 6) staminaregenfinal = floor(staminaregenfinal * 2.5);
				if (TensionLevel == 7) staminaregenfinal = floor(staminaregenfinal * 5.0);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 7: Tension (%d)]: %d\c-, Previous: %d", TensionLevel, staminaregenfinal, staminaregenbase);
				
				// Divine Avatar = +100% Regen
				staminaregenbase = staminaregenfinal;
				if (DivineAvatarTimer > 0) staminaregenfinal = floor(staminaregenfinal * 2);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 8: Divine Avatar]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// GoE = +250% Regen
				staminaregenbase = staminaregenfinal;
				if (GoeTimer > 0) staminaregenfinal = floor(staminaregenfinal * 3.5);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 8b: GoE]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
		
				// Speed Buffs
				staminaregenbase = staminaregenfinal;
				if (DQAcceleratleTimer > 0) staminaregenfinal = floor(staminaregenfinal * 1.25);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 9a: Acceleratle]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				staminaregenbase = staminaregenfinal;
				if (DQDeceleratleTimer > 0) staminaregenfinal = floor(staminaregenfinal * 0.8);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 9b: Deceleratle]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Poison = -33.3% Regen
				staminaregenbase = staminaregenfinal;
				if (PoisonedTimer > 0 && InvulnerabilityTimer == 0) staminaregenfinal = floor(staminaregenfinal * 0.667);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 10: Poison]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Fatigue = -80% Regen
				staminaregenbase = staminaregenfinal;
				if (FatigueTimer > 0) staminaregenfinal = floor(staminaregenfinal * 0.2);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 11: Fatigue]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
			
				// Sleeping = +400% Regen
				staminaregenbase = staminaregenfinal;
				if (SleepTimer > 0)
				{
					staminaregenfinal = floor(staminaregenfinal * 5);
					PerkFactor = ((RegStamFastLvl * 2000) + (RegStamFastEXLvl * 5000)) + 10000;
					staminaregenfinal = ceil(staminaregenfinal * PerkFactor / 10000); // "RegenStamFast" and "RegenStamFast EX" perks.
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 12: Sleep]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Berserk = +150% Regen
				staminaregenbase = staminaregenfinal;
				if (BerserkTimer > 0) staminaregenfinal = floor(staminaregenfinal * 2.5);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 13: Berserk]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Checks Stamina Regen Rate Menu Option
				staminaregenbase = staminaregenfinal;
				staminaregenfinal = floor(staminaregenfinal * dvds_staminaregenmultiplier / 100);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 14: StamRegen Menu Option]: %d\c-, Previous: %d, Factor: %d / 100", staminaregenfinal, staminaregenbase, dvds_staminaregenmultiplier);
				
				// Checks the final value based on how high the Max Stamina Pts Cap has been increased by various items
				staminaregenbase = staminaregenfinal;
				staminaregenfinal = floor(staminaregenfinal * MaximumStamina / 10000);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 15: StamCapVal]: %d\c-, Previous: %d, Factor: %d / 10000", staminaregenfinal, staminaregenbase, MaximumStamina);
				
				// RegenStamFast perks
				staminaregenbase = staminaregenfinal;
				PerkFactor = 10;
				if (RegStamFastLvl > 0)
				{
					PerkFactor = 10 + ((RegStamFastLvl * 2) + (RegStamFastEXLvl * 5));
					staminaregenfinal = ceil(staminaregenfinal * PerkFactor / 10); // "RegenStamFast" and "RegenStamFast EX" perks.
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 16: RegenFast Perk]: %d\c-, Previous: %d, Factor: %d / 10", staminaregenfinal, staminaregenbase, PerkFactor);
				
				// Check for Weapons
				double temp = 1.0;
				staminaregenbase = staminaregenfinal;
				nm = "SauronGauntletsAilish"; APPackCheck = nm;
				nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
				If (weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || weapon is "SauronGauntletsFlora" || 
					  weapon is APPackCheck || weapon is APPackCheck2)
				{
					staminaregenfinal = floor(staminaregenfinal * 0.75);
				}
				If (weapon is "EvilWarriorShield")
				{
					staminaregenfinal = floor(staminaregenfinal * (0.875 + (HellWarriorShieldLevel * 0.0125)));
				}
				If (weapon is "Chainsaw2" || weapon is "DoubleBladedChainsaw")
				{
					staminaregenfinal = floor(staminaregenfinal * 0.9);
				}
				nm = "FistAilish"; APPackCheck = nm;
				nn = "FistPetra"; APPackCheck2 = nn;
				If (weapon is "FistDeggaris" || weapon is "FistIllucia" || weapon is "FistFlora" || weapon is "PoisonNeedle" ||
						weapon is APPackCheck || weapon is APPackCheck2)
				{
					staminaregenfinal = floor(staminaregenfinal * 1.05);
					if (Owner.CountInv("FistPlayerBlockItem")) 
					{
						temp = FRandomPick[statitem](1.2,1.3,1.3,1.4,1.4,1.4,1.5,1.5,1.5,1.5,1.6,1.6,1.6,1.7,1.7,1.8);
						staminaregenfinal = floor(staminaregenfinal * temp);
					}
				}
				If (weapon is "SceptreOfEmpyrea")
				{
					if (Owner.CountInv("ShieldDefense")) temp = frandom[statitem](1.4,1.6);
					if (Owner.CountInv("ShieldDefense2")) temp = frandom[statitem](1.7,1.9);
					if (Owner.CountInv("ShieldDefense3")) temp = frandom[statitem](2.0,2.2);
					staminaregenfinal = floor(staminaregenfinal * temp);
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 17: Weapons]: %d\c-, Previous: %d, Temp: %.8f", staminaregenfinal, staminaregenbase, temp);
				
				// "Cleared of Mind" Perks
				staminaregenbase = staminaregenfinal;
				PerkFactor = 80;
				if (ClearMindPerkLvl > 0)
				{
					perkfactor = (80 + (ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5));
					staminaregenfinal = ceil(staminaregenfinal * perkfactor / 80);
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 18: Cleared of Mind Perk]: %d\c-, Previous: %d, Factor: %d / 80", staminaregenfinal, staminaregenbase, PerkFactor);
			
				// Check Musou Power Trip Mode
				staminaregenbase = staminaregenfinal;
				if (dvds_musou_powertripmode == 1) staminaregenfinal = floor(staminaregenfinal * 2.5); // 250%
				if (dvds_musou_powertripmode == 2) staminaregenfinal = floor(staminaregenfinal * 5); // 500%
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cdStamina Regeneration [Step 19: Musou/Power Trip Mode]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Low Caps Regen to 1 tic minimum
				staminaregenbase = staminaregenfinal;
				if (StamRegenBonPenTimer > 0) staminaregenfinal *= StamRegenBonPenMulti;
				if (StamRegenBonPenTimer < 0) staminaregenfinal *= (1.0 / StamRegenBonPenMulti);
				if (staminaregenfinal < 1) staminaregenfinal = 1;
				if (debugstamregen) Console.Printf("    \cdStamina Regeneration [Step 20: LowCap/FINAL]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);

				if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
				else // If Player is "Conscious", allow their Stamina Regen to count
				{
					CurrentStamina += staminaregenfinal;
					CurrentStamina = clamp(CurrentStamina, CurrentStamina, MaximumStamina);
					CallACS("MiscVarSetDECORATE",21,CurrentStamina);
					CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
				}
				if (debugstamregen) Console.Printf("    \cdStamina Regeneration: %d / %d\c-, Gain: %d", CurrentStamina, MaximumStamina, staminaregenfinal);
			}
			else if (CurrentStamina == MaximumStamina) 
			{
				staminaregenfinal = 0;
				if (debugstamregen) Console.Printf("    \cjStamina Neutral: %d / %d", CurrentStamina, MaximumStamina);
			}
			else // Degen
			{
				// Base
				staminaregenfinal = 0;
				staminaregenbase = 0;
				if (CharacterClass == 0) staminaregenbase = -4; // Deggaris (-0.04%/tic = -1.40%/sec)
				if (CharacterClass == 1) staminaregenbase = -6; // Illucia (-0.06%/tic = -2.10%/sec)
				if (CharacterClass == 2) staminaregenbase = -7; // Flora (-0.07%/tic = -2.45%/sec)
				if (CharacterClass == 8) staminaregenbase = -8; // Ailish (-0.08%/tic = -2.80%/sec)
				if (CharacterClass == 9) staminaregenbase = -4; // Petra (-0.04%/tic = -1.40%/sec)
				staminaregenfinal += staminaregenbase;
				if (debugstamregen) Console.Printf("    \cgStamina Degeneration [Step 1: Character Base]: %d\c-, Decrease: %d", staminaregenfinal, staminaregenbase);

				// Level
				staminaregenbase = 0;
				if (CharacterClass == 0) staminaregenbase = floor(PlayerLevel * 0.01786); // +1-3
				if (CharacterClass == 1) staminaregenbase = floor(PlayerLevel * 0.01786); // +1-3
				if (CharacterClass == 2) staminaregenbase = floor(PlayerLevel * 0.025); // +2-5
				if (CharacterClass == 8) staminaregenbase = floor(PlayerLevel * 0.03334); // +2-5
				if (CharacterClass == 9) staminaregenbase = floor(PlayerLevel * 0.01786); // +1-3
				staminaregenfinal += staminaregenbase;
				if (debugstamregen) Console.Printf("    \cgStamina Degeneration [Step 2: Level Subtraction]: %d\c-, Increase: %d", staminaregenfinal, staminaregenbase);
				
				staminaregenbase = 0;
				// Stamina Bonuses [Strife]
				staminaregenbase = floor(StrifeStamLvl * 0.125);
				staminaregenfinal += staminaregenbase;
				if (debugstamregen && StrifeStamLvl != 0) Console.Printf("    \cgStamina Degeneration [Step 3: Strife - Stamina Bonuses]: %d\c-, Increase: %d", staminaregenfinal, staminaregenbase);
				
				// Check Input for Bonus/Penalties
				staminaregenbase = staminaregenfinal;
				int StamMoveMultiplier = 100;
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1; // Menus are on
				if (SleepTimer > 0) FreezePlayer += 1; // Sleeping
				if (FreezePlayer == 0)
				{
					if (!(Owner.CountInv("ShieldDefense") || Owner.CountInv("ShieldDefense2") || Owner.CountInv("ShieldDefense3")))
					{
						if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) StamMoveMultiplier = ceil(StamMoveMultiplier * 100 / 76);
						if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) StamMoveMultiplier = ceil(StamMoveMultiplier * 100 / 84);
						if ((buttons & BT_JUMP) && sv_allowjump) StamMoveMultiplier = ceil(StamMoveMultiplier * 100 / 76);
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StamMoveMultiplier = ceil(StamMoveMultiplier * 100 / 120);
					}
					else
					{
						if ((buttons & BT_CROUCH) && sv_allowcrouch) StamMoveMultiplier = ceil(StamMoveMultiplier * 100 / 110);
					}
		
					staminaregenfinal = ceil(staminaregenfinal * StamMoveMultiplier / 100);
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 4: Input Checking]: (%d)\c-, Multiplier: %d%, NewValue: %d, PreviousValue: %d", buttons, StamMoveMultiplier, staminaregenfinal, staminaregenbase);
				
				// Check Armor for Bonus/Penalties
				staminaregenbase = 1000;
				// Marine Specific Armors
				if (Owner.CountInv("DSGreenArmorClass"))		staminaregenbase -= 6; 
				if (Owner.CountInv("DSBlueArmorClass"))			staminaregenbase -= 12; 
				if (Owner.CountInv("DSStoneArmorClass1"))		staminaregenbase -= 25; 
				if (Owner.CountInv("DSDiamondArmorClass1"))	staminaregenbase -= 50;  
				if (Owner.CountInv("DSStoneArmorClass2"))		staminaregenbase -= 37;  
				if (Owner.CountInv("DSDiamondArmorClass2"))	staminaregenbase -= 75; 
				// Sauron Stuff
				if (Owner.CountInv("SauronHelmet"))					staminaregenbase += 50; 
				if (Owner.CountInv("SauronGauntletsItem"))	staminaregenbase += 50; 
				// Flora's Stuff
				if (Owner.CountInv("RuinousShield"))				staminaregenbase += random[statitem](312,313);
				if (Owner.CountInv("SafeTeaShoes"))					staminaregenbase -= 50;  
				if (Owner.CountInv("AnubisCufflinks"))			staminaregenbase -= 13;  
				if (Owner.CountInv("KissaBra"))							staminaregenbase -= 37;  
				if (Owner.CountInv("DivineShield"))					staminaregenbase -= 63;  
				if (Owner.CountInv("DoveRibbon"))						staminaregenbase -= 25;  
				if (staminaregenbase < 1) staminaregenbase = 1;
				if (staminaregenbase > 2500) staminaregenbase = 2500;
				staminaregenfinal = ceil(staminaregenfinal * staminaregenbase / 1000);
				if (debugstamregen && staminaregenbase != 1000) Console.Printf("    \cgStamina Degeneration [Step 5: Armor Checking]: %d\c-, Multiplier: %d / 1000", staminaregenfinal, staminaregenbase);
				
				// 16pts of Strength = -1% Stamina Degen Speed
				int basestatdivisor = 16;
				if (TrueGameSkill <= SKILL_VERY_EASY) basestatdivisor = 15;
				if (TrueGameSkill == SKILL_EASY) basestatdivisor = 16;
				if (TrueGameSkill == SKILL_NORMAL) basestatdivisor = 16;
				if (TrueGameSkill == SKILL_HARD) basestatdivisor = 17;
				if (TrueGameSkill == SKILL_VERY_HARD) basestatdivisor = 17;
				if (TrueGameSkill == SKILL_EXTREME) basestatdivisor = 18;
				if (TrueGameSkill == SKILL_HORRIBLE) basestatdivisor = 18;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) basestatdivisor = 19;
				if (TrueGameSkill >= SKILL_OMEGA) basestatdivisor = 19;
				staminaregenbase = floor(PlayerSTR / basestatdivisor);
				// Secondary Stat Check = 16pts of [?] = -1% Stamina Degen Speed
				int basestatdivisor2 = 16;
				if (TrueGameSkill <= SKILL_VERY_EASY) basestatdivisor2 = 15;
				if (TrueGameSkill == SKILL_EASY) basestatdivisor2 = 16;
				if (TrueGameSkill == SKILL_NORMAL) basestatdivisor2 = 16;
				if (TrueGameSkill == SKILL_HARD) basestatdivisor2 = 17;
				if (TrueGameSkill == SKILL_VERY_HARD) basestatdivisor2 = 17;
				if (TrueGameSkill == SKILL_EXTREME) basestatdivisor2 = 18;
				if (TrueGameSkill == SKILL_HORRIBLE) basestatdivisor2 = 18;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) basestatdivisor2 = 19;
				if (TrueGameSkill >= SKILL_OMEGA) basestatdivisor2 = 19;
				if (CharacterClass == 0) staminaregenbase += floor(PlayerSTR / basestatdivisor2); // Deggaris's Secondary Stat is also strength, making it work doubly for him overall. :P
				if (CharacterClass == 1) staminaregenbase += floor(PlayerDEF / basestatdivisor2); // Illucia's Secondary Stat is Defense. :P
				if (CharacterClass == 2) staminaregenbase += floor(PlayerAGL / basestatdivisor2); // Flora's Secondary Stat is Agility. :P
				if (CharacterClass == 8) staminaregenbase += floor(PlayerAGL / basestatdivisor2); // Ailish's Secondary Stat is Agility. :P
				if (CharacterClass == 9) staminaregenbase += floor(PlayerDEF / basestatdivisor2); // Petra's Secondary Stat is Defense. :P
				staminaregenbase *= -1;
				staminaregenbase += 100;
				staminaregenfinal = ceil(staminaregenfinal * staminaregenbase / 100);
				if (debugstamregen) Console.Printf("    \cgStamina Degeneration [Step 6: Stat Checking]: %d\c-, Multiplier: %d / 100, BaseDivisor: %d", staminaregenfinal, staminaregenbase, basestatdivisor);
				
				// Tension
				staminaregenbase = staminaregenfinal;
				if (TensionLevel == 1) staminaregenfinal = ceil(staminaregenfinal * 0.990);
				if (TensionLevel == 2) staminaregenfinal = ceil(staminaregenfinal * 0.975);
				if (TensionLevel == 3) staminaregenfinal = ceil(staminaregenfinal * 0.950);
				if (TensionLevel == 4) staminaregenfinal = ceil(staminaregenfinal * 0.900);
				if (TensionLevel == 5) staminaregenfinal = ceil(staminaregenfinal * 0.750);
				if (TensionLevel == 6) staminaregenfinal = ceil(staminaregenfinal * 0.500);
				if (TensionLevel == 7) staminaregenfinal = ceil(staminaregenfinal * 0.200);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 7: Tension (%d)]: %d\c-, Previous: %d", TensionLevel, staminaregenfinal, staminaregenbase);
				
				// Divine Avatar = -50% Degen
				staminaregenbase = staminaregenfinal;
				if (DivineAvatarTimer > 0) staminaregenfinal = ceil(staminaregenfinal * 0.5);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 8: Divine Avatar]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// GoE = -80% Degen
				staminaregenbase = staminaregenfinal;
				if (GoETimer > 0) staminaregenfinal = ceil(staminaregenfinal * 0.2);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 8: Divine Avatar]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Speed Buffs
				staminaregenbase = staminaregenfinal;
				if (DQAcceleratleTimer > 0) staminaregenfinal = ceil(staminaregenfinal * 1.25); // Acceleratle
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 9a: Acceleratle]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				staminaregenbase = staminaregenfinal;
				if (DQDeceleratleTimer > 0) staminaregenfinal = ceil(staminaregenfinal * 0.8); // Deceleratle
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 9b: Deceleratle]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);

				// Poison = +33.3% Degen
				staminaregenbase = staminaregenfinal;
				if (PoisonedTimer > 0 && InvulnerabilityTimer == 0) staminaregenfinal = ceil(staminaregenfinal * 1.333);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 10: Poison]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Fatigue = +400% Degen
				staminaregenbase = staminaregenfinal;
				if (FatigueTimer > 0) staminaregenfinal = ceil(staminaregenfinal * 5);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 11: Fatigue]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Sleep = -80% Degen
				staminaregenbase = staminaregenfinal;
				if (SleepTimer > 0)
				{
					staminaregenfinal = ceil(staminaregenfinal * 0.2);
					PerkFactor = 10000 - ((RegStamFastLvl * 2000) + (RegStamFastEXLvl * 5000));
					staminaregenfinal = floor(staminaregenfinal * PerkFactor / 10000); // "RegenStamFast" and "RegenStamFast EX" perks.
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 12: Sleep]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Berserk = -60% Degen
				staminaregenbase = staminaregenfinal;
				if (BerserkTimer > 0) staminaregenfinal = ceil(staminaregenfinal * 0.4);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 13: Berserk]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Checks Stamina Regen Rate Menu Option
				staminaregenbase = staminaregenfinal;
				staminaregenfinal = ceil(staminaregenfinal * 100 / dvds_staminaregenmultiplier);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 14: StamRegen Menu Option]: %d\c-, Previous: %d, Factor: 100 / %d", staminaregenfinal, staminaregenbase, dvds_staminaregenmultiplier);
				
				// Checks the final value based on how high the Max Stamina Pts Cap has been increased by various items
				staminaregenbase = staminaregenfinal;
				staminaregenfinal = ceil((staminaregenfinal * MaximumStamina) / 10000);
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 15: StamCapVal]: %d\c-, Previous: %d, Factor: %d / 10000", staminaregenfinal, staminaregenbase, MaximumStamina);
				
				// RegenStamFast perks
				staminaregenbase = staminaregenfinal;
				if (RegStamFastLvl > 0)
				{
					PerkFactor = 10 - ((RegStamFastLvl * 2) + (RegStamFastEXLvl * 5));
					staminaregenfinal = floor(staminaregenfinal * PerkFactor / 10); // "RegenStamFast" and "RegenStamFast EX" perks.
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 16: RegenFast Perk]: %d\c-, Previous: %d, Factor: %d / 10", staminaregenfinal, staminaregenbase, PerkFactor);
				
				// Check for Weapons
				double temp = 1.0;
				staminaregenbase = staminaregenfinal;
				nm = "SauronGauntletsAilish"; APPackCheck = nm;
				nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
				If (weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || weapon is "SauronGauntletsFlora" || 
					  weapon is APPackCheck || weapon is APPackCheck2)
				{
					staminaregenfinal = ceil(staminaregenfinal * 1.334);
				}
				If (weapon is "EvilWarriorShield")
				{
					staminaregenfinal = ceil(staminaregenfinal * (1.142857142857143 + (HellWarriorShieldLevel * 0.01143)));
				}
				If (weapon is "Chainsaw2" || weapon is "DoubleBladedChainsaw")
				{
					staminaregenfinal = ceil(staminaregenfinal * 1.111111111111111);
				}
				nm = "FistAilish"; APPackCheck = nm;
				nn = "FistPetra"; APPackCheck2 = nn;
				If (weapon is "FistDeggaris" || weapon is "FistIllucia" || weapon is "FistFlora" || weapon is "PoisonNeedle" ||
						weapon is APPackCheck || weapon is APPackCheck2)
				{
					staminaregenfinal = ceil(staminaregenfinal * 0.9523809523809524);
					if (Owner.CountInv("FistPlayerBlockItem")) 
					{
						temp = FRandomPick[statitem](0.8334,0.769231,0.769231,0.714286,0.714286,0.714286,0.6667,0.6667,0.6667,0.6667,0.625,0.625,0.625,0.588235,0.588235,0.5556);
						staminaregenfinal = ceil(staminaregenfinal * temp);
					}
				}
				If (weapon is "SceptreOfEmpyrea")
				{
					if (Owner.CountInv("ShieldDefense")) temp = frandom[statitem](1.4,1.6);
					if (Owner.CountInv("ShieldDefense2")) temp = frandom[statitem](1.7,1.9);
					if (Owner.CountInv("ShieldDefense3")) temp = frandom[statitem](2.0,2.2);
					staminaregenfinal = staminaregenfinal * temp;
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 17: Weapons]: %d\c-, Previous: %d, temp: %.8f", staminaregenfinal, staminaregenbase, temp);
				
				// "Cleared of Mind" Perks
				staminaregenbase = staminaregenfinal;
				PerkFactor = 80;
				if (ClearMindPerkLvl > 0)
				{
					perkfactor = 80 - ((ClearMindPerkLvl * 2) + (ClearMindEXPerkLvl * 5));
					staminaregenfinal = floor(staminaregenfinal * perkfactor / 80);
				}
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 18: Cleared of Mind Perk]: %d\c-, Previous: %d, Factor: %d / 80", staminaregenfinal, staminaregenbase, PerkFactor);
				
				// Check Musou Power Trip Mode
				staminaregenbase = staminaregenfinal;
				if (dvds_musou_powertripmode == 1) staminaregenfinal = ceil(staminaregenfinal * 0.4); // 40%
				if (dvds_musou_powertripmode == 2) staminaregenfinal = ceil(staminaregenfinal * 0.2); // 20%
				if (debugstamregen && staminaregenfinal != staminaregenbase) Console.Printf("    \cgStamina Degeneration [Step 19: Musou/Power Trip Mode]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);
				
				// Low Caps Degen to -1 tic minimum
				staminaregenbase = staminaregenfinal;
				if (StamRegenBonPenTimer > 0) staminaregenfinal *= (1.0 / StamRegenBonPenMulti);
				if (StamRegenBonPenTimer < 0) staminaregenfinal *= StamRegenBonPenMulti;
				if (staminaregenfinal > -1) staminaregenfinal = -1;
				if (debugstamregen) Console.Printf("    \cgStamina Degeneration [Step 20: LowCap/FINAL]: %d\c-, Previous: %d", staminaregenfinal, staminaregenbase);

				if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
				else // If Player is "Conscious", allow their Stamina Regen to Count
				{
					CurrentStamina += staminaregenfinal;
					CurrentStamina = clamp(CurrentStamina, MaximumStamina, CurrentStamina);
					CallACS("MiscVarSetDECORATE",21,CurrentStamina);
					CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
				}
				if (debugstamregen) Console.Printf("    \cgStamina Degeneration: %d / %d\c-, Loss: %d", CurrentStamina, MaximumStamina, staminaregenfinal);
			}
		}
	}

	void A_PSI1DoEffectMasterPerkCheck()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			perks3mastered = 0;
			if (LifeUpPerkLvl >= 5) perks3mastered++;
			if (MagiUpPerkLevel >= 5) perks3mastered++;
			if (StamUpPerkLvl >= 5) perks3mastered++;
			if (DodgeMorePerkLvl >= 5) perks3mastered++;
			if (JmpMorePerkLvl >= 5) perks3mastered++;
			if (PsychFstPerkLvl >= 5) perks3mastered++;
			if (RegHPFstPerkLvl >= 5) perks3mastered++;
			if (RegMPFstPerkLvl >= 5) perks3mastered++;
			if (RegStamFastLvl >= 5) perks3mastered++;
			if (BulletAccPerkLvl >= 5) perks3mastered++;
			if (CallACS("MiscVarCheckDECORATE",10021) >= 5) perks3mastered++;
			if (CallACS("MiscVarCheckDECORATE",10023) >= 5) perks3mastered++;
			if (DemolitionsExpertPerkLevel >= 5) perks3mastered++;
			if (ArcheryMasteryPerkLevel >= 5) perks3mastered++;
			if (SoulMasteryPerkLevel >= 5) perks3mastered++;
			if (MartialArtsMastery >= 5) perks3mastered++;
			if (CallACS("MiscVarCheckDECORATE",10037) >= 7) perks3mastered++;
			if (DeathRagePerkLvl >= 3) perks3mastered++;
			if (OTMPerkLvl >= 5) perks3mastered++;
			if (CallACS("MiscVarCheckDECORATE",10047) >= 5) perks3mastered++;
			if (CharacterClass == 1)
			{
				if (CallACS("MiscVarCheckDECORATE",10049) >= 4) perks3mastered++;
			}
			else
			{
				if (CallACS("MiscVarCheckDECORATE",10049) >= 5) perks3mastered++;
			}
			if (CallACS("MiscVarCheckDECORATE",10050) >= 4) perks3mastered++;
			if (BerserkerFit >= 5) perks3mastered++;
			if (WandMasteryPerkLevel >= 5) perks3mastered++;
			if (ClearMindPerkLvl >= 5) perks3mastered += 2;
			
			if (perks3mastered >= 15) // Higher Learning Lvl 2 Enabled
			{
				owner.A_GiveInventory("HigherLearning2Gained",1);
				CallACS("MiscVarSetDECORATE",11001,2);
				if (owner.CountInv("HigherLearning2Gained") == 1) owner.A_StartSound("menu/higherlearning",160,CHANF_DEFAULT,1.75,ATTN_NORM);
			}
			else if (perks3mastered >= 5) // Higher Learning Enabled
			{ 
				owner.A_GiveInventory("HigherLearningGained",1);
				CallACS("MiscVarSetDECORATE",11001,1);
				if (owner.CountInv("HigherLearningGained") == 1) owner.A_StartSound("menu/higherlearning",160,CHANF_DEFAULT,1.5,ATTN_NORM);
			}
			else // Higher Learning Disabled
			{ 
				owner.A_SetInventory("HigherLearning2Gained",0);
				owner.A_SetInventory("HigherLearningGained",0);
				CallACS("MiscVarSetDECORATE",11001,0); 
			}
			
			CallACS("MiscVarSetDECORATE",40,perks3mastered);
			
			/*
			// Future Mastery Perk to come for having 768+ Aeon Pts spent on Perks
			aeonptsperksused = CallACS("MiscVarCheckDECORATE",42);
			int perkbasevalue = (768 * dvdsperks_costratio) / 100;
			int perkbasevalue2 = ((768 * 3) * dvdsperks_costratio) / 100;
			if (aeonptsperksused >= perkbasevalue2)
			{
				CallACS("MiscVarSetDECORATE",11002,2); 
			}
			else if (aeonptsperksused >= perkbasevalue)
			{
				CallACS("MiscVarSetDECORATE",11002,1); 
			}
			else
			{
				CallACS("MiscVarSetDECORATE",11002,0); 
			}
			*/
		}
	}
	
	// Perk Checks
	void A_PSI1DoEffectHPMPPerkCheck()
	{
		//*********************
		//*HP & MP Perk Checks*
		//*********************
		int TempCombinedLevels = 0;
		int TempStartValue, TempEndValue;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			// "LifeUp [EX]" perks
			TempCombinedLevels = LifeUpPerkLvl + LifeUpExPerkLvl;
			if (LifeUpPerkComboCheck != TempCombinedLevels)
			{
				if (LifeUpPerkComboCheck != 0)
				{
					LifeUpPerkBaseFactor = LifeUpPerkFactor;
					TempStartValue = MaxHealthTrue;
					TempEndValue = MaxHealthTrue;
					TempEndValue = TempEndValue * ((1000000 / LifeUpPerkFactor)) / 1000;
					TempEndValue += random[statitem](0,1);
				}
				else
				{
					LifeUpPerkBaseFactor = 1000;
					TempStartValue = MaxHealthTrue;
					TempEndValue = MaxHealthTrue;
				}
				LifeUpPerkFactor = (LifeUpPerkLvl * 50) + (LifeUpExPerkLvl * 125) + 1000;
				
				TempStartValue = TempEndValue;
				TempEndValue = TempEndValue * LifeUpPerkFactor / 1000;
				TempEndValue += random[statitem](0,1);
				
				CallACS("OtherVarSetDECORATE",0,TempEndValue);
				MaxHealthTrue = CallACS("StatCheck",1); // Refresh Var Check for MaxHP
				
				LifeUpPerkComboCheck = TempCombinedLevels;
			}
			
			// [STRIFE-Compatibility] Stamina Upgrades [HP side]
			TempCombinedLevels = StrifeStamLvl;
			if (StamUpgradeHPComboCheck != TempCombinedLevels)
			{
				if (StamUpgradeHPComboCheck != 0)
				{
					StamUpgradeHPPerkBaseFactor = StamUpgradeHPPerkFactor;
					TempStartValue = MaxHealthTrue;
					TempEndValue = MaxHealthTrue;
					TempEndValue = TempEndValue * ((1000000 / StamUpgradeHPPerkFactor)) / 1000;
					TempEndValue += random[statitem](0,1);
				}
				else
				{
					StamUpgradeHPPerkBaseFactor = 1000;
					TempStartValue = MaxHealthTrue;
					TempEndValue = MaxHealthTrue;
				}
				StamUpgradeHPPerkFactor = (StrifeStamLvl * 125) + 1000;
				
				TempStartValue = TempEndValue;
				TempEndValue = TempEndValue * StamUpgradeHPPerkFactor / 1000;
				TempEndValue += random[statitem](0,1);
				
				CallACS("OtherVarSetDECORATE",0,TempEndValue);
				MaxHealthTrue = CallACS("StatCheck",1); // Refresh Var Check for MaxHP
				
				StamUpgradeHPComboCheck = TempCombinedLevels;
			}


			// "MagiUp [EX]" perks
			TempCombinedLevels = MagiUpPerkLevel + MagiUpEXPerkLevel;
			if (MagiUpPerkComboCheck != TempCombinedLevels)
			{
				if (MagiUpPerkComboCheck != 0)
				{
					MagiUpPerkBaseFactor = MagiUpPerkFactor;
					TempStartValue = MaxMana;
					TempEndValue = MaxMana;
					TempEndValue = TempEndValue * ((1000000 / MagiUpPerkFactor)) / 1000;
					TempEndValue += random[statitem](0,1);
				}
				else
				{
					MagiUpPerkBaseFactor = 1000;
					TempStartValue = MaxMana;
					TempEndValue = MaxMana;
				}
				MagiUpPerkFactor = (MagiUpPerkLevel * 50) + (MagiUpEXPerkLevel * 125) + 1000;
				
				TempStartValue = TempEndValue;
				TempEndValue = TempEndValue * MagiUpPerkFactor / 1000;
				TempEndValue += random[statitem](0,1);
				
				CallACS("OtherVarSetDECORATE",1,TempEndValue);
				MaxMana = CallACS("StatCheck",2); // Refresh Var for MaxMP Value
				
				MagiUpPerkComboCheck = TempCombinedLevels;
			}
			
			// [STRIFE-Compatibility] Stamina Upgrades [MP side]
			TempCombinedLevels = StrifeStamLvl;
			if (StamUpgradeMPComboCheck != TempCombinedLevels)
			{
				if (StamUpgradeMPComboCheck != 0)
				{
					StamUpgradeMPPerkBaseFactor = StamUpgradeMPPerkFactor;
					TempStartValue = MaxMana;
					TempEndValue = MaxMana;
					TempEndValue = TempEndValue * ((1000000 / StamUpgradeMPPerkFactor)) / 1000;
					TempEndValue += random[statitem](0,1);
				}
				else
				{
					StamUpgradeMPPerkBaseFactor = 1000;
					TempStartValue = MaxMana;
					TempEndValue = MaxMana;
				}
				StamUpgradeMPPerkFactor = (StrifeStamLvl * 125) + 1000;
				
				TempStartValue = TempEndValue;
				TempEndValue = TempEndValue * StamUpgradeMPPerkFactor / 1000;
				TempEndValue += random[statitem](0,1);
				
				CallACS("OtherVarSetDECORATE",1,TempEndValue);
				MaxMana = CallACS("StatCheck",2); // Refresh Var for MaxMP Value
				
				StamUpgradeMPComboCheck = TempCombinedLevels;
			}
		}
	}

	// EXP Kill Combo Timer
	void A_PSI1DoEffectEXPComboTimer()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && UsingInGameMenu == 0)
		{
			int ComboRank = CallACS("MiscVarCheckDECORATE",51);
			int TimerMulti, TimerPart1;
			int tempaeonpts = 0;
			ComboTimerDelay = CallACS("MiscVarCheckDECORATE",162);
			EXPComboTimer = CallACS("MiscVarCheckDECORATE",157);
			int basecomboneeded = dvdsperks_combobase;
			int comboamount = CallACS("MiscVarCheckDECORATE",158); // Temporarily saves the kill combo counter for Aeon Point Checks
			int combolevel1 = basecomboneeded * 1; // C
			int combolevel2 = basecomboneeded * 3; // B
			int combolevel3 = basecomboneeded * 7; // A
			int combolevel4 = basecomboneeded * 12; // S
			int combolevel5 = basecomboneeded * 18; // Z
			ComboRank = -1;
			if (comboamount <= 0) ComboRank = -1;
			else if (comboamount > 0 && comboamount < combolevel1) ComboRank = 0; // Rank D
			else if (comboamount >= combolevel1 && comboamount < combolevel2) ComboRank = 1; // Rank C
			else if (comboamount >= combolevel2 && comboamount < combolevel3) ComboRank = 2; // Rank B
			else if (comboamount >= combolevel3 && comboamount < combolevel4) ComboRank = 3; // Rank A
			else if (comboamount >= combolevel4 && comboamount < combolevel5) ComboRank = 4; // Rank S
			else if (comboamount >= combolevel5) ComboRank = 5; // Rank Z
			if (dvdsdebug_showcombostuff && comboamount > 0) Console.Printf("Combo Amount: %d, Combo Rank: %d", comboamount, ComboRank);
			
			if (EXPComboTimer > 0)
			{
				if (DivineAvatarTimer > 0)
				{
					if (ComboTimerDelay >= 210) ComboTimerDelay = 210;
				}
				else
				{
					if (ComboTimerDelay >= 140) ComboTimerDelay = 140;
				}
				if (!dvds_expdmgkilldelaytimer) ComboTimerDelay = 0;
				TimerMulti = (RandomPick[statitem](20,20,20,20,20,20,20,20,20,10) * dvds_expcombotimermultiplier) / 100;
				if (ComboTimerDelay >= 0)
				{
					if (ComboRank <= 0) TimerMulti *= 0.5;
					if (ComboRank == 1) TimerMulti *= 0.334;
					if (ComboRank == 2) TimerMulti *= 0.25;
					if (ComboRank == 3) TimerMulti *= 0.167;
					if (ComboRank == 4) TimerMulti *= 0.125;
					if (ComboRank >= 5) TimerMulti *= 0.10;
					TimerMulti *= 0.8;
					ComboTimerDelay -= 1;
					if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Delay: %d", ComboTimerDelay);
				}
				if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Decrement [Step 1 - Base]: %d", TimerMulti);
				TimerPart1 = 100;
				
				if (CharacterClass == 2)
				{
					if (owner.CountInv("SafeTeaShoes")) TimerPart1 -= 10; // Item 1
					if (owner.CountInv("CloakofEvasion")) TimerPart1 -= 5; // Item 5
					if (owner.CountInv("DivineShield")) TimerPart1 -= 15; // Item 8
					if (owner.CountInv("RuinousShield")) TimerPart1 *= 2;
				}
				else
				{
					if (owner.CountInv("DSGreenArmorClass")) TimerPart1 -= 5;
					if (owner.CountInv("DSBlueArmorClass")) TimerPart1 -= 10;
					if (owner.CountInv("DSStoneArmorClass1")) TimerPart1 -= 15;
					if (owner.CountInv("DSDiamondArmorClass1")) TimerPart1 -= 20;
					if (owner.CountInv("DSStoneArmorClass2")) TimerPart1 -= 25;
					if (owner.CountInv("DSDiamondArmorClass2")) TimerPart1 -= 30;
				}
				if (owner.CountInv("TheOneRing")) TimerPart1 -= 20;
				TimerPart1 = clamp(TimerPart1, 40, 250);
				if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Decrement [Step 2 - Multiplier Base]: %d", TimerPart1);

				if (GoETimer > 0) TimerPart1 /= 5;
				if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Decrement [Step 3 - GoE Check]: %d", TimerPart1);

				TimerMulti = (TimerMulti * TimerPart1) / 100;
				
				if (TimeFreezeTimer > 0) TimerMulti = TimerMulti / 15;
				TimerMulti = clamp(TimerMulti, 1, TimerMulti);
				if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Decrement [Step 4 - Decrement Timer]: %d, Timer: %d", TimerMulti, EXPComboTimer);
				EXPComboTimer -= TimerMulti;
			}
			
			if (EXPComboTimer <= 0) // Timer Runs out
			{
				tempaeonpts = 0;
				
				if (basecomboneeded > 0 && comboamount > 0)
				{
					if (ComboRank == 1) tempaeonpts = (comboamount / basecomboneeded);
					if (ComboRank == 2) tempaeonpts = (comboamount / basecomboneeded) * 1.5;
					if (ComboRank == 3) tempaeonpts = (comboamount / basecomboneeded) * 2.5;
					if (ComboRank == 4) tempaeonpts = (comboamount / basecomboneeded) * 4;
					if (ComboRank == 5) tempaeonpts = (comboamount / basecomboneeded) * 6;
					if (dvdsdebug_showcombostuff) Console.Printf("Combo Timer Decrement [Step 5 - Get Combo Amounts]: 1: %d, 2: %d, 3: %d, 4: %d, 5: %d, Current: %d, tempaeonpts: %d", combolevel1, combolevel2, combolevel3, combolevel4, combolevel5, comboamount, tempaeonpts);
					
					if (tempaeonpts > 0)
					{
						tempaeonpts *= AeonPtMulti;
						CallACS("MiscVarSetDECORATE",25,tempaeonpts,1); 
						PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
						CallACS("MiscVarSetDECORATE",224,tempaeonpts,1); 
						CallACS("MiscVarSetDECORATE",2033,105);
						if (PlayerLevel >= CallACS("MiscVarCheckDECORATE",197))
						{
							owner.A_StartSound("misc/miniquestcomplete",CHAN_AUTO,CHANF_DEFAULT,1.5,ATTN_NONE);
							owner.A_Print(String.Format("\c[orange]You have gained %d Aeon Point[s] for a high enough kill combo!\n\n\c[orange]Remember to allocate your Aeon Points as soon as possible...", tempaeonpts), 2.75, "DVDSSMLFONT");
						}
					}
				}
				
				tempaeonpts = 0;
				comboamount = 0;
				CallACS("MiscVarSetDECORATE",158,0); // Set kill counter back to 0
				CallACS("MiscVarSetDECORATE",160,0); // Set EXP Combo Amount back to 0
			}
			CallACS("MiscVarSetDECORATE",157,EXPComboTimer); // Subtract
			CallACS("MiscVarSetDECORATE",162,ComboTimerDelay); // Subtract
			CallACS("MiscVarSetDECORATE",51,ComboRank);
		}
	}
	
	void A_PSI1DoEffectHealthRatios()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && MaxHealthTrue > 0)
		{
			HealthRatio = (PlayerCurrentHealth * 1000) / MaxHealthTrue;
			HealthRatio = clamp(HealthRatio, 0, 2000);

			if (PlayerCurrentHealth <= 0) { Owner.A_SetInventory("PlayerIsDead", 1); }
			else
			{
				Owner.A_SetInventory("PlayerIsDead", 0);
				if (HealthRatio != PrevHealthRatio)
				{
					if (HealthRatio < 625)
					{
						if (HealthRatio < 167)
						{
							if (HealthRatio < 21)
							{
								Owner.A_SetInventory("CriticalHealth", 1);
								Owner.A_SetInventory("LowHealth", 0);
								Owner.A_SetInventory("DecentHealth", 0);
								Owner.A_SetInventory("NormalHealth", 0);
							}
							else 
							{
								Owner.A_SetInventory("CriticalHealth", 0);
								Owner.A_SetInventory("LowHealth", 1);
								Owner.A_SetInventory("DecentHealth", 0);
								Owner.A_SetInventory("NormalHealth", 0);
							}
						}
						else 
						{
							Owner.A_SetInventory("CriticalHealth", 0);
							Owner.A_SetInventory("LowHealth", 0);
							Owner.A_SetInventory("DecentHealth", 1);
							Owner.A_SetInventory("NormalHealth", 0);
						}
					}
					else
					{
						Owner.A_SetInventory("CriticalHealth", 0);
						Owner.A_SetInventory("LowHealth", 0);
						Owner.A_SetInventory("DecentHealth", 0);
						Owner.A_SetInventory("NormalHealth", 1);
					}
					if (PlayerCurrentHealth >= MaxHealthTrue) Owner.A_SetInventory("FullHealth", 1); else Owner.A_SetInventory("FullHealth", 0);
					
					PrevHealthRatio = HealthRatio;
				}
			}
		}
	}
	
	void A_PSI1DoEffectSkillChecker()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (Skill <= SKILL_VERY_EASY)
			{
				if (Owner.CountInv("IsSkill1") == 0) Owner.A_SetInventory("IsSkill1", 1);
				if (Owner.CountInv("IsEasySkill") == 0) Owner.A_SetInventory("IsEasySkill", 1);
			}
			if (Skill == SKILL_EASY)
			{
				if (Owner.CountInv("IsSkill2") == 0) Owner.A_SetInventory("IsSkill2", 1);
				if (Owner.CountInv("IsEasySkill") == 0) Owner.A_SetInventory("IsEasySkill", 1);
			}
			if (Skill == SKILL_NORMAL)
			{
				if (Owner.CountInv("IsSkill3") == 0) Owner.A_SetInventory("IsSkill3", 1);
			}
			if (Skill == SKILL_HARD)
			{
				if (Owner.CountInv("IsSkill4") == 0) Owner.A_SetInventory("IsSkill4", 1);
				if (Owner.CountInv("IsHardSkill") == 0) Owner.A_SetInventory("IsHardSkill", 1);
			}
			if (Skill == SKILL_VERY_HARD)
			{
				if (Owner.CountInv("IsSkill5") == 0) Owner.A_SetInventory("IsSkill5", 1);
				if (Owner.CountInv("IsHardSkill") == 0) Owner.A_SetInventory("IsHardSkill", 1);
			}
			if (Skill >= SKILL_EXTREME)
			{
				if (Owner.CountInv("IsSkill6") == 0) Owner.A_SetInventory("IsSkill6", 1);
				if (Owner.CountInv("IsHardSkill") == 0) Owner.A_SetInventory("IsHardSkill", 1);
			}
		}
	}
	
	// RadiusDamageFactor
	void A_PSI1DoEffectRadDmgFactor()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		//**********************
		//**RadiusDamageFactor**
		//**********************
		if (playeractor)
		{
			double TotalRDFactor = 1.00;

			double EWShieldRDFactor = 1.00;
			If (weapon is "EvilWarriorShield") 
			{
				int HellWarriorShieldLevel = CallACS("MiscVarCheckDECORATE",300);
				EWShieldRDFactor *= (0.67 - (HellWarriorShieldLevel * 0.0125));
				if (Owner.CountInv("EWShieldDefendMode")) EWShieldRDFactor *= (0.134 - (HellWarriorShieldLevel * 0.01));
				if (Owner.CountInv("EWShieldDefendModeExtra")) EWShieldRDFactor *= (0.0268 - (HellWarriorShieldLevel * 0.002));
			}

			double PlayerFistBlockRDFactor = 1.00;
			if (Owner.CountInv("FistPlayerBlock")) PlayerFistBlockRDFactor *= 0.5;
			if (Owner.CountInv("FistPlayerBlock2")) PlayerFistBlockRDFactor *= 0.375;
			if (Owner.CountInv("FistPlayerBlock3")) PlayerFistBlockRDFactor *= 0.25;
			if (Owner.CountInv("FistPlayerBlock4")) PlayerFistBlockRDFactor *= 0.125;
			if (Owner.CountInv("FistPlayerBlockExtra")) PlayerFistBlockRDFactor *= 0.1;
			
			double ArmorRDFactor = 1.00;
			if (CharacterClass == 0 || CharacterClass == 1)
			{
				if (Owner.CountInv("DSGreenArmorClass")) ArmorRDFactor -= 0.01;
				if (Owner.CountInv("DSBlueArmorClass")) ArmorRDFactor -= 0.04;
				if (Owner.CountInv("DSStoneArmorClass1")) ArmorRDFactor -= 0.15;
				if (Owner.CountInv("DSDiamondArmorClass1")) ArmorRDFactor -= 0.075;
				if (Owner.CountInv("DSStoneArmorClass2")) ArmorRDFactor -= 0.30;
				if (Owner.CountInv("DSDiamondArmorClass2")) ArmorRDFactor -= 0.35;
			}
			if (CharacterClass == 2)
			{
				if (Owner.CountInv("WaterFlyingDress")) ArmorRDFactor -= 0.20;
				if (Owner.CountInv("BalrogRing")) ArmorRDFactor -= 0.25;
			}

			// "Demolition Expert" Perk
			double DemoExpertRDFactor = 1.00;
			DemoExpertRDFactor = 1.00 - ((DemolitionsExpertPerkLevel * frandompick[demordfactor](0.105,0.1575,0.21)) + (DemolitionsExpertEXPerkLevel * frandompick[demordfactor2](0.2625,0.39375,0.525))); 
			if (DemoExpertRDFactor < 0.025) DemoExpertRDFactor = 0.025;

			// Death Rage [Invulnerablity?]
			double DeathRageRDFactor = 1.0;
			if (DeathRageTimer > 0) DeathRageRDFactor = 0.0;
			
			// DQ Buffs
			double DQBuffRDFactor = 1.00;
			if (DQBuffTimer > 0) DQBuffRDFactor *= 0.50; // Buff
			if (DQSapTimer > 0) DQBuffRDFactor *= 2.00; // Sap
			if (SleepTimer > 0) // Sleep
			{
				if (random[statitem](1,16) == 1) DQBuffRDFactor *= 5.0; else DQBuffRDFactor *= 1.25;
			}

			// Sceptre Swinging [DEFENSIVE]
			double SceptreDefenseRDFactor = 1.0;
			if (Owner.CountInv("PrimingSceptre")) SceptreDefenseRDFactor *= (0.985 - (CallACS("OtherVarCheckDECORATE",11) * 0.015));
			if (Owner.CountInv("SwingDefense0")) SceptreDefenseRDFactor *= 0.95;
			if (Owner.CountInv("SwingDefense1")) SceptreDefenseRDFactor *= 0.8333;
			if (Owner.CountInv("SwingDefense2")) SceptreDefenseRDFactor *= 0.6666;
			if (Owner.CountInv("SwingDefense3")) SceptreDefenseRDFactor *= 0.5;
			if (Owner.CountInv("ShieldDefense")) SceptreDefenseRDFactor *= 0.5;
			if (Owner.CountInv("ShieldDefense2")) SceptreDefenseRDFactor *= 0.25;
			if (Owner.CountInv("ShieldDefense3")) SceptreDefenseRDFactor *= 0.06125;
			if (Owner.CountInv("SceptreSpinDefense1")) SceptreDefenseRDFactor *= 0.9375;
			if (Owner.CountInv("SceptreSpinDefense2")) SceptreDefenseRDFactor *= 0.875;
			if (Owner.CountInv("SceptreSpinDefense3")) SceptreDefenseRDFactor *= 0.75;
			if (Owner.CountInv("SceptreSpinDefense4")) SceptreDefenseRDFactor *= 0.5;

			TotalRDFactor = 1.00
										* EWShieldRDFactor
										* PlayerFistBlockRDFactor
										* ArmorRDFactor
										* DemoExpertRDFactor
										* DeathRageRDFactor
										* DQBuffRDFactor
										* SceptreDefenseRDFactor;

			double BaseIgnoreFactor = 0.0;
			double DefenseIgnoreFactor = 0.0;
			if (playeractor && playeractor.PlayerDefenseIgnoreFactor > 0.00)
			{
				BaseIgnoreFactor = (1.0 - TotalRDFactor);
				DefenseIgnoreFactor = BaseIgnoreFactor * playeractor.PlayerDefenseIgnoreFactor;
				TotalRDFactor += DefenseIgnoreFactor;
			}
			
			if (GoETimer > 0) TotalRDFactor *= 0.1;
			owner.RadiusDamageFactor = TotalRDFactor;

			int predmg = 0;
			if (playeractor && playeractor.mobjdmg > 0) 
			{
				predmg = playeractor.mobjdmg;
				playeractor.mobjdmg = 0;
			}
			if (dvdsdebug_playerdmgdisplays && predmg > 0) 
			{
				Console.Printf("    \czRADIUSDAMAGE\c-: \cxTotalRDFactor = %.8f\c-, EWShieldRDFactor = %.8f, PlayerFistBlockRDFactor = %.8f, ArmorRDFactor = %.8f, DemoExpertRDFactor = %.8f, DeathRageRDFactor = %.8f, DQBuffRDFactor = %.8f, SceptreDefenseRDFactor = %.8f", 
				TotalRDFactor, 
				EWShieldRDFactor, PlayerFistBlockRDFactor, 
				ArmorRDFactor, 
				DemoExpertRDFactor, DeathRageRDFactor, 
				DQBuffRDFactor, SceptreDefenseRDFactor);
			}
		}
	}
	
	void A_PSI1DoEffectSeedChecks()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			int SeedLimit = CallACS("MiscVarCheckDECORATE",29);
			// for the Seed limit amount [to be used in more than one script]
			if (TrueGameSkill <= SKILL_VERY_EASY) SeedLimit = 128;
			if (TrueGameSkill == SKILL_EASY) SeedLimit = 120;
			if (TrueGameSkill == SKILL_NORMAL) SeedLimit = 112;
			if (TrueGameSkill == SKILL_HARD) SeedLimit = 104;
			if (TrueGameSkill == SKILL_VERY_HARD) SeedLimit = 96;
			if (TrueGameSkill == SKILL_EXTREME) SeedLimit = 88;
			if (TrueGameSkill == SKILL_HORRIBLE) SeedLimit = 80;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) SeedLimit = 72;
			if (TrueGameSkill >= SKILL_OMEGA) SeedLimit = 64;
			if (ModType == 0) SeedLimit *= 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife
			CallACS("MiscVarSetDECORATE",29,SeedLimit);
			
			int SeedLimit2 = CallACS("MiscVarCheckDECORATE",28);
			// for the Seed of Skill limit amount [to be used in more than one script]
			if (TrueGameSkill <= SKILL_VERY_EASY) SeedLimit2 = 32;
			if (TrueGameSkill == SKILL_EASY) SeedLimit2 = 30;
			if (TrueGameSkill == SKILL_NORMAL) SeedLimit2 = 28;
			if (TrueGameSkill == SKILL_HARD) SeedLimit2 = 26;
			if (TrueGameSkill == SKILL_VERY_HARD) SeedLimit2 = 24;
			if (TrueGameSkill == SKILL_EXTREME) SeedLimit2 = 22;
			if (TrueGameSkill == SKILL_HORRIBLE) SeedLimit2 = 20;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) SeedLimit2 = 16;
			if (TrueGameSkill >= SKILL_OMEGA) SeedLimit2 = 14;
			if (ModType == 0) SeedLimit2 *= 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife
			CallACS("MiscVarSetDECORATE",28,SeedLimit2);
			
			int FyggLimit = CallACS("MiscVarCheckDECORATE",26);
			// for the Fygg limit amount [to be used in more than one script]
			if (TrueGameSkill <= SKILL_VERY_EASY) FyggLimit = 3;
			if (TrueGameSkill == SKILL_EASY) FyggLimit = 3;
			if (TrueGameSkill == SKILL_NORMAL) FyggLimit = 3;
			if (TrueGameSkill == SKILL_HARD) FyggLimit = 2;
			if (TrueGameSkill == SKILL_VERY_HARD) FyggLimit = 2;
			if (TrueGameSkill == SKILL_EXTREME) FyggLimit = 2;
			if (TrueGameSkill == SKILL_HORRIBLE) FyggLimit = 1;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) FyggLimit = 1;
			if (TrueGameSkill >= SKILL_OMEGA) FyggLimit = 1;
			if (ModType == 0) FyggLimit *= 4; // 4x the usual limits on Classic Doom 1/2 / Heretic / Hexen / Strife
			CallACS("MiscVarSetDECORATE",26,FyggLimit);
		}
	}
	
	void A_PSI1DoEffectCharacterChecks()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (CharacterClass == 0) { if (Owner.CountInv("DeggarisInPlay") < 1) Owner.A_SetInventory("DeggarisInPlay",1); } else Owner.A_SetInventory("DeggarisInPlay",0);
			if (CharacterClass == 1) { if (Owner.CountInv("IlluciaInPlay") < 1) Owner.A_SetInventory("IlluciaInPlay",1); } else Owner.A_SetInventory("IlluciaInPlay",0);
			if (CharacterClass == 2) { if (Owner.CountInv("FloraInPlay") < 1) Owner.A_SetInventory("FloraInPlay",1); } else Owner.A_SetInventory("FloraInPlay",0);
			if (CharacterClass == 8) { if (Owner.CountInv("AilishInPlay") < 1) Owner.A_SetInventory("AilishInPlay",1); } else Owner.A_SetInventory("AilishInPlay",0);
			if (CharacterClass == 9) { if (Owner.CountInv("PetraInPlay") < 1) Owner.A_SetInventory("PetraInPlay",1); } else Owner.A_SetInventory("PetraInPlay",0);
			
			if (CharacterClass == 2)
			{
				// Slot 1
				if (Owner.CountInv("Chainsaw")) Owner.A_SetInventory("Chainsaw", 0);
				if (Owner.CountInv("Chainsaw2")) Owner.A_SetInventory("Chainsaw2", 0);
				// Slot 2
				if (Owner.CountInv("FloraLearnedPistols") == 0)
				{
					if (Owner.CountInv("Pistol")) Owner.A_SetInventory("Pistol", 0);
					if (Owner.CountInv("Pistol2")) Owner.A_SetInventory("Pistol2", 0);
					CallACS("MiscVarSetDECORATE",25039,0);
				}
				else
				{
					CallACS("MiscVarSetDECORATE",25039,1);
				}
				// Slot 3
				if (Owner.CountInv("Shotgun")) Owner.A_SetInventory("Shotgun", 0);
				if (Owner.CountInv("Shotgun2")) Owner.A_SetInventory("Shotgun2", 0);
				// Slot 4
				if (Owner.CountInv("Chaingun")) Owner.A_SetInventory("Chaingun", 0);
				if (Owner.CountInv("Chaingun2")) Owner.A_SetInventory("Chaingun2", 0);
				// Slot 5
				if (Owner.CountInv("RocketLauncher")) Owner.A_SetInventory("RocketLauncher", 0);
				if (Owner.CountInv("RocketLauncher2")) Owner.A_SetInventory("RocketLauncher2", 0);
				// Slot 6
				if (Owner.CountInv("PlasmaRifle")) Owner.A_SetInventory("PlasmaRifle", 0);
				if (Owner.CountInv("PlasmaRifle2")) Owner.A_SetInventory("PlasmaRifle2", 0);
				if (Owner.CountInv("Railgun2")) Owner.A_SetInventory("Railgun2", 0);
				if (Owner.CountInv("Repeater2")) Owner.A_SetInventory("Repeater2", 0);
				if (Owner.CountInv("Karasawa2")) Owner.A_SetInventory("Karasawa2", 0);
				// Slot 7
				if (Owner.CountInv("BFG9000")) Owner.A_SetInventory("BFG9000", 0);
				if (Owner.CountInv("BFG90002")) Owner.A_SetInventory("BFG90002", 0);
			}
			else
			{
				// Slot 1
				if (Owner.CountInv("SceptreOfEmpyrea")) Owner.A_SetInventory("SceptreOfEmpyrea", 0);
				if (Owner.CountInv("DoubleBladedChainsaw") && Owner.CountInv("Chainsaw2")) Owner.A_SetInventory("Chainsaw2", 0);
				// Slot 3
				if (Owner.CountInv("DiarisLongbow")) Owner.A_SetInventory("DiarisLongbow", 0);
				// Slot 4
				if (Owner.CountInv("ImpSoul")) Owner.A_SetInventory("ImpSoul", 0);
				if (Owner.CountInv("DarkImpSoul")) Owner.A_SetInventory("DarkImpSoul", 0);
				if (Owner.CountInv("CacodemonSoul")) Owner.A_SetInventory("CacodemonSoul", 0);
				if (Owner.CountInv("CacolanternSoul")) Owner.A_SetInventory("CacolanternSoul", 0);
				if (Owner.CountInv("AbaddonSoul")) Owner.A_SetInventory("AbaddonSoul", 0);
				// Slot 5
				if (Owner.CountInv("KnightSoul")) Owner.A_SetInventory("KnightSoul", 0);
				if (Owner.CountInv("BaronSoul")) Owner.A_SetInventory("BaronSoul", 0);
				if (Owner.CountInv("BelphegorSoul")) Owner.A_SetInventory("BelphegorSoul", 0);
				if (Owner.CountInv("BruiserSoul")) Owner.A_SetInventory("BruiserSoul", 0);
				if (Owner.CountInv("ArchonSoul")) Owner.A_SetInventory("ArchonSoul", 0);
				if (Owner.CountInv("PyroDemonSoul")) Owner.A_SetInventory("PyroDemonSoul", 0);
				// Slot 6
				if (Owner.CountInv("IncarnateSoul")) Owner.A_SetInventory("IncarnateSoul", 0);
				if (Owner.CountInv("ArchvileSoul")) Owner.A_SetInventory("ArchvileSoul", 0);
				if (Owner.CountInv("DiabloistSoul")) Owner.A_SetInventory("DiabloistSoul", 0);
				if (Owner.CountInv("BalrogSoul")) Owner.A_SetInventory("BalrogSoul", 0);
				// Slot 7
				if (Owner.CountInv("HElementalSoul")) Owner.A_SetInventory("HElementalSoul", 0);
				if (Owner.CountInv("HOverlordSoul")) Owner.A_SetInventory("HOverlordSoul", 0);
			}
		}
	}
	
	// Stamina
	void A_PSI1DoEffectStaminaCalc()
	{
		//****************
		//**Stamina Calc**
		//****************
		int debugstamregen = dvdsdebug_showstaminaregenstuff;
		MaximumStamina = 10000;
		int prevcount;
		int PreviousStaminaMax = MaximumStamina;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			prevcount = MaximumStamina;
			if (CharacterClass == 2)
			{
				if (Owner.CountInv("WaterFlyingDress")) MaximumStamina += 1000; // +10.00%
				if (Owner.CountInv("FalconKnifeEarrings")) MaximumStamina += 1750; // +17.50%
				if (Owner.CountInv("DivineShield")) MaximumStamina += 500; // +5.00%
				if (Owner.CountInv("BalrogRing")) MaximumStamina += 1250; // +12.50%
				// Total = 45.00%
			}
			else
			{
				// Armor
				if (Owner.CountInv("DSGreenArmorClass")) MaximumStamina += 125; // +1.25%
				if (Owner.CountInv("DSBlueArmorClass")) MaximumStamina += 250; // +2.5%
				if (Owner.CountInv("DSStoneArmorClass1")) MaximumStamina += 500; // +5%
				if (Owner.CountInv("DSDiamondArmorClass1")) MaximumStamina += 1000; // +10%
				if (Owner.CountInv("DSStoneArmorClass2")) MaximumStamina += 1250; // +12.5%
				if (Owner.CountInv("DSDiamondArmorClass2")) MaximumStamina += 2500; // +25%
				// Other
				// To Be Added [maybe]
			}
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 1 - Armor Check]: %d, Previously: %d", MaximumStamina, PreviousStaminaMax);

			// Stats
			int staminastatfactor = 0;
			SkillFactor = 0;
			// Agility
			if (CharacterClass == 0) SkillFactor = PlayerAGL * 6;
			if (CharacterClass == 1) SkillFactor = PlayerAGL * 8;
			if (CharacterClass == 2) SkillFactor = PlayerAGL * 10;
			if (CharacterClass == 8) SkillFactor = PlayerAGL * 10;
			if (CharacterClass == 9) SkillFactor = PlayerAGL * 8;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2a - Stam - Stat Gain (AGL)]: %d, AGLAdd: %d, AGL: %d", staminastatfactor, SkillFactor, PlayerAGL);

			// Defense
			if (CharacterClass == 0) SkillFactor = PlayerDEF * 10;
			if (CharacterClass == 1) SkillFactor = PlayerDEF * 8;
			if (CharacterClass == 2) SkillFactor = PlayerDEF * 6;
			if (CharacterClass == 8) SkillFactor = PlayerDEF * 5;
			if (CharacterClass == 9) SkillFactor = PlayerDEF * 10;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2b - Stam - Stat Gain (DEF)]: %d, DEFAdd: %d, DEF: %d", staminastatfactor, SkillFactor, PlayerDEF);

			// Deftness
			if (CharacterClass == 0) SkillFactor = PlayerDFT * 8;
			if (CharacterClass == 1) SkillFactor = PlayerDFT * 8;
			if (CharacterClass == 2) SkillFactor = PlayerDFT * 8;
			if (CharacterClass == 8) SkillFactor = PlayerDFT * 8;
			if (CharacterClass == 9) SkillFactor = PlayerDFT * 8;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2c - Stam - Stat Gain (DFT)]: %d, DFTAdd: %d, DFT: %d", staminastatfactor, SkillFactor, PlayerDFT);
			
			// Sorcery
			if (CharacterClass == 0) SkillFactor = PlayerSOR * 6;
			if (CharacterClass == 1) SkillFactor = PlayerSOR * 8;
			if (CharacterClass == 2) SkillFactor = PlayerSOR * 10;
			if (CharacterClass == 8) SkillFactor = PlayerSOR * 9;
			if (CharacterClass == 9) SkillFactor = PlayerSOR * 7;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2d - Stam - Stat Gain (SOR)]: %d, SORAdd: %d, SOR: %d", staminastatfactor, SkillFactor, PlayerSOR);
			
			// Strength
			if (CharacterClass == 0) SkillFactor = PlayerSTR * 10;
			if (CharacterClass == 1) SkillFactor = PlayerSTR * 8;
			if (CharacterClass == 2) SkillFactor = PlayerSTR * 6;
			if (CharacterClass == 8) SkillFactor = PlayerSTR * 4;
			if (CharacterClass == 9) SkillFactor = PlayerSTR * 6;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2e - Stam - Stat Gain (STR)]: %d, STRAdd: %d, STR: %d", staminastatfactor, SkillFactor, PlayerSTR);
			
			// Therapeusis
			if (CharacterClass == 0) SkillFactor = PlayerTHE * 8;
			if (CharacterClass == 1) SkillFactor = PlayerTHE * 8;
			if (CharacterClass == 2) SkillFactor = PlayerTHE * 8;
			if (CharacterClass == 8) SkillFactor = PlayerTHE * 8;
			if (CharacterClass == 9) SkillFactor = PlayerTHE * 8;
			staminastatfactor += SkillFactor;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum [Step 2f - Stam - Stat Gain (THE)]: %d, THEAdd: %d, THE: %d", staminastatfactor, SkillFactor, PlayerTHE);

			SkillFactor = 0;
			PreviousStaminaMax = MaximumStamina;
			// Final Calc
			if (TrueGameSkill <= SKILL_VERY_EASY) SkillFactor = 10000;
			if (TrueGameSkill == SKILL_EASY) SkillFactor = 11250;
			if (TrueGameSkill == SKILL_NORMAL) SkillFactor = 12500;
			if (TrueGameSkill == SKILL_HARD) SkillFactor = 15000;
			if (TrueGameSkill == SKILL_VERY_HARD) SkillFactor = 20000;
			if (TrueGameSkill == SKILL_EXTREME) SkillFactor = 21250;
			if (TrueGameSkill == SKILL_HORRIBLE) SkillFactor = 22500;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillFactor = 23750;
			if (TrueGameSkill >= SKILL_OMEGA) SkillFactor = 25000;
			staminastatfactor += SkillFactor;
			MaximumStamina = MaximumStamina * staminastatfactor / SkillFactor;
			if (debugstamregen && MaximumStamina != PreviousStaminaMax) Console.Printf("    \cfStamina Maximum [Step 2X - Stam - Stat Gain]: %d, Previously: %d", MaximumStamina, PreviousStaminaMax);

			PreviousStaminaMax = MaximumStamina;
			SkillFactor = ((StamUpPerkLvl * 500) + (StamUpEXPerkLvl * 1250)) + 10000;
			MaximumStamina = MaximumStamina * SkillFactor / 10000; // "StamUp" and "StamUp EX" perks.
			if (debugstamregen && MaximumStamina != PreviousStaminaMax) Console.Printf("    \cfStamina Maximum [Step 3 - Stam Up Perk]: %d, Previously: %d", MaximumStamina, PreviousStaminaMax);
			
			PreviousStaminaMax = MaximumStamina;
			SkillFactor = 10000 + (StrifeStamLvl * 1250);
			MaximumStamina = MaximumStamina * SkillFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"
			if (debugstamregen && MaximumStamina != PreviousStaminaMax) Console.Printf("    \cfStamina Maximum [Step 4 - STRIFE - Stamina]: %d, Previously: %d", MaximumStamina, PreviousStaminaMax);
			
			MegaMaxStamina = MaximumStamina * 5;
			if (debugstamregen) Console.Printf("    \cfStamina Maximum: %d (5x: %d)", MaximumStamina, MegaMaxStamina);
			CallACS("MiscVarSetDECORATE",22,MaximumStamina);
			CallACS("MiscVarSetDECORATE",164,MegaMaxStamina);
		}
	}
	
	// Mass
	void A_PSI1DoEffectMassCalc()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		TotalMass = PreBuffMass = 100;
		if (playeractor)
		{
			if (CharacterClass == 0) // Deggaris
			{
				TotalMass = PreBuffMass = 116;
				TotalMass += (PlayerDEF / 9);		// Defense [Seeds]
				TotalMass += (PlayerSTR / 15);		// Strength [Seeds]
				TotalMass += (PlayerSOR / 27);		// Sorcery [Seeds]
				TotalMass += (PlayerTHE / 21);		// Therapeusis [Seeds]
				
				if (Owner.CountInv("DSGreenArmorClass"))		{ TotalMass += 4;  TotalMass = TotalMass * 101 / 100; }
				if (Owner.CountInv("DSBlueArmorClass"))			{ TotalMass += 8;  TotalMass = TotalMass * 102 / 100; }
				if (Owner.CountInv("DSStoneArmorClass1"))		{ TotalMass += 12; TotalMass = TotalMass * 104 / 100; }
				if (Owner.CountInv("DSDiamondArmorClass1"))	{ TotalMass += 16; TotalMass = TotalMass * 108 / 100; }
				if (Owner.CountInv("DSStoneArmorClass2"))		{ TotalMass += 12; TotalMass = TotalMass * 112 / 100; }
				if (Owner.CountInv("DSDiamondArmorClass2"))	{ TotalMass += 16; TotalMass = TotalMass * 124 / 100; }
				
				// Add a point of mass for every 8 levels for Deggaris [max of 25]
				TotalMass = TotalMass + (PlayerLevel * 0.125);
			}
			if (CharacterClass == 1) // Illucia
			{
				TotalMass = PreBuffMass = 96;
				TotalMass += (PlayerDEF / 12);		// Defense [Seeds]
				TotalMass += (PlayerSTR / 18);		// Strength [Seeds]
				TotalMass += (PlayerSOR / 21);		// Sorcery [Seeds]
				TotalMass += (PlayerTHE / 15);		// Therapeusis [Seeds]
				
				if (Owner.CountInv("DSGreenArmorClass"))		{ TotalMass += 4;  TotalMass = TotalMass * 101 / 100; }
				if (Owner.CountInv("DSBlueArmorClass"))			{ TotalMass += 8;  TotalMass = TotalMass * 102 / 100; }
				if (Owner.CountInv("DSStoneArmorClass1"))		{ TotalMass += 12; TotalMass = TotalMass * 104 / 100; }
				if (Owner.CountInv("DSDiamondArmorClass1"))	{ TotalMass += 16; TotalMass = TotalMass * 108 / 100; }
				if (Owner.CountInv("DSStoneArmorClass2"))		{ TotalMass += 12; TotalMass = TotalMass * 112 / 100; }
				if (Owner.CountInv("DSDiamondArmorClass2"))	{ TotalMass += 16; TotalMass = TotalMass * 124 / 100; }
				
				// Add a point of mass for every 10 levels for Illucia [max of 20]
				TotalMass = TotalMass + (PlayerLevel * 0.10);
			}
			if (CharacterClass == 2) // Flora
			{
				TotalMass = PreBuffMass = 68;
				TotalMass += (PlayerDEF / 15);		// Defense [Seeds]
				TotalMass += (PlayerSTR / 21);		// Strength [Seeds]
				TotalMass += (PlayerSOR / 15);		// Sorcery [Seeds]
				TotalMass += (PlayerTHE / 9);		// Therapeusis [Seeds]

				if (Owner.CountInv("SafeTeaShoes"))						TotalMass += 1;
				if (Owner.CountInv("PearlyCorset"))						TotalMass += 3;
				if (Owner.CountInv("WaterFlyingDress"))				TotalMass += 4;
				if (Owner.CountInv("EvenstarNecklace"))				TotalMass += 1;
				if (Owner.CountInv("CloakofEvasion"))					TotalMass += 3;
				if (Owner.CountInv("AnubisCufflinks"))				TotalMass += 2;
				if (Owner.CountInv("KissaBra"))								TotalMass += 1;
				if (Owner.CountInv("BalrogRing"))							TotalMass += 1;
				if (Owner.CountInv("DoveRibbon"))							TotalMass += 2;
				if (Owner.CountInv("DivineShield"))					{ TotalMass += 10; TotalMass *= 2; }
				if (Owner.CountInv("RuinousShield"))				{ TotalMass -= 10; TotalMass /= 2; }

				if (Owner.CountInv("DSSpiritualExoskin1"))	{ TotalMass += 4; TotalMass = TotalMass * 102 / 100;}
				if (Owner.CountInv("DSSpiritualExoskin2"))	{ TotalMass += 12; TotalMass = TotalMass * 106 / 100;}
				if (Owner.CountInv("DSSpiritualExoskin3"))	{ TotalMass += 30; TotalMass = TotalMass * 115 / 100;}

				if (Owner.CountInv("ShieldDefense"))				{ TotalMass = TotalMass * 5 / 4; }
				if (Owner.CountInv("ShieldDefense2"))				{ TotalMass = TotalMass * 3 / 2; }
				if (Owner.CountInv("ShieldDefense3"))				{ TotalMass = TotalMass * 15 / 8; }
				
				// Add a point of mass for every 12 levels for Flora [max of 16/17]
				TotalMass = TotalMass + (PlayerLevel * 0.08334);
			}
			if (CharacterClass == 8) // Ailish
			{
				TotalMass = PreBuffMass = 66;
				TotalMass += (PlayerDEF / 9);		// Defense [Seeds]
				TotalMass += (PlayerSTR / 15);		// Strength [Seeds]
				TotalMass += (PlayerSOR / 21);		// Sorcery [Seeds]
				TotalMass += (PlayerTHE / 21);		// Therapeusis [Seeds]

				// Add a point of mass for every 13 levels for Ailish [max of 15]
				TotalMass = TotalMass + (PlayerLevel * 0.076923);
			}
			if (CharacterClass == 9) // Petra
			{
				TotalMass = PreBuffMass = 70;
				TotalMass += (PlayerDEF / 9);		// Defense [Seeds]
				TotalMass += (PlayerSTR / 21);		// Strength [Seeds]
				TotalMass += (PlayerSOR / 23);		// Sorcery [Seeds]
				TotalMass += (PlayerTHE / 13);		// Therapeusis [Seeds]

				// Add a point of mass for every 8 levels for Petra [max of 22]
				TotalMass = TotalMass + (PlayerLevel * 0.125);
			}
			
			// Buff Timers
			if ((InvulnerabilityTimer > 0 || owner.bINVULNERABLE || owner.player.cheats & CF_GODMODE2 || owner.player.cheats & CF_GODMODE || owner.CountInv("InvulnerabilitySpell") || owner.CountInv("IsInvulnerable"))) // 128x Mass when Invulnerable
			{
				//owner.A_SpawnItemEx("InvulnerabilityAura");
				TotalMass *= 1024; 
			}
			if (BerserkTimer > 0) 
			{
				if (PlayerLevel >= 200) TotalMass *= 1.556;
				else if (PlayerLevel >= 150) TotalMass *= 1.445;
				else if (PlayerLevel >= 100) TotalMass *= 1.334;
				else if (PlayerLevel >= 50) TotalMass *= 1.223;
				else TotalMass *= 1.112;
			}
			if (DivineAvatarTimer > 0) TotalMass *= 4;		// 4x Mass when using Divine Avatar
			if (GoETimer > 0) TotalMass *= 10;		// 10x Mass when using GoE
			if (DQBuffTimer > 0) TotalMass *= 2;		// 2x Mass when using Buff

			// Sauron Items
			if (Owner.CountInv("SauronHelmet"))						{ TotalMass += 17; TotalMass = TotalMass * 117 / 100; }
			if (Owner.CountInv("SauronGauntletsIllucia"))	{ TotalMass += 6;  TotalMass = TotalMass * 106 / 100; }
			if (Owner.CountInv("SauronGauntletsFlora"))		{ TotalMass += 4;  TotalMass = TotalMass * 104 / 100; }
			if (Owner.CountInv("SauronGauntlets"))				{ TotalMass += 5;  TotalMass = TotalMass * 105 / 100; }
			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck))							{ TotalMass += 3;  TotalMass = TotalMass * 103 / 100; }
			nm = "SauronGauntletsPetra"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck))							{ TotalMass += 7;  TotalMass = TotalMass * 107 / 100; }
			if (Owner.CountInv("TheOneRing"))							{ TotalMass += 17; TotalMass = TotalMass * 117 / 100; }
			
			// Fist Blocks
			if (Owner.CountInv("FistPlayerBlock"))  TotalMass = TotalMass * 2;
			if (Owner.CountInv("FistPlayerBlock2")) TotalMass = TotalMass * 2.667;
			if (Owner.CountInv("FistPlayerBlock3")) TotalMass = TotalMass * 4;
			if (Owner.CountInv("FistPlayerBlock4")) TotalMass = TotalMass * 7.5;

			// Final Calculations
			owner.mass = TotalMass;
			CallACS("MiscVarSetDECORATE",201,TotalMass); // Set to the Total Mass
			//Console.Printf("    Calculated Mass: %d [Real Mass: %d]", TotalMass, owner.mass);
		}
	}

	// JumpZ
	void A_PSI1DoEffectJumpCalc()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		int debugjump = dvdsdebug_jumpzdisplays;
		if (playeractor)
		{
			double CharacterJumpZ = 8.0;
			if (CharacterClass == 0) CharacterJumpZ = 7.5;
			if (CharacterClass == 1) CharacterJumpZ = 8.5;
			if (CharacterClass == 2) CharacterJumpZ = 9.0;
			if (CharacterClass == 8) CharacterJumpZ = 7.0;
			if (CharacterClass == 9) CharacterJumpZ = 9.5;
			

			// Level
			double LevelJumpZ = 1.00;
			if (CharacterClass == 0) LevelJumpZ += (PlayerLevel * 0.00226);
			if (CharacterClass == 1) LevelJumpZ += (PlayerLevel * 0.00256);
			if (CharacterClass == 2) LevelJumpZ += (PlayerLevel * 0.00276);
			if (CharacterClass == 8) LevelJumpZ += (PlayerLevel * 0.00216);
			if (CharacterClass == 9) LevelJumpZ += (PlayerLevel * 0.00296);

			// AGL
			double AGLJumpZ = 1.00;
			if (CharacterClass == 0) AGLJumpZ += (PlayerAGL * 0.00076);
			if (CharacterClass == 1) AGLJumpZ += (PlayerAGL * 0.00086);
			if (CharacterClass == 2) AGLJumpZ += (PlayerAGL * 0.00093);
			if (CharacterClass == 8) AGLJumpZ += (PlayerAGL * 0.00070);
			if (CharacterClass == 9) AGLJumpZ += (PlayerAGL * 0.00100);

			// Armor
			double ArmorJumpZ = 1.00;
			if (CharacterClass == 2)
			{
				if (Owner.CountInv("SafeTeaShoes")) 				ArmorJumpZ += 0.10;
				if (Owner.CountInv("PearlyCorset")) 				ArmorJumpZ += 0.005;
				if (Owner.CountInv("WaterFlyingDress"))			ArmorJumpZ += 0.005;
				if (Owner.CountInv("EvenstarNecklace"))			ArmorJumpZ += 0.0125;
				if (Owner.CountInv("CloakofEvasion"))				ArmorJumpZ += 0.025;
				if (Owner.CountInv("AnubisCufflinks"))			ArmorJumpZ += 0.0125;
				if (Owner.CountInv("KissaBra"))							ArmorJumpZ += 0.025;
				if (Owner.CountInv("DivineShield"))					ArmorJumpZ += 0.00625;
				if (Owner.CountInv("BalrogRing"))						ArmorJumpZ += 0.0125;
				if (Owner.CountInv("DoveRibbon"))						ArmorJumpZ += 0.05;
				if (Owner.CountInv("FalconKnifeEarrings"))	ArmorJumpZ += 0.0375;
			}
			else
			if (CharacterClass == 0 || CharacterClass == 1)
			{
				if (Owner.CountInv("DSGreenArmorClass"))		ArmorJumpZ += 0.0334;
				if (Owner.CountInv("DSBlueArmorClass"))			ArmorJumpZ += 0.05;
				if (Owner.CountInv("DSStoneArmorClass1"))		ArmorJumpZ += 0.0667;
				if (Owner.CountInv("DSDiamondArmorClass1"))	ArmorJumpZ += 0.09;
				if (Owner.CountInv("DSStoneArmorClass2"))		ArmorJumpZ += 0.0833;
				if (Owner.CountInv("DSDiamondArmorClass2"))	ArmorJumpZ += 0.095;
			}
			
			double SauronArmorJumpZ = 1.00;
			if (Owner.CountInv("SauronHelmet"))						SauronArmorJumpZ -= 0.10;
			if (Owner.CountInv("SauronGauntlets"))				SauronArmorJumpZ -= 0.05;
			if (Owner.CountInv("SauronGauntletsIllucia"))	SauronArmorJumpZ -= 0.05;
			if (Owner.CountInv("SauronGauntletsFlora"))		SauronArmorJumpZ -= 0.05;
			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck))							SauronArmorJumpZ -= 0.05;
			nm = "SauronGauntletsPetra"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck))							SauronArmorJumpZ -= 0.05;
			if (Owner.CountInv("TheOneRing"))							SauronArmorJumpZ += 0.25;

			double BuffJumpZ = 1.00;
			if (DQAcceleratleTimer > 0) BuffJumpZ += 0.25;
			if (DQDeceleratleTimer > 0) BuffJumpZ -= 0.25;
			if (BerserkTimer > 0) BuffJumpZ *= 1.334;

			double SceptreJumpZ = 1.00;
			if (SceptreShieldLevel == 1) SceptreJumpZ -= 0.20;
			if (SceptreShieldLevel == 2) SceptreJumpZ -= 0.10;
			if (SceptreShieldLevel == 3) SceptreJumpZ -= 0.05;

			double DivineAvatarJumpZ = 1.00;
			if (DivineAvatarTimer > 0) DivineAvatarJumpZ *= 2.00;

			double GoEJumpZ = 1.00;
			if (GoETimer > 0) GoEJumpZ *= 2.50;

			double PerkFactorJumpZ = 1.0;
			PerkFactorJumpZ += ((JmpMorePerkLvl * 0.05) + (JmpMoreEXPerkLvl * 0.125));

			double StaminaJumpZ = 1.0;
			int StaminaLevel;
			int StaminaMax = 10000;
			if (MaximumStamina > 0) StaminaMax = MaximumStamina;
			StaminaLevel = CurrentStamina * 10000 / StaminaMax;
			if (StaminaLevel < 157) StaminaJumpZ = -0.3375;
			if (StaminaLevel > 156 && StaminaLevel < 626) StaminaJumpZ = -0.2625;
			if (StaminaLevel > 625 && StaminaLevel < 1251) StaminaJumpZ = -0.195;
			if (StaminaLevel > 1250 && StaminaLevel < 2501) StaminaJumpZ = -0.135;
			if (StaminaLevel > 2500 && StaminaLevel < 5001) StaminaJumpZ = -0.0825;
			if (StaminaLevel > 5000 && StaminaLevel < 7501) StaminaJumpZ = -0.0375;
			if (StaminaLevel > 7500 && StaminaLevel < 12501) StaminaJumpZ = 0.00;
			if (StaminaLevel > 12500 && StaminaLevel < 20001) StaminaJumpZ = 0.0375;
			if (StaminaLevel > 20000 && StaminaLevel < 27501) StaminaJumpZ = 0.0825;
			if (StaminaLevel > 27500 && StaminaLevel < 35001) StaminaJumpZ = 0.135;
			if (StaminaLevel > 35000 && StaminaLevel < 42501) StaminaJumpZ = 0.195;
			if (StaminaLevel > 42500 && StaminaLevel < 48751) StaminaJumpZ = 0.2625;
			if (StaminaLevel > 48750) StaminaJumpZ = 0.3375;
			StaminaJumpZ *= dvds_staminaaffectsjump;
			StaminaJumpZ += 1.00;

			double FistBlockJumpZ = 1.00;
			if (Owner.CountInv("FistPlayerSpeedFactor")) FistBlockJumpZ = 0.75;
			if (Owner.CountInv("FistPlayerSpeedFactor2")) FistBlockJumpZ = 0.825;
			if (Owner.CountInv("FistPlayerSpeedFactor3")) FistBlockJumpZ = 0.90;
			if (Owner.CountInv("FistPlayerSpeedFactor4")) FistBlockJumpZ = 0.9875;
			
			double TotalJumpZ = CharacterJumpZ
												* LevelJumpZ
												* AGLJumpZ
												* ArmorJumpZ
												* SauronArmorJumpZ
												* BuffJumpZ
												* SceptreJumpZ
												* PerkFactorJumpZ
												* StaminaJumpZ
												* FistBlockJumpZ
												* DivineAvatarJumpZ
												* GoeJumpZ;

			int TrueJumpHeight = ((TotalJumpZ * (TotalJumpZ + 1.0)) / 2) + owner.maxstepheight;
			PlayerPawn(Owner).JumpZ = TotalJumpZ;
			CallACS("MiscVarSetDECORATE",200,TrueJumpHeight); // Set to the True Jump Height
			PlayerJUMP = CallACS("MiscVarCheckDECORATE",200);

			if (debugjump)
			{
				Console.Printf("    \cwTotalJumpZ:\c- \cw%.8f \cy(%.8f)\c- [\cxTrueJumpHeight:\c- \cx%d\c-, \cyMaxStepHeight: %d\c-], CharacterJumpZ: %.8f, LevelJumpZ: %.8f, AGLJumpZ: %.8f, ArmorJumpZ: %.8f, SauronArmorJumpZ: %.8f, BuffJumpZ: %.8f, SceptreJumpZ: %.8f, PerkFactorJumpZ: %.8f, StaminaJumpZ: %.8f, FistBlockJumpZ: %.8f, DivineAvatarJumpZ: %.8f, GoEJumpZ: %.8f", 
														TotalJumpZ, PlayerPawn(Owner).JumpZ, TrueJumpHeight, owner.maxstepheight,
														CharacterJumpZ, LevelJumpZ, 
														AGLJumpZ, ArmorJumpZ, 
														SauronArmorJumpZ, BuffJumpZ, 
														SceptreJumpZ, PerkFactorJumpZ, 
														StaminaJumpZ, FistBlockJumpZ, 
														DivineAvatarJumpZ, GoEJumpZ);
			}
		}
	}
	
	// Survive Rate
	void A_PSI1DoEffectSurviveCalc()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		int debugsurvival = dvdsdebug_showsurvivalstuff;
		int SurvivalRate = CallACS("MiscVarCheckDECORATE",0);
		int prevcount;
		if (playeractor)
		{
			// 0.1% for every 2 levels (max of 50 or 5.0% [max of 100 or 10.0% for Flora at Level 200])
			prevcount = SurvivalRate;
			SurvivalRate += (PlayerLevel * 0.5);
			if (debugsurvival) Console.Printf("    \cwSurvival Rate % [STEP 1 - Base]: %d\c-, Original: %d", SurvivalRate, prevcount);

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Every 3/4/5 Points of Defenses = 0.1% increase to Survivability Rate
			if (TrueGameSkill <= SKILL_VERY_EASY) SkillFactor = PlayerDEF / 3;
			if (TrueGameSkill == SKILL_EASY) SkillFactor = PlayerDEF / 3;
			if (TrueGameSkill == SKILL_NORMAL) SkillFactor = PlayerDEF / 4;
			if (TrueGameSkill == SKILL_HARD) SkillFactor = PlayerDEF / 5;
			if (TrueGameSkill == SKILL_VERY_HARD) SkillFactor = PlayerDEF / 5;
			if (TrueGameSkill == SKILL_EXTREME) SkillFactor = PlayerDEF / 6;
			if (TrueGameSkill == SKILL_HORRIBLE) SkillFactor = PlayerDEF / 6;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillFactor = PlayerDEF / 7;
			if (TrueGameSkill >= SKILL_OMEGA) SkillFactor = PlayerDEF / 8;
			SurvivalRate += SkillFactor;
			if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 2 - DefStat Check]: %d,\c- Added: %d, Difficulty Level: %d", SurvivalRate, SkillFactor, TrueGameSkill);

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Abhorrent's Equipment Set
			if (Owner.CountInv("SauronHelmet")) SkillFactor += 175; // Helmet = 17.5%
			if (Owner.CountInv("SauronGauntlets")) SkillFactor += 50; // Gauntlets (Deggaris) = 5.0%
			if (Owner.CountInv("SauronGauntletsIllucia")) SkillFactor += 60; // Gauntlets (Illucia) = 6.0%
			if (Owner.CountInv("SauronGauntletsFlora")) SkillFactor += 40; // Gauntlets (Flora) = 4.0%
			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck)) SkillFactor += 80; // Gauntlets (Ailish) = 8.0%
			nm = "SauronGauntletsPetra"; APPackCheck = nm;
			if (Owner.CountInv(APPackCheck)) SkillFactor += 70; // Gauntlets (Petra) = 7.0%
			if (Owner.CountInv("TheOneRing")) SkillFactor += 333; // The One Ring = 33.3%
			SurvivalRate += SkillFactor;
			if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 3 - Abhorrent's Check]: %d,\c- Added: %d", SurvivalRate, SkillFactor);

			prevcount = SurvivalRate;
			SkillFactor = 0;
			if (CharacterClass != 2) // Deggaris and Illucia take advantage of Doom-equse Armor, however Flora, Ailish, and Petra cannot.
			{
				if (Owner.CountInv("DSGreenArmorClass")) SkillFactor += 5; // Green Armor = 0.5% [Deggaris and Illucia Only]
				if (Owner.CountInv("DSBlueArmorClass")) SkillFactor += 10; // Blue Armor = 1.0% [Deggaris and Illucia Only]
				if (Owner.CountInv("DSStoneArmorClass1")) SkillFactor += 16; // Stone Skin [1] = 1.6% [Deggaris and Illucia Only]
				if (Owner.CountInv("DSDiamondArmorClass1")) SkillFactor += 44; // Diamond Skin [1] = 4.4% [Deggaris and Illucia Only]
				if (Owner.CountInv("DSStoneArmorClass2")) SkillFactor += 66; // Stone Skin [2] = 6.6% [Deggaris and Illucia Only]
				if (Owner.CountInv("DSDiamondArmorClass2")) SkillFactor += 176; // Diamond Skin [2] = 17.6% [Deggaris and Illucia Only]
			}
			if (CharacterClass == 2) // Items only Flora can make use of
			{
				if (Owner.CountInv("DSSpiritualExoskin1")) SkillFactor += 32; // Spiritual Exoskin = 3.2% [Flora Only]
				if (Owner.CountInv("DSSpiritualExoskin2")) SkillFactor += 96; // Greater Spiritual Exoskin = 9.6% [Flora Only]
				if (Owner.CountInv("DSSpiritualExoskin2")) SkillFactor += 288; // Perfected Spiritual Exoskin = 28.8% [Flora Only]
				if (Owner.CountInv("AnubisCufflinks")) SkillFactor += 100; // Anubis Cufflinks = 10.0% [Flora Only]
				if (Owner.CountInv("DoveRibbon")) SkillFactor += 150; // Dove Ribbon = 15.0% [Flora Only]
			}
			SurvivalRate += SkillFactor;
			if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 4 - Armor Item Check]: %d,\c- Added: %d", SurvivalRate, SkillFactor);

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Divine Avatar = (25.0% of remaining amount uncovered)
			if (DivineAvatarTimer > 0)
			{
				SkillFactor = (1000 - SurvivalRate) * 0.25;
				SurvivalRate += SkillFactor;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 5 - Divine Avatar Check]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// GoE = (62.5% of remaining amount uncovered)
			if (GoETimer > 0)
			{
				SkillFactor = (1000 - SurvivalRate) * 0.625;
				SurvivalRate += SkillFactor;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 5a - GoE Check]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// [STRIFE-Compatibility] Stamina Upgrades
			if (StrifeStamLvl > 0)
			{
				SkillFactor = StrifeStamLvl * 11;
				SurvivalRate += SkillFactor;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 6 - Strife-Stamina Perk]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}

			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Buff = (10.0% of remaining amount uncovered)
			if (DQBuffTimer > 0)
			{
				SkillFactor = (1000 - SurvivalRate) * 0.1;
				SurvivalRate += SkillFactor;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 7a - Buff Check]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}
			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Sap = (-10.0% of remaining amount uncovered)
			if (DQSapTimer > 0)
			{
				SkillFactor = (1000 - SurvivalRate) * 0.1;
				SurvivalRate -= SkillFactor;
				if (SurvivalRate < 0) SurvivalRate = 0;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 7b - Sap Check]: %d,\c- Subtracted: %d", SurvivalRate, SkillFactor);
			}
		
			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Life Up Perks = total of +6% Survival
			if (LifeUpPerkLvl > 0 || LifeUpExPerkLvl > 0)
			{
				SkillFactor = ((LifeUpPerkLvl * 6) + (LifeUpExPerkLvl * 15));
				SurvivalRate += SkillFactor;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 8 - LifeUp Perk]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}
			
			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Kissa's Armored Brassiere = 25.0%
			if (Owner.CountInv("KissaBra"))
			{
				SkillFactor += 250; 
				SurvivalRate += SkillFactor;
				SurvivalRate = clamp(SurvivalRate, SurvivalRate, 938);
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 9 - Kissa's Brassiere (Yes)]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}
			else
			{
				SurvivalRate = clamp(SurvivalRate, SurvivalRate, 875);
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 9 - Kissa's Brassiere (No)]: %d,\c- Added: %d", SurvivalRate, SkillFactor);
			}
			
			prevcount = SurvivalRate;
			SkillFactor = 0;
			// Ruinous Shield
			if (Owner.CountInv("RuinousShield"))
			{
				SkillFactor = SurvivalRate - (SurvivalRate * 0.2); // Ruinous Shield divides Survival Rate by 5
				SurvivalRate *= 0.2;
				if (debugsurvival && SurvivalRate != prevcount) Console.Printf("    \cwSurvival Rate % [STEP 10 - Ruinous Shield]: %d,\c- Subtracted: %d", SurvivalRate, SkillFactor);
			}

			SkillFactor = SurvivalRate;
			int survivecalcfactor = dvds_survivecalcfactor;
			survivecalcfactor = clamp(survivecalcfactor, 10, 1000);
			SurvivalRate = SurvivalRate * survivecalcfactor / 100;
			if (debugsurvival && SurvivalRate != SkillFactor) Console.Printf("    \cwSurvival Rate % [STEP 11 - Survive-Factor Calc]: %d,\c- Previous: %d, SurvivalCalcFactor: %d", SurvivalRate, SkillFactor, survivecalcfactor);

			SkillFactor = SurvivalRate;
			// Invulnerability
			if (InvulnerabilityTimer > 0)
			{
				SurvivalRate = 1000;
				if (debugsurvival && SurvivalRate != SkillFactor) Console.Printf("    \cwSurvival Rate % [STEP 12 - Invulnerability Check]: %d,\c- Previous: %d", SurvivalRate, SkillFactor);
			}

			SkillFactor = SurvivalRate;
			// Death Rage's Invulnerability
			if (DeathRageTimer > 0) 
			{
				SurvivalRate = 1000;
				if (debugsurvival && SurvivalRate != SkillFactor) Console.Printf("    \cwSurvival Rate % [STEP 12 - Death Rage Invulnerability Check]: %d,\c- Previous: %d", SurvivalRate, SkillFactor);
			}
			int SurviveRNGVal = random[statitem](1,1000); // Based on 0.1% to 100.0% [though the displays only show full %]

			// Transplants back to ACS for HUD displays/etc
			CallACS("MiscVarSetDECORATE",232,SurvivalRate);
			
			if (SurviveRNGVal <= SurvivalRate) owner.player.cheats |= CF_BUDDHA; else owner.player.cheats &= ~CF_BUDDHA;
			
			if (debugsurvival)
			{
				if (SurviveRNGVal <= SurvivalRate) Console.Printf("    \cdSurvival Rate % Roll / Rate: %d / %d, \cx[cheatbits: %d]", SurviveRNGVal, SurvivalRate, owner.player.cheats);
																			else Console.Printf("    \cgSurvival Rate % Roll / Rate: %d / %d, \cx[cheatbits: %d]", SurviveRNGVal, SurvivalRate, owner.player.cheats);
			}
		}
	}
	
	// Critical Hits
	void A_PSI1DoEffectCritCalc()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		//**************************
		//**Critical Hit Calc/Roll**
		//**************************
		int CriticalHitRate = CallACS("MiscVarCheckDECORATE",0);
		if (playeractor)
		{
			SkillFactor = 0;
			if (TrueGameSkill <= SKILL_VERY_EASY) CriticalHitRate /= 4;
			if (TrueGameSkill == SKILL_EASY) CriticalHitRate /= 5;
			if (TrueGameSkill == SKILL_NORMAL) CriticalHitRate /= 6; 
			if (TrueGameSkill == SKILL_HARD) CriticalHitRate /= 7; 
			if (TrueGameSkill == SKILL_VERY_HARD) CriticalHitRate /= 8;
			if (TrueGameSkill == SKILL_EXTREME) CriticalHitRate /= 8;
			if (TrueGameSkill == SKILL_HORRIBLE) CriticalHitRate /= 9;
			if (TrueGameSkill == SKILL_IMPOSSIBLE) CriticalHitRate /= 9;
			if (TrueGameSkill >= SKILL_OMEGA) CriticalHitRate /= 10;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 1 - Base]: %d\c-, Difficulty Level", CriticalHitRate, TrueGameSkill);

			// Level + Stat Calculations
			SkillFactor = (PlayerLevel * 5) / 16; // Each level is +0.03125% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2a - Stats: Level]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerAGL * 3) / 16; // 1 pt of Agility is +0.01875% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2b - Stats: Agility]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerDEF * 3) / 32; // 1 pt of Defense is +0.009375% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2c - Stats: Defense]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerDFT * 7) / 4; // 1 pt of Deftness is +0.175% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2d - Stats: Deftness]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerSOR * 1) / 32; // 1 pt of Sorcery is +0.003125% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2e - Stats: Sorcery]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerSTR * 1) / 8; // 1 pt of Strength is +0.0125% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2f - Stats: Strength]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			
			SkillFactor = (PlayerTHE * 1) / 32; // 1 pt of Therapeusis is +0.003125% crit rate
			CriticalHitRate += SkillFactor;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 2g - Stats: Therapeusis]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);

			// Oomph/Blunt
			SkillFactor = 0;
			// Oomph = (5% of remaining amount uncovered)
			if (DQOomphTimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.05;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 3a - Oomph Check]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			SkillFactor = 0;
			// Blunt = (-5% of remaining amount uncovered)
			if (DQBluntTimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.05;
				CriticalHitRate -= SkillFactor;
				CriticalHitRate = clamp(CriticalHitRate, 0, CriticalHitRate);
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 3b - Blunt Check]: %d,\c- Subtracted: %d", CriticalHitRate, SkillFactor);
			}
			
			// Acceleratle/Deceleratle
			SkillFactor = 0;
			// Acceleratle (10% of remaining amount uncovered)
			if (DQAcceleratleTimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.1;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 4a - Acceleratle Check]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			SkillFactor = 0;
			// Deceleratle (-10% of remaining amount uncovered)
			if (DQDeceleratleTimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.1;
				CriticalHitRate -= SkillFactor;
				CriticalHitRate = clamp(CriticalHitRate, 0, CriticalHitRate);
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 4b - Deceleratle Check]: %d,\c- Subtracted: %d", CriticalHitRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// Divine Avatar (12.5% of remaining amount uncovered)
			if (DivineAvatarTimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.125;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 5 - Divine Avatar Check]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// GoE (31.25% of remaining amount uncovered)
			if (GoETimer > 0)
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.3125;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 5b - GoE Check]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// [STRIFE-Compatibility] Stamina Upgrades [up to 3.125% more Crit]
			if (StrifeStamLvl > 0)
			{
				SkillFactor = (StrifeStamLvl * 25) / 8;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 6 - Strife-Stamina Perk]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// [STRIFE-Compatibility] Accuracy Upgrades [up to 1.875% more Crit]
			if (StrifeAccuLvl > 0)
			{
				SkillFactor = (StrifeAccuLvl * 15) / 8;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 6 - Strife-Accuracy Perk]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}

			double baserate;
			SkillFactor = 0;
			nm = "ImpalerXBow"; APPackCheck = nm;
			nn = "DualImpalerXBow"; APPackCheck2 = nn;
			if (weapon is APPackCheck || weapon is APPackCheck2)
			{
				baserate = 0.05 + (ArcheryMasteryPerkLevel * 0.005) + (ArcheryMasteryEXPerkLevel * 0.0125);
				if (weapon is APPackCheck2) baserate = 0.075 + (ArcheryMasteryPerkLevel * 0.0075) + (ArcheryMasteryEXPerkLevel * 0.01875);
				SkillFactor = (1000 - CriticalHitRate) * baserate;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 6x7 - Impaler XBow(s)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			nm = "ScepterOfSouls"; APPackCheck = nm;
			nn = "DualScepterOfSouls"; APPackCheck2 = nn;
			if (weapon is APPackCheck || weapon is APPackCheck2)
			{
				baserate = 0.05 + (SoulMasteryPerkLevel * 0.005) + (SoulMasteryEXPerkLevel * 0.0125);
				if (weapon is APPackCheck2) baserate = 0.075 + (SoulMasteryPerkLevel * 0.0075) + (SoulMasteryEXPerkLevel * 0.01875);
				SkillFactor = (1000 - CriticalHitRate) * baserate;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 6x7 - Scepter(s) of Souls]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}

			int MeleeWeaponCritCheck = 0;
			nm = "FistAilish"; APPackCheck = nm;
			nn = "FistPetra"; APPackCheck2 = nn;
			no = "SauronGauntletsAilish"; APPackCheck3 = no;
			np = "SauronGauntletsPetra"; APPackCheck4 = np;
			If (weapon is "FistDeggaris" || weapon is "FistIllucia" || weapon is "FistFlora" || 
					weapon is APPackCheck || weapon is APPackCheck2 ||
					weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || weapon is "SauronGauntletsFlora" || 
					weapon is APPackCheck3 || weapon is APPackCheck4 ||
					weapon is "Chainsaw2" || weapon is "DoubleBladedChainsaw" || 
					weapon is "SceptreOfEmpyrea" || weapon is "PoisonNeedle") MeleeWeaponCritCheck = 1;

			// Uppercut Bonuses
			SkillFactor = 0;
			if (Owner.CountInv("UppercutCritBonus") == 1) // up to +4% more Crit
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.04;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 7 - Uppercut Bonus (1)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			SkillFactor = 0;
			if (Owner.CountInv("UppercutCritBonus") == 2) // up to +8% more Crit
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.08;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 7 - Uppercut Bonus (2)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			
			// Kick Bonus
			SkillFactor = 0;
			if (Owner.CountInv("KickCritBonus") == 1) // up to +2.5% more Crit
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.025;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 8 - Kicking Bonus (1)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}
			if (Owner.CountInv("KickCritBonus") >= 2) // up to +6.25% more Crit
			{
				SkillFactor = (1000 - CriticalHitRate) * 0.0625;
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 8 - Kicking Bonus (2)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}


			// Dashing
			SkillFactor = 0;
			if (Owner.CountInv("PlayerDashing")) // +2% more Crit [with most melee weapons], +0.5% with other weapons
			{
				If (MeleeWeaponCritCheck == 1) SkillFactor = (1000 - CriticalHitRate) * 0.02;
																	else SkillFactor = (1000 - CriticalHitRate) * 0.005;

				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) 
				{
					If (MeleeWeaponCritCheck == 1) Console.Printf("    \cwCrit Rate % [STEP 9 - Dashing Bonus (Melee)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
																		else Console.Printf("    \cwCrit Rate % [STEP 9 - Dashing Bonus (NON-Melee)]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
				}
			}

			//if (weapon is "SceptreOfEmpyrea") MeleeWeaponCritCheck = 0;
			// Martial Arts Mastery = total of +8% Crit
			SkillFactor = 0;
			if (MartialArtsMastery > 0)
			{
				If (MeleeWeaponCritCheck == 1)
				{
					SkillFactor = (MartialArtsMastery * 8) + (MartialArtsMasteryEX * 20);
					CriticalHitRate += SkillFactor;
					if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 10a - Martial Arts Mastery]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
				}
			}
			// Berserker Fit = total of +16% Crit
			SkillFactor = 0;
			if (BerserkerFit > 0)
			{
				If (MeleeWeaponCritCheck == 1)
				{
					SkillFactor = (BerserkerFit * 16) + (BerserkerFitEX * 40);
					CriticalHitRate += SkillFactor;
					if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 10b - Berserker Fit Perk]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
				}
			}

			// Stam Up Perks = total of +2/6% Crit
			SkillFactor = 0;
			if (StamUpPerkLvl > 0)
			{
				If (MeleeWeaponCritCheck == 1) SkillFactor = (StamUpPerkLvl * 6) + (StamUpEXPerkLvl * 15);
																	else SkillFactor = (StamUpPerkLvl * 2) + (StamUpEXPerkLvl * 5);
				CriticalHitRate += SkillFactor;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 11 - Stam Up Perk]: %d,\c- Added: %d", CriticalHitRate, SkillFactor);
			}

			// Armor
			SkillFactor = CriticalHitRate;
			if (owner.CountInv("RuinousShield"))
			{
				CriticalHitRate /= 2.56;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 12 - Ruinous Shield]: %d,\c- Previous: %d", CriticalHitRate, SkillFactor);
			}
			
			SkillFactor = CriticalHitRate;
			int criticalcalcfactor = dvds_criticalcalcfactor;
			criticalcalcfactor = clamp(criticalcalcfactor, 1, 1000);
			CriticalHitRate = CriticalHitRate * criticalcalcfactor / 100;
			if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 13 - Factor Check]: %d,\c- Previous: %d, Factor: %d", CriticalHitRate, SkillFactor, criticalcalcfactor);

			// High-Cap Crit at 100.0%, Low-Cap it at 0.1%
			CriticalHitRate = clamp(CriticalHitRate, 1, 1000);

			// Cheat for ALWAYS-CRIT
			if (Owner.CountInv("CheatCrit") || Owner.CountInv("CheatCritUltimate")) 
			{
				CriticalHitRate = 2000;
				if (dvdsdebug_showcriticalhitstuff) Console.Printf("    \cwCrit Rate % [STEP 13 - CRIT CHEAT IS ON]: %d", CriticalHitRate);
			}

			int CritRNGVal = random[statitem](1,1000); // Based on 0.1% to 100.0% [though the displays only show full %]
			if (CritRNGVal <= CriticalHitRate) { if (owner.CountInv("DealCriticalHit") <= 0) owner.A_SetInventory("DealCriticalHit",1); }
																		else { if (owner.CountInv("DealCriticalHit") >= 1) owner.A_SetInventory("DealCriticalHit",0); }

			// Transplants back to ACS for HUD displays/etc
			CallACS("MiscVarSetDECORATE",235,CriticalHitRate);

			if (dvdsdebug_showcriticalhitstuff)
			{
				if (CritRNGVal <= CriticalHitRate) Console.Printf("    \cdCrit Rate % Roll / Rate: %d / %d", CritRNGVal, CriticalHitRate);
																			else Console.Printf("    \cgCrit Rate % Roll / Rate: %d / %d", CritRNGVal, CriticalHitRate);
			}
		}
	}
	
	void A_PSI1DoEffectWandGuard()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			let weapon = owner.player.ReadyWeapon;
			owner.A_SetInventory("WandGuard", 0);
			if (weapon is "SapphireWandNew" || weapon is "DualSapphireWandsNew")
			{
				double chance = 5;
				chance += (WandMasteryPerkLevel * 4); // +20
				chance += (WandMasteryEXPerkLevel * 10); // +20
				chance += (ClearMindPerkLvl * 1); // +5
				chance += (ClearMindEXPerkLvl * 2.5); // +5
				if (weapon is "DualSapphireWandsNew") chance *= 1.125;
				if (DivineAvatarTimer > 0) chance *= 1.25; // Divine Avatar
				if (SpreadAura1Timer > 0) chance *= 0.85; // Spread Aura Lv 1
				if (SpreadAura2Timer > 0) chance *= 0.55; // Spread Aura Lv 2
				if (DQOomphTimer > 0) chance *= 1.125; // Oomph
				if (DQBluntTimer > 0) chance *= 0.8888888888888889; // Blunt
				if (DQAcceleratleTimer > 0) chance *= 1.0625; // Acceleratle
				if (DQDeceleratleTimer > 0) chance *= 0.9411764705882353; // Deceleratle
				chance *= 0.667;
				chance += (PlayerSOR * 0.01171875);
				chance += (PlayerTHE * 0.00390625);
				chance += (PlayerLevel * 0.015625);
				if (Owner.CountInv("SafeTeaShoes")) chance += 0.125;
				if (Owner.CountInv("PearlyCorset")) chance += 0.125;
				if (Owner.CountInv("WaterFlyingDress")) chance += 0.125;
				if (Owner.CountInv("EvenstarNecklace")) chance += 1.25;
				if (Owner.CountInv("CloakOfEvasion")) chance += 0.125;
				if (Owner.CountInv("AnubisCufflinks")) chance += 0.625;
				if (Owner.CountInv("KissaBra")) chance += 0.125;
				if (Owner.CountInv("DivineShield")) chance += 5.0;
				if (Owner.CountInv("BalrogRing")) chance += 2.5;
				if (Owner.CountInv("FalconKnifeEarrings")) chance += 0.25;
				if (Owner.CountInv("SauronHelmet")) chance += 1.0;
				if (Owner.CountInv("SauronGauntletsItem")) chance += 1.0;
				if (Owner.CountInv("TheOneRing")) chance += 2.5;
				if (dvdsdebug_showvisibleshieldparts) Console.Printf("Wand Guard Chance: %.4f", chance);
				if (frandom[statitem](0.1,100.0) <= chance) owner.A_SetInventory("WandGuard", 1);
			}
		}
	}
	
	void A_PSI1DoEffectLevelCaps()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (CharacterClass != 2)
			{
				if (CharacterClass != 8 && CharacterClass != 9) { LevelCap = dvds_marines_maxlevel; } // Necessary to prevent the game from giving bogus EXP requirements at level 100-199
				if (CharacterClass == 8) { LevelCap = dvds_ailish_maxlevel; }
				if (CharacterClass == 9) { LevelCap = dvds_petra_maxlevel; }
				LevelCap = clamp(LevelCap, 0, 200);
			}
			else
			{
				if (dvds_flora_ignorearmormadelevelcap == 0)
				{
					LevelCap = 100;
					if (owner.CountInv("SafeTeaShoes")) LevelCap += 9;
					if (owner.CountInv("PearlyCorset")) LevelCap += 9;
					if (owner.CountInv("WaterFlyingDress")) LevelCap += 9;
					if (owner.CountInv("EvenstarNecklace")) LevelCap += 9;
					if (owner.CountInv("CloakofEvasion")) LevelCap += 9;
					if (owner.CountInv("AnubisCufflinks")) LevelCap += 9;
					if (owner.CountInv("KissaBra")) LevelCap += 9;
					if (owner.CountInv("BalrogRing")) LevelCap += 9;
					if (owner.CountInv("DoveRibbon")) LevelCap += 9;
					if (owner.CountInv("FalconKnifeEarrings")) LevelCap += 9;
					if (owner.CountInv("DivineShield")) LevelCap += 9;
					if (owner.CountInv("RuinousShield")) LevelCap += 4;
				
					if (LevelCap >= 199) LevelCap = 200;
				}
				else
				{
					LevelCap = clamp(dvds_flora_maxlevel, 0, 200);
				}
			}
			if (dvdsdebug_levelupdisplays) Console.Printf("LevelCap: %d", LevelCap);
			CallACS("OtherVarSetDECORATE",13,LevelCap);
			LevelCap = CallACS("OtherVarCheckDECORATE",13);
		}
	}
	
	// Armor Resistance Numbers
	void A_PSI1DoEffectArmorResNums()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			ArmorResistance = 0;
			if (CharacterClass == 2)
			{
				if (owner.CountInv("SafeTeaShoes")) ArmorResistance += 30; // Item 1
				if (owner.CountInv("PearlyCorset")) ArmorResistance += 70; // Item 2
				if (owner.CountInv("WaterFlyingDress")) ArmorResistance += 80; // Item 3
				if (owner.CountInv("EvenstarNecklace")) ArmorResistance += 20; // Item 4
				if (owner.CountInv("CloakofEvasion")) ArmorResistance += 40; // Item 5
				if (owner.CountInv("AnubisCufflinks")) ArmorResistance += 50; // Item 6
				if (owner.CountInv("KissaBra")) ArmorResistance += 60; // Item 7
				if (owner.CountInv("DivineShield")) ArmorResistance += 160; // Item 8
				if (owner.CountInv("BalrogRing")) ArmorResistance += 20; // Item 9
				if (owner.CountInv("DoveRibbon")) ArmorResistance += 90; // Item 10
				if (owner.CountInv("FalconKnifeEarrings")) ArmorResistance += 50; // Item 11
			}
			else
			{
				if (owner.CountInv("DSGreenArmorClass")) ArmorResistance += 350;
				if (owner.CountInv("DSBlueArmorClass")) ArmorResistance += 525;
				if (owner.CountInv("DSStoneArmorClass1")) ArmorResistance += 708;
				if (owner.CountInv("DSDiamondArmorClass1")) ArmorResistance += 937;
				if (owner.CountInv("DSStoneArmorClass2")) ArmorResistance += 875;
				if (owner.CountInv("DSDiamondArmorClass2")) ArmorResistance += 987;
			}
			CallACS("MiscVarSetDECORATE",233,ArmorResistance);
		}
	}

	void A_PSI1DoEffectIronFeetArmor()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			// Safe Tea Boots [25% chance of damagefloor/ironfeet guard during normal incursion of damage]
			// Cloak of Evasion [12.5% chance of damagefloor/ironfeet guard during normal incursion of damage]
			int IronFeetChance = 0;
			if (owner.CountInv("SafeTeaShoes")) IronFeetChance += 250;
			if (owner.CountInv("CloakOfEvasion")) IronFeetChance += 125;
			if (IronFeetChance > 1000) IronFeetChance = 1000;
			owner.A_SetInventory("FloraArmorFloorGuard",0);
			if (random[statitem](1,1000) <= IronFeetChance) owner.A_SetInventory("FloraArmorFloorGuard",1);
			
			int FearChance = 100;
			if (owner.CountInv("TheOneRing")) FearChance = FearChance * 1.667;
			// Anubis Cufflinks [10% (16.667% with One Ring) chance of brief fear-effect on all hostile creatures with attacks]
			owner.A_SetInventory("AnubisCufflinksFear",0);   
			if (owner.CountInv("AnubisCufflinks") && random[statitem](1,1000) <= FearChance) owner.A_SetInventory("AnubisCufflinksFear",1);
		}
	}
	
	void A_PSI1DoEffectSigilStuff()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		if (playeractor)
		{
			int SigilPieces = 0;
			let sigl = owner.FindInventory("Sigil");
			if (sigl != null)
			{
				//Console.Printf("Sigil Pieces: %d", sigl.health);
				if (sigl.health == 1) owner.A_SetInventory("SigilPhase1", 1); else owner.A_SetInventory("SigilPhase1",0);
				if (sigl.health == 2) owner.A_SetInventory("SigilPhase2", 1); else owner.A_SetInventory("SigilPhase2",0);
				if (sigl.health == 3) owner.A_SetInventory("SigilPhase3", 1); else owner.A_SetInventory("SigilPhase3",0);
				if (sigl.health == 4) owner.A_SetInventory("SigilPhase4", 1); else owner.A_SetInventory("SigilPhase4",0);
				if (sigl.health == 5) owner.A_SetInventory("SigilComplete", 1); else owner.A_SetInventory("SigilComplete",0);
				SigilPieces = sigl.health;
			}
			CallACS("MiscVarSetDECORATE",25038,SigilPieces);
			if (ClassicDoomType == 4 && owner.CountInv("SigilModeType") <= 0) owner.A_SetInventory("SigilModeType",SigilPieces);
			owner.A_SetInventory("SigilPieces",SigilPieces);
			CallACS("MiscVarSetDECORATE",25047,owner.CountInv("SigilModeType"));

			nm = "BestEndingFlag"; iDTech1Check = nm;
			if (owner.CountInv("QuestItem27") && owner.CountInv("QuestItem25")) 
			{
				owner.A_SetInventory(iDTech1Check,1);
			}
			else
			{
				owner.A_SetInventory(iDTech1Check,0);
			}
			
			// Checks if you've destroyed the Acolyte Converter in Strife MAP24 [Conversion Chapel] (Flag 25)
			if (StrifeQuestFlag25 == 0)
			{
				if (owner.CountInv("QuestItem25") == 1)
				{
					owner.Stamina -= 10;
					owner.Accuracy -= 10;
					owner.A_GiveInventory("ConverterBonus");
					StrifeQuestFlag25++;
				}
			}

			// Checks if you've destroyed the Loremaster's Spectre in Strife MAP27 [The Lab] (Flag 26)
			if (StrifeQuestFlag26 == 0)
			{
				if (owner.CountInv("QuestItem26") == 1)
				{
					owner.Stamina -= 10;
					owner.Accuracy -= 10;
					owner.A_GiveInventory("LoreMasterBonus");
					StrifeQuestFlag26++;
				}
			}
			// Checks if you've destroyed the Drone Transmitter in Strife MAP14 [The Mines] (Flag 29)
			if (StrifeQuestFlag29 == 0) 
			{
				if (owner.CountInv("QuestItem29") == 1)
				{
					owner.Stamina -= 10;
					owner.Accuracy -= 10;
					owner.A_GiveInventory("TransmitterBonus");
					StrifeQuestFlag29++;
				}
			}
		}
	}

	// Evasion Stuff
	void A_PSI1DoEffectEvasionStuff()
	{
		//***********
		//**Evasion**
		//***********
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		if (playeractor)
		{
			// Set's The Base increase from each point of Agility
			if (CharacterClass == 0) { AglEvadeCheck = 8.6;  DftEvadeCheck = 0.4; } // Deggaris
			if (CharacterClass == 1) { AglEvadeCheck = 9.8;  DftEvadeCheck = 0.2; } // Illucia
			if (CharacterClass == 2) { AglEvadeCheck = 11.0; DftEvadeCheck = 0.1; } // Flora
			if (CharacterClass == 8) { AglEvadeCheck = 9.2;  DftEvadeCheck = 2.4; } // Ailish (is the only one with a proper initial Deftness bonus)
			if (CharacterClass == 9) { AglEvadeCheck = 16.5; DftEvadeCheck = 0.067; } // Petra (Has 1.5x of Flora's AGL bonsu)

			if (Owner.CountInv("SauronHelmet")) 
			{ 
				AglEvadeCheck += 1.1; 
				DftEvadeCheck += 1.1; 
				if (CharacterClass == 8) DftEvadeCheck += 0.55;
			}
			if (Owner.CountInv("SauronGauntletsItem")) 
			{
				AglEvadeCheck += 2.2;
				DftEvadeCheck += 2.2;
				if (CharacterClass == 8) DftEvadeCheck += 1.1;
			}
			if (Owner.CountInv("TheOneRing")) 
			{ 
				AglEvadeCheck += 6.6; 
				DftEvadeCheck += 6.6;
				if (CharacterClass == 8) DftEvadeCheck += 3.3;
			}
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate [STEP 0 - Agl/Def Evade Check]: %.4f / %.4f\c-", AglEvadeCheck, DftEvadeCheck);

			EvasionRate = ((PlayerAGL * AglEvadeCheck) + (PlayerDFT * DftEvadeCheck)) * 0.5;
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate [STEP 1 - Base (Agl/Evade, Dft/Evade)]: %d\c-", EvasionRate);

			// Divine Avatar
			SkillFactor = 0;
			if (DivineAvatarTimer > 0)
			{
				SkillFactor = EvasionRate * 1.75;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate [STEP 2 - Divine Avatar]: %d\c-, Added: %d", EvasionRate, SkillFactor);
			}
			
			// GoE
			SkillFactor = 0;
			if (GoETimer > 0)
			{
				SkillFactor = EvasionRate * 2.875;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate [STEP 2a - GoE]: %d\c-, Added: %d", EvasionRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// DodgeMore perks
			if (DodgeMorePerkLvl > 0 || DodgeMoreEXPerkLvl > 0)
			{
				SkillFactor = ((DodgeMorePerkLvl * 250) + (DodgeMoreEXPerkLvl * 625));
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate [STEP 3 - DodgeMore Perks]: %d\c-, Added: %d", EvasionRate, SkillFactor);
			}

			SkillFactor = 0;
			// [STRIFE-Compatibility] Stamina Upgrades
			if (StrifeStamLvl > 0)
			{
				SkillFactor = StrifeStamLvl * 111;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 4 - Strife-Stamina Perk]: %d,\c- Added: %d", EvasionRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// Checks Evasion Based on Level
			SkillFactor = PlayerLevel * 5;
			if (DivineAvatarTimer > 0) SkillFactor *= 1.4;
			EvasionRate += SkillFactor;
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 5a - Level Check]: %d,\c- Added: %d", EvasionRate, SkillFactor);

			SkillFactor = 0;
			// Flora Armor Checks
			if (CharacterClass == 2)
			{
				// Flora has Safe Tea Shoes? [+3.75% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("SafeTeaShoes")) SkillFactor += 375;
				
				// Flora has Pearly Corset? [+0.75% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("PearlyCorset")) SkillFactor += 75;
				
				// Flora has Water Flying Dress? [+1.25% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("WaterFlyingDress")) SkillFactor += 125;
				
				// Flora has Evenstar Necklace? [+2.5% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("EvenstarNecklace")) SkillFactor += 250;
				
				// Flora has Cloak of Evasion? [+12.50% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("CloakOfEvasion")) SkillFactor += 1250;
				
				// Flora has Falcon Knife Earrings? [+1.25% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("FalconKnifeEarrings")) SkillFactor += 125;
				
				// Flora has Anubis Cufflinks? [+0.5% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("AnubisCufflinks")) SkillFactor += 50;
				
				// Flora has Kissa's Brasseire? [+1% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("KissaBra")) SkillFactor += 100;
				
				// Flora has Balrog Ring? [+0.5% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("BalrogRing")) SkillFactor += 50;
				
				// Flora has Dove Ribbon? [+1.75% Chance to totally "Evade" damage even from a direct hit.]
				if (Owner.CountInv("DoveRibbon")) SkillFactor += 175;
			}
			EvasionRate += SkillFactor;
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 6 - Flora Armor Check]: %d,\c- Added: %d", EvasionRate, SkillFactor);

			SkillFactor = 0;
			// Someone has Sauron's Helmet [-1.56% Chance]
			if (Owner.CountInv("SauronHelmet")) 
			{
				SkillFactor = 156;
				EvasionRate -= SkillFactor;
				EvasionRate = clamp(EvasionRate, 0, EvasionRate);
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 7a - Sauron Helm Check]: %d,\c- Subtracted: %d", EvasionRate, SkillFactor);
			}
			
			SkillFactor = 0;
			// Someone has The One Ring [+6.25% Chance]
			if (Owner.CountInv("TheOneRing")) 
			{
				SkillFactor = 625;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 7b - One Ring Check]: %d,\c- Added: %d", EvasionRate, SkillFactor);
			}

			SkillFactor = 0;
			if (CharacterClass == 2)
			{
				// Ruinous Shield [Evade reduced by 5/8ths]
				if (Owner.CountInv("RuinousShield"))
				{
					SkillFactor = EvasionRate * 0.625;
					EvasionRate -= SkillFactor;
					EvasionRate = clamp(EvasionRate, 0, EvasionRate);
					if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 8 - Ruinous Shield Check]: %d,\c- Subtracted: %d", EvasionRate, SkillFactor);
				}
				
				// Divine Shield [Evade Increased by 1/4ths]
				if (Owner.CountInv("DivineShield"))
				{
					SkillFactor = EvasionRate * 0.25;
					EvasionRate += SkillFactor;
					if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 8 - Divine Shield Check]: %d,\c- Added: %d", EvasionRate, SkillFactor);
				}
			}
			
			SkillFactor = 0;
			// On The Move Perk
			int IsMoving = 0;
			if (owner.vel.x < minxymoveneg || owner.vel.x > minxymovepos) IsMoving++;
			if (owner.vel.y < minxymoveneg || owner.vel.y > minxymovepos) IsMoving++;
			if (owner.vel.z < minzmoveneg || owner.vel.z > minzmovepos) IsMoving++;
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 9 - Vel Checks]: IsMoving?: %d, x%.8f / y%.8f / z%.8f", IsMoving, owner.vel.x, owner.vel.y, owner.vel.z);
			if (OTMPerkLvl > 0 && IsMoving) // "On The Move" Perk
			{
				double tempmsboost = 1.0;
				if (OTMPerkLvl == 1) { SkillFactor = 250 + ((PlayerAGL * 100) / 40); }
				if (OTMPerkLvl == 2) { SkillFactor = 400 + ((PlayerAGL * 100) / 32); }
				if (OTMPerkLvl == 3) { SkillFactor = 550 + ((PlayerAGL * 100) / 24); }
				if (OTMPerkLvl == 4) { SkillFactor = 700 + ((PlayerAGL * 100) / 16); }
				if (OTMPerkLvl >= 5) { SkillFactor = 850 + ((PlayerAGL * 100) / 8); }
				int basemoveboost = SkillFactor;
				int mamlevels = MartialArtsMastery + BerserkerFit;
				int mamlevels2 = MartialArtsMasteryEX + BerserkerFitEX;
				if (mamlevels > 0 || mamlevels2 > 0)
				{
					if (weapon is "PoisonNeedle")
					{
						tempmsboost += (mamlevels * 0.5);
						tempmsboost += (mamlevels2 * (0.5 * 2.5));
					}
					no = "FistAilish"; APPackCheck3 = no;
					np = "FistPetra"; APPackCheck4 = np;
					if (weapon is "Fist" || weapon is "FistDeggaris" || weapon is "FistIllucia" || weapon is "FistFlora" || weapon is APPackCheck3 || weapon is APPackCheck4)
					{
						tempmsboost += (mamlevels * 0.334);
						tempmsboost += (mamlevels2 * (0.334 * 2.5));
					}
					nm = "SauronGauntletsAilish"; APPackCheck = nm;
					nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
					if (weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || weapon is "SauronGauntletsFlora" || weapon is APPackCheck || weapon is APPackCheck2)
					{
						tempmsboost += (mamlevels * 0.125);
						tempmsboost += (mamlevels2 * (0.125 * 2.5));
					}
					SkillFactor *= tempmsboost;
				}
		
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 10 - On The Move]: %d,\c- Added: %d (Base: %d [%.8f])", EvasionRate, SkillFactor, basemoveboost, tempmsboost);
			}

			// Caps Evasion Chances out at 75% [unless you have the Dove's Ribbon, which it caps at 92.5%]
			int EvasionMin;
			int EvasionMax;
			if (Owner.CountInv("DoveRibbon"))
			{
				EvasionMin = 175;
				EvasionMax = 9250;
				EvasionMin += ((DodgeMorePerkLvl * 25) + (DodgeMoreEXPerkLvl * 63) + (OTMPerkLvl * 16) + (OTMEXPerkLvl * 42));
				EvasionMax += ((DodgeMorePerkLvl * 50) + (DodgeMoreEXPerkLvl * 125) + (OTMPerkLvl * 33) + (OTMEXPerkLvl * 84));
			}
			else
			{
				EvasionMin = 0;
				EvasionMax = 7500;
				EvasionMin += ((DodgeMorePerkLvl * 20) + (DodgeMoreEXPerkLvl * 50) + (OTMPerkLvl * 13) + (OTMEXPerkLvl * 33));
				EvasionMax += ((DodgeMorePerkLvl * 30) + (DodgeMoreEXPerkLvl * 75) + (OTMPerkLvl * 20) + (OTMEXPerkLvl * 50));
			}
			EvasionRate = clamp(EvasionRate, EvasionMin, EvasionMax);
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 11 - Dove Ribbon Check]: %d,\c- EvadeMin: %d, EvadeMax: %d", EvasionRate, EvasionMin, EvasionMax);
			
			
			// Check for Equipped Weapon
			If (weapon is "BFG90002") BasePerkFactor = -625;
			If (weapon is "RocketLauncher2") BasePerkFactor = -313;
			If (weapon is "Railgun2" || weapon is "Karasawa2" ||
					weapon is "Repeater2" || weapon is "PlasmaRifle2")
			{
				BasePerkFactor = -156;
			}

			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
			If (weapon is "SauronGauntlets" || weapon is "SauronGauntletsIllucia" || weapon is "SauronGauntletsFlora" || 
					weapon is APPackCheck || weapon is APPackCheck2)
			{
				BasePerkFactor = -156;
			}

			If (weapon is "Chainsaw2" || weapon is "DoubleBladedChainsaw") BasePerkFactor = -78;
			If (weapon is "Minigun") BasePerkFactor = -78;
			If (weapon is "EvilWarriorShield") BasePerkFactor = (-63 * (1.0 + (HellWarriorShieldLevel * 0.0125)));
			If (weapon is "Chaingun2") BasePerkFactor = -39;
			no = "FistAilish"; APPackCheck3 = no;
			np = "FistPetra"; APPackCheck4 = np;
			If (weapon is "FistDeggaris" || 
					weapon is "FistIllucia" || 
					weapon is "FistFlora" || 
					weapon is APPackCheck3 || weapon is APPackCheck4)
			{
				BasePerkFactor = 625;
			}
			If (weapon is "PoisonNeedle") BasePerkFactor = 1750;
			If (weapon is "SceptreOfEmpyrea") BasePerkFactor = 1250;
			
			If (weapon is "Shotgun2") BasePerkFactor = 63;
			If (weapon is "Pistol2") BasePerkFactor = 125;
			If (weapon is "DualPistols") BasePerkFactor = (125 * 3) / 2;
			
			// Hellcore Weapons
			int EvadeCurrHellcoreLevel = 0;
			If (weapon is "ImpSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",96); }
			If (weapon is "DarkImpSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",97); }
			If (weapon is "CacodemonSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",98); }
			If (weapon is "CacolanternSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",99); }
			If (weapon is "AbaddonSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",100); }
			If (weapon is "KnightSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",101); }
			If (weapon is "BaronSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",102); }
			If (weapon is "BelphegorSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",103); }
			If (weapon is "BruiserSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",104); }
			If (weapon is "ArchonSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",105); }
			If (weapon is "PyroDemonSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",106); }
			If (weapon is "IncarnateSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",107); }
			If (weapon is "ArchvileSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",108); }
			If (weapon is "DiabloistSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",109); }
			If (weapon is "BalrogSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",110); }
			If (weapon is "HElementalSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",111); }
			If (weapon is "HOverlordSoul") { EvadeCurrHellcoreLevel = CallACS("MiscVarCheckDECORATE",112); }
			if (EvadeCurrHellcoreLevel > 0) BasePerkFactor = (1250 * EvadeCurrHellcoreLevel) / 8;
			
			If (weapon is "SapphireWandNew") BasePerkFactor = 125;
			If (weapon is "DualSapphireWandsNew") BasePerkFactor = (125 * 3) / 2;
			nm = "ImpalerXBow"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 325;
			nm = "DualImpalerXBow"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (325 * 3) / 2;
			nm = "ScepterOfSouls"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 125;
			nm = "DualScepterOfSouls"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (125 * 3) / 2;
			nm = "GoldWandNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 187;
			nm = "DualGoldWandNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (187 * 3) / 2;
			nm = "CrossbowNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 325;
			nm = "DualCrossbowNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (325 * 3) / 2;
			nm = "SuperCrossbowNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 468;
			nm = "DualSuperCrossbowNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (468 * 3) / 2;
			nm = "DragonClawNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 250;
			nm = "DualDragonClawNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (250 * 3) / 2;
			nm = "HellStaffNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 250;
			nm = "DualHellStaffNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (250 * 3) / 2;
			nm = "PhoenixRodNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 187;
			nm = "DualPhoenixRodNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (187 * 3) / 2;
			nm = "FiremaceNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 125;
			nm = "DualFiremaceNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (125 * 3) / 2;
			nm = "DSparilStaff"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 250;
			nm = "DualDSparilStaff"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = (250 * 3) / 2;
			nm = "StrifeCrossbowNew"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 325;
			nm = "StrifeCrossbow2New"; APPackCheck = nm; If (weapon is APPackCheck) BasePerkFactor = 325;

			if (BasePerkFactor != 0)
			{
				PerkFactor = BasePerkFactor;
				PerkFactor += ((DodgeMorePerkLvl * (BasePerkFactor / 20)) + (DodgeMoreEXPerkLvl * (BasePerkFactor / 8)));
				SkillFactor = (10000 - EvasionRate) * PerkFactor / 10000;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 12 - Weapon Check]: %d,\c- Change: %d, PerkFactor: %d", EvasionRate, SkillFactor, PerkFactor);
			}
			
			SkillFactor = 0;
			// Acceleratle = +1/5 of remaining % Evasion added (done after caps are normally calculated)
			if (DQAcceleratleTimer > 0)
			{
				PerkFactor = 2000;
				PerkFactor += ((DodgeMorePerkLvl * 200) + (DodgeMoreEXPerkLvl * 500));
				SkillFactor = (10000 - EvasionRate) * PerkFactor / 10000;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 13a - Acceleratle Check]: %d,\c- Add: %d, PerkFactor: %d", EvasionRate, SkillFactor, PerkFactor);
			}
			// Deceleratle = -1/5 of remaining % Current Evasion removed (done after caps are normally calculated)
			if (DQDeceleratleTimer > 0)
			{
				PerkFactor = 2000;
				PerkFactor -= ((DodgeMorePerkLvl * 100) + (DodgeMoreEXPerkLvl * 250));
				SkillFactor = (10000 - EvasionRate) * PerkFactor / 10000;
				EvasionRate -= SkillFactor;
				if (EvasionRate < 0) EvasionRate = 0;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 13b - Deceleratle Check]: %d,\c- Subtracted: %d, PerkFactor: %d", EvasionRate, SkillFactor, PerkFactor);
			}

			SkillFactor = 0;
			// BlurSphere = +1/3 of remaining % Evasion added (done after caps are normally calculated) [in other words, make the Blur Sphere & Invisibility Spells actually USEFUL >__>;]
			if (Owner.CountInv("PowerInvisibility") || Owner.CountInv("InvisiblitySpell"))
			{
				PerkFactor = 3334;
				PerkFactor += ((DodgeMorePerkLvl * 125) + (DodgeMoreEXPerkLvl * 313));
				SkillFactor = (10000 - EvasionRate) * PerkFactor / 10000;
				EvasionRate += SkillFactor;
				if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 14 - Invisibility Check]: %d,\c- Added: %d, PerkFactor: %d", EvasionRate, SkillFactor, PerkFactor);
			}

			SkillFactor = EvasionRate;
			int evadecalcfactor = clamp(dvds_evadecalcfactor, 10, 1000);
			EvasionRate = EvasionRate * evadecalcfactor / 100;
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 15 - Factor Check]: %d,\c- Previous: %d, Factor: %d", EvasionRate, SkillFactor, evadecalcfactor);
			
			int ultmaxevasionrate = 9875;
			EvasionRate = clamp(EvasionRate, 0, ultmaxevasionrate);
			if (dvdsdebug_showevadestuff) Console.Printf("    \cwEvasion Rate % [STEP 16 - Final Check]: %d / %d\c-", EvasionRate, ultmaxevasionrate);
			// Transplants back to ACS for HUD displays/etc
			CallACS("MiscVarSetDECORATE",23,EvasionRate);

			int EvasionRNGVal = random[statitem](1,10000); // Based on 0.1% to 100.0% [though the displays only show full %]
			if (EvasionRNGVal <= EvasionRate) 
			{
				if (owner.CountInv("EvadeAnAttack") <= 0) owner.A_SetInventory("EvadeAnAttack",1); 
				if (dvdsdebug_showevadestuff) Console.Printf("    \cdEvasion % Roll / Rate: %d / %d", EvasionRNGVal, EvasionRate);
			}
			else 
			{ 
				if (owner.CountInv("EvadeAnAttack") >= 1) owner.A_SetInventory("EvadeAnAttack",0); 
				if (dvdsdebug_showevadestuff) Console.Printf("    \cgEvasion % Roll / Rate: %d / %d", EvasionRNGVal, EvasionRate);
			}
		}
	}

	// Tension Stuff
	void A_PSI1DoEffectTensionStuff()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		
		if (playeractor && UsingInGameMenu == 0)
		{
			int TensionChargeFailRate;
			int TensionChargeTimeMax;
			int TensionStaminaPerTic;
			int randompulseinterval1;
			int randompulseinterval2;
			int randompulseinterval3;
			int randompulseinterval4;
			double pulsevolume;
			int maxpulseinterval;
			int TensionChargeAmount;
			int TensionCoolDownRatio;
			int TensionStaminaDivisor;
			int TensionChargeFailRatio = dvds_tension_failrateratio;
			int KillCounter = CallACS("MiscVarCheckDECORATE",158);
			int TensionOverChargeAllowed = dvds_allowtension;
			int SleepCanDisperseTension = dvds_sleepdispersetension;

			int TensionLevelLastTic = CallACS("MiscVarCheckDECORATE",182);
			TensionTimer = CallACS("MiscVarCheckDECORATE",183);
			int TensionCountingDown = CallACS("MiscVarCheckDECORATE",184);
			TensionWarmupTimer = CallACS("MiscVarCheckDECORATE",185);
			TensionCooldownTimer = CallACS("MiscVarCheckDECORATE",186);
			int TensionMaxCooldownTimer = CallACS("MiscVarCheckDECORATE",188);
			TensionChargeLoopTimer = CallACS("MiscVarCheckDECORATE",189);
			TensionActivePulseTimer = CallACS("MiscVarCheckDECORATE",190);
			TensionOverPsycheTimer = CallACS("MiscVarCheckDECORATE",250);
			TensionOverchargeTimer = CallACS("MiscVarCheckDECORATE",251);
			TensionMaxOverchargeTimer = CallACS("MiscVarCheckDECORATE",261);
			TensionMaxOverPsycheTimer = CallACS("MiscVarCheckDECORATE",262);
			if (TensionLevel == 0)  // 0 to 5 Tension [4 Seconds, 20% Total Stamina Use, 0% Fail Rate]
			{
				TensionChargeFailRate = 0;
				TensionChargeTimeMax = 14000;
				TensionStaminaPerTic = 2000;
				TensionMaxOverPsycheTimer = 99999999;
				TensionMaxOverchargeTimer = 99999999;
				TensionOverPsycheTimer = 0;
				TensionOverchargeTimer = 0;
			}
			
			if (TensionLevel == 1)  // 5 to 20 Tension [4.25~ Seconds, 22.5% Total Stamina Use, 2.5% Fail Rate]
			{
				TensionChargeFailRate = 25;
				TensionChargeTimeMax = 14880;
				TensionStaminaPerTic = 2250;
				TensionMaxOverPsycheTimer = 21000; // 600 Seconds [10 minutes]
				TensionMaxOverchargeTimer = 130; // 3.71 seconds
			}
			
			if (TensionLevel == 2)  // 20 to 50 Tension [4.5~ Seconds, 25% Total Stamina Use, 10% Fail Rate]
			{
				TensionChargeFailRate = 100;
				TensionChargeTimeMax = 15750;
				TensionStaminaPerTic = 2500;
				TensionMaxOverPsycheTimer = 15750; // 450 Seconds [7.5 minutes]
				TensionMaxOverchargeTimer = 110; // 3.14 seconds
			}
			
			if (TensionLevel == 3)  // 50 to 100 Tension [5 Seconds, 30% Total Stamina Use, 50% Fail Rate]
			{
				TensionChargeFailRate = 500;
				TensionChargeTimeMax = 17500;
				TensionStaminaPerTic = 3000;
				TensionMaxOverPsycheTimer = 10500; // 300 Seconds [5 minutes]
				TensionMaxOverchargeTimer = 90; // 2.57 seconds
			}
			
			if (TensionLevel == 4)  // 100 to 250 Tension [5.5 Seconds, 35% Total Stamina Use, 70% Fail Rate]
			{
				TensionChargeFailRate = 700;
				TensionChargeTimeMax = 19250;
				TensionStaminaPerTic = 3500;
				TensionMaxOverPsycheTimer = 5250; // 150 Seconds [2.5 minutes]
				TensionMaxOverchargeTimer = 70; // 2 seconds
			}
			
			if (TensionLevel == 5)  // 250 to 500 Tension [6 Seconds, 40% Total Stamina Use, 85% Fail Rate]
			{
				TensionChargeFailRate = 850;
				TensionChargeTimeMax = 21000;
				TensionStaminaPerTic = 4000;
				TensionMaxOverPsycheTimer = 2100; // 60 Seconds
				TensionMaxOverchargeTimer = 60; // 1.71 seconds
			}
			
			if (TensionLevel == 6)  // 500 to 1000 Tension [7.5 Seconds, 50% Total Stamina Use, 92.5% Fail Rate]
			{
				TensionChargeFailRate = 950;
				TensionChargeTimeMax = 26250;
				TensionStaminaPerTic = 5000;
				TensionMaxOverPsycheTimer = 1575; // 45 Seconds
				TensionMaxOverchargeTimer = 50; // 1.42 seconds
			}
			if (TensionLevel == 7)
			{
				TensionChargeFailRate = 1000;
				TensionChargeTimeMax = 26250;
				TensionStaminaPerTic = 5000;
				TensionMaxOverPsycheTimer = 1050; // 30 Seconds
				TensionMaxOverchargeTimer = 40; // 1.14 seconds
			}
			
			TensionMaxOverPsycheTimer *= 20;
			TensionMaxOverchargeTimer *= 20;
			
			if (DivineAvatarTimer > 0)
			{
				TensionMaxOverPsycheTimer *= 4;
				TensionMaxOverchargeTimer *= 4;
			}
			if (dvdsdebug_showtensioninformation) 
			{
				Console.Printf("Tension [Step 1 - Get Initial Values]: TensionLevel: %d, FailRate: %d, MaxChargeTime: %d, StamPerTic: %d, OverpsychTimer: %d / %d, OverchargeTimer: %d / %d", 
												TensionLevel, TensionChargeFailRate, TensionChargeTimeMax, TensionStaminaPerTic, TensionOverPsycheTimer, TensionMaxOverPsycheTimer, TensionOverchargeTimer, TensionMaxOverchargeTimer);
			}
			
			// Tension Per Tic Calcs
			TensionStaminaDivisor = TensionChargeTimeMax / 190;
			TensionStaminaPerTic = TensionStaminaPerTic / TensionStaminaDivisor;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 2 - Stam Use Calc P1]: StamPerTic: %d, MaxChargeTime: %d, Divisor: %d", TensionStaminaPerTic, TensionChargeTimeMax, TensionStaminaDivisor);
			// Check Tension Speed Option [also affects Stamina]
			TensionStaminaPerTic = (TensionStaminaPerTic * TensionSpeedRatio) / 100;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 3 - Stam Use Calc P2 - Tension Speed/Stam Multi]: StamPerTic: %d, Multiplier: %d%", TensionStaminaPerTic, TensionSpeedRatio);
			// Falcon Knife Earrings [-10% Consumption]
			if (Owner.CountInv("FalconKnifeEarrings")) TensionStaminaPerTic = TensionStaminaPerTic * 9 / 10;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 4 - Stam Use Calc P3 - Falcon Knife Earrings]: StamPerTic: %d", TensionStaminaPerTic);
			
			// Fail Rate Calcs
			if (A_CheckBerserk()) TensionChargeFailRate -= 125; // -12.5% Fail Rate When Berserked
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 5 - Fail Rate Calc P1 - Berserk]: %d", TensionChargeFailRate);
			if (DivineAvatarTimer > 0) TensionChargeFailRate -= 250; // -25% Fail Rate When In Divine Avatar
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 6 - Fail Rate Calc P2 - Divine Avatar]: %d", TensionChargeFailRate);
			if (GoETimer > 0) TensionChargeFailRate /= 5; // 0.2x Fail Rate When In GoE
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 7 - Fail Rate Calc P3 - GoE]: %d", TensionChargeFailRate);
			
			TensionChargeFailRatio = clamp(TensionChargeFailRatio, 0, 1000);
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 8 - Fail Rate Calc P4 - Caps]: %d", TensionChargeFailRate);
			
			TensionChargeFailRate = (TensionChargeFailRate * TensionChargeFailRatio) / 100;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 9 - Fail Rate Calc P5 - Failure Ratio Multi]: %d, Multiplier: %d%", TensionChargeFailRate, TensionChargeFailRatio);

			PerkFactor = 10000 - ((PsychFstPerkLvl * 125) + (PsychFstEXPerkLvl * random[statitem](312,313)));
			TensionChargeFailRate = (TensionChargeFailRate * PerkFactor) / 10000;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 10 - Fail Rate Calc P6 - PsycheFast]: %d, PerkFactor: %d / 10000", TensionChargeFailRate, PerkFactor);

			if (dvds_musou_powertripmode == 1) TensionChargeFailRate = TensionChargeFailRate / 5; // Check "Power Trip" mode Cheat
			if (dvds_musou_powertripmode == 2) TensionChargeFailRate = TensionChargeFailRate / 10; // Check "Power Trip" mode Cheat
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 11 - Fail Rate Calc P7 - Power Trip Mode]: %d", TensionChargeFailRate);
			TensionChargeFailRate = clamp(TensionChargeFailRate, 0, TensionChargeFailRate);
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 12 - Fail Rate Calc P8 - LowCap]: %d", TensionChargeFailRate);
			
			// Cooldown Base
			TensionCoolDownRatio = 200;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 13 - Cooldown Calc P1 - Base]: %d", TensionCoolDownRatio);
			// PsycheFast Cooldown
			PerkFactor = ((PsychFstPerkLvl * 500) + (PsychFstEXPerkLvl * 1250)) + 10000;
			TensionCoolDownRatio = TensionCoolDownRatio * PerkFactor / 10000; // "PsycheMore" and "PsycheMore EX" perks.
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 14 - Cooldown Calc P2 - PsychFast]: %d, PerkFactor: %d / 10000", TensionCoolDownRatio, PerkFactor);
			// Cooldown Multiplier
			TensionCoolDownRatio = TensionCoolDownRatio * dvds_tension_cooldownmultiplier / 100;
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 15 - Cooldown Calc P3 - Cooldown Multiplier]: %d, Multiplier: %d%", TensionCoolDownRatio, dvds_tension_cooldownmultiplier);
			
			// Kill Combo
			if (KillCounter > 1)
			{
				if (KillCounter >= 6 && KillCounter <= 10) TensionCoolDownRatio *= 1.005;
				else if (KillCounter >= 11 && KillCounter <= 20) TensionCoolDownRatio *= 1.01;
				else if (KillCounter >= 21 && KillCounter <= 27) TensionCoolDownRatio *= 1.02;
				else if (KillCounter >= 28 && KillCounter <= 35) TensionCoolDownRatio *= 1.03;
				else if (KillCounter >= 36 && KillCounter <= 48) TensionCoolDownRatio *= 1.045;
				else if (KillCounter >= 48 && KillCounter <= 60) TensionCoolDownRatio *= 1.06;
				else if (KillCounter >= 61 && KillCounter <= 80) TensionCoolDownRatio *= 1.1;
				else if (KillCounter >= 81 && KillCounter <= 100) TensionCoolDownRatio *= 1.15;
				else if (KillCounter >= 101 && KillCounter <= 150) TensionCoolDownRatio *= 1.2;
				else if (KillCounter >= 151 && KillCounter <= 200) TensionCoolDownRatio *= 1.35;
				else if (KillCounter >= 201 && KillCounter <= 350) TensionCoolDownRatio *= 1.5;
				else if (KillCounter >= 351 && KillCounter <= 500) TensionCoolDownRatio *= 1.75;
				else if (KillCounter >= 501 && KillCounter <= 750) TensionCoolDownRatio *= 2.0;
				else if (KillCounter >= 751 && KillCounter <= 1000) TensionCoolDownRatio *= 2.5;
				else if (KillCounter >= 1001) TensionCoolDownRatio *= 3.0;
			}
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 16 - Cooldown Calc P4 - Kill Counter]: %d, KillCount: %d", TensionCoolDownRatio, KillCounter);
			
			if (DashTimer <= 0) TensionCooldownTimer -= TensionCoolDownRatio;
			if (TensionCooldownTimer <= 0) { TensionCooldownTimer = 0; TensionMaxCooldownTimer = TensionCooldownTimer; }
			if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 17 - Cooldown Calc P5 - Final Countdown]: Timer: %d / %d, Decrease: %d", TensionCooldownTimer, TensionMaxCooldownTimer, TensionCoolDownRatio);
			
			if (PlayerCurrentHealth > 0)
			{
				TensionChargeAmount = 0;
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1;
				if (FatigueTimer > 0 && random[statitem](1,20) == 1) FreezePlayer += 1;
				if (SleepTimer > 0) FreezePlayer += 1;
				if (buttons & BT_USE && buttons & BT_SPEED && TensionCooldownTimer <= 0 && FreezePlayer == 0)
				{
					if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) { }
					else // Tension is Enabled & If Player is "Conscious", Tension Charge Timer counts up
					{
						if (dvds_allowtension > 0) 
						{
							TensionCooldownTimer = 0;
							TensionMaxCooldownTimer = TensionCooldownTimer;
							
							if (TensionLevel <= 7 && TensionCountingDown <= 0)
							{
								if (CurrentStamina >= TensionStaminaPerTic)
								{
									if (TensionLevel < 7)
									{
										TensionChargeLoopTimer++; // Increase Charge-Up Sound Loop Timer
										if (TensionChargeLoopTimer == 1) owner.A_StartSound("tensioncharge",CHAN_6,CHANF_DEFAULT,1.0);
										if (TensionChargeLoopTimer >= 63) TensionChargeLoopTimer = 0;
										
										if (TensionWarmupTimer == 0 && CharacterClass == 2) owner.A_StartSound("FloraChargeTension",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										owner.A_SpawnItemEx("TensionParticleGenerator",0,0,1,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION);
										if (TensionLevel > 3 && random[statitem](1,100) > 50) owner.A_SpawnItemEx("TensionParticleGenerator",0,0,1,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION); // "100"+ Tension
										if (TensionLevel > 4 && random[statitem](1,100) > 80) owner.A_SpawnItemEx("TensionParticleGenerator",0,0,1,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION); // "250"+ Tension
										if (TensionLevel > 5 && random[statitem](1,100) > 86) owner.A_SpawnItemEx("TensionParticleGenerator",0,0,1,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION); // "500"+ Tension
										if (TensionLevel > 6 && random[statitem](1,100) > 91) owner.A_SpawnItemEx("TensionParticleGenerator",0,0,1,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION); // "1000"+ Tension
									}
									else
									{
										TensionChargeLoopTimer = 0;
									}
									
									// Quaking
									if (TensionLevel == 0) owner.A_Quake(1,4,0,512,"null");
									if (TensionLevel == 1) owner.A_Quake(2,4,0,512,"null");
									if (TensionLevel == 2) owner.A_Quake(3,4,0,512,"null");
									if (TensionLevel == 3) owner.A_Quake(4,4,0,512,"null");
									if (TensionLevel == 4) owner.A_Quake(5,4,0,512,"null");
									if (TensionLevel == 5) owner.A_Quake(7,4,0,512,"null");
									if (TensionLevel == 6) owner.A_Quake(9,4,0,512,"null");
									if (TensionLevel < 7) 
									{
										CallACS("MiscVarSetDECORATE",21,TensionStaminaPerTic,2); // Subtract
										CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina

										BaseStamPenalty = (BaseStamPenalty * TensionStaminaPerTic) / MaximumStamina;
										if (BaseStamPenalty <= random[statitem](1,2)) BaseStamPenalty = random[statitem](1,2);
										if (dvdsdebug_regenpenaltydisplay) Console.Printf("StamPenaltyTimeAdd: %d", BaseStamPenalty);
										CallACS("MiscVarSetDECORATE",94,BaseStamPenalty,2);  // StamRegenBonPenTimer
										StamRegenBonPenTimer = CallACS("MiscVarCheckDECORATE",94);
									}
									
									// 100 = 1 tic
									TensionChargeAmount = 100;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18a - Charge Up P1]: %d", TensionChargeAmount);
									
									// -37.5% Charge Speed When Fatigued
									if (FatigueTimer > 0) TensionChargeAmount = TensionChargeAmount * 0.625;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18b - Charge Up P2 - Fatigue]: %d", TensionChargeAmount);

									// -25% Charge Speed When Berserked
									if (A_CheckBerserk()) TensionChargeAmount = TensionChargeAmount * 0.75;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18c - Charge Up P3 - Berserk]: %d", TensionChargeAmount);

									// -12.5% Charge Speed When in Divine Avatar
									if (DivineAvatarTimer > 0) TensionChargeAmount = TensionChargeAmount * 0.875;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18d - Charge Up P4 - Divine Avatar]: %d", TensionChargeAmount);

									// +50% Charge Speed When in GoE
									if (GoETimer > 0) TensionChargeAmount = TensionChargeAmount * 1.5;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18d - Charge Up P4 - Divine Avatar]: %d", TensionChargeAmount);

									// +5% Charge Speed When at Decent Health
									if (Owner.CountInv("DecentHealth")) TensionChargeAmount = TensionChargeAmount * 1.05;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18e - Charge Up P5a - Decent Health]: %d", TensionChargeAmount);

									// +12.5% Charge Speed When Low on Health
									if (Owner.CountInv("LowHealth")) TensionChargeAmount = TensionChargeAmount * 1.125;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18f - Charge Up P5b - Low Health]: %d", TensionChargeAmount);

									// +33.4% Charge Speed When Critically Low on Health
									if (Owner.CountInv("CriticalHealth")) TensionChargeAmount = TensionChargeAmount * 1.334;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18g - Charge Up P5c - Critically-Low Health]: %d", TensionChargeAmount);

									// +33.4% Charge Speed for Flora
									if (CharacterClass == 2) TensionChargeAmount = TensionChargeAmount * 1.334;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18h - Charge Up P6 - Flora Check]: %d", TensionChargeAmount);

									// +20% Charge Speed for Flora when Low on Health
									if (CharacterClass == 2 && Owner.CountInv("DecentHealth")) TensionChargeAmount = TensionChargeAmount * 1.2;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18i - Charge Up P7 - Flora - Decent Health]: %d", TensionChargeAmount);

									// +50% Charge Speed for Flora when Very Low on Health
									if (CharacterClass == 2 && Owner.CountInv("LowHealth")) TensionChargeAmount = TensionChargeAmount * 1.5;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18j - Charge Up P8 - Flora - Low Health]: %d", TensionChargeAmount);

									// +125% Charge Speed for Flora when Critically low on Health
									if (CharacterClass == 2 && Owner.CountInv("CriticalHealth")) TensionChargeAmount = TensionChargeAmount * 2.25;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18k - Charge Up P9 - Flora - Critically-Low Health]: %d", TensionChargeAmount);

									// Check Tension Charge Multiplier Option
									TensionChargeAmount = TensionChargeAmount * dvds_tension_chargemultiplier / 100;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18l - Charge Up P10 - Charge Multiplier]: %d, Multiplier: %d%", TensionChargeAmount, dvds_tension_chargemultiplier);

									// Check Tension Speed Option [also affects Stamina]
									TensionChargeAmount = (TensionChargeAmount * TensionSpeedRatio) / 100;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18m - Charge Up P11 - Tension Speed Multi]: %d, Multiplier: %d%", TensionChargeAmount, TensionSpeedRatio);

									// Check "Power Trip" mode Cheat
									if (dvds_musou_powertripmode == 1) TensionChargeAmount *= 5;
									if (dvds_musou_powertripmode == 2) TensionChargeAmount *= 10;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18n - Charge Up P12 - Power Trip Mode]: %d", TensionChargeAmount);
									
									// Kill Combo
									if (KillCounter > 1)
									{
										if (KillCounter > 10 && KillCounter < 21) { TensionChargeAmount = floor(TensionChargeAmount * 1.005); }
										else if (KillCounter > 20 && KillCounter < 36) { TensionChargeAmount = floor(TensionChargeAmount * 1.015); }
										else if (KillCounter > 35 && KillCounter < 61) { TensionChargeAmount = floor(TensionChargeAmount * 1.030); }
										else if (KillCounter > 60 && KillCounter < 101) { TensionChargeAmount = floor(TensionChargeAmount * 1.050); }
										else if (KillCounter > 100 && KillCounter < 201) { TensionChargeAmount = floor(TensionChargeAmount * 1.100); }
										else if (KillCounter > 200 && KillCounter < 501) { TensionChargeAmount = floor(TensionChargeAmount * 1.250); }
										else if (KillCounter > 500) { TensionChargeAmount = floor(TensionChargeAmount * 1.475); }
									}
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18o - Charge Up P13 - Kill Counter]: %d, KillCount: %d", TensionChargeAmount, KillCounter);
									
									// PsycheMore perks
									PerkFactor = ((PsychFstPerkLvl * 750) + (PsychFstEXPerkLvl * 1875)) + 10000;
									TensionChargeAmount = TensionChargeAmount * PerkFactor / 10000; // "PsycheMore" and "PsycheMore EX" perks.
									TensionChargeAmount += (PsychFstPerkLvl / 2);
									TensionChargeAmount += PsychFstEXPerkLvl;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18p - Charge Up P14 - PsycheFast]: %d", TensionChargeAmount);
									
									// Kill-Combo Bonus
									int TensionChargeKillBonus = (KillCounter * 0.75) + 100;
									if (KillCounter > 0) TensionChargeAmount = (TensionChargeAmount * TensionChargeKillBonus) / 100;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18q - Charge Up P15 - Kill Bonus]: %d, KillBonus: %d%", TensionChargeAmount, TensionChargeKillBonus);
									
									// ???
									if (Owner.CountInv("FistPlayerBlock")) TensionChargeAmount *= 1.25;
									if (Owner.CountInv("FistPlayerBlock2")) TensionChargeAmount *= 1.375;
									if (Owner.CountInv("FistPlayerBlock3")) TensionChargeAmount *= 1.5;
									if (Owner.CountInv("FistPlayerBlock4")) TensionChargeAmount *= 1.75;
									if (Owner.CountInv("FistPlayerBlockExtra")) TensionChargeAmount *= 2.25;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18r - Charge Up P16 - Fist Block]: %d", TensionChargeAmount);
									
									// Up-Clamp to 1 Tic
									if (TensionChargeAmount < 1) TensionChargeAmount = 1;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18s - Charge Up P17 - Clamp]: %d", TensionChargeAmount);
								}
								else
								{
									TensionChargeLoopTimer = clamp(TensionChargeLoopTimer, TensionChargeLoopTimer, 0);
							
									if (TensionLevel == 0) TensionCooldownTimer = 3500;
									if (TensionLevel == 1) TensionCooldownTimer = 3720;
									if (TensionLevel == 2) TensionCooldownTimer = 3940;
									if (TensionLevel == 3) TensionCooldownTimer = 4380;
									if (TensionLevel == 4) TensionCooldownTimer = 4810;
									if (TensionLevel == 5) TensionCooldownTimer = 5250;
									if (TensionLevel == 6) TensionCooldownTimer = 6560;
									TensionCooldownTimer = TensionCooldownTimer * 1.5;
									TensionMaxCooldownTimer = TensionCooldownTimer;
							
									if (TensionLevel < 7) owner.A_StartSound("tensionfailed",CHAN_7,CHANF_DEFAULT,1.0);
							
									CallACS("MiscVarSetDECORATE",21,0);
									CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
									TensionChargeAmount -= 250;
									if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18 - Charge Up P1]: %d", TensionChargeAmount);
								}
							}
						}
					}
				}
				else
				{
					TensionChargeLoopTimer = clamp(TensionChargeLoopTimer, TensionChargeLoopTimer, 0);
					TensionChargeAmount -= 250;
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 18 - Charge Up P1]: %d", TensionChargeAmount);
				}
				// Movement to decrease Tension charge.
				int C3 = 0;
				FreezePlayer = 0;
				if (UsingInGameMenu > 0) FreezePlayer += 1;
				if (SleepTimer > 0) FreezePlayer += 1;
				if (FreezePlayer == 0)
				{
					buttons = owner.GetPlayerInput(INPUT_BUTTONS);
					if (buttons & BT_FORWARD || buttons & BT_BACK || buttons & BT_MOVELEFT || buttons & BT_MOVERIGHT) C3 = -500;
					else if (buttons & BT_MOVEUP || buttons & BT_MOVEDOWN) C3 = -500;
					else if (((buttons & BT_JUMP) && sv_allowjump) || ((buttons & BT_CROUCH) && sv_allowcrouch)) C3 = -500;
				}
				if (C3 != 0 && TensionCooldownTimer < 7000 && FreezePlayer == 0)
				{
					if (dvds_allowtension > 0) // Tension is Enabled
					{
						TensionCooldownTimer = 7000; // 1 Sec
						TensionMaxCooldownTimer = TensionCooldownTimer;
					}
				}
				TensionChargeAmount += C3;
				if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 19 - Charge Up Input]: %d, input-change: %d", TensionChargeAmount, C3);
				
				if (TensionCountingDown <= 0) TensionWarmupTimer += TensionChargeAmount;
				if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 20 - Increase Warmup/Charge]:  %d / %d, Charge: %d", TensionWarmupTimer, TensionChargeTimeMax, TensionChargeAmount);

				if (TensionWarmupTimer <= 0) TensionWarmupTimer = 0;
				//TensionWarmupTimer = clamp(TensionWarmupTimer, 0, TensionWarmupTimer);
				
				if (TensionWarmupTimer >= TensionChargeTimeMax)
				{
					if (random[statitem](1,1000) > TensionChargeFailRate)
					{
						TensionCountingDown = 0;
						
						if (TensionLevel == 0) { TensionCooldownTimer = 3500; owner.A_SetBlend("FE 68 FD",0.33,43); }
						else if (TensionLevel == 1) { TensionCooldownTimer = 3720; owner.A_SetBlend("FE 68 FD",0.33,48); }
						else if (TensionLevel == 2) { TensionCooldownTimer = 3940; owner.A_SetBlend("FE 68 FD",0.33,53); }
						else if (TensionLevel == 3) { TensionCooldownTimer = 4380; owner.A_SetBlend("FE 68 FD",0.33,56); }
						else if (TensionLevel == 4) { TensionCooldownTimer = 4810; owner.A_SetBlend("FE 68 FD",0.33,61); }
						else if (TensionLevel == 5) { TensionCooldownTimer = 5250; owner.A_SetBlend("FE 68 FD",0.33,66); }
						else if (TensionLevel == 6) { TensionCooldownTimer = 6560; owner.A_SetBlend("FE 68 FD",0.33,70); }
						TensionCooldownTimer *= 2;
						TensionMaxCooldownTimer = TensionCooldownTimer;
						TensionOverPsycheTimer = 0;
						TensionOverchargeTimer = 0;
						
						if (TensionLevel >= 0 && TensionLevel <= 2) // to 5,20,50
						{
							owner.A_StopSound(CHAN_7);
							owner.A_StartSound("tensionincrease",CHAN_7,CHANF_DEFAULT,1.0,ATTN_NORM);
						}
						if (TensionLevel >= 3 && TensionLevel <= 4)  // to 100,250 [Super High Tension]
						{
							owner.A_StopSound(CHAN_7);
							owner.A_StartSound("tensionhigh1",CHAN_7,CHANF_DEFAULT,1.0,ATTN_NORM);
							if (CharacterClass == 2 && TensionLevel == 3 && random[statitem](1,3) == 1) 
							{
								owner.A_StopSound(CHAN_VOICE);
								owner.A_StartSound("FloraEnterHighTension1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
							}
							if (CharacterClass == 2 && TensionLevel == 4 && random[statitem](1,2) == 1) 
							{
								owner.A_StopSound(CHAN_VOICE);
								owner.A_StartSound("FloraEnterHighTension2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
							}
						}
						if (TensionLevel == 5) // to 500
						{
							owner.A_StartSound("tensionhigh2",CHAN_7,CHANF_DEFAULT,1.0,ATTN_NORM);
							if (CharacterClass == 2) 
							{
								owner.A_StopSound(CHAN_VOICE);
								owner.A_StartSound("FloraEnterHighTension2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
							}
						}
						if (TensionLevel == 6) // to 1000
						{
							owner.A_StartSound("tensionhigh3",CHAN_7,CHANF_DEFAULT,1.0,ATTN_NORM);
							if (CharacterClass == 2) 
							{
								owner.A_StopSound(CHAN_VOICE);
								owner.A_StartSound("FloraEnterHighTension3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
							}
						}
						
						double project_RealZ = (owner.player.mo.viewHeight * 39 / 50) + 8.0;
						string blastwavetype;
						if (TensionLevel == 0) blastwavetype = "PlayerTension5BlastRadius";
						if (TensionLevel == 1) blastwavetype = "PlayerTension20BlastRadius";
						if (TensionLevel == 2) blastwavetype = "PlayerTension50BlastRadius";
						if (TensionLevel == 3) blastwavetype = "PlayerTension100BlastRadius";
						if (TensionLevel == 4) blastwavetype = "PlayerTension250BlastRadius";
						if (TensionLevel == 5) blastwavetype = "PlayerTension500BlastRadius";
						if (TensionLevel == 6) blastwavetype = "PlayerTension1000BlastRadius";
						owner.A_SpawnItemEx(blastwavetype,0.0,0.0,project_RealZ,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION);

						TensionLevel += 1;
						if ((dvds_showdamagemessages & 1)) A_PrintPsychUpMessage(owner,TensionLevel);
						
						if (TensionLevel == 1) TensionTimer = 3600;
						if (TensionLevel == 2) TensionTimer = 4320;
						if (TensionLevel == 3) TensionTimer = 5184;
						if (TensionLevel == 4) TensionTimer = 6221;
						if (TensionLevel == 5) TensionTimer = 7465;
						if (TensionLevel == 6) TensionTimer = 8958;
						if (TensionLevel == 7) TensionTimer = 10750;
					}
					else // Psyche Up Fails D:
					{
						TensionCountingDown = 0;
						
						if (dvds_allowtension > 0) // Tension is Enabled
						{
							if (TensionLevel == 0) TensionCooldownTimer = 3500;
							if (TensionLevel == 1) TensionCooldownTimer = 3720;
							if (TensionLevel == 2) TensionCooldownTimer = 3940;
							if (TensionLevel == 3) TensionCooldownTimer = 4380;
							if (TensionLevel == 4) TensionCooldownTimer = 4810;
							if (TensionLevel == 5) TensionCooldownTimer = 5250;
							if (TensionLevel == 6) TensionCooldownTimer = 6560;
							TensionCooldownTimer = TensionCooldownTimer * 1.5;
							TensionMaxCooldownTimer = TensionCooldownTimer;
						
							if (TensionLevel < 7)
							{
								owner.A_StartSound("tensionfailed",CHAN_7,CHANF_DEFAULT,1.0);
							}
						}
						
						if (TensionLevel == 1) TensionTimer = 3600;
						if (TensionLevel == 2) TensionTimer = 4320;
						if (TensionLevel == 3) TensionTimer = 5184;
						if (TensionLevel == 4) TensionTimer = 6221;
						if (TensionLevel == 5) TensionTimer = 7465;
						if (TensionLevel == 6) TensionTimer = 8958;
						if (TensionLevel == 7) TensionTimer = 10750;
					}
					TensionWarmupTimer = 0; // Reset Warmup Timer
				}
			}
			else
			{
				if (TensionLevel > 0) // Level
				{ 
					owner.A_StartSound("tensionrevert",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM); TensionLevel = 0; 
				}
				TensionLevelLastTic = clamp(TensionLevelLastTic, TensionLevelLastTic, 0); // Compare
				TensionTimer = clamp(TensionTimer, TensionTimer, 0); // Timer
				if (TensionCountingDown != 0) TensionCountingDown = 0; // Timer Counts Down?
				TensionWarmupTimer = clamp(TensionWarmupTimer, TensionWarmupTimer, 0);
				TensionCooldownTimer = clamp(TensionCooldownTimer, TensionCooldownTimer, 0);
				TensionMaxCooldownTimer = clamp(TensionMaxCooldownTimer, TensionMaxCooldownTimer, 0);
				TensionChargeLoopTimer = clamp(TensionChargeLoopTimer, TensionChargeLoopTimer, 0);
				TensionActivePulseTimer = clamp(TensionActivePulseTimer, TensionActivePulseTimer, 0);
			}

			// Tension Effects
			if (PlayerCurrentHealth > 0)
			{
				if (TensionLevel != 0)
				{
					if (TensionLevel == 1) { pulsevolume = frandom[statitem2](0.118110236,0.244094488); maxpulseinterval = random[statitem](21,23); }
					if (TensionLevel == 2) { pulsevolume = frandom[statitem2](0.141732283,0.37007874); maxpulseinterval = random[statitem](19,21); }
					if (TensionLevel == 3) { pulsevolume = frandom[statitem2](0.165354331,0.496062992); maxpulseinterval = random[statitem](17,19); }
					if (TensionLevel == 4) { pulsevolume = frandom[statitem2](0.188976378,0.622047244); maxpulseinterval = random[statitem](15,17); }
					if (TensionLevel == 5) { pulsevolume = frandom[statitem2](0.212598425,0.748031496); maxpulseinterval = random[statitem](13,15); }
					if (TensionLevel == 6) { pulsevolume = frandom[statitem2](0.236220472,0.874015748); maxpulseinterval = random[statitem](12,14); }
					if (TensionLevel == 7) { pulsevolume = frandom[statitem2](0.25984252,1.0); maxpulseinterval = random[statitem](11,13); }
					maxpulseinterval *= 2;
					if (random[statitem](1,4) == 1) randompulseinterval1 = maxpulseinterval * 2; else randompulseinterval1 = random[statitem](1,maxpulseinterval);
					if (random[statitem](1,4) == 1) randompulseinterval2 = maxpulseinterval * 2; else randompulseinterval2 = random[statitem](1,maxpulseinterval);
					if (random[statitem](1,4) == 1) randompulseinterval3 = maxpulseinterval * 2; else randompulseinterval3 = random[statitem](1,maxpulseinterval);
					if (random[statitem](1,4) == 1) randompulseinterval4 = maxpulseinterval * 2; else randompulseinterval4 = random[statitem](1,maxpulseinterval);
					TensionActivePulseTimer++; // Increase Charge-Up Sound Loop Timer
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 22 - PulseTimer]: %d", TensionActivePulseTimer);
					
					if (TensionActivePulseTimer == randompulseinterval1 && TensionLevel >= 1)
					{
						owner.A_StartSound("tensionpulserand",CHAN_5,CHANF_DEFAULT,pulsevolume,ATTN_NORM);
						randompulseinterval1 = random[statitem](1,maxpulseinterval);
					}
					if (TensionActivePulseTimer == randompulseinterval2 && TensionLevel >= 3)
					{
						owner.A_StartSound("tensionpulserand",CHAN_5,CHANF_DEFAULT,pulsevolume,ATTN_NORM);
						randompulseinterval2 = random[statitem](1,maxpulseinterval);
					}
					if (TensionActivePulseTimer == randompulseinterval3 && TensionLevel >= 5)
					{
						owner.A_StartSound("tensionpulserand",CHAN_5,CHANF_DEFAULT,pulsevolume,ATTN_NORM);
						randompulseinterval3 = random[statitem](1,maxpulseinterval);
					}
					if (TensionActivePulseTimer == randompulseinterval4 && TensionLevel >= 7)
					{
						owner.A_StartSound("tensionpulserand",CHAN_5,CHANF_DEFAULT,pulsevolume,ATTN_NORM);
						randompulseinterval4 = random[statitem](1,maxpulseinterval);
					}
					if (TensionActivePulseTimer >= maxpulseinterval) TensionActivePulseTimer = 0;
					
					// Background Sound for the humming of tension.
					TensionBackgroundAuraTimer++;
					if (TensionBackgroundAuraTimer == 1)
					{
						string tenssound = "";
						owner.A_StopSound(16);
						if (TensionLevel == 1) tenssound = "tensionaura5";
						if (TensionLevel == 2) tenssound = "tensionaura20";
						if (TensionLevel == 3) tenssound = "tensionaura50";
						if (TensionLevel == 4) tenssound = "tensionaura100";
						if (TensionLevel == 5) tenssound = "tensionaura250";
						if (TensionLevel == 6) tenssound = "tensionaura500";
						if (TensionLevel == 7) tenssound = "tensionaura1000";
						owner.A_StartSound(tenssound,16,CHANF_DEFAULT,1.0,ATTN_NORM);
					}
					if (TensionBackgroundAuraTimer >= 68) TensionBackgroundAuraTimer = 0;
					
					int TensionOverchargeDmgFactor;
					int TensionOverchargeDmgBase;
					int TensionOverchargeDmgFinal;
					int TensionOverchargeDmgThreshold = PlayerCurrentHealth / 256;
					TensionOverchargeDmgThreshold = clamp(TensionOverchargeDmgThreshold, 1, TensionOverchargeDmgThreshold);
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 23 - Set Overcharge DMG Threshold]: %d", TensionOverchargeDmgThreshold);
					
					// Overcharge Tracking
					int TensionOCTimer1Amount = 20;
					int TensionOCTimer2Amount = 20;
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24 - Set Overcharge Increment Amts]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);
					
					if (InvulnerabilityTimer > 0) // Invulnerability stops the Overcharge timers while in effect
					{
						TensionOCTimer1Amount *= 0;
						TensionOCTimer2Amount *= 0;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24b - Set Overcharge Increment (Invuln)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (DQOomphTimer > 0) // Oomph Slows it down
					{
						TensionOCTimer1Amount *= 0.75;
						TensionOCTimer2Amount *= 0.75;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24c - Set Overcharge Increment (Oomph)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (DQBuffTimer > 0) // Buff Slows it down
					{
						TensionOCTimer1Amount *= 0.75;
						TensionOCTimer2Amount *= 0.75;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24d - Set Overcharge Increment (Buff)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (DQAcceleratleTimer > 0) // Accelerate Speeds it up
					{
						TensionOCTimer1Amount *= 1.2;
						TensionOCTimer2Amount *= 1.2;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24e - Set Overcharge Increment (Accelerate)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (DQDeceleratleTimer > 0) // Decelerate Slows it down
					{
						TensionOCTimer1Amount *= 0.8;
						TensionOCTimer2Amount *= 0.8;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24f - Set Overcharge Increment (Decelerate)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (PoisonedTimer > 0) // Poison Really Speeds it Up
					{
						TensionOCTimer1Amount *= 1.75;
						TensionOCTimer2Amount *= 1.75;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24g - Set Overcharge Increment (Poison)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (BerserkTimer > 0) // Berserk Speeds it up
					{
						TensionOCTimer1Amount *= 1.25;
						TensionOCTimer2Amount *= 1.25;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24h - Set Overcharge Increment (Berserk)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (TensionCountingDown == 1) // If Tension is draining
					{
						TensionOCTimer1Amount = TensionOCTimer1Amount / 3;
						TensionOCTimer2Amount = TensionOCTimer2Amount / 3;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24i - Set OverPsyche/Overcharge Increment (Tension CountDown)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (DivineAvatarTimer == 1) // DivineAvatar
					{
						TensionOCTimer1Amount *= 0.5;
						TensionOCTimer2Amount *= 0.5;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24j - Set OverPsyche/Overcharge Increment (Divine Avatar)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					if (GoETimer > 0) // GoE
					{
						TensionOCTimer1Amount *= 0.2;
						TensionOCTimer2Amount *= 0.2;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 24k - Set OverPsyche/Overcharge Increment (GoE)]: OverPsyche: %d, OverCharge: %d", TensionOCTimer1Amount, TensionOCTimer2Amount);

					// TensionOverCharge Allowed?
					if (TensionOverChargeAllowed > 1)
					{
						TensionOverPsycheTimer += TensionOCTimer1Amount; 
					}
					else
					{
						TensionOverPsycheTimer = 0;
					}
					if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 25 - OverPsyche Increment]: OverPsycheTimer: %d / %d, OverPsyche: %d", TensionOverPsycheTimer, TensionMaxOverPsycheTimer, TensionOCTimer1Amount);
					
					if (TensionOverPsycheTimer >= TensionMaxOverPsycheTimer && TensionOverChargeAllowed > 1)
					{
						TensionOverPsycheTimer = TensionMaxOverPsycheTimer;
						if (TensionOverChargeAllowed > 1) 
						{
							TensionOverchargeTimer += TensionOCTimer2Amount;
						}
						else 
						{
							TensionOverchargeTimer = 0;
						}
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 26 - OverCharge Increment]: OverChargeTimer: %d / %d, OverPsyche: %d", TensionOverchargeTimer, TensionMaxOverchargeTimer, TensionOCTimer2Amount);
						
						if (TensionOverchargeTimer >= TensionMaxOverchargeTimer && TensionOverChargeAllowed > 1)
						{
							TensionOverchargeTimer = 0;
							TensionMaxOverchargeTimer = 0;
							TensionOverchargeDmgFactor = random[statitem](6,10) * ((6 + ((TensionLevel * 9) / 4)) / 7);
							TensionOverchargeDmgBase = (random[statitem](2,3) * TensionOverchargeDmgFactor) / 8;
							if (TensionOverchargeDmgBase < 2 && TensionLevel > 4) TensionOverchargeDmgBase = 2;
							if (GoETimer > 0) TensionOverchargeDmgBase *= 0.2;
							if (TensionOverchargeDmgBase < 1) TensionOverchargeDmgBase = 1;
							TensionOverchargeDmgFinal = PlayerCurrentHealth - TensionOverchargeDmgBase;
							if (TensionOverchargeDmgFinal < TensionOverchargeDmgThreshold) TensionOverchargeDmgFinal = TensionOverchargeDmgThreshold;
							if (TensionOverchargeDmgFinal > TensionOverchargeDmgThreshold)
							{
								if (InvulnerabilityTimer == 0) // If not Invulnerable
								{
									if (random[statitem](1,5) == 1)
									{
										if (CharacterClass == 0)
										{
											owner.A_StartSound("deggaris/pain",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										}
										if (CharacterClass == 1)
										{
											owner.A_StartSound("illucia/pain",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
										}
										if (CharacterClass == 2)
										{
											//owner.A_StopSound(CHAN_VOICE); 
											if (health > 0)
											{
												if (HealthRatio >= 667) owner.A_StartSound("FloraPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
												else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("FloraPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
												else if (HealthRatio < 334) owner.A_StartSound("FloraPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
											}
										}
										if (CharacterClass == 8)
										{
											//owner.A_StopSound(CHAN_VOICE); 
											if (health > 0)
											{
												if (HealthRatio >= 667) owner.A_StartSound("AilishPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); 
												else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("AilishPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
												else if (HealthRatio < 334) owner.A_StartSound("AilishPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
											}
										}
										if (CharacterClass == 9)
										{
											//owner.A_StopSound(CHAN_VOICE); 
											if (health > 0)
											{
												if (HealthRatio >= 667) owner.A_StartSound("PetraPainSet1",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); 
												else if (HealthRatio >= 334 && HealthRatio < 667) owner.A_StartSound("PetraPainSet2",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
												else if (HealthRatio < 334) owner.A_StartSound("PetraPainSet3",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
											}
										}
									}
									owner.player.health = owner.player.mo.health = TensionOverchargeDmgFinal;
									PlayerCurrentHealth = owner.player.health;
									if ((dvds_showdamagemessages & 1) && TensionOverchargeDmgBase) 
									{
										string PsychDmgMessage = "";
										PsychDmgMessage.AppendFormat(" * \cy%d\c- damage dealt to \cx%s\c- from \c[purple]OverPsych\c-!", TensionOverchargeDmgBase, ownername);
										if (dvds_showdamagemessagedebug) PsychDmgMessage.AppendFormat(" (%d)", gametic);
										Console.Printf("%s", PsychDmgMessage);
									}
								}
							}
						}
					}
					else
					{
						TensionOverchargeTimer = 0;
					}
					
					int tensiontimerdecrease;
					if (TensionCountingDown != 0 && TensionTimer >= 0)
					{
						tensiontimerdecrease = 20;
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 27 - TensionDecrease Increment]: %d", tensiontimerdecrease);

						tensiontimerdecrease = tensiontimerdecrease * dvds_tension_countdownmultiplier / 100;
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 27b - TensionDecrease Multiplier]: %d, Multiplier: %d%", tensiontimerdecrease, dvds_tension_countdownmultiplier);

						if (dvds_musou_powertripmode == 1) tensiontimerdecrease = tensiontimerdecrease / 5; // 'Power Trip' mode cheat
						if (dvds_musou_powertripmode == 2) tensiontimerdecrease = tensiontimerdecrease / 10; // 'Power Trip' mode cheat
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 27c - TensionDecrease - Power Trip]: %d", tensiontimerdecrease);

						if (owner.CountInv("MartArtsMaster") == 1) tensiontimerdecrease = (tensiontimerdecrease * random[statitem](980,990)) / 1000;
						if (owner.CountInv("MartArtsMaster") == 2) tensiontimerdecrease = (tensiontimerdecrease * random[statitem](960,980)) / 1000;
						if (owner.CountInv("MartArtsMaster") == 3) tensiontimerdecrease = (tensiontimerdecrease * random[statitem](920,960)) / 1000;
						if (owner.CountInv("MartArtsMaster") == 4) tensiontimerdecrease = (tensiontimerdecrease * random[statitem](800,900)) / 1000;
						if (owner.CountInv("MartArtsMaster") >= 5) tensiontimerdecrease = (tensiontimerdecrease * random[statitem](400,600)) / 1000;
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 27d - TensionDecrease - MartArts Mastery]: %d", tensiontimerdecrease);

						PerkFactor = 10000 - ((PsychFstPerkLvl * 250) + (PsychFstEXPerkLvl * 625));
						tensiontimerdecrease = (tensiontimerdecrease * PerkFactor) / 10000;
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 27e - TensionDecrease - PsycheFast]: %d, PerkFactor: %d / 10000", tensiontimerdecrease, PerkFactor);

						TensionTimer -= tensiontimerdecrease;
						if (dvdsdebug_showtensioninformation) Console.Printf("Tension [Step 28 - TensionDecrease - Decrement]: %d, Decrease: %d", TensionTimer, tensiontimerdecrease);
					}
					
					if (TensionTimer <= 0 || (SleepCanDisperseTension && SleepTimer > 0)) 
					{
						if (dvds_allowtension > 0) // Tension is Enabled
						{
							if (TensionLevel == 1) TensionCooldownTimer = 14000; // Cooldown Timer set to 4 seconds
							if (TensionLevel == 2) TensionCooldownTimer = 14880; // Cooldown Timer set to 4.25 seconds
							if (TensionLevel == 3) TensionCooldownTimer = 15750; // Cooldown Timer set to 4.5 seconds
							if (TensionLevel == 4) TensionCooldownTimer = 17500; // Cooldown Timer set to 5 seconds
							if (TensionLevel == 5) TensionCooldownTimer = 19250; // Cooldown Timer set to 5.5 seconds
							if (TensionLevel == 6) TensionCooldownTimer = 21000; // Cooldown Timer set to 6 seconds
							if (TensionLevel == 7) TensionCooldownTimer = 26250; // Cooldown Timer set to 7.5 seconds
							TensionCooldownTimer *= 2;
							TensionMaxCooldownTimer = TensionCooldownTimer;
						}
					
						TensionTimer = 0; // Timer
						TensionWarmupTimer = 0; // Warmup Timer
						TensionCountingDown = 0; // Tension Timer
						TensionLevel = 0; // Tension Level
						TensionBackgroundAuraTimer = 0; // Tension Aura-Sound Timer
						owner.A_StopSound(CHAN_5);
						owner.A_StopSound(CHAN_6);
						owner.A_StopSound(CHAN_7);
						owner.A_StartSound("tensionrevert",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM);
						if ((dvds_showdamagemessages & 1))
						{
							string PsychMsg = " \c[purple]* ";
							PsychMsg.AppendFormat("\cx%s's\c[purple] ", ownername);
							PsychMsg.AppendFormat("\c[purple]tension returns to normal!");
							Console.Printf("%s", PsychMsg);							
						}
					}
				}
				
				if (dvds_allowtension > 0) // Tension is Enabled
				{
					TensionLevel = clamp(TensionLevel, 0, 7);
				}
				else
				{
					if (TensionLevel != 0) { TensionLevel = 0; owner.A_StartSound("tensionrevert",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM); }
					if (TensionTimer != 0) TensionTimer = 0; // Timer
					if (TensionCountingDown != 0) TensionCountingDown = 0; // Timer Counts Down?
					if (TensionWarmupTimer != 0) TensionWarmupTimer = 0;
					if (TensionCooldownTimer != 0) TensionCooldownTimer = 0;
					if (dvds_tension_chargemultiplier != 0) TensionChargeLoopTimer = 0;
					if (TensionMaxCooldownTimer != 0) TensionActivePulseTimer = 0;   
				}
	
				if (TensionLevel >= 4) { owner.A_SetInventory("TensionTrail", 1); } else { owner.A_SetInventory("TensionTrail", 0); } // Tension is "100" or higher
			}
			// Tension Aura Actor Control

			CallACS("MiscVarSetDECORATE",181,TensionLevel);
			TensionLevel = CallACS("MiscVarCheckDECORATE",181); // Refreshes Tension Level
			CallACS("MiscVarSetDECORATE",182,TensionLevelLastTic);
			CallACS("MiscVarSetDECORATE",183,TensionTimer);
			CallACS("MiscVarSetDECORATE",184,TensionCountingDown);
			CallACS("MiscVarSetDECORATE",185,TensionWarmupTimer);
			CallACS("MiscVarSetDECORATE",186,TensionCooldownTimer);
			CallACS("MiscVarSetDECORATE",188,TensionMaxCooldownTimer);
			CallACS("MiscVarSetDECORATE",189,TensionChargeLoopTimer);
			CallACS("MiscVarSetDECORATE",190,TensionActivePulseTimer);
			CallACS("MiscVarSetDECORATE",250,TensionOverPsycheTimer);
			CallACS("MiscVarSetDECORATE",251,TensionOverchargeTimer);
			CallACS("MiscVarSetDECORATE",261,TensionMaxOverchargeTimer);
			CallACS("MiscVarSetDECORATE",262,TensionMaxOverPsycheTimer);
		}
	}

	// Tension Aura
	void A_PSI1DoEffectTensionAuras()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		//*********************
		//*Check Tension Auras*
		//*********************
		double TensionAuraXScale;
		double TensionAuraYScale;
		double TensionAuraAlpha;
		int TensionAuraCheck;
		if (playeractor)
		{
			if (TensionLevel > 0)
			{
				double TensionAuraXScaleExtra = 1.0;
				double TensionAuraYScaleExtra = 1.0;
				if (ClassicDoomType == 5) // Doom 64
				{
					TensionAuraXScaleExtra = 1.1;
					TensionAuraYScaleExtra = 1.375;
				}
				
				if (TensionLevel == 1)
				{
					TensionAuraXScale = 0.5 * TensionAuraXScaleExtra;
					TensionAuraYScale = 0.75 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.20;
				}
				if (TensionLevel == 2)
				{
					TensionAuraXScale = 0.5555 * TensionAuraXScaleExtra;
					TensionAuraYScale = 0.8333 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.26;
				}
				if (TensionLevel == 3) 
				{
					TensionAuraXScale = 0.6111 * TensionAuraXScaleExtra;
					TensionAuraYScale = 0.9116 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.32;
				}
				if (TensionLevel == 4)
				{
					TensionAuraXScale = 0.6667 * TensionAuraXScaleExtra;
					TensionAuraYScale = 1.0 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.38;
				}
				if (TensionLevel == 5) 
				{
					TensionAuraXScale = 0.7222 * TensionAuraXScaleExtra;
					TensionAuraYScale = 1.0833 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.44;
				}
				if (TensionLevel == 6) 
				{
					TensionAuraXScale = 0.7777 * TensionAuraXScaleExtra;
					TensionAuraYScale = 1.1666 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.5;
				}
				if (TensionLevel == 7) 
				{
					TensionAuraXScale = 0.8333 * TensionAuraXScaleExtra;
					TensionAuraYScale = 1.25 * TensionAuraYScaleExtra;
					TensionAuraAlpha = 0.56;
				}
				if (InvisibilityTimer > 0) TensionAuraAlpha *= 0.10;

				TensionAuraCheck = 0;
				ThinkerIterator Test1 = ThinkerIterator.Create("TensionAuraLightPlayer"); Actor mo; while (mo = Actor(Test1.Next())) { TensionAuraCheck++; }
				if (TensionAuraCheck < 1) 
				{
					A_SpawnItemEx("TensionAuraLightPlayer",owner.pos.x,owner.pos.y,owner.pos.z,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION);
					if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraLightPlayer Spawned");
				}
				if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraCheck (TensionAuraLightPlayer): %d", TensionAuraCheck);
				
				// Misc Rescaling
				if (dvds_tensionauratype == 0) // Classic Tension Aura Sprites
				{
					TensionAuraXScale *= 1.0;
					TensionAuraYScale *= 1.0;
				}
				if (dvds_tensionauratype == 1) // Updated Tension Aura Sprites
				{
					TensionAuraXScale *= 0.575;
					TensionAuraYScale *= 0.425;
				}
				
				if (CharacterClass == 0) { TensionAuraXScale *= 1.12;	TensionAuraYScale *= 1.23; }
				if (CharacterClass == 1) { TensionAuraXScale *= 1.04;	TensionAuraYScale *= 1.08; }
				if (CharacterClass == 2) { TensionAuraXScale *= 1.0;	TensionAuraYScale *= 1.0; }
				if (CharacterClass == 8) { TensionAuraXScale *= 0.98;	TensionAuraYScale *= 0.98; }
				if (CharacterClass == 9) { TensionAuraXScale *= 0.96;	TensionAuraYScale *= 0.96; }
				
				TensionAuraCheck = 0;
				Test1 = ThinkerIterator.Create("TensionAuraLooper"); while (mo = Actor(Test1.Next())) { TensionAuraCheck++; }
				if (TensionAuraCheck < 1) 
				{
					if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraLooper Spawned");
					A_SpawnItemEx("TensionAuraLooper",owner.pos.x,owner.pos.y,owner.pos.z,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION);
				}

				if (dvdsdebug_showtensioninformation) Console.Printf("Tension Aura (Level: %d): ScaleX %.8f, ScaleY: %.8f, Alpha: %.8f", TensionLevel, TensionAuraXScale, TensionAuraYScale, TensionAuraAlpha);
				Test1 = ThinkerIterator.Create("TensionAuraLooper");  
				if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraCheck (TensionAuraLooper): %d", TensionAuraCheck);
				while (mo = Actor(Test1.Next())) 
				{
					mo.Alpha = TensionAuraAlpha; 
					mo.Scale.x = TensionAuraXScale; 
					mo.Scale.y = TensionAuraYScale; 
				}
			}
			else
			{
				ThinkerIterator Test1 = ThinkerIterator.Create("TensionAuraLooper"); Actor mo; while (mo = Actor(Test1.Next())) 
				{ 
					if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraLooper Destroyed");
					mo.Destroy(); 
				}
				Test1 = ThinkerIterator.Create("TensionAuraLightPlayer"); while (mo = Actor(Test1.Next())) 
				{ 
					if (dvdsdebug_showtensioninformation) Console.Printf("\cxTensionAuraLightPlayer Destroyed");
					mo.Destroy(); 
				}
			}
			//if (dvdsdebug_showtensioninformation) Console.Printf("\cyTics: %d", level.totaltime);
		}
	}

	void A_PSI1DoEffectSpecialArray()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			int DVDSSpecialArrayCheck = 0;
			int DVDSArrayValue;
			
			while (DVDSSpecialArrayCheck < 256)
			{
				DVDSArrayValue = playeractor.user_PlayerDVDSSpecial[DVDSSpecialArrayCheck];
				CallACS("DVDSSpecialArraySetDECORATE",DVDSSpecialArrayCheck,DVDSArrayValue);
				//Console.Printf("DVDSSpecialArrayCheck: %d / 256 - (%d)",DVDSSpecialArrayCheck, DVDSArrayValue);
				DVDSSpecialArrayCheck++;
			}
			// DVDSSpecialArrayValue[0] = Off = "Conscious", On = "Unconscious"
			if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious"))
			{
				//Console.Printf("Unconscious");
			}

			// DVDSSpecialArrayValue[1] = Sets MP/Mana to 0 then unsets itself
			if (CallACS("DVDSSpecialArrayCheckDECORATE",1) > 0 || owner.CountInv("TakeAllMPMana"))
			{
				CallACS("OtherVarSetDECORATE",2,0);
				CurrentMana = CallACS("StatCheck",14); // Refreshs Current MP amount
				CallACS("DVDSSpecialArraySetDECORATE",1,0);
				playeractor.user_PlayerDVDSSpecial[1] = 0;
				owner.A_SetInventory("TakeAllMPMana",0);
			}
			// DVDSSpecialArrayValue[2] = Sets Stamina to 0 then unsets itself
			if (CallACS("DVDSSpecialArrayCheckDECORATE",2) > 0 || owner.CountInv("TakeAllStamina"))
			{
				CallACS("MiscVarSetDECORATE",21,0);
				CurrentStamina = CallACS("MiscVarCheckDECORATE",21); // Refreshes Current Stamina
				CallACS("DVDSSpecialArraySetDECORATE",2,0);
				playeractor.user_PlayerDVDSSpecial[2] = 0;
				owner.A_SetInventory("TakeAllStamina",0);
			}
		
			// DVDSSpecialArrayValue[3] = Unloved Specific - Makes Hellcore Weapons drop 4x more often, etc :o
			// DVDSSpecialArrayValue[4] = TCOTD:A Specific
			// DVDSSpecialArrayValue[5] = Circus2 Specific
			
			// DVDSSpecialArrayValue[6] = Make HUD invisible [for TITLEMAP usage]
			if (CallACS("DVDSSpecialArrayCheckDECORATE",6) > 0 || owner.CountInv("DisableHUD"))
			{
				CallACS("MiscVarSetDECORATE",2000,-1);
				CallACS("DVDSSpecialArraySetDECORATE",6,0);
				playeractor.user_PlayerDVDSSpecial[6] = 0;
				owner.A_SetInventory("DisableHUD",0);
			}
			// DVDSSpecialArrayValue[7] = Make HUD visible again
			if (CallACS("DVDSSpecialArrayCheckDECORATE",7) > 0 || owner.CountInv("EnableHUD")) 
			{
				CallACS("MiscVarSetDECORATE",2000,1);
				CallACS("DVDSSpecialArraySetDECORATE",7,0);
				playeractor.user_PlayerDVDSSpecial[7] = 0;
				owner.A_SetInventory("EnableHUD",0);
			}
			// DVDSSpecialArrayValue[8] = Remove all weapons [TITLEMAP]
			if (CallACS("DVDSSpecialArrayCheckDECORATE",8) > 0 || owner.CountInv("RemoveAllWeapons")) 
			{
				owner.A_SetInventory("RemoveAllWeapons",0);
				owner.ClearInventory();
				owner.A_SetInventory("SceptreOfEmpyrea",0);
				CallACS("DVDSSpecialArraySetDECORATE",8,0);
				playeractor.user_PlayerDVDSSpecial[8] = 0;
			}
			
			// DVDSSpecialArrayValue[9] = Prevents Dashing

			// DVDSSpecialArrayValue[10] = KDIZD Specific

			// DVDSSpecialArrayValue[11] = TUTNT Specific
		}
	}
	
	// Sceptre EXP Tables
	void A_PSI1DoEffectSceptreEXPTables()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && CharacterClass == 2)
		{
			if (InitSceptreEXPTables == 0)
			{
				BaseSceptreEXP = 312;
				if (TrueGameSkill <= SKILL_VERY_EASY) BaseSceptreEXP = 240;
				if (TrueGameSkill == SKILL_EASY) BaseSceptreEXP = 288;
				if (TrueGameSkill == SKILL_NORMAL) BaseSceptreEXP = 312;
				if (TrueGameSkill == SKILL_HARD) BaseSceptreEXP = 336;
				if (TrueGameSkill == SKILL_VERY_HARD) BaseSceptreEXP = 384;
				if (TrueGameSkill == SKILL_EXTREME) BaseSceptreEXP = 408;
				if (TrueGameSkill == SKILL_HORRIBLE) BaseSceptreEXP = 432;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) BaseSceptreEXP = 456;
				if (TrueGameSkill >= SKILL_OMEGA) BaseSceptreEXP = 480;
				
				SceptreLvl1Req = BaseSceptreEXP * 1;
				SceptreLvl2Req = BaseSceptreEXP * 3;
				SceptreLvl3Req = BaseSceptreEXP * 6;
				SceptreLvl4Req = BaseSceptreEXP * 10;
				SceptreLvl5Req = BaseSceptreEXP * 15;
				SceptreLvl6Req = BaseSceptreEXP * 21;
				SceptreLvl7Req = BaseSceptreEXP * 28;
				SceptreLvl8Req = BaseSceptreEXP * 36;
				SceptreLvl9Req = BaseSceptreEXP * 45;
				SceptreLvl10Req = BaseSceptreEXP * 55;
				SceptreLvl11Req = BaseSceptreEXP * 66;
				SceptreLvl12Req = BaseSceptreEXP * 78;
				SceptreLvl13Req = BaseSceptreEXP * 91;
				SceptreLvl14Req = BaseSceptreEXP * 105;
				SceptreLvl15Req = BaseSceptreEXP * 120;
				SceptreLvl16Req = BaseSceptreEXP * 136;
				CallACS("MiscVarSetDECORATE",301,SceptreLvl1Req);
				CallACS("MiscVarSetDECORATE",302,SceptreLvl2Req);
				CallACS("MiscVarSetDECORATE",303,SceptreLvl3Req);
				CallACS("MiscVarSetDECORATE",304,SceptreLvl4Req);
				CallACS("MiscVarSetDECORATE",305,SceptreLvl5Req);
				CallACS("MiscVarSetDECORATE",306,SceptreLvl6Req);
				CallACS("MiscVarSetDECORATE",307,SceptreLvl7Req);
				CallACS("MiscVarSetDECORATE",308,SceptreLvl8Req);
				CallACS("MiscVarSetDECORATE",309,SceptreLvl9Req);
				CallACS("MiscVarSetDECORATE",310,SceptreLvl10Req);
				CallACS("MiscVarSetDECORATE",311,SceptreLvl11Req);
				CallACS("MiscVarSetDECORATE",312,SceptreLvl12Req);
				CallACS("MiscVarSetDECORATE",313,SceptreLvl13Req);
				CallACS("MiscVarSetDECORATE",314,SceptreLvl14Req);
				CallACS("MiscVarSetDECORATE",315,SceptreLvl15Req);
				CallACS("MiscVarSetDECORATE",316,SceptreLvl16Req);
				//Console.Printf("Sceptre EXP Requirements - BaseReq: %d / Lvl 1: %d / Lvl 2: %d / Lvl 3: %d / Lvl 4: %d / Lvl 5: %d / Lvl 6: %d / Lvl 7: %d / Lvl 8: %d / Lvl 9: %d / Lvl 10: %d / Lvl 11: %d / Lvl 12: %d / Lvl 13: %d / Lvl 14: %d / Lvl 15: %d / Lvl 16: %d", BaseSceptreEXP, SceptreLvl1Req, SceptreLvl2Req, SceptreLvl3Req, SceptreLvl4Req, SceptreLvl5Req, SceptreLvl6Req, SceptreLvl7Req, SceptreLvl8Req, SceptreLvl9Req, SceptreLvl10Req, SceptreLvl11Req, SceptreLvl12Req, SceptreLvl13Req, SceptreLvl14Req, SceptreLvl15Req, SceptreLvl16Req);
				
				InitSceptreEXPTables++;
			}
			
			SceptreLevelEXP = CallACS("OtherVarCheckDECORATE",10);
			if (SceptreLevelEXP >= CallACS("MiscVarCheckDECORATE",316)) SceptreActualLevel = 16;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",316)) SceptreActualLevel = 15;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",315)) SceptreActualLevel = 14;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",314)) SceptreActualLevel = 13;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",313)) SceptreActualLevel = 12;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",312)) SceptreActualLevel = 11;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",311)) SceptreActualLevel = 10;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",310)) SceptreActualLevel = 9;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",309)) SceptreActualLevel = 8;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",308)) SceptreActualLevel = 7;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",307)) SceptreActualLevel = 6;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",306)) SceptreActualLevel = 5;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",305)) SceptreActualLevel = 4;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",304)) SceptreActualLevel = 3;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",303)) SceptreActualLevel = 2;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",302)) SceptreActualLevel = 1;
			if (SceptreLevelEXP < CallACS("MiscVarCheckDECORATE",301)) SceptreActualLevel = 0;
			//Console.Printf("%d", SceptreActualLevel);
			CallACS("OtherVarSetDECORATE",11,SceptreActualLevel); 

			// Check for Sceptre Abilities
			if (CharacterClass == 2 && PlayerLevel >= 8 && SceptreActualLevel >= 2) CallACS("MiscVarSetDECORATE",244,1); else CallACS("MiscVarSetDECORATE",244,0);
			if (CharacterClass == 2 && PlayerLevel >= 13 && SceptreActualLevel >= 4) CallACS("MiscVarSetDECORATE",274,1); else CallACS("MiscVarSetDECORATE",274,0);
		}
	}

	// EXP Tables
	void A_PSI1DoEffectEXPTables()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && InitEXPTables == 0)
		{
			double ExpValue;
			int BaseEXPRequirement = clamp(dvds_baseexprequirement, 250, 11200);
			BaseEXPRequirement *= (0.75 + (TrueGameSkill * 0.125));

			double BaseExtra = clamp(dvds_baseexpextra, 0, 100);
			double BaseAccel1 = clamp(dvds_baseexpaccel1, 0, 100);
			double BaseAccel2 = clamp(dvds_baseexpaccel2, 0.0, 5.0);
			double BaseMulti1 = clamp(dvds_expmulti1, 1, 1024);
			double BaseMulti2 = clamp(dvds_expmulti2, 1, 10000);
			
			double BaseMulti3 = 1.0;
			int baseval;
			int addval;
			double mulval;
			int preval = 0;
			
			double BaseMulti3b = 2.0;
			double BaseMulti4 = 1.0;
			double BaseMulti5 = 0.01;

			// Sets up the actual EXP requirement tables based from BaseEXPRequirement above.
			for (int CuLv = 0; CuLv < 201; CuLv++)
			{
				if (CuLv >= 0 && CuLv <= 31) BaseMulti4 = 1.0;
				if (CuLv >= 32 && CuLv <= 56) BaseMulti4 = 1.334;
				if (CuLv >= 57 && CuLv <= 80) BaseMulti4 = 1.667;
				if (CuLv >= 81 && CuLv <= 100) BaseMulti4 = 2;
				if (CuLv >= 101 && CuLv <= 109) BaseMulti4 = 4;
				if (CuLv >= 110 && CuLv <= 118) BaseMulti4 = 6;
				if (CuLv >= 119 && CuLv <= 127) BaseMulti4 = 8;
				if (CuLv >= 128 && CuLv <= 136) BaseMulti4 = 10;
				if (CuLv >= 137 && CuLv <= 145) BaseMulti4 = 12;
				if (CuLv >= 146 && CuLv <= 154) BaseMulti4 = 14;
				if (CuLv >= 155 && CuLv <= 163) BaseMulti4 = 16;
				if (CuLv >= 164 && CuLv <= 172) BaseMulti4 = 18;
				if (CuLv >= 173 && CuLv <= 181) BaseMulti4 = 20;
				if (CuLv >= 182 && CuLv <= 190) BaseMulti4 = 22;
				if (CuLv >= 191 && CuLv <= 199) BaseMulti4 = 24;
				if (CuLv >= 200) BaseMulti4 = 30.0;

				BaseMulti3 = (BaseMulti4 + (CuLv * ((BaseMulti4 * BaseMulti5) * BaseMulti3b)));

				baseval = BaseEXPRequirement * (((CuLv * BaseExtra) + 1));
				baseval *= (1.00 + ((CuLv + 1) * 0.000625));

				mulval = (((CuLv * (BaseAccel1 * ((BaseMulti1 + CuLv) / BaseMulti1))) + BaseMulti2) / BaseMulti2);
				addval = (((BaseEXPRequirement * (CuLv * BaseAccel2)) * BaseMulti3) * ((BaseMulti4) * 1.5));
				ExpValue = baseval;
				if (dvdsdebug_initdisplays) Console.Printf("ExpValue: %d (%d)", ExpValue, baseval);
				ExpValue *= mulval;
				if (dvdsdebug_initdisplays) Console.Printf("(*) ExpValue: %d (%.8f)", ExpValue, mulval);
				ExpValue += addval;
				if (dvdsdebug_initdisplays) Console.Printf("(+) ExpValue: %d (%d)", ExpValue, addval);
				
				if (CuLv > 0) preval = CallACS("ExpTableSetDECORATE",(CuLv-1),0,-1);

				if (dvdsdebug_initdisplays) Console.Printf("\czLevel \cy%d\c- \czEXP Requirement: \cy%d \cz(prev: \cy%d)\cz, Multi: %.8f, baseval: %d, mulval: %.8f, addval: %d, diff: %d\c-", CuLv, ExpValue, preval, BaseMulti3, baseval, mulval, addval, (ExpValue-preval));
				CallACS("ExpTableSetDECORATE",CuLv,ExpValue);
			}
			if (dvdsdebug_initdisplays) Console.Printf("BaseEXPRequirement: %4f, BaseExtra: %4f / 100, BaseAccel1: %4f / 100, BaseAccel2: %3f / 25000, BaseMulti1: %3f / 1024, BaseMulti2: %3f / 10000", BaseEXPRequirement, BaseExtra, BaseAccel1, BaseAccel2, BaseMulti1, BaseMulti2);
			CallACS("ExpTableSetDECORATE",201,2147483647);
			InitEXPTables++;
		}
	}

	// Level Up Code
	void A_PSI1DoEffectLevelUp()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		//*******************
		//** LEVEL UP CODE **
		//*******************
		if (playeractor)
		{
			double RandomizedStatChance, RandomizedStatChance2;
			int Experience = CallACS("OtherVarCheckDECORATE",12);
			int levelmodulo, levelbonustype;
			int leveluptimes = 0;
			int leveluptimesmax = LevelCap - PlayerLevel;
			int tempaeonpointincrease;
			
			for (leveluptimes = 0; leveluptimes < leveluptimesmax; leveluptimes++)
			{
				//Console.Printf("%d / %d", leveluptimes, leveluptimesmax);
				CallACS("MiscVarSetDECORATE",48,(CallACS("ExpTableCheckDECORATE",PlayerLevel)-Experience));
				if (Experience >= CallACS("ExpTableCheckDECORATE",PlayerLevel))
				{
					tempaeonpointincrease = 0;
					if (PlayerLevel < LevelCap)
					{
						CallACS("OtherVarSetDECORATE",14,1,1); // PlayerLevel += 1;
						PlayerLevel = CallACS("StatCheck",0);

						CallACS("MiscVarSetDECORATE",171,105); // Turns on the "Level Up!!" and "Stat Up" indicators for 3 seconds on the HUD upon level up.
						CallACS("MiscVarSetDECORATE",204,PlayerAeonPts); // total Aeon Points gained
						CallACS("MiscVarSetDECORATE",205,PlayerAGL); // total Agility Points gained
						CallACS("MiscVarSetDECORATE",206,PlayerDEF); // total Defense Points gained
						CallACS("MiscVarSetDECORATE",207,PlayerDFT); // total Deftness Points gained
						CallACS("MiscVarSetDECORATE",208,PlayerSOR); // total Sorcery Points gained
						CallACS("MiscVarSetDECORATE",209,PlayerSTR); // total Strength Points gained
						CallACS("MiscVarSetDECORATE",210,PlayerTHE); // total Therapeusis Points gained
						if (dvdsdebug_levelupdisplays)
						{
							Console.Printf("1 - \cfAeon: %d\c-, \cnAgl: %d\c-, \cpDef: %d\c-, \cdDft: %d\c-, \ctSor: %d\c-, \cgStr: %d\c-, \ccThe: %d\c-", 
															CallACS("MiscVarCheckDECORATE",204), CallACS("MiscVarCheckDECORATE",205),
															CallACS("MiscVarCheckDECORATE",206), CallACS("MiscVarCheckDECORATE",207),
															CallACS("MiscVarCheckDECORATE",208), CallACS("MiscVarCheckDECORATE",209),
															CallACS("MiscVarCheckDECORATE",210));
						}

						levelmodulo = PlayerLevel % 20;
						if (levelmodulo == 0) levelbonustype = 0;
						else if (levelmodulo == 4) levelbonustype = 1;
						else if (levelmodulo == 5) levelbonustype = randompick[statitem](2,2,2,2,1);
						else if (levelmodulo == 8) levelbonustype = 1;
						else if (levelmodulo == 10) levelbonustype = randompick[statitem](2,2,2,2,1);
						else if (levelmodulo == 12) levelbonustype = 1;
						else if (levelmodulo == 15) levelbonustype = randompick[statitem](2,2,2,2,1);
						else if (levelmodulo == 16) levelbonustype = 1;
						else levelbonustype = 2;
						if (dvdsdebug_levelupdisplays) Console.Printf("\cyLevel Check\c-: %d, \cxModulo\c-: %d, \czBonus Type\c-: %d", PlayerLevel, levelmodulo, levelbonustype);

						//*********************
						//*Aeon Point Increase*
						//*********************
						if (PlayerLevel != 0)
						{
							double baseaeonchance1 = 65.0 + (ClearMindPerkLvl * 0.65) + (ClearMindEXPerkLvl * (0.65 * 2.5));
							double baseaeonchance2 = 25.0 + (ClearMindPerkLvl * 0.25) + (ClearMindEXPerkLvl * (0.25 * 2.5));
							double baseaeonchance3 = 20.0 + (ClearMindPerkLvl * 0.2) + (ClearMindEXPerkLvl * (0.2 * 2.5));
							double baseaeonchance4 = 2.5 + (ClearMindPerkLvl * 0.025) + (ClearMindEXPerkLvl * (0.025 * 2.5));
							if (levelbonustype == 0) // Levels 20, 40, 60, 80, 100, 120, 140, 160, 180 & 200 [really big Aeon Point gains]
							{
								baseaeonchance1 = 65.0 + (ClearMindPerkLvl * 0.65) + (ClearMindEXPerkLvl * (0.65 * 2.5));
								baseaeonchance2 = 25.0 + (ClearMindPerkLvl * 0.25) + (ClearMindEXPerkLvl * (0.25 * 2.5));
								baseaeonchance3 = 20.0 + (ClearMindPerkLvl * 0.2) + (ClearMindEXPerkLvl * (0.2 * 2.5));
								baseaeonchance4 = 2.5 + (ClearMindPerkLvl * 0.025) + (ClearMindEXPerkLvl * (0.025 * 2.5));
								if (PlayerLevel > 100)
								{
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) tempaeonpointincrease += 4; else tempaeonpointincrease += 2;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += random[statitem](1,4);
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += random[statitem](1,4);
								}
								else
								{
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) tempaeonpointincrease += 3; else tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += random[statitem](1,3);
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += random[statitem](1,3);
								}
							}
							else
							if (levelbonustype == 1) // Levels [0/2/4/6/8/10/12/14/16/18]4, [0/2/4/6/8/10/12/14/16/18]8, [1/3/5/7/9/11/13/15/17/19]2, & [1/3/5/7/9/11/13/15/17/19]6
							{
								baseaeonchance1 = 65 + (ClearMindPerkLvl * 0.65) + (ClearMindEXPerkLvl * (0.65 * 2.5));
								baseaeonchance2 = 15 + (ClearMindPerkLvl * 0.15) + (ClearMindEXPerkLvl * (0.15 * 2.5));
								baseaeonchance3 = 10 + (ClearMindPerkLvl * 0.1) + (ClearMindEXPerkLvl * (0.1 * 2.5));
								baseaeonchance4 = 1.5 + (ClearMindPerkLvl * 0.015) + (ClearMindEXPerkLvl * (0.015 * 2.5));
								if (PlayerLevel > 100)
								{
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += random[statitem](1,2);
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += random[statitem](1,2);
								}
								else
								{
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += random[statitem](0,1);
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += random[statitem](0,1);
								}
							}
							else
							if (levelbonustype == 2) // Any other level that's not a multiple of 4 or 20 [minor Aeon Point gains]
							{
								baseaeonchance1 = 65 + (ClearMindPerkLvl * 0.65) + (ClearMindEXPerkLvl * (0.65 * 2.5));
								baseaeonchance2 = 60 + (ClearMindPerkLvl * 0.6) + (ClearMindEXPerkLvl * (0.6 * 2.5));
								baseaeonchance3 = 15 + (ClearMindPerkLvl * 0.15) + (ClearMindEXPerkLvl * (0.15 * 2.5));
								baseaeonchance4 = 1.5 + (ClearMindPerkLvl * 0.015) + (ClearMindEXPerkLvl * (0.015 * 2.5));
								if (PlayerLevel > 100)
								{
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) // 60% chance of +2/3 Aeon Points per level
									{
										if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
										if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += 2; else tempaeonpointincrease += 1;
									}
								}
								else
								{
									baseaeonchance2 *= 0.5;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance1) tempaeonpointincrease += 1;
									if (frandom[statitem2](0.01,100.0) <= baseaeonchance2) // 30% chance of +1/2 Aeon Points per level
									{
										if (frandom[statitem2](0.01,100.0) <= baseaeonchance3) tempaeonpointincrease += 1;
										if (frandom[statitem2](0.01,100.0) <= baseaeonchance4) tempaeonpointincrease += 1;
									}
								}
							}
						}
						
						double extrachance = 12.5 + (ClearMindPerkLvl * 0.125) + (ClearMindEXPerkLvl * (0.125 * 2.5));
						// Extra AeonPts for "Perk Mode"
						if (dvdsperks_active)
						{
							if (random[statitem](1,100) <= 98) 
							{
								tempaeonpointincrease += 1;
								extrachance = 12.5 + (ClearMindPerkLvl * 0.125) + (ClearMindEXPerkLvl * (0.125 * 2.5));
							}
							else
							{
								tempaeonpointincrease += 2;
								extrachance = 25 + (ClearMindPerkLvl * 0.25) + (ClearMindEXPerkLvl * (0.25 * 2.5));
							}
							if (PlayerLevel >= 50 && frandom[statitem2](0.01,100.0) <= extrachance) tempaeonpointincrease += 1;
							if (PlayerLevel >= 100 && frandom[statitem2](0.01,100.0) <= extrachance) tempaeonpointincrease += 1;
							if (PlayerLevel >= 150 && frandom[statitem2](0.01,100.0) <= extrachance) tempaeonpointincrease += 1;
							if (PlayerLevel >= 200 && frandom[statitem2](0.01,100.0) <= extrachance) tempaeonpointincrease += 1;
						}
						tempaeonpointincrease *= (1.0 + (CallACS("MiscVarCheckDECORATE",11001) * 0.25)); // "Higher Learning" Grand Mastery Perk
			
						if (CallACS("DVDSSpecialArrayCheckDECORATE",3) > 0 || Owner.CountInv("PlayingUnloved")) tempaeonpointincrease += randompick[statitem](0,0,0,0,1,1,1,1,2,2); // If playing "Unloved"
						if (CallACS("DVDSSpecialArrayCheckDECORATE",4) > 0 || Owner.CountInv("PlayingTCOTDA")) tempaeonpointincrease += randompick[statitem](0,0,1,1,1,1,2,2,2,2); // If playing "TCOTD:A"
						if (CallACS("DVDSSpecialArrayCheckDECORATE",5) > 0 || Owner.CountInv("PlayingCircus2")) tempaeonpointincrease += randompick[statitem](1,1,1,1,2,2,2,2,3,3); // If playing "Circus2"
						tempaeonpointincrease *= AeonPtMulti;
						CallACS("MiscVarSetDECORATE",25,tempaeonpointincrease,1);
						PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
						
						// Increase Stats
						// 16:25 (1-100) [64] + 20:25 (101-200) [80] = [Max of 144 (or -75%)]
						RandomizedStatChance = 1.00000000; // 192;
						if (levelbonustype == 0) // Levels 20, 40, 60, 80, 100, 120, 140, 160, 180 & 200
						{
							RandomizedStatChance -= (0.1 * random[statitem](4,8)); // 112 to 152
							RandomizedStatChance -= (PlayerDFT * 0.001041667);
						}
						else
						if (levelbonustype == 1) // Levels [0/2/4/6/8/10/12/14/16/18]4, [0/2/4/6/8/10/12/14/16/18]8, [1/3/5/7/9/11/13/15/17/19]2, & [1/3/5/7/9/11/13/15/17/19]6
						{
							RandomizedStatChance -= (0.02 * random[statitem](4,8)); // 160 to 176
							RandomizedStatChance -= (PlayerDFT * 0.000744048);
						}
						else
						if (levelbonustype == 2) // Any other level that's not a multiple of 4 or 20
						{
							RandomizedStatChance -= (0.004 * random[statitem](4,8));
							RandomizedStatChance -= (PlayerDFT * 0.000651042);
						}

						double RNDSCSubtractor1 = 0;
						double RNDSCSubtractor2 = 0;
						RNDSCSubtractor1 = (PlayerLevel * 0.32);
						RNDSCSubtractor1 = clamp(RNDSCSubtractor1, 0.00000, 0.33334);
						if (PlayerLevel > 100)
						{
							RNDSCSubtractor2 = ((PlayerLevel - 100) * 0.4);
							RNDSCSubtractor2 = clamp(RNDSCSubtractor2, 0.00000, 0.33334);
						}
						if (dvdsdebug_levelupdisplays) Console.Printf("\cyRNDSCSubtractor1\c-: %.8f, \cxRNDSCSubtractor2\c-: %.8f", RNDSCSubtractor1, RNDSCSubtractor2);
			
						double RNDSCSubtractor = 0;
						RNDSCSubtractor += RNDSCSubtractor1; // Adds [level 1-100] range value
						RNDSCSubtractor += RNDSCSubtractor2; // Adds [level 101-200] range value
						RandomizedStatChance -= RNDSCSubtractor;
						if (owner.CountInv("TheOneRing")) RandomizedStatChance *= 0.75;
						RandomizedStatChance *= (1.0000 - (ClearMindPerkLvl * 0.0250) - (ClearMindEXPerkLvl * (0.0250 * 2.5)));
						if (RandomizedStatChance < 0.005208334) RandomizedStatChance = 0.005208334;
						if (dvdsdebug_levelupdisplays) Console.Printf("\cyRNDSCSubtractor\c-: %.8f, \cxRandomizedStatChance\c-: %.8f", RNDSCSubtractor, RandomizedStatChance);
			
						RandomizedStatChance2 = 1.00000000;
						if (PlayerLevel >= 25) RandomizedStatChance2 -= 0.041666667; // 23
						if (PlayerLevel >= 50) RandomizedStatChance2 -= 0.041666667; // 22
						if (PlayerLevel >= 75) RandomizedStatChance2 -= 0.041666667; // 21
						if (PlayerLevel >= 100) RandomizedStatChance2 -= 0.041666667; // 20
						if (PlayerLevel >= 125) RandomizedStatChance2 -= 0.083333334; // 18
						if (PlayerLevel >= 150) RandomizedStatChance2 -= 0.083333334; // 16
						if (PlayerLevel >= 175) RandomizedStatChance2 -= 0.083333334; // 14
						RandomizedStatChance2 *= (1.0000 - (ClearMindPerkLvl * 0.01250) - (ClearMindEXPerkLvl * (0.01250 * 2.5)));
						if (dvdsdebug_levelupdisplays) Console.Printf("\cyStat Chance 1\c-: %.8f, \cxStat Chance 2\c-: %.8f", RandomizedStatChance, RandomizedStatChance2);

						//********************************
						//*Random Levelups to Stat Values*
						//********************************
						int SeedIncreaseAmt;
						double LvlSkillMulti;
						double RollValue;
						double BaseChance1;
						double BaseChance2;
						if (CharacterClass == 0) // Deggaris (192pts) (0 left)
						{
							// Agility
							BaseChance1 = 0.125;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Agility [12.5%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
				
							// Defense
							BaseChance1 = 0.21875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Defense [21.875%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
				
							// Deftness
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Deftness [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
				
							// Sorcery
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Sorcery [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
				
							// Strength
							BaseChance1 = 0.1875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Strength [18.36%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength
				
							// Therapeusis
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Therapeusis [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis 
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
						}
						if (CharacterClass == 1) // Illucia (192pts) (0 left)
						{
							// Agility
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Agility [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
				
							// Defense
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Defense [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
				
							// Deftness
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Deftness [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
				
							// Sorcery
							BaseChance1 = 0.1875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Sorcery [18.36%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
				
							// Strength
							BaseChance1 = 0.10416667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Strength [12.5%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.60%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.60%]
				
							// Therapeusis
							BaseChance1 = 0.21875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Therapeusis [21.4%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
						}
						if (CharacterClass == 2) // Flora (192pts) (0 left)
						{
							// Agility
							BaseChance1 = 0.192708333;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Agility [19.27%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
				
							// Defense
							BaseChance1 = 0.083333333;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= 0.083333333) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Defense [8.33%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= 0.016666667) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= 0.016666667) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
				
							// Deftness
							BaseChance1 = 0.171875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Deftness [17.2%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
				
							// Sorcery
							BaseChance1 = 0.234375;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Sorcery [23.4%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
				
							// Strength
							BaseChance1 = 0.119791667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Strength [11.9%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.6%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.6%]
				
							// Therapeusis
							BaseChance1 = 0.197916667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Therapeusis [19.79%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
						}
		
						if (CharacterClass == 8) // Ailish (192pts) (0 left)
						{
							// Agility
							BaseChance1 = 0.1875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Agility [18.75%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
				
							// Defense
							BaseChance1 = 0.067708333;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Defense [6.77%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
				
							// Deftness
							BaseChance1 = 0.1875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Deftness [18.75%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
				
							// Sorcery
							BaseChance1 = 0.239583333;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Sorcery [23.95%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
				
							// Strength
							BaseChance1 = 0.104166667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Strength [10.4%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.08%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.08%]
				
							// Therapeusis
							BaseChance1 = 0.213541667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Therapeusis [21.35%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
						}
						if (CharacterClass == 9) // Petra (192pts) (0 left)
						{
							// Agility
							BaseChance1 = 0.15625;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Agility [15.625%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",31,LvlSkillMulti,1); // Extra Agility
				
							// Defense
							BaseChance1 = 0.21875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Defense [21.4%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",32,LvlSkillMulti,1); // Extra Defense
				
							// Deftness
							BaseChance1 = 0.171875;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Deftness [17.2%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",33,LvlSkillMulti,1); // Extra Deftness
				
							// Sorcery
							BaseChance1 = 0.177083333;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Sorcery [18.36%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",34,LvlSkillMulti,1); // Extra Sorcery
				
							// Strength
							BaseChance1 = 0.119791667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Strength
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.6%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",35,LvlSkillMulti,1); // Extra Strength [2.6%]
				
							// Therapeusis
							BaseChance1 = 0.197916667;
							BaseChance2 = 0.083333334;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Therapeusis [21.4%]
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
							BaseChance1 *= 0.2;
							BaseChance2 *= 0.825;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance2);
							if (RollValue <= BaseChance2) { LvlSkillMulti = 2; } else { LvlSkillMulti = 1; } LvlSkillMulti *= LvlStatMulti;
							RollValue = frandom[statitem2](0.00000001,RandomizedStatChance);
							if (RollValue <= BaseChance1) CallACS("MiscVarSetDECORATE",36,LvlSkillMulti,1); // Extra Therapeusis
						}
					
						if (PlayerAGL > 512) CallACS("MiscVarSetDECORATE",31,512);
						if (PlayerDEF > 512) CallACS("MiscVarSetDECORATE",32,512);
						if (PlayerDFT > 512) CallACS("MiscVarSetDECORATE",33,512);
						if (PlayerSOR > 512) CallACS("MiscVarSetDECORATE",34,512);
						if (PlayerSTR > 512) CallACS("MiscVarSetDECORATE",35,512);
						if (PlayerTHE > 512) CallACS("MiscVarSetDECORATE",36,512);
						PlayerAGL = CallACS("MiscVarCheckDECORATE",31);
						PlayerDEF = CallACS("MiscVarCheckDECORATE",32);
						PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
						PlayerSOR = CallACS("MiscVarCheckDECORATE",34);
						PlayerSTR = CallACS("MiscVarCheckDECORATE",35);
						PlayerTHE = CallACS("MiscVarCheckDECORATE",36);
			
						CallACS("MiscVarSetDECORATE",204,PlayerAeonPts,2); // total Aeon Points gained
						CallACS("MiscVarSetDECORATE",205,PlayerAGL,2); // total Agility Points gained
						CallACS("MiscVarSetDECORATE",206,PlayerDEF,2); // total Defense Points gained
						CallACS("MiscVarSetDECORATE",207,PlayerDFT,2); // total Deftness Points gained
						CallACS("MiscVarSetDECORATE",208,PlayerSOR,2); // total Sorcery Points gained
						CallACS("MiscVarSetDECORATE",209,PlayerSTR,2); // total Strength Points gained
						CallACS("MiscVarSetDECORATE",210,PlayerTHE,2); // total Therapeusis Points gained
						if (dvdsdebug_levelupdisplays)
						{
							Console.Printf("2 - \cfAeon: %d\c-, \cnAgl: %d\c-, \cpDef: %d\c-, \cdDft: %d\c-, \ctSor: %d\c-, \cgStr: %d\c-, \ccThe: %d\c-", 
															CallACS("MiscVarCheckDECORATE",204), CallACS("MiscVarCheckDECORATE",205),
															CallACS("MiscVarCheckDECORATE",206), CallACS("MiscVarCheckDECORATE",207),
															CallACS("MiscVarCheckDECORATE",208), CallACS("MiscVarCheckDECORATE",209),
															CallACS("MiscVarCheckDECORATE",210));
						}
						CallACS("MiscVarSetDECORATE",204,-1,3); // total Aeon Points gained
						CallACS("MiscVarSetDECORATE",205,-1,3);
						CallACS("MiscVarSetDECORATE",206,-1,3);
						CallACS("MiscVarSetDECORATE",207,-1,3);
						CallACS("MiscVarSetDECORATE",208,-1,3);
						CallACS("MiscVarSetDECORATE",209,-1,3);
						CallACS("MiscVarSetDECORATE",210,-1,3);
						
						if (dvdsdebug_levelupdisplays)
						{
							Console.Printf("3 - \cfAeon: %d\c-, \cnAgl: %d\c-, \cpDef: %d\c-, \cdDft: %d\c-, \ctSor: %d\c-, \cgStr: %d\c-, \ccThe: %d\c-", 
															CallACS("MiscVarCheckDECORATE",204), CallACS("MiscVarCheckDECORATE",205),
															CallACS("MiscVarCheckDECORATE",206), CallACS("MiscVarCheckDECORATE",207),
															CallACS("MiscVarCheckDECORATE",208), CallACS("MiscVarCheckDECORATE",209),
															CallACS("MiscVarCheckDECORATE",210));
						}
						
						//***************
						//*Mana Increase*
						//***************
						int CurrentMana = CallACS("StatCheck",14);
						int MaxMana = CallACS("StatCheck",2);
						int LevelAddMaxMana = 0;
						int MPMaxGain;
						if (TrueGameSkill <= SKILL_VERY_EASY)
						{
							LevelAddMaxMana = random[statitem](5,10);
							MPMaxGain = MaxMana / 96;
						}
						else if (TrueGameSkill == SKILL_EASY)
						{
							LevelAddMaxMana = random[statitem](4,8);
							MPMaxGain = MaxMana / 120;
						}
						else if (TrueGameSkill == SKILL_NORMAL)
						{
							LevelAddMaxMana = random[statitem](3,6);
							MPMaxGain = MaxMana / 144;
						}
						else if (TrueGameSkill == SKILL_HARD)
						{
							LevelAddMaxMana = random[statitem](2,4);
							MPMaxGain = MaxMana / 168;
						}
						else if (TrueGameSkill == SKILL_VERY_HARD)
						{
							LevelAddMaxMana = random[statitem](1,2);
							MPMaxGain = MaxMana / 192;
						}
						else if (TrueGameSkill == SKILL_EXTREME)
						{
							LevelAddMaxMana = random[statitem](1,2);
							MPMaxGain = MaxMana / 204;
						}
						else if (TrueGameSkill == SKILL_HORRIBLE)
						{
							LevelAddMaxMana = random[statitem](1,2);
							MPMaxGain = MaxMana / 216;
						}
						else if (TrueGameSkill == SKILL_IMPOSSIBLE)
						{
							LevelAddMaxMana = 1;
							MPMaxGain = MaxMana / 228;
						}
						else if (TrueGameSkill >= SKILL_OMEGA)
						{
							LevelAddMaxMana = 1;
							MPMaxGain = MaxMana / 240;
						}
			
						PerkFactor = ((MagiUpPerkLevel * 500) + (MagiUpEXPerkLevel * 1250)) + 10000;
						MPMaxGain = MPMaxGain * PerkFactor / 10000; // "MagiUp" and "MagiUp EX" perks.
			
						PerkFactor = (StrifeStamLvl * 1250) + 10000;
						MPMaxGain = MPMaxGain * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"
			
						PerkFactor = ((MagiUpPerkLevel * 0.5) + (MagiUpEXPerkLevel));
						PerkFactor += (StrifeStamLvl * 0.375);
						MPMaxGain = clamp(MPMaxGain, PerkFactor, MPMaxGain);
						LevelAddMaxMana += MPMaxGain;
			
						MPMaxGain = random[statitem](6,9); // +7-19 + Level base
						PerkFactor = ((MagiUpPerkLevel * 500) + (MagiUpEXPerkLevel * 1250)) + 10000;
						MPMaxGain = MPMaxGain * PerkFactor / 10000; // "MagiUp" and "MagiUp EX" perks.
			
						PerkFactor = (StrifeStamLvl * 1250) + 10000;
						MPMaxGain = MPMaxGain * PerkFactor / 10000; // [STRIFE-Compatibility] Times "Stamina Upgraded"
			
						LevelAddMaxMana += MPMaxGain;
		
						int DftTheMulti;
						if (CharacterClass == 0) DftTheMulti = random[statitem](36,42); // Deggaris [MP Gain / Level] [75%-87.5%]
						if (CharacterClass == 1) DftTheMulti = random[statitem](54,60); // Illucia [MP Gain / Level] [112.5%-125%]
						if (CharacterClass == 2) DftTheMulti = random[statitem](66,84); // Flora [MP Gain / Level] [137.5%-175%]
						if (CharacterClass == 8) DftTheMulti = random[statitem](60,78); // Ailish [MP Gain / Level]
						if (CharacterClass == 9) DftTheMulti = random[statitem](49,55); // Petra [MP Gain / Level]
			
						DftTheMulti += ((PlayerTHE + PlayerDFT) / 48); // Add [(Therapesius+Deftness / 48)]
						LevelAddMaxMana = LevelAddMaxMana * DftTheMulti / 48;
			
						// Overall Modifier
						LevelAddMaxMana = floor(LevelAddMaxMana * 0.75);
			
						if (LevelAddMaxMana < 1) LevelAddMaxMana = 1;
						if (LevelAddMaxMana <= 1)
						{
							if (CharacterClass == 0 && random[statitem](1,100) <= 10) LevelAddMaxMana += 1;
							if (CharacterClass == 1 && random[statitem](1,100) <= 20) LevelAddMaxMana += 1;
							if (CharacterClass == 2 && random[statitem](1,100) <= 35) LevelAddMaxMana += 1;
							if (CharacterClass == 8 && random[statitem](1,100) <= 35) LevelAddMaxMana += 1;
							if (CharacterClass == 9 && random[statitem](1,100) <= 10) LevelAddMaxMana += 1;
						}
						else
						{
							if (CharacterClass == 0 && random[statitem](1,1000) <= 10) LevelAddMaxMana += 1;
							if (CharacterClass == 1 && random[statitem](1,1000) <= 20) LevelAddMaxMana += 1;
							if (CharacterClass == 2 && random[statitem](1,1000) <= 35) LevelAddMaxMana += 1;
							if (CharacterClass == 8 && random[statitem](1,1000) <= 35) LevelAddMaxMana += 1;
							if (CharacterClass == 9 && random[statitem](1,1000) <= 10) LevelAddMaxMana += 1;
						}
		
						LevelAddMaxMana *= LvlStatMulti;
						MaxMana += LevelAddMaxMana;
						CurrentMana += LevelAddMaxMana;
						CallACS("OtherVarSetDECORATE",1,MaxMana); // Sets MaxMana in ACS
						MaxMana = CallACS("StatCheck",2); // Refresh Var for MaxMP Value
						CallACS("OtherVarSetDECORATE",2,CurrentMana); // Sets CurrentMana in ACS
						CurrentMana = CallACS("StatCheck",14); // Refreshs Current MP amount
						CallACS("MiscVarSetDECORATE",243,CurrentMana); // Sets "LastManaValue" in ACS
						CallACS("MiscVarSetDECORATE",238,CurrentMana); // Sets "NewManaValue" in ACS
						
						
						//*************
						//*HP Increase*
						//*************
						int CurrentHealth = owner.health;
						int LevelAddMaxHP = 0;
						int HPMaxGain;
						int HPRandomizer1;
						if (TrueGameSkill <= SKILL_VERY_EASY)
						{
							LevelAddMaxHP = random[statitem](2,4);
							HPMaxGain = MaxHealthTrue / 288;
						}
						if (TrueGameSkill == SKILL_EASY)
						{
							LevelAddMaxHP = random[statitem](1,3);
							HPMaxGain = MaxHealthTrue / 360;
						}
							if (TrueGameSkill == SKILL_NORMAL)
						{
							LevelAddMaxHP = random[statitem](0,2);
							HPMaxGain = MaxHealthTrue / 432;
						}
						if (TrueGameSkill == SKILL_HARD)
						{
							LevelAddMaxHP = random[statitem](-1,1);
							HPMaxGain = MaxHealthTrue / 504;
						}
						if (TrueGameSkill == SKILL_VERY_HARD)
						{
							LevelAddMaxHP = random[statitem](-2,0);
							HPMaxGain = MaxHealthTrue / 576;
						}
						if (TrueGameSkill == SKILL_EXTREME)
						{
							LevelAddMaxHP = random[statitem](-2,0);
							HPMaxGain = MaxHealthTrue / 648;
						}
						if (TrueGameSkill == SKILL_HORRIBLE)
						{
							LevelAddMaxHP = random[statitem](-3,-1);
							HPMaxGain = MaxHealthTrue / 720;
						}
						if (TrueGameSkill == SKILL_IMPOSSIBLE)
						{
							LevelAddMaxHP = random[statitem](-3,-1);
							HPMaxGain = MaxHealthTrue / 792;
						}
						if (TrueGameSkill >= SKILL_OMEGA)
						{
							LevelAddMaxHP = random[statitem](-4,-2);
							HPMaxGain = MaxHealthTrue / 864;
						}
			
						HPMaxGain += randompick[statitem](1,1,1,1,2,2,2,2,3,3);
						if (CharacterClass == 0) HPMaxGain += randompick[statitem](3,3,4,4,5); // + 6-12+ HP
						if (CharacterClass == 1) HPMaxGain += randompick[statitem](1,2,2,2,3); // + 5-10+ HP
						if (CharacterClass == 2) HPMaxGain += randompick[statitem](1,1,1,2,2); // + 4-9+ HP
						if (CharacterClass == 8) HPMaxGain += randompick[statitem](1,1,1,2,2); // + 3-8+ HP
						if (CharacterClass == 9) HPMaxGain += randompick[statitem](3,3,4,4,5); // + 6-12+ HP
			
						PerkFactor = 1.00 + ((LifeUpPerkLvl * 0.05) + (LifeUpExPerkLvl * 0.125));
						HPMaxGain *= PerkFactor; // "LifeUp" and "LifeUp EX" perks.
			
						PerkFactor = 1.00 + (StrifeStamLvl * 0.125);
						HPMaxGain *= PerkFactor; // [STRIFE-Compatibility] Times "Stamina Upgraded
			
						PerkFactor = (((LifeUpPerkLvl * 0.5) + (LifeUpExPerkLvl)) + (StrifeStamLvl * 0.375));
						if (HPMaxGain < PerkFactor) HPMaxGain = PerkFactor;
						LevelAddMaxHP += HPMaxGain;
		
						if (TrueGameSkill <= SKILL_VERY_EASY)					LvlSkillMulti = floor(PlayerLevel * 0.35);	// 35%
						else if (TrueGameSkill == SKILL_EASY)					LvlSkillMulti = floor(PlayerLevel * 0.30);	// 30%
						else if (TrueGameSkill == SKILL_NORMAL)				LvlSkillMulti = floor(PlayerLevel * 0.25);	// 25%
						else if (TrueGameSkill == SKILL_HARD)					LvlSkillMulti = floor(PlayerLevel * 0.20);	// 20%
						else if (TrueGameSkill == SKILL_VERY_HARD)		LvlSkillMulti = floor(PlayerLevel * 0.15);	// 15%
						else if (TrueGameSkill == SKILL_EXTREME)			LvlSkillMulti = floor(PlayerLevel * 0.15);	// 15%
						else if (TrueGameSkill == SKILL_HORRIBLE)			LvlSkillMulti = floor(PlayerLevel * 0.10);	// 10%
						else if (TrueGameSkill == SKILL_IMPOSSIBLE)		LvlSkillMulti = floor(PlayerLevel * 0.10);	// 10%
						else if (TrueGameSkill >= SKILL_OMEGA)				LvlSkillMulti = floor(PlayerLevel * 0.05);	// 5%
				
						if (PlayerLevel > 24 && PlayerLevel < 50)			LvlSkillMulti = floor(LvlSkillMulti * 1.04); 		// *104%
						if (PlayerLevel > 49 && PlayerLevel < 75)			LvlSkillMulti = floor(LvlSkillMulti * 1.08); 		// *108%
						if (PlayerLevel > 74 && PlayerLevel < 100)		LvlSkillMulti = floor(LvlSkillMulti * 1.12); 		// *112%
						if (PlayerLevel > 99 && PlayerLevel < 125)		LvlSkillMulti = floor(LvlSkillMulti * 1.17); 		// *117%
						if (PlayerLevel > 124 && PlayerLevel < 150)		LvlSkillMulti = floor(LvlSkillMulti * 1.22); 		// *122%
						if (PlayerLevel > 149 && PlayerLevel < 175)		LvlSkillMulti = floor(LvlSkillMulti * 1.28); 		// *128%
						if (PlayerLevel > 174)												LvlSkillMulti = floor(LvlSkillMulti * 1.34); 		// *134%
			
						PerkFactor = 1.00 + ((LifeUpPerkLvl * 0.05) + (LifeUpExPerkLvl * 0.125));
						LvlSkillMulti *= PerkFactor; // "LifeUp" and "LifeUp EX" perks.
			
						PerkFactor = 1.00 + (StrifeStamLvl * 0.125);
						LvlSkillMulti *= PerkFactor; // [STRIFE-Compatibility] Times "Stamina Upgraded
			
						LevelAddMaxHP += LvlSkillMulti;
			
						int DefTheMulti;
						if (CharacterClass == 0) DefTheMulti = random[statitem](54,60); // Deggaris [HP Gain / Level] [112.5%-125%]
						if (CharacterClass == 1) DefTheMulti = random[statitem](36,42); // Illucia [HP Gain / Level] [75%-87.5%]
						if (CharacterClass == 2) DefTheMulti = random[statitem](27,33); // Flora [HP Gain / Level] [56.25%-68.75%]
						if (CharacterClass == 8) DefTheMulti = random[statitem](24,30); // Ailish [HP Gain / Level] [50.0%-62.5%]
						if (CharacterClass == 9) DefTheMulti = random[statitem](54,60); // Petra [HP Gain / Level] [112.5%-125%]. Same as Deggaris.
			
						DefTheMulti += ((PlayerDEF + PlayerDFT) / 48); // Add [(Defense+Deftness / 48)]
						LevelAddMaxHP = LevelAddMaxHP * DefTheMulti / 48;
			
						// Overall Modifier
						LevelAddMaxHP = floor(LevelAddMaxHP * 0.75); // *75%+
			
						// Give The HP to the player
						if (LevelAddMaxHP < 1) LevelAddMaxHP = 1;
						if (LevelAddMaxHP <= 1)
						{
							if (CharacterClass == 0 && random[statitem](1,100) <= 35) LevelAddMaxHP += 1;
							if (CharacterClass == 1 && random[statitem](1,100) <= 20) LevelAddMaxHP += 1;
							if (CharacterClass == 2 && random[statitem](1,100) <= 10) LevelAddMaxHP += 1;
							if (CharacterClass == 8 && random[statitem](1,100) <= 10) LevelAddMaxHP += 1;
							if (CharacterClass == 9 && random[statitem](1,100) <= 35) LevelAddMaxHP += 1;
						}
						else
						{
							if (CharacterClass == 0 && random[statitem](1,1000) <= 35) LevelAddMaxHP += 1;
							if (CharacterClass == 1 && random[statitem](1,1000) <= 20) LevelAddMaxHP += 1;
							if (CharacterClass == 2 && random[statitem](1,1000) <= 10) LevelAddMaxHP += 1;
							if (CharacterClass == 8 && random[statitem](1,1000) <= 10) LevelAddMaxHP += 1;
							if (CharacterClass == 9 && random[statitem](1,1000) <= 35) LevelAddMaxHP += 1;
						}
		
						LevelAddMaxHP *= LvlStatMulti;
						CurrentHealth += LevelAddMaxHP;
						owner.player.health = owner.player.mo.health = CurrentHealth;
						MaxHealthTrue += LevelAddMaxHP;
						CallACS("OtherVarSetDECORATE",0,MaxHealthTrue);
						MaxHealthTrue = CallACS("StatCheck",1); // Refresh Var Check for MaxHP
						CallACS("MiscVarSetDECORATE",241,PlayerCurrentHealth);
						CallACS("MiscVarSetDECORATE",175,PlayerCurrentHealth);
						
						if (leveluptimes == 0)
						{
							string lvlcharsnd = "misc/spawn";
							if (CharacterClass == 0) lvlcharsnd = "DeggarisLeveledUp"; // Deggaris
							if (CharacterClass == 1) lvlcharsnd = "IlluciaLeveledUp"; // Illucia
							if (CharacterClass == 2) lvlcharsnd = "FloraLeveledUp"; // Flora
							if (CharacterClass == 8) lvlcharsnd = "AilishLeveledUp"; //Ailish
							if (CharacterClass == 9) lvlcharsnd = "PetraLeveledUp"; //Petra
							owner.A_StartSound(lvlcharsnd,CHAN_6,CHANF_DEFAULT,1.25,ATTN_NONE); 
							LevelupSpeechTimer1 = 1;
						}
						
						// [222] # of TOTAL Max HP gained during multiple stat ups [for displays]
						// [223] # of TOTAL Max MP gained during multiple stat ups [for displays]
						// [224] # of TOTAL Aeon Points gained during multiple stat ups [for displays]
						// [225] # of TOTAL Agility Points gained during multiple stat ups [for displays]
						// [226] # of TOTAL Defense Points gained during multiple stat ups [for displays]
						// [227] # of TOTAL Deftness Points gained during multiple stat ups [for displays]
						// [228] # of TOTAL Sorcery Points gained during multiple stat ups [for displays]
						// [229] # of TOTAL Strength Points gained during multiple stat ups [for displays]
						// [230] # of TOTAL Therapeusis Points gained during multiple stat ups [for displays]
						CallACS("MiscVarSetDECORATE",222,LevelAddMaxHP,1);
						CallACS("MiscVarSetDECORATE",223,LevelAddMaxMana,1);
						CallACS("MiscVarSetDECORATE",224,CallACS("MiscVarCheckDECORATE",204),1);
						CallACS("MiscVarSetDECORATE",225,CallACS("MiscVarCheckDECORATE",205),1);
						CallACS("MiscVarSetDECORATE",226,CallACS("MiscVarCheckDECORATE",206),1);
						CallACS("MiscVarSetDECORATE",227,CallACS("MiscVarCheckDECORATE",207),1);
						CallACS("MiscVarSetDECORATE",228,CallACS("MiscVarCheckDECORATE",208),1);
						CallACS("MiscVarSetDECORATE",229,CallACS("MiscVarCheckDECORATE",209),1);
						CallACS("MiscVarSetDECORATE",230,CallACS("MiscVarCheckDECORATE",210),1);
						if (CallACS("MiscVarCheckDECORATE",222) > 0) CallACS("MiscVarSetDECORATE",2031,105);
						if (CallACS("MiscVarCheckDECORATE",223) > 0) CallACS("MiscVarSetDECORATE",2032,105);
						if (CallACS("MiscVarCheckDECORATE",224) > 0) CallACS("MiscVarSetDECORATE",2033,105);
						if (CallACS("MiscVarCheckDECORATE",225) > 0) CallACS("MiscVarSetDECORATE",2034,105);
						if (CallACS("MiscVarCheckDECORATE",226) > 0) CallACS("MiscVarSetDECORATE",2035,105);
						if (CallACS("MiscVarCheckDECORATE",227) > 0) CallACS("MiscVarSetDECORATE",2036,105);
						if (CallACS("MiscVarCheckDECORATE",228) > 0) CallACS("MiscVarSetDECORATE",2037,105);
						if (CallACS("MiscVarCheckDECORATE",229) > 0) CallACS("MiscVarSetDECORATE",2038,105);
						if (CallACS("MiscVarCheckDECORATE",230) > 0) CallACS("MiscVarSetDECORATE",2039,105);
						
						string LearnedSpells = "";
						if (PlayerLevel <= 32) LearnedSpells = "\c[Green]New Spells Have Been Learned!\cf\n\n";
						if (CharacterClass == 2 && PlayerLevel == 56) LearnedSpells = "\c[Green]New Spells Have Been Learned!\cf\n\n";
			
						string AeonPtUse = "";
						if (PlayerLevel >= CallACS("MiscVarCheckDECORATE",197)) AeonPtUse = "\c[White]Remember to allocate any Aeon Points you've attained!\cf\n\n";
			
						string SpinAttack = "";
						if (CharacterClass == 2 && PlayerLevel == 8) SpinAttack = "\caThe Sceptre Will Now Have an Alternate\n\caAttack if Sceptre Level is above 2!\cf";
						
						owner.A_Print(String.Format("\c[Green]Congradulations, you've reached Level %d\n\n\c[Brick]HP \c[Gold]+%d\n\c[Purple]Mana \c[Gold]+%d\n\c[White]AeonPts: \c[Gold]+%d\n\c[LightBlue]Agility: \c[Gold]+%d\n\c[Olive]Defense: \c[Gold]+%d\n\c[Green]Deftness: \c[Gold]+%d\n\c[Purple]Sorcery: \c[Gold]+%d\n\c[Red]Strength: \c[Gold]+%d\n\c[Gray]Therapeusis: \c[Gold]+%d\n\n%s%s%s", PlayerLevel, LevelAddMaxHP, LevelAddMaxMana,
												 CallACS("MiscVarChecKDECORATE",204), CallACS("MiscVarChecKDECORATE",205),
												 CallACS("MiscVarChecKDECORATE",206), CallACS("MiscVarChecKDECORATE",207),
												 CallACS("MiscVarChecKDECORATE",208), CallACS("MiscVarChecKDECORATE",209),
												 CallACS("MiscVarChecKDECORATE",210), LearnedSpells, AeonPtUse, SpinAttack), 2.25, "SMALLFONT");
						owner.A_SetBlend("00 00 FF",0.3,3,"00 00 FF",0.0);
					}
				}
			}
			
			// Delays the levelup speech for a character
			if (LevelupSpeechTimer1 > 0)
			{
				LevelupSpeechTimer2++;
				if (dvdsdebug_levelupdisplays) Console.Printf("Level Up dialogue Timer: %d / 105", LevelupSpeechTimer2);
				if (LevelupSpeechTimer2 >= 105)
				{
					if (random[statitem](1,100) <= dvds_levelspeechchance && PlayerCurrentHealth > 0)
					{
						if (CharacterClass == 2) 
						{
							owner.A_StartSound("FloraLevelSpeech",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM);
						}
					}
					LevelupSpeechTimer1 = 0;
					LevelupSpeechTimer2 = 0;
				}
			}
		}
	}

	void A_PSI1DoEffectLandDamage()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		if (playeractor && weapon is "SceptreOfEmpyrea")
		{
			landdmgbonus = 0;
			if (FlightTimer < 1) // && ((buttons & BT_JUMP) && sv_allowjump)) // [not Flight]
			{
				if (owner.vel.z < -128.0)
				{
					landdmgbonus = 4;
					if (dvdsdebug_showplayeratkinformation) Console.Printf("    \ceLanding Damage [Lvl 4 - 13.9453125x Melee Dmg]: ZVel: %.8f", owner.vel.z);
				}
				else
				if (owner.vel.z < -32.0)
				{
					landdmgbonus = 3;
					if (dvdsdebug_showplayeratkinformation) Console.Printf("    \ceLanding Damage [Lvl 3 - 6.5625x Melee Dmg]: ZVel: %.8f", owner.vel.z);
				}
				else
				if (owner.vel.z < -8.0)
				{
					landdmgbonus = 2;
					if (dvdsdebug_showplayeratkinformation) Console.Printf("    \ceLanding Damage [Lvl 2 - 3.5x Melee Dmg]: ZVel: %.8f", owner.vel.z);
				}
				else
				if (owner.vel.z < -0.0625)
				{
					landdmgbonus = 1;
					if (dvdsdebug_showplayeratkinformation) Console.Printf("    \ceLanding Damage [Lvl 1 - 2x Melee Dmg]: ZVel: %.8f", owner.vel.z);
				}
			}

			double SceptreJumpDmgMulti;
			SceptreJumpDmgMulti = owner.vel.z / -0.1;
			SceptreJumpDmgMulti += 100;
			if (SceptreJumpDmgMulti < 100) SceptreJumpDmgMulti = 100;
			if (dvdsdebug_showplayeratkinformation && SceptreJumpDmgMulti != 100) Console.Printf("    \ceSceptre Landing Dmg Multiplier: ZVel: %.8f%", SceptreJumpDmgMulti);
		}
	}
	
	// Inventory/Ammo Limit Enforcement
	void A_PSI1DoEffectInvAmmoLimits()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		
		//*********************************************************************
		//***Determines Inventory Amounts Based on Strength Seeds and Level***
		//*********************************************************************
		int debuginventorylimits = dvdsdebug_inventorylimits;
		if (playeractor)
		{
			int dropamt;
			string itemname;
			// Gets the Number of Collected Backpacks which is the backbone of the system.
			int BackPacksCollected = CallACS("MiscVarCheckDECORATE",80);
			int backpackdivisor = TrueGameSkill + 6;
			int backpackmultiplier = backpackdivisor + BackPacksCollected;
			double baselimitmulti = dvds_inventorybaselimitratio;
			double itemcalcmulti = dvds_inventorylimitcalcratio;
			double itemlimitmulti = dvds_inventorylimittotalratio;
			double hexenmodemulti = dvds_inventoryhexenmultiratio;
			int baseholdamount;
			double leveladd;
			double stradd;
			int itemsmax;
			hexenmodemulti = clamp(hexenmodemulti, 1.0, hexenmodemulti);
			double perkmultiplier = 1.0 + ((StamUpPerkLvl * 0.025) + (StamUpEXPerkLvl * 0.0625)); // StamUp
			double perkmultiplier2 = 1.0 + (StrifeStamLvl * 0.05); // Strife's Stamina Upgrades
			double perkmultiplier3 = 1.0 + ((CallACS("MiscVarCheckDECORATE",10059) * 0.10) + (CallACS("MiscVarCheckDECORATE",10060) * 0.25)); // Pack Mule
			let currentitemtype = owner.FindInventory("MedicinalHerb");
			int itemid;

			if (dvds_imposeinventorylimits)
			{
				// Medicinal Herbs [5.33, 2.66~]
				itemid = 7001;
				currentitemtype = owner.FindInventory("MedicinalHerb");
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 3; 
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.1875);
					stradd = (PlayerSTR * 0.375);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Strong Medicinal Herbs [8, 4]
				currentitemtype = owner.FindInventory("StrongMedicine");
				itemid = 7002;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 2;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.125);
					stradd = (PlayerSTR * 0.25);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Special Medicinal Herbs [16, 8]
				currentitemtype = owner.FindInventory("SpecialMedicine");
				itemid = 7003;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Magic Waters [5.33~, 2.66~]
				currentitemtype = owner.FindInventory("MagicWater");
				itemid = 7004;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 3;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.1875);
					stradd = (PlayerSTR * 0.375);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Sage Elixirs [8, 4]
				currentitemtype = owner.FindInventory("SageElixir");
				itemid = 7005;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 2;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.125);
					stradd = (PlayerSTR * 0.25);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Elfin Elixirs [16, 8]
				itemid = 7006;
				currentitemtype = owner.FindInventory("ElfinElixir");
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Yggdrasil Dew [32, 16]
				currentitemtype = owner.FindInventory("YggdrasilDew");
				itemid = 7007;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.03125);
					stradd = (PlayerSTR * 0.0625);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Miracle Potion [64, 32]
				itemid = 7008;
				currentitemtype = owner.FindInventory("MiraclePotion");
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 2;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Rockbomb Shards [16, 8]
				currentitemtype = owner.FindInventory("RockBombShard");
				itemid = 7009;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 2;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Paxa Punch [32, 16]
				itemid = 7010;
				currentitemtype = owner.FindInventory("PaxaPunch");
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.03125);
					stradd = (PlayerSTR * 0.0625);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Mercury Bandana [32, 16]
				currentitemtype = owner.FindInventory("MercuryBandana");
				itemid = 7011;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.03125);
					stradd = (PlayerSTR * 0.0625);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Monster Munchies [16, 8]
				currentitemtype = owner.FindInventory("MonsterMunchies");
				itemid = 7012;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Lesser Vimstones [16, 8]
				currentitemtype = owner.FindInventory("LesserVimstone");
				itemid = 7013;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.0625);
					stradd = (PlayerSTR * 0.125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}

				// Greater Vimstones [64, 32]
				currentitemtype = owner.FindInventory("GreaterVimstone");
				itemid = 7014;
				if (currentitemtype)
				{
					itemname = currentitemtype.GetClassName();
					baseholdamount = 1;
					baseholdamount *= baselimitmulti;
					if (baseholdamount < 1) baseholdamount = 1;
					leveladd = (PlayerLevel * 0.015625);
					stradd = (PlayerSTR * 0.03125);
					if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
					itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
					currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
					if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
					if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
					CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
					if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
				}


				if (ClassicDoomType == 2) // Heretic
				{
					// Quartz Flasks
					pm = "ArtiHealthNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7101;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 3;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.1875);
						stradd = (PlayerSTR * 0.375);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Mystic Urn [32, 16]
					pm = "ArtiSuperHealthNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7102;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}


					// Chaos Devices [16, 8]
					pm = "ArtiTeleportNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7103;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Morph Ovum [32, 16]
					pm = "ArtiEggNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7104;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Shadow Sphere [32, 16]
					pm = "ArtiInvisibilityNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7105;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Ring of Invulnerability [64, 32]
					pm = "ArtiInvulnerabilityNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7106;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.015625);
						stradd = (PlayerSTR * 0.03125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}
				}
				if (ClassicDoomType == 3) // Hexen
				{
					// Quartz Flasks
					pm = "ArtiHealthNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7201;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 3;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.1875);
						stradd = (PlayerSTR * 0.375);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Mystic Ambit Incant [16, 8]
					pm = "ArtiHealingRadiusNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7202;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Mystic Urn [32, 16]
					pm = "ArtiSuperHealthNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7203;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Krater of Might [32, 16]
					pm = "ArtiBoostManaNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7204;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Chaos Devices [16, 8]
					pm = "ArtiTeleportNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7205;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Banishment Devices [16, 8]
					pm = "ArtiTeleportOtherNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7206;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Dark Servant [32, 16]
					pm = "ArtiDarkServantNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7207;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Porkulator [32, 16]
					pm = "ArtiPorkNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7208;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Icon of The Defender [64, 32]
					pm = "ArtiInvulnerability2New"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7209;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.015625);
						stradd = (PlayerSTR * 0.03125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}
				}
				if (ClassicDoomType == 4) // Strife
				{
					// Med Patches
					pm = "MedPatchNew"; iDTech1Check = pm;
					itemid = 7301;
					currentitemtype = owner.FindInventory(iDTech1Check);
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 4;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.3125);
						stradd = (PlayerSTR * 0.625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Medicial Kits
					pm = "MedicalKitNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7302;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 3;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.1875);
						stradd = (PlayerSTR * 0.375);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Surgery Kits [32, 16]
					pm = "SurgeryKitNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7303;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Scanner [16, 8]
					pm = "ScannerNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7304;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Targetter [16, 8]
					pm = "TargeterNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7305;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Environmental Suit [16, 8]
					pm = "EnvironmentalSuitNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7306;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 3;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Shadow Armor [32, 16]
					pm = "ShadowArmorNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7307;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.03125);
						stradd = (PlayerSTR * 0.0625);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// Teleporter Beacon [16, 8]
					pm = "TeleporterBeaconNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7308;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 1;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.0625);
						stradd = (PlayerSTR * 0.125);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}

					// 4 Degnin Ore [4, 2]
					pm = "DegninOreNew"; iDTech1Check = pm;
					currentitemtype = owner.FindInventory(iDTech1Check);
					itemid = 7309;
					if (currentitemtype)
					{
						itemname = currentitemtype.GetClassName();
						baseholdamount = 4;
						baseholdamount *= baselimitmulti;
						if (baseholdamount < 1) baseholdamount = 1;
						leveladd = (PlayerLevel * 0.25);
						stradd = (PlayerSTR * 0.5);
						if (ClassicDoomType == 3) { leveladd *= hexenmodemulti; stradd *= hexenmodemulti; }
						itemsmax = (leveladd + stradd) * itemcalcmulti; itemsmax += baseholdamount;
						currentitemtype.MaxAmount = (((((((itemsmax * backpackmultiplier) / backpackdivisor) * itemlimitmulti)) * perkmultiplier) * perkmultiplier2) * perkmultiplier3);
						if (dvds_inventorylowcap && currentitemtype.MaxAmount < 1) currentitemtype.MaxAmount = 1;
						if (currentitemtype.Amount > currentitemtype.MaxAmount) { dropamt = currentitemtype.MaxAmount - currentitemtype.Amount; owner.A_DropInventory(itemname,dropamt); }
						CallACS("MiscVarSetDECORATE",itemid,currentitemtype.MaxAmount);
						if (debuginventorylimits) Console.Printf("\cy%s\c-: %d / %d, Backpacks: %d (%d), BaseAmt: %d, LevelAdd: %.8f, StrAdd: %.8f, ItemMulti: %.8f, PerkMulti: %.8f, PerkMulti2: %.8f, PerkMulti3: %.8f, \cxbaselimitmulti: %.8f, itemcalcmulti: %.8f, itemlimitmulti: %.8f", itemname, currentitemtype.Amount, currentitemtype.MaxAmount, BackPacksCollected, backpackdivisor, baseholdamount, leveladd, stradd, itemlimitmulti, perkmultiplier, perkmultiplier2, perkmultiplier3, baselimitmulti, itemcalcmulti, itemlimitmulti);
					}
				}
			}
			else
			{
				if (owner) 
				{
					int maxamountdefault = 9999;
					if (owner.FindInventory("MedicinalHerb")) owner.FindInventory("MedicinalHerb").MaxAmount = maxamountdefault;
					if (owner.FindInventory("StrongMedicine")) owner.FindInventory("StrongMedicine").MaxAmount = maxamountdefault;
					if (owner.FindInventory("SpecialMedicine")) owner.FindInventory("SpecialMedicine").MaxAmount = maxamountdefault;
					if (owner.FindInventory("MagicWater")) owner.FindInventory("MagicWater").MaxAmount = maxamountdefault;
					if (owner.FindInventory("SageElixir")) owner.FindInventory("SageElixir").MaxAmount = maxamountdefault;
					if (owner.FindInventory("ElfinElixir")) owner.FindInventory("ElfinElixir").MaxAmount = maxamountdefault;
					if (owner.FindInventory("MiraclePotion")) owner.FindInventory("MiraclePotion").MaxAmount = maxamountdefault;
					if (owner.FindInventory("YggdrasilDew")) owner.FindInventory("YggdrasilDew").MaxAmount = maxamountdefault;
					if (owner.FindInventory("RockbombShard")) owner.FindInventory("RockbombShard").MaxAmount = maxamountdefault;
					if (owner.FindInventory("PaxaPunch")) owner.FindInventory("PaxaPunch").MaxAmount = maxamountdefault;
					if (owner.FindInventory("MercuryBandana")) owner.FindInventory("MercuryBandana").MaxAmount = maxamountdefault;
					if (owner.FindInventory("MonsterMunchies")) owner.FindInventory("MonsterMunchies").MaxAmount = maxamountdefault;
					if (owner.FindInventory("LesserVimstone")) owner.FindInventory("LesserVimstone").MaxAmount = maxamountdefault;
					if (owner.FindInventory("GreaterVimstone")) owner.FindInventory("GreaterVimstone").MaxAmount = maxamountdefault;
					if (ClassicDoomType == 2) // Heretic
					{
						pm = "ArtiHealthNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiSuperHealthNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiTeleportNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiEggNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiInvisibilityNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiInvulnerabilityNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
					}
					if (ClassicDoomType == 3) // Hexen
					{
						pm = "ArtiHealthNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiHealingRadiusNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiSuperHealthNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiBoostManaNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiTeleportNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiTeleportOtherNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiDarkServantNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiPorkNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ArtiInvulnerability2New"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
					}
					if (ClassicDoomType == 4) // Strife
					{
						pm = "MedPatchNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "MedicalKitNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "SurgeryKitNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ScannerNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "TargeterNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "EnvironmentalSuitNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "ShadowArmorNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "TeleporterBeaconNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
						pm = "DegninOreNew"; iDTech1Check = pm; if (owner.FindInventory(iDTech1Check)) owner.FindInventory(iDTech1Check).MaxAmount = maxamountdefault;
					}
				}
			}
		}
		
		
		
		
		
		//***********************************************************************
		//***Determines Maximum Ammo Amounts Based on Strength Seeds and Level***
		//***********************************************************************
		if (playeractor)
		{
			double perkmultiplier = 1.0 + ((StamUpPerkLvl * 0.025) + (StamUpEXPerkLvl * 0.0625));
			double perkmultiplier2 = 1.0 + (StrifeStamLvl * 0.05);
			double perkmultiplier3 = 1.0 + ((CallACS("MiscVarCheckDECORATE",10059) * 0.10) + (CallACS("MiscVarCheckDECORATE",10060) * 0.25));

			// Default Ammo Types
			int DiarisArrowMax, DiarisArrowUltimateMax;
			int PoisonNeedleMax, PoisonNeedleUltimateMax;
			// Doom Ammo Types
			int ClipMax, ClipUltimateMax;
			int ShellMax, ShellUltimateMax;
			int RocketMax, RocketUltimateMax;
			int CellMax, CellUltimateMax;
			// Heretic Ammo Types
			int GoldWandAmmoMax, GoldWandAmmoUltimateMax;
			int CrossbowAmmoMax, CrossbowAmmoUltimateMax;
			int BlasterAmmoMax, BlasterAmmoUltimateMax;
			int PhoenixRodAmmoMax, PhoenixRodAmmoUltimateMax;
			int SkullRodAmmoMax, SkullRodAmmoUltimateMax;
			int MaceAmmoMax, MaceAmmoUltimateMax;
			// Hexen Ammo Types
			// Strife Ammo Types
			int ElectricBoltsMax, ElectricBoltsUltimateMax;
			int PoisonBoltsMax, PoisonBoltsUltimateMax;
			int ClipOfBulletsMax, ClipOfBulletsUltimateMax;
			int MiniMissilesMax, MiniMissilesUltimateMax;
			int EnergyPodMax, EnergyPodUltimateMax;
			int HEGrenadeRoundsMax, HEGrenadeRoundsUltimateMax;
			int PHGrenadeRoundsMax, PHGrenadeRoundsUltimateMax;
			// Misc Non-idTech1 ammo types
			int RifleAmmoMax, RifleAmmoUltimateMax; // KDIZD
			int PopcornPieceMax, PopcornPieceUltimateMax; // HTC2 [400]
			int GoreBalloonsMax, GoreBalloonsUltimateMax; // HTC2 [50]
			int CGrenadeAmmoMax, CGrenadeAmmoUltimateMax; // HTC2 [100]
			int ClownSoulsMax, ClownSoulsUltimateMax; // HTC2 [400]
			int CZBallMax, CZBallUltimateMax; // HTC2 [25]
			
			int BackPacksCollected = CallACS("MiscVarCheckDECORATE",80);

			// Get Ammo Values
			if (CharacterClass == 0) // Deggaris
			{
				// Default Ammo Types
				DiarisArrowUltimateMax = 0;
				PoisonNeedleUltimateMax = 0;
				DiarisArrowMax = 0;
				PoisonNeedleMax = 0;
				// Doom Types
				ClipUltimateMax = 500 * dvds_ammolimitsumaxbaseratio;
				ClipUltimateMax += ((PlayerSTR * 5) + (PlayerLevel * 2.5) * dvds_ammolimitsumaxaddratio);
				ClipUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ClipUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ShellUltimateMax = 140 * dvds_ammolimitsumaxbaseratio;
				ShellUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				ShellUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ShellUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				RocketUltimateMax = 120  * dvds_ammolimitsumaxbaseratio;
				RocketUltimateMax += ((PlayerSTR * 1) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				RocketUltimateMax *= dvds_ammolimitsumaxtotalratio;
				RocketUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CellUltimateMax = 750 * dvds_ammolimitsumaxbaseratio;
				CellUltimateMax += ((PlayerSTR * 20) + (PlayerLevel * 10) * dvds_ammolimitsumaxaddratio);
				CellUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CellUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				ClipMax = (250 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 100) * dvds_ammolimitsbackpackratio); 
				ClipMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ShellMax = (70 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 28) * dvds_ammolimitsbackpackratio);
				ShellMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				RocketMax = (60 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 24) * dvds_ammolimitsbackpackratio);
				RocketMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CellMax = (375 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 150) * dvds_ammolimitsbackpackratio);
				CellMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				// Misc Non-idTech1 ammo types
				RifleAmmoUltimateMax = 75 * dvds_ammolimitsumaxbaseratio;
				RifleAmmoUltimateMax += ((PlayerSTR * 2.5) + (PlayerLevel * 1.25) * dvds_ammolimitsumaxaddratio);
				RifleAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				RifleAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PopcornPieceUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				PopcornPieceUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				PopcornPieceUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PopcornPieceUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsUltimateMax = 50 * dvds_ammolimitsumaxbaseratio;
				GoreBalloonsUltimateMax += ((PlayerSTR * 1) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				GoreBalloonsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				GoreBalloonsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoUltimateMax = 100 * dvds_ammolimitsumaxbaseratio;
				CGrenadeAmmoUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				CGrenadeAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CGrenadeAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				ClownSoulsUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				ClownSoulsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ClownSoulsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallUltimateMax = 25 * dvds_ammolimitsumaxbaseratio;
				CZBallUltimateMax += ((PlayerSTR * 0.5) + (PlayerLevel * 0.25) * dvds_ammolimitsumaxaddratio);
				CZBallUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CZBallUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				RifleAmmoMax = (37 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 14.8) * dvds_ammolimitsbackpackratio);
				RifleAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PopcornPieceMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				PopcornPieceMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsMax = (50 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 20) * dvds_ammolimitsbackpackratio);
				GoreBalloonsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoMax = (100 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 40) * dvds_ammolimitsbackpackratio);
				CGrenadeAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				ClownSoulsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallMax = (25 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 10) * dvds_ammolimitsbackpackratio);
				CZBallMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
			}
			if (CharacterClass == 1) // Illucia
			{
				// Default Ammo Types
				DiarisArrowUltimateMax = 0;
				PoisonNeedleUltimateMax = 0;
				DiarisArrowMax = 0;
				PoisonNeedleMax = 0;
				// Doom Types
				ClipUltimateMax = 300 * dvds_ammolimitsumaxbaseratio;
				ClipUltimateMax += ((PlayerSTR * 3.75) + (PlayerLevel * 1.75) * dvds_ammolimitsumaxaddratio);
				ClipUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ClipUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ShellUltimateMax = 90 * dvds_ammolimitsumaxbaseratio;
				ShellUltimateMax += ((PlayerSTR * 1.5) + (PlayerLevel * 0.75) * dvds_ammolimitsumaxaddratio);
				ShellUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ShellUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				RocketUltimateMax = 70  * dvds_ammolimitsumaxbaseratio;
				RocketUltimateMax += ((PlayerSTR * 0.75) + (PlayerLevel * 0.375) * dvds_ammolimitsumaxaddratio);
				RocketUltimateMax *= dvds_ammolimitsumaxtotalratio;
				RocketUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CellUltimateMax = 500 * dvds_ammolimitsumaxbaseratio;
				CellUltimateMax += ((PlayerSTR * 15) + (PlayerLevel * 7.5) * dvds_ammolimitsumaxaddratio);
				CellUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CellUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				ClipMax = (175 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 70) * dvds_ammolimitsbackpackratio); 
				ClipMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ShellMax = (45 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 18) * dvds_ammolimitsbackpackratio);
				ShellMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				RocketMax = (35 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 14) * dvds_ammolimitsbackpackratio);
				RocketMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CellMax = (250 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 100) * dvds_ammolimitsbackpackratio);
				CellMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				// Misc Non-idTech1 ammo types
				RifleAmmoUltimateMax = 60 * dvds_ammolimitsumaxbaseratio;
				RifleAmmoUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				RifleAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				RifleAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PopcornPieceUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				PopcornPieceUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				PopcornPieceUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PopcornPieceUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsUltimateMax = 50 * dvds_ammolimitsumaxbaseratio;
				GoreBalloonsUltimateMax += ((PlayerSTR * 1) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				GoreBalloonsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				GoreBalloonsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoUltimateMax = 100 * dvds_ammolimitsumaxbaseratio;
				CGrenadeAmmoUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				CGrenadeAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CGrenadeAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				ClownSoulsUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				ClownSoulsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ClownSoulsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallUltimateMax = 25 * dvds_ammolimitsumaxbaseratio;
				CZBallUltimateMax += ((PlayerSTR * 0.5) + (PlayerLevel * 0.25) * dvds_ammolimitsumaxaddratio);
				CZBallUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CZBallUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				RifleAmmoMax = (30 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 12) * dvds_ammolimitsbackpackratio);
				RifleAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PopcornPieceMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				PopcornPieceMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsMax = (50 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 20) * dvds_ammolimitsbackpackratio);
				GoreBalloonsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoMax = (100 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 40) * dvds_ammolimitsbackpackratio);
				CGrenadeAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				ClownSoulsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallMax = (25 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 10) * dvds_ammolimitsbackpackratio);
				CZBallMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
			}
			if (CharacterClass == 2) // Flora
			{
				// Default Ammo Types
				DiarisArrowUltimateMax = 30 * dvds_ammolimitsumaxbaseratio;
				DiarisArrowUltimateMax += ((PlayerSTR * 3) + (PlayerLevel * 1.5) * dvds_ammolimitsumaxaddratio);
				DiarisArrowUltimateMax *= dvds_ammolimitsumaxtotalratio;
				DiarisArrowUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PoisonNeedleUltimateMax = 2 * dvds_ammolimitsumaxbaseratio;
				PoisonNeedleUltimateMax += ((PlayerSTR * 0.16667) + (PlayerLevel * 0.083334) * dvds_ammolimitsumaxaddratio);
				PoisonNeedleUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PoisonNeedleUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				DiarisArrowMax = (15 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 6) * dvds_ammolimitsbackpackratio);
				DiarisArrowMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PoisonNeedleMax = (1 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 0.5) * dvds_ammolimitsbackpackratio);
				PoisonNeedleMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				// Doom Types
				if (owner.CountInv("FloraLearnedPistols")) 
				{ 
					ClipUltimateMax = 200 * dvds_ammolimitsumaxbaseratio;
					ClipUltimateMax += ((PlayerSTR * 2.5) + (PlayerLevel * 1.25) * dvds_ammolimitsumaxaddratio);
					ClipUltimateMax *= dvds_ammolimitsumaxtotalratio;
					ClipUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
					ClipMax = (100 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 40) * dvds_ammolimitsbackpackratio); 
					ClipMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				} 
				else 
				{ 
					ClipUltimateMax = 0;
					ClipMax = 0; 
				}
				ShellUltimateMax = 0;
				ShellMax = 0;
				RocketUltimateMax = 0;
				RocketMax = 0;
				CellUltimateMax = 0;
				CellMax = 0;
				// Heretic Types
				GoldWandAmmoUltimateMax = 200 * dvds_ammolimitsumaxbaseratio; 
				GoldWandAmmoUltimateMax += ((PlayerSTR * 5) + (PlayerLevel * 2.5) * dvds_ammolimitsumaxaddratio);
				GoldWandAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				GoldWandAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CrossbowAmmoUltimateMax = 100 * dvds_ammolimitsumaxbaseratio;
				CrossbowAmmoUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				CrossbowAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CrossbowAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				BlasterAmmoUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				BlasterAmmoUltimateMax += ((PlayerSTR * 5) + (PlayerLevel * 2.5) * dvds_ammolimitsumaxaddratio);
				BlasterAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				BlasterAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PhoenixRodAmmoUltimateMax = 40 * dvds_ammolimitsumaxbaseratio;
				PhoenixRodAmmoUltimateMax += ((PlayerSTR * 1) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				PhoenixRodAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PhoenixRodAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				SkullRodAmmoUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				SkullRodAmmoUltimateMax += ((PlayerSTR * 10) + (PlayerLevel * 5) * dvds_ammolimitsumaxaddratio);
				SkullRodAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				SkullRodAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				MaceAmmoUltimateMax = 300 * dvds_ammolimitsumaxbaseratio;
				MaceAmmoUltimateMax += ((PlayerSTR * 10) + (PlayerLevel * 5) * dvds_ammolimitsumaxaddratio);
				MaceAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				MaceAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				GoldWandAmmoMax = (100 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 40) * dvds_ammolimitsbackpackratio);
				GoldWandAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CrossbowAmmoMax = (50 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 20) * dvds_ammolimitsbackpackratio);
				CrossbowAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				BlasterAmmoMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 50) * dvds_ammolimitsbackpackratio);
				BlasterAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PhoenixRodAmmoMax = (20 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 12) * dvds_ammolimitsbackpackratio);
				PhoenixRodAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				SkullRodAmmoMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 50) * dvds_ammolimitsbackpackratio);
				SkullRodAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				MaceAmmoMax = (150 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 37.5) * dvds_ammolimitsbackpackratio);
				MaceAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				// Strife Types
				ElectricBoltsUltimateMax = 100 * dvds_ammolimitsumaxbaseratio;
				ElectricBoltsUltimateMax += ((PlayerSTR * 10) + (PlayerLevel * 5) * dvds_ammolimitsumaxaddratio);
				ElectricBoltsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ElectricBoltsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PoisonBoltsUltimateMax = 50 * dvds_ammolimitsumaxbaseratio;
				PoisonBoltsUltimateMax += ((PlayerSTR * 5) + (PlayerLevel * 2.5) * dvds_ammolimitsumaxaddratio);
				PoisonBoltsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PoisonBoltsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				ClipOfBulletsUltimateMax = 0;
				MiniMissilesUltimateMax = 0;
				EnergyPodUltimateMax = 0;
				HEGrenadeRoundsUltimateMax = 0;
				PHGrenadeRoundsUltimateMax = 0;
				ElectricBoltsMax = (50 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 20) * dvds_ammolimitsbackpackratio);
				ElectricBoltsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				PoisonBoltsMax = (25 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 10) * dvds_ammolimitsbackpackratio);
				PoisonBoltsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClipOfBulletsMax = 0;
				MiniMissilesMax = 0;
				EnergyPodMax = 0;
				HEGrenadeRoundsMax = 0;
				PHGrenadeRoundsMax = 0;
				// Misc Non-idTech1 ammo types
				RifleAmmoUltimateMax = 0;
				PopcornPieceUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				PopcornPieceUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				PopcornPieceUltimateMax *= dvds_ammolimitsumaxtotalratio;
				PopcornPieceUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsUltimateMax = 50 * dvds_ammolimitsumaxbaseratio;
				GoreBalloonsUltimateMax += ((PlayerSTR * 1) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				GoreBalloonsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				GoreBalloonsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoUltimateMax = 100 * dvds_ammolimitsumaxbaseratio;
				CGrenadeAmmoUltimateMax += ((PlayerSTR * 2) + (PlayerLevel * 1) * dvds_ammolimitsumaxaddratio);
				CGrenadeAmmoUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CGrenadeAmmoUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsUltimateMax = 400 * dvds_ammolimitsumaxbaseratio;
				ClownSoulsUltimateMax += ((PlayerSTR * 4) + (PlayerLevel * 2) * dvds_ammolimitsumaxaddratio);
				ClownSoulsUltimateMax *= dvds_ammolimitsumaxtotalratio;
				ClownSoulsUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallUltimateMax = 25 * dvds_ammolimitsumaxbaseratio;
				CZBallUltimateMax += ((PlayerSTR / 2) + (PlayerLevel * 0.5) * dvds_ammolimitsumaxaddratio);
				CZBallUltimateMax *= dvds_ammolimitsumaxtotalratio;
				CZBallUltimateMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);

				RifleAmmoMax = 0;
				PopcornPieceMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				PopcornPieceMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				GoreBalloonsMax = (50 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 20) * dvds_ammolimitsbackpackratio);
				GoreBalloonsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CGrenadeAmmoMax = (100 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 40) * dvds_ammolimitsbackpackratio);
				CGrenadeAmmoMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				ClownSoulsMax = (200 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 80) * dvds_ammolimitsbackpackratio);
				ClownSoulsMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
				CZBallMax = (25 * dvds_ammolimitsbaseammoratio) + ((BackPacksCollected * 10) * dvds_ammolimitsbackpackratio);
				CZBallMax *= (perkmultiplier * perkmultiplier2 * perkmultiplier3);
			}
			if (CharacterClass == 8) // Ailish
			{
			}
			if (CharacterClass == 9) // Petra
			{
			}

			if (dvdsdebug_backpackammolimits)
			{
				Console.Printf("\cxBackPacksCollected: %d\c-,
				Diaris: %d / %d, PoisonNeedle: %d / %d, Clip: %d / %d, Shell: %d / %d, Rocket: %d / %d, Cell: %d / %d, Rifle: %d / %d,
				\ci GoldWand: %d / %d, Crossbow: %d / %d, DragonClaw: %d / %d, PhoenixRod: %d / %d, Hellstaff: %d / %d, FireMace: %d / %d,
				\cp ElecArrows: %d / %d, PoisonArrows: %d / %d, StrifeRifle: %d / %d, MiniMissiles: %d / %d, EnergyPod: %d / %d, HEGrenades: %d / %d, PHGrenades: %d / %d,
				\cx perkmultiplier: %.8f, \cx perkmultiplier2: %.8f, \cx perkmultiplier3: %.8f", 
												BackPacksCollected,
												DiarisArrowMax, DiarisArrowUltimateMax, 
												PoisonNeedleMax, PoisonNeedleUltimateMax, 
												ClipMax, ClipUltimateMax, 
												ShellMax, ShellUltimateMax,
												RocketMax, RocketUltimateMax,
												CellMax, CellUltimateMax,
												RifleAmmoMax, RifleAmmoUltimateMax,
												GoldWandAmmoMax, GoldWandAmmoUltimateMax,
												CrossbowAmmoMax, CrossbowAmmoUltimateMax,
												BlasterAmmoMax, BlasterAmmoUltimateMax,
												PhoenixRodAmmoMax, PhoenixRodAmmoUltimateMax,
												SkullRodAmmoMax, SkullRodAmmoUltimateMax,
												MaceAmmoMax, MaceAmmoUltimateMax,
												ElectricBoltsMax, ElectricBoltsUltimateMax,
												PoisonBoltsMax, PoisonBoltsUltimateMax,
												ClipOfBulletsMax, ClipOfBulletsUltimateMax,
												MiniMissilesMax, MiniMissilesUltimateMax,
												EnergyPodMax, EnergyPodUltimateMax,
												HEGrenadeRoundsMax, HEGrenadeRoundsUltimateMax,
												PHGrenadeRoundsUltimateMax, PHGrenadeRoundsUltimateMax,
												perkmultiplier, perkmultiplier2, perkmultiplier3);
			}

			// Hexen has no backpack item so in Hexen so max ammo is solely determined on Strength stat and Level.
			if (ClassicDoomType == 3)
			{
				DiarisArrowMax = DiarisArrowUltimateMax;
				PoisonNeedleMax = PoisonNeedleUltimateMax;
				ClipMax = ClipUltimateMax;
				ShellMax = ShellUltimateMax;
				RocketMax = RocketUltimateMax;
				CellMax = CellUltimateMax;
				GoldWandAmmoMax = GoldWandAmmoUltimateMax;
				CrossbowAmmoMax = CrossbowAmmoUltimateMax;
				BlasterAmmoMax = BlasterAmmoUltimateMax;
				PhoenixRodAmmoMax = PhoenixRodAmmoUltimateMax;
				SkullRodAmmoMax = SkullRodAmmoUltimateMax;
				MaceAmmoMax = MaceAmmoUltimateMax;
				ElectricBoltsMax = ElectricBoltsUltimateMax;
				PoisonBoltsMax = PoisonBoltsUltimateMax;
				ClipOfBulletsMax = ClipOfBulletsUltimateMax;
				MiniMissilesMax = MiniMissilesUltimateMax;
				EnergyPodMax = EnergyPodUltimateMax;
				HEGrenadeRoundsMax = HEGrenadeRoundsUltimateMax;
				PHGrenadeRoundsMax = PHGrenadeRoundsUltimateMax;
				RifleAmmoMax = RifleAmmoUltimateMax; // KDIZD
				PopcornPieceMax = PopcornPieceUltimateMax; // HTC2
				GoreBalloonsMax = GoreBalloonsUltimateMax; // HTC2
				CGrenadeAmmoMax = CGrenadeAmmoUltimateMax; // HTC2
				ClownSoulsMax = ClownSoulsUltimateMax; // HTC2
				CZBallMax = CZBallUltimateMax; // HTC2
			}
			
			// Cap Maximum Ammo Limits
			DiarisArrowMax = clamp(DiarisArrowMax, 1, DiarisArrowUltimateMax);
			PoisonNeedleMax = clamp(PoisonNeedleMax, 1, PoisonNeedleUltimateMax);

			ClipMax = clamp(ClipMax, 1, ClipUltimateMax);
			ShellMax = clamp(ShellMax, 1, ShellUltimateMax);
			RocketMax = clamp(RocketMax, 1, RocketUltimateMax);
			CellMax = clamp(CellMax, 1, CellUltimateMax);

			GoldWandAmmoMax = clamp(GoldWandAmmoMax, 1, GoldWandAmmoUltimateMax);
			CrossbowAmmoMax = clamp(CrossbowAmmoMax, 1, CrossbowAmmoUltimateMax);
			BlasterAmmoMax = clamp(BlasterAmmoMax, 1, BlasterAmmoUltimateMax);
			PhoenixRodAmmoMax = clamp(PhoenixRodAmmoMax, 1, PhoenixRodAmmoUltimateMax);
			SkullRodAmmoMax = clamp(SkullRodAmmoMax, 1, SkullRodAmmoUltimateMax);
			MaceAmmoMax = clamp(MaceAmmoMax, 1, MaceAmmoUltimateMax);

			ElectricBoltsMax = clamp(ElectricBoltsMax, 1, ElectricBoltsUltimateMax);
			PoisonBoltsMax = clamp(PoisonBoltsMax, 1, PoisonBoltsUltimateMax);
			ClipOfBulletsMax = clamp(ClipOfBulletsMax, 1, ClipOfBulletsUltimateMax);
			MiniMissilesMax = clamp(MiniMissilesMax, 1, MiniMissilesUltimateMax);
			EnergyPodMax = clamp(EnergyPodMax, 1, EnergyPodUltimateMax);
			HEGrenadeRoundsMax = clamp(HEGrenadeRoundsMax, 1, HEGrenadeRoundsUltimateMax);
			PHGrenadeRoundsMax = clamp(PHGrenadeRoundsMax, 1, PHGrenadeRoundsUltimateMax);

			RifleAmmoMax = clamp(RifleAmmoMax, 1, RifleAmmoUltimateMax);

			PopcornPieceMax = clamp(PopcornPieceMax, 1, PopcornPieceUltimateMax);
			GoreBalloonsMax = clamp(GoreBalloonsMax, 1, GoreBalloonsUltimateMax);
			CGrenadeAmmoMax = clamp(CGrenadeAmmoMax, 1, CGrenadeAmmoUltimateMax);
			ClownSoulsMax = clamp(ClownSoulsMax, 1, ClownSoulsUltimateMax);
			CZBallMax = clamp(CZBallMax, 1, CZBallUltimateMax);

			// Set Maximum Ammo Values
			let currentammotype = owner.FindInventory("DiarisArrow"); 
			if (currentammotype) 
			{
				currentammotype.MaxAmount = DiarisArrowMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7401,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7501,currentammotype.MaxAmount);
			}
			currentammotype = owner.FindInventory("PoisonNeedleAmmo"); 
			if (currentammotype) 
			{
				currentammotype.MaxAmount = PoisonNeedleMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7402,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7502,currentammotype.MaxAmount);
			}

			currentammotype = owner.FindInventory("Clip");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = ClipMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7403,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7503,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("Shell");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = ShellMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7404,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7504,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("RocketAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = RocketMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7405,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7505,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("Cell");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = CellMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7406,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7506,currentammotype.MaxAmount);
			}
			currentammotype = owner.FindInventory("GoldWandAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = GoldWandAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7411,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7511,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("CrossbowAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = CrossbowAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7412,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7512,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("BlasterAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = BlasterAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7413,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7513,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("PhoenixRodAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = PhoenixRodAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7414,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7514,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("SkullRodAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = SkullRodAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7415,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7515,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("MaceAmmo");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = MaceAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7416,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7516,currentammotype.MaxAmount);
			}
			currentammotype = owner.FindInventory("ElectricBolts");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = ElectricBoltsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7421,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7521,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("PoisonBolts");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = PoisonBoltsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7422,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7522,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("ClipOfBullets");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = ClipOfBulletsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7423,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7523,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("MiniMissiles");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = MiniMissilesMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7424,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7524,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("EnergyPod");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = EnergyPodMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7425,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7525,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("HEGrenadeRounds");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = HEGrenadeRoundsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7426,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7526,currentammotype.MaxAmount);
			}
			
			currentammotype = owner.FindInventory("PhosphorusGrenadeRounds");
			if (currentammotype) 
			{
				currentammotype.MaxAmount = PHGrenadeRoundsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7427,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7527,currentammotype.MaxAmount);
			}
			// None Main Game Ammo Types
			nm = "RifleAmmo"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = RifleAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7441,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7541,currentammotype.MaxAmount);
			}

			nm = "PopcornPiece"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = PopcornPieceMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7442,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7542,currentammotype.MaxAmount);
			}

			nm = "GoreBalloons"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = GoreBalloonsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7443,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7543,currentammotype.MaxAmount);
			}

			nm = "CGrenadeAmmo"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = CGrenadeAmmoMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7444,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7544,currentammotype.MaxAmount);
			}

			nm = "ClownSouls"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = ClownSoulsMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7445,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7545,currentammotype.MaxAmount);
			}

			nm = "CZBall"; APPackCheck = nm; currentammotype = owner.FindInventory(APPackCheck);
			if (currentammotype) 
			{
				currentammotype.MaxAmount = CZBallMax;
				currentammotype.Amount = clamp(currentammotype.Amount, currentammotype.Amount, currentammotype.MaxAmount);
				CallACS("MiscVarSetDECORATE",7446,currentammotype.Amount);
				CallACS("MiscVarSetDECORATE",7546,currentammotype.MaxAmount);
			}

			if (BackPacksCollected > PrevBackPacksCollected)
			{
				int BackPackDiff = BackPacksCollected - PrevBackPacksCollected;
				//Console.Printf("BackPackDiff: %d", BackPackDiff);

				if (CharacterClass != 2) // Deggaris & Illucia
				{
					owner.GiveInventory("Clip", (20 * BackPackDiff)); 
					owner.GiveInventory("Shell", (8 * BackPackDiff)); 
					owner.GiveInventory("RocketAmmo", (2 * BackPackDiff)); 
					owner.GiveInventory("Cell", (80 * BackPackDiff)); 
				}
				if (CharacterClass == 2) // Flora
				{
					if (owner.CountInv("FloraLearnedPistols")) owner.GiveInventory("Clip", (20 * BackPackDiff));
					owner.GiveInventory("DiarisArrow", (3 * BackPackDiff)); 
				}
				
				// Heretic Ammo
				owner.GiveInventory("GoldWandAmmo", (20 * BackPackDiff));
				owner.GiveInventory("CrossbowAmmo", (10 * BackPackDiff));
				owner.GiveInventory("BlasterAmmo", (20 * BackPackDiff));
				owner.GiveInventory("MaceAmmo", (40 * BackPackDiff));
				owner.GiveInventory("PhoenixRodAmmo", (2 * BackPackDiff));
				owner.GiveInventory("SkullRodAmmo", (40 * BackPackDiff));
				
				// Strife Ammo
				owner.GiveInventory("ElectricBolts", (20 * BackPackDiff));
				owner.GiveInventory("PoisonBolts", (10 * BackPackDiff));
				if (CharacterClass == 7) // StrifeGuy
				{
					owner.GiveInventory("ClipOfBullets", (10 * BackPackDiff));
					owner.GiveInventory("MiniMissiles", (4 * BackPackDiff));
					owner.GiveInventory("EnergyPod", (20 * BackPackDiff));
					owner.GiveInventory("HEGrenadeRounds", (6 * BackPackDiff));
					owner.GiveInventory("PhosphorusGrenadeRounds", (4 * BackPackDiff));
				}
				
				// CompatPack Ammos
				nm = "RifleAmmo"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (10 * BackPackDiff));
				nm = "PopcornPiece"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (5 * BackPackDiff));
				nm = "ClownSouls"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (5 * BackPackDiff));
				nm = "GoreBalloon"; APPackCheck = nm; if (owner.CountInv(APPackCheck)) { nm = "GoreBalloons"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (6 * BackPackDiff)); }
				nm = "ClownGrenade"; APPackCheck = nm; if (owner.CountInv(APPackCheck)) { nm = "CGrenadeAmmo"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (2 * BackPackDiff)); }
				nm = "CrazyBall2"; APPackCheck = nm; if (owner.CountInv(APPackCheck)) { nm = "CZBall"; APPackCheck = nm; owner.GiveInventory(APPackCheck, (1 * BackPackDiff)); }
			}
			PrevBackPacksCollected = BackPacksCollected;
		}
	}
	
	void A_PSI1DoEffectSauronEquipCheck()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			nm = "SauronGauntletsAilish"; APPackCheck = nm;
			nn = "SauronGauntletsPetra"; APPackCheck2 = nn;
			if (CharacterClass == 0) // Deggaris's Gauntlets
			{
				if (Owner.CountInv("SauronGauntlets")) { Owner.A_SetInventory("SauronGauntletsItem", 1); } else { Owner.A_SetInventory("SauronGauntletsItem", 0); }
				if (Owner.CountInv("SauronGauntletsIllucia")) { Owner.A_SetInventory("SauronGauntletsIllucia", 0); Owner.A_SetInventory("SauronGauntlets", 1); }
				if (Owner.CountInv("SauronGauntletsFlora")) { Owner.A_SetInventory("SauronGauntletsFlora", 0); Owner.A_SetInventory("SauronGauntlets", 1); }
				if (Owner.CountInv(APPackCheck)) { Owner.A_SetInventory(APPackCheck, 0); Owner.A_SetInventory("SauronGauntlets", 1); }
				if (Owner.CountInv(APPackCheck2)) { Owner.A_SetInventory(APPackCheck2, 0); Owner.A_SetInventory("SauronGauntlets", 1); }
			}
			if (CharacterClass == 1) // Illucia's Gauntlets
			{
				if (Owner.CountInv("SauronGauntlets")) { Owner.A_SetInventory("SauronGauntlets", 0); Owner.A_SetInventory("SauronGauntletsIllucia", 1); }
				if (Owner.CountInv("SauronGauntletsIllucia")) { Owner.A_SetInventory("SauronGauntletsItem", 1); } else { Owner.A_SetInventory("SauronGauntletsItem", 0); }
				if (Owner.CountInv("SauronGauntletsFlora")) { Owner.A_SetInventory("SauronGauntletsFlora", 0); Owner.A_SetInventory("SauronGauntletsIllucia", 1); }
				if (Owner.CountInv(APPackCheck)) { Owner.A_SetInventory(APPackCheck, 0); Owner.A_SetInventory("SauronGauntletsIllucia", 1); }
				if (Owner.CountInv(APPackCheck2)) { Owner.A_SetInventory(APPackCheck2, 0); Owner.A_SetInventory("SauronGauntletsIllucia", 1); }
			}
			if (CharacterClass == 2) // Flora's Gauntlets
			{
				if (Owner.CountInv("SauronGauntlets")) { Owner.A_SetInventory("SauronGauntlets", 0); Owner.A_SetInventory("SauronGauntletsFlora", 1); }
				if (Owner.CountInv("SauronGauntletsIllucia")) { Owner.A_SetInventory("SauronGauntletsIllucia", 0); Owner.A_SetInventory("SauronGauntletsFlora", 1); }
				if (Owner.CountInv("SauronGauntletsFlora")) { Owner.A_SetInventory("SauronGauntletsItem", 1); } else { Owner.A_SetInventory("SauronGauntletsItem", 0); }
				if (Owner.CountInv(APPackCheck)) { Owner.A_SetInventory(APPackCheck, 0); Owner.A_SetInventory("SauronGauntletsFlora", 1); }
				if (Owner.CountInv(APPackCheck2)) { Owner.A_SetInventory(APPackCheck2, 0); Owner.A_SetInventory("SauronGauntletsFlora", 1); }
			}
			if (CharacterClass == 8) // Ailish's Gauntlets
			{
				if (Owner.CountInv("SauronGauntlets")) { Owner.A_SetInventory("SauronGauntlets", 0); Owner.A_SetInventory(APPackCheck, 1); }
				if (Owner.CountInv("SauronGauntletsIllucia")) { Owner.A_SetInventory("SauronGauntletsIllucia", 0); Owner.A_SetInventory(APPackCheck, 1); }
				if (Owner.CountInv("SauronGauntletsFlora")) { Owner.A_SetInventory("SauronGauntletsFlora", 0); Owner.A_SetInventory(APPackCheck, 1); }
				if (Owner.CountInv(APPackCheck)) { Owner.A_SetInventory("SauronGauntletsItem", 1); } else { Owner.A_SetInventory("SauronGauntletsItem", 0); }
				if (Owner.CountInv(APPackCheck2)) { Owner.A_SetInventory(APPackCheck2, 0); Owner.A_SetInventory(APPackCheck, 1); }
			}
			if (CharacterClass == 9) // Petra's Gauntlets
			{
				if (Owner.CountInv("SauronGauntlets")) { Owner.A_SetInventory("SauronGauntlets", 0); Owner.A_SetInventory(APPackCheck2, 1); }
				if (Owner.CountInv("SauronGauntletsIllucia")) { Owner.A_SetInventory("SauronGauntletsIllucia", 0); Owner.A_SetInventory(APPackCheck2, 1); }
				if (Owner.CountInv("SauronGauntletsFlora")) { Owner.A_SetInventory("SauronGauntletsFlora", 0); Owner.A_SetInventory(APPackCheck2, 1); }
				if (Owner.CountInv(APPackCheck)) { Owner.A_SetInventory(APPackCheck, 0); Owner.A_SetInventory(APPackCheck2, 1); }
				if (Owner.CountInv(APPackCheck2)) { Owner.A_SetInventory("SauronGauntletsItem", 1); } else { Owner.A_SetInventory("SauronGauntletsItem", 0); }
			}
			
			if (Owner.CountInv("TheOneRing"))
			{
				Owner.A_SetInventory("RingFullMap", 1); // All characters get a full automap with the Ring
				Owner.A_SetInventory("RingScanner", 1); // All characters get a map scanner with the Ring
				if (CharacterClass == 0) Owner.A_SetInventory("RingGhost", 1); // Deggaris becomes Ghostly like with the Ring
				if (CharacterClass == 1) Owner.A_SetInventory("RingShadow", 1); // Illucia becomes Shadow like with the Ring 
			}
			else
			{
				Owner.A_SetInventory("RingFullMap", 0);
				Owner.A_SetInventory("RingScanner", 0);
				Owner.A_SetInventory("RingGhost", 0);
				Owner.A_SetInventory("RingShadow", 0);
			}
		}
	}
	
	// Infinite Ammo Chance Checks
	void A_PSI1DoEffectInfAmmo()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		
		//***********************
		//*Infinite Ammo Chances*
		//***********************
		int infammoreqremaining;
		int infammoneeded = 0;
		int infammoneeded2 = 0;
		int temp;
		if (playeractor)
		{
			if (Owner.CountInv("DSGreenArmorClass"))		temp += 250; // +2.5% Chance
			if (Owner.CountInv("DSBlueArmorClass"))			temp += 400; // +4.0% Chance
			if (Owner.CountInv("DSStoneArmorClass1"))		temp += 650; // +6.5% Chance
			if (Owner.CountInv("DSDiamondArmorClass1"))	temp += 1000; // +10.0% Chance
			if (Owner.CountInv("DSStoneArmorClass2"))		temp += 1500; // +15.0% Chance
			if (Owner.CountInv("DSDiamondArmorClass2"))	temp += 2500; // +25.0% Chance
			if (ModType != 0) 															temp *= 1.5; // Marine's Armor gives them 1.5x the chance of infinite ammo (from their specific armors only) on each tic in DVI/DVII mode.
			infammoneeded += temp;
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 1 - Marine Armor]: %d\c-", infammoneeded);

			if (Owner.CountInv("SauronHelmet"))						temp += 750; // +7.5% Chance
			if (Owner.CountInv("SauronGauntletsItem"))		temp += 750; // +7.5% Chance
			if (Owner.CountInv("TheOneRing"))							temp += 2500; // +25.0% Chance
			if (ModType != 0) 																temp *= 1.25; // Sauron's Armor gives them 1.25x the chance of infinite ammo on each tic in DVI/DVII mode.
			infammoneeded += temp;
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 2 - Sauron Armor]: %d\c-", infammoneeded2);

			infammoneeded += infammoneeded2;
			if (DivineAvatarTimer > 0)
			{
				temp += 1250;
				infammoneeded += temp;
				infammoreqremaining = (10000 - infammoneeded) * 0.25; // Gets 25% of the remaining value not covered by the above.
				infammoneeded += infammoreqremaining;
			}
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 3 - Divine Avatar]: %d\c-", infammoneeded);
			
			// "Bottomless Magazines" Perk
			infammoneeded += (CallACS("MiscVarCheckDECORATE",10047) * 500);
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 4 - Bottomless Mags]: %d\c-", infammoneeded);
			
			// "Bottomless Magazines EX" Perk
			infammoneeded += (CallACS("MiscVarCheckDECORATE",10048) * 1250);
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 5 - Bottomless Mags EX]: %d\c-", infammoneeded);
			
			int infammochance = random[statitem](1,10000);
			Owner.A_SetInventory("RandomInfiniteAmmo",0);
			if (infammochance <= infammoneeded) Owner.A_SetInventory("RandomInfiniteAmmo",1);
			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP 6 - Chance Roll]: %d / %d\c-", infammochance, infammoneeded);

			if (dvdsdebug_infiniteammostuff) Console.Printf("    \cwInfinite Ammo [STEP ? - Minigun Heat]: %d / %d\c-", minigunheat, minigunheatmax);
		}
	}

	void A_PSI1DoEffectIronFeet()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			if (Owner.CountInv("PowerIronFeet") || Owner.CountInv("AetheriusPowerIronFeet"))
			{
				if (Owner.CountInv("IronFeetNoPoison") == 0) Owner.A_SetInventory("IronFeetNoPoison",1);
				if (Owner.CountInv("MaskNoFire")) Owner.A_SetInventory("MaskNoFire",0);
			}
			else if (Owner.CountInv("PowerMask") || Owner.CountInv("AetheriusPowerMask"))
			{
				if (Owner.CountInv("IronFeetNoPoison") == 0) Owner.A_SetInventory("IronFeetNoPoison",1);
				if (Owner.CountInv("MaskNoFire") == 0) Owner.A_SetInventory("MaskNoFire",1);
			}
			else
			{
				if (Owner.CountInv("IronFeetNoPoison")) Owner.A_SetInventory("IronFeetNoPoison",0);
				if (Owner.CountInv("MaskNoFire")) Owner.A_SetInventory("MaskNoFire",0);
			}
		}
	}
	
	// Shield Uncurse Intervals
	void A_PSI1DoEffectUncurseShield()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);

		//*******************
		//*RUINOUS SHIELD D:*
		//*******************
		int UncurseIntervalChance;
		int UncurseIntervalChance2;
		int UncursePtsTotalAdded = 0;
		int UncursePtsAdd1 = 0;
		int uncursetimerincrease = 100;
		int uncurselevel = CallACS("MiscVarCheckDECORATE",202);
		if (playeractor && UsingInGameMenu == 0)
		{
			if (CharacterClass == 2 && Owner.CountInv("RuinousShield")) // Flora
			{
				RuinousPtsCurrent = CallACS("MiscVarCheckDECORATE",202);
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 0]: %d\c-, %d / %d", uncurselevel, RuinousPtsCurrent, RuinousPtsNeeded);
				// Base Max Interval
				UncurseMaxInterval = 7000; // 70 [*100] tics [up to -17 tics with all items]
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 1 - Interval Max (Base)]: %d\c-", UncurseMaxInterval);
	
				previousdelaycount = UncurseMaxInterval;
				if (Owner.CountInv("FalconKnifeEarrings")) UncurseMaxInterval -= 500;
				if (Owner.CountInv("BalrogRing")) UncurseMaxInterval -= 400;
				if (Owner.CountInv("EvenstarNecklace")) UncurseMaxInterval -= 300;
				if (Owner.CountInv("AnubisCufflinks")) UncurseMaxInterval -= 200;
				if (Owner.CountInv("DoveRibbon")) UncurseMaxInterval -= 200;
				if (Owner.CountInv("KissaBra")) UncurseMaxInterval -= 100;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 2 - Interval Max (Armor)]: %d\c-, Previous: %d", UncurseMaxInterval, previousdelaycount);
				
				// Base Interval Chance
				UncurseIntervalChance = 40;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 3 - Interval Chance (Armor)]: %d\c-", UncurseIntervalChance);
				
				previousdelaycount = UncurseIntervalChance;
				if (Owner.CountInv("SafeTeaShoes")) UncurseIntervalChance += 1;
				if (Owner.CountInv("PearlyCorset")) UncurseIntervalChance += 1;
				if (Owner.CountInv("WaterFlyingDress")) UncurseIntervalChance += 1;
				if (Owner.CountInv("EvenstarNecklace")) UncurseIntervalChance += 2;
				if (Owner.CountInv("CloakofEvasion")) UncurseIntervalChance += 1;
				if (Owner.CountInv("FalconKnifeEarrings")) UncurseIntervalChance += 3;
				if (Owner.CountInv("AnubisCufflinks")) UncurseIntervalChance += 2;
				if (Owner.CountInv("KissaBra")) UncurseIntervalChance += 1;
				if (Owner.CountInv("BalrogRing")) UncurseIntervalChance += 2;
				if (Owner.CountInv("DoveRibbon")) UncurseIntervalChance += 1;
				if (Owner.CountInv("SauronHelmet")) UncurseIntervalChance -= 2;
				if (Owner.CountInv("SauronGauntletsFlora")) UncurseIntervalChance -= 3;
				if (Owner.CountInv("TheOneRing")) UncurseIntervalChance += 11;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 4 - Interval Chance (Armor)]: %d\c-, Previous: %d", UncurseIntervalChance, previousdelaycount);
				
				UncurseIntervalChance2 = 8;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 5 - Interval Chance 2 (Armor)]: %d\c-", UncurseIntervalChance2);
	
				previousdelaycount = UncurseIntervalChance2;
				if (Owner.CountInv("PearlyCorset")) UncurseIntervalChance2 += random[statitem](0,1);
				if (Owner.CountInv("DoveRibbon")) UncurseIntervalChance2 += random[statitem](1,3);
				if (Owner.CountInv("CloakOfEvasion")) UncurseIntervalChance2 += random[statitem](2,5);
				if (Owner.CountInv("WaterFlyingDress")) UncurseIntervalChance2 += 2;
				if (Owner.CountInv("AnubisCufflinks")) UncurseIntervalChance2 += 4;
				if (Owner.CountInv("FalconKnifeEarrings")) UncurseIntervalChance2 += 6;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 6 - Interval Chance 2 (Armor)]: %d\c-, Previous: %d", UncurseIntervalChance2, previousdelaycount);
				
				// Amount of Points for Full Uncurse is determined by Difficulty level
				if (TrueGameSkill <= SKILL_VERY_EASY) RuinousPtsNeeded = 576;
				if (TrueGameSkill == SKILL_EASY) RuinousPtsNeeded = 768;
				if (TrueGameSkill == SKILL_NORMAL) RuinousPtsNeeded = 1024;
				if (TrueGameSkill == SKILL_HARD) RuinousPtsNeeded = 1152;
				if (TrueGameSkill == SKILL_VERY_HARD) RuinousPtsNeeded = 1280;
				if (TrueGameSkill == SKILL_EXTREME) RuinousPtsNeeded = 1408;
				if (TrueGameSkill == SKILL_HORRIBLE) RuinousPtsNeeded = 1536;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) RuinousPtsNeeded = 1664;
				if (TrueGameSkill >= SKILL_OMEGA) RuinousPtsNeeded = 1792;
				CallACS("MiscVarSetDECORATE",269,RuinousPtsNeeded); // Set
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 7 - Get Max Uncurse Pts Needed]: %d\c-", RuinousPtsNeeded);
			
				// Checks to determine how many points the Ruinous Shield has gathered towards becoming an uncursed Divine Shield
				uncursetimerincrease = 100;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 8 - Uncurse Interval (Base)]: %d\c-", uncursetimerincrease);

				previousdelaycount = uncursetimerincrease;
				uncursetimerincrease = (uncursetimerincrease * dvds_uncurserate) / 100;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 9 - Uncurse Interval (MenuFactor)]: %d\c-, Previous: %d, Uncurse Factor: %d%", uncursetimerincrease, dvds_uncurserate, previousdelaycount);

				UncurseInterval += uncursetimerincrease;
				if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 10 - Uncurse Interval Increment]: %d / %d\c-, Increment: %d%, Uncurse Pts: (%d) %d / %d", UncurseInterval, UncurseMaxInterval, uncursetimerincrease, uncurselevel, RuinousPtsCurrent, RuinousPtsNeeded);
				if (UncurseInterval >= UncurseMaxInterval)
				{
					UncurseInterval -= UncurseMaxInterval;
					
					// Base Chance
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance) // 35-66% chance of increase
					{
						UncursePtsAdd1 += 2;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					else
					{
						UncursePtsAdd1 += 1;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11a - Uncurse Pts (Base)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Safe Tea Shoes
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("SafeTeaShoes")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 3;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11b - Uncurse Pts (Safe Tea Shoes)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Pearly Corset
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("PearlyCorset")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 6;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11c - Uncurse Pts (Pearly Corset)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Water Flying Dress
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("WaterFlyingDress")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 4;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11d - Uncurse Pts (Water Flying Dress)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Evenstar Necklace
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("EvenstarNecklace")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 1;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11e - Uncurse Pts (Evenstar Necklace)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Cloak of Evasion
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("CloakOfEvasion")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 2;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11f - Uncurse Pts (Cloak of Evasion)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Anubis Cufflinks
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("AnubisCufflinks")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 2;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11g - Uncurse Pts (Anubis Cufflinks)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Kissa's Bra
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("KissaBra")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 5;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11h - Uncurse Pts (Kissa's Bra)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Balrog Ring
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("BalrogRing")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 1;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11i - Uncurse Pts (Balrog Ring)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Dove Ribbon
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("DoveRibbon")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 10;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11j - Uncurse Pts (Dove Ribbon)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);
					
					// Falcon Knife Earrings
					UncursePtsAdd1 = 0;
					if (random[statitem](1,100) <= UncurseIntervalChance && Owner.CountInv("FalconKnifeEarrings")) // 35-66% chance of increase
					{
						UncursePtsAdd1 = 3;
						if (random[statitem](1,100) <= UncurseIntervalChance2) UncursePtsAdd1 *= 2;
						UncursePtsTotalAdded += UncursePtsAdd1;
					}
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11k - Uncurse Pts (Falcon Knife Earrings)]: %d\c-, Increment: %d%", UncursePtsTotalAdded, UncursePtsAdd1);

					if (DivineAvatarTimer > 0) UncursePtsTotalAdded *= 1.25;
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11l - Uncurse Pts (Divine Avatar)]: %d", UncursePtsTotalAdded);

					if (GoETimer > 0) UncursePtsTotalAdded *= 5;
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 11m - Uncurse Pts (GoE)]: %d", UncursePtsTotalAdded);
					
					if (ClearMindPerkLvl == 1) UncursePtsTotalAdded *= 1.02;
					if (ClearMindPerkLvl == 2) UncursePtsTotalAdded *= 1.045;
					if (ClearMindPerkLvl == 3) UncursePtsTotalAdded *= 1.075;
					if (ClearMindPerkLvl == 4) UncursePtsTotalAdded *= 1.11;
					if (ClearMindPerkLvl >= 5) UncursePtsTotalAdded *= 1.15;
					if (ClearMindEXPerkLvl == 1) UncursePtsTotalAdded *= 1.05;
					if (ClearMindEXPerkLvl >= 2) UncursePtsTotalAdded *= 1.1125;
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 12 - Cleared of Mind]: %d", UncursePtsTotalAdded);
		
					RuinousPtsCurrent += UncursePtsTotalAdded;
					if (dvdsdebug_shielduncursedisplay) Console.Printf("    \cnShield Uncursing [Step 13 - Increment Uncurse Pts]: %d / %d\c-, Total Increment: %d%", RuinousPtsCurrent, RuinousPtsNeeded, UncursePtsTotalAdded);
					CallACS("MiscVarSetDECORATE",202,UncursePtsTotalAdded,1); // Add
					
					if (RuinousPtsCurrent >= RuinousPtsNeeded)
					{
						Owner.A_SetInventory("DivineShield", 1);
						Owner.A_SetInventory("RuinousShield", 0);
						owner.A_PrintBold("\c[Gold]CONGRATULATIONS!!\n\n\cfTHE RUINOUS SHIELD IS NO LONGER CURSED!\n\n\c[Gold]YOU NOW POSSESS AND WIELD THE MIGHTY 'DIVINE SHIELD'!!", frandom[statitem](1.028,1.2));
						owner.A_StartSound("Uncursed",CHAN_7,CHANF_DEFAULT,1.0,ATTN_NONE);
						UncurseInterval = 0;
					}
				}
			}
			// Checks to make sure you cannot hold the Ruinous Shield if you already have a Divine Shield (the latter is the uncursed version of the former).
			if (CharacterClass == 2 && Owner.CountInv("DivineShield") && Owner.CountInv("RuinousShield")) Owner.A_SetInventory("RuinousShield",0); // Flora
		}
	}
	
	// Actions to APPEND DoEffect() due to Register Limit Issues in the main function >.>
	void A_PSI1DoEffectMiscOptions()
	{
		// Check if player can breath/talk underwater
		CanTalkUnderwater = 0;
		if (owner.waterlevel < 3) 
		{
			CanTalkUnderwater = 1;
		}
		else
		{
			if (owner.CountInv("PowerNoDrown") || 
					owner.CountInv("PowerIronFeet") || 
					owner.CountInv("PowerMask"))
			{
				CanTalkUnderwater = 2;
			}
			else
			{
				if (random[statitem](1,32) <= random[statitem](1,4)) CanTalkUnderwater = 1;
			}
		}
		if (dvdsdebug_showairmeter) Console.Printf("CanTalkUnderwater %d", CanTalkUnderwater);
		
		int tempcvarvalue;
		CallACS("MiscVarSetDECORATE",100001,dvdsdebug_showmeleeinformation);
		CallACS("MiscVarSetDECORATE",100005,dvdsdebug_showstaminausestuff);
		CallACS("MiscVarSetDECORATE",100006,dvdsdebug_showmiscdmginformation);
		CallACS("MiscVarSetDECORATE",100007,dvdsdebug_accuracyspreadisplay);
		
		CallACS("MiscVarSetDECORATE",110001,dvdsperks_active);
		CallACS("MiscVarSetDECORATE",110002,dvds_allowtension);
		CallACS("MiscVarSetDECORATE",110004,dvds_rnd_stealthlevel);
		CallACS("MiscVarSetDECORATE",110005,dvds_canseedsappear);
		CallACS("MiscVarSetDECORATE",110006,dvds_flora_ignorearmormadelevelcap);
		CallACS("MiscVarSetDECORATE",110007,dvds_monstercrisisattacks);
		CallACS("MiscVarSetDECORATE",110008,dvdsdebug_healitemdisplays);
		CallACS("MiscVarSetDECORATE",110009,dvds_fke_effecttype);
		
		//***************
		//*Tension Speed*
		//***************
		TensionSpeedRatio = clamp(TensionSpeedRatio, 0, 1000);

		tempcvarvalue = clamp(dvds_aeonstartlvl, 0, 200);
		CallACS("MiscVarSetDECORATE",197,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationOVERALL, -50, 50);
		CallACS("MiscVarSetDECORATE",169,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationEXP, -50, 50);
		CallACS("MiscVarSetDECORATE",52,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationStats, -50, 50);
		CallACS("MiscVarSetDECORATE",53,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationSpawnStealth, -50, 50);
		CallACS("MiscVarSetDECORATE",54,tempcvarvalue);


		tempcvarvalue = clamp(dvds_mapdifficultyinflationOVERALL2, 1, 5000);
		CallACS("MiscVarSetDECORATE",5,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationEXP2, 1, 5000);
		CallACS("MiscVarSetDECORATE",1,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationStats2, 1, 5000);
		CallACS("MiscVarSetDECORATE",2,tempcvarvalue);

		tempcvarvalue = clamp(dvds_mapdifficultyinflationSpawnStealth2, 1, 5000);
		CallACS("MiscVarSetDECORATE",3,tempcvarvalue);


		tempcvarvalue = clamp(dvds_aeonpointmultiplier, 1, dvds_aeonpointmultiplier);
		CallACS("MiscVarSetDECORATE",86,tempcvarvalue);
		AeonPtMulti = CallACS("MiscVarCheckDECORATE",86);

		tempcvarvalue = clamp(dvds_seedmultiplier, 1, dvds_seedmultiplier);
		CallACS("MiscVarSetDECORATE",87,tempcvarvalue);

		tempcvarvalue = clamp(dvds_lvlstatmultiplier, 1, dvds_lvlstatmultiplier);
		CallACS("MiscVarSetDECORATE",146,tempcvarvalue);
		LvlStatMulti = CallACS("MiscVarCheckDECORATE",146);
		
		
		if (CallACS("MiscVarCheckDECORATE",171) > 0) CallACS("MiscVarSetDECORATE",171,1,2); // Ticks down the "Level Up" and "Stat Up" indicators on the new HUD after a level up occurs
		if (CallACS("MiscVarCheckDECORATE",2031) > 0) CallACS("MiscVarSetDECORATE",2031,1,2); // Ticks down the "MaxHP" gain timer
		if (CallACS("MiscVarCheckDECORATE",2032) > 0) CallACS("MiscVarSetDECORATE",2032,1,2); // Ticks down the "MaxMP" gain timer
		if (CallACS("MiscVarCheckDECORATE",2033) > 0) CallACS("MiscVarSetDECORATE",2033,1,2); // Ticks down the "AeonPts" gain timer
		if (CallACS("MiscVarCheckDECORATE",2034) > 0) CallACS("MiscVarSetDECORATE",2034,1,2); // Ticks down the "Strength" gain timer
		if (CallACS("MiscVarCheckDECORATE",2035) > 0) CallACS("MiscVarSetDECORATE",2035,1,2); // Ticks down the "Defense" gain timer
		if (CallACS("MiscVarCheckDECORATE",2036) > 0) CallACS("MiscVarSetDECORATE",2036,1,2); // Ticks down the "Sorcery" gain timer
		if (CallACS("MiscVarCheckDECORATE",2037) > 0) CallACS("MiscVarSetDECORATE",2037,1,2); // Ticks down the "Therapeusis" gain timer
		if (CallACS("MiscVarCheckDECORATE",2038) > 0) CallACS("MiscVarSetDECORATE",2038,1,2); // Ticks down the "Agility" gain timer
		if (CallACS("MiscVarCheckDECORATE",2039) > 0) CallACS("MiscVarSetDECORATE",2039,1,2); // Ticks down the "Deftness" gain timer

		if (CallACS("MiscVarCheckDECORATE",2040) > 0) CallACS("MiscVarSetDECORATE",2040,1,2); // Ticks down Buff/Debuff Message #1 Timer
		if (CallACS("MiscVarCheckDECORATE",2041) > 0) CallACS("MiscVarSetDECORATE",2041,1,2); // Ticks down Buff/Debuff Message #2 Timer
		if (CallACS("MiscVarCheckDECORATE",2042) > 0) CallACS("MiscVarSetDECORATE",2042,1,2); // Ticks down Buff/Debuff Message #3 Timer
		if (CallACS("MiscVarCheckDECORATE",2043) > 0) CallACS("MiscVarSetDECORATE",2043,1,2); // Ticks down Buff/Debuff Message #4 Timer
		if (CallACS("MiscVarCheckDECORATE",2044) > 0) CallACS("MiscVarSetDECORATE",2044,1,2); // Ticks down Buff/Debuff Message #5 Timer

		// [222] # of TOTAL Max HP gained during multiple level ups [for displays]
		// [223] # of TOTAL Max MP gained during multiple level ups [for displays]
		// [224] # of TOTAL Aeon Points gained during multiple level ups [for displays]
		// [225] # of TOTAL Agility Points gained during multiple level ups [for displays]
		// [226] # of TOTAL Defense Points gained during multiple level ups [for displays]
		// [227] # of TOTAL Deftness Points gained during multiple level ups [for displays]
		// [228] # of TOTAL Sorcery Points gained during multiple level ups [for displays]
		// [229] # of TOTAL Strength Points gained during multiple level ups [for displays]
		// [230] # of TOTAL Therapeusis Points gained during multiple level ups [for displays]

		if (CallACS("MiscVarCheckDECORATE",2031) <= 0) CallACS("MiscVarSetDECORATE",222,0);
		if (CallACS("MiscVarCheckDECORATE",2032) <= 0) CallACS("MiscVarSetDECORATE",223,0);
		if (CallACS("MiscVarCheckDECORATE",2033) <= 0) CallACS("MiscVarSetDECORATE",224,0);
		if (CallACS("MiscVarCheckDECORATE",2034) <= 0) CallACS("MiscVarSetDECORATE",225,0);
		if (CallACS("MiscVarCheckDECORATE",2035) <= 0) CallACS("MiscVarSetDECORATE",226,0);
		if (CallACS("MiscVarCheckDECORATE",2036) <= 0) CallACS("MiscVarSetDECORATE",227,0);
		if (CallACS("MiscVarCheckDECORATE",2037) <= 0) CallACS("MiscVarSetDECORATE",228,0);
		if (CallACS("MiscVarCheckDECORATE",2038) <= 0) CallACS("MiscVarSetDECORATE",229,0);
		if (CallACS("MiscVarCheckDECORATE",2039) <= 0) CallACS("MiscVarSetDECORATE",230,0);
		
		
		
		
		
		// [2502] Unfreeze Player
		CallACS("MiscVarSetDECORATE",4,0);
		if (UsingInGameMenu != 0 || SleepTimer > 0) CallACS("MiscVarSetDECORATE",4,1,1); // Freezes the player's actions if in the menu or was put to sleep.
		if (CallACS("MiscVarCheckDECORATE",4) > 0)
		{
			owner.player.cheats |= CF_FROZEN; // Turns on Freezing
			owner.player.cheats |= CF_TOTALLYFROZEN; // Turns on Total Freezing
			CallACS("DVDSSpecialArraySetDECORATE",9,1); // Prevents Dashing
			//Console.Printf("Player Frozen!");
			CallACS("MiscVarSetDECORATE",2502,0);
		}
		else
		{
			if (CallACS("MiscVarCheckDECORATE",2502) == 0)
			{
				owner.player.cheats &= ~CF_FROZEN; // Turns off Total Freezing
				owner.player.cheats &= ~CF_TOTALLYFROZEN; // Turns off Total Freezing
				CallACS("DVDSSpecialArraySetDECORATE",9,0); // Allows Dashing
				//Console.Printf("Player UnFrozen!");
				CallACS("MiscVarSetDECORATE",2502,1);
			}
		}
		//Console.Printf("[2502]: %d, [4]: %d", CallACS("MiscVarCheckDECORATE",2502), CallACS("MiscVarCheckDECORATE",4));
	}

	// Actions to APPEND DoEffect() due to Register Limit Issues in the main function >.> [Completion Checking/Aeon Point Giving)
	void A_PSI1DoEffectCountKSI()
	{
		//*******************************************
		// Gets Values for Accquired Kills & Secrets*
		//*******************************************
		if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
		{
			CallACS("ArrayVarSetDECORATE",0,level.levelnum,(level.total_monsters - level.killed_monsters));
			CallACS("ArrayVarSetDECORATE",1,level.levelnum,level.killed_monsters);
			CallACS("ArrayVarSetDECORATE",2,level.levelnum,level.found_secrets);
			CallACS("ArrayVarSetDECORATE",3,level.levelnum,level.found_items);
		}
		if (ModType == 1 && (level.levelnum >= 1100 && level.levelnum <= 1199)) // Deus Vult 1 only
		{
			if (CallACS("SpecialGameFlagsCheckDECORATE",10000) != 1)
			{
				CallACS("ArrayVarSetDECORATE",0,level.levelnum,(level.total_monsters - level.killed_monsters));
				CallACS("ArrayVarSetDECORATE",1,level.levelnum,level.killed_monsters);
				CallACS("ArrayVarSetDECORATE",2,level.levelnum,level.found_secrets);
				CallACS("ArrayVarSetDECORATE",3,level.levelnum,level.found_items);
			}
		}
		if (ModType == 2 && (level.levelnum >= 1200 && level.levelnum <= 1299)) // Deus Vult 2 only
		{
			CallACS("ArrayVarSetDECORATE",0,level.levelnum,(level.total_monsters - level.killed_monsters));
			CallACS("ArrayVarSetDECORATE",1,level.levelnum,level.killed_monsters);
			CallACS("ArrayVarSetDECORATE",2,level.levelnum,level.found_secrets);
			CallACS("ArrayVarSetDECORATE",3,level.levelnum,level.found_items);
		}

		int i = 0;
		int tempaeonpts;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		//*************************
		//*Aeon Point Distribution*
		//*************************
		int forstart, forend;
		int totalkills, totalsecrets, totalitems = 0;
		int aeontogivekills, aeontogivesecrets, aeontogiveitems = 0;
		int aeontogivekillsyet, aeontogivesecretsyet, aeontogiveitemsyet = 0;
		if (playeractor)
		{
			if (dvds_aeonpointbonus == 1)
			{
				if (ModType == 0) { forstart = 0; forend = 151; }
				if (ModType == 1) { forstart = 1100; forend = 1105; }
				if (ModType == 2) { forstart = 1200; forend = 1215; }
				
				// Kills
				totalkills = 0;
				for (i = forstart; i < forend; i++) { totalkills += CallACS("ArrayVarCheckDECORATE",1,i); }
				CallACS("MiscVarSetDECORATE",63,totalkills);
				aeontogivekills = totalkills / dvds_killsforaeonpts;
				aeontogivekillsyet = CallACS("MiscVarCheckDECORATE",62);
				
				if (aeontogivekillsyet < aeontogivekills)
				{
					tempaeonpts = 1;
					tempaeonpts *= AeonPtMulti;
					
					CallACS("MiscVarSetDECORATE",25,tempaeonpts,1);
					PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
					CallACS("MiscVarSetDECORATE",224,tempaeonpts,1);
					CallACS("MiscVarSetDECORATE",2033,105);
					aeontogivekillsyet += 1;
					
					if (PlayerLevel >= CallACS("MiscVarCheckDECORATE",197)) 
					{
						owner.A_StartSound("misc/miniquestcomplete",CHAN_AUTO,CHANF_DEFAULT,1.5,ATTN_NONE);
						owner.A_Print(String.Format("\c[orange]You have gained %d Aeon Point[s] for killing enough monsters!\n\n\c[orange]Remember to allocate your Aeon Points as soon as possible...", tempaeonpts), 2.75, "DVDSSMLFONT");
					}
					tempaeonpts = 0;
				}
				if (dvdsdebug_aeonbonusdisplays) Console.Printf("\c[brick]totalkills: %d (%d) / %d, (GiveYet / Give: %d / %d)", totalkills, level.killed_monsters, dvds_killsforaeonpts, aeontogivekillsyet, aeontogivekills);
				CallACS("MiscVarSetDECORATE",62,aeontogivekillsyet);
				CallACS("MiscVarSetDECORATE",61,aeontogivekills);
				
				// Secrets
				totalsecrets = 0;
				for (i = forstart; i < forend; i++) { totalsecrets += CallACS("ArrayVarCheckDECORATE",2,i); }
				CallACS("MiscVarSetDECORATE",64,totalsecrets);
				aeontogivesecrets = totalsecrets / dvds_secretsforaeonpts;
				aeontogivesecretsyet = CallACS("MiscVarCheckDECORATE",60);

				if (aeontogivesecretsyet < aeontogivesecrets)
				{
					tempaeonpts = 1;
					tempaeonpts *= AeonPtMulti;
					
					CallACS("MiscVarSetDECORATE",25,tempaeonpts,1);
					PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
					CallACS("MiscVarSetDECORATE",224,tempaeonpts,1);
					CallACS("MiscVarSetDECORATE",2033,105);
					aeontogivesecretsyet += 1;
					
					if (PlayerLevel >= CallACS("MiscVarCheckDECORATE",197)) 
					{
						owner.A_StartSound("misc/miniquestcomplete",CHAN_AUTO,CHANF_DEFAULT,1.5,ATTN_NONE);
						owner.A_Print(String.Format("\c[orange]You have gained %d Aeon Point[s] for finding enough secrets!\n\n\c[orange]Remember to allocate your Aeon Points as soon as possible...", tempaeonpts), 2.75, "DVDSSMLFONT");
					}
					tempaeonpts = 0;
				}
				if (dvdsdebug_aeonbonusdisplays) Console.Printf("\c[gold]totalsecrets: %d (%d) / %d, (GiveYet / Give: %d / %d)", totalsecrets, level.found_secrets, dvds_secretsforaeonpts, aeontogivesecretsyet, aeontogivesecrets);
				CallACS("MiscVarSetDECORATE",60,aeontogivesecretsyet);
				CallACS("MiscVarSetDECORATE",59,aeontogivesecrets);
				
				// Items
				totalitems = 0;
				for (i = forstart; i < forend; i++) { totalitems += CallACS("ArrayVarCheckDECORATE",3,i); }
				CallACS("MiscVarSetDECORATE",56,totalitems);
				aeontogiveitems = totalitems / dvds_itemsforaeonpts;
				aeontogiveitemsyet = CallACS("MiscVarCheckDECORATE",58);
				
				if (aeontogiveitemsyet < aeontogiveitems)
				{
					tempaeonpts = 1;
					tempaeonpts *= AeonPtMulti;
					
					CallACS("MiscVarSetDECORATE",25,tempaeonpts,1);
					PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
					CallACS("MiscVarSetDECORATE",224,tempaeonpts,1);
					CallACS("MiscVarSetDECORATE",2033,105);
					aeontogiveitemsyet += 1;
					
					if (PlayerLevel >= CallACS("MiscVarCheckDECORATE",197)) 
					{
						owner.A_StartSound("misc/miniquestcomplete",CHAN_AUTO,CHANF_DEFAULT,1.5,ATTN_NONE);
						owner.A_Print(String.Format("\c[orange]You have gained %d Aeon Point[s] for finding special items!\n\n\c[orange]Remember to allocate your Aeon Points as soon as possible...", tempaeonpts), 2.75, "DVDSSMLFONT");
					}
					tempaeonpts = 0;
				}
				if (dvdsdebug_aeonbonusdisplays) Console.Printf("\c[lightblue]totalitems: %d (%d) / %d, (GiveYet / Give: %d / %d)", totalitems, level.found_items, dvds_itemsforaeonpts, aeontogiveitemsyet, aeontogiveitems);
				CallACS("MiscVarSetDECORATE",58,aeontogiveitemsyet);
				CallACS("MiscVarSetDECORATE",57,aeontogiveitems);
			}
			if (PlayerAeonPts < 1) CallACS("MiscVarSetDECORATE",24,0);
			if (PlayerAGL >= 512 && 
					PlayerDEF >= 512 && 
					PlayerDFT >= 512 && 
					PlayerSOR >= 512 && 
					PlayerSTR >= 512 && 
					PlayerTHE >= 512) CallACS("MiscVarSetDECORATE",24,0);
		}
	}
	
	// Armor Checking and Palette Assignment
	void A_PSI1DoEffectArmorChecks()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		//************************************************
		//*Marine's Armor Checks (for color translations)*
		//************************************************
		if (playeractor)
		{
			CurrentArmorClass = CallACS("OtherVarCheckDECORATE",5); // Refresh Current Armor amt
			CurrentMaxArmor = CallACS("OtherVarCheckDECORATE",9); // Refresh Max Armor amt

			if (ClassCheck >= 2)
			{
				if (CurrentArmorClass == 6)
				{
					owner.A_SetInventory("DSDiamondArmorClass2", 1);
					owner.A_SetInventory("DSNoArmorClass", 0);
					owner.A_SetInventory("DSGreenArmorClass", 0);
					owner.A_SetInventory("DSBlueArmorClass", 0);
					owner.A_SetInventory("DSStoneArmorClass1", 0);
					owner.A_SetInventory("DSDiamondArmorClass1", 0);
					owner.A_SetInventory("DSStoneArmorClass2", 0);
					//ACS>Trans - 262164 (21)
					if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262164;
				}
				else
				{
					if (CurrentArmorClass == 5)
					{
						owner.A_SetInventory("DSStoneArmorClass2", 1);
						owner.A_SetInventory("DSNoArmorClass", 0);
						owner.A_SetInventory("DSGreenArmorClass", 0);
						owner.A_SetInventory("DSBlueArmorClass", 0);
						owner.A_SetInventory("DSStoneArmorClass1", 0);
						owner.A_SetInventory("DSDiamondArmorClass1", 0);
						owner.A_SetInventory("DSDiamondArmorClass2", 0);
						//ACS>Trans - 262163 (20)
						if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262163;
					}
					else
					{
						if (CurrentArmorClass == 4)
						{
							owner.A_SetInventory("DSDiamondArmorClass1", 1);
							owner.A_SetInventory("DSNoArmorClass", 0);
							owner.A_SetInventory("DSGreenArmorClass", 0);
							owner.A_SetInventory("DSBlueArmorClass", 0);
							owner.A_SetInventory("DSStoneArmorClass1", 0);
							owner.A_SetInventory("DSStoneArmorClass2", 0);
							owner.A_SetInventory("DSDiamondArmorClass2", 0);
							//ACS>Trans - 262164 (21)
							if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262164; 
						}
						else
						{
							if (CurrentArmorClass == 3)
							{
								owner.A_SetInventory("DSStoneArmorClass1", 1);
								owner.A_SetInventory("DSNoArmorClass", 0);
								owner.A_SetInventory("DSGreenArmorClass", 0);
								owner.A_SetInventory("DSBlueArmorClass", 0);
								owner.A_SetInventory("DSDiamondArmorClass1", 0);
								owner.A_SetInventory("DSStoneArmorClass2", 0);
								owner.A_SetInventory("DSDiamondArmorClass2", 0);
								//ACS>Trans - 262163 (20)
								if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262163; 
							}
							else
							{
								if (CurrentArmorClass == 2)
								{
									owner.A_SetInventory("DSBlueArmorClass", 1);
									owner.A_SetInventory("DSNoArmorClass", 0);
									owner.A_SetInventory("DSGreenArmorClass", 0);
									owner.A_SetInventory("DSStoneArmorClass1", 0);
									owner.A_SetInventory("DSDiamondArmorClass1", 0);
									owner.A_SetInventory("DSStoneArmorClass2", 0);
									owner.A_SetInventory("DSDiamondArmorClass2", 0);
										//ACS>Trans - 262162 (19)
									if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262162; 
								}
								else
								{
									if (CurrentArmorClass == 1)
									{
										owner.A_SetInventory("DSGreenArmorClass", 1);
										owner.A_SetInventory("DSNoArmorClass", 0);
										owner.A_SetInventory("DSBlueArmorClass", 0);
										owner.A_SetInventory("DSStoneArmorClass1", 0);
										owner.A_SetInventory("DSDiamondArmorClass1", 0);
										owner.A_SetInventory("DSStoneArmorClass2", 0);
										owner.A_SetInventory("DSDiamondArmorClass2", 0);
										//ACS>Trans - 262161 (18)
										if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262161; 
									}
									else
									{
										owner.A_SetInventory("DSNoArmorClass", 1);
										owner.A_SetInventory("DSGreenArmorClass", 0);
										owner.A_SetInventory("DSBlueArmorClass", 0);
										owner.A_SetInventory("DSStoneArmorClass1", 0);
										owner.A_SetInventory("DSDiamondArmorClass1", 0);
										owner.A_SetInventory("DSStoneArmorClass2", 0);
										owner.A_SetInventory("DSDiamondArmorClass2", 0);
										//ACS>Trans - 262160 (17)
										if (CharacterClass != 2 && CharacterClass != 8 && CharacterClass != 9) owner.Translation = 262160; 
									}
								}
							}
						}
					}
				}

				if (owner.CountInv("BasicArmor") <= 0)
				{
					CurrentArmorClass = 0;
					CurrentMaxArmor = 0;
					if (owner.CountInv("DSNoArmorClass") == 0)
					{
						owner.A_SetInventory("DSNoArmorClass", 1);
						owner.A_SetInventory("DSGreenArmorClass", 0);
						owner.A_SetInventory("DSBlueArmorClass", 0);
						owner.A_SetInventory("DSStoneArmorClass1", 0);
						owner.A_SetInventory("DSDiamondArmorClass1", 0);
						owner.A_SetInventory("DSStoneArmorClass2", 0);
						owner.A_SetInventory("DSDiamondArmorClass2", 0);
					}
				}
				CallACS("OtherVarSetDECORATE",5,CurrentArmorClass); // CurrentArmorClass
				CurrentArmorClass = CallACS("OtherVarCheckDECORATE",5); // Refresh Current Armor amt
				CallACS("OtherVarSetDECORATE",9,CurrentMaxArmor); // CurrentMaxArmor
				CurrentMaxArmor = CallACS("OtherVarCheckDECORATE",9); // Refresh Max Armor amt
				if (dvdsdebug_armortrackdisplays) Console.Printf("-_-_> CurrentArmorClass: %d, CurrentMaxArmor: %d", CurrentArmorClass, CurrentMaxArmor);
			}
		}
	}
	
		void A_PerkRespecCheckEX(int perknumber = 0, int experknumber = 0)
		{
			int refundamount;
			int CurrentUsedPerkPoints;
			int tempheldrefundpts;

			if (CallACS("PerkPtsCheckDECORATE",perknumber) > 0)
			{
				owner.A_StartSound("menu/respecperks",41,CHANF_DEFAULT,1.0,ATTN_NORM);

				CallACS("MiscVarSetDECORATE",perknumber,0); // Set back to Zero
				refundamount = CallACS("PerkPtsCheckDECORATE",perknumber);
				CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);

				CallACS("MiscVarSetDECORATE",42,refundamount,2); // takes
				CallACS("MiscVarSetDECORATE",25,refundamount,1);
				CallACS("PerkPtsSetDECORATE",perknumber,0); // Set the level of the perk to 0

				CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);
				PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points

				if (dvdsdebug_perkrespecdisplays) Console.Printf("Perk#: %d, OldValue: %d, NewValue: %d, OldOtherPerkPtsUsed: %d, OtherPerkPtsUsed: %d", perknumber, refundamount, CallACS("PerkPtsCheckDECORATE",perknumber), CurrentUsedPerkPoints, CallACS("MiscVarCheckDECORATE",42));

				if (experknumber != 0 && CallACS("PerkPtsCheckDECORATE",experknumber) > 0)
				{
					CallACS("MiscVarSetDECORATE",experknumber,0); // Set back to Zero
					refundamount = CallACS("PerkPtsCheckDECORATE",experknumber);
					CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);

					CallACS("MiscVarSetDECORATE",25,refundamount,1);
					CallACS("MiscVarSetDECORATE",42,refundamount,2);
					CallACS("PerkPtsSetDECORATE",experknumber,0);

					PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
					CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);

					if (dvdsdebug_perkrespecdisplays) Console.Printf("Perk#: %d, OldValue: %d, NewValue: %d, OldOtherPerkPtsUsed: %d, OtherPerkPtsUsed: %d", experknumber, refundamount, CallACS("PerkPtsCheckDECORATE",experknumber), CurrentUsedPerkPoints, CallACS("MiscVarCheckDECORATE",42));
				}
			}
			else
			{
				owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
		}

		void A_PerkRespecCheck(int perknumber = 0)
		{
			int refundamount;
			int CurrentUsedPerkPoints;
			int tempheldrefundpts;

			if (CallACS("PerkPtsCheckDECORATE",perknumber) > 0)
			{
				owner.A_StartSound("menu/respecperks",41,CHANF_DEFAULT,1.0,ATTN_NORM);

				CallACS("MiscVarSetDECORATE",perknumber,0); // Set back to Zero
				refundamount = CallACS("PerkPtsCheckDECORATE",perknumber);
				CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);

				CallACS("MiscVarSetDECORATE",25,refundamount,1);
				CallACS("MiscVarSetDECORATE",42,refundamount,2);
				CallACS("PerkPtsSetDECORATE",perknumber,0);

				PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
				CurrentUsedPerkPoints = CallACS("MiscVarCheckDECORATE",42);

				if (dvdsdebug_perkrespecdisplays) Console.Printf("Perk#: %d, OldValue: %d, NewValue: %d, OldOtherPerkPtsUsed: %d, OtherPerkPtsUsed: %d", perknumber, refundamount, CallACS("PerkPtsCheckDECORATE",perknumber), CurrentUsedPerkPoints, CallACS("MiscVarCheckDECORATE",42));
			}
			else
			{
				owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
		}
	
	void A_PSI1DoEffectQuickuseVimstone()
	{
		if (CallACS("MiscVarCheckDECORATE",25035) > 0)
		{
			int check = 0;
			if (owner.CountInv("LesserVimstone")) check++;
			if (owner.CountInv("GreaterVimstone")) check++;
			if (check > 0)
			{
				if (TensionLevel >= 7) { owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM); } // If Tension is Maxed, do not use an item.
				else
				{
					if (TensionLevel >= 4) // If Tension is "100" or above, prioritize a Greater Vimstone only.
					{
						if (owner.CountInv("GreaterVimstone")) 
						{
							A_SetTensionLevel(4,2,true,owner);
							owner.A_StartSound("use_greatervimstone",CHANF_DEFAULT,CHAN_BODY,1.0,ATTN_NORM);
							if (!(owner.CountInv("RandomInfiniteAmmo") || owner.CountInv("PowerInfiniteAmmo")))
							{
								owner.A_TakeInventory("GreaterVimstone",1);
							}
							else
							{
								if (random[statitem](1,10) <= 9)
								{
									owner.A_TakeInventory("GreaterVimstone",1);
								}
							}
						}
						else { owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM); }
					}
					else
					{
						if (owner.CountInv("LesserVimstone")) 
						{
							A_SetTensionLevel(2,1,true,owner);
							owner.A_StartSound("use_lesservimstone",CHANF_DEFAULT,CHAN_BODY,1.0,ATTN_NORM);
							if (!(owner.CountInv("RandomInfiniteAmmo") || owner.CountInv("PowerInfiniteAmmo")))
							{
								owner.A_TakeInventory("LesserVimstone",1);
							}
							else
							{
								if (random[statitem](1,10) <= 9)
								{
									owner.A_TakeInventory("LesserVimstone",1);
								}
							}
						}
						else 
						{
							if (owner.CountInv("GreaterVimstone")) 
							{
								A_SetTensionLevel(4,2,true,owner);
								owner.A_StartSound("use_greatervimstone",CHANF_DEFAULT,CHAN_BODY,1.0,ATTN_NORM);
								if (!(owner.CountInv("RandomInfiniteAmmo") || owner.CountInv("PowerInfiniteAmmo")))
								{
									owner.A_TakeInventory("GreaterVimstone",1);
								}
								else
								{
									if (random[statitem](1,10) <= 9)
									{
										owner.A_TakeInventory("GreaterVimstone",1);
									}
								}
							}
							else { owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM); }
						}
					}
				}
			}
			else 
			{ 
				owner.A_PrintBold("\cfNo Vimstones are in your possession!", frandom[statitem](1.028,1.2));
				owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM); 
			}
			
			CallACS("MiscVarSetDECORATE",25035,0);
		}
	}
	
	void A_PSI1DoEffectUnspecPerks()
	{
		if (CallACS("MiscVarCheckDECORATE",25205) > 0)
		{
			CallACS("MiscVarSetDECORATE",25205,0);
			owner.A_StopSound(42);
			owner.A_StartSound("DraQue/gainperk",42,CHANF_DEFAULT,frandom[statitem2](0.6,0.7),ATTN_NORM);
		}

		int perknumber;
		int tempvalue1;
		if (CallACS("MiscVarCheckDECORATE",25033) > 0)
		{
			int ifnotinperksmenu = 1;
			int UsingInGameMenuSelection = CallACS("MenuVarCheckDECORATE",1);
			int UsingInGameSubMenu = CallACS("MenuVarCheckDECORATE",4);
			int UsingInGameSubMenu2 = CallACS("MenuVarCheckDECORATE",5);
			if (!dvds_aeonptsrefund)
			{
				owner.A_PrintBold("\cfAeon point refunds disabled in settings!", frandom[statitem](1.028,1.2));
				owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
			else
			{
				if (UsingInGameSubMenu == 3)
				{
					if (UsingInGameMenuSelection == 0) owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);

					if (UsingInGameSubMenu2 == 0) // General Stat Perks
					{
						if (UsingInGameMenuSelection == 1) A_PerkRespecCheckEX(10001,10002); // LifeUp [5]
						if (UsingInGameMenuSelection == 2) A_PerkRespecCheckEX(10003,10004); // MagiUp [5]
						if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEX(10005,10006); // StamUp [5]
						if (UsingInGameMenuSelection == 4) A_PerkRespecCheckEX(10007,10008); // DodgeMore [5]
						if (UsingInGameMenuSelection == 5) A_PerkRespecCheckEX(10009,10010); // JumpMore [5]
						if (UsingInGameMenuSelection == 6) A_PerkRespecCheckEX(10011,10012); // PsycheFast [5]
						if (UsingInGameMenuSelection == 7) A_PerkRespecCheckEX(10013,10014); // RegenHPFast [5]
						if (UsingInGameMenuSelection == 8) A_PerkRespecCheckEX(10015,10016); // RegenMPFast [5]
						if (UsingInGameMenuSelection == 9) A_PerkRespecCheckEX(10017,10018); // RegenStamFast [5]
						if (UsingInGameMenuSelection == 10) A_PerkRespecCheckEX(10045,10046); // OnTheMove [5]
					}

					if (UsingInGameSubMenu2 == 1) // Character-Specific Stat Perks
					{
						if (CharacterClass == 0) // Deggaris
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheck(10004); // MagiUp EX [2]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheck(10008); // DodgeMore EX [1]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheck(10010); // JumpMore EX [2]
						}
						if (CharacterClass == 1) // Illucia
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheck(10006); // StamUp EX [2]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheck(10008); // DodgeMore EX [2]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheck(10010); // JumpMore EX [1]
						}
						if (CharacterClass == 2) // Flora
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheck(10002); // LifeUp EX [2]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheck(10012); // PsycheFast EX [2]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheck(10006); // StamUp EX [1]
						}
						if (CharacterClass == 8) // Ailish
						{
						}
						if (CharacterClass == 9) // Petra
						{
							//if (UsingInGameMenuSelection == 1) A_PerkRespecCheck(10008); // DodgeMore EX [1]
						}
					}

					if (UsingInGameSubMenu2 == 2) // Weapon Perks
					{
						if (CharacterClass == 0 || CharacterClass == 1) // Deggaris/Illucia Only
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheckEx(10051,10052); // Berserker Fit [5]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheckEx(10019,10020); // Bullet Accuracy [5]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEx(10021,10022); // Pellet Accuracy [5]
							if (UsingInGameMenuSelection == 4) A_PerkRespecCheckEx(10023,10024); // Plasma Accuracy [5]
							if (UsingInGameMenuSelection == 5) A_PerkRespecCheckEx(10025,10026); // Demolitions Expert [5]
							if (UsingInGameMenuSelection == 6) A_PerkRespecCheckEx(10047,10048); // Bottomless Magazines [5]
						}
						if (CharacterClass == 0) // Deggaris
						{
							if (UsingInGameMenuSelection == 7) A_PerkRespecCheck(10020); // Bullet Accuracy EX [2]
							if (UsingInGameMenuSelection == 8) A_PerkRespecCheck(10026); // Demolitions Expert EX [1]
							if (UsingInGameMenuSelection == 9) A_PerkRespecCheck(10029); // BFG Attunement [2]
						}
						if (CharacterClass == 1) // Illucia
						{
							if (UsingInGameMenuSelection == 7) A_PerkRespecCheck(10022); // Pellet Accuracy EX [2]
							if (UsingInGameMenuSelection == 8) A_PerkRespecCheck(10024); // Plasma Accuracy EX [1]
							if (UsingInGameMenuSelection == 9) A_PerkRespecCheck(10027); // Karasawa Attunement [2]
						}
						if (CharacterClass == 2) // Flora
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheckEx(10031,10032); // Archery Mastery [5]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheckEx(10053,10054); // Wand/Staff Mastery [5]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEx(10033,10034); // Soul Mastery [5]
							if (UsingInGameMenuSelection == 4) A_PerkRespecCheckEx(10035,10036); // Martial Arts Mastery [5]
						}
						if (CharacterClass == 8) // Ailish
						{
						}
						if (CharacterClass == 9) // Petra
						{
						}
					}

					if (UsingInGameSubMenu2 == 3) // Item Perks
					{
						if (UsingInGameMenuSelection == 1) A_PerkRespecCheck(10049); // Medicinal Prowess [5]
						if (UsingInGameMenuSelection == 2) A_PerkRespecCheck(10050); // Powerup Powerhouse [4]
						if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEx(10059,10060); // Pack Mule [5]
					}

					if (UsingInGameSubMenu2 == 4) // Misc Perks
					{
						if (CharacterClass == 0 || CharacterClass == 1) // Deggaris/Illucia Only
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheckEx(10041,10042); // Mortal Hit Survivability Blast Wave [1]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheckEx(10039,10040); // Mortal Hit Survivability Mana Recovery [1]
							if (CharacterClass == 0) // Deggaris
							{
								if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEx(10043,10044); // Mortal Hit Survivability "Death Rage" [3]
							}
							if (CharacterClass == 1) // Illucia
							{
								if (UsingInGameMenuSelection == 3) A_PerkRespecCheck(10042); // Mortal Hit Survivability Blast Wave EX [1]
							}
							if (UsingInGameMenuSelection == 4) A_PerkRespecCheckEx(10037,10038); // Mortal Hit Survivability Psyche Up [7]
							if (UsingInGameMenuSelection == 5) A_PerkRespecCheckEx(10055,10056); // Cleared of Mind [5]
							if (UsingInGameMenuSelection == 6) A_PerkRespecCheckEx(10057,10058); // Villain Killer [5]
						}

						if (CharacterClass == 2) // Flora
						{
							if (UsingInGameMenuSelection == 1) A_PerkRespecCheckEx(10039,10040); // Mortal Hit Survivability Mana Recovery [1]
							if (UsingInGameMenuSelection == 2) A_PerkRespecCheck(10040); // Mortal Hit Survivability Mana Recovery EX [1]
							if (UsingInGameMenuSelection == 3) A_PerkRespecCheckEx(10037,10038); // Mortal Hit Survivability Psyche Up [7]
							if (UsingInGameMenuSelection == 4) A_PerkRespecCheckEx(10055,10056); // Cleared of Mind [5]
							if (UsingInGameMenuSelection == 5) A_PerkRespecCheckEx(10057,10058); // Villain Killer [5]
							if (UsingInGameMenuSelection == 6) A_PerkRespecCheck(10058); // Villain Killer EX [2]
						}
						if (CharacterClass == 8) // Ailish
						{
						}
						if (CharacterClass == 9) // Petra
						{
						}
					}
				}
				else
				{
					if (CallACS("MiscVarCheckDECORATE",42) > 0)
					{
						owner.A_StartSound("menu/respecperks",41,CHANF_DEFAULT,1.0,ATTN_NORM);

						for (perknumber = 10000; perknumber < 10251; perknumber++) 
						{
							CallACS("MiscVarSetDECORATE",perknumber,0); 
							CallACS("PerkPtsSetDECORATE",perknumber,0); 
						}
	
						CallACS("MiscVarSetDECORATE",25,CallACS("MiscVarCheckDECORATE",42),1);
						PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
						owner.A_PrintBold(String.Format("\cfAll Perks Reset and Aeon Points [%d] Restored.", CallACS("MiscVarCheckDECORATE",42)), frandom[statitem](1.028,1.2));
						CallACS("MiscVarSetDECORATE",42,0);
					}
					else
					{
						owner.A_PrintBold("\cfNo Aeon Points Have Been Put Into Your Perks!", frandom[statitem](1.028,1.2));
						owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
					}

				}
			}
			
			CallACS("MiscVarSetDECORATE",25033,0);
		}

		if (CallACS("MiscVarCheckDECORATE",25034) > 0)
		{
			if (!dvds_aeonptsrefund)
			{
				owner.A_PrintBold("\cfAeon point refunds disabled in settings!", frandom[statitem](1.028,1.2));
				owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
			}
			else
			{
				int points;
				points += CallACS("MiscVarCheckDECORATE",631);
				points += CallACS("MiscVarCheckDECORATE",632);
				points += CallACS("MiscVarCheckDECORATE",633);
				points += CallACS("MiscVarCheckDECORATE",634);
				points += CallACS("MiscVarCheckDECORATE",635);
				points += CallACS("MiscVarCheckDECORATE",636);
				if (points > 0)
				{
					owner.A_StartSound("menu/respecperks",41,CHANF_DEFAULT,1.0,ATTN_NORM);
					CallACS("MiscVarSetDECORATE",31,CallACS("MiscVarCheckDECORATE",631),2); CallACS("MiscVarSetDECORATE",631,0);
					CallACS("MiscVarSetDECORATE",32,CallACS("MiscVarCheckDECORATE",632),2); CallACS("MiscVarSetDECORATE",632,0);
					CallACS("MiscVarSetDECORATE",33,CallACS("MiscVarCheckDECORATE",633),2); CallACS("MiscVarSetDECORATE",633,0);
					CallACS("MiscVarSetDECORATE",34,CallACS("MiscVarCheckDECORATE",634),2); CallACS("MiscVarSetDECORATE",634,0);
					CallACS("MiscVarSetDECORATE",35,CallACS("MiscVarCheckDECORATE",635),2); CallACS("MiscVarSetDECORATE",635,0);
					CallACS("MiscVarSetDECORATE",36,CallACS("MiscVarCheckDECORATE",636),2); CallACS("MiscVarSetDECORATE",636,0);
					PlayerAGL = CallACS("MiscVarCheckDECORATE",31);
					PlayerDEF = CallACS("MiscVarCheckDECORATE",32);
					PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
					PlayerSOR = CallACS("MiscVarCheckDECORATE",34);
					PlayerSTR = CallACS("MiscVarCheckDECORATE",35);
					PlayerTHE = CallACS("MiscVarCheckDECORATE",36);
					
					CallACS("MiscVarSetDECORATE",25,CallACS("MiscVarCheckDECORATE",43),1);
					PlayerAeonPts = CallACS("MiscVarCheckDECORATE",25); // Refreshes Aeon Points
					owner.A_PrintBold(String.Format("\cfStats Have Been Reset and Aeon Points [%d] Restored.", CallACS("MiscVarCheckDECORATE",43)), frandom[statitem](1.028,1.2));
					CallACS("MiscVarSetDECORATE",43,0);
				}
				else
				{
					owner.A_PrintBold("\cfNo Aeon Points Have Been Put Into Your Stats!", frandom[statitem](1.028,1.2));
					owner.A_StartSound("inv_fail",CHAN_BODY,CHANF_DEFAULT,1.0,ATTN_NORM);
				}
			}

			CallACS("MiscVarSetDECORATE",25034,0);
		}
	}
	
	void A_PSI1DoEffectDashControl()
	{
		int dashcooldown;
		int dashstamina, cooldownreduction, cooldownreductionlvl, cooldownreductionagl;
		int AGLCheck = PlayerAGL;
		int AGLCheckBase = 32;
		int PlayerLevelCheckBase = 25;
		
		if (owner.health > 0)
		{
			// Dash Cooldown Time
			dashcooldown = 30;
			cooldownreduction = 0;
			if (PlayerLevel >= PlayerLevelCheckBase) cooldownreductionlvl = 1 + ((PlayerLevel - PlayerLevelCheckBase) / 50); // Max of -8 [22 left]
			if (AGLCheck >= AGLCheckBase) cooldownreductionagl = (AGLCheck / AGLCheckBase); // Agility
			dashcooldown -= cooldownreductionlvl;
			dashcooldown -= cooldownreductionagl;
			dashcooldown = clamp(dashcooldown, 4, dashcooldown);
			if (owner.CountInv("SafeTeaShoes")) dashcooldown *= 0.75; // Dash-Cooldown time cut by 25%
			if (dvds_allowdashing > 2) dashcooldown *= 0.5;
			CallACS("MiscVarSetDECORATE",85,dashcooldown); // DashDelay
			CallACS("MiscVarSetDECORATE",637,dashcooldown); // dashcooldown
			
			// Dash Stamina Consumed
			if (owner.pos.z - owner.GetZAt() > 0) { dashstamina = 625; } else { dashstamina = 500; }
			if (dvds_musou_powertripmode == 1) dashstamina *= 0.2;
			if (dvds_musou_powertripmode == 2) dashstamina *= 0.1; 
			if (CharacterClass == 0) dashstamina -= (AGLCheck * 0.834);
			if (CharacterClass == 1) dashstamina -= (AGLCheck * 1.0);
			if (CharacterClass == 2) dashstamina -= (AGLCheck * 1.167);
			if (CharacterClass == 8) dashstamina -= (AGLCheck * 1.334);
			if (CharacterClass == 9) dashstamina -= (AGLCheck * 0.834);
			
			if (owner.pos.z - owner.GetZAt() > 0) { dashstamina = clamp(dashstamina, 50, dashstamina); }
																			 else { dashstamina = clamp(dashstamina, 40, dashstamina); }
			
			if (owner.CountInv("SafeTeaShoes")) dashstamina *= 0.4; // Stamina require for dash/air-dash cut by 60%
			if (owner.CountInv("FalconKnifeEarrings")) dashstamina *= 0.75;
			if (dvds_allowdashing > 2) dashstamina *= 0.5;
			CallACS("MiscVarSetDECORATE",638,dashstamina);
			
			int candash = 1;
			if (CallACS("DVDSSpecialArrayCheckDECORATE",0) > 0 || Owner.CountInv("IsUnconscious")) candash--; // If Player is "Conscious"
			if (CallACS("DVDSSpecialArrayCheckDECORATE",9) > 0 || Owner.CountInv("IsScriptFrozen")) candash--;

			CallACS("MiscVarSetDECORATE",639,candash);
			if (dvdsdebug_showdashinformation) Console.Printf("dashcooldown: %d, dashstamina: %d, candash: %d", dashcooldown, dashstamina, candash);
		}
	}
	

	// Buff/Powerup Timer Countdowns
	void A_PSI1DoEffectBuffTimerCountdown()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		int BaseTimerIncrement;
		int fadeouttic;
		if (playeractor)
		{
			if (UsingInGameMenu == 0)
			{
				owner.A_SetInventory("AetheriusTimeFreezerMenu",0);
				owner.A_SetInventory("MenuInvulnerability",0);
				
				// Light/Infared
				if (NVLightTimer > 0)
				{
					owner.A_SetInventory("NightVisionSpell",1);

					CallACS("GetBuffTimer",0,3,1);
					NVLightTimer = CallACS("GetBuffTimer",0);
				}
				else
				{
					owner.A_SetInventory("NightVisionSpell",0);
				}
				
				// Invisibility
				if (InvisibilityTimer > 0)
				{
					fadeouttic = 64;
					if (InvisibilityTimer == fadeouttic) owner.A_StartSound("buffs/invisfading",202,CHANF_DEFAULT,2.25,ATTN_NORM);
					if (InvisibilityTimer > fadeouttic) owner.A_StopSound(202);
					
					owner.A_SetInventory("InvisiblitySpell",1);

					CallACS("GetBuffTimer",1,3,1);
					InvisibilityTimer = CallACS("GetBuffTimer",1);
				}
				else
				{
					owner.A_SetInventory("InvisiblitySpell",0);
				}
				
				// Flight
				if (FlightTimer > 0)
				{
					fadeouttic = 53;
					if (FlightTimer == fadeouttic) owner.A_StartSound("buffs/flightfading",206,CHANF_DEFAULT,2.25,ATTN_NORM);
					if (FlightTimer > fadeouttic) owner.A_StopSound(206);
	
					owner.A_SetInventory("FlightSpell",1);
					CallACS("GetBuffTimer",2,3,1);
					FlightTimer = CallACS("GetBuffTimer",2);
				}
				else
				{
					owner.A_SetInventory("FlightSpell",0);
				}
				
				// Stealth
				if (StealthTimer > 0)
				{
					owner.player.cheats |= CF_NOTARGET; // Turns On

					CallACS("GetBuffTimer",3,3,1);
					StealthTimer = CallACS("GetBuffTimer",3);
				}
				else
				{
					owner.player.cheats &= ~CF_NOTARGET; // Turns Off
				}
				
				// Invulnerability
				if (InvulnerabilityTimer > 0)
				{
					if ((InvulnerabilityTimer % 70) == 69) owner.A_StartSound("buffs/invulnpulse",200,CHANF_DEFAULT,frandom[statitem](0.75,1.0),ATTN_NORM);
					fadeouttic = 106;
					if (InvulnerabilityTimer == fadeouttic) owner.A_StartSound("buffs/invulnfading",201,CHANF_DEFAULT,2.25,ATTN_NORM);
					if (InvulnerabilityTimer > fadeouttic) owner.A_StopSound(206);

					owner.A_SetInventory("InvulnerabilitySpell",1);
					owner.A_SetInventory("IsInvulnerable",1);

					CallACS("GetBuffTimer",4,3,1);
					InvulnerabilityTimer = CallACS("GetBuffTimer",4);
				}
				else
				{
					owner.A_SetInventory("InvulnerabilitySpell",0);
					owner.A_SetInventory("IsInvulnerable",0);
				}
				
				// Time Stop
				int BeatTimer;
				int TickTimer;
				double BeatVol = 0.5;
				if (TimeFreezeTimer > 0)
				{
					if (PrevTimeFreezeTimer == 0)
					{
						owner.A_StopSound(CHAN_6);
						if (dvds_timefreezesound == 0) owner.A_StartSound("TimeFreezeIn4",CHAN_6,CHANF_DEFAULT,0.875,ATTN_NONE); 
						else owner.A_StartSound("TheWorldIn",CHAN_6,CHANF_DEFAULT,0.875,ATTN_NONE); 
					}
					owner.A_SetInventory("AetheriusTimeFreezer",1);

					CallACS("GetBuffTimer",5,3,1);
					TimeFreezeTimer = CallACS("GetBuffTimer",5);

					TickTimer = CallACS("GetBuffTimer",5) % 35;
					if (TickTimer == 0 && PrevTimeFreezeTimer != 0)
					{
						owner.A_StopSound(CHAN_6); 
						owner.A_StartSound("TimeStopTick",CHAN_6,CHANF_DEFAULT,frandom[statitem2](0.80,1.20),ATTN_NONE); 
					}
					if (dvds_timefreezesound == 0) 
					{
						if (TimeFreezeTimer >= 64 && TimeFreezeTimer <= 66) 
						{
							owner.A_StopSound(CHAN_7); 
							owner.A_StartSound("TimeFreezeOut4",CHAN_7,CHANF_DEFAULT,0.875,ATTN_NONE); 
						}
						else
						{
							if (TimeFreezeTimer > 66)
							{
								BeatTimer = TimeFreezeTimer % 120;
								BeatVol = 0.5;
								if (CharacterClass == 2)
								{
									if (Owner.CountInv("NormalHealth")) { BeatTimer = TimeFreezeTimer % 120; BeatVol = 0.5; }
									else if (Owner.CountInv("DecentHealth")) { BeatTimer = TimeFreezeTimer % 100; BeatVol = 0.625; }
									else if (Owner.CountInv("LowHealth")) { BeatTimer = TimeFreezeTimer % 80; BeatVol = 0.775; }
									else if (Owner.CountInv("CriticalHealth")) { BeatTimer = TimeFreezeTimer % 60; BeatVol = 1.0; }
								}
								else
								{
									if (Owner.CountInv("NormalHealth")) { BeatTimer = TimeFreezeTimer % 40; BeatVol = 0.5; }
									else if (Owner.CountInv("DecentHealth")) { BeatTimer = TimeFreezeTimer % 33; BeatVol = 0.625; }
									else if (Owner.CountInv("LowHealth")) { BeatTimer = TimeFreezeTimer % 27; BeatVol = 0.775; }
									else if (Owner.CountInv("CriticalHealth")) { BeatTimer = TimeFreezeTimer % 20; BeatVol = 1.0; }
								}
								//Console.Printf("BeatTimer: %d", BeatTimer);
								if (BeatTimer == 0)
								{
									owner.A_StopSound(33);
									owner.A_StartSound("TimeFreezeLoop4",CHANF_DEFAULT,33,BeatVol,ATTN_NONE); 
								}
							}
						}
					}
					else
					{
						if (TimeFreezeTimer >= 48 && TimeFreezeTimer <= 50) 
						{
							owner.A_StopSound(CHAN_7); 
							owner.A_StartSound("TheWorldOut",CHAN_7,CHANF_DEFAULT,0.875,ATTN_NONE); 
						}
						else
						{
							if (TimeFreezeTimer > 50)
							{
								BeatTimer = TimeFreezeTimer % 120;
								BeatVol = 0.5;
								if (CharacterClass == 2)
								{
									if (Owner.CountInv("NormalHealth")) { BeatTimer = TimeFreezeTimer % 120; BeatVol = 0.5; }
									else if (Owner.CountInv("DecentHealth")) { BeatTimer = TimeFreezeTimer % 100; BeatVol = 0.625; }
									else if (Owner.CountInv("LowHealth")) { BeatTimer = TimeFreezeTimer % 80; BeatVol = 0.775; }
									else if (Owner.CountInv("CriticalHealth")) { BeatTimer = TimeFreezeTimer % 60; BeatVol = 1.0; }
								}
								else
								{
									if (Owner.CountInv("NormalHealth")) { BeatTimer = TimeFreezeTimer % 40; BeatVol = 0.5; }
									else if (Owner.CountInv("DecentHealth")) { BeatTimer = TimeFreezeTimer % 33; BeatVol = 0.625; }
									else if (Owner.CountInv("LowHealth")) { BeatTimer = TimeFreezeTimer % 27; BeatVol = 0.775; }
									else if (Owner.CountInv("CriticalHealth")) { BeatTimer = TimeFreezeTimer % 20; BeatVol = 1.0; }
								}
								//Console.Printf("BeatTimer: %d", BeatTimer);
								if (BeatTimer == 0)
								{
									owner.A_StopSound(33);
									owner.A_StartSound("TimeFreezeLoop4",CHANF_DEFAULT,33,BeatVol,ATTN_NONE); 
								}
							}
						}
					}
				}
				else
				{
					owner.A_SetInventory("AetheriusTimeFreezer",0);
				}
				PrevTimeFreezeTimer = TimeFreezeTimer;
				
				// Fear Aura Effects
				if (FearAuraTimer > 0)
				{
					owner.A_SetInventory("PowerFrightener",1);

					CallACS("GetBuffTimer",6,3,1);
					FearAuraTimer = CallACS("GetBuffTimer",6);
				}
				else
				{
					owner.A_SetInventory("PowerFrightener",0);
				}
				
				// Divine Avatar Effects
				if (DivineAvatarTimer > 0)
				{
					fadeouttic = 62;
					if (DivineAvatarTimer == fadeouttic) owner.A_StartSound("buffs/divineavatarfading",205,CHANF_DEFAULT,2.25,ATTN_NORM);
					if (DivineAvatarTimer > fadeouttic) owner.A_StopSound(205);

					owner.A_SetInventory("DivineAvatarDoubleFiringSpeed",1);
					owner.A_SetInventory("DivineAvatarHighJump",1);
					CallACS("GetBuffTimer",7,3,1);
					DivineAvatarTimer = CallACS("GetBuffTimer",7);
				}
				else
				{
					owner.A_SetInventory("DivineAvatarDoubleFiringSpeed",0);
					owner.A_SetInventory("DivineAvatarHighJump",0);
					CallACS("MiscVarSetDECORATE",14,0);
				}
				
				// Speader Aura Lv. 1 Effects
				if (SpreadAura2Timer > 0)
				{
					CallACS("GetBuffTimer",8,1,0);
					SpreadAura1Timer = CallACS("GetBuffTimer",8);

					owner.A_SetInventory("SpreaderAura1",0);
				}
				else
				{
					if (SpreadAura1Timer > 0)
					{
						fadeouttic = 53;
						if (SpreadAura1Timer == fadeouttic) owner.A_StartSound("buffs/spread1fading",207,CHANF_DEFAULT,2.25,ATTN_NORM);
						if (SpreadAura1Timer > fadeouttic) owner.A_StopSound(207);

						owner.A_SetInventory("SpreaderAura1",1);

						CallACS("GetBuffTimer",8,3,1);
						SpreadAura1Timer = CallACS("GetBuffTimer",8);
					}
					else
					{
						owner.A_SetInventory("SpreaderAura1",0);
					}
				}
				
				// Speader Aura Lv. 2 Effects
				if (SpreadAura2Timer > 0)
				{
					fadeouttic = 62;
					if (SpreadAura2Timer > fadeouttic) owner.A_StopSound(207);
					if (SpreadAura2Timer == fadeouttic) owner.A_StartSound("buffs/spread2fading",207,CHANF_DEFAULT,2.25,ATTN_NORM);

					owner.A_SetInventory("SpreaderAura2",1);

					CallACS("GetBuffTimer",9,3,1);
					SpreadAura2Timer = CallACS("GetBuffTimer",9);
				}
				else
				{
					owner.A_SetInventory("SpreaderAura2",0);
				}
				
				// Oomph Effects
				if (DQOomphTimer > 0) 
				{
					fadeouttic = 50;
					if (DQOomphTimer > fadeouttic) owner.A_StopSound(207);
					if (DQOomphTimer == fadeouttic) owner.A_StartSound("buffs/dqbufffading",207,CHANF_DEFAULT,2.25,ATTN_NORM);

					CallACS("GetBuffTimer",10,3,1); 
					DQOomphTimer = CallACS("GetBuffTimer",10);
					//
				}
				
				// Buff Effects
				if (DQBuffTimer > 0) 
				{
					fadeouttic = 50;
					if (DQBuffTimer > fadeouttic) owner.A_StopSound(209);
					if (DQBuffTimer == fadeouttic) owner.A_StartSound("buffs/dqbufffading2",209,CHANF_DEFAULT,2.25,ATTN_NORM);

					CallACS("GetBuffTimer",11,3,1); 
					DQBuffTimer = CallACS("GetBuffTimer",11);
				}
				
				// Acceleratle Effects
				if (DQAcceleratleTimer > 0) 
				{
					fadeouttic = 50;
					if (DQAcceleratleTimer > fadeouttic) owner.A_StopSound(210);
					if (DQAcceleratleTimer == 50) owner.A_StartSound("buffs/dqbufffading3",210,CHANF_DEFAULT,2.25,ATTN_NORM);

					CallACS("GetBuffTimer",12,3,1); 
					DQAcceleratleTimer = CallACS("GetBuffTimer",12);
				}
				
				// Blunt Effects
				if (DQBluntTimer > 0)
				{
					fadeouttic = 57;
					if (DQBluntTimer > fadeouttic) owner.A_StopSound(211);
					if (DQBluntTimer == fadeouttic) owner.A_StartSound("buffs/dqdebufffading",211,CHANF_DEFAULT,2.25,ATTN_NORM);

					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",13,3,BaseTimerIncrement);
					DQBluntTimer = CallACS("GetBuffTimer",13);
				}
				
				// Sap Effects
				if (DQSapTimer > 0)
				{
					fadeouttic = 57;
					if (DQSapTimer > fadeouttic) owner.A_StopSound(218);
					if (DQSapTimer == fadeouttic) owner.A_StartSound("buffs/dqdebufffading2",218,CHANF_DEFAULT,2.25,ATTN_NORM);

					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",14,3,BaseTimerIncrement);
					DQSapTimer = CallACS("GetBuffTimer",14);
				}
				
				// Deceleratle Effects
				if (DQDeceleratleTimer > 0)
				{
					fadeouttic = 57;
					if (DQDeceleratleTimer > fadeouttic) owner.A_StopSound(219);
					if (DQDeceleratleTimer == fadeouttic) owner.A_StartSound("buffs/dqdebufffading3",219,CHANF_DEFAULT,2.25,ATTN_NORM);

					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",15,3,BaseTimerIncrement);
					DQDeceleratleTimer = CallACS("GetBuffTimer",15);
				}
				
				// Poison Effects
				if (PoisonedTimer > 0)
				{
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",16,3,BaseTimerIncrement);
					PoisonedTimer = CallACS("GetBuffTimer",16);
				}
				
				// Corrosion Effects
				if (CorrosionTimer > 0)
				{
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",17,3,BaseTimerIncrement);
					CorrosionTimer = CallACS("GetBuffTimer",17);
				}
				
				// Fatigue Effects
				if (FatigueTimer > 0)
				{
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",18,3,BaseTimerIncrement);
					FatigueTimer = CallACS("GetBuffTimer",18);
				}
				
				// Blind Effects
				if (BlindTimer > 0)
				{
					CallACS("MiscVarSetDECORATE",248,1,1);
					if (CallACS("MiscVarCheckDECORATE",248) == 1)
					{
						owner.A_StartSound("misc/blinded",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM);
						if (CharacterClass == 2) { owner.A_StopSound(CHAN_VOICE); owner.A_StartSound("FloraGotBlinded",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); }
					}
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",19,3,BaseTimerIncrement);
					BlindTimer = CallACS("GetBuffTimer",19);
				}
				else
				{
					CallACS("MiscVarSetDECORATE",248,0,0);
				}
				
				// Sleep Effects
				if (SleepTimer > 0)
				{
					CallACS("MiscVarSetDECORATE",249,1,1);
					if (CallACS("MiscVarCheckDECORATE",249) == 1)
					{
						owner.A_StartSound("DraQue/fallasleep",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM);
						if (CharacterClass == 2) { owner.A_StopSound(CHAN_VOICE); owner.A_StartSound("FloraFallAsleep",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); }
					}
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",20,3,BaseTimerIncrement);
					SleepTimer = CallACS("GetBuffTimer",20);
				}
				else
				{
					CallACS("MiscVarSetDECORATE",249,0,0);
				}
				
				// Silence Effects
				if (SilenceTimer > 0)
				{
					CallACS("MiscVarSetDECORATE",270,1,1);
					if (CallACS("MiscVarCheckDECORATE",270) == 1)
					{
						owner.A_StartSound("DraQue/sealed",CHAN_5,CHANF_DEFAULT,1.0,ATTN_NORM);
						//if (CharacterClass == 2) { owner.A_StopSound(CHAN_VOICE); owner.A_StartSound("FloraSpSealed",CHAN_VOICE,CHANF_DEFAULT,1.0,ATTN_NORM); }
					}
					BaseTimerIncrement = 1; 
					if (owner.CountInv("EvenstarNecklace") && random[statitem](1,6) == 1) BaseTimerIncrement += 1;
					if (owner.CountInv("BalrogRing") && random[statitem](1,12) == 1) BaseTimerIncrement += 1;
					if (DivineAvatarTimer > 0) BaseTimerIncrement *= 2;

					CallACS("GetBuffTimer",21,3,BaseTimerIncrement);
					SilenceTimer = CallACS("GetBuffTimer",21);
				}
				else
				{
					CallACS("MiscVarSetDECORATE",270,0,0);
				}
				
				// RadSphere Effects
				if (RadSuitTimer > 0)
				{
					fadeouttic = 75;
					if (RadSuitTimer > fadeouttic) owner.A_StopSound(203);
					if (RadSuitTimer == fadeouttic) owner.A_StartSound("buffs/bioshieldfading",203,CHANF_DEFAULT,2.25,ATTN_NORM);

					if (ClassicDoomType == 4) owner.A_SetInventory("AetheriusPowerMask",1); else owner.A_SetInventory("PowerIronFeet",1);

					CallACS("GetBuffTimer",22,3,1);
					RadSuitTimer = CallACS("GetBuffTimer",22);
				}
				else
				{
					if (ClassicDoomType == 4) owner.A_SetInventory("AetheriusPowerMask",0); else owner.A_SetInventory("PowerIronFeet",0);
				}
				
				// Berserk Effects
				if (BerserkTimer > 0)
				{
					fadeouttic = 48;
					if (BerserkTimer > fadeouttic) owner.A_StopSound(204);
					if (BerserkTimer == fadeouttic) owner.A_StartSound("buffs/berserkfading",204,CHANF_DEFAULT,2.25,ATTN_NORM);

					owner.A_SetInventory("AetheriusPowerStrength", 1);
					
					CallACS("GetBuffTimer",23,3,1);
					BerserkTimer = CallACS("GetBuffTimer",23);
				}
				else
				{
					owner.A_SetInventory("AetheriusPowerStrength",0);
				}
				
				// Regen Effects
				if (RegenerationTimer > 0) 
				{
					CallACS("GetBuffTimer",24,3,1);
					RegenerationTimer = CallACS("GetBuffTimer",24);
				}
				
				// Arcana Force Effects
				if (CallACS("GetBuffTimer",25) > 0) 
				{
					CallACS("GetBuffTimer",25,3,1); 
				}
				
				// Desperado Damsel Effects
				if (CallACS("GetBuffTimer",26) > 0) 
				{ 
					CallACS("GetBuffTimer",26,3,1); 
					nm = "PowerHitscanBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 1);
					nm = "PowerChristinaBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 1);
					nm = "PowerAccuracyBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 1);
				}
				else
				{
					nm = "PowerHitscanBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 0);
					nm = "PowerChristinaBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 0);
					nm = "PowerAccuracyBoost"; APPackCheck = nm; owner.A_SetInventory(APPackCheck, 0);
				}
				
				// GoE?? Effects
				if (GoETimer > 0) 
				{
					// (GoE is intended as a "permanent buff" once activated. To disable this and make it time elapsed, uncomment the line below)

					// CallACS("GetBuffTimer",129,3,1); 
					// GoETimer = CallACS("GetBuffTimer",129);
				}
			}
			else
			{
				if (!owner.CountInv("AetheriusTimeFreezer")) owner.A_SetInventory("AetheriusTimeFreezerMenu",1);
				owner.A_SetInventory("MenuInvulnerability",1);
			}
		}
	}
	
	override void ModifyDamage(int damage, Name damageType, out int newdamage, bool passive)
	{
		let weapon = owner.player.ReadyWeapon;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);

		int InvisiblityLevel = 0;
		double InvisFactor = 1.0;
		double InvisBaseAmt = 1.0;
		CallACS("MiscVarSetDECORATE",15,0);
		if (Owner.CountInv("PowerInvisibility") || Owner.CountInv("InvisiblitySpell"))
		{
			if (random[statitem](1,100) <= 35)
			{
				InvisiblityLevel++;
				if (random[statitem](1,100) <= 25)
				{
					InvisiblityLevel++;
					if (random[statitem](1,100) <= 20)
					{
						InvisiblityLevel++;
						if (random[statitem](1,100) <= 10)
						{
							InvisiblityLevel++;
						}
					}
				}
			}
		}
		CallACS("MiscVarSetDECORATE",15,InvisiblityLevel);
		int InvisIgnored = random[statitem](1,3);

		// ******************
		// ******************
		// **Offensive Code**
		// ******************
		// ******************
		if (!passive && damage > 0) // If the owner [usually the player] of the item is the ATTACKER
		{
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czPlayerStatItem input [STEP 5 (\cwsuper.DamageMobj\cz)]\c-: \cydmg = %d\c-)", damage);

			// Check Level
			double LVLfactor = 1.0; double LVLfactorclamp = 10.00;
			LVLFactor = 1.00 + (PlayerLevel * 0.0025); // 1 LVL = +0.25% Damage Dealt
			if (LVLfactor > LVLfactorclamp) LVLfactor = LVLfactorclamp;

			// Check Strength
			double STRfactor = 1.0; double STRfactorclamp = 11.00;
			if (!(damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight'))
			{
				if (CharacterClass == 0) STRfactor = (PlayerSTR * 0.003334);
				if (CharacterClass == 1) STRfactor = (PlayerSTR * 0.0025);
				if (CharacterClass == 2) STRfactor = (PlayerSTR * 0.001667);
				if (CharacterClass == 8) STRfactor = (PlayerSTR * 0.0015);
				if (CharacterClass == 9) STRfactor = (PlayerSTR * 0.003625);
				STRfactor += 1.00;
			}
			if (STRfactor > STRfactorclamp) STRfactor = STRfactorclamp;

			// Check Sorcery
			double SORfactor = 1.0; double SORfactorclamp = 11.00;
			if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight')
			{
				if (CharacterClass == 0) SORfactor = (PlayerSOR * 0.001667);			// Deggaris	(1 SOR = +0.3334~% Damage Dealt)
				if (CharacterClass == 1) SORfactor = (PlayerSOR * 0.0025);					// Illucia	(1 SOR = +0.5% Damage Dealt)
				if (CharacterClass == 2) SORfactor = (PlayerSOR * 0.003334);			// Flora		(1 SOR = +0.6667~% Damage Dealt)
				if (CharacterClass == 8) SORfactor = (PlayerSOR * 0.003625);				// Ailish		(1 SOR = +0.725% Damage Dealt)
				if (CharacterClass == 9) SORfactor = (PlayerSOR * 0.0015);					// Petra		(1 SOR = +0.3% Damage Dealt)
				SORfactor += 1.00;
			}
			if (SORfactor > SORfactorclamp) SORfactor = SORfactorclamp;

			// "Power Trip" Mode
			double MusouFactor = 1.0;
			if (dvds_musou_powertripmode == 1) MusouFactor *= 5.0;
			if (dvds_musou_powertripmode == 2) MusouFactor *= 10.0;
			
			// Cursed Shield
			double CursedShieldFactor = 1.0;
			if (CharacterClass == 2 && Owner.CountInv("RuinousShield")) CursedShieldFactor *= 0.390625;
			
			// "MagiUp" and "Wand/Staff Mastery" Perks [Magic ONLY]
			double MagiUpATKFactor = 1.0;
			double WandMasteryATKFactor = 1.0;
			if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight')
			{
				MagiUpATKFactor = 1.00 + ((MagiUpPerkLevel * 0.05) + (MagiUpEXPerkLevel * 0.125)); 
				WandMasteryATKFactor = 1.00 + ((WandMasteryPerkLevel * 0.0625) + (WandMasteryEXPerkLevel * 0.15625)); 
			}
			
			// "StamUp" Perk [Melee Oriented Attacks]
			double StamUpATKFactor = 1.0;
			if (damageType == 'Melee' || 
					damageType == 'Trample' || 
					damageType == 'Stomp' || 
					damageType == 'Sceptre' || 
					damageType == 'Gauntlets' || 
					damageType == 'Fist' || 
					damageType == 'Kick' || 
					damageType == 'Chainsaw' )
			{
				StamUpATKFactor = 1.00 + ((StamUpPerkLvl * 0.05) + (StamUpEXPerkLvl * 0.125)); 
			}
			
			// Death Rage
			double DeathRageFactor = 1.0;
			if (DeathRageTimer > 0)
			{
				if (DeathRagePerkLvl <= 1) DeathRageFactor = 2.5;
				if (DeathRagePerkLvl == 2) DeathRageFactor = 3.75;
				if (DeathRagePerkLvl >= 3) DeathRageFactor = 5.0;
			}
			
			// Strife's "Accuracy" Upgrades
			double StrifeAccuracyFactor = 1.0;
			StrifeAccuracyFactor = 1.00 + (StrifeAccuLvl * 0.01); // up to +10%
			
			// Doomspell Bonuses
			double DoomSpellFactor = 1.0;
			if (CharacterClass == 0) // Deggaris
			{
				if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') DoomSpellFactor = 1.08334;
				if (damageType == 'Fire') DoomSpellFactor = 1.55;
				if (damageType == 'Holy') DoomSpellFactor = 1.75;
				if (damageType == 'Ice') DoomSpellFactor = 1.0;
				if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') DoomSpellFactor = 1.0;
				if (damageType == 'Acid') DoomSpellFactor = 2.1;
				if (damageType == 'PoisonElemental') DoomSpellFactor = 2.1;
			}
			if (CharacterClass == 1) // Illucia
			{
				if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') DoomSpellFactor = 1.16667;
				if (damageType == 'Fire') DoomSpellFactor = 1.0;
				if (damageType == 'Holy') DoomSpellFactor = 0.875;
				if (damageType == 'Ice') DoomSpellFactor = 2.1;
				if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') DoomSpellFactor = 2.1;
				if (damageType == 'Acid') DoomSpellFactor = 1.55;
				if (damageType == 'PoisonElemental') DoomSpellFactor = 1.55;
			}
			if (CharacterClass == 2) // Flora
			{
				if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') DoomSpellFactor = 1.25;
				if (damageType == 'Fire') DoomSpellFactor = 2.1;
				if (damageType == 'Holy') DoomSpellFactor = 2.5;
				if (damageType == 'Ice') DoomSpellFactor = 1.55;
				if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') DoomSpellFactor = 1.55;
				if (damageType == 'Acid') DoomSpellFactor = 1.0;
				if (damageType == 'PoisonElemental') DoomSpellFactor = 1.0;
			}
			if (CharacterClass == 8) // Ailish
			{
				if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') DoomSpellFactor = 1.25;
				if (damageType == 'Fire') DoomSpellFactor = 2.1;
				if (damageType == 'Holy') DoomSpellFactor = 2.125;
				if (damageType == 'Ice') DoomSpellFactor = 2.1;
				if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') DoomSpellFactor = 1.55;
				if (damageType == 'Acid') DoomSpellFactor = 1.0;
				if (damageType == 'PoisonElemental') DoomSpellFactor = 1.0;
			}
			if (CharacterClass == 9) // Petra
			{
				if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') DoomSpellFactor = 1.08334;
				if (damageType == 'Fire') DoomSpellFactor = 1.55;
				if (damageType == 'Holy') DoomSpellFactor = 2.375;
				if (damageType == 'Ice') DoomSpellFactor = 1.55;
				if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') DoomSpellFactor = 1.55;
				if (damageType == 'Acid') DoomSpellFactor = 1.0;
				if (damageType == 'PoisonElemental') DoomSpellFactor = 1.0;
			}
			
			// Invisibility [OFFENSIVE]
			double InvisFactor = 1.0;
			double InvisBaseAmt = 1.125;
			
			if (InvisiblityLevel >= 1) InvisFactor *= InvisBaseAmt;
			if (InvisiblityLevel >= 2) InvisFactor *= InvisBaseAmt;
			if (InvisiblityLevel >= 3) InvisFactor *= InvisBaseAmt;
			if (InvisiblityLevel >= 4) InvisFactor *= InvisBaseAmt;

			if (playeractor) playeractor.InvisNeedleBonus = InvisFactor;
			
			// Dashing Bonus
			double DashingFactor = 1.0;
			if (DashTimer > 0)
			{
				if (damageType == 'Sceptre') DashingFactor = 1.75;
				if (damageType == 'Gauntlets') DashingFactor = 1.625;
				if (damageType == 'Fist' || damageType == 'Kick') DashingFactor = 1.5;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp' || damageType == 'Chainsaw') DashingFactor = 1.25;
			}
			
			// Uppercut Bonus
			double UppercutFactor = 1.0;
			if (damageType == 'Fist' || damageType == 'Gauntlets')
			{
				if (Owner.CountInv("UppercutATKBonus") == 1) UppercutFactor = 1.25;
				if (Owner.CountInv("UppercutATKBonus") == 2) UppercutFactor = 1.625;
			}

			// Landing Bonus
			double LandingFactor = 1.0;
			if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp' || damageType == 'Sceptre' || damageType == 'Gauntlets' || damageType == 'Fist' || damageType == 'Kick' || damageType == 'Chainsaw')
			{
				if (landdmgbonus == 1) LandingFactor = 2.0;
				if (landdmgbonus == 2) LandingFactor = 3.5;
				if (landdmgbonus == 3) LandingFactor = 6.5625;
				if (landdmgbonus == 4) LandingFactor = 13.9453125;
			}

			// Tension Level [OFFENSIVE]
			double TensionFactor = 1.0;
			int CanUseTension = dvds_allowtension;
			if (CanUseTension > 0)
			{
				if (TensionLevel == 1) TensionFactor = 1.7;		// "5" Tension
				if (TensionLevel == 2) TensionFactor = 3;			// "20" Tension
				if (TensionLevel == 3) TensionFactor = 5;			// "50" Tension
				if (TensionLevel == 4) TensionFactor = 7.5;		// "100" Tension
				if (TensionLevel == 5) TensionFactor = 11.25;	// "250" Tension
				if (TensionLevel == 6) TensionFactor = 17.5;	// "500" Tension
				if (TensionLevel == 7) TensionFactor = 25;		// "1000" Tension
			}
			
			// Flora Armor
			double FloraArmorFactor = 1.0;
			if (CharacterClass == 2)
			{
				if (Owner.CountInv("EvenstarNecklace")) 
				{
					if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') FloraArmorFactor += 0.2;
					if (damageType == 'Fire') FloraArmorFactor += 0.5;
					if (damageType == 'Ice') FloraArmorFactor += 0.5;
					if (damageType == 'Thunder' || damageType == 'Electric' || damageType == 'Lightning' || damageType == 'Shock') FloraArmorFactor += 0.5;
					if (damageType == 'Holy') FloraArmorFactor += 0.5;
				}
				if (Owner.CountInv("DoveRibbon")) 
				{
					if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight') FloraArmorFactor += 0.2;
				}
				if (Owner.CountInv("FalconKnifeEarrings"))
				{
					FloraArmorFactor *= 2.0;
					if (damageType == 'Gauntlets' || damageType == 'Fist' || damageType == 'Kick') FloraArmorFactor *= 1.3333;
				}
			}
			
			// The One Ring [OFFENSIVE]
			double RingFactor = 1.0;
			if (Owner.CountInv("TheOneRing")) RingFactor = 2.5;

			// DQ Buffs [OFFENSIVE]
			double DQBuffFactor = 1.0;
			if (DQOomphTimer > 0) DQBuffFactor *= 2.0; // Oomph
			if (DQBluntTimer > 0) DQBuffFactor *= 0.5; // Blunt
			if (BlindTimer > 0) // Blind
			{
				if (random[statitem](1,16) == 1) DQBuffFactor *= 0.2; else DQBuffFactor *= 0.8; 
			}

			// Divine Avatar [OFFENSIVE]
			double DivineAvatarFactor = 1.0;
			if (DivineAvatarTimer > 0) DivineAvatarFactor = 4.0;

			// GoE? [OFFENSIVE]
			double GoEFactor = 1.0;
			if (GoETimer > 0) GoEFactor = 10.0;

			double TOTALFactor = LVLfactor 
													* STRfactor 
													* SORfactor 
													* MusouFactor 
													* MagiUpATKFactor 
													* WandMasteryATKFactor 
													* StamUpATKFactor 
													* DeathRageFactor 
													* StrifeAccuracyFactor 
													* CursedShieldFactor
													* DoomSpellFactor
													* InvisFactor
													* DashingFactor
													* UppercutFactor
													* LandingFactor
													* TensionFactor
													* FloraArmorFactor
													* RingFactor
													* DQBuffFactor
													* DivineAvatarFactor
													* GoEFactor;
			newdamage = max(1, ApplyDamageFactors(GetClass(), damageType, damage, damage * TOTALFactor));

			if (playeractor) playeractor.playoutputdmg = newdamage;
			if (dvdsdebug_actordmgdisplays && newdamage > 0) 
			{
				Console.Printf("    (\czPlayerStatItem Input [STEP 6 - Alter Player's Dmg]\c-: \cwDmgType:\c- \cw%s\c-, input: \cyolddmg\c- / \cynewdmg\c- = \cy%d\c- / \cy%d\c-, \caTOTALFactor\c- = \ca%.8f\c-, LVLFactor [%d] = %.8f, STRfactor [%d] = %.8f, SORfactor [%d] = %.8f, MusouFactor = %.8f, StamUpATKFactor = %.8f, MagiUpATKFactor = %.8f, WandMasteryATKFactor = %.8f, DeathRageFactor = %.8f, StrifeAccuracyFactor = %.8f, CursedShieldFactor = %.8f, DoomSpellFactor = %.8f, InvisFactor = %.8f, DashingFactor = %.8f, UppercutFactor = %.8f, LandingFactor = %.8f, TensionFactor = %.8f, FloraArmorFactor = %.8f, RingFactor = %.8f, DQBuffFactor = %.8f, DivineAvatarFactor = %.8f, GoEFactor = %.8f)", 
				damageType, damage, newdamage, TOTALFactor, 
				PlayerLevel, LVLFactor, PlayerSTR, STRfactor, PlayerSOR, SORfactor, 
				MusouFactor, StamUpATKFactor, MagiUpATKFactor, 
				WandMasteryATKFactor, DeathRageFactor, StrifeAccuracyFactor, 
				CursedShieldFactor, DoomSpellFactor, 
				InvisFactor, DashingFactor, UppercutFactor, 
				LandingFactor, TensionFactor, FloraArmorFactor, 
				RingFactor, DQBuffFactor, DivineAvatarFactor, GoEFactor);
			}
		}

		// ******************
		// ******************
		// **Defensive Code**
		// ******************
		// ******************
		if (passive && damage > 0) // If the owner [usually the player] of the item is the DEFENDER
		{
			int predmg = damage;
			if (playeractor) predmg = playeractor.mobjdmg;
			double factorchange = 1.00;
			if (predmg > 0) factorchange = 1.0 * damage / predmg;
			if (dvdsdebug_playerdmgdisplays) Console.Printf("    (\cz[STEP 6 (\cwsuper.DamageMobj\cz)] player-StatItem input\c-: \cypredmg\c- / \cydamage\c- = \cy%d\c- /  \cy%d\c-, \cafactorchange\c- = \ca%.8f\c-)", predmg, damage, factorchange);

			// ****************************************
			// *DEFENSE THAT CAN BE IGNORED GOES FIRST*
			// ****************************************
			// Check Level
			double LVLfactor = 1.0; double LVLfactorclamp = 0.05;
			LVLFactor = 1.00 - (PlayerLevel * 0.00125);	// 1 LVL = -0.125% Damage Taken
			if (LVLfactor < LVLfactorclamp) LVLfactor = LVLfactorclamp;

			// Check Defense
			double DEFfactor = 1.0; double DEFfactorclamp = 0.05;
			if (!(damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight'))
			{
				if (CharacterClass == 0) DEFfactor = -(PlayerDEF * 0.003334);			// Deggaris	(1 DEF = -0.6667~% Physical Damage)
				if (CharacterClass == 1) DEFfactor = -(PlayerDEF * 0.0025);					// Illucia	(1 DEF = -0.5000% Physical Damage)
				if (CharacterClass == 2) DEFfactor = -(PlayerDEF * 0.001667);			// Flora		(1 DEF = -0.3334~% Physical Damage)
				if (CharacterClass == 8) DEFfactor = -(PlayerDEF * 0.0015);					// Ailish		(1 DEF = -0.3000% Physical Damage)
				if (CharacterClass == 9) DEFfactor = -(PlayerDEF * 0.003625);				// Petra		(1 DEF = -0.7250% Physical Damage)
				DEFfactor += 1.0;
			}
			if (DEFfactor < DEFfactorclamp) DEFfactor = DEFfactorclamp;

			// Check Therapeusis
			double THEfactor = 1.0; double THEfactorclamp = 0.05;
			if (damageType == 'Magic' || damageType == 'Eldritch' || damageType == 'Deadlight')
			{
				if (CharacterClass == 0) THEfactor = -(PlayerTHE * 0.001667);			// Deggaris	(1 THE = -0.3334~% Magic Damage)
				if (CharacterClass == 1) THEfactor = -(PlayerTHE * 0.0025);					// Illucia	(1 THE = -0.5000% Magic Damage)
				if (CharacterClass == 2) THEfactor = -(PlayerTHE * 0.003334);			// Flora		(1 THE = -0.6667~% Magic Damage)
				if (CharacterClass == 8) THEfactor = -(PlayerTHE * 0.003625);				// Ailish		(1 THE = -0.7250% Magic Damage)
				if (CharacterClass == 9) THEfactor = -(PlayerTHE * 0.0015);					// Petra		(1 THE = -0.3000% Magic Damage)
				THEfactor += 1.0;
			}
			if (THEfactor < THEfactorclamp) THEfactor = THEfactorclamp;
			
			// "LifeUp" Perk
			double LifeUpDEFFactor = 1.00;
			LifeUpDefFactor = 1.00 - ((LifeUpPerkLvl * 0.05) + (LifeUpExPerkLvl * 0.125)); 

			// "Demolition Expert" Perk
			double DemoExpertFactor = 1.00;
			if (damageType == 'Explosive' ||
					damageType == 'ExplosiveImpact' ||
					damageType == 'CC_Firecracker')
			{
				DemoExpertFactor = 1.00 - ((DemolitionsExpertPerkLevel * frandompick[demordfactor](0.105,0.1575,0.21)) - (DemolitionsExpertEXPerkLevel * frandompick[demordfactor2](0.2625,0.39375,0.525))); 
				if (DemoExpertFactor < 0.025) DemoExpertFactor = 0.025;
			}

			// Strife's "Stamina" Upgrades
			double StrifeStaminaFactor = 1.0;
			StrifeStaminaFactor = 1.00 - (StrifeStamLvl * 0.01); // up to -10%
			
			// Invisibility [DEFENSIVE] [if ignored] (33% Chance)
			InvisFactor = 1.0;
			InvisBaseAmt = 0.8889;
			if (InvisIgnored == 3)
			{
				if (InvisiblityLevel >= 1) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 2) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 3) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 4) InvisFactor *= InvisBaseAmt;
			}
			
			// Uppercut Bonus
			double BerserkFactorblock = frandompick[statitem2](0.667,0.75,0.834);

			double UppercutFactor = 1.0;
			if (Owner.CountInv("UppercutDEFBonus") == 1) UppercutFactor = 0.80;
			if (Owner.CountInv("UppercutDEFBonus") == 2) UppercutFactor = 0.615;
			if (UppercutFactor < 1.00) UppercutFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125)));
			if (UppercutFactor < 1.00 && A_CheckBerserk()) UppercutFactor *= BerserkFactorblock;

			// Kicking Bonus
			BerserkFactorblock = frandompick[statitem2](0.5,0.667,0.75);
			double MartArtFactor = 1.0;
			if (Owner.CountInv("MartArtsMaster") == 1)
			{
				MartArtFactor *= 0.975; // -2.5%
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') MartArtFactor *= 0.9875;
			}
			if (Owner.CountInv("MartArtsMaster") == 2)
			{
				MartArtFactor *= 0.9375; // -6.25%
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') MartArtFactor *= 0.96875;
			}
			if (Owner.CountInv("MartArtsMaster") == 3)
			{
				MartArtFactor *= 0.85; // -15%
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') MartArtFactor *= 0.925;
			}
			if (Owner.CountInv("MartArtsMaster") == 4)
			{
				MartArtFactor *= 0.75; // -25%
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') MartArtFactor *= 0.875;
			}
			if (Owner.CountInv("MartArtsMaster") == 5)
			{
				MartArtFactor *= 0.425; // 57.5%
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') MartArtFactor *= 0.7125;
			}
			if (MartArtFactor < 1.00) MartArtFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125)));
			if (MartArtFactor < 1.00 && A_CheckBerserk()) MartArtFactor *= BerserkFactorblock;

			// Hell Warrior Shield [DEFENSIVE]
			double EWShieldFactor = 1.00;
			BerserkFactorblock = frandompick[statitem2](0.334,0.5,0.667);
			int HellWarriorShieldLevel = CallACS("MiscVarCheckDECORATE",300);
			If (weapon is "EvilWarriorShield") 
			{
				EWShieldFactor *= (0.67 - (HellWarriorShieldLevel * 0.0125));
				if (Owner.CountInv("EWShieldDefendMode")) EWShieldFactor *= (0.134 - (HellWarriorShieldLevel * 0.01));
				if (Owner.CountInv("EWShieldDefendModeExtra")) EWShieldFactor *= (0.0268 - (HellWarriorShieldLevel * 0.002));
				if (EWShieldFactor < 1.00) EWShieldFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125)));
				if (EWShieldFactor < 1.00 && A_CheckBerserk()) EWShieldFactor *= BerserkFactorblock;
			}
			
			double PlayerFistBlockFactor = 1.00;
			int UsingFistBlock = 0;
			BerserkFactorblock = frandompick[statitem2](0.25,0.334,0.5,0.667,0.75);
			if (Owner.CountInv("FistPlayerBlock")) 
			{
				UsingFistBlock++;
				PlayerFistBlockFactor *= 0.5;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= 0.5;
			}
			if (Owner.CountInv("FistPlayerBlock2")) 
			{
				UsingFistBlock++;
				PlayerFistBlockFactor *= 0.375;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= 0.375;
			}
			if (Owner.CountInv("FistPlayerBlock3")) 
			{
				UsingFistBlock++;
				PlayerFistBlockFactor *= 0.25;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= 0.25;
			}
			if (Owner.CountInv("FistPlayerBlock4")) 
			{
				UsingFistBlock++;
				PlayerFistBlockFactor *= 0.125;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= 0.125;
			}
			if (Owner.CountInv("FistPlayerBlockExtra") && UsingFistBlock) 
			{
				PlayerFistBlockFactor *= 0.1;
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= 0.1;
			}
			// Lifeup Perk
			if (PlayerFistBlockFactor < 1.00 && UsingFistBlock)
			{
				PlayerFistBlockFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125)));
				if (damageType == 'Melee' || damageType == 'Trample' || damageType == 'Stomp') PlayerFistBlockFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125)));
			}
			if (PlayerFistBlockFactor < 1.00 && UsingFistBlock && A_CheckBerserk()) PlayerFistBlockFactor *= BerserkFactorblock;

			// Sceptre Swinging [DEFENSIVE]
			double SceptreDefenseFactor = 1.0;
			BerserkFactorblock = 0.50 + (frandom[statitem2](-10,10) * 0.01);
			if (Owner.CountInv("PrimingSceptre")) SceptreDefenseFactor *= (0.985 - (CallACS("OtherVarCheckDECORATE",11) * 0.015));
			if (Owner.CountInv("SwingDefense0")) SceptreDefenseFactor *= 0.95;
			if (Owner.CountInv("SwingDefense1")) SceptreDefenseFactor *= 0.8333;
			if (Owner.CountInv("SwingDefense2")) SceptreDefenseFactor *= 0.6667;
			if (Owner.CountInv("SwingDefense3")) SceptreDefenseFactor *= 0.5;
			if (Owner.CountInv("ShieldDefense")) SceptreDefenseFactor *= 0.5;
			if (Owner.CountInv("ShieldDefense2")) SceptreDefenseFactor *= 0.25;
			if (Owner.CountInv("ShieldDefense3")) SceptreDefenseFactor *= 0.125;
			if (Owner.CountInv("SceptreSpinDefense1")) SceptreDefenseFactor *= 0.9375;
			if (Owner.CountInv("SceptreSpinDefense2")) SceptreDefenseFactor *= 0.875;
			if (Owner.CountInv("SceptreSpinDefense3")) SceptreDefenseFactor *= 0.75;
			if (Owner.CountInv("SceptreSpinDefense4")) SceptreDefenseFactor *= 0.5;
			// Lifeup Perk
			if (SceptreDefenseFactor < 1.00) { SceptreDefenseFactor *= (1.00 - ((LifeUpPerkLvl * .0125) + (LifeUpExPerkLvl * .03125))); }
			if (SceptreDefenseFactor < 1.00 && A_CheckBerserk()) SceptreDefenseFactor *= BerserkFactorblock;

			// Sauron Equipment [DEFENSIVE]
			double SauronEquipFactor = 1.0;
			if (Owner.CountInv("SauronHelmet")) 
			{
				SauronEquipFactor *= 0.75; // General Reduction
				if (damageType == 'Bullet') SauronEquipFactor *= 0.833334;
			}

			// The One Ring [DEFENSIVE]
			double RingFactor = 1.0;
			if (Owner.CountInv("TheOneRing")) RingFactor = 0.4;

			// DQ Buffs [DEFENSIVE]
			double DQBuffFactor = 1.0;
			if (DQBuffTimer > 0) DQBuffFactor *= 0.50; // Buff
			if (DQSapTimer > 0) DQBuffFactor *= 2.00; // Sap
			if (SleepTimer > 0) // Sleep
			{
				if (random[statitem](1,16) == 1) DQBuffFactor *= 5.0; else DQBuffFactor *= 1.25;
			}

			//********************************************************************
			// TOTALFactor is for defenses that can be ignored by various attacks
			//********************************************************************
			double TOTALFactor = 1.0
													* LVLfactor 
													* DEFfactor 
													* THEfactor 
													* LifeUpDEFFactor 
													* DemoExpertFactor 
													* StrifeStaminaFactor
													* InvisFactor
													* UppercutFactor
													* MartArtFactor
													* EWShieldFactor
													* PlayerFistBlockFactor
													* SceptreDefenseFactor
													* SauronEquipFactor
													* RingFactor
													* DQBuffFactor;
													
			// The following allows TOTALFactor to be affected by varying types of (Partial)Defense-Ignoring attacks.
			double BaseIgnoreFactor = 0.0;
			double DefenseIgnoreFactor = 0.0;
			double PreTOTALFactor = TOTALFactor;
			if (playeractor && playeractor.PlayerDefenseIgnoreFactor > 0.00 && TOTALFactor <= 1.00)
			{
				BaseIgnoreFactor = (1.0 - TOTALFactor);
				DefenseIgnoreFactor = BaseIgnoreFactor * playeractor.PlayerDefenseIgnoreFactor;
				TOTALFactor += DefenseIgnoreFactor;
				if (dvdsdebug_playerdmgdisplays)
				{
					Console.Printf("    (\cz[STEP 7] PlayerStatItem input\c-: \caDefenseIgnoreFactor\c- = \ca%.8f\c- / \cy%.8f\c-, \cwPlyrDmgIgnFctr\c- = \cw%.8f\c-, \cxTOTALFactor\c- = %.8f \cw(%.8f)\c-, \cydmg = %d\c- (StatItem Actor))", 
					DefenseIgnoreFactor, BaseIgnoreFactor, playeractor.PlayerDefenseIgnoreFactor, TOTALFactor, PreTOTALFactor, damage);
				}
			}
			else
			{
				if (dvdsdebug_playerdmgdisplays)
				{
					Console.Printf("    (\cz[STEP 7] PlayerStatItem input\c-: \caSKIPPED\c-, \cydmg = %d\c-)", DefenseIgnoreFactor, damage);
				}
			}

			newdamage = max(0, ApplyDamageFactors(GetClass(), damageType, damage, damage * TOTALFactor));
			int postdef1dmg = newdamage;
			if (dvdsdebug_playerdmgdisplays && damage > 0) 
			{
				Console.Printf("    (\cz[STEP 8] StatItem input ([Ignorables])\c-: \cwDmgType:\c- \cw%s\c-, \cyolddmg\c- / \cynewdmg\c- = \cy%d\c- / \cy%d\c-, \caTOTALFactor\c- = \ca%.8f\c-, LVLFactor [%d] = %.8f, DEFfactor [%d] = %.8f, THEfactor [%d] = %.8f, LifeUpDEFFactor = %.8f, DemoExpertFactor = %.8f, StrifeStaminaFactor = %.8f, InvisFactor = %.8f, EWShieldFactor = %.8f, PlayerFistBlockFactor = %.8f, SceptreDefenseFactor = %.8f, UppercutFactor = %.8f, MartArtFactor = %.8f, SauronEquipFactor = %.8f, RingFactor = %.8f, DQBuffFactor = %.8f)", 
				damageType, damage, postdef1dmg, TOTALFactor, 
				PlayerLevel, LVLFactor, PlayerDEF, DEFfactor, PlayerTHE, THEfactor, 
				LifeUpDEFFactor, DemoExpertFactor, StrifeStaminaFactor, 
				InvisFactor, EWShieldFactor,
				PlayerFistBlockFactor, SceptreDefenseFactor, UppercutFactor, 
				MartArtFactor, SauronEquipFactor, 
				RingFactor, DQBuffFactor);
			}


			// ******************************************
			// *DEFENSE THAT CANNOT BE IGNORED GOES LAST*
			// ******************************************
			// "Power Trip" Mode ===Unignorable===
			double MusouFactor = 1.0;
			if (dvds_musou_powertripmode == 1) MusouFactor = 0.2;
			if (dvds_musou_powertripmode == 2) MusouFactor = 0.1;

			// Death Rage [Invulnerablity?] ===Unignorable===
			double DeathRageFactor = 1.0;
			if (DeathRageTimer > 0) DeathRageFactor = 0.0;
			
			// Focusing ===Unignorable===
			double FocusFactor = 1.00;
			if (IsFocusOn > 0) FocusFactor = 4.00;

			// Invisibility [DEFENSIVE] [if NOT ignored] (67% Chance)
			InvisFactor = 1.0;
			InvisBaseAmt = 0.8889;
			if (InvisIgnored <= 2)
			{
				if (InvisiblityLevel >= 1) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 2) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 3) InvisFactor *= InvisBaseAmt;
				if (InvisiblityLevel >= 4) InvisFactor *= InvisBaseAmt;
			}
			
			// Cursed Shield [DEFENSIVE] ===Unignorable===
			double CursedShieldFactor = 1.0;
			if (CharacterClass == 2 && Owner.CountInv("RuinousShield"))
			{
				CursedShieldFactor *= 2.56;
				if (damageType == 'Dark' || damageType == 'IncarnateGlare')
				{
					CursedShieldFactor *= 0.390625;
				}
			}
			
			// Tension Level [DEFENSIVE] ===Unignorable===
			double TensionFactor = 1.0;
			int CanUseTension = dvds_allowtension;
			if (CanUseTension > 0)
			{
				if (TensionLevel == 1) TensionFactor = 0.975;		// "5" Tension
				if (TensionLevel == 2) TensionFactor = 0.925;		// "20" Tension
				if (TensionLevel == 3) TensionFactor = 0.825;		// "50" Tension
				if (TensionLevel == 4) TensionFactor = 0.7;			// "100" Tension
				if (TensionLevel == 5) TensionFactor = 0.55;		// "250" Tension
				if (TensionLevel == 6) TensionFactor = 0.35;		// "500" Tension
				if (TensionLevel == 7) TensionFactor = 0.1;			// "1000" Tension
			}

			// Divine Avatar [DEFENSIVE] ===Unignorable===
			double DivineAvatarFactor = 1.0;
			if (DivineAvatarTimer > 0) DivineAvatarFactor = 0.25;

			// GoE? [DEFENSIVE] ===Unignorable===
			double GoEFactor = 1.0;
			if (GoETimer > 0) GoEFactor = 0.1;

			//************************************************************************
			// TOTALFactor2 is for defenses that CANNOT be ignored by various attacks
			//************************************************************************
			double TOTALFactor2 = 1.0
													* MusouFactor
													* DeathRageFactor
													* FocusFactor
													* InvisFactor
													* CursedShieldFactor
													* TensionFactor
													* DivineAvatarFactor
													* GoEFactor;

			newdamage = max(0, ApplyDamageFactors(GetClass(), damageType, postdef1dmg, postdef1dmg * TOTALFactor2));
			if (dvdsdebug_playerdmgdisplays && postdef1dmg > 0) 
			{
				Console.Printf("    (\cz[STEP 9] StatItem input ([UNIgnorables])\c-: \cwDmgType:\c- \cw%s\c-, \cyolddmg\c- / \cynewdmg\c- = \cy%d\c- / \cy%d\c-, \caTOTALFactor2\c- = \ca%.8f\c-, MusouFactor = %.8f, DeathRageFactor = %.8f, FocusFactor = %.8f, InvisFactor = %.8f, CursedShieldFactor = %.8f, TensionFactor = %.8f, DivineAvatarFactor = %.8f, GoEFactor = %.8f)", 
				damageType, postdef1dmg, newdamage, TOTALFactor2, 
				MusouFactor, DeathRageFactor, FocusFactor,
				InvisFactor, CursedShieldFactor,
				TensionFactor, DivineAvatarFactor, GoEFactor);
			}
			if (playeractor) playeractor.saveddamage = newdamage;
		}
	}

	override double GetSpeedFactor() 
	{
		let weapon = owner.player.ReadyWeapon;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);

		double CVarAdjustSpeed = 1.00;
		CVarAdjustSpeed = dvds_speedmult;

		double StaminaSpeed = 1.00;
		int StamRatio = CallACS("MiscVarCheckDECORATE",41);
		if (StamRatio < 157) StaminaSpeed = -0.675;
		if (StamRatio > 156 && StamRatio < 626) StaminaSpeed = -0.525;
		if (StamRatio > 625 && StamRatio < 1251) StaminaSpeed = -0.39;
		if (StamRatio > 1250 && StamRatio < 2501) StaminaSpeed = -0.27;
		if (StamRatio > 2500 && StamRatio < 5001) StaminaSpeed = -0.165;
		if (StamRatio > 5000 && StamRatio < 7501) StaminaSpeed = -0.075;
		if (StamRatio > 7500 && StamRatio < 12501) StaminaSpeed = 0.00;
		if (StamRatio > 12500 && StamRatio < 20001) StaminaSpeed = 0.075;
		if (StamRatio > 20000 && StamRatio < 27501) StaminaSpeed = 0.165;
		if (StamRatio > 27500 && StamRatio < 35001) StaminaSpeed = 0.27;
		if (StamRatio > 35000 && StamRatio < 42501) StaminaSpeed = 0.39;
		if (StamRatio > 42500 && StamRatio < 48751) StaminaSpeed = 0.525;
		if (StamRatio > 48750) StaminaSpeed = 0.675;
		StaminaSpeed /= 2;
		StaminaSpeed *= dvds_staminaaffectsspeed;
		StaminaSpeed += 1.00;

		double DodgeMoreSpeed = 1.00;
		DodgeMoreSpeed = 1.0 + ((DodgeMorePerkLvl * 0.01) + (DodgeMoreEXPerkLvl * 0.025));

		double JumpMoreSpeed = 1.00;
		JumpMoreSpeed = 1.0 + ((JmpMorePerkLvl * 0.01) + (JmpMoreEXPerkLvl * 0.025));

		double OnTheMoveSpeed = 1.00;
		OnTheMoveSpeed = 1.0 + ((OTMPerkLvl * 0.02) + (OTMEXPerkLvl * 0.05));

		double ArmorSpeed = 1.00;
		if (Owner.CountInv("CloakofEvasion")) ArmorSpeed += 0.10;
		if (Owner.CountInv("DoveRibbon")) ArmorSpeed += 0.15;

		double OneRingSpeed = 1.00;
		if (Owner.CountInv("TheOneRing")) OneRingSpeed = 1.50;

		double LVLSpeed = 1.00;
		LVLSpeed = (PlayerLevel * 0.001);
		LVLSpeed *= dvds_levelaffectsspeed;
		LVLSpeed += 1.00;

		double AGLSpeed = 1.00;
		if (CharacterClass == 0) AGLSpeed = 1.0 + (PlayerAGL * 0.00111114);
		if (CharacterClass == 1) AGLSpeed = 1.0 + (PlayerAGL * 0.00166667); 
		if (CharacterClass == 2) AGLSpeed = 1.0 + (PlayerAGL * 0.00222223);
		if (CharacterClass == 8) AGLSpeed = 1.0 + (PlayerAGL * 0.00194448); 
		if (CharacterClass == 9) AGLSpeed = 1.0 + (PlayerAGL * 0.00138891); 

		double HWShieldSpeed = 1.00;
		If (weapon is "EvilWarriorShield")
		{
			if (Owner.CountInv("HWShieldBlockHold")) HWShieldSpeed = (0.81 * (1.0 - (HellWarriorShieldLevel * 0.0125))); else HWShieldSpeed = (0.9 * (1.0 - (HellWarriorShieldLevel * 0.00625)));
		}

		double MinigunFiringSpeed = 1.00;
		If (weapon is "Minigun")
		{
			if (Owner.CountInv("MinigunSlowdownWhenFiring")) 
			{
				MinigunFiringSpeed = frandom[statitem2](0.8334,1.1666) * (0.25 + (BulletAccPerkLvl * 0.05) + (BulletAccEXPerkLvl * 0.125));
			}
		}
		else
		{
			if (Owner.CountInv("MinigunSlowdownWhenFiring")) Owner.A_SetInventory("MinigunSlowdownWhenFiring",0);
		}

		double FistBlockSpeed = 1.00;
		if (Owner.CountInv("FistPlayerSpeedFactor")) FistBlockSpeed = 0.75;
		if (Owner.CountInv("FistPlayerSpeedFactor2")) FistBlockSpeed = 0.825;
		if (Owner.CountInv("FistPlayerSpeedFactor3")) FistBlockSpeed = 0.90;
		if (Owner.CountInv("FistPlayerSpeedFactor3")) FistBlockSpeed = 0.9875;

		double LongbowSpeed = 1.00;
		if (CallACS("MiscVarCheckDECORATE",398) == 1)
		{
			LongbowSpeed = CallACS("MiscVarCheckDECORATE",84) * 0.01;
			if (LongbowSpeed > 1.0) LongbowSpeed = 1.00;
			//Console.Printf("LongbowSpeed: %.8f", LongbowSpeed);
		}
		double SceptreShieldSpeed = 1.00;
		if (Owner.CountInv("PrimingSceptre")) SceptreShieldSpeed *= (0.745 + (CallACS("OtherVarCheckDECORATE",11) * 0.015));
		if (SceptreShieldLevel == 1) SceptreShieldSpeed *= 0.25;
		if (SceptreShieldLevel == 2) SceptreShieldSpeed *= 0.5;
		if (SceptreShieldLevel == 3) SceptreShieldSpeed *= 0.875;

		double BuffSpeed = 1.00;
		if (DQAcceleratleTimer > 0) BuffSpeed *= 1.3334; 
		if (DQDeceleratleTimer > 0) BuffSpeed *= 0.6667; 

		double TensionSpeed = 1.00;
		int CanUseTension = dvds_allowtension;
		if (CanUseTension > 0)
		{
			if (TensionLevel == 1) TensionSpeed = 1.035;
			if (TensionLevel == 2) TensionSpeed = 1.15;
			if (TensionLevel == 3) TensionSpeed = 1.25;
			if (TensionLevel == 4) TensionSpeed = 1.375;
			if (TensionLevel == 5) TensionSpeed = 1.5625;
			if (TensionLevel == 6) TensionSpeed = 1.875;
			if (TensionLevel == 7) TensionSpeed = 2.25;
		}

		double FocusSpeed = 1.00;
		if (IsFocusOn > 0) FocusSpeed = 0.25;

		double DivineAvatarSpeed = 1.00;
		if (DivineAvatarTimer > 0) DivineAvatarSpeed = 1.5;

		Speed = 1.00
					* CVarAdjustSpeed
					* StaminaSpeed 
					* DodgeMoreSpeed
					* JumpMoreSpeed
					* OnTheMoveSpeed
					* FocusSpeed
					* LVLSpeed
					* AGLSpeed
					* ArmorSpeed
					* OneRingSpeed
					* HWShieldSpeed
					* MinigunFiringSpeed
					* FistBlockSpeed
					* LongbowSpeed
					* SceptreShieldSpeed
					* BuffSpeed
					* TensionSpeed
					* DivineAvatarSpeed;
		if (dvdsdebug_showmoveinformation) Console.Printf("    (\czSpeed Input\c-: \cyTotalSpeed\c- = \cy%.8f\c-, CVarAdjustSpeed = %.8f, StaminaSpeed [%d] = %.8f, DodgeMoreSpeed = %.8f, JumpMoreSpeed = %.8f, OnTheMoveSpeed = %.8f, FocusSpeed = %.8f, LVLSpeed = %.8f, AGLSpeed = %.8f, ArmorSpeed = %.8f, OneRingSpeed = %.8f, HWShieldSpeed = %.8f, MinigunFiringSpeed = %.8f, FistBlockSpeed = %.8f, LongbowSpeed = %.8f, SceptreShieldSpeed = %.8f, BuffSpeed = %.8f, TensionSpeed = %.8f, DivineAvatarSpeed = %.8f)", Speed, CVarAdjustSpeed, StamRatio, StaminaSpeed, DodgeMoreSpeed, JumpMoreSpeed, OnTheMoveSpeed, FocusSpeed, LVLSpeed, AGLSpeed, ArmorSpeed, OneRingSpeed, HWShieldSpeed, MinigunFiringSpeed, FistBlockSpeed, LongbowSpeed, SceptreShieldSpeed, BuffSpeed, TensionSpeed, DivineAvatarSpeed);
		if (playeractor) playeractor.truespeed = Speed;
		return Speed; 
	}
}

class PlayerStatItem2 : Inventory 
{
	const SKILL_VERY_EASY = 0;
	const SKILL_EASY = 1;
	const SKILL_NORMAL = 2;
	const SKILL_HARD = 3;
	const SKILL_VERY_HARD = 4;
	const SKILL_EXTREME = 5;
	const SKILL_HORRIBLE = 6;
	const SKILL_IMPOSSIBLE = 7;
	const SKILL_OMEGA = 8;

	const minxymoveneg = -3.814697266;
	const minxymovepos = 3.814697266;
	const minzmoveneg = -1.907348633;
	const minzmovepos = 1.907348633;

	int PrevTimeFreezeTimer;
	int InitEXPTables;
	int InitSceptreEXPTables;
	int ClassCheck;
	int outputdamage;
	int CharacterClass;
	int jiggle_jump, jiggle_crouch, jiggle_left, jiggle_right, jiggle_up, jiggle_down;
	
	int LevelupSpeechTimer2;
	int PrevBackPacksCollected;

	// Strife Flag Checks
	int StrifeQuestFlag25, StrifeQuestFlag26, StrifeQuestFlag29;
	
	int EXPComboTimer, MaxEXPCombotimer, ComboTimerDelay;
	
	double HPRegenTimer, HPDelayInterval;
	double HPDegenTimer, HPDelayInterval2;
	double MPRegenTimer, MPDelayInterval;
	double RuinousShieldDegenTimer, CursedShieldDegenTimer;
	double DivineRegenTimer, DivineRegenInterval;
	double DoveRegenTimer, DoveRegenInterval;
	double PoisonTimer, PoisonMaxInterval;
	double RuinousPtsCurrent, RuinousPtsNeeded;
	double UncurseInterval, UncurseMaxInterval;

	int LifeUpPerkComboCheck;
	int LifeUpPerkFactor;
	int LifeUpPerkBaseFactor;
	int MagiUpPerkComboCheck;
	int MagiUpPerkFactor;
	int MagiUpPerkBaseFactor;
	int StamUpgradeHPComboCheck;
	int StamUpgradeHPPerkFactor;
	int StamUpgradeHPPerkBaseFactor;
	int StamUpgradeMPComboCheck;
	int StamUpgradeMPPerkFactor;
	int StamUpgradeMPPerkBaseFactor;

	int landdmgbonus;
	int heldtime;
	int PrevHealthRatio;
	int PoisonHits;
	int SceptreEXPRatio;
	
	int TensionLevel; // [181]
	int TensionTimer; // [183]
	int TensionWarmupTimer; // [185]
	int TensionCooldownTimer; // [186]
	int TensionChargeLoopTimer; // [189]
	int TensionActivePulseTimer; // [190]
	int TensionOverPsycheTimer; // [250]
	int TensionOverchargeTimer; // [251]
	int TensionMaxOverchargeTimer; // [261]
	int TensionMaxOverPsycheTimer; // [262]
	int TensionSpeedRatio; // [193]
	
	int DeathCheck, WasDead;
	int ArcanaRegenDelay;

	String nm, nn, no, np;
	String pm, pn, po, pp;
	
	int PlayerLevel;
	int MaxHealthTrue;
	int MaxHealthLimit;
	int MaxMana;
	int PlayerAGL;
	int PlayerDEF;
	int PlayerDFT;
	int PlayerSOR;
	int PlayerSTR;
	int PlayerTHE;
	int PlayerJUMP;
	int PlayerAeonPts;
	int CurrentStamina;
	int MaximumStamina;
	int PlayerCurrentMP;
	int PlayerCurrentHealth;
	int IsFocusOn;
	int FocusTimer;
	int FocusHumTimer;
	int BaseSceptreEXP;
	int SceptreLevelEXP;

	int SkillFactor;
	int TrueGameSkill;
	int CurrentArmorClass;
	int CurrentMaxArmor;
	int HellcoreOverheatLevel;
	double HellcoreCooldownSpeed;
	int HellcoreCooldownTimer;
	int ClassicDoomType;
	int ModType;
	
	int buttons;
	int oldbuttons;
	int FreezePlayer;
	int Player1TID;
	
	int DashTimer, MaxDashTimer;
	
	int InvisibilityTimer;
	int InvulnerabilityTimer;
	
	int EvasionRate; // Based on 0.1% to 100.0% [though the displays only show full %]
	int AglEvadeCheck, DftEvadeCheck;

	int ArmorResistance;
	int BasePerkFactor;
	int PerkFactor;
	int TotalMass;
	int delaycount;
	int HealthRatio;
	int previousdelaycount;
	int ArmorBits;
	
	int minigunheat;
	int minigunheatmax;

	int MortalHitSurviveRate;
	int AGL, DEF, DFT, SOR, STR, THE, AeonPts;

	int HellcoreCoolRatio;
	
	int perks3mastered;
	int aeonptsperksused;
	int LifeUpPerkLvl;
	int LifeUpExPerkLvl;
	int MagiUpPerkLevel;
	int MagiUpEXPerkLevel;
	int StamUpPerkLvl;
	int StamUpEXPerkLvl;
	int DodgeMorePerkLvl;
	int DodgeMoreEXPerkLvl;
	int JmpMorePerkLvl;
	int JmpMoreEXPerkLvl;
	int PsychFstPerkLvl;
	int PsychFstEXPerkLvl;
	int RegHPFstPerkLvl;
	int RegHPFstEXPerkLvl;
	int RegMPFstPerkLvl;
	int RegMPFstEXPerkLvl;
	int RegStamFastLvl;
	int RegStamFastEXLvl;
	int BulletAccPerkLvl;
	int BulletAccEXPerkLvl;
	int ArcheryMasteryPerkLevel;
	int ArcheryMasteryEXPerkLevel;

	//
	int OTMPerkLvl;
	int OTMEXPerkLvl;
	//
	int WandMasteryPerkLevel;
	int WandMasteryEXPerkLevel;
	int ClearMindPerkLvl;
	int ClearMindEXPerkLvl;
	
	int StrifeStamLvl;
	int StrifeAccuLvl;
	
	int HealthDifferenceTimer;
	int PrevMaxArmor;

	default 
	{
		+Inventory.PERSISTENTPOWER;
		+Inventory.UNDROPPABLE;
		+Inventory.UNTOSSABLE;
	}

	private class<Inventory> APPackToken, APPackCheck, APPackCheck2, APPackCheck3, APPackCheck4, APPackCheck5, APPackCheck6, APPackCheck7, APPackCheck8, APPackCheck9, APPackCheck10, APPackCheck11, APPackCheck12;
	private class<Inventory> iDTech1Check, iDTech1Check2, iDTech1Check3, iDTech1Check4, iDTech1Check5, iDTech1Check6, iDTech1Check7, iDTech1Check8, iDTech1Check9, iDTech1Check10, iDTech1Check11, iDTech1Check12;

	override void DoEffect()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (!playeractor) { owner.A_SetInventory("PlayerStatItem2",0); super.DoEffect(); } // Removes itself if given to a non-Aetherius Player Class
		
		
		
		
		
		A_PSI2DoEffectInterpolateHealth();
		
		
		
		
		
		A_PSI2DoEffectIRenderAlpha();
		
		
		
		
		A_PSI2DoEffectSpellCostCheck();
		
		
		
		
		
		//****************
		//**Weapon Slots**
		//****************
		A_PSI2DoEffectWeaponSlot();
		
		
		
		
		
		super.DoEffect();
	}
	
	// Spell Cost Check
	void A_PSI2DoEffectSpellCostCheck()
	{
	}
	
	
	// Interpolate Health
	void A_PSI2DoEffectInterpolateHealth()
	{
		//*******************************************************************************
		//*Attempting to Interpolate Health Values for the player to show damage values.*
		//*******************************************************************************
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		int ClassCheck = CallACS("OtherVarCheckDECORATE",4);
		int CharacterClass = CallACS("CheckCharacterClass");
		MaxHealthTrue = CallACS("StatCheck",1);
		MaxMana = CallACS("StatCheck",2);
		int CurrentMana = CallACS("StatCheck",14);
		if (playeractor)
		{
			if (ClassCheck > 1)
			{
				if (HealthDifferenceTimer > 0)
				{
					//Console.Printf("(241: %d - 175: %d [gametic: %d])", CallACS("MiscVarCheckDECORATE",241), CallACS("MiscVarCheckDECORATE",175), gametic);
					CallACS("MiscVarSetDECORATE",241,CallACS("MiscVarCheckDECORATE",175)); // "LastHealthValue"
					//Console.Printf("(241: %d [gametic: %d])", CallACS("MiscVarCheckDECORATE",241), gametic);
					CallACS("MiscVarSetDECORATE",175,owner.health); // "NewHealthValue"
					//Console.Printf("(175: %d [gametic: %d])", CallACS("MiscVarCheckDECORATE",175), gametic);
					CallACS("MiscVarSetDECORATE",173,(CallACS("MiscVarCheckDECORATE",175) - CallACS("MiscVarCheckDECORATE",241))); // "HealthDifference"
					//Console.Printf("\cxDiff(173): %d\c- (175: %d \cy-\c- 241: %d [gametic: %d])", CallACS("MiscVarCheckDECORATE",173), CallACS("MiscVarCheckDECORATE",175), CallACS("MiscVarCheckDECORATE",241), gametic);
					if (MaxHealthTrue != 0) CallACS("MiscVarSetDECORATE",174,(CallACS("MiscVarCheckDECORATE",173) * 100 / MaxHealthTrue)); // "HealthDiffRatio"
					
					CallACS("MiscVarSetDECORATE",243,CallACS("MiscVarCheckDECORATE",238)); // "LastManaValue"
					CallACS("MiscVarSetDECORATE",238,CurrentMana); // "NewManaValue"
					CallACS("MiscVarSetDECORATE",236,(CallACS("MiscVarCheckDECORATE",238) - CallACS("MiscVarCheckDECORATE",243))); // "ManaDifference"
					if (MaxMana != 0) CallACS("MiscVarSetDECORATE",237,(CallACS("MiscVarCheckDECORATE",236) * 100 / MaxMana)); // "ManaDiffRatio"
					
					if (CharacterClass != 2)
					{
						CallACS("MiscVarSetDECORATE",242,CallACS("MiscVarCheckDECORATE",178)); // "LastArmorValue"
						CallACS("MiscVarSetDECORATE",178,owner.CountInv("BasicArmor")); // "NewArmorValue"
						CallACS("MiscVarSetDECORATE",176,(CallACS("MiscVarCheckDECORATE",178) - CallACS("MiscVarCheckDECORATE",242))); // "ArmorDifference"

						// "ArmorDiffRatio"
						if (PrevMaxArmor > 0)
						{
							CallACS("MiscVarSetDECORATE",177,(CallACS("MiscVarCheckDECORATE",176) * 100 / PrevMaxArmor));
						}
						else
						{
							CallACS("MiscVarSetDECORATE",177,0);
						}
					}
					
					if (dvdsdebug_showplayerhealthsync)
					{
						if (MaxHealthTrue != 0) Console.Printf("LastHealthValue: %d, NewHealthValue: %d, HealthDifference: %d, HealthDiffRatio: %d", CallACS("MiscVarCheckDECORATE",175), owner.health, (CallACS("MiscVarCheckDECORATE",175) - CallACS("MiscVarCheckDECORATE",241)), (CallACS("MiscVarCheckDECORATE",173) * 100 / MaxHealthTrue));
						else Console.Printf("LastHealthValue: %d, NewHealthValue: %d, HealthDifference: %d", CallACS("MiscVarCheckDECORATE",175), owner.health, (CallACS("MiscVarCheckDECORATE",175) - CallACS("MiscVarCheckDECORATE",241)));

						if (MaxMana != 0) Console.Printf("LastManaValue: %d, NewManaValue: %d, ManaDifference: %d, ManaDiffRatio: %d", CallACS("MiscVarCheckDECORATE",238), CurrentMana, (CallACS("MiscVarCheckDECORATE",238) - CallACS("MiscVarCheckDECORATE",243)), (CallACS("MiscVarCheckDECORATE",236) * 100 / MaxMana));
						else Console.Printf("LastManaValue: %d, NewManaValue: %d, ManaDifference: %d", CallACS("MiscVarCheckDECORATE",238), CurrentMana, (CallACS("MiscVarCheckDECORATE",238) - CallACS("MiscVarCheckDECORATE",243)));

						if (CharacterClass != 2)
						{
							if (PrevMaxArmor > 0) Console.Printf("LastArmorValue: %d, NewArmorValue: %d, ArmorDifference: %d, ArmorDiffRatio: %d", CallACS("MiscVarCheckDECORATE",178), owner.CountInv("BasicArmor"), (CallACS("MiscVarCheckDECORATE",178) - CallACS("MiscVarCheckDECORATE",242)),(CallACS("MiscVarCheckDECORATE",176) * 100 / PrevMaxArmor));
							else Console.Printf("LastArmorValue: %d, NewArmorValue: %d, ArmorDifference: %d", CallACS("MiscVarCheckDECORATE",178), owner.CountInv("BasicArmor"), (CallACS("MiscVarCheckDECORATE",178) - CallACS("MiscVarCheckDECORATE",242)));
						}
					}
				}
				HealthDifferenceTimer += 1;
			}
		}
	}

	void A_PSI2DoEffectIRenderAlpha()
	{
		//**********************************************************************
		//*Alpha and RenderStyle Effects [Invisiblity and Mercy Invulnerablity]*
		//**********************************************************************
		int InvisPulseTimer = level.totaltime % 40;
		DashTimer = CallACS("MiscVarCheckDECORATE",166);
		InvisibilityTimer = CallACS("GetBuffTimer",1);
		InvulnerabilityTimer = CallACS("GetBuffTimer",4);
		double InvisPulseAlpha;
		double flickeralpha = 1.0;
		double basealpha = 1.0;
		double tempalpha;
		double ghostdashvis = random[statitem](7,9) * 0.03125;
		int ArmorResistance, ArmRes1, ArmRes2, ArmRes3;
		PrevMaxArmor = CurrentMaxArmor;
		CurrentMaxArmor = CallACS("OtherVarCheckDECORATE",9);
		int FlickerTimerMod;
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor)
		{
			//Invisibility Pulse Timers
			if (InvisibilityTimer > 0)
			{
				if (InvisPulseTimer == 0 || InvisPulseTimer == 20 || InvisPulseTimer == 40) InvisPulseAlpha = 0.20;
				if (InvisPulseTimer == 1 || InvisPulseTimer == 19) InvisPulseAlpha = 0.205;
				if (InvisPulseTimer == 2 || InvisPulseTimer == 18) InvisPulseAlpha = 0.21;
				if (InvisPulseTimer == 3 || InvisPulseTimer == 17) InvisPulseAlpha = 0.215;
				if (InvisPulseTimer == 4 || InvisPulseTimer == 16) InvisPulseAlpha = 0.22;
				if (InvisPulseTimer == 5 || InvisPulseTimer == 15) InvisPulseAlpha = 0.225;
				if (InvisPulseTimer == 6 || InvisPulseTimer == 14) InvisPulseAlpha = 0.23;
				if (InvisPulseTimer == 7 || InvisPulseTimer == 13) InvisPulseAlpha = 0.235;
				if (InvisPulseTimer == 8 || InvisPulseTimer == 12) InvisPulseAlpha = 0.24;
				if (InvisPulseTimer == 9 || InvisPulseTimer == 11) InvisPulseAlpha = 0.245;
				if (InvisPulseTimer == 10) InvisPulseAlpha = 0.25;
				if (InvisPulseTimer == 21 || InvisPulseTimer == 39) InvisPulseAlpha = 0.195;
				if (InvisPulseTimer == 22 || InvisPulseTimer == 38) InvisPulseAlpha = 0.19;
				if (InvisPulseTimer == 23 || InvisPulseTimer == 37) InvisPulseAlpha = 0.185;
				if (InvisPulseTimer == 24 || InvisPulseTimer == 36) InvisPulseAlpha = 0.18;
				if (InvisPulseTimer == 25 || InvisPulseTimer == 35) InvisPulseAlpha = 0.175;
				if (InvisPulseTimer == 26 || InvisPulseTimer == 34) InvisPulseAlpha = 0.17;
				if (InvisPulseTimer == 27 || InvisPulseTimer == 33) InvisPulseAlpha = 0.165;
				if (InvisPulseTimer == 28 || InvisPulseTimer == 32) InvisPulseAlpha = 0.16;
				if (InvisPulseTimer == 29 || InvisPulseTimer == 31) InvisPulseAlpha = 0.155;
				if (InvisPulseTimer == 30) InvisPulseAlpha = 0.15;
			}
			if (dvdsdebug_mercyinvulndisplays) Console.Printf("InvisPulseTimer: %d, level.totaltime: %d", InvisPulseTimer, level.totaltime);
			
			
			//Mercy Invulnerablity Itself
			if (CallACS("MiscVarCheckDECORATE",194) != 0) // Flickering
			{
				if (InvisibilityTimer > 0) basealpha = InvisPulseAlpha; // Invisible
				if (dvdsdebug_mercyinvulndisplays) Console.Printf("BaseAlpha: %.8f, ghostdashvis: %.8f", basealpha, ghostdashvis);
				
				if (CallACS("MiscVarCheckDECORATE",195) > 0) // Timer Above 0
				{
					if (InvulnerabilityTimer == 0) 
					{
						owner.player.cheats |= CF_GODMODE;
						owner.bINVULNERABLE = 1;
						owner.A_SetInventory("IsInvulnerable",1);
						CallACS("MiscVarSetDECORATE",25040,1);
					}
					FlickerTimerMod = CallACS("MiscVarCheckDECORATE",195) % 120;
					if (FlickerTimerMod >= 0 && FlickerTimerMod <= 14) flickeralpha = basealpha * 0.25;
					if (FlickerTimerMod >= 15 && FlickerTimerMod <= 29) flickeralpha = basealpha * 0.3125;
					if (FlickerTimerMod >= 30 && FlickerTimerMod <= 44) flickeralpha = basealpha * 0.375;
					if (FlickerTimerMod >= 45 && FlickerTimerMod <= 59) flickeralpha = basealpha * 0.4375;
					if (FlickerTimerMod >= 60 && FlickerTimerMod <= 74) flickeralpha = basealpha * 0.5;
					if (FlickerTimerMod >= 75 && FlickerTimerMod <= 89) flickeralpha = basealpha * 0.4375;
					if (FlickerTimerMod >= 90 && FlickerTimerMod <= 104) flickeralpha = basealpha * 0.375;
					if (FlickerTimerMod >= 105 && FlickerTimerMod <= 119) flickeralpha = basealpha * 0.3125;
					if (DashTimer > 0) flickeralpha *= ghostdashvis;
					owner.A_SetRenderStyle(flickeralpha,7);
					if (dvdsdebug_mercyinvulndisplays) Console.Printf("flickeralpha: %.8f, FlickerTimerMod [Timer]: %d [%d]", flickeralpha, owner.GetRenderStyle(), FlickerTimerMod, CallACS("MiscVarCheckDECORATE",195));
					
					CallACS("MiscVarSetDECORATE",196,FlickerTimerMod);
					CallACS("MiscVarSetDECORATE",195,20,2);
				}
				else // Timer at 0
				{
					if (InvulnerabilityTimer == 0) 
					{
						owner.player.cheats &= ~CF_GODMODE;
						owner.bINVULNERABLE = 0;
						owner.A_SetInventory("IsInvulnerable",0);
						CallACS("MiscVarSetDECORATE",25040,0);
					}
					CallACS("MiscVarSetDECORATE",194,0);
					CallACS("MiscVarSetDECORATE",195,0);
				}
			}
			else // Not Flickering
			{
				if (InvulnerabilityTimer == 0) 
				{
					owner.player.cheats &= ~CF_GODMODE;
					owner.bINVULNERABLE = 0;
					owner.A_SetInventory("IsInvulnerable",0);
					CallACS("MiscVarSetDECORATE",25040,0);
				}
		
				if (InvisibilityTimer > 0)
				{
					tempalpha = InvisPulseAlpha;
					if (DashTimer > 0) tempalpha *= ghostdashvis;
					owner.A_SetRenderStyle(tempalpha,7);
				}
				else
				{
					tempalpha = 1.0;
					if (DashTimer > 0) 
					{ 
						tempalpha *= ghostdashvis; 
						owner.A_SetRenderStyle(tempalpha,7);
					}
					else 
					{ 
						owner.A_SetRenderStyle(1.0,1);
					}
				}
				CallACS("MiscVarSetDECORATE",195,0);
				if (dvdsdebug_mercyinvulndisplays) Console.Printf("tempalpha: %.8f", tempalpha, owner.GetRenderStyle());
			}
			if (dvdsdebug_mercyinvulndisplays) Console.Printf("owner.player.cheats: %d, InvisPulseAlpha: %.8f", owner.player.cheats, InvisPulseAlpha);
			if (dvdsdebug_mercyinvulndisplays) Console.Printf("mercyinvulntime: %d, mercyinvulnstate: %d", CallACS("MiscVarCheckDECORATE",195), CallACS("MiscVarCheckDECORATE",194));
			CallACS("FixedVarSetDECORATE",101,(InvisPulseAlpha * 65536));
		}
	}
	
	// Weapon Slot Check
	void A_PSI2DoEffectWeaponSlot()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		let weapon = owner.player.ReadyWeapon;
		int SkillFactor;
		if (playeractor)
		{
			CallACS("MiscVarSetDECORATE",11,-1);
			CallACS("MiscVarSetDECORATE",411,-1);
			CallACS("MiscVarSetDECORATE",412,-1);
			CallACS("MiscVarSetDECORATE",413,-1);
			CallACS("MiscVarSetDECORATE",414,-1);
			CallACS("MiscVarSetDECORATE",415,-1);
			CallACS("MiscVarSetDECORATE",416,-1);
			CallACS("MiscVarSetDECORATE",417,-1);
			CallACS("MiscVarSetDECORATE",418,-1);
			CallACS("MiscVarSetDECORATE",419,-1);
			CallACS("MiscVarSetDECORATE",420,-1);

			nm = "FistAilish"; APPackCheck = nm;
			nm = "SauronGauntletsAilish"; APPackCheck2 = nm;
			nn = "FistPetra"; APPackCheck3 = nn;
			nn = "SauronGauntletsPetra"; APPackCheck4 = nn;
			nm = "RoyalScepter"; APPackCheck5 = nm;
			nn = "SoulWhisper"; APPackCheck6 = nn;
			// Slot 1
			SkillFactor = 0;
			if (owner.CountInv("Fist")) SkillFactor++;
			if (owner.CountInv("Chainsaw")) SkillFactor++;
			if (owner.CountInv("Chainsaw2")) SkillFactor++;
			if (owner.CountInv("DoubleBladedChainsaw")) SkillFactor++;
			if (owner.CountInv("FistDeggaris")) SkillFactor++;
			if (owner.CountInv("SauronGauntlets")) SkillFactor++;
			if (owner.CountInv("FistIllucia")) SkillFactor++;
			if (owner.CountInv("SauronGauntletsIllucia")) SkillFactor++;
			if (owner.CountInv("FistFlora")) SkillFactor++;
			if (owner.CountInv("SauronGauntletsFlora")) SkillFactor++;
			if (owner.CountInv("PoisonNeedle")) SkillFactor++;
			if (owner.CountInv("SceptreOfEmpyrea")) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			if (owner.CountInv(APPackCheck4)) SkillFactor++;
			if (owner.CountInv(APPackCheck5)) SkillFactor++;
			if (owner.CountInv(APPackCheck6)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",411,SkillFactor);

			if (weapon is "Fist" || 
					weapon is "Chainsaw" ||
					weapon is "Chainsaw2" ||
					weapon is "DoubleBladedChainsaw" ||
					weapon is "FistDeggaris" ||
					weapon is "SauronGauntlets" ||
					weapon is "FistIllucia" ||
					weapon is "SauronGauntletsIllucia" || 
					weapon is "FistFlora" ||
					weapon is "SauronGauntletsFlora" ||
					weapon is "PoisonNeedle" ||
					weapon is "SceptreOfEmpyrea" ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4 ||
					weapon is APPackCheck5 ||
					weapon is APPackCheck6) CallACS("MiscVarSetDECORATE",11,1);

			// Slot 2
			pm = "ImpalerXBow"; iDTech1Check = pm;
			pm = "DualImpalerXBow"; iDTech1Check2 = pm;
			pm = "GoldWandNew"; iDTech1Check3 = pm;
			pm = "DualGoldWandNew"; iDTech1Check4 = pm;
			pm = "StrifeCrossbowNew"; iDTech1Check5 = pm;
			pm = "StrifeCrossbow2New"; iDTech1Check6 = pm;
			nm = "PetraRevolver"; APPackCheck = nm;
			nm = "PetraRevolver2"; APPackCheck2 = nm;
			nm = "AChristina"; APPackCheck3 = nm;
			nm = "ShockStaff"; APPackCheck4 = nm;
			SkillFactor = 0;
			if (owner.CountInv("SapphireWandNew")) SkillFactor++; 
			if (owner.CountInv("DualSapphireWandsNew")) SkillFactor++; 
			if (owner.CountInv("Pistol2")) SkillFactor++; 
			if (owner.CountInv("DualPistols")) SkillFactor++; 
			if (owner.CountInv(iDTech1Check)) SkillFactor++; 
			if (owner.CountInv(iDTech1Check2)) SkillFactor++; 
			if (owner.CountInv(iDTech1Check3)) SkillFactor++; 
			if (owner.CountInv(iDTech1Check4)) SkillFactor++; 
			if (owner.CountInv(iDTech1Check5)) SkillFactor++; 
			if (owner.CountInv(iDTech1Check6)) SkillFactor++; 
			if (owner.CountInv(APPackCheck)) SkillFactor++; 
			if (owner.CountInv(APPackCheck2)) SkillFactor++; 
			if (owner.CountInv(APPackCheck3)) SkillFactor++; 
			if (owner.CountInv(APPackCheck4)) SkillFactor++; 
			CallACS("MiscVarSetDECORATE",412,SkillFactor);

			if (weapon is "SapphireWandNew" || 
					weapon is "DualSapphireWandsNew" || 
					weapon is "Pistol2" || 
					weapon is "DualPistols" || 
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is iDTech1Check3 ||
					weapon is iDTech1Check4 ||
					weapon is iDTech1Check5 ||
					weapon is iDTech1Check6 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4) CallACS("MiscVarSetDECORATE",11,2);

			// Slot 3
			pm = "CrossbowNew"; iDTech1Check = pm;
			pm = "DualCrossbowNew"; iDTech1Check2 = pm;
			pm = "SuperCrossbowNew"; iDTech1Check3 = pm;
			pm = "DualSuperCrossbowNew"; iDTech1Check4 = pm;
			nm = "Histanica"; APPackCheck = nm;
			nm = "SerpentStaffAilish"; APPackCheck2 = nm;
			nm = "PetraSawedOff"; APPackCheck3 = nm;
			nm = "AChristinaEnergyMine"; APPackCheck4 = nm;
			SkillFactor = 0;
			if (owner.CountInv("DiarisLongbow")) SkillFactor++;
			if (owner.CountInv("Shotgun2")) SkillFactor++;
			if (owner.CountInv("Shotgun")) SkillFactor++;
			if (owner.CountInv("SuperShotgun2")) SkillFactor++;
			if (owner.CountInv("SuperShotgun")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(iDTech1Check3)) SkillFactor++;
			if (owner.CountInv(iDTech1Check4)) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			if (owner.CountInv(APPackCheck4)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",413,SkillFactor);
			if (weapon is "DiarisLongbow" ||
					weapon is "Shotgun2" ||
					weapon is "Shotgun" ||
					weapon is "SuperShotgun2" ||
					weapon is "SuperShotgun" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is iDTech1Check3 ||
					weapon is iDTech1Check4 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4) CallACS("MiscVarSetDECORATE",11,3);

			// Slot 4
			pm = "DragonClawNew"; iDTech1Check = pm;
			pm = "DualDragonClawNew"; iDTech1Check2 = pm;
			nm = "Batholith"; APPackCheck = nm;
			nm = "PetraTommyGun"; APPackCheck2 = nm;
			nm = "PetraTommyGun2"; APPackCheck3 = nm;
			nm = "AChristinaMastermind"; APPackCheck4 = nm;
			nm = "AChristinaRepeater"; APPackCheck5 = nm;
			SkillFactor = 0;
			if (owner.CountInv("ImpSoul")) SkillFactor++;
			if (owner.CountInv("DarkImpSoul")) SkillFactor++;
			if (owner.CountInv("CacodemonSoul")) SkillFactor++;
			if (owner.CountInv("CacolanternSoul")) SkillFactor++;
			if (owner.CountInv("AbaddonSoul")) SkillFactor++;
			if (owner.CountInv("Chaingun")) SkillFactor++;
			if (owner.CountInv("Chaingun2")) SkillFactor++;
			if (owner.CountInv("Minigun")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			if (owner.CountInv(APPackCheck4)) SkillFactor++;
			if (owner.CountInv(APPackCheck5)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",414,SkillFactor);
			if (weapon is "ImpSoul" ||
					weapon is "DarkImpSoul" ||
					weapon is "CacodemonSoul" ||
					weapon is "CacolanternSoul" ||
					weapon is "AbaddonSoul" ||
					weapon is "Chaingun" ||
					weapon is "Chaingun2" ||
					weapon is "Minigun" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4 ||
					weapon is APPackCheck5) CallACS("MiscVarSetDECORATE",11,4);

			// Slot 5
			pm = "HellStaffNew"; iDTech1Check = pm;
			pm = "DualHellStaffNew"; iDTech1Check2 = pm;
			nm = "WizardWoodStave"; APPackCheck = nm;
			nm = "PetraNapalmLauncher"; APPackCheck2 = nm;
			nm = "AChristinaCyberdemon"; APPackCheck3 = nm;
			nm = "AChristinaMaulotaur"; APPackCheck4 = nm;
			nm = "AChristinaWyvern"; APPackCheck5 = nm;
			nm = "AChristinaMiniMissiles"; APPackCheck6 = nm;
			SkillFactor = 0;
			if (owner.CountInv("KnightSoul")) SkillFactor++;
			if (owner.CountInv("BaronSoul")) SkillFactor++;
			if (owner.CountInv("BelphegorSoul")) SkillFactor++;
			if (owner.CountInv("BruiserSoul")) SkillFactor++;
			if (owner.CountInv("ArchonSoul")) SkillFactor++;
			if (owner.CountInv("PyroDemonSoul")) SkillFactor++;
			if (owner.CountInv("RocketLauncher2")) SkillFactor++;
			if (owner.CountInv("RocketLauncher")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			if (owner.CountInv(APPackCheck4)) SkillFactor++;
			if (owner.CountInv(APPackCheck5)) SkillFactor++;
			if (owner.CountInv(APPackCheck6)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",415,SkillFactor);
			if (weapon is "KnightSoul" ||
					weapon is "BaronSoul" ||
					weapon is "BelphegorSoul" ||
					weapon is "BruiserSoul" ||
					weapon is "ArchonSoul" ||
					weapon is "PyroDemonSoul" ||
					weapon is "RocketLauncher2" ||
					weapon is "RocketLauncher" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4 ||
					weapon is APPackCheck5 ||
					weapon is APPackCheck6) CallACS("MiscVarSetDECORATE",11,5);

			// Slot 6
			pm = "PhoenixRodNew"; iDTech1Check = pm;
			pm = "DualPhoenixRodNew"; iDTech1Check2 = pm;
			nm = "ChilltipCane"; APPackCheck = nm;
			nm = "PetraTeslaCannon"; APPackCheck2 = nm;
			nm = "PetraTeslaCannon2"; APPackCheck3 = nm;
			nm = "AChristinaHades"; APPackCheck4 = nm;
			nm = "AChristinaIronLich"; APPackCheck5 = nm;
			nm = "AChristinaHeresiarch"; APPackCheck6 = nm;
			SkillFactor = 0;
			if (owner.CountInv("IncarnateSoul")) SkillFactor++;
			if (owner.CountInv("ArchvileSoul")) SkillFactor++;
			if (owner.CountInv("DiabloistSoul")) SkillFactor++;
			if (owner.CountInv("BalrogSoul")) SkillFactor++;
			if (owner.CountInv("PlasmaRifle2")) SkillFactor++;
			if (owner.CountInv("Railgun2")) SkillFactor++;
			if (owner.CountInv("Repeater2")) SkillFactor++;
			if (owner.CountInv("Karasawa2")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			if (owner.CountInv(APPackCheck4)) SkillFactor++;
			if (owner.CountInv(APPackCheck5)) SkillFactor++;
			if (owner.CountInv(APPackCheck6)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",416,SkillFactor);
			if (weapon is "IncarnateSoul" ||
					weapon is "ArchvileSoul" ||
					weapon is "DiabloistSoul" ||
					weapon is "BalrogSoul" ||
					weapon is "PlasmaRifle2" ||
					weapon is "Railgun2" ||
					weapon is "Repeater2" ||
					weapon is "Karasawa2" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3 ||
					weapon is APPackCheck4 ||
					weapon is APPackCheck5 ||
					weapon is APPackCheck6) CallACS("MiscVarSetDECORATE",11,6);

			// Slot 7
			pm = "FiremaceNew"; iDTech1Check = pm;
			pm = "DualFiremaceNew"; iDTech1Check2 = pm;
			nm = "NightShadow"; APPackCheck = nm;
			nm = "AChristinaBFG"; APPackCheck2 = nm;
			nm = "AChristinaPartinias"; APPackCheck3 = nm;
			SkillFactor = 0;
			if (owner.CountInv("BFG9000")) SkillFactor++;
			if (owner.CountInv("BFG90002")) SkillFactor++;
			if (owner.CountInv("HElementalSoul")) SkillFactor++;
			if (owner.CountInv("HOverlordSoul")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(APPackCheck)) SkillFactor++;
			if (owner.CountInv(APPackCheck2)) SkillFactor++;
			if (owner.CountInv(APPackCheck3)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",417,SkillFactor);
			if (weapon is "BFG9000" ||
					weapon is "BFG90002" ||
					weapon is "HElementalSoul" ||
					weapon is "HOverlordSoul" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is APPackCheck ||
					weapon is APPackCheck2 ||
					weapon is APPackCheck3) CallACS("MiscVarSetDECORATE",11,7);

			// Slot 8
			pm = "PopcornGunNew"; iDTech1Check = pm;
			pm = "GoreBalloonNew"; iDTech1Check2 = pm;
			pm = "GoreBalloonNew"; iDTech1Check3 = pm;
			pm = "NNSigil"; iDTech1Check4 = pm;
			pm = "DSparilStaff"; iDTech1Check5 = pm;
			pm = "DualDSparilStaff"; iDTech1Check6 = pm;
			SkillFactor = 0;
			if (owner.CountInv("UnmakerDVDS")) SkillFactor++;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(iDTech1Check3)) SkillFactor++;
			if (owner.CountInv(iDTech1Check4)) SkillFactor++;
			if (owner.CountInv(iDTech1Check5)) SkillFactor++;
			if (owner.CountInv(iDTech1Check6)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",418,SkillFactor);
			if (weapon is "UnmakerDVDS" ||
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is iDTech1Check3 ||
					weapon is iDTech1Check4 ||
					weapon is iDTech1Check5 ||
					weapon is iDTech1Check6) CallACS("MiscVarSetDECORATE",11,8);

			// Slot 9
			pm = "ScepterofSouls"; iDTech1Check = pm;
			pm = "DualScepterofSouls"; iDTech1Check2 = pm;
			pm = "GasRocketLauncherNew"; iDTech1Check3 = pm;
			pm = "GutFlingerNew"; iDTech1Check4 = pm;
			SkillFactor = 0;
			if (owner.CountInv("EvilWarriorShield")) SkillFactor++; 
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++;
			if (owner.CountInv(iDTech1Check3)) SkillFactor++;
			if (owner.CountInv(iDTech1Check4)) SkillFactor++;
			CallACS("MiscVarSetDECORATE",419,SkillFactor);
			if (weapon is "EvilWarriorShield" || 
					weapon is iDTech1Check ||
					weapon is iDTech1Check2 ||
					weapon is iDTech1Check3 ||
					weapon is iDTech1Check4) CallACS("MiscVarSetDECORATE",11,9);

			// Slot 0
			pm = "ClownGrenadeNew"; iDTech1Check = pm;
			pm = "CrazyBall2New"; iDTech1Check2 = pm;
			SkillFactor = 0;
			if (owner.CountInv(iDTech1Check)) SkillFactor++;
			if (owner.CountInv(iDTech1Check2)) SkillFactor++; 
			CallACS("MiscVarSetDECORATE",420,SkillFactor);
			if (weapon is iDTech1Check ||
					weapon is iDTech1Check2) CallACS("MiscVarSetDECORATE",11,0);
		}
	}
}

class PlayerStatItem3 : Inventory 
{
	const SKILL_VERY_EASY = 0;
	const SKILL_EASY = 1;
	const SKILL_NORMAL = 2;
	const SKILL_HARD = 3;
	const SKILL_VERY_HARD = 4;
	const SKILL_EXTREME = 5;
	const SKILL_HORRIBLE = 6;
	const SKILL_IMPOSSIBLE = 7;
	const SKILL_OMEGA = 8;
	
	override void DoEffect()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (!playeractor) { owner.A_SetInventory("PlayerStatItem3",0); super.DoEffect(); } // Removes itself if given to a non-Aetherius Player Class

		A_PSI3DoEffectDoomSpell1();
		A_PSI3DoEffectDoomSpell2();
		A_PSI3DoEffectDoomSpell3();
		A_PSI3DoEffectDoomSpell4();
		
		
		
		
		
		super.DoEffect();
	}
	
	void A_PSI3DoEffectDoomSpell1()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor) 
		{
		}
	}
	
	void A_PSI3DoEffectDoomSpell2()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor) 
		{
		}
	}
	
	void A_PSI3DoEffectDoomSpell3()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor) 
		{
		}
	}
	
	void A_PSI3DoEffectDoomSpell4()
	{
		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor) 
		{
		}
	}
}

// Resistance code [w/ some help from argv :V]
class Resistances : Inventory 
{
	default 
	{
		//Powerup.Duration 0xFFFFFFFD;
		+Inventory.PERSISTENTPOWER;
		+Inventory.UNDROPPABLE;
		+Inventory.UNTOSSABLE;
	}

	override void AbsorbDamage(int damage, Name damageType, out int newdamage) 
	{
		if (damageType == 'HellcoreDrain') { return; }

		let globalvars = DSGlobalVariables.Get();
		let playeractor = AetheriusPlayerPawn(owner);
		if (playeractor && playeractor.saveddamage > 0 && damage == 0) 
		{
			if (dvdsdebug_playerdmgdisplays) Console.Printf("    (\cz[STEP 9.5] Flora PRE-Armor input Safeguard\c-: \cwDmgType\c- = \cw%s\c-, \cyolddmg\c- = \cy%d\c-, \cynewdmg\c- = \cy%d\c-)", 
																					 damageType, damage, playeractor.saveddamage);
			damage = playeractor.saveddamage; 
			playeractor.saveddamage = 0; 
		}
		int olddamage = damage;
		double BaseIgnoreFactor, ArmorIgnoreFactor, ArmorIgnoreFactor2, ArmorIgnoreFactor3;
		double resist = 0;
		double resistN = 0;
		int ArmorItemsAmt = 0;
		if (Owner.CountInv("SafeTeaShoes"))					ArmorItemsAmt++;
		if (Owner.CountInv("PearlyCorset"))					ArmorItemsAmt++;
		if (Owner.CountInv("WaterFlyingDress"))			ArmorItemsAmt++;
		if (Owner.CountInv("EvenstarNecklace"))			ArmorItemsAmt++;
		if (Owner.CountInv("CloakofEvasion"))				ArmorItemsAmt++;
		if (Owner.CountInv("AnubisCufflinks"))			ArmorItemsAmt++;
		if (Owner.CountInv("KissaBra"))							ArmorItemsAmt++;
		if (Owner.CountInv("DivineShield"))					ArmorItemsAmt++;
		if (Owner.CountInv("BalrogRing"))						ArmorItemsAmt++;
		if (Owner.CountInv("DoveRibbon"))						ArmorItemsAmt++;
		if (Owner.CountInv("FalconKnifeEarrings"))	ArmorItemsAmt++;

		// Calculates any non-normal damage type in a separate factor
		for (let inv = Owner.Inv; inv != NULL; inv = inv.Inv)
		{
			if (inv is "ResistanceGrantingItem") resist += ResistanceGrantingItem(inv).GetResistForDamageType(damageType);
		}
		if (playeractor.PlayerArmorIgnoreFactor > 0.00)
		{
			ArmorIgnoreFactor = resist * playeractor.PlayerArmorIgnoreFactor;
			resist -= ArmorIgnoreFactor;
		}
		newdamage = ceil(damage * (1.0 - resist));

		// "Normal" Damage Type is counted separately from other resistances
		int newdmg1 = newdamage;
		if (damageType != 'Drowning')
		{
			for (let inv = Owner.Inv; inv != NULL; inv = inv.Inv)
			{
				if (inv is "ResistanceGrantingItem") resistN += ResistanceGrantingItem(inv).ResistNormal;
			}
		}
		if (playeractor.PlayerArmorIgnoreFactorGeneral > 0.00)
		{
			ArmorIgnoreFactor2 = resistN * playeractor.PlayerArmorIgnoreFactorGeneral;
			resistN -= ArmorIgnoreFactor2;
		}
		if (Owner.CountInv("PlayingStrangeAeons") && damageType == 'ScrollFloor') 
		{
			resistN *= (0.5 + (random[statitem](-5,5) * 0.01));
		}

		newdamage = ceil(newdmg1 * (1.0 - resistN));
		int tempdamage = newdamage;

		// The "Omniblock" Bonus from the Divine Shield is Armor based defense, so it gets placed here now 
		// instead of PlayerStatItem [which also prevents standard def-ignoring attacks from bypassing it]
		int shieldblockdmg1 = newdamage;
		int ShieldBonusOn = 0;
		double DivineShieldBlockChance = 0.0;
		double DivShldBonus = 0.0;
		if (Owner.CountInv("DivineShield"))
		{
			DivineShieldBlockChance += 7.8; // 13.0
			DivShldBonus += 0.042; // 0.07
			if (Owner.CountInv("SafeTeaShoes"))					{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("PearlyCorset"))					{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("WaterFlyingDress"))			{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("EvenstarNecklace"))			{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("CloakofEvasion"))				{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("AnubisCufflinks"))			{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("KissaBra"))							{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("BalrogRing"))						{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("DoveRibbon"))						{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (Owner.CountInv("FalconKnifeEarrings"))	{ DivineShieldBlockChance += 1.3; DivShldBonus += 0.042; }
			if (playeractor.PlayerArmorIgnoreFactorGeneral > 0.00)
			{
				ArmorIgnoreFactor3 = DivShldBonus * playeractor.PlayerArmorIgnoreFactorGeneral;
				DivShldBonus -= ArmorIgnoreFactor3;
				
				if (Owner.CountInv("PlayingStrangeAeons") && damageType == 'ScrollFloor') 
				{
					DivShldBonus *= (0.5 + (random[statitem](-5,5) * 0.01));
				}
			}

			if (frandom[statitem2](0.001,100.000) <= DivineShieldBlockChance)
			{ 
				ShieldBonusOn = 1;
				newdamage = ceil(shieldblockdmg1 * (1.0 - DivShldBonus));
				owner.A_StartSound("SceptreEmpyrea/Reflect",random[statitem](35,37));
			}
		}
		if ((damageType != 'Holy') && (olddamage > 1 && newdamage < 1)) newdamage = 1;
		int tempdamage2 = newdamage;

		if (dvdsdebug_playerdmgdisplays)
		{
			if (ArmorItemsAmt > 0) Console.Printf("    (\cz[STEP 10] Flora Armor input\c-: \cwDmgType\c- = \cw%s\c-, \cyolddmg\c- = \cy%d\c-, \cydmg\c- = \cy%d\c-, \cares\c- = \ca%.4f\c-, \cynewdmg1\c- = \cy%d\c-, \caresN\c- = \ca%.4f\c-, \cyfinaldmg\c- = \cy%d\c-, \cxArmorIgnoreFactor\c- = \cx%.8f\c-, \cwArmorIgnoreFactor2\c- = \cw%.8f\c-)", damageType, olddamage, damage, resist, newdmg1, resistN, tempdamage, ArmorIgnoreFactor, ArmorIgnoreFactor2);
												else Console.Printf("    (\cz[STEP 10] Flora Armor input\c-: \caSKIPPED\c-, \cyolddmg\c- = \cy%d\c-, \cydmg = %d\c-)", olddamage, newdmg1);

			if (ShieldBonusOn > 0) Console.Printf("    (\cz[STEP 11] Flora Omniblock Input\c-: \cwDmgType\c- = \cw%s\c-, \cyshieldblockdmg1\c- = \cy%d\c-, \caDivShldBonus\c- = \ca%.4f\c-, \cyfinaldmg\c- = \cy%d\c-, \cwArmorIgnoreFactor3\c- = \cw%.8f\c-)", damageType, shieldblockdmg1, DivShldBonus, tempdamage2, ArmorIgnoreFactor3);
												else Console.Printf("    (\cz[STEP 11] Flora Omniblock Input\c-: \caSKIPPED\c-, \cydmg = %d\c-)", shieldblockdmg1);
		}
	}

	States
	{
		Use:
			TNT1 A 0;
			Stop;
	}
}

class ResistanceGrantingItem : AetheriusCustomInventory 
{
	double ResistNormal, ResistPhysical, ResistMelee, ResistBullet, ResistMagic;
	double ResistFire, ResistIce, ResistThunder, ResistHoly, ResistDark, ResistWind, ResistEarth;
	double ResistSlime, ResistMagma, ResistCrush, ResistDrowning, ResistFalling, ResistExplosive;
	double ResistSceptre, ResistFist, ResistKick, ResistGauntlets, ResistChainsaw;
	double ResistAcid, ResistPoison;

	property ResistNormal: ResistNormal;
	property ResistPhysical: ResistPhysical;
	property ResistMelee: ResistMelee;
	property ResistBullet: ResistBullet;
	property ResistMagic: ResistMagic;

	property ResistFire: ResistFire;
	property ResistIce: ResistIce;
	property ResistThunder: ResistThunder;
	property ResistHoly: ResistHoly;
	property ResistDark: ResistDark;
	property ResistWind: ResistWind;
	property ResistEarth: ResistEarth;

	property ResistSlime: ResistSlime;
	property ResistMagma: ResistMagma;
	property ResistCrush: ResistCrush;
	property ResistDrowning: ResistDrowning;
	property ResistFalling: ResistFalling;
	property ResistExplosive: ResistExplosive;

	property ResistSceptre: ResistSceptre;
	property ResistFist: ResistFist;
	property ResistKick: ResistKick;
	property ResistGauntlets: ResistGauntlets;
	property ResistChainsaw: ResistChainsaw;

	property ResistAcid: ResistAcid;
	property ResistPoison: ResistPoison;
    
	double GetResistForDamageType(Name damageType) 
	{
		if (damageType == 'Physical') return ResistPhysical;
		else 
		if (damageType == 'Melee' || 
				damageType == 'Trample' || 
				damageType == 'Stomp' || 
				damageType == 'Fist' || 
				damageType == 'Kick' || 
				damageType == 'Chainsaw' || 
				damageType == 'Gauntlets') return ResistMelee;
		else
		if (damageType == 'Bullet' || 
				damageType == 'Railgun') return ResistBullet;
		else 
		if (damageType == 'Magic' || 
				damageType == 'Zap' || 
				damageType == 'Eldritch' || 
				damageType == 'Deadlight') return ResistMagic;
		else
		if (damageType == 'Fire' ||
				damageType == 'Flames' ||
				damageType == 'CCardsEyeFire' ||
				damageType == 'Burn' ||
				damageType == 'Inferno' ||
				damageType == 'Flare' ||
				damageType == 'Solar' ||
				damageType == 'Boiling')
				return ResistFire;
		else 
		if (damageType == 'Ice' ||
				damageType == 'IceWater' ||
				damageType == 'Frost' ||
				damageType == 'Chill') return ResistIce;
		else 
		if (damageType == 'Thunder' || 
				damageType == 'Electric' || 
				damageType == 'Shock' || 
				damageType == 'Lightning') return ResistThunder;
		else if (damageType == 'Holy')
				return ResistHoly;
		else if (damageType == 'Dark')
				return ResistDark;
		else if (damageType == 'Wind')
				return ResistWind;
		else if (damageType == 'Earth')
				return ResistEarth;
		else if (damageType == 'Slime')
				return ResistSlime;
		else 
		if (damageType == 'Lava' || 
				damageType == 'Magma') return ResistMagma;
		else if (damageType == 'Crush')
				return ResistCrush;
		else if (damageType == 'Drowning')
				return ResistDrowning;
		else if (damageType == 'Falling')
				return ResistFalling;
		else 
		if (damageType == 'Explosive' || 
				damageType == 'ExplosiveImpact' || 
				damageType == 'CC_Firecracker' || 
				damagetype == 'MOD_ROCKET' || 
				damagetype == 'MOD_R_SPLASH' || 
				damagetype == 'MOD_BARREL') return ResistExplosive;
		else if (damageType == 'Sceptre') return ResistSceptre;
		else if (damageType == 'Fist') return ResistFist;
		else if (damageType == 'Kick') return ResistKick;
		else if (damageType == 'Gauntlets') return ResistGauntlets;
		else if (damageType == 'Chainsaw') return ResistChainsaw;
		else if (damageType == 'Acid') return ResistAcid;
		else 
		if (damageType == 'Poison' || 
				damageType == 'PoisonElemental') return ResistPoison;
		else
				return 0;
	}

	States
	{
		Use:
			TNT1 A 0;
			Stop;
	}
}

class BaseFloraArmorItemZSC : ResistanceGrantingItem
{
	int loopernum;
	default
	{
		radius 20;
		height 20;
		scale 0.33;
		//Alpha 0.1 RenderStyle "Add"
		mass 666;
		+DONTGIB;
		+FLOATBOB;
		+INVENTORY.ALWAYSPICKUP;
		+INVENTORY.BIGPOWERUP;
	}
	property loopernum: loopernum;
	
	int gfxeffectlvl;

	override void PostBeginPlay()
	{
		if (CountInv("PlayingDoom64",AAPTR_PLAYER1)) { scale.x * 1.2; scale.y * 1.2; }
		//This space for rent.
		Super.PostBeginPlay();
	}

	override void Tick()
	{
		if (Owner == null)
		{
			gfxeffectlvl = dvds_gfxeffectlevel;
			A_CheckFloraArmorCopies(loopernum); // ACS_NamedExecuteAlways("CheckFloraArmorCopies",0,loopernum,0,0);
			if (A_CheckRange(1024,"Null")) { } else { if (gfxeffectlvl == 0) { A_SpawnItemEx("ArmorGlitter", 0, 0, 16, random[statitem](-2,2), random[statitem](-2,2), random[statitem](-2,2) ,64); } }
			if (A_CheckRange(1024,"Null")) { } else { if (gfxeffectlvl <= 1) { A_SpawnItemEx("ArmorGlitter", 0, 0, 16, random[statitem](-2,2), random[statitem](-2,2), random[statitem](-2,2) ,128); } }
			if (A_CheckRange(1024,"Null")) { } else { if (gfxeffectlvl <= 2) { A_SpawnItemEx("ArmorGlitter", 0, 0, 16, random[statitem](-2,2), random[statitem](-2,2), random[statitem](-2,2) ,192); } }
			if ((GetAge() % 42) == 41)
			{
				A_StopSound(CHAN_ITEM);
				A_StartSound("FloraArmor/Hum",CHAN_ITEM);
			}
		}
		Super.Tick(); 
	}

	States
	{
		Spawn:
			FAMR A 0 bright NoDelay;
			loop;
		Use:
			TNT1 A 0;
			Stop;
		Pickup:
			// Other Things
			TNT1 A 0 A_JumpIf(CallACS("CheckPlayerIfDead") == 1,2);
			TNT1 A 0 A_StartSound("generalequip", 5);
			TNT1 A 0;
			Stop;
	}
}

// Item 1
class SafeTeaShoes : BaseFloraArmorItemZSC
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRA0"
		inventory.icon "FAMRA0";
		Inventory.PickupMessage "Got the \chSafe Tea Shoes\c-!!";
		ResistanceGrantingItem.ResistSlime 0.275;
		ResistanceGrantingItem.ResistMagma 0.275;
		ResistanceGrantingItem.ResistNormal 0.03;
		ResistanceGrantingItem.ResistMagic 0.0125;
		ResistanceGrantingItem.ResistFalling 0.75;
		BaseFloraArmorItemZSC.loopernum 1;
	}

	override void DoEffect() 
	{
		ResistSlime = 0.25 + (0.005 * random[safeteashoes](0,10));
		//if (dvdsdebug_playerdmgdisplays) Console.Printf("    (\czFloraArmorAbsorb\c-: ResistSlime = %.8f)", ResistSlime);
		Super.DoEffect(); 
	}

	States
	{
		Spawn:
			FAMR A 1 bright NoDelay;
			loop;
	}
}

// Item 2
class PearlyCorset : BaseFloraArmorItemZSC
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRB0"
		inventory.icon "FAMRB0";
		Inventory.PickupMessage "Got the \chPearly Corset\c-!!";
		ResistanceGrantingItem.ResistNormal 0.07;
		ResistanceGrantingItem.ResistFire 0.02;
		ResistanceGrantingItem.ResistMagma 0.02;
		ResistanceGrantingItem.ResistIce 0.02;
		ResistanceGrantingItem.ResistThunder 0.02;
		ResistanceGrantingItem.ResistDark 0.25;
		ResistanceGrantingItem.ResistMagic 0.025;
		ResistanceGrantingItem.ResistBullet 0.25;
		BaseFloraArmorItemZSC.loopernum 2;
	}

	States
	{
		Spawn:
			FAMR B 1 bright NoDelay;
			loop;
	}
}

// Item 3
class WaterFlyingDress : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRC0"
		inventory.icon "FAMRC0";
		Inventory.PickupMessage "Got the \chWater Flying Dress\c-!!";
		ResistanceGrantingItem.ResistNormal 0.08;
		ResistanceGrantingItem.ResistFire 0.3;
		ResistanceGrantingItem.ResistMagma 0.3;
		ResistanceGrantingItem.ResistMagic 0.25;
		ResistanceGrantingItem.ResistBullet 0.15;
		ResistanceGrantingItem.ResistExplosive 0.20;
		BaseFloraArmorItemZSC.loopernum 3;
	}

	States
	{
		Spawn:
			FAMR C 1 bright NoDelay;
			loop;
	}
}

// Item 4
class EvenstarNecklace : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRD0"
		inventory.icon "FAMRD0";
		Inventory.PickupMessage "Got the \chEvenstar Necklace\c-!!";
		ResistanceGrantingItem.ResistNormal 0.02;
		ResistanceGrantingItem.ResistFire 0.2;
		ResistanceGrantingItem.ResistMagma 0.2;
		ResistanceGrantingItem.ResistIce 0.2;
		ResistanceGrantingItem.ResistThunder 0.2;
		ResistanceGrantingItem.ResistDark 0.2;
		ResistanceGrantingItem.ResistMagic 0.2;
		BaseFloraArmorItemZSC.loopernum 4;
	}

	States
	{
		Spawn:
			FAMR D 1 bright NoDelay;
			loop;
	}
}

// Item 5
class CloakOfEvasion : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRE0"
		inventory.icon "FAMRE0";
		Inventory.PickupMessage "Got the \chCloak of Evasion\c-!!";
		ResistanceGrantingItem.ResistNormal 0.04;
		ResistanceGrantingItem.ResistIce 0.05;
		ResistanceGrantingItem.ResistThunder 0.025;
		ResistanceGrantingItem.ResistBullet 0.1;
		BaseFloraArmorItemZSC.loopernum 5;
	}

	States
	{
		Spawn:
			FAMR E 1 bright NoDelay;
			loop;
	}
}

// Item 6
class AnubisCufflinks : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRF0"
		inventory.icon "FAMRF0";
		Inventory.PickupMessage "Got the \chAnubis Cufflinks\c-!!";
		ResistanceGrantingItem.ResistNormal 0.05;
		ResistanceGrantingItem.ResistThunder 0.0625;
		ResistanceGrantingItem.ResistBullet 0.1;
		BaseFloraArmorItemZSC.loopernum 6;
	}

	States
	{
		Spawn:
			FAMR F 1 bright NoDelay;
			loop;
	}
}

// Item 7
class KissaBra : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRG0"
		inventory.icon "FAMRG0";
		Inventory.PickupMessage "Got \chKissa's Armored Brasseire\c-!!";
		ResistanceGrantingItem.ResistNormal 0.06;
		ResistanceGrantingItem.ResistBullet 0.2;
		BaseFloraArmorItemZSC.loopernum 7;
	}

	States
	{
	Spawn:
		FAMR G 1 bright NoDelay;
		loop;
	}
}

// Item 8
class DivineShield : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRH0"
		inventory.icon "FAMRH0";
		Inventory.PickupMessage "Got the \chDivine Shield\c-!!";
		ResistanceGrantingItem.ResistNormal 0.16;
		ResistanceGrantingItem.ResistFire 0.25;
		ResistanceGrantingItem.ResistMagma 0.25;
		ResistanceGrantingItem.ResistIce 0.25;
		ResistanceGrantingItem.ResistThunder 0.25;
		ResistanceGrantingItem.ResistDark 0.25;
		ResistanceGrantingItem.ResistMagic 0.3;
		BaseFloraArmorItemZSC.loopernum 9;
	}

	States
	{
		Spawn:
			FAMR H 1 bright NoDelay;
			loop;
	}
}

// Item 9
class BalrogRing : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRI0"
		inventory.icon "FAMRI0";
		Inventory.PickupMessage "Got the \chBalrog's Ring\c-!!";
		ResistanceGrantingItem.ResistNormal 0.02;
		ResistanceGrantingItem.ResistFire 0.15;
		ResistanceGrantingItem.ResistMagma 0.15;
		ResistanceGrantingItem.ResistIce 0.225;
		ResistanceGrantingItem.ResistExplosive 0.25;
		BaseFloraArmorItemZSC.loopernum 10;
	}

	States
	{
		Spawn:
			FAMR I 1 bright NoDelay;
			loop;
	}
}

// Item 10
class DoveRibbon : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRJ0"
		inventory.icon "FAMRJ0";
		Inventory.PickupMessage "Got the \chDove's Ribbon\c-!!";
		ResistanceGrantingItem.ResistNormal 0.09;
		ResistanceGrantingItem.ResistFire 0.0125;
		ResistanceGrantingItem.ResistMagma 0.0125;
		ResistanceGrantingItem.ResistIce 0.0625;
		ResistanceGrantingItem.ResistThunder 0.15;
		ResistanceGrantingItem.ResistDark 0.125;
		ResistanceGrantingItem.ResistMagic 0.0625;
		ResistanceGrantingItem.ResistBullet 0.05;
		BaseFloraArmorItemZSC.loopernum 11;
	}

	States
	{
		Spawn:
			FAMR J 1 bright NoDelay;
			loop;
	}
}

// Item 11
class FalconKnifeEarrings : BaseFloraArmorItemZSC 
{
	default
	{
		//$Category DV-DS Armor Items
		//$Sprite "FAMRK0"
		inventory.icon "FAMRK0";
		Inventory.PickupMessage "Got the \chFalcon Knife Earrings\c-!!";
		ResistanceGrantingItem.ResistNormal 0.05;
		BaseFloraArmorItemZSC.loopernum 12;
	}

	States
	{
		Spawn:
			FAMR K 1 bright NoDelay;
			loop;
	}
}

/////////////////////////////////////////////////////////////DASH
// Dash and double jump code by TheCamaleonMaligno ( https://www.youtube.com/watch?v=mTfGxY_Afhs )
// This code is heavily modified from the "Hell Crusher" variation of it :V
class PlayerDashJump : Inventory
{
	const SKILL_VERY_EASY = 0;
	const SKILL_EASY = 1;
	const SKILL_NORMAL = 2;
	const SKILL_HARD = 3;
	const SKILL_VERY_HARD = 4;
	const SKILL_EXTREME = 5;
	const SKILL_HORRIBLE = 6;
	const SKILL_IMPOSSIBLE = 7;
	const SKILL_OMEGA = 8;
	
	int itemtimer;
	string nm, nn, no, np, nq, nr;
	
	int DashTimer;
	int TrueGameSkill;
	actor weapon;
	int HellWarriorShieldLevel;
	Double DashDir, DashSpeed, DashVSpeed, DashPitch;
	Int DashTics, DashCharge, AirTics, DashCost, DashCooldown, MaxDashCooldown;
	Bool DJump, Waiting;
	string dashgruntsound;
	int dashgruntchance;
	int dashtype;
	int airdashtype;
	Int MaxDashes, MaxDashTics;
	bool slownthres1, slownthres2, slownthres3;
	bool berserked;
	int PlayerLevel;
	int TruePlayerLevel;
	int firsttic;
	int input, oldInput, taps, taptics, last;
	
	Default
	{
		+Inventory.PERSISTENTPOWER
		+Inventory.UNDROPPABLE
		+Inventory.UNTOSSABLE
		+Inventory.UNCLEARABLE;
	}
	
	int A_CheckActualLevel(int type = 0)
	{
		actor player = players[0].mo;
		let MiscItem = PlayerStatItem(Player.FindInventory("PlayerStatItem"));

		int Level = 0;
		if (MiscItem)
		{
			if (dvds_expgains) Level = MiscItem.PlayerLevel;
		}
		if (dvdsdebug_playerlevelchecks) Console.Printf("\c[green](%s) \c[gold](A_CheckActualLevel - PlayerDashJump)\c- PlayerLevel: %d [%d]", GetClassName(), level, gametic);
		return Level;
	}
	
	int IsButtonPressed (int input, int oldInput, int mask)
	{
		return (input & ~oldInput) & mask;
	}
	
	void A_DashDamage(int type = 0, name dashtype = "Dashing", double basedmginc = 0.125, double baseradinc = 0.25)
	{
		let globalvars = DSGlobalVariables.Get();
		let MiscItem = PlayerStatItem(Owner.FindInventory("PlayerStatItem"));
		int ActualLevel;
		int TruePlayerSTR;
		int TruePlayerDEF;
		int TruePlayerSOR;
		int TruePlayerTHE;
		int TruePlayerAGL;
		int TruePlayerDFT;
		int SceptreLevel;
		if (MiscItem)
		{
			ActualLevel = MiscItem.PlayerLevel;
			TruePlayerSTR = MiscItem.PlayerSTR;
			TruePlayerDEF = MiscItem.PlayerDEF;
			TruePlayerSOR = MiscItem.PlayerSOR;
			TruePlayerTHE = MiscItem.PlayerTHE;
			TruePlayerAGL = MiscItem.PlayerAGL;
			TruePlayerDFT = MiscItem.PlayerDFT;
			SceptreLevel = MiscItem.SceptreActualLevel;
			
			double DashDmg;
			double DashRad;
			owner.bFORCERADIUSDMG = true;
			
			if (type == 0) // Sceptre Dash
			{
				DashDmg = (random[statitem](30,40) * random[statitem](2,5));
				DashDmg += ((TruePlayerAGL * 0.15625) + (TruePlayerSTR * 0.0390625) + (ActualLevel * 0.078125));
				DashRad = (owner.radius * 5.0) + frandom[statitem](-3.334,3.334);
			}
			if (type == 1) // Sceptre Dash w/ Berserk
			{
				DashDmg = ((random[statitem](16,24) + random[statitem](30,40)) * random[statitem](2,5));
				DashDmg += ((TruePlayerAGL * 0.3125) + (TruePlayerSTR * 0.078125) + (ActualLevel * 0.15625));
				DashRad = (owner.radius * 5.0) + frandom[statitem](-10.0,10.0);
			}
			if (type == 2) // Non Sceptre Dash [default]
			{
				DashDmg = (random[statitem](8,12) * random[statitem](1,3));
				DashRad = (owner.radius * 2.25) + frandom[statitem](-1.5,1.5);
			}
			if (type == 3) // Non Sceptre Dash [berserked, default]
			{
				DashDmg = (random[statitem](2,5) + random[statitem](8,12) * random[statitem](1,3));
				DashRad = (owner.radius * 3.125) + frandom[statitem](-2.0834375,2.0834375);
			}
			if (type == 4) // Hell Warrior Shield
			{
				DashDmg = (random[statitem](3,6) * random[statitem](2,4));
				DashDmg += ((TruePlayerAGL * 0.625) + (TruePlayerSTR * 0.15625) + (ActualLevel * 0.3125));
				
				DashRad = (owner.radius * 4.5) + frandom[statitem](-6.0,6.0);
			}
			if (type == 5) // Hell Warrior Shield [berserked]
			{
				DashDmg = ((random[statitem](4,10) + random[statitem](3,6)) * random[statitem](2,4));
				DashDmg += ((TruePlayerAGL * 1.25) + (TruePlayerSTR * 0.3125) + (ActualLevel * 0.625));

				DashRad = (owner.radius * 4.5) + frandom[statitem](-6.0,6.0);
			}

			if (type >= 0 && type <= 1)
			{
				DashDmg *= (0.5 + (SceptreLevel * 0.0625));
				DashRad *= (0.75 + (SceptreLevel * 0.03125));
				dashtype = "Sceptre";
			}
			if (type >= 2 && type <= 3) 
			{
				dashtype = "Dashing";
			}
			if (type >= 4 && type <= 5) 
			{
				DashDmg *= (0.5 + (MiscItem.HellWarriorShieldLevel * 0.125));
				DashRad *= (0.75 + (MiscItem.HellWarriorShieldLevel * 0.0625));
				dashtype = "DashingSD";
			}

			if (owner.waterlevel == 1) 
			{
				DashDmg *= (1.0 + basedmginc);
				DashRad *= (1.0 + baseradinc);
			}
			if (owner.waterlevel == 2) 
			{
				DashDmg *= (1.0 + (basedmginc * 2));
				DashRad *= (1.0 + (baseradinc * 2));
			}
			if (owner.waterlevel >= 3) 
			{
				DashDmg *= (1.0 + (basedmginc * 3));
				DashRad *= (1.0 + (baseradinc * 3));
			}
			Owner.A_Explode(Dashdmg,DashRad,XF_NOTMISSILE,false,(DashRad*0.5),0,0,"",dashtype);
		}

	}
	
	override void Tick()
	{
		Super.Tick();
		if (!Owner || Owner && (!Owner.Player || Owner.Health < 1)) Return;
		
		let globalvars = DSGlobalVariables.Get();
		let MiscItem = PlayerStatItem(Owner.FindInventory("PlayerStatItem"));
		weapon = owner.player.ReadyWeapon;
		if (Owner.CountInv("PowerStrength") || Owner.CountInv("AetheriusPowerStrength")) berserked = true;
		else berserked = false;
		
		TrueGameSkill = dvds_gendifficultycurve + Skill;
		HellWarriorShieldLevel = CallACS("MiscVarCheckDECORATE",300); //owner.CountInv("HellWarriorShieldLevel");
		
		PlayerInfo PlayDash = Owner.Player;
		Int BTInput = PlayDash.cmd.buttons;
		dashgruntchance = randompick[statitem](66,66,67);
		MaxDashes = 1;
		double dashsndvol = 0.67;
		double dashgruntsndvol = 1.0;
		PlayerLevel = owner.CountInv("PlayerLevel");
		if (dvds_expgains) TruePlayerLevel = PlayerLevel; else TruePlayerLevel = 0;
		int ActualLevel;
		int TruePlayerSTR;
		int TruePlayerDEF;
		int TruePlayerSOR;
		int TruePlayerTHE;
		int TruePlayerAGL;
		int TruePlayerDFT;
		if (MiscItem)
		{
			ActualLevel = MiscItem.PlayerLevel;
			TruePlayerSTR = MiscItem.PlayerSTR;
			TruePlayerDEF = MiscItem.PlayerDEF;
			TruePlayerSOR = MiscItem.PlayerSOR;
			TruePlayerTHE = MiscItem.PlayerTHE;
			TruePlayerAGL = MiscItem.PlayerAGL;
			TruePlayerDFT = MiscItem.PlayerDFT;
		}
		
		//******************
		//*Check Dash Timer*
		//******************
		int dashtrailinterval = level.time % random[statitem](1,4);
		int dashveltimer;
		int dashveltimer2;
		double dashtimermulti = 1.0;
		if (owner.CountInv("SafeTeaShoes")) dashtimermulti += 0.125;
		if (owner.CountInv("CloakofEvasion")) dashtimermulti += 0.0625;
		if (owner.CountInv("DoveRibbon")) dashtimermulti += 0.0625;
		
		double trueanglecos = abs(cos(angle));
		double trueanglesin = abs(sin(angle));
		if (dvdsdebug_showdashinformation) Console.Printf("[angle] cos: %.8f, sin: %.8f", trueanglecos, trueanglesin);
		
		MaxDashTics = 18;
		if (dvds_allowdashing > 0)
		{
			MaxDashTics = 18 + (CallACS("MiscVarCheckDECORATE",31) / 32);
			if (CountInv("HWShieldBlockHold"))
			{
				MaxDashTics *= frandompick[statitem](1.5,1.5,1.5,1.5,1.5,1.625,1.625,1.75);
			}
			if (dvds_allowdashing > 2) MaxDashTics *= 0.5;
		}
		MaxDashTics *= dashtimermulti;
		CallACS("MiscVarSetDECORATE",91,MaxDashTics);
		dashveltimer = DashTimer % 2;
		dashveltimer2 = DashTimer % 1;
		
		DashCharge = CallACS("MiscVarCheckDECORATE",21);
		double DashSpdMul = 1.00;
		DashSpeed = (25 + (ActualLevel * 0.03125));
		if (Owner.waterlevel == 1) DashSpdMul = 0.9375;
		if (Owner.waterlevel == 2) DashSpdMul = 0.875;
		if (Owner.waterlevel >= 3) DashSpdMul = 0.75;

		DashSpeed *= DashSpdMul;
		if (berserked) DashSpeed *= 1.03125;
		if (dvdsdebug_showdashinformation) Console.Printf("DashSpeed: %.8f", DashSpeed);
		
		DashCost = CallACS("MiscVarCheckDECORATE",638);
		MaxDashCooldown = CallACS("MiscVarCheckDECORATE",637);
		
		if (owner.CountInv("NormalHealth")) 
		{
			DashCost *= 1.0;
			MaxDashCooldown *= 1.0;
		}
		if (owner.CountInv("DecentHealth")) 
		{
			DashCost *= 1.125;
			MaxDashCooldown *= 1.1875;
		}
		if (owner.CountInv("LowHealth")) 
		{
			DashCost *= 1.25;
			MaxDashCooldown *= 1.375;
		}
		if (owner.CountInv("CriticalHealth"))
		{
			DashCost *= 1.5;
			MaxDashCooldown *= 1.75;
		}

		if (berserked) MaxDashCooldown *= 0.625;
		double ssa = 1.0;
		// Future Placement for Sauron/Armor Perm Items
		DashCost *= ssa;
		ssa = 1.0;
		// Future Placement for Sauron/Armor Perm Items
		MaxDashCooldown *= ssa;
		if (skill <= 0 && DashCost <= 8) DashCost = 8;
		if (skill == 1 && DashCost <= 16) DashCost = 16;
		if (skill == 2 && DashCost <= 24) DashCost = 24;
		if (skill == 3 && DashCost <= 32) DashCost = 32;
		if (skill >= 4 && DashCost <= 40) DashCost = 40;
		if (skill <= 0 && MaxDashCooldown <= 1) MaxDashCooldown = 1;
		if (skill == 1 && MaxDashCooldown <= 1) MaxDashCooldown = 1;
		if (skill == 2 && MaxDashCooldown <= 2) MaxDashCooldown = 2;
		if (skill == 3 && MaxDashCooldown <= 2) MaxDashCooldown = 2;
		if (skill >= 4 && MaxDashCooldown <= 3) MaxDashCooldown = 3;
		
		bool doubletapdash = GetCVar("dvds_doubledash");
		if (dvdsdebug_showdashinformation) Console.Printf("DashCost [start]: %d, DashCooldown: %d", DashCost, MaxDashCooldown);
		airdashtype = 0;
		// 0 = No loss of altitude
		// 1 = Start with a short "hop" but fall to the ground afterwards.
		
		double settings[2][4];
		settings[0][0] = BT_FORWARD;
		settings[1][0] = 0.00;
		settings[0][1] = BT_MOVELEFT;
		settings[1][1] = 0.25;
		settings[0][2] = BT_BACK;
		settings[1][2] = 0.50;
		settings[0][3] = BT_MOVERIGHT;
		settings[1][3] = 0.75;
		oldInput = owner.GetPlayerInput(INPUT_OLDBUTTONS);

		int pushingdirection = 0;
		If (BTInput & BT_FORWARD) pushingdirection += 1;
		If (BTInput & BT_BACK) pushingdirection += 2;
		If (BTInput & BT_MOVELEFT) pushingdirection += 4;
		If (BTInput & BT_MOVERIGHT) pushingdirection += 8;
		
		int dashtapwindow = 8;
		bool dashactivated = false;
		if (doubletapdash)
		{
			if (dvdsdebug_showdashinformation) Console.Printf("\cy[double-tap dashing enabled]:\c- doubletapdash: %d, taps: %d, BTInput: %d", doubletapdash, taps, BTInput);
			for (int i = 0; i < 4; i++)
			{
				input = BTInput;
				if (CallACS("MiscVarCheckDECORATE",639) > 0)
				{
					if (IsButtonPressed(input, oldInput, settings[0][i]) && DashCharge >= DashCost && dvds_allowdashing > 0) // DV-DS version also requires a minimal amount of Stamina and the Dash option on to perform
					{
						taps++;
						taptics = dashtapwindow;

						if (taps >= 2 && last == i)
						{
							taps = 0;
							input = 0;
							oldinput = 0;
							dashactivated = true;
						}
						last = i;
					}
				}
			}
			
			If (taptics)
			{
				taptics--;
				If (!taptics)
				{
					taps = 0;
				}
			}
		}
		else
		{
		 if (!doubletapdash && (BTInput & BT_USER3)) dashactivated = true;
		}
		
		if (!Waiting &&
				!owner.CountInv("NoDashing") &&
				dashactivated && 
				DashCharge >= DashCost && 
				dvds_allowdashing > 0 &&
				pushingdirection &&
				!DashTics &&
				DashCooldown == 0)
		{
			taptics = 0;
			taps = 0;
			//Console.Printf("OnGround: %d", PlayDash.OnGround);
			DashDir = 0;
			If (BTInput & BT_FORWARD) DashDir = 0;
			If (BTInput & BT_BACK) DashDir = 180;
			If (BTInput & BT_MOVELEFT) DashDir = 90;
			If (BTInput & BT_MOVERIGHT) DashDir = -90;
			If ((BTInput & BT_FORWARD) && (BTInput & BT_MOVELEFT)) DashDir = 45;
			If ((BTInput & BT_FORWARD) && (BTInput & BT_MOVERIGHT)) DashDir = -45;
			If ((BTInput & BT_BACK) && (BTInput & BT_MOVELEFT)) DashDir = (180 - 45);
			If ((BTInput & BT_BACK) && (BTInput & BT_MOVERIGHT)) DashDir = (180 + 45);
			DashDir += Owner.Angle;
			DashPitch = Owner.Pitch;
			if (BTInput & BT_FORWARD) DashPitch *= 1.0;
			else if (BTInput & BT_BACK) DashPitch *= -1.0;

			DashCharge -= DashCost;
			if (DashCharge <= 0) DashCharge = 0;
			CallACS("MiscVarSetDECORATE",21,DashCharge);
			
			// Dash "Speed"
			DashTics = MaxDashTics;
			if (PlayDash.OnGround)
			{
				dashtype = 0;
				Owner.A_StartSound("player/dash",CHAN_BODY,CHANF_OVERLAP,dashsndvol);
			}
			else
			{
				dashtype = 1; // Airdash
				if (airdashtype != 1) DashSpeed *= 0.8;
				DashVSpeed = (5 * (ActualLevel * 0.025));
				if (berserked) DashVSpeed *= 1.04;
				Owner.A_StartSound("player/airjump",CHAN_BODY,CHANF_OVERLAP,dashsndvol);
			}
			
			if (owner.CountInv("HWShieldBlockHold")) 
			{
				Owner.A_StartSound("shielddash1", randompick[statitem](180,181), CHANF_OVERLAP, frandom[statitem](0.65,0.95), ATTN_NORM, frandom[statitem](0.667,1.333));
			}
			
			if (random[statitem](1,100) <= dashgruntchance)
			{
				int dashgruntrand = 0;
				if (Owner.GetClassName() == "FloraBriscoletti") dashgruntsound = "FloraDash";
				if (Owner.GetClassName() == "IlluciaHendershot") dashgruntsound = "IlluciaDash";
				if (Owner.GetClassName() == "DeggarisMontegger") dashgruntsound = "DeggarisDash";
				if (MiscItem && MiscItem.CanTalkUnderwater)
				{
					double maskpitch = 1.00;
					if (Owner.waterlevel >= 3 && MiscItem.CanTalkUnderwater >= 2) maskpitch *= 1.259921885;
					Owner.A_StopSound(CHAN_VOICE);
					Owner.A_StartSound(dashgruntsound,CHAN_VOICE,CHANF_DEFAULT,(dashgruntsndvol * frandom[statitem](1.25,1.375)),ATTN_NORM,maskpitch);
				}
			}

			bool CollisonSpawn = false;
			if (CollisonSpawn)
			{
				Actor CollDash = Spawn("DashCollisionChecker", Owner.Pos);
				CollDash.bSOLID = True;
				CollDash.Master = Self;
				CollDash.Target = Owner;
				CollDash.A_SetSize(Owner.Radius, Owner.Height);
				CollDash.bNOTIMEFREEZE = True;
			}
		}
		
		if (DashTics)
		{
			if (DashTics >= MaxDashTics) DashCooldown = MaxDashCooldown;
			else if (DashCooldown > 0) 
			{
				if (CallACS("MenuVarCheckDECORATE",0) == 0) DashCooldown--;
			}

			owner.bFORCERADIUSDMG = false;
			
			//if (PlayDash.OnGround) { PlayDash.OnGround = False; Owner.AddZ(1); }
			if (PlayDash.OnGround && DashTics % 2) 
			{
				Owner.A_SpawnItemEx("DashPuff",0,0,8,0.0,0.0,0.0,0,SXF_NOCHECKPOSITION);
			}
			if (PlayDash.OnGround) firsttic = 1; else firsttic = 0;
			
			if (DashTics > (MaxDashTics - 2))
			{
				if (firsttic == 0) // On the Ground when Dashing began
				{
					if (dashveltimer == 0) { owner.vel.x *= 1.0125; owner.vel.y *= 1.0125; }
				}
				else // In the Air when Dashing began
				{
					if ((dvds_allowdashing == 2 || dvds_allowdashing == 4) && dashveltimer2 == 0) { owner.vel.z = 0.0; }
				}
			}

			if (!PlayDash.OnGround && 
					(DashTics > (MaxDashTics - 2)) 
					&& airdashtype == 1) 
			{
				Owner.Vel.Z += DashVSpeed;
			}
			else
			{
				if ((dvds_allowdashing == 2 || dvds_allowdashing == 4) && dashveltimer2 == 0) Owner.Vel.Z = 0.0;
			}

			Owner.A_SetBlend("78447E",frandom[statitem](0.08,0.12),random[statitem](2,3));
			Owner.A_SetInventory("PlayerDashing",1);
			if (owner.CountInv("UsingSceptreAltFire")) Owner.A_SetInventory("PlayerSceptreDashing",1);
			Owner.bSHOOTABLE = false;
			Owner.bVISIBILITYPULSE = true;
			Owner.bTHRUACTORS = true;
			if (CallACS("MenuVarCheckDECORATE",0) == 0) DashTics--;
			
			Owner.A_SetInventory("DashTimeFreezer",0);
			
			if (DashTics >= (MaxDashTics - 8)) 
			{
				if (dvds_flightswimpitchdash && (owner.waterlevel >= 3 || (owner.bNOGRAVITY || owner.bFLY)))
				{
					if (dvdsdebug_showdashinformation) Console.Printf("DashSpeed: %.8f, DashDir: %.8f, DashPitch: %.8f", DashSpeed, DashDir, DashPitch);
					Owner.Vel3DFromAngle(DashSpeed, DashDir, DashPitch);
				}
				else 
				{
					if (dvdsdebug_showdashinformation) Console.Printf("DashSpeed: %.8f, DashDir: %.8f", DashSpeed, DashDir);
					Owner.VelFromAngle(DashSpeed, DashDir);
				}
			}
			string dashtype;

			double DashDmg;
			double DashRad;
			double DashFullRad;
			int DashBaseDmg;
			if (berserked)
			{
				if (DashTics > (MaxDashTics * 0.75)) DashSpeed *= 1.025;
				
				if (DashTics % 2) 
				{
					// Dash with Sceptre Shield Alt-Fire
					if (owner.CountInv("UsingSceptreAltFire"))
					{
						A_DashDamage(1,"Sceptre");
					}
					else // Dashing Without a Specific Weapon
					{
						A_DashDamage(3,"Dashing");
					}
				}
				
				// Dash with Sceptre Shield Alt-Fire
				if (owner.CountInv("UsingSceptreAltFire") && DashTics % 2 == 1)
				{
					if (random[statitem](1,16) <= 15)
					{
						A_DashDamage(1,"Sceptre");
					}
				}
				// HW Shield [Berserked]
				if (Owner.CountInv("HWShieldBlockHold"))
				{
					A_DashDamage(5,"DashingSD");
				}
			}
			else // Not Berserked
			{
				if (DashTics % 2) 
				{
					if (random[statitem](1,16) <= 15)
					{
						// Dash with Sceptre Shield Alt-Fire
						if (owner.CountInv("UsingSceptreAltFire"))
						{
							A_DashDamage(0,"Sceptre");
						}
						else // Dashing Without a Specific Weapon
						{
							if (random[statitem](1,32) <= 1)
							{
								A_DashDamage(2,"Dashing");
							}
						}
					}
				}
				if (DashTics % 2 == 1) 
				{
					if (random[statitem](1,64) <= random[statitem](48,54))
					{
						// Dash with Sceptre Shield Alt-Fire
						if (owner.CountInv("UsingSceptreAltFire"))
						{
							A_DashDamage(0,"Sceptre");
						}
						else // Dashing Without a Specific Weapon
						{
							if (random[statitem](1,32) <= 1)
							{
								A_DashDamage(2,"Dashing");
							}
						}
					}
				}
				
				// HW Shield
				if (Owner.CountInv("HWShieldBlockHold"))
				{
					A_DashDamage(4,"DashingSD");
				}
			}
			
			if (DashTics <= (MaxDashTics * 0.25))
			{
				if (!slownthres1)
				{
					slownthres1 = true;
					DashSpeed *= 0.85;
				}
			}
			else if (DashTics <= (MaxDashTics * 0.5)) 
			{
				if (!slownthres2)
				{
					slownthres2 = true;
					DashSpeed *= 0.9;
				}
			}
			else if (DashTics <= (MaxDashTics * 0.75))
			{
				if (!slownthres3)
				{
					slownthres3 = true;
					DashSpeed *= 0.95;
				}
			}
			
			if (dvdsdebug_showdashinformation) Console.Printf("DashTics: %d / %d", DashTics, MaxDashTics);
		}
		else
		{
			if (DashCooldown < 0) DashCooldown = MaxDashCooldown;
			else if (DashCooldown > 0) 
			{
				if (CallACS("MenuVarCheckDECORATE",0) == 0) DashCooldown--;
			}
			firsttic = -1;
			Owner.A_SetInventory("DashTimeFreezer",0);
			Owner.A_SetInventory("PlayerDashing",0);
			Owner.A_SetInventory("PlayerSceptreDashing",0);
			Owner.bSHOOTABLE = true;
			Owner.bVISIBILITYPULSE = false;
			Owner.bTHRUACTORS = false;
			dashtype = -1;
			slownthres1 = false;
			slownthres2 = false;
			slownthres3 = false;
			owner.bFORCERADIUSDMG = false; 
		}
		if (dvdsdebug_showdashinformation) Console.Printf("DashCost [end]: %d, DashCooldown: %d", DashCost, DashCooldown);
		
		owner.A_SetInventory("DashCharge",DashCharge);
		owner.A_SetInventory("DashTics",DashTics);
		CallACS("MiscVarSetDECORATE",166,DashTics);
		owner.A_SetInventory("DashCost",DashCost);
		owner.A_SetInventory("DashCooldown",DashCooldown);

		if (Waiting) owner.A_SetInventory("DashReady",0);
						else owner.A_SetInventory("DashReady",1);
		
		itemtimer++;
	}
}
Class DashCollisionChecker : Actor
{
	PlayerDashJump je;
	Override Void PostBeginPlay()
	{
		Super.PostBeginPlay();
		let sas = PlayerDashJump(Master);
		je = sas;
	}

	Override bool CanCollideWith(Actor other, bool passive)
	{
		if (Other == target || Other.bMissile)
		Return False;
		if (Pos.Z > (Other.Pos.Z + Other.Height) || Other.Pos.Z > (Pos.Z + Height)) Return False;
		if (Other.bSolid && Other.bShootable && Other.CanCollideWith(Self,0))
		Tracer = Other;
		Return False;
	}

	Override Void Tick()
	{
		Super.Tick();
		if (!target || !je || je && !je.dashtics) { Destroy(); Return; }
		SetOrigin((Target.Pos + (Target.Vel * 0.1)),0);
		Vel = Target.Vel;
		if (Tracer)
		{
			bThruActors = True;
			je.DashSpeed = 0;
			Destroy();
		}
	}
}
