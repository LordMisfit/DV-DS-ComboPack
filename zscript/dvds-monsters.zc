// Base monster class [for later use, general monster use outside of game]
class AetheriusMonsterZSC : AetheriusBaseZSC
{
	mixin EvolveMonsters;
	mixin DamageMessages;
	mixin CritAtkSound;
	name MonsterFamily;
	
	// Gargoyle
	bool extremecrash;
	bool droppedtheirsoul;
	bool diedasafriendly;
	bool diedasacharmed;
	bool damagedbyplayer;
	// Afrit
	const FIREDEMON_ATTACK_RANGE = 64*8.;
	int fdstrafecount;
	// Bishop
	int missilecount;
	int bobstate;

	int bormcountercooldown;
	int hsexphealth;
	int specialspeed1;
	int stealthstate, stealthtimer;
	int IsACrisisBulletAttack;
	int IsACrisisMeleeAttack;
	int IsACrisisComboAttack;

	int TrueGameSkill;
	int stealthcheckinterval;
	int CrisisMultiplier;
	int CharacterClass;
	int ClassicDoomType;
	int ModType;

	int timesrevivedamonster;
	int timesrevivedpervile;
	int timesrevivedperdiabloist;
	int timesrevivedperbanshee;

	int hitsoundtimer;
	int hitweaksoundtimer;

	int chasetimer;
	int isamajorboss;

	int user_icekilledtimes;
	int basereactiontime;
	int maxreactiontime;
	int levelsperreacttic;
	double actorbasespeed;
	double actorbasespeedLDL;
	double prevspeed;

	int IsAPeasent;
	int IsARebel;

	int targetdummyhitcooldown;

	int hastetimer;
	int slowtimer;
	int poisontimer;
	int oomphtimer;
	int blunttimer;
	int bufftimer;
	int saptimer;
	
	int SauravatarFirstDMG;
	int SauravatarSecondDMG;
	int SauravatarAtkType;
	int SauravatarRegenTic;
	int SauravatarRegenState;
	
	bool ActorDisplayDMG;
	bool ActorLevelCalcs;
	
	// General
	const SKILL_VERY_EASY = 0;
	const SKILL_EASY = 1;
	const SKILL_NORMAL = 2;
	const SKILL_HARD = 3;
	const SKILL_VERY_HARD = 4;
	const SKILL_EXTREME = 5;
	const SKILL_HORRIBLE = 6;
	const SKILL_IMPOSSIBLE = 7;
	const SKILL_OMEGA = 8;

	int painchancefist, painchancekick, painchancegauntlets;
	int bossdeathactivate;
	int InitRenderType;
	double InitAlpha;
	int levelbehavior;
	int bullet_tracer_mode;
	int gfxeffectlevel;
	int AggressionLevelThreshold1, AggressionLevelThreshold2, AggressionLevelThreshold3;
	int neverbleeds;
	int deathcounter;
	int fadecounter;
	int cannotres;
	double gravitypulsetimer;
	int temp1, temp2, temp3;
	
	property AggressionLevelThreshold: AggressionLevelThreshold1, AggressionLevelThreshold2, AggressionLevelThreshold3;
	property ActorFamily: MonsterFamily;

	default
	{
    AetheriusMonsterZSC.AggressionLevelThreshold 75, 150, 225;
		Painchance "Dashing", 0;
		Mass 100;
		
		dropitem "DoomSpellMana", 16;
		dropitem "DoomSpellMana2", 4;
		dropitem "DoomSpellMana3", 1;
		dropitem "HealthBonus", 2;
		dropitem "HealthBonus", 2;
		dropitem "HealthBonus", 2;
		dropitem "HealthBonus", 2;
		dropitem "HealthBonus", 2;
		dropitem "ArmorBonus", 2;
		dropitem "ArmorBonus", 2;
		dropitem "ArmorBonus", 2;
		dropitem "ArmorBonus", 2;
		dropitem "ArmorBonus", 2;
		dropitem "MaxHealthBonus", 1;
		dropitem "MaxHealthBonus", 1;
		dropitem "MaxHealthBonus", 1;
		dropitem "MaxHealthBonus", 1;
		dropitem "MaxHealthBonus", 1;
	}

	double oldVelZ;
	int actortimer;
	int user_tookcrit;
	int NORADDMG;
	
	/**
	* 32 random bits, generated separately for each actor. Each actor has its own unique random bits, but the random bits don't change over the actor's lifetime.
	*
	* The bottom 4 bits are used to schedule “once every n tics” computations so that all actors don't do it on the same tic, but it still happens exactly once every n tics.
	*/
	int ActorRandomBits;
	int glitterheight, glitterheight2, glitterwidth;
	
	private class<Inventory> LDLPreload, LDLToken, LDLCheck, MiscCheck, MiscCheck2, MiscCheck3, MiscCheck4;
	Actor lastattacker;
	Actor lastattackeratk;
	Actor playeriskiller;
	
	override bool CanResurrect(Actor other, bool passive)
	{
		bool debugmode = dvds_showdamagemessagedebug;
		bool useactortags = dvds_showdamagemessageactortags;

		int maxviletimesrevived = dvds_maxresperarchvile;
		if (maxviletimesrevived <= 0) maxviletimesrevived = 32;
		int maxtimesrevivedpervile = dvds_maxarchrespermonster;
		if (maxtimesrevivedpervile <= 0) maxtimesrevivedpervile = 32;

		int maxdiabtimesrevived = dvds_maxresperdiabloist;
		if (maxdiabtimesrevived <= 0) maxdiabtimesrevived = 32;
		int maxtimesrevivedperdiab = dvds_maxdiabrespermonster;
		if (maxtimesrevivedperdiab <= 0) maxtimesrevivedperdiab = 32;

		int maxbanshtimesrevived = dvds_maxresperbanshee;
		if (maxbanshtimesrevived <= 0) maxbanshtimesrevived = 32;
		int maxtimesrevivedperbansh = dvds_maxbansrespermonster;
		if (maxtimesrevivedperbansh <= 0) maxtimesrevivedperbansh = 32;

		bool ResSucceed;
		AetheriusPlayerPawn playpawn;
		AetheriusMonsterZSC DVDSActor;
		AetheriusMonsterZSC RevivedMonster;
		AetheriusMonsterZSC RevivingMonster;
		if (!passive) // Monster is the one REVIVING...
		{
			RevivedMonster = AetheriusMonsterZSC(other);
			if (GetClassName() == "DSArchvile" || GetClassName() == "FArchvile")
			{
				if (timesrevivedamonster < maxviletimesrevived)
				{
					if (RevivedMonster.timesrevivedpervile < maxtimesrevivedpervile)
					{
						if (other.GetClassName() == "DSArchvile") { if (dvds_vilesressurectviles) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "FArchvile") { if (dvds_vilesressurectviles) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Diabloist") { if (dvds_vilesressurectdiabs) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "DSCyberdemon") { if (dvds_vilesressurectcybers) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Annihilator") { if (dvds_vilesressurectcybers) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "DSSpiderMastermind") { if (dvds_vilesressurectspiders) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Demolisher") { if (dvds_vilesressurectspiders) { ResSucceed = true; } else { ResSucceed = false; } }
						else { ResSucceed = true; }
						if (ResSucceed > 0)
						{
							if (dvds_vilesusehealthtores != 0)
							{
								if (dvds_vilesusehealthtores < 0) health -= dvds_vilesusehealthtores;
								if (dvds_vilesusehealthtores > 0) health -= (health * (dvds_vilesusehealthtores * 0.01));
								
								if (health < 1) health = 1;
							}
							timesrevivedamonster++;
							if (RevivedMonster) 
							{
								RevivedMonster.timesrevivedpervile++;
								if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cxRevivedMonster.timesrevivedpervile: %d, timesrevivedamonster: %d\c-", RevivedMonster.timesrevivedpervile, timesrevivedamonster);
							}
						}
					}
					else
					{
						ResSucceed = false;
					}
				}
				else
				{
					ResSucceed = false;
				}
			}
			else
			if (GetClassName() == "Diabloist" || GetClassName() == "FDiabloist")
			{
				if (timesrevivedamonster < maxdiabtimesrevived)
				{
					if (RevivedMonster.timesrevivedperdiabloist < maxtimesrevivedperdiab)
					{
						if (other.GetClassName() == "DSArchvile") { if (dvds_diabsressurectviles) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "FDiabloist") { if (dvds_diabsressurectdiabs) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Diabloist") { if (dvds_diabsressurectdiabs) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "DSCyberdemon") { if (dvds_diabsressurectcybers) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Annihilator") { if (dvds_diabsressurectcybers) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "DSSpiderMastermind") { if (dvds_diabsressurectspiders) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "Demolisher") { if (dvds_diabsressurectspiders) { ResSucceed = true; } else { ResSucceed = false; } }
						else { ResSucceed = true; }
						if (ResSucceed > 0)
						{
							if (dvds_diabsusehealthtores != 0)
							{
								if (dvds_diabsusehealthtores < 0) health -= dvds_diabsusehealthtores;
								if (dvds_diabsusehealthtores > 0) health -= (health * (dvds_diabsusehealthtores * 0.01));

								if (health < 1) health = 1;
							}
							timesrevivedamonster++;
							if (RevivedMonster) 
							{
								RevivedMonster.timesrevivedperdiabloist++;
								if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cxRevivedMonster.timesrevivedperdiabloist: %d, timesrevivedamonster: %d\c-", RevivedMonster.timesrevivedperdiabloist, timesrevivedamonster);
							}
						}
					}
					else
					{
						ResSucceed = false;
					}
				}
				else
				{
					ResSucceed = false;
				}
			}
			else
			if (GetClassName() == "Banshee")
			{
				if (timesrevivedamonster < maxbanshtimesrevived)
				{
					if (RevivedMonster.timesrevivedperbanshee < maxtimesrevivedperbansh)
					{
						if (other.GetClassName() == "Banshee") { if (dvds_banshsressurectbanshs) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "IronlichNew") { if (dvds_banshsressurectliches) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "IceLich") { if (dvds_banshsressurectliches) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "GoldLich") { if (dvds_banshsressurectliches) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "BloodLich") { if (dvds_banshsressurectliches) { ResSucceed = true; } else { ResSucceed = false; } }
						else if (other.GetClassName() == "MaulotaurNew") { if (dvds_banshsressurecttaurs) { ResSucceed = true; } else { ResSucceed = false; } }
						else { ResSucceed = true; }
						if (ResSucceed > 0)
						{
							if (dvds_banshsusehealthtores != 0)
							{
								if (dvds_banshsusehealthtores < 0) health -= dvds_banshsusehealthtores;
								if (dvds_banshsusehealthtores > 0) health -= (health * (dvds_banshsusehealthtores * 0.01));
								
								if (health < 1) health = 1;
							}
							timesrevivedamonster++;
							if (RevivedMonster) 
							{
								RevivedMonster.timesrevivedperbanshee++;
								if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cxRevivedMonster.timesrevivedperbanshee: %d, timesrevivedamonster: %d\c-", RevivedMonster.timesrevivedperbanshee, timesrevivedamonster);
							}
						}
					}
					else
					{
						ResSucceed = false;
					}
				}
				else
				{
					ResSucceed = false;
				}
			}
			else
			{
				ResSucceed = true;
				if (diedasafriendly)
				{
					if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cyFriend Resurrect? [non-passive side]\c-");
					if (other == self) 
					{
						self.bFRIENDLY = true;
						if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cySelf-Resurrection [Friendly] [non-passive side]\c-");
					}
					else
					{
						diedasafriendly = 0;
						if (diedasacharmed) diedasacharmed = 0;
						self.bFRIENDLY = false;
						if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cySelf-Resurrection [Enemy Res'd?] [non-passive side]\c-");
					}
				}
				else
				{
					if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cyNon-Friend Resurrect? [non-passive side]\c-");
				}
			}
			if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cxResurrector\c-: \cx%s\c-, \cyResurrectee\c-: \cy%s\c- -- ResSucceed: %d, timesrevivedamonster: %d", GetClassName(), other.GetClassName(), ResSucceed, timesrevivedamonster);
			if (ResSucceed && (dvds_showdamagemessages & 2)) 
			{
				string ResurrectMsg;
				string rese = other.GetClassName();
				string res = GetClassName();
				if (self) 
				{
					playpawn = AetheriusPlayerPawn(self);
					DVDSActor = AetheriusMonsterZSC(self);
				}

				if (useactortags)
				{
					rese = other.GetTag("");
					res = GetTag("");
				}
				ResurrectMsg = " * ";
				if (self == other) ResurrectMsg.AppendFormat("\cy%s\c- self resurrects!", rese);
				else 
				{
					ResurrectMsg.AppendFormat("\cx%s\c- was resurrected by \cy%s\c-", rese, res);
					if (DVDSActor && DVDSActor.bFRIENDLY)
					{
						if (DVDSActor.user_charmed) ResurrectMsg.AppendFormat(" \cx(C)\c-");
																	 else ResurrectMsg.AppendFormat(" \cn(F)\c-");
					}
					ResurrectMsg.AppendFormat("!");
				}
				if (debugmode) ResurrectMsg.AppendFormat(" (%d)", gametic);
				Console.Printf("%s", ResurrectMsg);
			}
		}
		else // Monster is the one BEING REVIVED...
		{
			if (cannotres) 
			{
				ResSucceed = false; 
			}
			else 
			{
				ResSucceed = true;
				if (diedasafriendly)
				{
					if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cyFriend Resurrect? [passive side]\c-");
					if (other.bFRIENDLY) 
					{
						self.bFRIENDLY = true;
						if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cySelf-Resurrection [Ally Res'd?] [passive side]\c-");
						RevivingMonster = AetheriusMonsterZSC(other);
						if (dvds_reskeepscharmed && RevivingMonster && RevivingMonster.user_charmed) user_charmed = 1;
					}
					else
					{
						diedasafriendly = 0;
						if (diedasacharmed) diedasacharmed = 0;
						self.bFRIENDLY = false;
						if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cySelf-Resurrection [Enemy Res'd?] [passive side]\c-");
					}
				}
				else
				{
					if (dvdsdebug_actorresurrectdisplays) Console.Printf("\cyNon-Friend Resurrect? [passive side]\c-");
					if (other.bFRIENDLY) 
					{
						RevivingMonster = AetheriusMonsterZSC(other);
						if (dvds_reskeepscharmed && RevivingMonster && RevivingMonster.user_charmed) user_charmed = 1;
					}
				}
			}
		}

		if (dvdsdebug_actorresurrectdisplays) Console.Printf("Resurrect Attempt: Ressee: %s, Resser: %s", GetClassName(), other.GetClassName());
		if (other.GetClassName() == "ReviveProj" || other.GetClassName() == "ReviveProj2")
		{
			if ((dvds_showdamagemessages & 2))
			{
				string ResurrectMsg;
				string rese = GetClassName();
				string res = other.GetClassName();
				if (other.master) 
				{
					res = other.master.GetClassName();
					playpawn = AetheriusPlayerPawn(other.master);
					DVDSActor = AetheriusMonsterZSC(other.master);
				}
				
				if (useactortags)
				{
					rese = GetTag("");
					res = other.GetTag("");
					if (other.master) res = other.master.GetTag("");
				}
				ResurrectMsg = " * ";
				ResurrectMsg.AppendFormat("\cx%s\c- was resurrected by \cy%s\c-", rese, res);
				if (DVDSActor && DVDSActor.bFRIENDLY)
				{
					if (DVDSActor.user_charmed) ResurrectMsg.AppendFormat(" \cx(C)\c-");
																 else ResurrectMsg.AppendFormat(" \cn(F)\c-");
				}
				ResurrectMsg.AppendFormat("!");
				if (debugmode) ResurrectMsg.AppendFormat(" (%d)", gametic);
				Console.Printf("%s", ResurrectMsg);
			}
		}
		return ResSucceed;
	}
	
	void A_ClearShadow()
	{
		if (!user_isstealth)
		{
			bShadow = false;
			A_SetRenderStyle(1, STYLE_Normal);
		}
	}

	void A_VileHealProj(double anglevec = 0.0, double anglevec2 = 0.0)
	{
		int maxviletimesrevived = dvds_maxresperarchvile;
		if (maxviletimesrevived <= 0) maxviletimesrevived = 32;

		if (timesrevivedamonster < maxviletimesrevived)
		{
			if (levelbehavior && user_monsterlevel > 120)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 72+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 144+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 216+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 288+anglevec, 0);
			}
			else
			if (levelbehavior && user_monsterlevel > 60)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 120+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 240+anglevec2, 0);
			}
		}
	}
	void A_DiabHealProj(double anglevec = 0.0, double anglevec2 = 0.0)
	{
		int maxdiabtimesrevived = dvds_maxresperdiabloist;
		if (maxdiabtimesrevived <= 0) maxdiabtimesrevived = 32;

		if (timesrevivedamonster < maxdiabtimesrevived)
		{
			if (levelbehavior && user_monsterlevel > 120)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 72+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 144+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 216+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 288+anglevec, 0);
			}
			else
			if (levelbehavior && user_monsterlevel > 60)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 120+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 240+anglevec2, 0);
			}
		}
	}
	void A_BanshHealProj(double anglevec = 0.0, double anglevec2 = 0.0)
	{
		int maxbanshtimesrevived = dvds_maxresperbanshee;
		if (maxbanshtimesrevived <= 0) maxbanshtimesrevived = 32;

		if (timesrevivedamonster < maxbanshtimesrevived)
		{
			if (levelbehavior && user_monsterlevel > 120)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 72+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 144+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 216+anglevec, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 288+anglevec, 0);
			}
			else
			if (levelbehavior && user_monsterlevel > 60)
			{
				A_SpawnProjectile("ReviveProj2", 0, 0, 0+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 120+anglevec2, 0);
				A_SpawnProjectile("ReviveProj2", 0, 0, 240+anglevec2, 0);
			}
		}
	}
	
	void A_FirstTicInit(int type = 0)
	{
		if (self.health > 0 && !ActorLevelCalcs) 
		{
			if (GetClassName() != "Sauravatar") A_AetheriusStats(0); 

			health = clamp(health, User_MaxHP, health);
			if (diedasafriendly && !bFRIENDLY)
			{
				if (dvdsdebug_actorresurrectdisplays && type == 0) Console.Printf("diedasafriendly [PostBeginPlay()]");
				if (dvdsdebug_actorresurrectdisplays && type == 1) Console.Printf("diedasafriendly [tick()]");
				bFRIENDLY = true;
				diedasafriendly = 0;
				if (diedasacharmed)
				{
					user_charmed = 1;
					diedasacharmed = 0;
				}
			}
			
			// LDL
			A_LegendaryCheck();
		}
	}
	
	override void PostBeginPlay()
	{
		CrisisMultiplier = CallACS("CrisisMultiplier");
		TrueGameSkill = dvds_gendifficultycurve + Skill;
		CharacterClass = CallACS("CheckCharacterClass");
		ClassicDoomType = CallACS("OtherVarCheckDECORATE",7);
		ModType = CallACS("OtherVarCheckDECORATE",8);

		//STYLE_None (0)
		//STYLE_Normal (1)
		//STYLE_Fuzzy (2)
		//STYLE_SoulTrans (3)
		//STYLE_OptFuzzy (4)
		//STYLE_Stencil (5)
		//STYLE_Translucent (6)
		//STYLE_Add (7)
		//STYLE_Shaded (8)
		//STYLE_TranslucentStencil (9)
		//STYLE_Shadow (10)
		//STYLE_Subtract (11)
		//STYLE_AddStencil (12)
		//STYLE_AddShaded (13)
		
		if (GetAge() < 1) // SO APPEARANTLY RELOADING HUB MAPS WILL RERUN PostBeginPlay() CODE, MEANING MONSTERS WITH STEALTH BECOME HARDER AND HARDER TO SEE UNLESS AN AGE CHECK IS RAN >__________>;
		{
			AggressionLevelThreshold1 *= dvds_monsteraggressionmod;
			AggressionLevelThreshold2 *= dvds_monsteraggressionmod;
			AggressionLevelThreshold3 *= dvds_monsteraggressionmod;
			if (dvdsdebug_showstatcalcstuff) Console.Printf("AggressionLevelThreshold1: %d, AggressionLevelThreshold2: %d, AggressionLevelThreshold3: %d", AggressionLevelThreshold1, AggressionLevelThreshold2, AggressionLevelThreshold3);

			if (special == 0)
			{
				user_presetleveladd = Args[0];
				user_presetlevelrand1 = Args[1];
				user_presetlevelrand2 = Args[2];
			}

			InitRenderType = GetRenderStyle();
			InitAlpha = Alpha;
			if (!bSTEALTH)
			{
				if (InitRenderType == 0 && InitAlpha <= 0.000000001) 
				{ 
					InitAlpha = 1.0;
					InitRenderType = 1; 
					Alpha = 1.0;
					A_SetRenderStyle(1.0,1);
				}
			}
			StealthAlpha = Alpha;
			if (dvdsdebug_evolvestealthstuff) Console.Printf("InitRenderType: %d (InitAlpha: %.8f) [Name: %s]", InitRenderType, InitAlpha, GetClassName());
			
			if (bNORADIUSDMG) NORADDMG = 1;
			if (bNOBLOOD) 
			{
				if (!bNOBLOODDECALS) bNOBLOODDECALS == 1;
				neverbleeds = 1;
			}
			if (bNOBLOODDECALS) 
			{
				if (!bNOBLOOD) bNOBLOOD == 1;
				neverbleeds = 1;
			}
		}

		A_FirstTicInit(0);

		ActorRandomBits = random();

		user_hyperlvl1 = 225;
		user_hyperlvl2 = 450;

		deathcounter = 0;

		string classname = GetClassName();

		if (classname == "Benellus1DS") isamajorboss = 16;
		if (classname == "Benellus2DS") isamajorboss = 16;
		if (classname == "Benellus3DS") isamajorboss = 16;
		if (classname == "DragonNew") isamajorboss = 16;
		if (classname == "HeresiarchNew") isamajorboss = 16;
		if (classname == "ClericBossNew") isamajorboss = 16;
		if (classname == "MageBossNew") isamajorboss = 16;
		if (classname == "FighterBossNew") isamajorboss = 16;
		if (classname == "DSparilMountedNew") isamajorboss = 12; // 12
		if (classname == "DSparilUnmountedNew") isamajorboss = 16;
		if (classname == "KoraxNew") isamajorboss = 16;
		if (classname == "Zakachi") isamajorboss = 16;
		if (classname == "AvatarNew") isamajorboss = 16; // 32
		if (classname == "ProgrammerNew") isamajorboss = 16;
		if (classname == "StrifeBishopNew") isamajorboss = 16;
		if (classname == "OracleNew") isamajorboss = 16;
		if (classname == "Macil1New") isamajorboss = 16;
		if (classname == "Macil2New") isamajorboss = 16;
		if (classname == "LoremasterNew") isamajorboss = 16;
		if (classname == "SourceGuardian") isamajorboss = 16;
		if (classname == "AlienSpectre1New") isamajorboss = 16; // 24
		if (classname == "AlienSpectre2New") isamajorboss = 16; // 24
		if (classname == "AlienSpectre3New") isamajorboss = 16; // 24
		if (classname == "AlienSpectre4New") isamajorboss = 16; // 24
		if (classname == "AlienSpectre5New") isamajorboss = 16; // 24
		if (classname == "AlienSpectre1Model") isamajorboss = 16; // 24
		if (classname == "AlienSpectre2Model") isamajorboss = 16; // 24
		if (classname == "AlienSpectre3Model") isamajorboss = 16; // 24
		if (classname == "AlienSpectre4Model") isamajorboss = 16; // 24
		if (classname == "AlienSpectre5Model") isamajorboss = 16; // 24
		if (classname == "StarSpawn") isamajorboss = 16; // 24
		if (classname == "EntityBossNew") isamajorboss = 24; // 32
		if (classname == "EntitySecondNew") isamajorboss = 24; // 32
		if (classname == "EntityAscended") isamajorboss = 24; // 32
		if (classname == "DSMotherDemon64") isamajorboss = 16;
		if (classname == "SpiderGod") isamajorboss = 16;
		if (classname == "SpiderGodling") isamajorboss = 16;
		if (classname == "ThamuzNew") isamajorboss = 24; // 32
		if (classname == "TchernobogNew") isamajorboss = 24; // 32
		if (classname == "PennywiseBoss") isamajorboss = 32; // 32
		if (classname == "NyarlathotepLesser") isamajorboss = 32; // 32
		if (classname == "TheSource") isamajorboss = 32; // 128
		if (classname == "Nyarlathotep") isamajorboss = 64; // 64
		if (classname == "Magmantis") isamajorboss = 64; // 32
		if (classname == "AdolfHitlerDS") isamajorboss = 64; // 32
		if (classname == "Sauravatar") isamajorboss = 96; // 128
		
		//This space for rent.
		Super.PostBeginPlay();
	}

	override void Tick()
	{
		bullet_tracer_mode = dvds_monsterbulletstracers;
		levelbehavior = dvds_monsterlevelbehavior;
		gfxeffectlevel = dvds_gfxeffectlevel;
		
		A_FirstTicInit(1);
		
		if (health > 0 && ((gametic % 35) == 0))
		{
			if (dvds_dmgindicator && !ActorDisplayDMG) ActorDisplayDMG = true;
			else if (!dvds_dmgindicator && ActorDisplayDMG) ActorDisplayDMG = false;
		}
		
		//******************
		//*"Stealth" Checks*
		//******************
		stealthcheckinterval = clamp(dvds_rnd_stealth_refreshrate, 1, 35);
		if (user_isstealth && ((gametic % stealthcheckinterval) == 0))
		{
			if (
					// General/Global
					InStateSequence(curstate,ResolveState("See")) || 
					InStateSequence(curstate,ResolveState("Spawn")) || 
					InStateSequence(curstate,ResolveState("Idle")) || 
					InStateSequence(curstate,ResolveState("Pain.Charm")) || 
					InStateSequence(curstate,ResolveState("Pain.Heal1")) || 
					InStateSequence(curstate,ResolveState("Pain.Heal2")) || 
					InStateSequence(curstate,ResolveState("Pain.Heal3")) || 
					InStateSequence(curstate,ResolveState("Raise")) ) 
			{
				A_RefreshStealthInfo(0);
				if (dvdsdebug_evolvestealthstuff) Console.Printf("gametic: %d (stealth type: 0) [stealthcheckinterval: %d]", gametic, stealthcheckinterval);
			}
		
			if (
					// Doom
					((GetClassName() == "BFGGuy" || GetClassName() == "FBFGGuy") && (InStateSequence(curstate,ResolveState("MissileBFG9000")) || InStateSequence(curstate,ResolveState("MissileBFG2704")))) ||
					((GetClassName() == "VoidDarkImp" || GetClassName() == "FVoidDarkImp") && (InStateSequence(curstate,ResolveState("MissileNormal")) || InStateSequence(curstate,ResolveState("MissileStrong")))) ||
					((GetClassName() == "Cybruiser" || GetClassName() == "FCybruiser") && (InStateSequence(curstate,ResolveState("RageAttackStart")) || InStateSequence(curstate,ResolveState("RageAttack")) || InStateSequence(curstate,ResolveState("RageAttackEnd")) || InStateSequence(curstate,ResolveState("Missile1End")))) ||
					((GetClassName() == "PyroDemon" || GetClassName() == "FPyroDemon") && InStateSequence(curstate,ResolveState("Missile1a"))) ||
					((GetClassName() == "Demolisher" || GetClassName() == "FDemolisher") && (InStateSequence(curstate,ResolveState("Missile1Loop")) || InStateSequence(curstate,ResolveState("Missile2Loop")))) ||
					((GetClassName() == "DSCyberdemon" || GetClassName() == "FCyberdemon" || GetClassName() == "Annihilator" || GetClassName() == "FAnnihilator") && (InStateSequence(curstate,ResolveState("Stomp")) || InStateSequence(curstate,ResolveState("AttackPhaseChange")))) ||
					((GetClassName() == "Hierophant" || GetClassName() == "FHierophant") && InStateSequence(curstate,ResolveState("Missile3End"))) ||
					// Heretic
					((GetClassName() == "DeathKnight" || GetClassName() == "DeathKnightGhost") && (InStateSequence(curstate,ResolveState("Missile1Phase2")) || InStateSequence(curstate,ResolveState("Missile1Phase3")) || InStateSequence(curstate,ResolveState("Missile1End")) || InStateSequence(curstate,ResolveState("Missile2Phase2")) || InStateSequence(curstate,ResolveState("Missile2Phase3")) || InStateSequence(curstate,ResolveState("Missile2End")))) ||
					((GetClassName() == "ClinkNew" || GetClassName() == "FClink") && (InStateSequence(curstate,ResolveState("LungeAttack")) || InStateSequence(curstate,ResolveState("AxeMissile")) || InStateSequence(curstate,ResolveState("MeleeStrike")))) ||
					(GetClassName() == "PlagueImp" && (InStateSequence(curstate,ResolveState("MissileSingle")) || InStateSequence(curstate,ResolveState("MissileMulti")))) ||
					((GetClassName() == "GreaterDisciple" || GetClassName() == "FGreaterDisciple") && InStateSequence(curstate,ResolveState("MissileBlur"))) ||
					((GetClassName() == "Banshee" || GetClassName() == "FBanshee") && ( InStateSequence(curstate,ResolveState("Missile4End")) || InStateSequence(curstate,ResolveState("Missile5Loop")))) ||
					(GetClassName() == "ShadowBeast" && (InStateSequence(curstate,ResolveState("Missile1a")) || InStateSequence(curstate,ResolveState("Missile1b")) || InStateSequence(curstate,ResolveState("Missile2a")) || InStateSequence(curstate,ResolveState("Missile2b")))) ||
					// Hexen
					((GetClassName() == "Bormereth" || GetClassName() == "FBormereth") && (InStateSequence(curstate,ResolveState("Missile1b")) || InStateSequence(curstate,ResolveState("Missile1c")))) ||
					((GetClassName() == "SlaughtaurNew" || GetClassName() == "FSlaughtaur") && (InStateSequence(curstate,ResolveState("MissilePhase2")) || InStateSequence(curstate,ResolveState("MissilePhase3")) || InStateSequence(curstate,ResolveState("MissilePhase4")))) ||
					((GetClassName() == "VampireDVDS" || GetClassName() == "FVampire") && InStateSequence(curstate,ResolveState("BatAttack"))) ||
					((GetClassName() == "StalkerNew" || GetClassName() == "FStalker" || GetClassName() == "StalkerLeaderNew" || GetClassName() == "FStalkerLeader" || GetClassName() == "IceStalker" || GetClassName() == "IceStalkerLeader") && (InStateSequence(curstate,ResolveState("Attack")) || InStateSequence(curstate,ResolveState("MeleeAttack")))) ||
					(GetClassName() == "KoraxNew" && InStateSequence(curstate,ResolveState("Attack"))) ||
					// Strife
					(GetClassName() == "OStalkerNew" && InStateSequence(curstate,ResolveState("MissileCeiling"))) ||
					
					// General/Global
					InStateSequence(curstate,ResolveState("Melee")) || 
					InStateSequence(curstate,ResolveState("Melee1")) || 
					InStateSequence(curstate,ResolveState("Melee2")) || 
					InStateSequence(curstate,ResolveState("Missile")) ||
					InStateSequence(curstate,ResolveState("MissileStart")) ||
					InStateSequence(curstate,ResolveState("MissileEnd")) ||
					InStateSequence(curstate,ResolveState("MissileLoop")) ||
					InStateSequence(curstate,ResolveState("Missile1")) ||
					InStateSequence(curstate,ResolveState("Missile2")) ||
					InStateSequence(curstate,ResolveState("Missile3")) ||
					InStateSequence(curstate,ResolveState("Missile4")) ||
					InStateSequence(curstate,ResolveState("Missile5")) ||
					InStateSequence(curstate,ResolveState("Missile6")) ||
					InStateSequence(curstate,ResolveState("Heal")) ||

					InStateSequence(curstate,ResolveState("Pain")) || 
					InStateSequence(curstate,ResolveState("Pain.Bonk")) || 
					InStateSequence(curstate,ResolveState("Pain.Breakfast")) || 
					InStateSequence(curstate,ResolveState("Pain.Zap")) || 
					InStateSequence(curstate,ResolveState("Pain.Chop")) || 
					InStateSequence(curstate,ResolveState("Pain.Cricket")) || 
					InStateSequence(curstate,ResolveState("Pain.Lead")) || 
					InStateSequence(curstate,ResolveState("Pain.Bop")) || 
					InStateSequence(curstate,ResolveState("Pain.Beats")) || 
					InStateSequence(curstate,ResolveState("Pain.Dust")) || 
					InStateSequence(curstate,ResolveState("Pain.CherryBomb")) || 
					InStateSequence(curstate,ResolveState("Pain.BRocket")) || 
					InStateSequence(curstate,ResolveState("Pain.Spinner")) || 
					InStateSequence(curstate,ResolveState("Pain.Popper")) || 
					InStateSequence(curstate,ResolveState("Pain.Dashing")) || 
					InStateSequence(curstate,ResolveState("Pain.Boiling")) || 
					InStateSequence(curstate,ResolveState("Pain.Tank")) || 
					InStateSequence(curstate,ResolveState("Pain.Suck")) || 
					InStateSequence(curstate,ResolveState("Pain.Musak")) || 
					InStateSequence(curstate,ResolveState("Pain.DoomSpell")) || 
					InStateSequence(curstate,ResolveState("Pain.Magic")) || 
					InStateSequence(curstate,ResolveState("Pain.Holy")) || 
					InStateSequence(curstate,ResolveState("Pain.Dark")) ||
					InStateSequence(curstate,ResolveState("Pain.Eldritch")) ||
					InStateSequence(curstate,ResolveState("Pain.Fire")) || 
					InStateSequence(curstate,ResolveState("Pain.Ice")) || 
					InStateSequence(curstate,ResolveState("Pain.Plasma")) || 
					InStateSequence(curstate,ResolveState("Pain.Thunder")) || 
					InStateSequence(curstate,ResolveState("Pain.Electric")) || 
					InStateSequence(curstate,ResolveState("Pain.Lightning")) || 
					InStateSequence(curstate,ResolveState("Pain.Shock")) || 
					InStateSequence(curstate,ResolveState("Pain.Sceptre")) || 
					InStateSequence(curstate,ResolveState("Pain.Fist")) || 
					InStateSequence(curstate,ResolveState("Pain.Kick")) ||
					InStateSequence(curstate,ResolveState("Pain.PoisonNeedle")) ||
					InStateSequence(curstate,ResolveState("Pain.Deadlight")) ||
					InStateSequence(curstate,ResolveState("Pain.Chainsaw")) ||
					InStateSequence(curstate,ResolveState("Pain.Gauntlets")) ||
					InStateSequence(curstate,ResolveState("PainShield")) ||
					InStateSequence(curstate,ResolveState("PainShieldEnd")) ||
					InStateSequence(curstate,ResolveState("PainReact")) ||
					(GetClassName() == "Sauravatar" && (InStateSequence(curstate,ResolveState("PainCounter")) || InStateSequence(curstate,ResolveState("PainCounterHealthMod")) || InStateSequence(curstate,ResolveState("PainCounterHealthLow")) || InStateSequence(curstate,ResolveState("PainGauntEnd")))) ||
					InStateSequence(curstate,ResolveState("PainEnd"))
					) 
			{
				A_RefreshStealthInfo(1);
				if (dvdsdebug_evolvestealthstuff) Console.Printf("gametic: %d (stealth type: 1) [stealthcheckinterval: %d]", gametic, stealthcheckinterval);
			}
		
			if (
					// General/Global
					InStateSequence(curstate,ResolveState("Death")) || 
					InStateSequence(curstate,ResolveState("Death")) || 
					InStateSequence(curstate,ResolveState("Death2")) || 
					InStateSequence(curstate,ResolveState("DeathLoop")) || 
					InStateSequence(curstate,ResolveState("FakeDeath")) || 
					InStateSequence(curstate,ResolveState("TrueDeath")) || 
					InStateSequence(curstate,ResolveState("DeathFinalCheck")) || 
					InStateSequence(curstate,ResolveState("Death.Fire")) || 
					InStateSequence(curstate,ResolveState("Death.PoisonNeedle")) || 
					InStateSequence(curstate,ResolveState("Death.Final")) || 
					InStateSequence(curstate,ResolveState("Death.Thunder")) || 
					InStateSequence(curstate,ResolveState("Death.Electric")) || 
					InStateSequence(curstate,ResolveState("Death.Lightning")) || 
					InStateSequence(curstate,ResolveState("Death.Shock")) || 
					InStateSequence(curstate,ResolveState("Death.Plasma")) || 
					InStateSequence(curstate,ResolveState("Death.Extreme")) || 
					InStateSequence(curstate,ResolveState("Death.Massacre")) || 
					InStateSequence(curstate,ResolveState("Death.SilentMassacre")) || 
					InStateSequence(curstate,ResolveState("Death.HSExplode")) || 
					InStateSequence(curstate,ResolveState("XDeath")) || 
					InStateSequence(curstate,ResolveState("Crash")) || 
					InStateSequence(curstate,ResolveState("XCrash")) || 
					InStateSequence(curstate,ResolveState("Burn")) || 
					InStateSequence(curstate,ResolveState("Disintergrate")) || 
					InStateSequence(curstate,ResolveState("Ice")) ) 
			{
				A_RefreshStealthInfo(2);
				if (dvdsdebug_evolvestealthstuff) Console.Printf("gametic: %d (stealth type: 2) [stealthcheckinterval: %d]", gametic, stealthcheckinterval);
			}
		}

		// Unsets BUDDHA from a transformed legendary [in the rare case a monster doesn't get it removed by the initial transformation]
		if (user_legendaryevolved) bBuddha = false;

		if (!(isFrozen() || CountInv("AetheriusTimeFreezer",AAPTR_PLAYER1) || CountInv("AetheriusTimeFreezerMenu",AAPTR_PLAYER1)))
		{
			// Undoes LDLite Tokens if the var is set to !0
			if (user_nolegendarytrans) user_willbecomelegendary = 0;

			if (user_legendaryevolved) GiveInventory("LDLegendaryMonsterVisualEffectMaker", 1);

			//********************************************************
			//*Sets Fading for monster corpses if option is turned on*
			//********************************************************
			if (health <= 0 && (dvds_deadwillfade || droppedtheirsoul))
			{
				if (deathcounter >= (dvds_deadbeforefadetimer*35))
				{
					if (droppedtheirsoul) fadecounter += 4; else fadecounter++;
					cannotres = 1;
					if (droppedtheirsoul) A_FadeOut((1.0/(random(7,8))),FTF_REMOVE); else A_FadeOut((1.0/random(28,32)),FTF_REMOVE);
					if (fadecounter > 32) Destroy();
					if (dvdsdebug_deathgibfadedisplays) Console.Printf("\cy%s\c- alpha: \cx%.8f\c- - fadecounter: %d / 32", GetClassName(), alpha, fadecounter);
				}
				else
				{
					if (droppedtheirsoul) deathcounter += (5 * random(5,10)); else deathcounter++;
					if (dvdsdebug_deathgibfadedisplays) Console.Printf("\cy%s\c- deathcounter: \cx%d\c-", GetClassName(), deathcounter);
				}
			}

			if (health > 0)
			{
				//*********************************************************
				//*Ally/Charm Sparkle Code [for easily identifying allies]*
				//*********************************************************
				if (dvdsdebug_charmdisplays && user_charmed) Console.Printf("(%s) FRIENDLY = %d, user_charmed = %d", GetClassName(), bFRIENDLY, user_charmed);
				if (((gametic + (ActorRandomBits & 15)) & 15) == 1)
				{
					if (bFRIENDLY > 0 && health > 0)
					{
						let glitterheight = height / 2;
						let glitterheight2 = height / 4;
						let glitterwidth = radius * 5 / 4;
						int maxglit = 2;
						bool glitrange = false;
						for (int i = 0; i < players.Size(); i++)
						{
							if (playeringame[i] && players[i].mo.health > 0 && Distance3D(players[i].mo) <= 800)
							{
								glitrange = true;
								break;
							}
						}

						if (glitrange)
						{
							maxglit += (radius / 16);
							maxglit += (height / 32);
							if (random(1,4) == 1) maxglit *= 1.334;
							if (random(1,4) == 1) maxglit *= 1.25;
							if (random(1,4) == 1) maxglit *= 1.125;
						}
						string glittype = "ArmorGlitter";
						if (user_charmed) glittype = "FyggGlitter";
						for (int i = 1; i < maxglit; i++)
						{
							A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
							if (random(1,5) == 1) A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
							if (random(1,25) == 1) A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
							if (random(1,125) == 1) A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
							if (user_charmed)
							{
								if (random(1,15) == 1) A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
								if (random(1,75) == 1) A_SpawnItemEx(glittype, random[TeleGlitter](-glitterwidth,glitterwidth), random[TeleGlitter](-glitterwidth,glitterwidth), glitterheight+random(-glitterheight2,glitterheight2)+random[TeleGlitter](0,31)-16,frandom(-0.75,0.75),frandom(-0.75,0.75),frandom(-0.75,0.75));
							}
						}
						if (user_charmed)
						{
							if (CountInv("CharmMonsterAttack") <= 0) A_SetInventory("CharmMonsterAttack",1);
							if (CountInv("CharmMonsterDefense") <= 0) A_SetInventory("CharmMonsterDefense",1);
							if (CountInv("CharmMonsterSpeed") <= 0) A_SetInventory("CharmMonsterSpeed",1);
						}
					}
				}

				if ((gametic % 2) == 0)
				{
					Speed = actorbasespeed;
					
					if (user_legendaryevolved && !bBOSS) 
					{
						Speed *= LD_legendaryspeed;
						actorbasespeedLDL = actorbasespeed * LD_legendaryspeed;
					}
					if (user_legendaryevolved && bBOSS) 
					{
						Speed *= LD_legendaryspeedboss;
						actorbasespeedLDL = actorbasespeed * LD_legendaryspeedboss;
					}
					for (Inventory item = Inv; item != NULL; item = item.Inv)
					{
						let sitem = PowerSpeed(item);
						if (sitem != null)
						{
							prevspeed = Speed;
							Speed *= sitem.speed;
							if (dvdsdebug_monsterspeeditemdisplays) Console.Printf("Actor: %s, invname: %s, speed: %.8f (prevspeed: %.8f (basespeed: %.8f))", GetClassName(), sitem.GetClassName(), speed, prevspeed, actorbasespeed);
						}
					}
				}
			}
		}
		if (health > 0)
		{
			if (bormcountercooldown > 0) 
			{
				bormcountercooldown--;
				//Console.Printf("bormcountercooldown: %d", bormcountercooldown);
			}
			if (hitsoundtimer > 0) hitsoundtimer--;
			if (hitweaksoundtimer > 0) hitweaksoundtimer--;
		}
		//This space for rent.
		super.Tick(); // KEEP THIS HERE ELSE OTHER FUNCTIONS RELATED TO THIS BREAK :V
	}

	override void Die(Actor source, Actor inflictor, int dmgflags)
	{
		string nm;
		if (user_isstealth || user_wasstealth)
		{
			A_SetRenderStyle(InitAlpha,InitRenderType);
			Alpha = InitAlpha;
		}

		if (self.health <= 0 && ActorLevelCalcs && !bICECORPSE) 
		{ 
			SetInventory("LDLegendaryMonsterVisualEffectMaker", 0);
			SetInventory("LDLegendaryMonsterVisualEffectAlternator", 0);
			user_willbecomelegendary = 0;
			if (bFRIENDLY) 
			{
				diedasafriendly = 1;
				if (user_charmed) diedasacharmed = 1;
				if (dvdsdebug_actorresurrectdisplays) Console.Printf("diedasafriendly: %d, diedasacharmed: %d", diedasafriendly, diedasacharmed);
			}

			A_AetheriusStats(1); 
		}

		if (CountInv("CharmMonsterAttack")) A_SetInventory("CharmMonsterAttack",0);
		if (CountInv("CharmMonsterDefense")) A_SetInventory("CharmMonsterDefense",0);
		if (CountInv("CharmMonsterSpeed")) A_SetInventory("CharmMonsterSpeed",0);
		if (user_charmed) user_charmed = 0;
		
		string Actorname = GetClassName();
		int ActorKillNumber = 8000;
		//*******************************************
		//* Increase Kill Counters [for Codex, etc] *
		//*******************************************
		// Doom & Doom 2
		ActorKillNumber++; if (ActorName == "DSZombieman") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSShotgunGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "PlasmaGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "RepeaterZombie") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "KarasawaGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "RocketLauncherGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSShotgunGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "SuperShotgunGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "FemaleRailZombie") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSChaingunGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Minigunner") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "BFGGuy") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "SuicideBomber") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSDoomImp") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DarkImp") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "STDarkImp") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "VoidDarkImp") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "NetherDarkImp") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSSpectre") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "BloodDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "BloodSpectre") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "ChaingunDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "ChaingunSpectre") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSWolfensteinSS") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSLostSoul") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "ForgottenOne") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSPainElemental") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSCacoDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Cacolantern") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Abaddon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSHellKnight") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSBaronofHell") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HellWarrior") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Belphegor") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "BruiserDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "ArchonofHell") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "PyroDemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSRevenant") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DeathIncarnate") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSFatso") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Hectebus") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Daedabus") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSArachnotron") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSRailArachnotron") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "ArachnotronMK2") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "FusionArachnotron") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSArchvile") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Diabloist") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSSpiderMastermind") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Demolisher") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSCyberdemon") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Annihilator") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSScriptedMarine") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HadesSphere") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HSOverlord") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "WeakenedFlyingBalrog") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "FlyingBalrog") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "CyBruiser") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HellCleric") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HadesElemental") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "HadesOverlord") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "Hierophant") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		ActorKillNumber++; if (Actorname == "DSBossBrain") CallACS("MiscVarCheckDECORATE",ActorKillNumber,1,1);
		
		// Heretic, Hexen & Strife
		ActorKillNumber = 8100;
		
		
		
		// Happy Time Circus [both] 
		ActorKillNumber = 8200;
		
		
		
		//
		//This space for rent.
		Super.Die(source, inflictor, dmgflags);
	}

	override bool CanCollideWith(Actor other, bool passive)
	{
		// Non-passive means the one moving into the other is performing the checks.
		if (!passive)
		{
			// Pass through players, if the calling monster is Friendly
			if (bFRIENDLY == 1 && other.GetSpecies() == "Players")
			{
				return false; 
				//A_Log("False - Friendly - Player"); 
			}

			// Pass through other actors, if the calling monster is Friendly
			if (bFRIENDLY == 1 && other.bFRIENDLY == 1)
			{
				return false; 
				//A_Log("False - Friendly - Other Friendly"); 
			}

			// Pass through charm shots if the calling monster is Friendly
			if (bFRIENDLY == 1 && (other.GetClassName() == "CharmShot" || other.GetClassName() == "CharmShotNoSeek")) 
			{
				return false; 
				//A_Log("False - Friendly - Charm Shot"); 
			}

			if (bFRIENDLY == 1 && other.GetClassName() == "Heal1Shot")
			{
				if (self.health < self.User_MaxHP) return true;
				else 
				{
					return false; 
					//A_Log("False - Heal1"); 
				}
			}
			if (bFRIENDLY == 1 && other.GetClassName() == "Heal2Shot")
			{
				if (self.health < self.User_MaxHP) return true; 
				else
				{
					return false; 
					//A_Log("False - Heal2"); 
				}
			}
			if (bFRIENDLY == 1 && other.GetClassName() == "Heal3Shot")
			{
				if (self.health < (self.User_MaxHP*2)) return true;
				else
				{
					return false; 
					//A_Log("False - Heal3"); 
				}
			}
		}
		if (other.GetClassName() == "HubbleBubbleSmall" || other.GetClassName() == "HubbleBubbleLarge") return false;

		// We don't really care about others making the check.
		return true;
	}
	
	// without Chaos Serpent
	void DSparilTeleport()
	{
		SpotState state = Level.GetSpotState();
		if (state == null) return;

		Actor spot = state.GetSpotWithMinMaxDistance("BossSpot", pos.x, pos.y, 128, 0);
		if (spot == null) return;

		Vector3 prev = Pos;
		if (TeleportMove (spot.Pos, false))
		{
			Actor mo = Spawn("Sorcerer2Telefade", prev, ALLOW_REPLACE);
			if (mo) 
			{
				mo.Translation = Translation;
				mo.A_StartSound("misc/teleport", CHAN_BODY);
			}
			SetStateLabel("Teleport");
			A_StartSound("misc/teleport", CHAN_BODY);
			SetZ(floorz);
			angle = spot.angle;
			vel = (0,0,0); 
		}
	}

	// Sceptre EXP Increase [Monster/Actor-Side Specific Code]
	void A_AddSceptreEXP_M (int SExPts = 1, int DivAmount = 1)
	{
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int clearofmindex = CallACS("MiscVarCheckDECORATE",10056);
		int ModType = CallACS("OtherVarCheckDECORATE",8);
		int CharacterClass = CallACS("CheckCharacterClass");
		int ExpPiecesToAdd;
		double EXPBonus1;
		int BossEnemy;
		int DeftnessExpBase = dvds_deftnessexpbase;
		int SceptreExpMultiplier = dvds_sceptreexpmultiplier;
		int SceptreActualLevel = CallACS("OtherVarCheckDECORATE",11);
		string vict = GetClassName();
		double sceptbasemulti = 1.00;
		int higherlearning = CallACS("MiscVarCheckDECORATE",11001);
		int PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
		int SceptEXPFrags = CallACS("MiscVarCheckDECORATE",203);
		
		DivAmount = clamp(DivAmount, 1, DivAmount);
		
		if (CharacterClass == 2)
		{
			if (user_MaxHP > 0) SExPts = user_MaxHP; else SExPts = SpawnHealth();
			if (ModType == 0) SExPts *= 1.334; // Classic Doom 1/2 / Heretic / Hexen / Strife
			SExPts *= 16; // * 16 is because each full Sceptre EXP Point is 16 "fragments".
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 1 - Base): %d / 16", SExPts);
			SExPts /= 300;
			if (clearofmind >= 1) SExPts += 4;
			if (clearofmind >= 2) SExPts += 5;
			if (clearofmind >= 3) SExPts += 6;
			if (clearofmind >= 4) SExPts += 7;
			if (clearofmind >= 5) SExPts += 8;
			if (clearofmindex >= 1) SExPts += 15;
			if (clearofmindex >= 2) SExPts += 15;
			if (higherlearning == 1) SExPts += 15; // [115%]
			if (higherlearning >= 2) SExPts += 30; // [130%]
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 1b - Base 2): %d / 16", SExPts);

			// Check for if the monster calling the script is a boss or strong monster [to cut down on SExp Gains]
			if (vict == "Benellus1DS") DivAmount *= 16;
			if (vict == "Benellus2DS") DivAmount *= 16;
			if (vict == "Benellus3DS") DivAmount *= 16;
			if (vict == "DragonNew") DivAmount *= 16;
			if (vict == "HeresiarchNew") DivAmount *= 16;
			if (vict == "ClericBossNew") DivAmount *= 16;
			if (vict == "MageBossNew") DivAmount *= 16;
			if (vict == "FighterBossNew") DivAmount *= 16;
			if (vict == "DSparilMountedNew") DivAmount *= 12; // 12
			if (vict == "DSparilUnmountedNew") DivAmount *= 16;
			if (vict == "KoraxNew") DivAmount *= 16;
			if (vict == "Zakachi") DivAmount *= 16;
			if (vict == "AvatarNew") DivAmount *= 16; // 32
			if (vict == "ProgrammerNew") DivAmount *= 16;
			if (vict == "StrifeBishopNew") DivAmount *= 16;
			if (vict == "OracleNew") DivAmount *= 16;
			if (vict == "Macil1New") DivAmount *= 16;
			if (vict == "Macil2New") DivAmount *= 16;
			if (vict == "LoremasterNew") DivAmount *= 16;
			if (vict == "SourceGuardian") DivAmount *= 16;
			if (vict == "AlienSpectre1New") DivAmount *= 16; // 24
			if (vict == "AlienSpectre2New") DivAmount *= 16; // 24
			if (vict == "AlienSpectre3New") DivAmount *= 16; // 24
			if (vict == "AlienSpectre4New") DivAmount *= 16; // 24
			if (vict == "AlienSpectre5New") DivAmount *= 16; // 24
			if (vict == "AlienSpectre1Model") DivAmount *= 16; // 24
			if (vict == "AlienSpectre2Model") DivAmount *= 16; // 24
			if (vict == "AlienSpectre3Model") DivAmount *= 16; // 24
			if (vict == "AlienSpectre4Model") DivAmount *= 16; // 24
			if (vict == "AlienSpectre5Model") DivAmount *= 16; // 24
			if (vict == "StarSpawn") DivAmount *= 16; // 24
			if (vict == "EntityBossNew") DivAmount *= 24; // 32
			if (vict == "EntitySecondNew") DivAmount *= 24; // 32
			if (vict == "EntityAscended") DivAmount *= 24; // 32
			if (vict == "DSMotherDemon64") DivAmount *= 16;
			if (vict == "SpiderGod") DivAmount *= 16;
			if (vict == "SpiderGodling") DivAmount *= 16;
			if (vict == "ThamuzNew") DivAmount *= 24; // 32
			if (vict == "TchernobogNew") DivAmount *= 24; // 32
			if (vict == "PennywiseBoss") DivAmount *= 32; // 32
			if (vict == "NyarlathotepLesser") DivAmount *= 32; // 32
			if (vict == "TheSource") DivAmount *= 32; // 128
			if (vict == "Nyarlathotep") DivAmount *= 64; // 32
			if (vict == "Magmantis") DivAmount *= 64; // 32
			if (vict == "AdolfHitlerDS") DivAmount *= 64; // 32
			if (vict == "Sauravatar") DivAmount *= 96; // 128
		
			if (DivAmount >= 1) SExPts /= DivAmount;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 2a - Boss Check [%s]): %d / 16, DivAmount: %d", vict, SExPts, DivAmount);
			sceptbasemulti = frandompick(0.67,0.67,0.67,0.67,1.00,1.00,1.34);
			SExPts += (16 + (SceptreActualLevel * sceptbasemulti));
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 2b - Post Boss Check [%3f]): %d / 16", sceptbasemulti, SExPts);
		
			int Randomizer = random(1,256);
			if (Randomizer == 1) SExPts *= 8;
			if (Randomizer == 2) SExPts *= 4;
			if (Randomizer == 3) SExPts *= 4;
			if (Randomizer == 4) SExPts *= 2;
			if (Randomizer == 5) SExPts *= 2;
			if (Randomizer == 6) SExPts *= 2;
			if (Randomizer == 7) SExPts *= 2;
		
			// Higher Levels = slightly less chances to get all EXP
			if (SceptreActualLevel > 15 && Randomizer == 241) SExPts /= 2;
			if (SceptreActualLevel > 14 && Randomizer == 242) SExPts /= 2;
			if (SceptreActualLevel > 13 && Randomizer == 243) SExPts /= 2;
			if (SceptreActualLevel > 12 && Randomizer == 244) SExPts /= 2;
			if (SceptreActualLevel > 11 && Randomizer == 245) SExPts /= 2;
			if (SceptreActualLevel > 10 && Randomizer == 246) SExPts /= 2;
			if (SceptreActualLevel > 9 && Randomizer == 247) SExPts /= 2;
			if (SceptreActualLevel > 8 && Randomizer == 248) SExPts /= 2;
			if (SceptreActualLevel > 7 && Randomizer == 249) SExPts /= 2;
			if (SceptreActualLevel > 6 && Randomizer == 250) SExPts /= 2;
			if (SceptreActualLevel > 5 && Randomizer == 251) SExPts /= 2;
			if (SceptreActualLevel > 4 && Randomizer == 252) SExPts /= 2;
			if (SceptreActualLevel > 3 && Randomizer == 253) SExPts /= 2;
			if (SceptreActualLevel > 2 && Randomizer == 254) SExPts /= 2;
			if (SceptreActualLevel > 1 && Randomizer == 255) SExPts /= 2;
			if (SceptreActualLevel > 0 && Randomizer == 256) SExPts /= 2;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 3 - Randomizer Check [%d]): %d / 16", Randomizer, SExPts);
		
			EXPBonus1 = 1.000;
			// Safe Tea Shoes [+2.5/5% EXP Bonus]
			if (CountInv("SafeTeaShoes", AAPTR_PLAYER1))
			{
				if (random(1,100) <= 5) EXPBonus1 += 0.050; // 5% Chance of +5% EXP Bonus
				else EXPBonus1 += 0.025; // Else +2.5% EXP Bonus
			}
			// Pearly Corset [+20/30% EXP Bonus]
			if (CountInv("PearlyCorset", AAPTR_PLAYER1))
			{
				if (random(1,100) <= 5) EXPBonus1 += 0.300; // 5% Chance of +30% EXP Bonus
				else EXPBonus1 += 0.200; // Else +20% EXP Bonus
			}
			// Dove's [+2.5/5% EXP Bonus]
			if (CountInv("DoveRibbon", AAPTR_PLAYER1))
			{
				if (random(1,100) <= 5) EXPBonus1 += 0.050; // 5% Chance of +5% EXP Bonus
				else EXPBonus1 += 0.025; // Else +2.5% EXP Bonus
			}
			SExPts *= EXPBonus1;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 4 - Armor Check [%.8f]): %d / 16", EXPBonus1, SExPts);
		
			EXPBonus1 = 1.000;
			// Divine Avatar {+25% EXP Bonus]
			if (CallACS("GetBuffTimer",7) > 0)
			{
				if (random(1,100) <= 20) EXPBonus1 += 0.500; // 20% Chance of +50% EXP Bonus
				else EXPBonus1 += 0.250; // 20% Else +25% EXP Bonus
			}
			SExPts *= EXPBonus1;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 5 - Buff Check [%3f]): %d / 16", EXPBonus1, SExPts);
			SExPts = SExPts * (DeftnessExpBase + PlayerDFT) / DeftnessExpBase;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 6 - Deftness Check): %d / 16 [DeftExpBase: %d / %d]", SExPts, (DeftnessExpBase + PlayerDFT), DeftnessExpBase);
			SExPts = SExPts * SceptreExpMultiplier / 100;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 7 - Option Checker [%d%]): %d / 16", SceptreExpMultiplier, SExPts);
		
			// "Cleared of Mind" Perk
			double perkfactor = 1.00;
			if (clearofmind > 0)
			{
				if (clearofmind >= 1) perkfactor += 0.04;
				if (clearofmind >= 2) perkfactor += 0.05;
				if (clearofmind >= 3) perkfactor += 0.06;
				if (clearofmind >= 4) perkfactor += 0.07;
				if (clearofmind >= 5) perkfactor += 0.08;
				if (clearofmindex >= 1) perkfactor += 0.15;
				if (clearofmindex >= 2) perkfactor += 0.15;
				SExPts *= perkfactor;
			}
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 8 - Cleared of Mind [%.8f]): %d / 16", perkfactor, SExPts);

			// "Higher Learning" Grand Mastery Perk
			if (higherlearning == 1) SExPts *= 1.15; // [115%]
			if (higherlearning >= 2) SExPts *= 1.30; // [130%]
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 9 - Higher Learning): %d / 16", SExPts);

			if (ModType == 0) ExpPiecesToAdd *= 1.334; // Classic Doom 1/2 / Heretic / Hexen / Strife
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 10 - ModType Checker): %d / 16", SExPts);

			SExPts = SExPts * 1.25;
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (Step 11 - ?): %d / 16", SExPts);

			while (SExPts > 15)
			{
				SExPts -= 16;
				CallACS("OtherVarSetDECORATE",10,1,1);
				if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (while 1): %d / 16", SExPts);
			}
			CallACS("MiscVarSetDECORATE",203,SExPts,1);
			SceptEXPFrags = CallACS("MiscVarCheckDECORATE",203);
		
			if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (pre-while 2): %d / 16", SceptEXPFrags);
			while (SceptEXPFrags > 15)
			{
				CallACS("MiscVarSetDECORATE",203,-16,1);
				SceptEXPFrags = CallACS("MiscVarCheckDECORATE",203);
				CallACS("OtherVarSetDECORATE",10,1,1);
				if (dvdsdebug_showexpdebugstuff) Console.Printf("\cxSExPts (while 2): %d / 16", SceptEXPFrags);
			}
		}
	}
	
	double A_DamageMobCheckShielding(Actor inflictor, Actor source, int damage, Name mod, int flags, double angle)
	{
		string infl, sour, vict;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source == null) sour = "NONE"; else sour = source.GetClassName();

		int finaldmg = damage;
		double shieldfactor;
		
		shieldfactor = 1.0;
		if (CountInv("HWShieldDefense")) shieldfactor *= 0.134;
		if (CountInv("HWShieldDefenseExtra")) shieldfactor *= 0.0268;
		if (CountInv("ImpWarlordShieldDefend")) shieldfactor *= 0.5;
		if (CountInv("ImpWarlordShieldDefendExtra")) shieldfactor *= 0.1;
		if (CountInv("DKnightShieldDefend")) shieldfactor *= 0.25;
		if (CountInv("DKnightShieldDefendExtra")) shieldfactor *= 0.05;
		if (CountInv("AcolyteShieldDefend")) shieldfactor *= 0.75;
		if (CountInv("AcolyteShieldDefendExtra")) shieldfactor *= 0.30;
		if (CountInv("CentaurShieldDefend")) shieldfactor *= 0.333;
		if (CountInv("CentaurShieldDefendExtra")) shieldfactor *= 0.0666;
		if (CountInv("SlaughtaurShieldDefend")) shieldfactor *= 0.167;
		if (CountInv("SlaughtaurShieldDefendExtra")) shieldfactor *= 0.0333;
		if (CountInv("MaulotaurChargeDefense")) shieldfactor *= 0.25;
		if (CountInv("HeresiarchShieldDefense")) shieldfactor *= 0.125;
		if (CountInv("NightmarePhaseOutDefense")) shieldfactor *= 0.0625;
		String nm = "ThamuzApocalypseDefendMode"; MiscCheck = nm; if (CountInv(MiscCheck)) shieldfactor *= 0.20;
		shieldfactor *= -1;
		shieldfactor += 1.0;

		if (infl == "HubbleBubbleSmall" || infl == "HubbleBubbleLarge") shieldfactor *= (random(0,1) * 0.01);
		if (mod == 'Sceptre')
		{
			if (infl == "SceptrePuffSpinning" || infl == "SceptrePuffSpinningSilent") shieldfactor *= (random(75,80) * 0.005);
			else shieldfactor *= (random(75,80) * 0.01);
		}

		shieldfactor *= -1;
		shieldfactor += 1.0;
		if (shieldfactor > 1.0) shieldfactor = 1.0;
		
		finaldmg = ceil(finaldmg * shieldfactor);
		if (finaldmg < 1) finaldmg = 1;
		if (dvdsdebug_actordmgdisplays && shieldfactor >= 0.01) Console.Printf("    (\czActor Defensive Input [STEP ?? - Shielding Monsters]\c-: finaldmg: %d (prevdamage: %d), shieldfactor: %4f", finaldmg, damage, shieldfactor);

		return finaldmg;
	}
	
	int A_DamageMobjCheckHellCore(Actor inflictor, Actor source)
	{
		string infl, sour, vict;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source == null) sour = "NONE"; else sour = source.GetClassName();

		int type;
		if (
				infl == "UnmakerLaser" ||
				infl == "UnmakerLaserCrisis"
			 ) type = -2;
		if (
				infl == "EvilWarriorShieldBall" ||
				infl == "EvilWarriorShieldBallCrisis"
			 ) type = -1;
		if (
				infl == "DoomImpBall_Soul" ||
				infl == "DoomImpBallCrisis_Soul"
			 ) type = 1;
		if (
				infl == "DarkSeeker_Soul" ||
				infl == "DarkSeekerCrisis_Soul"
			 ) type = 2;
		if (
				infl == "CacodemonBall_Soul" ||
				infl == "CacodemonBallCrisis_Soul"
			 ) type = 3;
		if (
				infl == "CacolanternBall_Soul" ||
				infl == "CacolanternBallCrisis_Soul"
			 ) type = 4;
		if (
				infl == "AbaddonBall_Soul" ||
				infl == "AbaddonBallCrisis_Soul"
			 ) type = 5;
		if (
				infl == "HellKnightBall_Soul" ||
				infl == "HellKnightBallCrisis_Soul"
			 ) type = 6;
		if (
				infl == "BaronOfHellBall_Soul" ||
				infl == "BaronOfHellBallCrisis_Soul"
			 ) type = 7;
		if (
				infl == "BelphegorBall_Soul" ||
				infl == "BelphegorBallCrisis_Soul"
			 ) type = 8;
		if (
				infl == "BruiserBall_Soul" ||
				infl == "BruiserBallCrisis_Soul" ||
				infl == "BruiserBall2_Soul" ||
				infl == "BruiserBall2Crisis_Soul" ||
				infl == "BruiserFireSpawner_Soul" ||
				infl == "BruiserFireSpawnerCrisis_Soul"
			 ) type = 9;
		if (
				infl == "ArchonOfHellBall_Soul" ||
				infl == "ArchonOfHellBallCrisis_Soul" ||
				infl == "ArchonComet_Soul" ||
				infl == "ArchonCometCrisis_Soul"
			 ) type = 10;
		if (
				infl == "FireShot_Soul" ||
				infl == "FireShotCrisis_Soul" ||
				infl == "PyroBall_Soul" ||
				infl == "PyroBallCrisis_Soul" ||
				infl == "PyroBlast_Soul" ||
				infl == "PyroBlastCrisis_Soul" ||
				infl == "RainCometNull_Soul" ||
				infl == "RainCometNullCrisis_Soul" ||
				infl == "EscapeExplosion_Soul" ||
				infl == "EscapeExplosionCrisis_Soul"
			 ) type = 11;
		if (
				infl == "DIPuff_Soul"
			 ) type = 12;
		if (
				infl == "ArchvileFlame_Soul" ||
				infl == "ArchvileFlameCrisis_Soul"
			 ) type = 13;
		if (
				infl == "DFlare_Soul" ||
				infl == "DFlareCrisis_Soul" ||
				infl == "DTracer_Soul" ||
				infl == "DTracerCrisis_Soul" ||
				infl == "DTracerPuff_Soul" ||
				infl == "DTracerPuffCrisis_Soul" ||
				infl == "DMissile_Soul" ||
				infl == "DMissileCrisis_Soul" ||
				infl == "DMissileCircle_Soul" ||
				infl == "DMissileCircleCrisis_Soul" ||
				infl == "DFire_Soul" ||
				infl == "DFireCrisis_Soul"
			 ) type = 14;
		if (
				infl == "FlyingBalrogShot1_Soul" ||
				infl == "FlyingBalrogShot1Crisis_Soul" ||
				infl == "FlyingBalrogShot2_Soul" ||
				infl == "FlyingBalrogShot2Crisis_Soul"
			 ) type = 15;
		if (
				infl == "HadesElementalBall_Soul" ||
				infl == "HadesElementalBallCrisis_Soul" ||
				infl == "HadesBolt_Soul" ||
				infl == "HadesBoltCrisis_Soul"
			 ) type = 16;
		if (
				infl == "StormStrike1_Soul" ||
				infl == "StormStrike1Crisis_Soul" ||
				infl == "StormShot1_Soul" ||
				infl == "StormShot1Crisis_Soul" ||
				infl == "StormShot2_Soul" ||
				infl == "StormShot2Crisis_Soul" ||
				infl == "StormBolt_Soul" ||
				infl == "StormBoltCrisis_Soul" ||
				infl == "StormBolt2_Soul" ||
				infl == "StormBolt2Crisis_Soul" ||
				infl == "StormLite1_Soul" ||
				infl == "StormLite1Crisis_Soul" ||
				infl == "StormLite2_Soul" ||
				infl == "StormLite2Crisis_Soul" ||
				infl == "HadesOverlordBall_Soul" ||
				infl == "HadesOverlordBallCrisis_Soul" ||
				infl == "OverBall_Soul" ||
				infl == "OverBallCrisis_Soul"
			 ) type = 17;
		return type;
	}
	
	Actor, Actor, int A_CheckHellcoreVsAtk(Actor inflictor, Actor source, int damage)
	{
		string infl, sour, vict;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source == null) sour = "NONE"; else sour = source.GetClassName();
		vict = GetClassName();
		bool increasedmg = false;
		int checkval;

		if ((infl == "DoomImpBall_Soul" || infl == "DoomImpBallCrisis_Soul") && (vict == "DSDoomImp" || vict == "DoomImp" || vict == "FDoomImp" || vict == "Devil" || vict == "ImpWarlordNew")) { increasedmg = true; checkval = 96; }
		if ((infl == "DarkSeeker_Soul" || infl == "DarkSeekerCrisis_Soul") && (vict == "DarkImp" || vict == "FDarkImp" || vict == "STDarkImp" || vict == "FSTDarkImp" || vict == "VoidDarkImp" || vict == "FVoidDarkImp" || vict == "NetherDarkImp" || vict == "FNetherDarkImp")) { increasedmg = true; checkval = 97; }
		if ((infl == "CacodemonBall_Soul" || infl == "CacodemonBallCrisis_Soul") && (vict == "DSCacodemon" || vict == "Cacodemon" || vict == "FCacodemon")) { increasedmg = true; checkval = 98; }
		if ((infl == "CacolanternBall_Soul" || infl == "CacolanternBallCrisis_Soul") && (vict == "Cacolantern" || vict == "FCacolantern")) { increasedmg = true; checkval = 99; }
		if ((infl == "AbaddonBall_Soul" || infl == "AbaddonBallCrisis_Soul") && (vict == "Abaddon" || vict == "FAbaddon")) { increasedmg = true; checkval = 100; }
		if ((infl == "HellKnightBall_Soul" || infl == "HellKnightBallCrisis_Soul") && (vict == "DSHellKnight" || vict == "HellKnight" || vict == "FHellKnight")) { increasedmg = true; checkval = 101; }
		if ((infl == "BaronOfHellBall_Soul" || infl == "BaronOfHellBallCrisis_Soul") && (vict == "DSBaronofHell" || vict == "BaronofHell" || vict == "FBaronofHell")) { increasedmg = true; checkval = 102; }
		if ((infl == "BelphegorBall_Soul" || infl == "BelphegorBallCrisis_Soul") && (vict == "Belphegor" || vict == "FBelphegor")) { increasedmg = true; checkval = 103; }
		if ((infl == "BruiserBall1_Soul" || infl == "BruiserBall1Crisis_Soul" ||
				 infl == "BruiserBall2_Soul" || infl == "BruiserBall2Crisis_Soul" ||
				 infl == "BruiserFireSpawner_Soul" || infl == "BruiserFireSpawnerCrisis_Soul" ||
				 infl == "BruiserFire_Soul" || infl == "BruiserFireCrisis_Soul") && (vict == "BruiserDemon" || vict == "FBruiserDemon")) { increasedmg = true; checkval = 104; }
		if ((infl == "ArchonOfHellBall_Soul" || infl == "ArchonOfHellBallCrisis_Soul" ||
				 infl == "ArchonComet_Soul" || infl == "ArchonCometCrisis_Soul") && (vict == "ArchonofHell" || vict == "FArchonofHell")) { increasedmg = true; checkval = 105; }
		if ((infl == "PyroBall_Soul" || infl == "PyroBallCrisis_Soul" ||
				 infl == "FirebombExplosion1_Soul" || infl == "FirebombExplosion1Crisis_Soul" ||
				 infl == "FirebombExplosion2_Soul" || infl == "FirebombExplosion2Crisis_Soul" ||
				 infl == "FirebombExplosion3_Soul" || infl == "FirebombExplosion3Crisis_Soul" ||
				 infl == "PyroBlast_Soul" || infl == "PyroBlastCrisis_Soul" ||
				 infl == "RainCometNull_Soul" || infl == "RainCometNullCrisis_Soul" ||
				 infl == "FallingComet_Soul" || infl == "FallingCometCrisis_Soul" ||
				 infl == "CometDeath_Soul") && (vict == "PyroDemon" || vict == "FPyroDemon")) { increasedmg = true; checkval = 106; }
		if ((infl == "ArchvileFireFast" || infl == "ArchvileFireFastCrisis" || infl == "ArchvileFlame_Soul" || infl == "ArchvileFlameCrisis_Soul") && (vict == "DSArchvile" || vict == "Archvile" || vict == "FArchvile")) { increasedmg = true; checkval = 108; }
		if ((infl == "DIPuff_Soul") && (vict == "DeathIncarnate" || vict == "FDeathIncarnate")) { increasedmg = true; checkval = 107; }
		if ((infl == "DFire_Soul" || infl == "DFireCrisis_Soul" ||
				 infl == "DFlare_Soul" || infl == "DFlareCrisis_Soul" ||
				 infl == "DMissile_Soul" || infl == "DMissileCrisis_Soul" ||
				 infl == "DTracer_Soul" || infl == "DTracerCrisis_Soul" ||
				 infl == "DTracerPuff_Soul" || infl == "DTracerPuffCrisis_Soul") && (vict == "Diabloist" || vict == "FDiabloist")) { increasedmg = true; checkval = 109; }
		if ((infl == "FlyingBalrogShot1_Soul" || infl == "FlyingBalrogShot1Crisis_Soul" ||
				 infl == "FlyingBalrogShot2_Soul" || infl == "FlyingBalrogShot2Crisis_Soul") && (vict == "FlyingBalrog" || vict == "FFlyingBalrog")) { increasedmg = true; checkval = 110; }
		if ((infl == "HadesElementalBall_Soul" || infl == "HadesElementalBallCrisis_Soul" ||
				 infl == "HadesBolt_Soul" || infl == "HadesBoltCrisis_Soul") && (vict == "HadesElemental" || vict == "FHadesElemental")) { increasedmg = true; checkval = 111; }
		if ((infl == "OverBall_Soul" || infl == "OverBallCrisis_Soul" ||
				 infl == "HadesOverlordBall_Soul" || infl == "HadesOverlordBallCrisis_Soul" ||
				 infl == "StormShot1Ball_Soul" || infl == "StormShot1BallCrisis_Soul" ||
				 infl == "StormShot2Ball_Soul" || infl == "StormShot2BallCrisis_Soul" ||
				 infl == "StormStrike1Ball_Soul" || infl == "StormStrike1Crisis_Soul" ||
				 infl == "StormBolt_Soul" || infl == "StormBoltCrisis_Soul" ||
				 infl == "StormBolt2_Soul" || infl == "StormBolt2Crisis_Soul" ||
				 infl == "StormLite1_Soul" || infl == "StormLite1Crisis_Soul" ||
				 infl == "StormLite2_Soul" || infl == "StormLite2Crisis_Soul") && (vict == "HadesOverlord" || vict == "FHadesOverlord")) { increasedmg = true; checkval = 112; }

		//Console.Printf("increasedmg: %d", increasedmg);
		if (increasedmg) 
		{
			damage = floor(damage * (1.0 + (CallACS("MiscVarCheckDECORATE",checkval) * frandom(0.15,0.2))));
		}
		return inflictor, source, damage;
	}
	
	void A_CheckNeverBleed(int type, int damage, int flags)
	{
		if (type == 0)
		{
			if (neverbleeds == 0)
			{
				if (bNOBLOOD) bNOBLOOD = 0;
				if (bNOBLOODDECALS) bNOBLOODDECALS = 1;
			}
		}
		else
		{
			//Console.Printf("(A_CheckNeverBleed [player], damage: %d)", damage);
			if (flags & !DMG_EXPLOSION)
			{
				if (neverbleeds == 0)
				{
					bNOBLOOD = 1;
					bNOBLOODDECALS = 1;
				}
			}
		}
	}
	
	int, int A_CalcCritChance(Actor inflictor, Actor source, int damage, Name mod, int flags, double angle)
	{
		AetheriusPlayerPawn playpawn;
		AetheriusMonsterZSC DVDSActor;
		AetheriusMonsterZSC DVDSVictim;
		AetheriusProjectileZSC UniqueProjectile;
		AetheriusFastProjectileZSC UniqueProjectileFast;
		AetheriusEffectProjectile ailmentproj;
		AetheriusEffectFastProjectile ailmentprojfast;
		SingleDamageRipper singleripproj;
		SingleDamageFastRipper singlefastripproj;

		if (source) 
		{
			playpawn = AetheriusPlayerPawn(source);
			if (dvdsdebug_actordmgdisplays && playpawn) Console.Printf("Playpawn (source) Found! [CalcCritChance]");
			DVDSActor = AetheriusMonsterZSC(source);
			if (dvdsdebug_actordmgdisplays && DVDSActor) Console.Printf("DVDSActor (source) Found! [CalcCritChance]");
		}
		if (inflictor)
		{
			UniqueProjectile = AetheriusProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectile) Console.Printf("UniqueProjectile (inflictor) Found! [CalcCritChance]");
			UniqueProjectileFast = AetheriusFastProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectileFast) Console.Printf("UniqueProjectileFast (inflictor) Found! [CalcCritChance]");
			ailmentproj = AetheriusEffectProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentproj) Console.Printf("ailmentproj (inflictor) Found! [CalcCritChance]");
			ailmentprojfast = AetheriusEffectFastProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentprojfast) Console.Printf("ailmentprojfast (inflictor) Found! [CalcCritChance]");
			singleripproj = SingleDamageRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singleripproj) Console.Printf("singleripproj (inflictor) Found! [CalcCritChance]");
			singlefastripproj = SingleDamageFastRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singlefastripproj) Console.Printf("singlefastripproj (inflictor) Found! [CalcCritChance]");
		}
		string ActorClass;
		int CritChance = 0;
		int meleeattack = 0;
		string infl, sour, vict;
		vict = GetClassName();
		if (inflictor != null) lastattackeratk = inflictor;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source != null) lastattacker = source;
		if (source == null) sour = "NONE"; else sour = source.GetClassName();

		if (DVDSActor)
		{
			ActorClass = DVDSActor.GetClassName();

			if (mod == 'Melee' || mod == 'Trample' || mod == 'Stomp' || mod == 'Fist' || mod == 'Kick' || mod == 'Chainsaw' || mod == 'Gauntlets' || mod == 'Sceptre') meleeattack = 1;
			//*****************************************************
			//**Allows Monsters to deal crits [4/256 base chance]**
			//*****************************************************
			// Base Chances
			CritChance = 8 + (DVDSActor.user_monsterlevel / 11.25); // 8 (+ 8 every 90 levels)
			if (DVDSActor && DVDSActor.bBOSS) CritChance = (CritChance * 3) / 2; // Boss Flag Check
			if (DVDSActor && DVDSActor.bJUSTHIT) CritChance *= 2; // JustHit Flag Check
			if (DVDSActor && DVDSActor.user_charmed) CritChance = (CritChance * 3) / 2; // Charm Flag Check
			if (DVDSActor && DVDSActor.user_legendaryevolved) CritChance *= 4; // Legendaries have double crit rate
			if (DVDSActor && DVDSActor.health <= DVDSActor.user_HPBuffRange) CritChance = (CritChance * 6) / 4;
			
			// Actor Only Checks
			if (ActorClass == "DSHelperDog") CritChance *= 3; // Helper Dogs get triple crit rate
			if (ActorClass == "DSPainElemental" || ActorClass == "FPainElemental" || ActorClass == "DSPainElemental64" || ActorClass == "DSLostSoul" || ActorClass == "DSLostSoul2" || ActorClass == "ForgottenOne" || ActorClass == "DSLostSoul64" || ActorClass == "DSLostSoul642" ||
					ActorClass == "FLostSoul1" || ActorClass == "FLostSoul2") CritChance *= 4; // Pain-Elementals/Lost Souls are Crit-happy nuisances
			if (ActorClass == "DSRevenant" || ActorClass == "FRevenant" || ActorClass == "DeathIncarnate" || ActorClass == "FDeathIncarnate") CritChance *= 1.5; // Revenants/Death Incarnates have 50% more crit
			if (ActorClass == "ChainsawZombieNew") CritChance *= 2.5; // Chainsaw Zombies have 150% more crit
			if (ActorClass == "NightmareNew" || ActorClass == "SirenNightmareNew") CritChance *= 4; // Nightmares are good at crits too
			if (ActorClass == "EvilDeadHandNew" || ActorClass == "BabyClownNew" || 
					ActorClass == "BabyClown2New" || ActorClass == "BouncingClownNew" ||
					ActorClass == "StarSpawn" || ActorClass == "SpiderGod" || ActorClass == "SpiderGodling") CritChance *= 4;
			// Ally Specific
			if (ActorClass == "RebelNew" || ActorClass == "Rebel1New" || ActorClass == "Rebel2New" || ActorClass == "Rebel3New" || 
					ActorClass == "Rebel4New" || ActorClass == "Rebel5New" || ActorClass == "Rebel6New") 
					CritChance *= frandom(1.75,2.25); // Strife Rebels have +75-125% more crit
			// Boss Only Checks
			if (ActorClass == "DragonNew" || ActorClass == "FDragon" || ActorClass == "HeresiarchNew" || ActorClass == "FHeresiarch" || 
					ActorClass == "DSparilMountedNew" || ActorClass == "ClericBossNew" || ActorClass == "FighterBossNew" || ActorClass == "MageBossNew" ||
					ActorClass == "ProgrammerNew" || ActorClass == "StrifeBishopNew" || ActorClass == "LoremasterNew" || ActorClass == "Macil1New" || ActorClass == "StrifMacil2NeweBishopNew" ||
					ActorClass == "NyarlathotepLesser") CritChance *= 4;
			if (ActorClass == "AlienSpectre1New" || ActorClass == "AlienSpectre2New" || ActorClass == "AlienSpectre3New" || ActorClass == "AlienSpectre4New" || ActorClass == "AlienSpectre5New" ||
					ActorClass == "AvatarNew" || ActorClass == "Benellus1DS" || ActorClass == "Benellus2DS" || ActorClass == "Benellus3DS" ||
					ActorClass == "TNTSpider" || ActorClass == "SourceGuardian" || ActorClass == "AdolfHitlerDS") CritChance *= 6;
			if (ActorClass == "DSparilUnmountedNew" || ActorClass == "KoraxNew" || ActorClass == "PennywiseBoss" ||
					ActorClass == "EntityBossNew" || ActorClass == "EntitySecondNew" || ActorClass == "EntityAscended" || ActorClass == "ThamuzNew" || ActorClass == "TchernobogNew" ||
					ActorClass == "Magmantis" || ActorClass == "Zakachi") CritChance *= 8;
			if (ActorClass == "Nyarlathotep") CritChance *= 12;
			
			// Unique Checks
			if (meleeattack && (ActorClass == "WraithNew" || ActorClass == "WraithBuriedNew" || ActorClass == "FWraith")) 
					CritChance *= 4;
			
			if (meleeattack && (ActorClass == "Dragon" || ActorClass == "FDragon")) 
					CritChance *= 8;
			
			if (meleeattack && (ActorClass == "EttinNew" || ActorClass == "EttinCommander" || ActorClass == "Bormereth" ||
					ActorClass == "FEttinNew" || ActorClass == "FEttinCommander" || ActorClass == "FBormereth")) 
					CritChance *= 2.25; // Ettins have 125% more crit for Melee
			
			if (meleeattack && (ActorClass == "StalkerNew" || ActorClass == "StalkerLeaderNew" || ActorClass == "IceStalker" || ActorClass == "IceStalkerLeader" || 
					ActorClass == "FStalker" || ActorClass == "FStalkerLeader")) 
					CritChance *= 2; // Hexen Stalkers have 2x more crit for Melee
			
			if (meleeattack && (ActorClass == "CentaurNew" || ActorClass == "SlaughtaurNew" || 
					ActorClass == "FCentaur" || ActorClass == "FSlaughtaur")) 
					CritChance *= 2; // Centaurs have 2x more crit for Melee
			
			if (meleeattack && (ActorClass == "DSRevenant" || ActorClass == "FRevenant" || ActorClass == "DeathIncarnate" || ActorClass == "FDeathIncarnate")) 
					CritChance *= 1.5; // Revenants/Death Incarnates have another +50% more crit when using melee
			
			if (meleeattack && (ActorClass == "KnightNew" || ActorClass == "FKnight" || ActorClass == "KnightGhostNew" || ActorClass == "FKnightGhost")) 
					CritChance *= 1.5; // Undead Warriors [Heretic] have another +50% more crit when using melee
			
			if (meleeattack && (ActorClass == "ReaverNew")) 
					CritChance *= 3; // Reavers have 3x more crit for melee
			
			if (meleeattack && (ActorClass == "OStalkerNew")) 
					CritChance *= 1.5; // Strife Stalkers have 50% more crit
			
			if (meleeattack && 
					(ActorClass == "DSCacodemon" || ActorClass == "DSCacodemon64" || ActorClass == "FCacodemon" ||
					ActorClass == "Cacolantern" || ActorClass == "FCacolantern" ||
					ActorClass == "Abaddon" || ActorClass == "FAbaddon")) 
					CritChance *= 2; // Cacos have 2x Crit for Melee
			
			if (meleeattack && 
					(ActorClass == "HadesElemental" || ActorClass == "FHadesElemental" ||
					ActorClass == "HadesOverlord" || ActorClass == "FHadesOverlord")) 
					CritChance *= 3; // Hades Scions have 3x Crit for Melee
			
			if (meleeattack && (ActorClass == "SatyrNew")) 
					CritChance *= 8; // Satyrs are very likely to crit too
					
			if (meleeattack && 
					(ActorClass == "DSDemon" || ActorClass == "DSDemon64" || 
					ActorClass == "DSSpectre" || ActorClass == "DSSpectre64" || 
					ActorClass == "BloodDemon" || ActorClass == "BloodSpectre" ||
					ActorClass == "BloodFiendNew" || ActorClass == "LurkerNew" ||
					ActorClass == "FDemon" || ActorClass == "FSpectre" || 
					ActorClass == "FBloodDemon" || ActorClass == "FBloodSpectre")) 
					CritChance *= 1.5; // Pinkies have 50% more crit with Melee
			
			if (meleeattack && (ActorClass == "ClinkNew" || ActorClass == "FClink" || ActorClass == "DarkClink" || ActorClass == "FDarkClink")) 
					CritChance *= 1.5; // SabreClaws have 50% more crit with Melee
			
			if (meleeattack && 
					(ActorClass == "DSCyberdemon" || ActorClass == "DSCyberdemon64" || ActorClass == "Annihilator" || 
					ActorClass == "FCyberdemon" || ActorClass == "FAnnihilator")) 
					CritChance *= 8; // Cyberdemon Stomps/Melee have 8x chance to crit.
			
			if (meleeattack && 
					(ActorClass == "DSHellKnight" || ActorClass == "DSHellKnight64" || ActorClass == "FHellKnight" || 
					ActorClass == "HellWarrior" || ActorClass == "FHellWarrior" || 
					ActorClass == "DSBaronofHell" || ActorClass == "DSBaronofHell64" || ActorClass == "FBaronofHell" || 
					ActorClass == "Belphegor" || ActorClass == "FBelphegor" || 
					ActorClass == "BruiserDemon" || ActorClass == "FBruiserDemon" || 
					ActorClass == "CyBruiser" || ActorClass == "FCyBruiser" || 
					ActorClass == "ArchonofHell" || ActorClass == "FArchonofHell" ||
					ActorClass == "PyroDemon" || ActorClass == "FPyroDemon" ||
					ActorClass == "WeakenedFlyingBalrog" || ActorClass == "FlyingBalrog" || ActorClass == "FFlyingBalrog" || 
					ActorClass == "Hierophant" || ActorClass == "FHierophant")) 
					CritChance *= 4; // Hell Nobles have 4x chance to Crit w/ melee attacks
			
			// Misc
			if (mod == 'BFG' || mod == 'BFGSpray' || mod == 'BFGSplash') // BFG related attacks have signficantly LESS chance to crit, but still always have at least a 1/512 chance :P
			{ 
				CritChance *= 0.25;
				if (CritChance < 1) CritChance = 1;
			}
			if (infl == "DemonFire" || infl == "DemonFireCrisis" || 
					infl == "MiniFirePuff" || infl == "MiniFirePuffCrisis" || 
					infl == "DogFireNew" || infl == "DogFireNewCrisis" ||
					infl == "FireBreath" || infl == "FireBreathCrisis" ||
					infl == "SGuardianFlameBreath" || infl == "SGuardianFlameBreathCrisis" ||
					infl == "Demon5Jet" || infl == "Demon5JetCrisis")
			{
				CritChance *= 4;
			}
			if (infl == "SuicideBomber" || infl == "SuicideBomb" || infl == "SuicideBombStrong" || infl == "SuicideBombUltra" || infl == "HSBoom" || infl == "HadesSphere" || infl == "HSOverlord") CritChance = 0; // Kamikaze Monsters Cannot Crit
		}
		return CritChance, meleeattack;
	}

	override int DamageMobj(Actor inflictor, Actor source, int damage, Name mod, int flags, double angle)
	{
		if (mod == 'Heal1' || mod == 'Heal2' || mod == 'Heal3' || mod == 'Heal4') return 0;
		if (CallACS("MenuVarCheckDECORATE",0) > 0)
		{
			if (mod == 'Crush') return 0;
		}
		if (bDORMANT)
		{
			if (!(mod == "SilentMassacre" || mod == "Massacre" || mod == "InstantDeath")) return 0;
		}

		if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input\c-: \cygametic = %d\c-)", gametic);
		int predamage = damage;
		int firstdamage = damage;

		int PlayerTensionLevel = CallACS("MiscVarCheckDECORATE",181);
		int MagiUpPerkLvl = CallACS("MiscVarCheckDECORATE",10003);
		int MagiUpExPerkLvl = CallACS("MiscVarCheckDECORATE",10004);
		int StamUpPerkLvl = CallACS("MiscVarCheckDECORATE",10005);
		int StamUpEXPerkLvl = CallACS("MiscVarCheckDECORATE",10006);
		int BulletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10019);
		int BulletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10020);
		int PelletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10021);
		int PelletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10022);
		int PlasmaAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10023);
		int PlasmaAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10024);
		int DemolitionsExpertPerkLevel = CallACS("MiscVarCheckDECORATE",10025);
		int DemolitionsExpertEXPerkLevel = CallACS("MiscVarCheckDECORATE",10026);
		int KarasawaAttunementPerkLevel = CallACS("MiscVarCheckDECORATE",10027);
		int KarasawaAttunementEXPerkLevel = CallACS("MiscVarCheckDECORATE",10028);
		int BFGAttunementPerkLevel = CallACS("MiscVarCheckDECORATE",10029);
		int BFGAttunementEXPerkLevel = CallACS("MiscVarCheckDECORATE",10030);
		int ArcheryMasteryPerkLevel = CallACS("MiscVarCheckDECORATE",10031);
		int ArcheryMasteryEXPerkLevel = CallACS("MiscVarCheckDECORATE",10032);
		int SoulMasteryPerkLevel = CallACS("MiscVarCheckDECORATE",10033);
		int SoulMasteryEXPerkLevel = CallACS("MiscVarCheckDECORATE",10034);
		int MartialArtsMastery = CallACS("MiscVarCheckDECORATE",10035);
		int MartialArtsMasteryEX = CallACS("MiscVarCheckDECORATE",10036);
		int BerserkerFit = CallACS("MiscVarCheckDECORATE",10051);
		int BerserkerFitEX = CallACS("MiscVarCheckDECORATE",10052);
		int WandMastPerkLvl = CallACS("MiscVarCheckDECORATE",10053);
		int WandMastEXPerkLvl = CallACS("MiscVarCheckDECORATE",10054);
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int clearofmindex = CallACS("MiscVarCheckDECORATE",10056);
		int VillainKillerPerkLvl = CallACS("MiscVarCheckDECORATE",10057);
		int VillainKillerEXPerkLvl = CallACS("MiscVarCheckDECORATE",10058);
		int StrifeStaminaLevel = CallACS("MiscVarCheckDECORATE",317);
		int StrifeAccuracyLevel = CallACS("MiscVarCheckDECORATE",318);
		bool criticalhit = false;
		int CritChance, CritRoll;
		int oldhealth = self.health;
		int SceptreActualLevel = CallACS("OtherVarCheckDECORATE",11);
		double HellcoreBaseMulti = 1.0;
		double HellcoreLevelFactor = 1.0;
		int HellcoreLevel;
		int IsHellCoreAttack = A_DamageMobjCheckHellCore(inflictor, source);
		int HellcoreType = 0; 
		if (IsHellCoreAttack > 0) HellcoreType = IsHellCoreAttack + 95;
		if (IsHellCoreAttack < 0) HellcoreType = -1;
		if (dvdsdebug_actordmgdisplays && IsHellCoreAttack) Console.Printf("    (\czIsHellCoreAttack?: %d, HellcoreType: %d", IsHellCoreAttack, HellcoreType);
		
		bool wasblastedimpact = false;
		if (inflictor == null && source == null && mod == 'Melee') 
		{
			wasblastedimpact = true;
			if (bBLASTED && random(1,4) <= 3) bBLASTED = false;
			if (vel.x != 0.0) vel.x *= 0.1;
			if (vel.y != 0.0) vel.y *= 0.1;
			if (dvdsdebug_actordmgdisplays && wasblastedimpact) Console.Printf("    (\czwasblastedimpact?: %d", wasblastedimpact);
		}
		
		if (dvdsdebug_actordmgdisplays)
		{
			if (flags & DMG_NO_ARMOR) Console.Printf("    (\cyIgnoresArmor?: yes)");
			if (flags & DMG_INFLICTOR_IS_PUFF) Console.Printf("    (\cyInflictorIsPuff?: yes)");
			if (flags & DMG_THRUSTLESS) Console.Printf("    (\cyThrustless?: yes)");
			if (flags & DMG_FORCED) Console.Printf("    (\cyForcedDamage?: yes)");
			if (flags & DMG_NO_FACTOR) Console.Printf("    (\cyNoDmgFactor?: yes)");
			if (flags & DMG_PLAYERATTACK) Console.Printf("    (\cyPlayerAttack?: yes)");
			if (flags & DMG_FOILINVUL) Console.Printf("    (\cyFoilInvuln?: yes)");
			if (flags & DMG_FOILBUDDHA) Console.Printf("    (\cyFoilBuddha?: yes)");
			if (flags & DMG_NO_PROTECT) Console.Printf("    (\cyBypassPowerProtection?: yes)");
			if (flags & DMG_NO_ENHANCE) Console.Printf("    (\cyBypassPowerDamage?: yes)");
			if (flags & DMG_USEANGLE) Console.Printf("    (\cyUsesAngle?: yes)");
			if (flags & DMG_EXPLOSION) Console.Printf("    (\cyIsAoEBurst?: yes)");
		}

		if (mod == 'dashing')
		{
			if (NORADDMG == 1 && bNORADIUSDMG) 
			{
				bNORADIUSDMG = 0;
				if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP ? - UNSET NORADIUSDMG TEMPORARILY])");
			}
		}
		A_CheckNeverBleed(0, damage, flags);
		int drainmaxdmg = self.health; // Prevents overdamage from gauntlets from being factored into Healing values
		string infl, sour, vict;
		vict = GetClassName();
		if (inflictor != null) lastattackeratk = inflictor;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source != null) lastattacker = source;
		if (source == null) sour = "NONE"; else sour = source.GetClassName();
		
		
		// Crush Damage
		if (mod == 'Crush')
		{
			predamage = damage;
			damage *= 8.0;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\cz[STEP -?] Actor Defensive Input [\cyCrush Check\c-]\c-: %d, [prev: %d])", damage, predamage);
		}

		// Is spawned via a Mapspot [i.e. Hexen shooters]
		if (sour == "FS_MapSpot" || sour == "MapSpot" || sour == "MapspotGravity")
		{
			predamage = damage;
			double msdmgmulti = (1.0 + (A_MapCheckDamageMobj() * 0.025));
			damage *= msdmgmulti;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\cz[STEP -5] Actor Defensive Input [\cyMapSpot Check\c-]\c-: %d, [prev: %d] {multi: %.8f})", damage, predamage, msdmgmulti);
		}

		bool isaminionpolykill = false;
		// PE/HE/HO Minion spawn situations
		if ((sour == "DSPainElemental" && infl == "DSPainElemental") || (sour == "FPainElemental" || infl == "FPainElemental"))
		{
			if (vict == "DSLostSoul" || vict == "FLostSoul" || vict == "DSLostSoul2" || vict == "FLostSoul2" || vict == "ForgottenOne" || vict == "FForgottenOne")
			{
				isaminionpolykill = true;
			}
		}
		if ((sour == "HadesElemental" && infl == "HadesElemental") || (sour == "FHadesElemental" || infl == "FHadesElemental") || (sour == "HadesOverlord" && infl == "HadesOverlord") || (sour == "FHadesOverlord" || infl == "FHadesOverlord"))
		{
			if (vict == "HadesSphere" || vict == "HSOverlord" || vict == "FHadesSphere" || vict == "FHSOverlord")
			{
				isaminionpolykill = true;
			}
		}
		if (isaminionpolykill) 
		{
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (isaminionpolykill)");
			return 1000000;
		}

		int olddmg = damage;
		if (dvdsdebug_actordmgdisplays && olddmg > 0) Console.Printf("    (\czActor Defensive Input [STEP 1 - Base Damage]\c-: \cydmg = %d\c-, mod = %s)", olddmg, mod);


		if (HellcoreType != 0)
		{
			HellcoreLevel = 0;
			olddmg = damage;
			if (HellcoreType > 0) HellcoreLevel = CallACS("MiscVarCheckDECORATE",HellcoreType);
			if (HellcoreLevel < 0) HellCoreLevel = 0;
			if (HellcoreLevel > 0)
			{
				if (HellcoreLevel >= 9) HellCoreLevel = 9;
				HellcoreBaseMulti = dvds_basehellcoremulti;
				if (HellcoreLevel >= 1) HellcoreLevelFactor = HellcoreBaseMulti;
				if (HellcoreLevel >= 2) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 3) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 4) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 5) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 6) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 7) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 8) HellcoreLevelFactor *= HellcoreBaseMulti;
				if (HellcoreLevel >= 9) HellcoreLevelFactor *= HellcoreBaseMulti;
				damage = floor(damage * HellcoreLevelFactor);
			}
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (input: HellcoreLevelFactor [%d, LVL %d] = %10f)  (damage: \cy%d\c- (\cx%d\c-))", HellcoreType, HellcoreLevel, HellcoreLevelFactor, damage, olddmg);
			
			olddmg = damage;
			double SoulMasteryFactor = 1.0;
			SoulMasteryFactor = 1.00 + ((SoulMasteryPerkLevel * 0.10) + (SoulMasteryEXPerkLevel * 0.25));
			damage = floor(damage * SoulMasteryFactor);
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (input: SoulMasteryFactor [%d, %d] = %10f)  (damage: \cy%d\c- (\cx%d\c-))", SoulMasteryPerkLevel, SoulMasteryEXPerkLevel, SoulMasteryFactor, damage, olddmg);
		}
		if (IsHellCoreAttack != 0)
		{
			if (CharacterClass == 2 && CountInv("RuinousShield", AAPTR_PLAYER1))
			{
				olddmg = damage;
				damage = floor(damage * 2.56);
				if (dvdsdebug_actordmgdisplays) Console.Printf("    (input: Ruinous Shield)  (damage: \cy%d\c- (\cx%d\c-))", damage, olddmg);
			}
		}

		double prevDamageFactor;
		double critdmgmulti = 2.0 + (0.01 * random(-10,10));
		double critextradmgmulti = 1.0 + (clearofmind * 0.10) + (clearofmindex * 0.25);
		critdmgmulti *= critextradmgmulti;
		double ldldmgmulti = 1.0;
		int preplayerdmg = damage;
		int prefriendlydmg = 0;
		int precritdmg = 0;
		int preldldmg = 0;
		double PoisonNeedleCritChance = 12.5;
		int PoisonNeedleBossCheck = 0;
		// Player/Actor Check
		AetheriusPlayerPawn playpawn;
		AetheriusMonsterZSC DVDSActor;
		AetheriusMonsterZSC DVDSVictim;
		AetheriusProjectileZSC UniqueProjectile;
		AetheriusFastProjectileZSC UniqueProjectileFast;
		AetheriusEffectProjectile ailmentproj;
		AetheriusEffectFastProjectile ailmentprojfast;
		SingleDamageRipper singleripproj;
		SingleDamageFastRipper singlefastripproj;

		if (vict == "Sauravatar" || 
				MonsterFamily == "PracticeTarget" ||
				vict == "ProgrammerNew" || vict == "StrifeBishopNew" || vict == "OracleNew" || vict == "Macil1New" || vict == "Macil2New" || vict == "LoremasterNew" ||
				vict == "AlienSpectre1New" || vict == "AlienSpectre2New" || vict == "AlienSpectre3New" || vict == "AlienSpectre4New" || vict == "AlienSpectre5New" ||
				vict == "AvatarNew" || vict == "Benellus1DS" || vict == "Benellus2DS" || vict == "Benellus3DS" ||
				vict == "TNTSpider" || vict == "SourceGuardian" || vict == "AdolfHitlerDS" ||
				vict == "DSparilUnmountedNew" || vict == "KoraxNew" || vict == "PennywiseBoss" ||
				vict == "EntityBossNew" || vict == "EntitySecondNew" || vict == "EntityAscended" || vict == "ThamuzNew" || vict == "TchernobogNew" ||
				vict == "Magmantis" || vict == "Zakachi" ||
				vict == "Nyarlathotep" || vict == "NyarlathotepLesser" || vict == "StarSpawn" || vict == "SpiderGod" || vict == "SpiderGodling") 
				PoisonNeedleBossCheck = 1;
				
		int playweaksound = 0;
		//*******************
		//* Weakness Sounds *
		//*******************
		int tempdmgval = 10000;
		double tempdmgfactor = damagefactor;
		damagefactor = 1.0;
		int moddedDMG = ApplyDamageFactor(mod, tempdmgval);
		damagefactor = tempdmgfactor;
		double outputdmgfactor = 1.0;
		outputdmgfactor *= moddedDMG;
		outputdmgfactor /= tempdmgval;
		if (MonsterFamily != "PracticeTarget")
		{
			if (damage > 0 && !(flags & DMG_NO_FACTOR)) 
			{
				if (!(mod == '' || mod == 'Normal' || mod == 'Crush' || mod == 'Falling' || mod == 'Drowning'))
				{
					if (moddedDMG <= (tempdmgval * 0.25)) playweaksound = -3;
					if (moddedDMG >= (tempdmgval * 0.25) && moddedDMG <= (tempdmgval * 0.3999999)) playweaksound = -2;
					if (moddedDMG >= (tempdmgval * 0.4) && moddedDMG <= (tempdmgval * 0.6666667)) playweaksound = -1;
					if (moddedDMG >= (tempdmgval * 1.5) && moddedDMG <= (tempdmgval * 2.4999999)) playweaksound = 1;
					if (moddedDMG >= (tempdmgval * 2.5) && moddedDMG <= (tempdmgval * 3.9999999)) playweaksound = 2;
					if (moddedDMG >= (tempdmgval * 4.0)) playweaksound = 3;
					if (playweaksound > 0) A_SetInventory("TookWeaknessHit",playweaksound);
					else if (playweaksound < 0) A_SetInventory("TookResistanceHit",(playweaksound*-1));
					if (dvdsdebug_actordmgdisplays) Console.Printf("moddedDMG: %d (%.8f) (%s), playweaksound: %d, damagefactor: %.8f", moddedDMG, outputdmgfactor, mod, playweaksound, damagefactor);
				}
			}
		}
		if (MonsterFamily == "PracticeTarget") targetdummyhitcooldown = 175;

		if (source) 
		{
			playpawn = AetheriusPlayerPawn(source);
			if (dvdsdebug_actordmgdisplays && playpawn) Console.Printf("Playpawn (source) Found! [DamageMobj]");
			DVDSActor = AetheriusMonsterZSC(source);
			if (dvdsdebug_actordmgdisplays && DVDSActor) Console.Printf("DVDSActor (source) Found! [DamageMobj]");
		}
		if (inflictor)
		{
			UniqueProjectile = AetheriusProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectile) Console.Printf("UniqueProjectile (inflictor) Found! [DamageMobj]");
			UniqueProjectileFast = AetheriusFastProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectileFast) Console.Printf("UniqueProjectileFast (inflictor) Found! [DamageMobj]");
			ailmentproj = AetheriusEffectProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentproj) Console.Printf("ailmentproj (inflictor) Found! [DamageMobj]");
			ailmentprojfast = AetheriusEffectFastProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentprojfast) Console.Printf("ailmentprojfast (inflictor) Found! [DamageMobj]");
			singleripproj = SingleDamageRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singleripproj) Console.Printf("singleripproj (inflictor) Found! [DamageMobj]");
			singlefastripproj = SingleDamageFastRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singlefastripproj) Console.Printf("singlefastripproj (inflictor) Found! [DamageMobj]");
		}

		// ****************************
		[inflictor, source, damage, mod, flags, angle] = A_DamageMobPreReturn1(inflictor, source, damage, mod, flags, angle);
		// ****************************

		//**********************************
		//*Chance to RESIST a critical hit.*
		//**********************************
		double CritResistChance = 1.25;
		// Enemy Type
		if (vict == "DSPainElemental" || vict == "FPainElemental") CritResistChance = 5.0;
		if (vict == "DSPainElemental64") CritResistChance = 5.0;
		if (vict == "HadesElemental" || vict == "FHadesElemental") CritResistChance = 5.0;
		if (vict == "HadesOverlord" || vict == "FHadesOverlord") CritResistChance = 5.0;
		if (vict == "DSLostSoul" || vict == "FLostSoul") CritResistChance = 12.5;
		if (vict == "DSLostSoul2" || vict == "FLostSoul2") CritResistChance = 17.5;
		if (vict == "ForgottenOne" || vict == "FForgottenOne") CritResistChance = 25.0;
		if (vict == "HadesSphere" || vict == "FHadesSphere") CritResistChance = 12.5;
		if (vict == "HSOverlord" || vict == "FHSOverlord") CritResistChance = 12.5;
		// Enemy Flags
		if (bBOSS) CritResistChance *= 2.5;
		// Enemy Has "Item"
		if (CountInv("HWShieldDefense")) CritResistChance += ((100.0 - CritResistChance) * 0.6588);
		if (CountInv("HWShieldDefenseExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.92232);
		if (CountInv("ImpWarlordShieldDefend")) CritResistChance += ((100.0 - CritResistChance) * 0.25);
		if (CountInv("ImpWarlordShieldDefendExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.45);
		if (CountInv("DKnightShieldDefend")) CritResistChance += ((100.0 - CritResistChance) * 0.375);
		if (CountInv("DKnightShieldDefendExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.475);
		if (CountInv("AcolyteShieldDefend")) CritResistChance += ((100.0 - CritResistChance) * 0.125);
		if (CountInv("AcolyteShieldDefendExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.35);
		if (CountInv("CentaurShieldDefend")) CritResistChance += ((100.0 - CritResistChance) * 0.333);
		if (CountInv("CentaurShieldDefendExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.48666);
		if (CountInv("SlaughtaurShieldDefend")) CritResistChance += ((100.0 - CritResistChance) * 0.41667);
		if (CountInv("SlaughtaurShieldDefendExtra")) CritResistChance += ((100.0 - CritResistChance) * 0.49333);
		if (CountInv("MaulotaurChargeDefense")) CritResistChance += ((100.0 - CritResistChance) * 0.375);
		if (CountInv("HeresiarchShieldDefense")) CritResistChance += ((100.0 - CritResistChance) * 0.4375);
		if (CountInv("NightmarePhaseOutDefense")) CritResistChance += ((100.0 - CritResistChance) * 0.46875);
		String nm = "ThamuzApocalypseDefendMode"; MiscCheck = nm; if (CountInv(MiscCheck)) CritResistChance += ((100.0 - CritResistChance) * 0.4);
		// Flag Detection
		if (user_legendaryevolved) CritResistChance += ((100.0 - CritResistChance) * 0.1875);
		// Type Detection
		if (mod == 'Sigil' || mod == 'SpectralLow') CritResistChance *= 0.75;
		if (mod == 'Eldritch' || mod == 'Deadlight') CritResistChance *= 0.25;
		// Ripper Detection
		if (infl == "RagingSpirit") 
		{
			if (random(1,24) != 1) CritResistChance = 200.0;
			if (UniqueProjectile && random(1,6) == 1) UniqueProjectile.user_fuse -= randompick(1,1,1,1,1,1,1,1,1,1,1,2);
		}
		if (infl == "RagingSpirit2")
		{
			if (random(1,6) != 1) CritResistChance = 200.0;
			if (UniqueProjectile && random(1,24) == 1) UniqueProjectile.user_fuse -= randompick(1,1,1,1,1,1,1,1,1,1,1,2);
		}
		if (inflictor && inflictor.bRIPPER) { if (!singleripproj && !singlefastripproj && random(1,6) != 1) CritResistChance = 200.0; } // 5 out of 6 times, Raging Spirits/Rippers can't Crit

		if (playpawn && damage > 0)
		{
			if (infl != "NONE")
			{
				predamage = damage;
				[inflictor, source, damage] = A_CheckHellcoreVsAtk(inflictor, source, damage);
				if (dvdsdebug_actordmgdisplays) Console.Printf("    %d (%d)", damage, predamage);
			}

			prefriendlydmg = damage;
			if (bFRIENDLY)
			{
				damage = 0;
				A_CheckNeverBleed(1, damage, flags);
				if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP Z]\c-: END DAMAGE ATTEMPT (FRIENDLY)");
				return 0;
			}
			
			double CritResistChanceReduce = 1.0 - (clearofmind * 0.0125) + (clearofmindex * 0.03125);
			CritResistChance *= CritResistChanceReduce;

			if (mod == 'PoisonNeedle') // Poison Needle will not thrust
			{
				if (playpawn.CountInv("DealCriticalHit")) playpawn.A_SetInventory("DealCriticalHit", 0); // Forces the Needle to use its own personal Crit Chance instead of the normal one.
				flags |= DMG_THRUSTLESS;
				flags |= DMG_NO_ARMOR;
				flags |= DMG_NO_FACTOR;
				flags |= DMG_NO_PROTECT; 
				CritResistChance = -200.0; // Cannot be resisted

				if (damage < 1) damage = randompick(1,1,1,1,2);

				PoisonNeedleCritChance += ((StamUpPerkLvl * 0.5) + (StamUpEXPerkLvl * 1.25)); // StamUp
				PoisonNeedleCritChance += ((MartialArtsMastery * 1.0) + (MartialArtsMasteryEX * 2.5)); // Martial Arts Mastery
				PoisonNeedleCritChance += ((clearofmind * 0.25) + (clearofmindex * 0.625)); // Cleared of Mind
				PoisonNeedleCritChance += ((StrifeStaminaLevel * 0.25) + (StrifeAccuracyLevel * 0.75)); // Strife [Stamina and Accuracy]
				if (CallACS("GetBuffTimer",10) > 0) PoisonNeedleCritChance *= 1.25;
				if (CallACS("GetBuffTimer",13) > 0) PoisonNeedleCritChance *= 0.80;
				if (CallACS("GetBuffTimer",1) > 0 && playpawn) PoisonNeedleCritChance *= (((playpawn.InvisNeedleBonus - 1.00) * 0.3334) + 1.00);
				
				if (PlayerTensionLevel > 0) PoisonNeedleCritChance = (PoisonNeedleCritChance * (PlayerTensionLevel + 7)) / 7;
				if (PoisonNeedleBossCheck) PoisonNeedleCritChance *= 0.25;
				if (playpawn.CountInv("PlayerDashing")) PoisonNeedleCritChance *= 2.5;

				if (MonsterFamily == "Balloon") PoisonNeedleCritChance = 200.0; // "Balloon" type enemies in Circus666/Circus2 instantly "pop" from a hit of the needle
				if (vict == "ClayDevilNew") PoisonNeedleCritChance *= 0.0625; // Clay Devils are harder to crit, but will go down for a VERY VERY LONG time if they are killed by the needle.

				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2aa - Player-Crit Dmg (\cxPOISON NEEDLE Check\c-)]\c-: \cyPoisonNeedleCritChance = %.8f\c-)", PoisonNeedleCritChance);
				if (frandom(0.1,100.0) <= PoisonNeedleCritChance) { if (playpawn.CountInv("DealCriticalHit") <= 0) playpawn.A_SetInventory("DealCriticalHit",1); }
			}
			// Dashing Detection
			if (mod == 'Dashing') // Dashing Cannot Crit, but it ignores damagefactors/protection/armor, and doesn't thrust enemies around.
			{ 
				CritResistChance = 200.0;
				flags |= DMG_THRUSTLESS; 
				flags |= DMG_PLAYERATTACK; 
				flags |= DMG_NO_ARMOR; 
				flags |= DMG_NO_FACTOR; 
				flags |= DMG_NO_ENHANCE; 
				flags |= DMG_NO_PROTECT; 
			}

			if (CountInv("CheatCritUltimate", AAPTR_PLAYER1)) CritResistChance = -200.0;
			double CritResistRoll = frandom(0.1,100.0);

			//****************************
			//*Dealing with Critical hits*
			//****************************
			precritdmg = damage;
			
			// Crit Damage
			if (CountInv("DealCriticalHit", AAPTR_PLAYER1) && CritResistRoll > CritResistChance)
			{
				if (CountInv("AnubisCufflinksFear", AAPTR_PLAYER1)) critdmgmulti *= 1.25;
				if (CountInv("RuinousShield", AAPTR_PLAYER1)) critdmgmulti *= 0.8;
				if (infl == "SonicNail") critdmgmulti *= frandompick(2.0,2.125,2.25,2.375,2.5);

				damage = floor(damage * critdmgmulti);
				A_SetInventory("TookCriticalHit",1);
				criticalhit = true;
				if (mod == 'PoisonNeedle') 
				{
					if (PoisonNeedleBossCheck) damage += ((self.User_MaxHP * random(1,2)) / 8); 
																else damage += (self.User_MaxHP * random(3,5));

					flags |= DMG_NO_ARMOR;
					flags |= DMG_NO_FACTOR;
					flags |= DMG_NO_PROTECT;
					if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2b - Player-Crit Dmg  (\cxPOISON NEEDLE\c-)]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \cacritdmgmulti = %3f\c-, \cacritextradmgmulti = %3f\c-)", precritdmg, damage, critdmgmulti, critextradmgmulti);
				}
				else
				{
					if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2b - Player-Crit Dmg]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \cacritdmgmulti = %3f\c-, \cacritextradmgmulti = %3f\c-)", precritdmg, damage, critdmgmulti, critextradmgmulti);
				}
			}

			// Healing from Punching/Kicking Practice Targets ala SW
			if (MonsterFamily == "PracticeTarget")
			{
				if ((mod == 'Fist' || mod == 'Kick' || mod == 'Gauntlets'))
				{
					if (!(flags & DMG_EXPLOSION))
					{
						double multfactorHP = 1.0;
						double multfactorStam = 1.0;
						int randbonusincreaseHP = random(5,6) * frandom(3.75,5.25) * frandom(0.5,1.5);
						int randbonusincreaseStam = random(6,7) * frandom(3.75,5.25) * frandom(0.5,1.5);
						if (mod == 'Fist' && infl == "UppercutPuff")
						{
							multfactorHP *= frandompick(1.5,1.75);
							multfactorStam *= frandompick(1.5,1.75);
						}
						if (mod == 'Kick')
						{
							multfactorHP *= frandompick(1.334,1.667);
							multfactorStam *= frandompick(1.334,1.667);
						}
						if (mod == 'Gauntlets')
						{
							multfactorHP *= frandompick(2.25,2.625);
							multfactorStam *= frandompick(2.25,2.625);
						}
						randbonusincreaseHP *= multfactorHP;
						randbonusincreaseStam *= multfactorStam;
						if (criticalhit)
						{
							randbonusincreaseHP *= critdmgmulti;
							randbonusincreaseStam *= critdmgmulti;
						}
						if (dvdsdebug_regenpenaltydisplay) Console.Printf("HPBonusTimeAdd: %d", randbonusincreaseHP);
						CallACS("MiscVarSetDECORATE",92,randbonusincreaseHP,1); // HPRegenBonPenTimer
						if (dvdsdebug_regenpenaltydisplay) Console.Printf("StamBonusTimeAdd: %d", randbonusincreaseStam);
						CallACS("MiscVarSetDECORATE",94,randbonusincreaseStam,1); // StamRegenBonPenTimer
						int prehealth = playpawn.player.mo.health;
						int phealmax = playpawn.truehealthmax;
						if ((prehealth < phealmax) && random(1,16) <= random(7,9))
						{
							int targhealamt = (randompick(1,1,1,1,1,1,1,1,1,1,1,2) * critdmgmulti * multfactorHP);
							prehealth += targhealamt;
							if ((dvds_showdamagemessages & 1) && targhealamt > 0) A_PrintHealingMessage(playpawn, targhealamt);
							//Console.Printf("prehealth: %d, phealmax: %d, targhealamt: %d", prehealth, phealmax, targhealamt);
							if (prehealth > phealmax) prehealth = phealmax;
							playpawn.player.mo.health = playpawn.player.health = prehealth;
						}
					}
				}
			}
			
			// Attacks/Etc That Have More/Less Effect on Legendaries
			preldldmg = damage;
			ldldmgmulti = 1.0;
			if (user_legendaryevolved)
			{
				if (infl == "SonicNail") ldldmgmulti = 1.25;
				if (infl == "UnmakerLaser" || infl == "UnmakerLaserCrisis") ldldmgmulti = frandompick(1.375,1.5,1.625);
				if (ldldmgmulti >= 1.0000) damage = floor(damage * ldldmgmulti);
															else damage = ceil(damage * ldldmgmulti);
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2c - Player-LDL Other Dmg]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \caldldmgmulti = %3f\c-)", preldldmg, damage, ldldmgmulti);
			}
			
			// "Villain Killer" Perk [for extra damage specifically against Legendaries]
			preldldmg = damage;
			ldldmgmulti = 1.0;
			double ldlbasemod = 1.0;
			if (user_legendaryevolved)
			{
				if (bBOSS) ldlbasemod = frandom(0.15,0.20);
							else ldlbasemod = frandom(0.30,0.40);

				// DamageType Modifiers
				if (mod == 'Sceptre') ldlbasemod *= 1.5;
				if (mod == 'Gauntlets') ldlbasemod *= 1.25;
				if (mod == 'Melee' || mod == 'Trample' || mod == 'Stomp' || mod == 'Fist' || mod == 'Kick' || mod == 'Chainsaw') ldlbasemod *= 1.125;

				ldldmgmulti += (ldlbasemod * VillainKillerPerkLvl);
				ldldmgmulti += ((ldlbasemod * 2.5) * VillainKillerEXPerkLvl);
				if (ldldmgmulti >= 1.0000) damage = floor(damage * ldldmgmulti);
															else damage = ceil(damage * ldldmgmulti);
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2d - Player-LDLPerk Dmg]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \caldldmgmulti = %3f\c-)", preldldmg, damage, ldldmgmulti);
			}
			if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2x - Player Dmg]\c-: \cxprefdmg = %d\c-, \cxprefrienddmg = %d\c-, \cxprecritdmg = %d\c-, \cxpreldldmg = %d\c-, \cydmg = %d\c-, \cbCritResist: (%.8f) / %.8f\c-)", preplayerdmg, prefriendlydmg, precritdmg, preldldmg, damage, CritResistRoll, CritResistChance);

			if (vict == "Sauravatar" && mod == 'Gauntlets')
			{
				predamage = damage;
				damage = floor(damage + ((user_MaxHP) * frandom(0.003125,0.009375)));
				if (dvdsdebug_actordmgdisplays) Console.Printf("[Sauravatar Gauntlet Damage] - %d (%d)", damage, predamage);
			}
		}
		else
		if (DVDSActor && damage > 0 && dvds_monstercrits != 0)
		{
			// Dealing with Critical hits from other Monsters
			precritdmg = damage;
			string AilmentProjClass;
			string ailmentprojfastClass;
			if (ailmentproj) AilmentProjClass = ailmentproj.GetClassName();
			if (ailmentprojfast) ailmentprojfastClass = ailmentprojfast.GetClassName();
			string ActorClass;
			ActorClass = DVDSActor.GetClassName();
			int meleeattack = 0;
			if (dvds_monstercrits != 0)
			{
				[CritChance, meleeattack] = A_CalcCritChance(inflictor,source,damage,mod,flags,angle);

				// Final Crit Roll
				CritRoll = random(1,512);
				if (CritRoll <= CritChance && DVDSActor.health > 0 && !isFrozen() && dvds_monstercrits != 0) criticalhit = 1;
				if (criticalhit > 0 && (inflictor == null && source == null)) criticalhit = 0;
				if (dvdsdebug_actordmgdisplays && dvds_monstercrits != 0) Console.Printf("    (\czActor Defensive Input [Monster Crit Rate]\c-: %d / 512 (%d) \c-, \cyActorClass: = %s\c-)", CritRoll, CritChance, ActorClass);

				double CritResistRoll = frandom(0.1,100.0);
				if (criticalhit && CritResistRoll <= CritResistChance) 
				{
					criticalhit = 0;
					if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2b - Monster-Crit]\c-: \cxRESISTED\c-, \cbCritResist: (%.8f) / %.8f\c-)", CritResistRoll, CritResistChance);
				}
				
				if (criticalhit) 
				{
					damage = floor(damage * critdmgmulti);
					A_SetInventory("TookCriticalHit",1);
					if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 2b - Monster-Crit Dmg]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \cacritdmgmulti = %3f\c-, \cacritextradmgmulti = %3f\c-, \cbCritResist: (%.8f) / %.8f\c-)", precritdmg, damage, critdmgmulti, critextradmgmulti, CritResistRoll, CritResistChance);
				}
			}
		}

		int predmginr = damage;
		// (Partial) Defense Ignoring Attacks
		double basedmgfactor = DamageFactor;

		double HubBubRand = frandompick(0.45,0.475,0.5,0.525,0.55);
		double RailRandom = frandompick(0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.33,0.33,0.33,0.33,0.33,0.33,0.33,0.33,0.50,0.50,0.50,0.50,0.75,0.75,0.9875);
		double ActorDefenseIgnoreFactor = 0.00;
		double dfperkfactor = 0.00;
		if (inflictor == null && source == null) 
		{
			// BLASTED Impact Damage
			if (wasblastedimpact) ActorDefenseIgnoreFactor += (frandom(0.45,0.55) * (1.00 - ActorDefenseIgnoreFactor));
		}
		else
		{
			// Hellcore
			if (IsHellCoreAttack != 0) 
			{
				ActorDefenseIgnoreFactor += ((frandom(0.225,0.275) + (SoulMasteryPerkLevel * frandom(0.0225,0.0275)) + (SoulMasteryEXPerkLevel * frandom(0.05625,0.06875))) * (1.00 - ActorDefenseIgnoreFactor));
			}

			// Sigil
			if (mod == 'Sigil' || mod == 'SpectralLow') 
			{
				ActorDefenseIgnoreFactor += (frandompick(0.125,0.25,0.375) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Eldritch
			if (mod == 'Eldritch' || mod == 'Deadlight')
			{
				ActorDefenseIgnoreFactor += (0.75 * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Melee
			if (mod == 'Melee' || mod == 'Trample' || mod == 'Stomp' || mod == 'Fist' || mod == 'Kick' || mod == 'Chainsaw' || mod == 'Gauntlets')
			{
				if (playpawn)
				{
					if (mod == 'Chainsaw')
					{
						dfperkfactor += ((BerserkerFit * 0.025) + (BerserkerFitEX * 0.0625));
						dfperkfactor += ((MartialArtsMastery * 0.025) + (MartialArtsMasteryEX * 0.0625));
						ActorDefenseIgnoreFactor += (((random(10,25) * 0.01) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
					}
					else
					{
						dfperkfactor += ((BerserkerFit * 0.01) + (BerserkerFitEX * 0.025));
						dfperkfactor += ((MartialArtsMastery * 0.01) + (MartialArtsMasteryEX * 0.025));
						ActorDefenseIgnoreFactor += (((random(0,10) * 0.01) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
					}
				}
			}
			// BFG Ignores roughly half of "normal" damagefactor
			if (mod == 'BFG' || mod == 'BFGSpray' || mod == 'BFGSplash') 
			{ 
				if (playpawn)
				{
					dfperkfactor += ((PlasmaAccuracyPerkLevel * 0.01) + (PlasmaAccuracyEXPerkLevel * 0.025));
					dfperkfactor += ((BFGAttunementPerkLevel * 0.025) + (BFGAttunementEXPerkLevel * 0.0625));
				}
				ActorDefenseIgnoreFactor += ((frandom(0.45,0.55) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Plasma Ignores 1/4th of "normal" damagefactor
			if (mod == 'Plasma') 
			{ 
				if (playpawn)
				{
					dfperkfactor += ((PlasmaAccuracyPerkLevel * 0.01) + (PlasmaAccuracyEXPerkLevel * 0.025));
				}
				ActorDefenseIgnoreFactor += ((frandom(0.225,0.275) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Railguns
			if (infl == "DBTRailPuff") 
			{ 
				if (playpawn)
				{
					dfperkfactor += ((PlasmaAccuracyPerkLevel * 0.01) + (PlasmaAccuracyEXPerkLevel * 0.025));
				}
				ActorDefenseIgnoreFactor += ((RailRandom + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Hubble Bubbles
			if (infl == "HubbleBubbleSmall" || infl == "HubbleBubbleLarge") 
			{
				if (playpawn)
				{
					dfperkfactor += ((MagiUpPerkLvl * 0.025) + (MagiUpExPerkLvl * 0.0625));
					dfperkfactor += ((WandMastPerkLvl * 0.05) + (WandMastEXPerkLvl * 0.125));
				}
				ActorDefenseIgnoreFactor += ((HubBubRand + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
				
				if (CountInv("HubbleBubbleSpeedPenalty1") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty1",1);
				else
				{
					if (CountInv("HubbleBubbleSpeedPenalty1b") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty1b",1);
				}
				if (random(1,3) == 1) 
				{
					if (CountInv("HubbleBubbleSpeedPenalty2") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty2",1);
					else
					{
						if (CountInv("HubbleBubbleSpeedPenalty2b") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty2b",1);
					}
				}
				if (random(1,9) == 1) 
				{
					if (CountInv("HubbleBubbleSpeedPenalty3") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty3",1);
					else
					{
						if (CountInv("HubbleBubbleSpeedPenalty3b") < 1) A_GiveInventory("HubbleBubbleSpeedPenalty3b",1);
					}
				}
			}
			// Bullet/Pellet
			if (mod == 'Bullet') 
			{ 
				if (playpawn)
				{
					dfperkfactor += ((BulletAccuracyPerkLevel * 0.01) + (PelletAccuracyPerkLevel * 0.02) + (BulletAccuracyEXPerkLevel * 0.025) + (PelletAccuracyEXPerkLevel * 0.05));
				}
				ActorDefenseIgnoreFactor += ((frandom(0.1125,0.1375) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			
			// Sceptre
			if (mod == 'Sceptre') 
			{ 
				double temp = (0.5 + (random(0,5) * 0.02));
				double temp2 = (((0.30 + (random(0,5) * 0.02)) / 16) * SceptreActualLevel);
				ActorDefenseIgnoreFactor += ((temp + temp2) * (1.00 - ActorDefenseIgnoreFactor));
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("\cz[Sceptre Defense Ignoring]\c-: \caDefenseIgnoreFactor = %.8f\c-, \catemp1+2 = %.8f", ActorDefenseIgnoreFactor, (temp+temp2));
			}
			// Diaris Arrows
			if (infl == 'DiarisHolyArrow' || infl == 'DiarisHolyArrow2xDmg' || infl == 'DiarisHolyArrow3xDmg' || 
			    infl == 'DiarisHolyArrowGlitter1' || infl == 'DiarisHolyArrowGlitter2' || infl == 'DiarisHolyArrowGlitter3') 
			{ 
				ActorDefenseIgnoreFactor += ((0.5 + (random(-10,10) * 0.01)) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Poison Needle
			if (mod == 'PoisonNeedle') 
			{ 
				if (playpawn)
				{
					dfperkfactor += ((MartialArtsMastery * 0.01) + (MartialArtsMasteryEX * 0.025));
				}
				ActorDefenseIgnoreFactor += ((0.625 + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Poison Clouds
			if ((mod == "PoisonElemental" || mod == "Poison") && 
					(infl == "MinorPoisonCloud" || infl == "NormalPoisonCloud" || infl == "MajorPoisonCloud" ||
					 infl == "HexenPoisonCloud1" || infl == "HexenPoisonCloud2Source" || infl == "HexenPoisonCloud2Outer" || infl == "HexenPoisonCloud3Source" || infl == "HexenPoisonCloud3Outer"))
			{
				if (playpawn)
				{
					dfperkfactor += ((MagiUpPerkLvl * 0.01) + (MagiUpExPerkLvl * 0.025));
					dfperkfactor += ((WandMastPerkLvl * 0.02) + (WandMastEXPerkLvl * 0.05));
				}
				ActorDefenseIgnoreFactor += ((frandompick(0.20,0.225,0.25,0.275,0.30) - dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
				
				if (CountInv("PoisonCloudSpeedPenalty1") < 1) A_GiveInventory("PoisonCloudSpeedPenalty1",1);
				else
				{
					if (CountInv("PoisonCloudSpeedPenalty1b") < 1) A_GiveInventory("PoisonCloudSpeedPenalty1b",1);
				}
				if (CountInv("PoisonCloudATKPenalty1") < 1) A_GiveInventory("PoisonCloudATKPenalty1",1);
				else
				{
					if (CountInv("PoisonCloudATKPenalty1b") < 1) A_GiveInventory("PoisonCloudATKPenalty1b",1);
				}
				if (CountInv("PoisonCloudDEFPenalty1") < 1) A_GiveInventory("PoisonCloudDEFPenalty1",1);
				else
				{
					if (CountInv("PoisonCloudDEFPenalty1b") < 1) A_GiveInventory("PoisonCloudDEFPenalty1b",1);
				}

				if (random(1,5) == 1) 
				{
					if (CountInv("PoisonCloudSpeedPenalty2") < 1) A_GiveInventory("PoisonCloudSpeedPenalty2",1);
					else
					{
						if (CountInv("PoisonCloudSpeedPenalty2b") < 1) A_GiveInventory("PoisonCloudSpeedPenalty2b",1);
					}
					if (CountInv("PoisonCloudATKPenalty2") < 1) A_GiveInventory("PoisonCloudATKPenalty2",1);
					else
					{
						if (CountInv("PoisonCloudATKPenalty2b") < 1) A_GiveInventory("PoisonCloudATKPenalty2b",1);
					}
					if (CountInv("PoisonCloudDEFPenalty2") < 1) A_GiveInventory("PoisonCloudDEFPenalty2",1);
					else
					{
						if (CountInv("PoisonCloudDEFPenalty2b") < 1) A_GiveInventory("PoisonCloudDEFPenalty2b",1);
					}
				}
				if (random(1,25) == 1) 
				{
					if (CountInv("PoisonCloudSpeedPenalty3") < 1) A_GiveInventory("PoisonCloudSpeedPenalty3",1);
					else
					{
						if (CountInv("PoisonCloudSpeedPenalty3b") < 1) A_GiveInventory("PoisonCloudSpeedPenalty3b",1);
					}
					if (CountInv("PoisonCloudATKPenalty3") < 1) A_GiveInventory("PoisonCloudATKPenalty3",1);
					else
					{
						if (CountInv("PoisonCloudATKPenalty3b") < 1) A_GiveInventory("PoisonCloudATKPenalty3b",1);
					}
					if (CountInv("PoisonCloudDEFPenalty3") < 1) A_GiveInventory("PoisonCloudDEFPenalty3",1);
					else
					{
						if (CountInv("PoisonCloudDEFPenalty3b") < 1) A_GiveInventory("PoisonCloudDEFPenalty3b",1);
					}
				}
			}
			if (mod == 'Drowning') 
			{
				ActorDefenseIgnoreFactor += (1.00 * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Suicide Bombers/Kamikaze Enemy Attacks/RockBomb Shards
			if (infl == "RockBombShardProj" || infl == "SuicideBomber" || infl == "SuicideBomb" || infl == "SuicideBombStrong" || infl == "SuicideBombUltra" || infl == "HSBoom" || infl == "HadesSphere" || infl == "HSOverlord" || mod == 'Explosive' || flags & DMG_EXPLOSION) 
			{
				if (playpawn)
				{
					dfperkfactor += ((DemolitionsExpertPerkLevel * 0.01) + (DemolitionsExpertEXPerkLevel * 0.025));
				}
				if (infl == "RockBombShardProj" || infl == "RockBombShardProjT") ActorDefenseIgnoreFactor += ((frandompick(0.50,0.5334,0.60) + (dfperkfactor * 0.5)) * (1.00 - ActorDefenseIgnoreFactor));
																		else ActorDefenseIgnoreFactor += ((frandompick(0.625,0.6667,0.75) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Chill Touch
			if (infl == "ChillTouch") 
			{
				if (playpawn)
				{
					dfperkfactor += ((MagiUpPerkLvl * 0.02) + (MagiUpExPerkLvl * 0.05));
					dfperkfactor += ((WandMastPerkLvl * 0.01) + (WandMastEXPerkLvl * 0.025));
				}
				ActorDefenseIgnoreFactor += ((0.5 + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Fire Breath
			if (infl == "DemonFire" || infl == "DemonFireCrisis" || 
					infl == "MiniFirePuff" || infl == "MiniFirePuffCrisis" || 
					infl == "DogFireNew" || infl == "DogFireNewCrisis" ||
					infl == "FireBreath" || infl == "FireBreathCrisis" ||
					infl == "SGuardianFlameBreath" || infl == "SGuardianFlameBreathCrisis" ||
					infl == "Demon5Jet" || infl == "Demon5JetCrisis")
			{
				ActorDefenseIgnoreFactor += (0.75 * (1.00 - ActorDefenseIgnoreFactor));
			}
			if (infl == "SonicNail")
			{
				ActorDefenseIgnoreFactor += (frandompick(0.25,0.3125,0.375,0.4325,0.50) * (1.00 - ActorDefenseIgnoreFactor));
			}
			if (infl == "UnmakerLaser" || infl == "UnmakerLaserCrisis")
			{
				if (playpawn)
				{
					dfperkfactor += ((MagiUpPerkLvl * 0.02) + (MagiUpExPerkLvl * 0.05));
					dfperkfactor += ((WandMastPerkLvl * 0.02) + (WandMastEXPerkLvl * 0.05));
					if (CharacterClass != 2 && CountInv("UnmakerAmmoType",AAPTR_PLAYER1) == 1) dfperkfactor += ((PlasmaAccuracyPerkLevel * 0.02) + (PlasmaAccuracyEXPerkLevel * 0.05));
					if (CharacterClass == 2 && CountInv("UnmakerAmmoType",AAPTR_PLAYER1) == 1) dfperkfactor += ((SoulMasteryPerkLevel * 0.02) + (SoulMasteryEXPerkLevel * 0.05));
				}
				ActorDefenseIgnoreFactor += ((frandompick(0.25,0.3125,0.375) + dfperkfactor) * (1.00 - ActorDefenseIgnoreFactor));
			}
			
			// Misc
			if (playpawn && (playpawn.player.cheats & CF_FRIGHTENING || playpawn.bFRIGHTENING))
			{ 
				ActorDefenseIgnoreFactor += (0.25 * (1.00 - ActorDefenseIgnoreFactor));
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP ? - Fright Check]: YES\c-)");
			}
			if (playpawn && PlayerTensionLevel)
			{
				double tensionignore; 
				if (PlayerTensionLevel == 1) tensionignore = 0.01; // 5
				if (PlayerTensionLevel == 2) tensionignore = 0.03; // 20
				if (PlayerTensionLevel == 3) tensionignore = 0.06; // 50
				if (PlayerTensionLevel == 4) tensionignore = 0.15; // 100
				if (PlayerTensionLevel == 5) tensionignore = 0.27; // 250
				if (PlayerTensionLevel == 6) tensionignore = 0.48; // 500
				if (PlayerTensionLevel == 7) tensionignore = 0.66; // 1000
				int randcall = random(1,32);
				if (randcall <= 1) tensionignore *= 4;
				if (randcall == 2 || randcall == 3) tensionignore *= 2;
				if (tensionignore > 1.00) tensionignore = 1.00;
				double tempv1 = (1.0 - ActorDefenseIgnoreFactor) * tensionignore;

				ActorDefenseIgnoreFactor += (tempv1 * (1.00 - ActorDefenseIgnoreFactor));
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP ? - Tension Check]: YES (%.4f) \c-)", tempv1);
			}
			// Legendaries
			if (DVDSActor && DVDSActor.user_legendaryevolved) 
			{ 
				ActorDefenseIgnoreFactor += (0.50 * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Player Buff Checks
			if (playpawn)
			{
				double temp = (0.025 * random(0,5));
				if (CallACS("GetBuffTimer",10) > 0) temp *= 1;
				if (CallACS("GetBuffTimer",13) > 0) temp -= 1;
				ActorDefenseIgnoreFactor += (temp * (1.00 - ActorDefenseIgnoreFactor));
			}
			// Target itself is a Legendary
			if (user_legendaryevolved)
			{
				if (ActorDefenseIgnoreFactor > 0.00) ActorDefenseIgnoreFactor /= random(2,6);
			}
		}

		//**********************************************************************
		//*This ignores damage factors [similar to how DQ crits ignore defense]*
		//**********************************************************************
		if (CallACS("GetBuffTimer",7) > 0) ActorDefenseIgnoreFactor *= 1.25;
		if (CallACS("GetBuffTimer",10) > 0) ActorDefenseIgnoreFactor *= 1.05;
		if (CallACS("GetBuffTimer",13) > 0) ActorDefenseIgnoreFactor *= 0.9524;
		if (ActorDefenseIgnoreFactor > 1.00) ActorDefenseIgnoreFactor = 1.00;

		prevDamageFactor = DamageFactor;
		if (DamageFactor < 1.00) 
		{
			if (criticalhit) ActorDefenseIgnoreFactor = 1.00;
			DamageFactor += ((1.00 - DamageFactor) * ActorDefenseIgnoreFactor); 
		}
		if (dvdsdebug_actordmgdisplays && damage > 0) 
		{
			if (ActorDefenseIgnoreFactor > 0.00) Console.Printf("    (\czActor Defensive Input [STEP 3a - Def Ignoring]\c-: \caDefenseIgnoreFactor = %.8f\c-, \cadmgfactor = %.8f\c-, \caprevdmgfactor = %.8f\c-, \cypredmg = %d\c-, \cydmg = %d\c- (Monster Actor))", ActorDefenseIgnoreFactor, DamageFactor, prevDamageFactor, predmginr, damage);
																			else Console.Printf("    (\czActor Defensive Input [STEP 3a - Def Ignoring]\c-: \caSKIPPED\c-, \cydmg = %d\c-)", predmginr);
		}

		int predirdmg = damage;
		prevDamageFactor = DamageFactor;
		// If the Attack was Deflected by the Player
		if (UniqueProjectile && UniqueProjectile.REFLECTEDMONSTERPROJ)
		{
			predirdmg = damage;
			if (CountInv("FalconKnifeEarrings", AAPTR_PLAYER1)) 
			{
				if (dvds_fke_effecttype == 0) damage = floor(damage * 1.25);
				if (dvds_fke_effecttype == 1) damage = floor(damage * 1.5);
				if (dvds_fke_effecttype == 2) damage = floor(damage * 2); // Classic Earring Damage Buff
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 3b - Player-Deflection Pre-Check [Earrings]\c-: \cypredmg = %d\c- / \cydmg = %d\c-)", predirdmg, damage);
			}
			if (CallACS("GetBuffTimer",7))
			{
				damage = floor(damage * 4);
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 3c - Player-Deflection Pre-Check [DivAvatar]\c-: \cypredmg = %d\c- / \cydmg = %d\c-)", predirdmg, damage);
			}
			if (CallACS("GetBuffTimer",10))
			{
				damage = floor(damage * 2);
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 3d - Player-Deflection Pre-Check [Oomph]\c-: \cypredmg = %d\c- / \cydmg = %d\c-)", predirdmg, damage);
			}
			if (CallACS("GetBuffTimer",13))
			{
				damage = ceil(damage * 0.5);
				if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 3d - Player-Deflection Pre-Check [Blunt]\c-: \cypredmg = %d\c- / \cydmg = %d\c-)", predirdmg, damage);
			}

			double randomdmgmax = 1.50 + (random(0,50) * 0.01);
			if (DamageFactor < randomdmgmax) DamageFactor += ((randomdmgmax - DamageFactor) * frandompick(0.75,0.875,1.00,1.125,1.25));
			if (DamageFactor >= randomdmgmax) DamageFactor = randomdmgmax;
			if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP 3d - Player-Deflection Checking]\c-: \caDamageFactor = %.8f\c-, \caprevDamageFactor = %.8f\c-, \carandomdmgmax = %.8f, \cypredmg = %d\c- / \cydmg = %d\c-)", DamageFactor, prevDamageFactor, randomdmgmax, predirdmg, damage);
		}

		predirdmg = damage;
		if ((playpawn && (playpawn.player.cheats & CF_FRIGHTENING || playpawn.bFRIGHTENING)) && (bFRIGHTENED && !bFRIENDLY))
		{
			damage = floor(damage * frandom(1.20,1.25));
			if (dvdsdebug_actordmgdisplays && damage > 0) Console.Printf("    (\czActor Defensive Input [STEP ?? - Fright Check]\c-: \cypredmg = %d\c- / \cydmg = %d\c-)", predirdmg, damage);
		}


		predirdmg = damage;
		damage = A_DamageMobCheckShielding(inflictor, source, damage, mod, flags, angle);
		// Direct Damage Changes
		if (infl == "DemonFire" || infl == "DemonFireCrisis" || 
				infl == "MiniFirePuff" || infl == "MiniFirePuffCrisis" || 
				infl == "DogFireNew" || infl == "DogFireNewCrisis" ||
				infl == "FireBreath" || infl == "FireBreathCrisis" ||
				infl == "SGuardianFlameBreath" || infl == "SGuardianFlameBreathCrisis" ||
				infl == "Demon5Jet" || infl == "Demon5JetCrisis")
		{
			damage = floor(damage * 1.125);
		}
		if (dvdsdebug_actordmgdisplays && damage > 0) 
		{
			if (DamageFactor != basedmgfactor) Console.Printf("    (\czActor Defensive Input [STEP 4 - Direct Dmg Changes]:\c- \cypredmg = %d\c-, \cydmg = %d\c-)", predirdmg, damage);
																		else Console.Printf("    (\czActor Defensive Input [STEP 4 - Direct Dmg Changes]:\c- \caSKIPPED\c-, \cydmg = %d\c-)", predirdmg);
		}
		
		// BLASTED Impact Damage
		if (wasblastedimpact)
		{
		}
		
		predirdmg = damage;
		double cheatnpcdmgtaken;
		cheatnpcdmgtaken = dvds_cheatnpcdmgtaken * 0.01;
		if (cheatnpcdmgtaken < 0.01) cheatnpcdmgtaken = 0.01;
		
		bool isakamikaze = false;
		if (mod == 'Massacre' || mod == 'SilentMassacre') { }
		else
		{
			if (GetClassName() == "SuicideBomber" && mod == 'None') isakamikaze = true;
			if (GetClassName() == "HadesSphere" && mod == 'None') isakamikaze = true;
			if (GetClassName() == "HSOverlord" && mod == 'None') isakamikaze = true;
			if (isakamikaze)
			{ 
				damage += (health + (SpawnHealth() * frandompick(3.0,3.5,4.0,4.5,5.0)));
				if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP C1 - Direct Dmg Changes (Kamikaze)]:\c- \cypredmg = %d\c-, \cydmg = %d\c-)", predirdmg, damage);
			}
			else
			{
				if (cheatnpcdmgtaken != 1.0)
				{
					if (damage > 0)
					{
						if (random(0,1) == 0) damage = floor(damage * cheatnpcdmgtaken);
														 else damage = ceil(damage * cheatnpcdmgtaken);
						if (damage < 1) damage = 1;
						if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP C1 - Direct Dmg Changes]:\c- \cypredmg = %d\c-, \cydmg = %d\c-, \cxcheatnpcdmgtaken = %2f)", predirdmg, damage, cheatnpcdmgtaken);
					}
				}
			}
		}

		double nrmldmgfctr = DamageFactor;
		// Space for rent :V
		//************************************************************************
		let ret = super.DamageMobj(inflictor, source, damage, mod, flags, angle);
		//************************************************************************
		if (mod == 'PoisonNeedle' && ret < 1) 
		{
			ret = randompick(1,1,1,1,2);
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czPOison Needle Low-Clamp: %d)", ret);
		}
		

		
		A_DamageMobPostReturn1(inflictor, source, damage, mod, flags, angle, 
													 ret, oldhealth, nrmldmgfctr, vict, sour, infl, basedmgfactor, drainmaxdmg, playweaksound, criticalhit, firstdamage, wasblastedimpact);
		
		return ret;
	}
	
	Actor, Actor, int, Name, int, double A_DamageMobPreReturn1(Actor inflictor, Actor source, int damage, Name mod, int flags, double angle)
	{
		AetheriusPlayerPawn playpawn;
		AetheriusMonsterZSC DVDSActor;
		AetheriusMonsterZSC DVDSVictim;
		AetheriusProjectileZSC UniqueProjectile;
		AetheriusFastProjectileZSC UniqueProjectileFast;
		AetheriusEffectProjectile ailmentproj;
		AetheriusEffectFastProjectile ailmentprojfast;
		SingleDamageRipper singleripproj;
		SingleDamageFastRipper singlefastripproj;
		if (source) 
		{
			playpawn = AetheriusPlayerPawn(source);
			if (dvdsdebug_actordmgdisplays && playpawn) Console.Printf("Playpawn (source) Found!");
			DVDSActor = AetheriusMonsterZSC(source);
			if (dvdsdebug_actordmgdisplays && DVDSActor) Console.Printf("DVDSActor (source) Found!");
		}
		if (inflictor)
		{
			UniqueProjectile = AetheriusProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectile) Console.Printf("UniqueProjectile (inflictor) Found!");
			UniqueProjectileFast = AetheriusFastProjectileZSC(inflictor);
			if (dvdsdebug_actordmgdisplays && UniqueProjectileFast) Console.Printf("UniqueProjectileFast (inflictor) Found!");
			ailmentproj = AetheriusEffectProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentproj) Console.Printf("ailmentproj (inflictor) Found!");
			ailmentprojfast = AetheriusEffectFastProjectile(inflictor);
			if (dvdsdebug_actordmgdisplays && ailmentprojfast) Console.Printf("ailmentprojfast (inflictor) Found!");
			singleripproj = SingleDamageRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singleripproj) Console.Printf("singleripproj (inflictor) Found!");
			singlefastripproj = SingleDamageFastRipper(inflictor);
			if (dvdsdebug_actordmgdisplays && singlefastripproj) Console.Printf("singlefastripproj (inflictor) Found!");
		}
		string infl, sour, vict;
		vict = GetClassName();
		if (inflictor != null) lastattackeratk = inflictor;
		if (inflictor == null) infl = "NONE"; else infl = inflictor.GetClassName();
		if (source != null) lastattacker = source;
		if (source == null) sour = "NONE"; else sour = source.GetClassName();
		int olddmg;

		// Moved Code starts here.
		if (UniqueProjectile && UniqueProjectile.IsACrisisAttack)
		{
			olddmg = damage;
			damage = floor(damage * dvds_monstercrisismulti);
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP 1a1 - Crisis Projectile Check [%s]]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \czdmgmulti: %.8f\c-)", sour, olddmg, damage, dvds_monstercrisismulti);
			UniqueProjectile.IsACrisisAttack = false;
		}

		olddmg = damage;
		double buffdamagemulti = 1.0;
		// Checks Buffs on Monsters based on their Health Levels
		if (health <= user_HPBuffRange)
		{
					 if (vict == "Nyarlathotep") buffdamagemulti = 0.375;
			else if (vict == "DSparilUnmountedNew" || vict == "KoraxNew" || vict == "PennywiseBoss" ||
							 vict == "EntityBossNew" || vict == "EntitySecondNew" || vict == "EntityAscended" || 
							 vict == "ThamuzNew" || vict == "TchernobogNew" ||
							 vict == "Magmantis" || vict == "NyarlathotepLesser" || vict == "StarSpawn" || vict == "SpiderGod" || vict == "SpiderGodling") buffdamagemulti = 0.625;
			else if (vict == "AlienSpectre1New" || vict == "AlienSpectre2New" || vict == "AlienSpectre3New" || 
							 vict == "AlienSpectre4New" || vict == "AlienSpectre5New" ||
							 vict == "DSCyberdemon" || vict == "FCyberdemon" || vict == "Annihilator" || vict == "FAnnihilator" ||
							 vict == "DSSpiderMastermind" || vict == "FSpiderMastermind" || vict == "Demolisher" || vict == "FDemolisher") buffdamagemulti = 0.75;
			else if (vict == "PyroDemon" || vict == "FPyroDemon" || 
							 vict == "FlyingBalrog" || vict == "Hierophant") buffdamagemulti = 0.8;
			else if (vict == "ArchonOfHell" || vict == "FArchonOfHell" ||
							 vict == "Cybruiser" || vict == "FCybruiser" ||
							 vict == "BruiserDemon" || vict == "FBruiserDemon") buffdamagemulti = 0.85;
			else if (vict == "Belphegor" || vict == "FBelphegor" ||
							 vict == "HadesElemental" || vict == "HadesOverlord") buffdamagemulti = 0.9;
			else if (vict == "Diabloist" || vict == "FDiabloist" ||
							 vict == "Abaddon" || vict == "FAbaddon") buffdamagemulti = 0.95;
			else if (vict == "DSArchvile" || vict == "FArchvile" ||
							 vict == "DSBaronOfHell" || vict == "FBaronOfHell" ||
							 vict == "DSHellKnight" || vict == "FHellKnight" ||
							 vict == "HellWarrior" || vict == "FHellWarrior")  buffdamagemulti = 0.975;
			else buffdamagemulti = 0.9875;

			if (health <= user_HPLowBuffRange) buffdamagemulti *= 0.875;
			if (user_legendaryevolved) buffdamagemulti *= frandom(0.925,0.975);
			damage = ceil(damage * buffdamagemulti);
			if (damage < 1) damage = 1;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP 1a2 - Attacker Monster Buffs/Debuffs [%s]]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \czdmgmulti: %.8f\c-)", sour, olddmg, damage, buffdamagemulti);
		}
		buffdamagemulti = 1.0;
		if (DVDSActor && DVDSActor.health <= DVDSActor.user_HPBuffRange)
		{
					 if (vict == "Nyarlathotep") buffdamagemulti = 2.875;
			else if (sour == "DSparilUnmountedNew" || sour == "KoraxNew" || sour == "PennywiseBoss" ||
							 sour == "EntityBossNew" || sour == "EntitySecondNew" || sour == "EntityAscended" || 
							 sour == "ThamuzNew" || sour == "TchernobogNew" ||
							 sour == "Magmantis" || vict == "NyarlathotepLesser" || vict == "StarSpawn" || vict == "SpiderGod" || vict == "SpiderGodling") buffdamagemulti = 1.75;
			else if (sour == "AlienSpectre1New" || sour == "AlienSpectre2New" || sour == "AlienSpectre3New" || 
							 sour == "AlienSpectre4New" || sour == "AlienSpectre5New" ||
							 sour == "DSCyberdemon" || sour == "FCyberdemon" || sour == "Annihilator" || sour == "FAnnihilator" ||
							 sour == "DSSpiderMastermind" || sour == "FSpiderMastermind" || sour == "Demolisher" || sour == "FDemolisher") buffdamagemulti = 1.5;
			else if (sour == "PyroDemon" || sour == "FPyroDemon" || 
							 sour == "FlyingBalrog" || sour == "Hierophant") buffdamagemulti = 1.4;
			else if (sour == "ArchonOfHell" || sour == "FArchonOfHell" ||
							 sour == "Cybruiser" || sour == "FCybruiser" ||
							 sour == "BruiserDemon" || sour == "FBruiserDemon") buffdamagemulti = 1.3;
			else if (sour == "Belphegor" || sour == "FBelphegor" ||
							 sour == "HadesElemental" || sour == "HadesOverlord") buffdamagemulti = 1.2;
			else if (sour == "Diabloist" || sour == "FDiabloist" ||
							 sour == "Abaddon" || sour == "FAbaddon") buffdamagemulti = 1.1;
			else if (sour == "DSArchvile" || sour == "FArchvile" ||
							 sour == "DSBaronOfHell" || sour == "FBaronOfHell" ||
							 sour == "DSHellKnight" || sour == "FHellKnight" ||
							 sour == "HellWarrior" || sour == "FHellWarrior")  buffdamagemulti = 1.05;
			else buffdamagemulti = 1.025;

			if (DVDSActor.health <= DVDSActor.user_HPLowBuffRange) buffdamagemulti *= 1.25;
			if (DVDSActor.user_legendaryevolved) buffdamagemulti *= frandom(1.05,1.15);
			damage = floor(damage * buffdamagemulti);
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP 1a2 - Defender Monster Buffs/Debuffs [%s]]\c-: \cxolddmg = %d\c-, \cydmg = %d\c-, \czdmgmulti: %.8f\c-)", vict, olddmg, damage, buffdamagemulti);
		}
		return inflictor, source, damage, mod, flags, angle;
	}

	int A_DamageMobPostReturn1(Actor inflictor, Actor source, int damage, Name mod, int flags, double angle, int ret, int oldhealth, double nrmldmgfctr, string vict, string sour, string infl, double basedmgfactor, int drainmaxdmg, int playweaksound, bool criticalhit, int firstdamage, int wasblastedimpact)
	{
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int clearofmindex = CallACS("MiscVarCheckDECORATE",10056);
		AetheriusPlayerPawn playpawn;
		AetheriusMonsterZSC DVDSActor;
		if (source) 
		{
			playpawn = AetheriusPlayerPawn(source);
			DVDSActor = AetheriusMonsterZSC(source);
		}
		
		// Copied from DamageMobj vvvvvv
		if (mod == 'dashing' && NORADDMG == 1 && !bNORADIUSDMG) 
		{
			bNORADIUSDMG = 1;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czActor Defensive Input [STEP ? - RESET NORADIUSDMG])");
		}
		
		int outputdmg = damage;
		if (playpawn) 
		{
			if (damage > 0) damagedbyplayer = true;
			outputdmg = playpawn.playoutputdmg;
		}
		double finaldmgfactor = 1.00;
		if (outputdmg > 0) finaldmgfactor = 1.00 * ret / outputdmg;
		if (dvdsdebug_actordmgdisplays && outputdmg > 0) 
		{
			if (wasblastedimpact && health < 1) 
			{ 
			}
			else
			{
				Console.Printf("    (\czActor Defensive Output [STEP 7 - Final Dmg]:\c- \cypredmg \c-/ \cyfinaldmg\c- = \cy%d\c- / \cy%d\c-, \cydmgdifffactor = %.8f\c-, \cxhealth = %d (%d) / %d\c-, \cynormaldamagefactor\c- = \cy%.8f\c-, \cyactualdamagefactor\c- = \cy%.8f\c-, \cwdmgtype\c- = \cw%s\c-, \cavictim\c- = \ca%s\c-, \cdinflictor\c- = \cd%s\c-, \cnsource\c- = \cn%s\c-)", 
											outputdmg, ret, finaldmgfactor,
											health, oldhealth, user_MaxHP,
											basedmgfactor, nrmldmgfctr,
											mod, vict, infl, sour);
			}
		}

		if ((dvds_showdamagemessages & 2) && ret > 0) A_PrintDamageMessage(inflictor, source, ret, mod, criticalhit, infl, sour, vict, health, firstdamage, flags);

		string weakplayedsound = "";
		if (dvds_hitweaksounds && playweaksound != 0 && hitweaksoundtimer <= 0)
		{
			hitweaksoundtimer += dvds_hitweaksounddelay;

			if (playweaksound == -3) weakplayedsound = "Misc/ResistanceHitHigh";
			if (playweaksound == -2) weakplayedsound = "Misc/ResistanceHitMid";
			if (playweaksound == -1) weakplayedsound = "Misc/ResistanceHit";
			if (playweaksound == 1) weakplayedsound = "Misc/WeaknessHit";
			if (playweaksound == 2) weakplayedsound = "Misc/WeaknessHitMid";
			if (playweaksound == 3) weakplayedsound = "Misc/WeaknessHitHigh";

			if (outputdmg > 0 && (oldhealth > 0 && oldhealth > health))
			{
				if (DVDSActor && DVDSActor.bFRIENDLY)
				{
					A_StartSound(weakplayedsound, 11, CHANF_DEFAULT, (dvds_hitweaksoundvol * frandom(0.75,1.25)), ATTN_NONE, 1.5);
				}
				else
				if (playpawn && source != null && !bFRIENDLY)
				{
					A_StartSound(weakplayedsound, 11, CHANF_DEFAULT, (dvds_hitweaksoundvol * frandom(0.75,1.25)), ATTN_NONE, 1.0);
				}
				else
				if (bFRIENDLY)
				{
					A_StartSound(weakplayedsound, 11, CHANF_DEFAULT, (dvds_hitweaksoundvol * frandom(0.75,1.25)), ATTN_NONE, 0.67);
				}
			}
		}

		string playedsound = "";
		int ComboTimerDelay = CallACS("MiscVarCheckDECORATE",162);
		int ComboTimerDelayIncrease = 0;
		// Play Q3A/QC Style "Hit" Sounds when the player hits a monster and does legit damage
		if (outputdmg > 0 && (oldhealth > 0 && oldhealth > health))
		{
			if (DVDSActor && DVDSActor.bFRIENDLY)
			{
				if (health <= 0 && dvds_q3aqckillsounds2) 
				{
					if (dvds_q3aqckillsoundtype == 0) playedsound = "misc/killsnd2";
					if (dvds_q3aqckillsoundtype == 1) playedsound = "misc/killsndDED2";
					if (dvds_q3aqckillsoundtype >= 0) A_StartSound(playedsound, 12, CHANF_DEFAULT, (dvds_q3aqckillsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				if (dvds_q3aqchitsounds2 && hitsoundtimer <= 0) 
				{
					hitsoundtimer += dvds_q3aqchitsounddelay;
					if (dvds_q3aqchitsoundtype == 0) playedsound = "misc/hit2";
					if (dvds_q3aqchitsoundtype == 1) playedsound = "misc/hitpunch2";
					if (dvds_q3aqchitsoundtype >= 0) A_StartSound(playedsound, 13, CHANF_DEFAULT, (dvds_q3aqchitsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				ComboTimerDelayIncrease = random(2,4);
			}
			else
			if (playpawn && source != null && !bFRIENDLY)
			{
				if (health <= 0 && (infl == "EvilWarriorShieldBall" || infl == "EvilWarriorShieldBallCrisis"))
				{
					CallACS("MiscVarSetDECORATE",49,1,1);
					if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czINFO:\c- \cyEvilWarriorShieldKills\c-: \cy%d\c-)", CallACS("MiscVarCheckDECORATE",49));
				}
				if (health <= 0 && dvds_q3aqckillsounds) 
				{
					if (dvds_q3aqckillsoundtype == 0) playedsound = "misc/killsnd";
					if (dvds_q3aqckillsoundtype == 1) playedsound = "misc/killsndDED";
					if (dvds_q3aqckillsoundtype >= 0) A_StartSound(playedsound, 12, CHANF_DEFAULT, (dvds_q3aqckillsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				if (dvds_q3aqchitsounds && hitsoundtimer <= 0)
				{
					hitsoundtimer += dvds_q3aqchitsounddelay;
					if (dvds_q3aqchitsoundtype == 0) playedsound = "misc/hit";
					if (dvds_q3aqchitsoundtype == 1) playedsound = "misc/hitpunch";
					if (dvds_q3aqchitsoundtype >= 0) A_StartSound(playedsound, 13, CHANF_DEFAULT, (dvds_q3aqchitsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				ComboTimerDelayIncrease = random(2,4);
			}
			else
			if (bFRIENDLY)
			{
				if (health <= 0 && dvds_q3aqckillsounds) 
				{
					if (dvds_q3aqckillsoundtype == 0) playedsound = "misc/killsndAlly";
					if (dvds_q3aqckillsoundtype == 1) playedsound = "misc/killsndDEDAlly";
					if (dvds_q3aqckillsoundtype >= 0) A_StartSound(playedsound, 12, CHANF_DEFAULT, (dvds_q3aqckillsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				if (dvds_q3aqchitsounds && hitsoundtimer <= 0)
				{
					hitsoundtimer += dvds_q3aqchitsounddelay;
					if (dvds_q3aqchitsoundtype == 0) playedsound = "misc/hitally";
					if (dvds_q3aqchitsoundtype == 1) playedsound = "misc/hitpally";
					if (dvds_q3aqchitsoundtype >= 0) A_StartSound(playedsound, 13, CHANF_DEFAULT, (dvds_q3aqchitsoundvol * frandom(0.75,1.25)), ATTN_NONE);
				}
				ComboTimerDelayIncrease = random(2,4);
			}
		}


		int EXPComboTimer = CallACS("MiscVarCheckDECORATE",157);
		if (outputdmg > 0 && ComboTimerDelayIncrease > 0 && EXPComboTimer > 0)
		{
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czINFO:\c- \cyComboTimerDelayIncrease [Base]\c-: \cy%.8f\c-)", ComboTimerDelayIncrease);
			// "Legendary" Check
			if (user_legendaryevolved) ComboTimerDelayIncrease *= 1.375; //2.5;
			// BOSS Flag Check
			if (bBOSS) ComboTimerDelayIncrease *= 1.125; //1.5;
			// STEALTH Flag Check
			if (bSTEALTH) ComboTimerDelayIncrease *= 1.125; //1.5;
			// "Cleared of Mind" Perk
			if (clearofmind == 1) ComboTimerDelayIncrease *= 1.00375; //1.015;
			if (clearofmind == 2) ComboTimerDelayIncrease *= 1.0075; //1.03;
			if (clearofmind == 3) ComboTimerDelayIncrease *= 1.015; //1.06;
			if (clearofmind == 4) ComboTimerDelayIncrease *= 1.03; //1.12;
			if (clearofmind == 5) ComboTimerDelayIncrease *= 1.06; //1.24;
			// "Higher Learning" Grand Mastery Perk
			if (CallACS("MiscVarCheckDECORATE",11001) == 1) ComboTimerDelayIncrease *= 1.0375; //1.15;
			if (CallACS("MiscVarCheckDECORATE",11001) == 2) ComboTimerDelayIncrease *= 1.075; //1.30;
			if (CallACS("GetBuffTimer",7) > 0) ComboTimerDelayIncrease *= 1.0625; //1.25; // Divine Avatar
			if (CallACS("GetBuffTimer",12) > 0) ComboTimerDelayIncrease *= 1.0625; //1.25; // Acceleratle
			if (CallACS("GetBuffTimer",15) > 0) ComboTimerDelayIncrease *= 0.95; //0.8; // Deceleratle
			double DamageRatio = 1.0;
			int ClampCheck = ret;
			if (ClampCheck > oldhealth) ClampCheck = oldhealth;
			if (User_MaxHP > 0)
			{
				if (outputdmg > 0) DamageRatio = (1.00 * ClampCheck) / User_MaxHP;
			}
			else
			{
				if (outputdmg > 0) DamageRatio = (1.00 * ClampCheck) / SpawnHealth();
			}
			ComboTimerDelayIncrease *= (1.0 + (DamageRatio * 0.5));
			ComboTimerDelay += ComboTimerDelayIncrease;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czINFO:\c- \cxDamageRatio\c-: \cx\%.8f\c-, \cyComboTimerDelayIncrease\c-: \cy%.8f\c-)", DamageRatio, ComboTimerDelayIncrease);
		}
		CallACS("MiscVarSetDECORATE",162,ComboTimerDelay);

		// Unsets Alterations of target's DamageFactor
		DamageFactor = basedmgfactor;
		
		// Gauntlet HP/MP/AP drain && Sceptre EXP Gain
		if (playpawn && ret > 0 && bFRIENDLY == 0)
		{
			int InvalidTargetType = 0;
			if (MonsterFamily == "PracticeTarget") InvalidTargetType = 1;
			if (dvdsdebug_actordmgdisplays) Console.Printf("    (\czINFO (Gauntlet Drain/Sceptre EXP):\c- \cavict\c-: \ca%s\c-, \cdinfl\c-: \cd%s\c-)", vict, infl);

			if (InvalidTargetType == 0)
			{
				if (infl == "GauntletPuff" || 
						infl == "GauntletAltPuff")
				{
					// Give some life when hurting a monster [1+(HP/250)]
					// Give more life when killing a monster [5+(HP/50)]
					
					let drainamt = ret;
					if (drainamt > drainmaxdmg) drainamt = drainmaxdmg;
					if (dvdsdebug_actordmgdisplays && drainamt > 0) Console.Printf("    (\czActor Def. Output [STEP (8) - Gauntlet Drain]:\c- \cy%d\c- / \cy%d\c-)", drainamt, drainmaxdmg);
					A_SauronGauntletsHit(playpawn,drainamt,(health > 0? 1 : 2));
				}

				// Sceptre EXP Gain
				if (infl == "SceptrePuffNormal" || 
						infl == "SceptrePuffSilent" || 
						infl == "SceptrePuffSpinning")
				{
					A_AddSceptreEXP_M(0,(health > 0? randompick(4,5,5,5,6) : 1));
				}
			}
		}
		
		if (ret <= 0) A_CheckNeverBleed(1, ret, flags);
		
		return ret;
	}

	//***********
	//**REVISED**
	//***********
	// Adds Crisis Attack Support
	void A_CustomBulletAttack(double spread_xy, double spread_z, int numbullets, int damageperbullet, class<Actor> pufftype = "BulletPuff", double range = 0, int flags = 0, int ptr = AAPTR_TARGET, class<Actor> missile = null, double Spawnheight = 32, double Spawnofs_xy = 0)
	{
		let ref = GetPointer(ptr);

		if (range == 0)
			range = MISSILERANGE;

		int i;
		double bangle;
		double bslope = 0.;
		int laflags = (flags & CBAF_NORANDOMPUFFZ)? LAF_NORANDOMPUFFZ : 0;

		if (ref != NULL || (flags & CBAF_AIMFACING))
		{
			if (!(flags & CBAF_AIMFACING))
			{
				A_Face(ref);
			}
			bangle = self.Angle;

			if (!(flags & CBAF_NOPITCH)) bslope = AimLineAttack (bangle, MISSILERANGE);
			if (pufftype == null) pufftype = 'BulletPuff';

			IsACrisisBulletAttack = false;
			user_canusecrisisatk = 0;
			if (health <= user_HPLowRange) 
			{ 
				if (health <= user_HPCritRange) 
				{ 
					user_canusecrisisatk = 1; 
					//Console.Printf("user_HPCritRange");
				} 
				else 
				{ 
					if (random(1,4) == 4) user_canusecrisisatk = 1;
					//Console.Printf("user_HPLowRange");
				} 
			}
			if (dvds_monstercrisisattacks == 0) { user_canusecrisisatk = 0; }
			//Console.Printf("user_canusecrisisatk: %d", user_canusecrisisatk);
			if (user_canusecrisisatk)
			{
				A_StartSound("crisisattack", 9, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
				A_StartSound("crisisattack2", 10, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
				IsACrisisBulletAttack = true;
			}

			A_StartSound(AttackSound, CHAN_WEAPON);
			for (i = 0; i < numbullets; i++)
			{
				double pangle = bangle;
				double slope = bslope;

				if (flags & CBAF_EXPLICITANGLE)
				{
					pangle += spread_xy;
					slope += spread_z;
				}
				else
				{
					pangle += spread_xy * Random2[cwbullet]() / 255.;
					slope += spread_z * Random2[cwbullet]() / 255.;
				}
				
				if (IsACrisisBulletAttack) damageperbullet *= dvds_monstercrisismulti;
				int damage = damageperbullet;

				if (!(flags & CBAF_NORANDOM))
					damage *= random[cwbullet](1, 3);

				let puff = LineAttack(pangle, range, slope, damage, 'Hitscan', pufftype, laflags);
				if (missile != null && pufftype != null)
				{
					double ang = pangle - 90;
					let ofs = AngleToVector(ang, Spawnofs_xy);
					
					let pos = self.pos;
					SetXYZ(Vec3Offset(ofs.x, ofs.y, 0.));
					let proj = SpawnMissileAngleZSpeed(Pos.Z + GetBobOffset() + Spawnheight, missile, self.Angle, 0, GetDefaultByType(missile).Speed, self, false);
					SetXYZ(pos);
					
					if (proj)
					{
						bool temp = (puff == null);
						if (!puff)
						{
							puff = LineAttack(pangle, range, slope, 0, 'Hitscan', pufftype, laflags | LAF_NOINTERACT);
						}
						if (puff)
						{			
							AimBulletMissile(proj, puff, flags, temp, true);
						}
					}
				}
			}
		}
	}
	
	void A_DVDSCustomComboAttack(Class<Actor> missiletype = "", float spawnheight = 32.0, int meleedamage = 0, string meleesound = "", string damagetype = "Melee", bool bleed = true)
	{
		if (!target) 
						return;
		//
		IsACrisisComboAttack = false;
		user_canusecrisisatk = 0;
		if (health <= user_HPLowRange) 
		{ 
			if (health <= user_HPCritRange) 
			{ 
				user_canusecrisisatk = 1; 
				//Console.Printf("user_HPCritRange");
			} 
			else 
			{ 
				if (random(1,4) == 4) user_canusecrisisatk = 1;
				//Console.Printf("user_HPLowRange");
			} 
		}
		if (dvds_monstercrisisattacks == 0) { user_canusecrisisatk = 0; }
		//Console.Printf("user_canusecrisisatk: %d", user_canusecrisisatk);
		if (user_canusecrisisatk)
		{
			A_StartSound("crisisattack", 9, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
			A_StartSound("crisisattack2", 10, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
			IsACrisisComboAttack = true;
		}
		//
    
		A_FaceTarget();
		if (CheckMeleeRange()) // Melee Attack
		{
			if (IsACrisisComboAttack) meleedamage *= dvds_monstercrisismulti; //

			if (meleesound) 
						A_StartSound(meleesound, CHAN_WEAPON, CHANF_DEFAULT, 1, ATTN_NORM);
			int newdam = target.DamageMobj(self, self, meleedamage, damagetype);
			if (bleed) 
						target.TraceBleed (newdam > 0 ? newdam : meleedamage, self);
		}
		else if (missiletype) // Shoot a single Projectile
		{
			// This seemingly senseless code is needed for proper aiming.
			double add = spawnheight + GetBobOffset() - 32;
			AddZ(add);
			Actor missile = SpawnMissileXYZ((0,0,32), target, missiletype, false);
			AddZ(-add);
    
			if (missile)
			{
				AetheriusProjectileZSC UniqueProjectile; //
				UniqueProjectile = AetheriusProjectileZSC(missile); //
				AetheriusFastProjectileZSC UniqueProjectileFast;
				UniqueProjectileFast = AetheriusFastProjectileZSC(missile);
				if (IsACrisisComboAttack && UniqueProjectile) UniqueProjectile.IsACrisisAttack = true; //
    
				// automatic handling of seeker missiles
				if (missile.bSEEKERMISSILE)
				{
					missile.tracer = target;
				}
				missile.CheckMissileSpawn(radius);
			}
		}
		return;
	}
	
	enum CM_Flags
	{
		CMF_AIMMODE = 3,
		CMF_TRACKOWNER = 4,
		CMF_CHECKTARGETDEAD = 8,
	
		CMF_ABSOLUTEPITCH = 16,
		CMF_OFFSETPITCH = 32,
		CMF_SAVEPITCH = 64,
	
		CMF_ABSOLUTEANGLE = 128,
		CMF_BADPITCH = 256
	};
	
	Actor A_DVDSSpawnProjectile(class<Actor> missiletype, double spawnheight = 32, double spawnofs_xy = 0, double angle = 0, int flags = 0, double pitch = 0, int ptr = AAPTR_TARGET)
	{
		/*
		PARAM_SELF_PROLOGUE(AActor);
		PARAM_CLASS		(ti, AActor);
		PARAM_FLOAT	(Spawnheight);
		PARAM_FLOAT	(Spawnofs_xy);
		PARAM_ANGLE	(Angle);
		PARAM_INT	(flags);
		PARAM_ANGLE	(Pitch);
		PARAM_INT	(ptr);
		*/

		let ref = GetPointer(ptr); // AActor *ref = COPY_AAPTR(self, ptr);
		
		int aimmode = flags & CMF_AIMMODE;
		
		Actor targ; // AActor * targ;
		Actor missile = null; // AActor * missile = nullptr;
		
		if (ref != NULL || aimmode == 2)
		{
			if (missiletype) // if (ti)
			{
				angle -= 90; // DAngle angle = self->Angles.Yaw - 90;
				double x = Spawnofs_xy * cos(angle); // double x = Spawnofs_xy * angle.Cos();
				double y = Spawnofs_xy * sin(angle); // double y = Spawnofs_xy * angle.Sin();
				double z = Spawnheight + GetBobOffset() - 32 + (player? player.crouchoffset : 0.); // double z = Spawnheight + self->GetBobOffset() - 32 + (self->player? self->player->crouchoffset : 0.);
	
				Vector3 pos = (pos.x, pos.y, pos.z); // DVector3 pos = self->Pos();
				switch (aimmode)
				{
					case 0:
					default:
						// same adjustment as above (in all 3 directions this time) - for better aiming!
						SetXYZ(Vec3Offset(pos.x, pos.y, pos.z)); // self->SetXYZ(self->Vec3Offset(x, y, z));
						missile = SpawnMissileXYZ((0,0,32), ref, missiletype, false); // missile = P_SpawnMissileXYZ(self->PosPlusZ(32.), self, ref, ti, false);
						SetXYZ(pos); // self->SetXYZ(pos);
						break;
		
					case 1:
						missile = SpawnMissileXYZ(Vec3Offset(pos.x, pos.y, GetBobOffset() + Spawnheight), ref, missiletype, false); // missile = P_SpawnMissileXYZ(self->Vec3Offset(x, y, self->GetBobOffset() + Spawnheight), self, ref, ti, false);
						break;
		
					case 2:
						SetXYZ(Vec3Offset(pos.x, pos.y, 0.)); // self->SetXYZ(self->Vec3Offset(x, y, 0.));
						missile = SpawnMissileAngleZSpeed(pos.z + GetBobOffset() + Spawnheight, missiletype, angle, 0, GetDefaultByType(missiletype).Speed, self, false); // missile = P_SpawnMissileAngleZSpeed(self, self->Z() + self->GetBobOffset() + Spawnheight, ti, self->Angles.Yaw, 0, GetDefaultByType(ti)->Speed, self, false);
						SetXYZ(pos); // self->SetXYZ(pos);
		
						flags |= CMF_ABSOLUTEPITCH;
		
						break;
				}
	
				if (missile != NULL)
				{
					// Use the actual velocity instead of the missile's Speed property
					// so that this can handle missiles with a high vertical velocity 
					// component properly.
	
					double missilespeed;
	
					if ( (CMF_ABSOLUTEPITCH|CMF_OFFSETPITCH) & flags)
					{
						if (CMF_OFFSETPITCH & flags)
						{
							pitch += missile.pitch; // Pitch += missile->Vel.Pitch();
						}
						missilespeed = abs(Cos(pitch) * missile.Speed); // missilespeed = fabs(Pitch.Cos() * missile->Speed);
						missile.Vel.Z = Sin(pitch) * missile.Speed; // missile->Vel.Z = Pitch.Sin() * missile->Speed;
						if (!(flags & CMF_BADPITCH)) missile.Vel.Z *= -1; // if (!(flags & CMF_BADPITCH)) missile->Vel.Z *= -1;
					}
					else
					{
						missilespeed = missile.vel.xy.Length(); // missilespeed = missile->VelXYToSpeed();
					}
	
					if (CMF_SAVEPITCH & flags)
					{
						missile.pitch = pitch; // missile->Angles.Pitch = Pitch;
						// In aimmode 0 and 1 without absolutepitch or offsetpitch, the pitch parameter
						// contains the unapplied parameter. In that case, it is set as pitch without
						// otherwise affecting the spawned actor.
					}
	
					missile.angle = (CMF_ABSOLUTEANGLE & flags) ? Angle : missile.angle + Angle; // missile->Angles.Yaw = (CMF_ABSOLUTEANGLE & flags) ? Angle : missile->Angles.Yaw + Angle;
					missile.VelFromAngle(missilespeed); // missile->VelFromAngle(missilespeed);
		
					// handle projectile shooting projectiles - track the
					// links back to a real owner
					if (bMISSILE && (!!(flags & CMF_TRACKOWNER))) //if (self->isMissile(!!(flags & CMF_TRACKOWNER)))
					{
						Actor owner = self; // AActor *owner = self ;//->target;
						while (owner.bMISSILE && (!!(flags & CMF_TRACKOWNER)) && owner.target) // while (owner->isMissile(!!(flags & CMF_TRACKOWNER)) && owner.target)
										owner = owner.target; // owner = owner->target;
						targ = owner;
						missile.target = owner; // missile->target = owner;
						// automatic handling of seeker missiles
						if (bSEEKERMISSILE & missile.bSEEKERMISSILE) // if (self->flags2 & missile->flags2 & MF2_SEEKERMISSILE)
						{
							missile.tracer = tracer; // missile->tracer = self->tracer;
						}
					}
					else if (missile.bSEEKERMISSILE) // else if (missile->flags2 & MF2_SEEKERMISSILE)
					{
						// automatic handling of seeker missiles
						missile.tracer = target; // missile->tracer = self->target;
					}

					// we must redo the spectral check here because the owner is set after spawning so the FriendPlayer value may be wrong
					if (missile.bSPECTRAL) // if (missile->flags4 & MF4_SPECTRAL)
					{
						if (missile.target != NULL) // if (missile->target != NULL)
						{
							missile.SetFriendPlayer(missile.target.player); // missile->SetFriendPlayer(missile->target->player);
						}
						else
						{
							missile.FriendPlayer = 0; // missile->FriendPlayer = 0;
						}
					}
					CheckMissileSpawn(radius); // P_CheckMissileSpawn(missile, self->radius);
				}
			}
		}
		else if (flags & CMF_CHECKTARGETDEAD)
		{
			// Target is dead and the attack shall be aborted.
			if (SeeState != NULL && (health > 0 || !(bISMONSTER))) // if (self->SeeState != NULL && (self->health > 0 || !(self->flags3 & MF3_ISMONSTER)))
				SetState(SeeState); // self->SetState(self->SeeState);
		}
		return(missile); // ACTION_RETURN_OBJECT(missile);
	}
	
	void A_DVDSCustomMeleeAttack(int damage = 0, string meleesound = "", string misssound = "", string damagetype = "Melee", bool bleed = true)
	{
		if (damagetype == 'None')
						damagetype = 'Melee';	// Melee is the default type

		if (!target) 
						return;

		IsACrisisMeleeAttack = false; //
		let targ = target;
		//
		user_canusecrisisatk = 0;
		if (health <= user_HPLowRange) 
		{ 
			if (health <= user_HPCritRange) 
			{ 
				user_canusecrisisatk = 1; 
				//Console.Printf("user_HPCritRange");
			} 
			else 
			{ 
				if (random(1,4) == 4) user_canusecrisisatk = 1;
				//Console.Printf("user_HPLowRange");
			} 
		}
		if (dvds_monstercrisisattacks == 0) { user_canusecrisisatk = 0; }
		//Console.Printf("user_canusecrisisatk: %d", user_canusecrisisatk);
		if (user_canusecrisisatk)
		{
			A_StartSound("crisisattack", 9, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
			A_StartSound("crisisattack2", 10, CHANF_DEFAULT, frandom(1.25,1.5), ATTN_NORM, frandom(0.75,1.25));
			IsACrisisMeleeAttack = true;
		}
		if (IsACrisisMeleeAttack) damage *= dvds_monstercrisismulti;
		//
    
		A_FaceTarget();
		if (CheckMeleeRange())
		{
			if (meleesound) 
						A_StartSound(meleesound, CHAN_WEAPON, CHANF_DEFAULT, 1, ATTN_NORM);
			int newdam = target.DamageMobj(self, self, damage, damagetype);
			if (bleed) 
						target.TraceBleed (newdam > 0 ? newdam : damage, self);
		}
		else
		{
			if (misssound) 
						A_StartSound(misssound, CHAN_WEAPON, CHANF_DEFAULT, 1, ATTN_NORM);
		}
		return;
	}
	
	enum CustomRailgun
	{
		CRF_DONTAIM = 0,
		CRF_AIMPARALLEL = 1,
		CRF_AIMDIRECT = 2,
		CRF_EXPLICITANGLE = 4,
	};
	
	void A_DVDSCustomRailgun(int damage, int spawnofs_xy = 0, color color1 = 0, color color2 = 0, int flags = 0, int aim = 0, double maxdiff = 0, class<Actor> pufftype = "BulletPuff", double spread_xy = 0, double spread_z = 0, double range = 0, int duration = 0, double sparsity = 1.0, double driftspeed = 1.0, class<Actor> spawnclass = null, double spawnofs_z = 0, int spiraloffset = 270, int limit = 0, double veleffect = 3)
	{
		/*
		PARAM_SELF_PROLOGUE(AActor);
		PARAM_INT		(damage);
		PARAM_INT	(spawnofs_xy)		
		PARAM_COLOR	(color1)			
		PARAM_COLOR	(color2)			
		PARAM_INT	(flags)				
		PARAM_INT	(aim)				
		PARAM_FLOAT	(maxdiff)			
		PARAM_CLASS	(pufftype, AActor)	
		PARAM_ANGLE	(spread_xy)			
		PARAM_ANGLE	(spread_z)			
		PARAM_FLOAT	(range)				
		PARAM_INT	(duration)			
		PARAM_FLOAT	(sparsity)			
		PARAM_FLOAT	(driftspeed)		
		PARAM_CLASS	(spawnclass, AActor)
		PARAM_FLOAT	(spawnofs_z)		
		PARAM_INT	(SpiralOffset)		
		PARAM_INT	(limit)				
		PARAM_FLOAT	(veleffect)
		*/
	
		if (range == 0) range = 8192.;
		if (sparsity == 0) sparsity = 1;
	
		FTranslatedLineTarget t;
	
		Vector3 savedpos = (pos.x, pos.y, pos.z); // DVector3 savedpos = self->Pos();
		double saved_angle = Angle; // DAngle saved_angle = self->Angles.Yaw;
		double saved_pitch = Pitch; // DAngle saved_pitch = self->Angles.Pitch;
	
		if (aim && target == NULL) // if (aim && self->target == NULL)
		{
			return; // return 0;
		}
		// [RH] Andy Baker's stealth monsters
		if (bSTEALTH) // if (self->flags & MF_STEALTH)
		{
			visdir = 1; // self->visdir = 1;
		}
	
		flags &= ~bAMBUSH; // self->flags &= ~MF_AMBUSH;
	
	
		if (aim)
		{
			Angle = AngleTo(target); // self->Angles.Yaw = self->AngleTo(self->target);
		}
		Pitch = AimLineAttack (Angle, MISSILERANGE, t, 60., 0, aim ? target : NULL); // self->Angles.Pitch = P_AimLineAttack (self, self->Angles.Yaw, MISSILERANGE, &t, 60., 0, aim ? self->target : NULL);
		if (t.linetarget == NULL && aim)
		{
			// We probably won't hit the target, but aim at it anyway so we don't look stupid.
			Vector2 xydiff = Vec2To(target); // DVector2 xydiff = self->Vec2To(self->target);
			double zdiff = (target.pos.z + (target.height/2)) - (pos.z + (height/2)) - Floorclip; // double zdiff = self->target->Center() - self->Center() - self->Floorclip;
			Pitch = -VectorAngle(xydiff.Length(), zdiff); // self->Angles.Pitch = -VecToAngle(xydiff.Length(), zdiff);
		}
		// Let the aim trail behind the player
		if (aim)
		{
			let vec = target.Vec2To (self) + (-target.Vel.X * veleffect, -target.Vel.Y * veleffect);  // saved_angle = self->Angles.Yaw = self->AngleTo(self->target, -self->target->Vel.X * veleffect, -self->target->Vel.Y * veleffect);
			saved_angle = angle = VectorAngle (vec.X, vec.Y);
	
			if (aim == CRF_AIMDIRECT)
			{
				// Tricky: We must offset to the angle of the current position
				// but then change the angle again to ensure proper aim.
				Vector3 dpos = (Vec2Offset(spawnofs_xy * Cos(angle), spawnofs_xy * Sin(angle)), pos.z); SetXYZ(dpos); // self->SetXY(self->Vec2Offset(spawnofs_xy * self->Angles.Yaw.Cos(), spawnofs_xy * self->Angles.Yaw.Sin()));
				spawnofs_xy = 0;
				vec = target.Vec2To (self) + (-target.Vel.X * veleffect, -target.Vel.Y * veleffect); // self->Angles.Yaw = self->AngleTo(self->target, -self->target->Vel.X * veleffect, -self->target->Vel.Y * veleffect);
				angle = VectorAngle (vec.X, vec.Y);
				
			}
	
			if (target.bSHADOW) // if (self->target->flags & MF_SHADOW)
			{
				double rnd = Random2[pr_crailgun]() * (45. / 256.); // DAngle rnd = pr_crailgun.Random2() * (45. / 256.);
				angle += rnd; // self->Angles.Yaw += rnd;
			}
		}
	
		if (!(flags & CRF_EXPLICITANGLE))
		{
			spread_xy = spread_xy * Random2[pr_crailgun]() / 255; // spread_xy = spread_xy * pr_crailgun.Random2() / 255;
			spread_z = spread_z * Random2[pr_crailgun]() / 255; // spread_z = spread_z * pr_crailgun.Random2() / 255;
		}
	
		/*
		FRailParams p;
		p.source = self;
		p.damage = damage;
		p.offset_xy = spawnofs_xy;
		p.offset_z = spawnofs_z;
		p.color1 = color1;
		p.color2 = color2;
		p.maxdiff = maxdiff;
		p.flags = flags;
		p.puff = pufftype;
		p.angleoffset = spread_xy;
		p.pitchoffset = spread_z;
		p.distance = range;
		p.duration = duration;
		p.sparsity = sparsity;
		p.drift = driftspeed;
		p.spawnclass = spawnclass;
		p.SpiralOffset = SpiralOffset;
		p.limit = 0;
		P_RailAttack(&p);
		*/
	
		SetXYZ(savedpos); // self->SetXYZ(savedpos);
		angle = saved_angle; // self->Angles.Yaw = saved_angle;
		pitch = saved_pitch; // self->Angles.Pitch = saved_pitch;
		return; // return 0;
	}
	
	
	//****************************
	//*AETHERIUS UNIQUE FUNCTIONS*
	//****************************
	void A_DVDSBossDeath()
	{
		bossdeathactivate++;
		A_BossDeath();
	}

	// int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0
	void A_DVDSWander(int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
			if (value5) value6 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSWander]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}
		
		A_Wander(flags);
	}
	
	// int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0
	void A_DVDSChase(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		int DodgeMorePerkLvl = CallACS("MiscVarCheckDECORATE",10007);
		int DodgeMoreEXPerkLvl = CallACS("MiscVarCheckDECORATE",10008);
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
			if (value6) value6 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}
		
		int NoAtkChance = 0;
		if (CountInv("PoisonCloudATKPenalty1")) NoAtkChance += 75;
		if (CountInv("PoisonCloudATKPenalty1b")) NoAtkChance += 75;
		if (CountInv("PoisonCloudATKPenalty2")) NoAtkChance += 75;
		if (CountInv("PoisonCloudATKPenalty2b")) NoAtkChance += 75;
		if (CountInv("PoisonCloudATKPenalty3")) NoAtkChance += 75;
		if (CountInv("PoisonCloudATKPenalty3b")) NoAtkChance += 75;
		if (CountInv("HubbleBubbleSpeedPenalty1")) NoAtkChance += 138;
		if (CountInv("HubbleBubbleSpeedPenalty1b")) NoAtkChance += 137;
		if (CountInv("HubbleBubbleSpeedPenalty2")) NoAtkChance += 138;
		if (CountInv("HubbleBubbleSpeedPenalty2b")) NoAtkChance += 137;
		if (CountInv("HubbleBubbleSpeedPenalty3")) NoAtkChance += 138;
		if (CountInv("HubbleBubbleSpeedPenalty3b")) NoAtkChance += 137;
		
		int PerkFactor;
		int SkillFactor;
		string Actorname = GetClassName();

		AetheriusPlayerPawn playpawn;
		if (target) playpawn = AetheriusPlayerPawn(target);
		if (playpawn)
		{
			if (playpawn.CountInv("PowerInvisibility") || playpawn.CountInv("InvisiblitySpell"))
			{
				if (Actorname == "ClayDevilNew")
				{
					PerkFactor = 834;
					PerkFactor += ((DodgeMorePerkLvl * 30) + (DodgeMoreEXPerkLvl * 75));
				}
				else
				{
					PerkFactor = 167;
					PerkFactor += ((DodgeMorePerkLvl * 6) + (DodgeMoreEXPerkLvl * 15));
				}
				if (PerkFactor > 1000) PerkFactor = 1000;
				SkillFactor = (1000 - NoAtkChance) * PerkFactor / 1000;
				NoAtkChance += SkillFactor;
			}
			if (playpawn.CountInv("PlayerDashing"))
			{
				if (Actorname == "ClayDevilNew")
				{
					PerkFactor = random(993,994);
				}
				else
				{
					PerkFactor = 875;
				}
				SkillFactor = (1000 - NoAtkChance) * PerkFactor / 1000;
				NoAtkChance += SkillFactor;
			}
		}
		
		if (dvdsdebug_showactormoveinformation && NoAtkChance > 0) 
		{
			if (target) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- NoAtkChance: %d / 1000, Target: %s \cytics: %d\c-", GetClassName(), gametic, NoAtkChance, target.GetClassName(), tics);
						 else Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- NoAtkChance: %d / 1000 \cytics: %d\c-", GetClassName(), gametic, NoAtkChance, tics);
		}
		if (random(1,1000) <= NoAtkChance)
		{
			if (flags & CHF_FASTCHASE) flags &= ~CHF_FASTCHASE;
			if (playpawn && (playpawn.CountInv("PowerInvisibility") || playpawn.CountInv("InvisiblitySpell")))
			{
				if (random(1,1000) <= 250) 
				{
					A_Wander();
					if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- A_Wander Succeed", GetClassName(), gametic);
				}
				else 
				{
					A_Chase(null,null,flags);
				}
			}
			else
			{
				A_Chase(null,null,flags);
			}
			if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- NoAtkChance Succeed \cytics: %d\c-", GetClassName(), gametic, tics);
		}
		else
		{
			A_Chase(melee,missile,flags);
		}
		if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSChase]\c- Default Chase \cytics: %d\c-", GetClassName(), gametic, tics);
	}
	
	void A_DVDSLook(int flags = 0, double minseedist = 0, double maxseedist = 0, double maxheardist = 0, double fov = 0, statelabel label = null)
	{
		A_LookEx(flags,minseedist,maxseedist,maxheardist,fov,label);
	}

	enum ChaseFlags
	{
		CHF_FASTCHASE = 1,
		CHF_NOPLAYACTIVE = 2,
		CHF_NIGHTMAREFAST = 4,
		CHF_RESURRECT = 8,
		CHF_DONTMOVE = 16,
		CHF_NORANDOMTURN = 32,
		CHF_NODIRECTIONTURN = 64,
		CHF_NOPOSTATTACKTURN = 128,
		CHF_STOPIFBLOCKED = 256,
	};

	void A_DVDSPain(int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		A_Pain();
		A_RefreshStealthInfo(1);
		
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
			if (value6) value6 = 0;
		}
		if (type == 1) // SpeedPainChange
		{
			if (random(1,100) <= value5)
			{
				if (value1 <= 0) value1 = random(18,22);
				if (value2 <= 0) value2 = 8;
				
				int extrasteps;
				if (levelbehavior) extrasteps = user_monsterlevel / value2;
				specialspeed1 = value1 + extrasteps; // Number of steps to walk fast
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_DVDSPain]\c- specialspeed1: %d, basespeedtimer: %d, leveldivisor: %d, ?3: %d, ?4: %d, chanceroll[/100]: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, value4, value5, tics);
			}
		}

		if (GetClassName() == "Diabloist" || GetClassName() == "FDiabloist")
		{
			if (bNOTARGETSWITCH) bNOTARGETSWITCH = false;
			if (!bQUICKTORETALIATE) bQUICKTORETALIATE = true;
		}
	}
	
	void A_LegendaryCheck()
	{
		String nm = "LDLegendaryMonsterPickupEasy";
		LDLPreload = nm;
		
		if (!(GetClassName() == "PeasantNew" || GetClassName() == "Peasant1New" || GetClassName() == "Peasant2New" || GetClassName() == "Peasant3New"
				|| GetClassName() == "Peasant4New" || GetClassName() == "Peasant5New" || GetClassName() == "Peasant6New" || GetClassName() == "Peasant7New"
				|| GetClassName() == "Peasant8New" || GetClassName() == "Peasant9New" || GetClassName() == "Peasant10New" || GetClassName() == "Peasant11New"
				|| GetClassName() == "Peasant12New" || GetClassName() == "Peasant13New" || GetClassName() == "Peasant14New" || GetClassName() == "Peasant15New"
				|| GetClassName() == "Peasant16New" || GetClassName() == "Peasant17New" || GetClassName() == "Peasant18New" || GetClassName() == "Peasant19New"
				|| GetClassName() == "Peasant20New" || GetClassName() == "Peasant21New"|| GetClassName() == "Peasant22New" || GetClassName() == "BeggarNew"
				|| GetClassName() == "Beggar1New" || GetClassName() == "Beggar2New" || GetClassName() == "Beggar3New" || GetClassName() == "Beggar4New"
				|| GetClassName() == "Beggar5New" || GetClassName() == "MerchantNew" || GetClassName() == "WeaponSmithNew" || GetClassName() == "BarKeepNew"
				|| GetClassName() == "ArmorerNew" || GetClassName() == "MedicNew"))
		{
			if (TrueGameSkill <= SKILL_VERY_EASY) { nm = "LDLegendaryMonsterPickupEasy"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_EASY) { nm = "LDLegendaryMonsterPickupNormal"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_NORMAL) { nm = "LDLegendaryMonsterPickupHard"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_HARD) { nm = "LDLegendaryMonsterPickupUV"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_VERY_HARD) { nm = "LDLegendaryMonsterPickupNightmare"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_EXTREME) { nm = "LDLegendaryMonsterPickupExtreme"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_HORRIBLE) { nm = "LDLegendaryMonsterPickupHorrible"; LDLPreload = nm; }
			if (TrueGameSkill == SKILL_IMPOSSIBLE) { nm = "LDLegendaryMonsterPickupImpossible"; LDLPreload = nm; }
			if (TrueGameSkill >= SKILL_OMEGA) { nm = "LDLegendaryMonsterPickupOmega"; LDLPreload = nm; }
			self.A_GiveInventory(LDLPreload,1);
		}
	}
	
	int A_GetStealthChance()
	{
		int TempRatio;
		int StealthChance, TempStealthChance, ChanceFactor, LevelCheck, MapCheck;
		int debugevolvestealth = dvdsdebug_evolvestealthstuff;
		int deathkingsmapcalcmod = dvds_deathkingsmapcalcmod;
		int mapcalcfactorexact = 0;
		int mapcalcfactorpercent = 100;
		int PlayerLevel = CallACS("StatCheck",0);
		int SceptreActualLevel = CallACS("OtherVarCheckDECORATE",11);
		int mapdifficultytype = dvds_mapdifficultytype;
		
		StealthChance = dvds_rnd_stealth;
		if (StealthChance <= 0) { return StealthChance; }

		if (debugevolvestealth) Console.Printf("Stealth Chance [Base]: %d - %s", StealthChance, GetClassName());
		
		StealthChance = clamp(StealthChance, 0, 512);

		TempRatio = dvds_rnd_stealth_levels;
		if (TempRatio > 0) 
		{
			if (TempRatio > 1000) TempRatio = 1000;
			
			TempStealthChance = (SceptreActualLevel * 0.04) + (PlayerLevel * 0.0133333333333333); 
			TempStealthChance = TempStealthChance * TempRatio / 100;
			StealthChance += TempStealthChance;
			if (debugevolvestealth) Console.Printf("Stealth Chance [Level]: %d - %s - (+%d)", StealthChance, GetClassName(), TempStealthChance);
		}

		TempRatio = dvds_rnd_stealth_chars;
		if (TempRatio > 0) 
		{
			if (TempRatio > 1000) TempRatio = 1000;
			
			TempStealthChance = 0;
			if (CharacterClass == 0) TempStealthChance = 125;
			else if (CharacterClass == 1) TempStealthChance = 0;
			else if (CharacterClass == 2) TempStealthChance = -125;
			else if (CharacterClass == 8) TempStealthChance = -50;
			else if (CharacterClass == 9) TempStealthChance = 50;
	
			TempStealthChance = TempStealthChance * TempRatio / 100;
			TempStealthChance += 1000;
			StealthChance *= TempStealthChance;
			StealthChance /= 1000;
			if (debugevolvestealth) Console.Printf("Stealth Chance [Character]: %d - %s - (%d / 1000)", StealthChance, GetClassName(), TempStealthChance);
		}
		
		TempRatio = dvds_rnd_stealth_skill;
		if (TempRatio > 0) 
		{
			if (TempRatio > 1000) TempRatio = 1000;
			
			TempStealthChance = 0;
			if (TrueGameSkill <= SKILL_VERY_EASY) TempStealthChance = -250;
			else if (TrueGameSkill == SKILL_EASY) TempStealthChance = -100;
			else if (TrueGameSkill == SKILL_NORMAL) TempStealthChance = 0;
			else if (TrueGameSkill == SKILL_HARD) TempStealthChance = 100;
			else if (TrueGameSkill == SKILL_VERY_HARD) TempStealthChance = 250;
			else if (TrueGameSkill == SKILL_EXTREME) TempStealthChance = 350;
			else if (TrueGameSkill == SKILL_HORRIBLE) TempStealthChance = 500;
			else if (TrueGameSkill == SKILL_IMPOSSIBLE) TempStealthChance = 700;
			else if (TrueGameSkill >= SKILL_OMEGA) TempStealthChance = 1000;
	
			TempStealthChance = TempStealthChance * TempRatio / 100;
			TempStealthChance += 1000;
			StealthChance *= TempStealthChance;
			StealthChance /= 1000;
			if (debugevolvestealth) Console.Printf("Stealth Chance [Skill]: %d - %s - (%d / 1000)", StealthChance, GetClassName(), TempStealthChance);
		}

		TempRatio = dvds_rnd_stealth_maps;
		if (TempRatio > 0) 
		{
			if (TempRatio > 1000) TempRatio = 1000;
			
			if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
			{
				if (ClassicDoomType == 1 || ClassicDoomType == 2) // Doom 1 / Heretic
				{
					if (mapdifficultytype == 0) MapCheck = level.levelnum;
					else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
					
					if (CallACS("MiscVarCheckDECORATE",259) > 0) 
					{
						if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
						else MapCheck += deathkingsmapcalcmod;
					}
					MapCheck += CallACS("MiscVarCheckDECORATE",54); // Map Inflation [Evolve/Stealth - Exact]
					MapCheck += CallACS("MiscVarCheckDECORATE",169); // Map Inflation [Overall - Exact]
					MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",3) / 100; // Map Inflation [Evolve/Stealth - Percentile]
					MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",5) / 100; // Map Inflation [Overall - Percentile]
					MapCheck = clamp(MapCheck, 1, 100);
			
					if (MapCheck >= 1 && MapCheck <= 10) ChanceFactor = (MapCheck * 25); // Episode 1
					if (MapCheck >= 11 && MapCheck <= 20) ChanceFactor = (MapCheck * 31); // Episode 2
					if (MapCheck >= 21 && MapCheck <= 30) ChanceFactor = (MapCheck * 38); // Episode 3
					if (MapCheck >= 31 && MapCheck <= 40) ChanceFactor = (MapCheck * 46); // Episode 4
					if (MapCheck >= 41 && MapCheck <= 50) ChanceFactor = (MapCheck * 55); // Episode 5
					if (MapCheck >= 51 && MapCheck <= 60) ChanceFactor = (MapCheck * 65); // Episode 6
					if (MapCheck >= 61 && MapCheck <= 70) ChanceFactor = (MapCheck * 76); // Episode 7
					if (MapCheck >= 71 && MapCheck <= 80) ChanceFactor = (MapCheck * 88); // Episode 8
					if (MapCheck >= 81 && MapCheck <= 90) ChanceFactor = (MapCheck * 101); // Episode 9
					if (MapCheck >= 91 && MapCheck <= 100) ChanceFactor = (MapCheck * 115); // Episode 10
				}
				else // Doom / Hexen / Strife / Doom64
				{
					if (mapdifficultytype == 0) MapCheck = level.levelnum;
					else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
					
					if (CallACS("MiscVarCheckDECORATE",259) > 0) 
					{
						if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
						else MapCheck += deathkingsmapcalcmod;
					}
					MapCheck += CallACS("MiscVarCheckDECORATE",54); // Map Inflation [Evolve/Stealth - Exact]
					MapCheck += CallACS("MiscVarCheckDECORATE",169); // Map Inflation [Overall - Exact]
					MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",3) / 100; // Map Inflation [Evolve/Stealth - Percentile]
					MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",5) / 100; // Map Inflation [Overall - Percentile]
					MapCheck = clamp(MapCheck, 1, 100);
			
					if (MapCheck >= 1 && MapCheck <= 5) ChanceFactor = (MapCheck * 30);
					if (MapCheck >= 6 && MapCheck <= 10) ChanceFactor = (MapCheck * 35);
					if (MapCheck >= 11 && MapCheck <= 15) ChanceFactor = (MapCheck * 40);
					if (MapCheck >= 16 && MapCheck <= 20) ChanceFactor = (MapCheck * 45);
					if (MapCheck >= 21 && MapCheck <= 25) ChanceFactor = (MapCheck * 55);
					if (MapCheck >= 26 && MapCheck <= 30) ChanceFactor = (MapCheck * 60);
					if (MapCheck >= 31 && MapCheck <= 36) ChanceFactor = (MapCheck * 66);
					if (MapCheck >= 37 && MapCheck <= 42) ChanceFactor = (MapCheck * 72);
					if (MapCheck >= 43 && MapCheck <= 48) ChanceFactor = (MapCheck * 78);
					if (MapCheck >= 49 && MapCheck <= 54) ChanceFactor = (MapCheck * 84);
					if (MapCheck >= 55 && MapCheck <= 60) ChanceFactor = (MapCheck * 90);
					if (MapCheck >= 61 && MapCheck <= 66) ChanceFactor = (MapCheck * 96);
					if (MapCheck >= 67 && MapCheck <= 72) ChanceFactor = (MapCheck * 103);
					if (MapCheck >= 73 && MapCheck <= 78) ChanceFactor = (MapCheck * 110);
					if (MapCheck >= 79 && MapCheck <= 84) ChanceFactor = (MapCheck * 118);
					if (MapCheck >= 85 && MapCheck <= 90) ChanceFactor = (MapCheck * 126);
					if (MapCheck >= 91 && MapCheck <= 96) ChanceFactor = (MapCheck * 135);
					if (MapCheck >= 97 && MapCheck <= 102) ChanceFactor = (MapCheck * 144);
				}
				ChanceFactor = ChanceFactor * 5 / 8;
			}
			else if (ModType == 1) // DVI
			{
				MapCheck = level.levelnum;
				MapCheck = clamp(MapCheck, 1101, 1104);
			
				if (MapCheck == 1101) StealthChance = StealthChance * 1000 / 1000; // MAP01 - Insurgents
				else if (MapCheck == 1102) StealthChance = StealthChance * 1116 / 1000; // MAP02 - Torture Chamber
				else if (MapCheck == 1103) StealthChance = StealthChance * 1256 / 1000; // MAP03 - Cathedral
				else if (MapCheck == 1104) StealthChance = StealthChance * 1418 / 1000; // MAP04 - End Of Days
			}
			else
			if (ModType == 2) // DVII
			{
				MapCheck = level.levelnum;
				MapCheck = clamp(MapCheck, 1201, 1212);
			
				if (MapCheck == 1201) ChanceFactor = 0; // MAP01 - Entryway Pass
				else if (MapCheck == 1202) ChanceFactor = 70; // MAP02 - Mutagen
				else if (MapCheck == 1203) ChanceFactor = 140; // MAP03 - Crouching Demon, Hidden Archvile
				else if (MapCheck == 1204) ChanceFactor = 209; // MAP04 - Minas Morgul
				else if (MapCheck == 1205) ChanceFactor = 302; // MAP05 - Eagle's Nest
				else if (MapCheck == 1206) ChanceFactor = 395; // MAP05B - The Manliest Level Ever
				else if (MapCheck == 1207) ChanceFactor = 488; // MAP06 - Stargate
				else if (MapCheck == 1208) ChanceFactor = 605; // MAP07 - The Desert Temple
				else if (MapCheck == 1209) ChanceFactor = 953; // MAP08 - The Unholy Cathedral
				else if (MapCheck == 1210) ChanceFactor = 1372; // MAP09 - You Shall Not Pass!
				else if (MapCheck == 1211) ChanceFactor = 1884; // MAP10 - Hell's Vendetta
				else if (MapCheck == 1212) ChanceFactor = 2488; // MAP10B - attedneV s'lleH
				else if (MapCheck == 1214) ChanceFactor = 465; // MAP12 - "The Wings of The Maiar" [DVI combined level remake]
				else if (MapCheck == 1215) ChanceFactor = 2488; // MAP10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
			}
	
			ChanceFactor = ChanceFactor * TempRatio / 100;
			ChanceFactor += 1000;
			StealthChance = StealthChance * ChanceFactor / 1000;
			if (debugevolvestealth)
			{
				Console.Printf("\czMapCheck: %d\n\c-Stealth Chance [Maps]: %d - %s - (%d / 1000)", MapCheck, StealthChance, GetClassName(), ChanceFactor);
			}
		}

		// Check if the actor is one of Strife's Peasents [and if so, sets Stealth Chance to 0]
		If (GetClassName() == "PeasantNew") IsAPeasent++;
		If (GetClassName() == "Peasant1New") IsAPeasent++;
		If (GetClassName() == "Peasant2New") IsAPeasent++;
		If (GetClassName() == "Peasant3New") IsAPeasent++;
		If (GetClassName() == "Peasant4New") IsAPeasent++;
		If (GetClassName() == "Peasant5New") IsAPeasent++;
		If (GetClassName() == "Peasant6New") IsAPeasent++;
		If (GetClassName() == "Peasant7New") IsAPeasent++;
		If (GetClassName() == "Peasant8New") IsAPeasent++;
		If (GetClassName() == "Peasant9New") IsAPeasent++;
		If (GetClassName() == "Peasant10New") IsAPeasent++;
		If (GetClassName() == "Peasant11New") IsAPeasent++;
		If (GetClassName() == "Peasant12New") IsAPeasent++;
		If (GetClassName() == "Peasant13New") IsAPeasent++;
		If (GetClassName() == "Peasant14New") IsAPeasent++;
		If (GetClassName() == "Peasant15New") IsAPeasent++;
		If (GetClassName() == "Peasant16New") IsAPeasent++;
		If (GetClassName() == "Peasant17New") IsAPeasent++;
		If (GetClassName() == "Peasant18New") IsAPeasent++;
		If (GetClassName() == "Peasant19New") IsAPeasent++;
		If (GetClassName() == "Peasant20New") IsAPeasent++;
		If (GetClassName() == "Peasant21New") IsAPeasent++;
		If (GetClassName() == "Peasant22New") IsAPeasent++;
		If (GetClassName() == "BeggarNew") IsAPeasent++;
		If (GetClassName() == "Beggar1New") IsAPeasent++;
		If (GetClassName() == "Beggar2New") IsAPeasent++;
		If (GetClassName() == "Beggar3New") IsAPeasent++;
		If (GetClassName() == "Beggar4New") IsAPeasent++;
		If (GetClassName() == "Beggar5New") IsAPeasent++;
		If (GetClassName() == "MerchantNew") IsAPeasent++;
		If (GetClassName() == "WeaponSmithNew") IsAPeasent++;
		If (GetClassName() == "BarKeepNew") IsAPeasent++;
		If (GetClassName() == "ArmorerNew") IsAPeasent++;
		If (GetClassName() == "MedicNew") IsAPeasent++;
		If (IsAPeasent > 0) 
		{
			StealthChance = 0;
			if (debugevolvestealth) Console.Printf("Stealth Chance [PeasentCheck]: %d - %s", StealthChance, GetClassName());
		}

		int IsFullyInvisible = 0;
		If (GetClassName() == "NightmareNew") IsFullyInvisible++;
		If (GetClassName() == "SirenNightmareNew") IsFullyInvisible++;
		If (IsFullyInvisible > 0) 
		{
			StealthChance = 0;
			if (debugevolvestealth) Console.Printf("Stealth Chance [GhostStealthCheck]: %d - %s", StealthChance, GetClassName());
		}

		if (debugevolvestealth) Console.Printf("Stealth Chance [Final]: %d - %s", StealthChance, GetClassName());
		return StealthChance;
	}
	
	void A_MonsterStatsHP_ATK_DEF_SPD(int type = 0, int extraflags = 0)
	{
		double basemaxratio = 6.25;
		double MaxHP, MSpeed, Attack, Defense, Balance;
		double PreMaxHP, PreMSpeed, PreAttack, PreDefense, PreBalance;
		double RangeVar;
		int CurrHP, Temp, LevelCheck, MapCheck;
		int StealthChance;
		int nonstatmonster = 0;
		int debugstatcalc = dvdsdebug_showstatcalcstuff;
		int skilllevelcalctype = dvds_skilllevelcalctype;
		int deathkingsmapcalcmod = dvds_deathkingsmapcalcmod;
		int mapcalcfactorexact = 0;
		int mapcalcfactorpercent = 100;
		int BossEyeCheck = 0;
		int PlayerLevel = CallACS("StatCheck",0);
		int mapdifficultytype = dvds_mapdifficultytype;
		int StrifeStaminaLevel = CallACS("MiscVarCheckDECORATE",317);
		int StrifeAccuracyLevel = CallACS("MiscVarCheckDECORATE",318);
		
		type = clamp(type, 0, 1);
		
		// extraflags
		// & 1 = Always multiply level by 4 instead of a 1/64 chance of it. [basically "Elitifies" the monster all the time when called]
		// & 2 = Multiplies the monsters' level by 4 [again]

		if (type == 0) // Giving Stats
		{
			if (ActorLevelCalcs) { if (debugstatcalc) Console.Printf("ActorLevelCalcs [1]: %d", ActorLevelCalcs); }
			else
			{
				if (user_checkmapskill > 0) { if (debugstatcalc) Console.Printf("user_checkmapskill [2]: %d", user_checkmapskill); }
				else
				{
					ThinkerIterator Test1 = ThinkerIterator.Create("DSBossEye"); Actor mo; while (mo = Actor(Test1.Next())) { BossEyeCheck++; }
					if (debugstatcalc) Console.Printf("DSBossEye (Check): %d", BossEyeCheck);

					string ActorName = GetClassName();
					if (debugstatcalc) Console.Printf("\ckActorName: %s", ActorName);

					StealthChance = A_GetStealthChance(); // ACS_NamedExecuteWithResult("GetStealthChance");
					if (dvdsdebug_evolvestealthstuff) Console.Printf("Stealth Chance: %d", StealthChance);

					nonstatmonster = 0;
					if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
					if (random(1,256) <= StealthChance && nonstatmonster == 0)
					{
						user_isstealth = user_wasstealth = 1;
						A_RefreshStealthInfo(0); // Runs to check Stealth information [in case something like finding the Ring has happened]
					}
					else
					{
						user_isstealth = user_wasstealth = 0;
					}

					//*******************************************************
					//** Calculates Stats By Checking the Difficulty Level **
					//*******************************************************
					int DifficultyChecker = 1;
					if (ModType == 0)
					{
						if (dvds_monsterstatcalc_skill) DifficultyChecker = 1; else DifficultyChecker = 0;
					}
					else DifficultyChecker = 1;

					double SpeedFactor = 0.0;
					double AttackFactor = 0.0;
					double DefenseFactor = 0.0;
					double MaxHPFactor = 0.0;
					double BalanceFactor = 0.0;
					if (GetClassName() == "Sauravatar") MSpeed = 32.0; else MSpeed = Speed;
					Attack = 1.0; 
					Defense = 1.0; 
					Balance = Mass;
					if (GetClassName() == "Sauravatar") MaxHP = user_MaxHP; else MaxHP = SpawnHealth();
					PreMSpeed = MSpeed;
					PreAttack = Attack; 
					PreDefense = Defense; 
					PreBalance = Balance; 
					PreMaxHP = MaxHP;
					user_basespeed = Speed;
					user_basemass = Mass;
					if (debugstatcalc) Console.Printf("\chStart Speed: %.8f, \cgStart Attack: %.8f, \cdStart Defense: %.8f, \caStart Max HP: %d, \cpStart Balance: %d", MSpeed, Attack, Defense, MaxHP, Balance);
					
					nonstatmonster = 0;
					if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
					if (DifficultyChecker == 1 && nonstatmonster == 0) // Difficulty-checking enabled
					{
						if (TrueGameSkill <= SKILL_VERY_EASY)
						{
							AttackFactor = 0.05;
							DefenseFactor = -0.025;
							SpeedFactor = 0.025;
							MaxHPFactor = 0.05;
							BalanceFactor = 0.04;
						}
						else
						if (TrueGameSkill == SKILL_EASY)
						{
							AttackFactor = 0.125;
							DefenseFactor = -0.0625;
							SpeedFactor = 0.0625;
							MaxHPFactor = 0.125;
							BalanceFactor = 0.1;
						}
						else
						if (TrueGameSkill == SKILL_NORMAL)
						{
							AttackFactor = 0.25;
							DefenseFactor = -0.125;
							SpeedFactor = 0.125;
							MaxHPFactor = 0.25;
							BalanceFactor = 0.2;
						}
						else
						if (TrueGameSkill == SKILL_HARD)
						{
							AttackFactor = 0.375;
							DefenseFactor = -0.1875;
							SpeedFactor = 0.1875;
							MaxHPFactor = 0.375;
							BalanceFactor = 0.5;
						}
						else
						if (TrueGameSkill == SKILL_VERY_HARD)
						{
							AttackFactor = 0.5; 
							DefenseFactor = -0.25; 
							SpeedFactor = 0.25; 
							MaxHPFactor = 0.5; 
							BalanceFactor = 0.75;
						}
						else
						if (TrueGameSkill == SKILL_EXTREME)
						{
							AttackFactor = 0.625;
							DefenseFactor = -0.3125;
							SpeedFactor = 0.3125;
							MaxHPFactor = 0.625;
							BalanceFactor = 0.875;
						}
						else
						if (TrueGameSkill == SKILL_HORRIBLE)
						{
							AttackFactor = 0.75;
							DefenseFactor = -0.375;
							SpeedFactor = 0.375;
							MaxHPFactor = 0.75;
							BalanceFactor = 1.0;
						}
						else
						if (TrueGameSkill == SKILL_IMPOSSIBLE)
						{
							AttackFactor = 0.875;
							DefenseFactor = -0.4375;
							SpeedFactor = 0.4375;
							MaxHPFactor = 0.875;
							BalanceFactor = 1.125;
						}
						else
						if (TrueGameSkill >= SKILL_OMEGA)
						{
							AttackFactor = 1.0;
							DefenseFactor = -0.50;
							SpeedFactor = 0.50;
							MaxHPFactor = 1.00;
							BalanceFactor = 1.25;
						}
						if (ActorName == "ReaverNew") SpeedFactor *= 3.0;
						if (skilllevelcalctype == 0)
						{
							AttackFactor *= frandompick(1.5,1.75,1.75,2.0,2.0,2.0,2.0,2.0,2.0,2.25,2.25,2.5);
							DefenseFactor *= frandompick(1.5,1.75,1.75,2.0,2.0,2.0,2.0,2.0,2.0,2.25,2.25,2.5);
							SpeedFactor *= frandompick(1.5,1.75,1.75,2.0,2.0,2.0,2.0,2.0,2.0,2.25,2.25,2.5);
							MaxHPFactor *= frandompick(1.5,1.75,1.75,2.0,2.0,2.0,2.0,2.0,2.0,2.25,2.25,2.5);
							BalanceFactor *= frandompick(1.5,1.75,1.75,2.0,2.0,2.0,2.0,2.0,2.0,2.25,2.25,2.5);
						}
						else
						{
							AttackFactor *= frandompick(0.75,0.875,0.875,1.0,1.0,1.0,1.0,1.0,1.0,1.125,1.125,1.25);
							DefenseFactor *= frandompick(0.75,0.875,0.875,1.0,1.0,1.0,1.0,1.0,1.0,1.125,1.125,1.25);
							SpeedFactor *= frandompick(0.75,0.875,0.875,1.0,1.0,1.0,1.0,1.0,1.0,1.125,1.125,1.25);
							MaxHPFactor *= frandompick(0.75,0.875,0.875,1.0,1.0,1.0,1.0,1.0,1.0,1.125,1.125,1.25);
							BalanceFactor *= frandompick(0.75,0.875,0.875,1.0,1.0,1.0,1.0,1.0,1.0,1.125,1.125,1.25);
						}
						if (debugstatcalc) Console.Printf("\cgAttackFactor [Skill]: %.8f, \cdDefenseFactor [Skill]: %.8f, \chSpeedFactor [Skill]: %.8f, \caMaxHPFactor [Skill]: %.8f, \cpBalanceFactor [Skill]: %.8f", AttackFactor, DefenseFactor, SpeedFactor, MaxHPFactor, BalanceFactor);

						SpeedFactor *= dvds_monsterspeedratio_skill;
						SpeedFactor = clamp(SpeedFactor, -basemaxratio, basemaxratio);
						MSpeed *= (1.0 + SpeedFactor);
						Speed = MSpeed;
					
						AttackFactor *= dvds_monsterattackratio_skill;
						AttackFactor = clamp(AttackFactor, -basemaxratio, basemaxratio);
						Attack *= (1.0 + AttackFactor);
						DamageMultiply = Attack;
					
						DefenseFactor *= dvds_monsterdefenseratio_skill;
						DefenseFactor = clamp(DefenseFactor, -basemaxratio, basemaxratio);
						Defense *= (1.0 + DefenseFactor);
						//DamageFactor = Defense; 
					
						MaxHPFactor *= dvds_monstermaxhpratio_skill;
						MaxHPFactor = clamp(MaxHPFactor, -basemaxratio, basemaxratio);
						MaxHP *= (1.0 + MaxHPFactor);
					
						BalanceFactor *= dvds_monsterbalanceratio_skill;
						BalanceFactor = clamp(BalanceFactor, -basemaxratio, basemaxratio);
						Balance *= (1.0 + BalanceFactor);
						Mass = Balance;
					
						Attack = clamp(Attack, 0.0025, 40.00);
						Defense = clamp(Defense, 0.0025, 40.00);
						Balance = clamp(Balance, 1, 5000000);
						MaxHP = clamp(MaxHP, 1, 2147483647);
					
						if (debugstatcalc)
						{
							Console.Printf("\chSpeedFactor [Skill]: %.8f, Speed After Skill: %.8f (%.8f)", (1.0 + SpeedFactor), MSpeed, PreMSpeed);
							Console.Printf("\cgAttackFactor [Skill]: %.8f, Attack After Skill: %.8f (%.8f)", (1.0 + AttackFactor), Attack, PreAttack);
							Console.Printf("\cdDefenseFactor [Skill]: %.8f, Defense After Skill: %.8f (%.8f)", (1.0 + DefenseFactor), Defense, PreDefense);
							Console.Printf("\caMaxHPFactor [Skill]: %.8f, MaxHP After Skill: %d (%d)", (1.0 + MaxHPFactor), MaxHP, PreMaxHP);
							Console.Printf("\cpBalanceFactor [Skill]: %.8f, Balance After Skill: %d (%d)", (1.0 + BalanceFactor), Balance, PreBalance);
						}
					}
					//*************************************************
					//** Calculates Stats By Checking the Map Number **
					//*************************************************
					int MapChecker = 1;
					if (ModType == 0)
					{
						if (dvds_monsterstatcalc_maps) MapChecker = 1; else MapChecker = 0;
					}
					else MapChecker = 1;

					nonstatmonster = 0;
					if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
					if (MapChecker == 1 && nonstatmonster == 0) // Map-checking enabled
					{
						PreMSpeed = MSpeed;
						PreAttack = Attack; 
						PreDefense = Defense; 
						PreBalance = Balance; 
						PreMaxHP = MaxHP;
						if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
						{
							if (ClassicDoomType == 1 || ClassicDoomType == 2) // Doom 1 / Heretic [ExMx system]
							{
								if (mapdifficultytype == 0) MapCheck = level.levelnum;
								else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
								
								if (CallACS("MiscVarCheckDECORATE",259) > 0) 
								{
									if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
									else MapCheck += deathkingsmapcalcmod;
								}
								MapCheck += CallACS("MiscVarCheckDECORATE",53); // Map Inflation [Stats - Exact]
								MapCheck += CallACS("MiscVarCheckDECORATE",169); // Map Inflation [Overall - Exact]
								MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",2) / 100; // Map Inflation [Stats - Percentile]
								MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",5) / 100; // Map Inflation [Overall - Percentile]
								MapCheck = clamp(MapCheck, 1, 100);
						
								AttackFactor = 0.0;
								if (MapCheck > 1) AttackFactor += (0.02 * (MapCheck - 1));
								if (MapCheck > 2) AttackFactor += (0.001 * (MapCheck - 2));
								if (MapCheck >= 1 && MapCheck <= 10) AttackFactor *= 1.0125;
								if (MapCheck >= 11 && MapCheck <= 20) AttackFactor *= 1.025;
								if (MapCheck >= 21 && MapCheck <= 30) AttackFactor *= 1.0375;
								if (MapCheck >= 31 && MapCheck <= 40) AttackFactor *= 1.05;
								if (MapCheck >= 41 && MapCheck <= 50) AttackFactor *= 1.0625;
								if (MapCheck >= 51 && MapCheck <= 60) AttackFactor *= 1.075;
								if (MapCheck >= 61 && MapCheck <= 70) AttackFactor *= 1.0875;
								if (MapCheck >= 71 && MapCheck <= 80) AttackFactor *= 1.1;
								if (MapCheck >= 81 && MapCheck <= 90) AttackFactor *= 1.1125;
								if (MapCheck >= 91) AttackFactor *= 1.25;
						
								DefenseFactor = 1.0 / (AttackFactor + 1.0);
								DefenseFactor -= 1.0;
						
								SpeedFactor = AttackFactor / 3.2;
								if (ActorName == "ReaverNew") SpeedFactor *= 3.0;
						
								MaxHPFactor = AttackFactor;
						
								BalanceFactor = AttackFactor;
							}
							else // Doom 2 / Hexen / Strife / Doom64 / PSXDoom [MAPxx system]
							{
								if (mapdifficultytype == 0) MapCheck = level.levelnum;
								else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
								
								if (CallACS("MiscVarCheckDECORATE",259) > 0) 
								{
									if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
									else MapCheck += deathkingsmapcalcmod;
								}
								MapCheck += CallACS("MiscVarCheckDECORATE",53); // Map Inflation [Stats - Exact]
								MapCheck += CallACS("MiscVarCheckDECORATE",169); // Map Inflation [Overall - Exact]
								MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",2) / 100; // Map Inflation [Stats - Percentile]
								MapCheck = MapCheck * CallACS("MiscVarCheckDECORATE",5) / 100; // Map Inflation [Overall - Percentile]
								MapCheck = clamp(MapCheck, 1, 100);
						
								AttackFactor = 0.0;
								if (MapCheck > 1) AttackFactor += (0.025 * (MapCheck - 1));
						
								if (MapCheck >= 1 && MapCheck <= 6) AttackFactor *= 1.0125;
								if (MapCheck >= 7 && MapCheck <= 11) AttackFactor *= 1.025;
								if (MapCheck >= 12 && MapCheck <= 20) AttackFactor *= 1.0375;
								if (MapCheck == 31) AttackFactor *= 1.0375;
								if (MapCheck == 32) AttackFactor *= 1.0375;
								if (MapCheck >= 21 && MapCheck <= 30) AttackFactor *= 1.05;
								if (MapCheck >= 33 && MapCheck <= 40) AttackFactor *= 1.0625;
								if (MapCheck >= 41 && MapCheck <= 50) AttackFactor *= 1.075;
								if (MapCheck >= 51 && MapCheck <= 60) AttackFactor *= 1.0875;
								if (MapCheck >= 61 && MapCheck <= 70) AttackFactor *= 1.10;
								if (MapCheck >= 71 && MapCheck <= 80) AttackFactor *= 1.125;
								if (MapCheck >= 81 && MapCheck <= 90) AttackFactor *= 1.25;
								if (MapCheck >= 91) AttackFactor *= 1.375;
						
								DefenseFactor = 1.0 / (AttackFactor + 1.0); //(1.0 / (AttackFactor + 1.0)) - 1.0;
								DefenseFactor -= 1.0;
						
								SpeedFactor = AttackFactor / 3.2;
								if (ActorName == "ReaverNew") SpeedFactor *= 3.0;
						
								MaxHPFactor = AttackFactor;
						
								BalanceFactor = AttackFactor;
							}
						}

						nonstatmonster = 0;
						if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
						if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
						if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
						if (ModType == 1 && nonstatmonster == 0) // Deus Vult 1
						{
							MapCheck = level.levelnum;
							MapCheck = clamp(MapCheck, 1101, 1104);
					
							AttackFactor = 0.0;
							if (MapCheck == 1101) AttackFactor = 0.0; // MAP01 - Insurgents
							if (MapCheck == 1102) AttackFactor = 0.25; // MAP02 - Torture Chamber
							if (MapCheck == 1103) AttackFactor = 0.75; // MAP03 - Cathedral
							if (MapCheck == 1104) AttackFactor = 1.5; // MAP04 - End Of Days
					
							DefenseFactor = 1.0 / (AttackFactor + 1.0); //(1.0 / (AttackFactor + 1.0)) - 1.0;
							DefenseFactor -= 1.0;
					
							SpeedFactor = AttackFactor / 4.0;
							if (ActorName == "ReaverNew") SpeedFactor *= 3.0;
					
							MaxHPFactor = AttackFactor / 1.25;
					
							BalanceFactor = AttackFactor / 1.25;
						}
						
						if (ModType == 2 && (MonsterFamily != "PracticeTarget")) // Deus Vult 2
						{
							MapCheck = level.levelnum;
							MapCheck = clamp(MapCheck, 1201, 1212);
					
							// Earth-type Levels
							if (MapCheck == 1201) // MAP01 - Entryway Pass
							{
								AttackFactor = 0.0; DefenseFactor = 0.0; SpeedFactor = 0.0; MaxHPFactor = 0.0; BalanceFactor = 0.0;
							}
							else
							if (MapCheck == 1202) // MAP02 - Mutagen
							{
								AttackFactor = 0.03; DefenseFactor = -0.029126; SpeedFactor = 0.0075; MaxHPFactor = 0.06; BalanceFactor = 0.03;
							}
							else
							if (MapCheck == 1203) // MAP03 - Crouching Demon, Hidden Archvile
							{
								AttackFactor = 0.09; DefenseFactor = -0.082569; SpeedFactor = 0.0225; MaxHPFactor = 0.12; BalanceFactor = 0.09;
							}
							else
							if (MapCheck == 1204) // MAP04 - Minas Morgul
							{
								AttackFactor = 0.18; DefenseFactor = -0.152542; SpeedFactor = 0.045; MaxHPFactor = 0.19; BalanceFactor = 0.18;
							}
							else
							if (MapCheck == 1205) // MAP05 - Eagle's Nest
							{
								AttackFactor = 0.30; DefenseFactor = -0.230769; SpeedFactor = 0.075; MaxHPFactor = 0.26; BalanceFactor = 0.30;
							}
							else
							if (MapCheck == 1206) // MAP05S - The Manliest Level Ever
							{
								AttackFactor = 0.45; DefenseFactor = -0.310345; SpeedFactor = 0.1125; MaxHPFactor = 0.34; BalanceFactor = 0.45;
							}
							else
							if (MapCheck == 1207) // MAP06 - Stargate
							{
								AttackFactor = 0.63; DefenseFactor = -0.386503; SpeedFactor = 0.1575; MaxHPFactor = 0.42; BalanceFactor = 0.63;
							}
							else
							if (MapCheck == 1208) // MAP07 - The Desert Temple
							{
								AttackFactor = 0.84; DefenseFactor = -0.456522; SpeedFactor = 0.21; MaxHPFactor = 0.50; BalanceFactor = 0.84;
							}
							else
							// Hell Levels
							if (MapCheck == 1209) // MAP08 - The Unholy Cathedral
							{
								AttackFactor = 1.14; DefenseFactor = -0.53271; SpeedFactor = 0.285; MaxHPFactor = 0.77; BalanceFactor = 1.14;
							}
							else
							if (MapCheck == 1210) // DV2M09 - You Shall Not Pass!
							{
								AttackFactor = 1.53; DefenseFactor = -0.604743; SpeedFactor = 0.3825; MaxHPFactor = 1.09; BalanceFactor = 1.53;
							}
							else
							if (MapCheck == 1211) // DV2M10 - Hell's Vendetta
							{
								AttackFactor = 2.01; DefenseFactor = -0.667774; SpeedFactor = 0.5025; MaxHPFactor = 1.48; BalanceFactor = 2.01;
							}
							else
							if (MapCheck == 1212) // DV2M10B - attedneV s'lleH
							{
								AttackFactor = 2.58; DefenseFactor = -0.72067; SpeedFactor = 0.645; MaxHPFactor = 1.92; BalanceFactor = 2.58;
							}
							else
							if (MapCheck == 1214) // DV2M12 - "The Wings of The Maiar" [DVI combined level remake]
							{
								AttackFactor = 1.56; DefenseFactor = -0.609375; SpeedFactor = 0.39; MaxHPFactor = 1.41; BalanceFactor = 1.56;
							}
							else
							if (MapCheck == 1215) // DV2M10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)
							{
								AttackFactor = 2.58; DefenseFactor = -0.72067; SpeedFactor = 0.645; MaxHPFactor = 1.92; BalanceFactor = 2.58;
							}
						}
						if (debugstatcalc) Console.Printf("\cx[MAP] \czMapCheck: %d, \chSpeedFactor: %.8f, \cgAttackFactor: %.8f, \cdDefenseFactor: %.8f, \caMaxHPFactor: %.8f, \cpBalanceFactor: %.8f", MapCheck, SpeedFactor, AttackFactor, DefenseFactor, MaxHPFactor, BalanceFactor);

						SpeedFactor *= dvds_monsterspeedratio_maps;
						SpeedFactor = clamp(SpeedFactor, -basemaxratio, basemaxratio);
						MSpeed *= (1.0 + SpeedFactor);
						Speed = MSpeed;
					
						AttackFactor *= dvds_monsterattackratio_maps;
						AttackFactor = clamp(AttackFactor, -basemaxratio, basemaxratio);
						Attack *= (1.0 + AttackFactor);
						DamageMultiply = Attack;
					
						DefenseFactor *= dvds_monsterdefenseratio_maps;
						DefenseFactor = clamp(DefenseFactor, -basemaxratio, basemaxratio);
						Defense *= (1.0 + DefenseFactor);
						//DamageFactor = Defense;
					
						MaxHPFactor *= dvds_monstermaxhpratio_maps;
						MaxHPFactor = clamp(MaxHPFactor, -basemaxratio, basemaxratio);
						MaxHP *= (1.0 + MaxHPFactor);
					
						BalanceFactor *= dvds_monsterbalanceratio_maps;
						BalanceFactor = clamp(BalanceFactor, -basemaxratio, basemaxratio);
						Balance *= (1.0 + BalanceFactor);
						Mass = Balance;
					
						Attack = clamp(Attack, 0.0025, 40.00);
						Defense = clamp(Defense, 0.0025, 40.00);
						Balance = clamp(Balance, 1, 5000000);
						MaxHP = clamp(MaxHP, 1, 2147483647);

						if (debugstatcalc)
						{
							Console.Printf("\chSpeedFactor [MAP]: %.8f, Speed After Map: %.8f (%.8f)", (1.0 + SpeedFactor), MSpeed, PreMSpeed);
							Console.Printf("\cgAttackFactor [MAP]: %.8f, Attack After Map: %.8f (%.8f)", (1.0 + AttackFactor), Attack, PreAttack);
							Console.Printf("\cdDefenseFactor [MAP]: %.8f, Defense After Map: %.8f (%.8f)", (1.0 + DefenseFactor), Defense, PreDefense);
							Console.Printf("\caMaxHPFactor [MAP]: %.8f, MaxHP After Map: %d (%d)", (1.0 + MaxHPFactor), MaxHP, PreMaxHP);
							Console.Printf("\cpBalanceFactor [MAP]: %.8f, Balance After Map: %d (%d)", (1.0 + BalanceFactor), Balance, PreBalance);
						}
					}

					//*****************************************************************
					//** Calculates Stats [and Level] By Checking the Player's Level **
					//*****************************************************************
					int LevelErrorRange;
					double TempSkillBase = 0.00075;
					double TempSkillLevel = (TrueGameSkill * 0.25);
					double TempSkillBase2 = 0.00025;
					double LevelBaseMulti = 0.00225;
					LevelBaseMulti += ((TrueGameSkill * (TempSkillBase + ((TrueGameSkill + TempSkillLevel) * TempSkillBase2)))); 
					if (debugstatcalc) Console.Printf("\cyLevelBaseMulti: %.8f, TrueGameSkill: %d, TempSkillLevel: %.8f, TempSkillBase: %.8f, TempSkillBase2: %.8f", LevelBaseMulti, TrueGameSkill, TempSkillLevel, TempSkillBase, TempSkillBase2);
					LevelBaseMulti *= dvds_monsterlevelstatfactor;
					if (debugstatcalc) Console.Printf("\cyLevelBaseMulti: %.8f, dvds_monsterlevelstatfactor: %.8f", LevelBaseMulti, dvds_monsterlevelstatfactor);
				
					int LevelChecker = 1;
					int LevelDifficultyInflation = clamp(dvds_leveldifficultyinflation, -2000, 2000);
					int LevelDifficultyInflationPercent = clamp(dvds_leveldifficultyinflation2, -100, 2000);
				
					if (ModType == 0)
					{
						if (dvds_monsterstatcalc_levels) LevelChecker = 1; else LevelChecker = 0;
					}
					else LevelChecker = 1;
				
					nonstatmonster = 0;
					if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
					if (LevelChecker == 1 && nonstatmonster == 0)
					{
						PreMSpeed = MSpeed;
						PreAttack = Attack; 
						PreDefense = Defense; 
						PreBalance = Balance; 
						PreMaxHP = MaxHP;
						LevelCheck = user_presetleveladd; // Checks the "Preset" strength of a monster
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [PresetLevel Add]: %d (Add: %d)", LevelCheck, user_presetleveladd, user_presetlevelrand1, user_presetlevelrand2);

						LevelCheck += random(user_presetlevelrand1,user_presetlevelrand2); // Checks the "Preset" strength of a monster
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [PresetLevel Rand]: %d (Error: +%d to %d)", LevelCheck, user_presetlevelrand1, user_presetlevelrand2);

						LevelCheck += PlayerLevel;
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [PlayerLevel Check]: %d (PlayLvl: +%d)", LevelCheck, PlayerLevel);
				
						LevelCheck += user_ressurrectstr; // Checks the "Resurrect" strength of a monster [Clay Devils in TCOTD:A get stronger each time they resurrect]
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [ResurrectStr Check]: %d (ResStr: +%d)", LevelCheck, user_ressurrectstr);
			
						LevelCheck += LevelDifficultyInflation;
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [inflation-exact]: %d (Difficulty Inflation: +%d)", LevelCheck, LevelDifficultyInflation);
			
						LevelCheck = LevelCheck * (100 + LevelDifficultyInflationPercent) / 100;
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [inflation-percent]: %d (Percent: %d%)", LevelCheck, (100 + LevelDifficultyInflationPercent));
						
						LevelErrorRange = LevelCheck * 0.1667;
						if (LevelErrorRange < 1) LevelErrorRange = random(0,3);
						LevelCheck += random(-LevelErrorRange,LevelErrorRange);
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [error-range]: %d (Error Range: +-%d)", LevelCheck, LevelErrorRange);
						
						int PreviousLevelCheck = LevelCheck;
						if (ModType == 1) // DV1 [general]
						{
							LevelCheck += random(0,10);
						}
						else
						if (ModType == 2) // DV2 [general]
						{
							if (MapCheck >= 1209 && MapCheck <= 1215) // DV2's Hell Levels
							{
								LevelCheck += random(10,25);
							}
							else
							{
								LevelCheck += random(0,10);
							}
						}
						else // Normal Mode
						{
							// Specific Actors
							if (ActorName == "RebelNew" || ActorName == "Rebel1New" || ActorName == "Rebel2New" || ActorName == "Rebel3New" ||
							    ActorName == "Rebel4New" || ActorName == "Rebel5New" || ActorName == "Rebel6New") LevelCheck += random(-3,7);
					
							// Specific Monsters
							// Mini-Boss
							if (ActorName == "DSSpiderMastermind") LevelCheck += random(3,6);
							if (ActorName == "Demolisher") LevelCheck += random(3,6);
							if (ActorName == "DSCyberdemon") LevelCheck += random(3,6);
							if (ActorName == "Annihilator") LevelCheck += random(3,6);
							if (ActorName == "MaulotaurNew") LevelCheck += random(3,6);
					
							// Specific Bosses
							// Tier 1 Boss
							if (ActorName == "DSparilMountedNew") LevelCheck += random(9,18);
							if (ActorName == "FighterBossNew") LevelCheck += random(9,18);
							if (ActorName == "ClericBossNew") LevelCheck += random(9,18);
							if (ActorName == "MageBossNew") LevelCheck += random(9,18);
							if (ActorName == "ProgrammerNew") LevelCheck += random(9,18);
							if (ActorName == "StrifeBishopNew") LevelCheck += random(9,18);
							if (ActorName == "OracleNew") LevelCheck += random(9,18);
							if (ActorName == "Macil1New") LevelCheck += random(9,18);
							if (ActorName == "Macil2New") LevelCheck += random(9,18);
							if (ActorName == "LoremasterNew") LevelCheck += random(9,18);
							// Tier 2 Boss
							if (ActorName == "DSBossBrain") { LevelCheck += random(15,30); Thing_ChangeTID(0,1222); }
							if (ActorName == "AlienSpectre1New") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre2New") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre3New") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre4New") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre5New") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre1Model") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre2Model") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre3Model") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre4Model") LevelCheck += random(15,30);
							if (ActorName == "AlienSpectre5Model") LevelCheck += random(15,30);
							if (ActorName == "SourceGuardian") LevelCheck += random(15,30);
							if (ActorName == "NyarlathotepLesser") LevelCheck += random(15,30);
							// Tier 3 Boss
							if (ActorName == "DSparilUnmountedNew") LevelCheck += random(23,45);
							if (ActorName == "Zakachi") LevelCheck += random(23,45);
							if (ActorName == "KoraxNew") LevelCheck += random(23,45);
							if (ActorName == "ThamuzNew") LevelCheck += random(23,45);
							if (ActorName == "AvatarNew") LevelCheck += random(23,45);
							if (ActorName == "TchernobogNew") LevelCheck += random(23,45);
							if (ActorName == "AdolfHitlerDS") LevelCheck += random(23,45);
							if (ActorName == "DSMotherDemon64") LevelCheck += random(23,45);
							// Tier 4 Boss
							if (ActorName == "EntityBossNew") LevelCheck += random(37,75);
							if (ActorName == "EntitySecondNew") LevelCheck += random(37,75);
							if (ActorName == "PennywiseBoss") LevelCheck += random(37,75);
							if (ActorName == "Sauravatar") LevelCheck += random(37,75);
							if (ActorName == "TheSource") LevelCheck += random(37,75);
							// Tier 5 Boss
							if (ActorName == "EntityAscended") LevelCheck += random(75,112);
							if (ActorName == "Nyarlathotep") LevelCheck += random(75,112);
							// Oddball Tier Boss
							if (ActorName == "Benellus1DS") LevelCheck += random(37,75);
							if (ActorName == "Benellus2DS") LevelCheck += random(42,80);
							if (ActorName == "Benellus3DS") LevelCheck += random(47,85);
							if (ActorName == "Magmantis") LevelCheck += random(52,75);
							if (ActorName == "StarSpawn") LevelCheck += random(30,40);
							if (ActorName == "SpiderGod") LevelCheck += random(30,40);
							if (ActorName == "SpiderGodling") LevelCheck += random(15,20);
						}
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [actor-check: %s]: %d (Previous: %d)", ActorName, LevelCheck, PreviousLevelCheck);
	
						// Check if the actor is one of Strife's Peasents [and if so, cancel out most level additions and divide their level by 4]
						If (ActorName == "PeasantNew") IsAPeasent++;
						If (ActorName == "Peasant1New") IsAPeasent++;
						If (ActorName == "Peasant2New") IsAPeasent++;
						If (ActorName == "Peasant3New") IsAPeasent++;
						If (ActorName == "Peasant4New") IsAPeasent++;
						If (ActorName == "Peasant5New") IsAPeasent++;
						If (ActorName == "Peasant6New") IsAPeasent++;
						If (ActorName == "Peasant7New") IsAPeasent++;
						If (ActorName == "Peasant8New") IsAPeasent++;
						If (ActorName == "Peasant9New") IsAPeasent++;
						If (ActorName == "Peasant10New") IsAPeasent++;
						If (ActorName == "Peasant11New") IsAPeasent++;
						If (ActorName == "Peasant12New") IsAPeasent++;
						If (ActorName == "Peasant13New") IsAPeasent++;
						If (ActorName == "Peasant14New") IsAPeasent++;
						If (ActorName == "Peasant15New") IsAPeasent++;
						If (ActorName == "Peasant16New") IsAPeasent++;
						If (ActorName == "Peasant17New") IsAPeasent++;
						If (ActorName == "Peasant18New") IsAPeasent++;
						If (ActorName == "Peasant19New") IsAPeasent++;
						If (ActorName == "Peasant20New") IsAPeasent++;
						If (ActorName == "Peasant21New") IsAPeasent++;
						If (ActorName == "Peasant22New") IsAPeasent++;
						If (ActorName == "BeggarNew") IsAPeasent++;
						If (ActorName == "Beggar1New") IsAPeasent++;
						If (ActorName == "Beggar2New") IsAPeasent++;
						If (ActorName == "Beggar3New") IsAPeasent++;
						If (ActorName == "Beggar4New") IsAPeasent++;
						If (ActorName == "Beggar5New") IsAPeasent++;
						If (ActorName == "MerchantNew") IsAPeasent++;
						If (ActorName == "WeaponSmithNew") IsAPeasent++;
						If (ActorName == "BarKeepNew") IsAPeasent++;
						If (ActorName == "ArmorerNew") IsAPeasent++;
						If (ActorName == "MedicNew") IsAPeasent++;
						
						if (ActorName == "RebelNew") IsARebel++;
						if (ActorName == "Rebel1New") IsARebel++;
						if (ActorName == "Rebel2New") IsARebel++;
						if (ActorName == "Rebel3New") IsARebel++;
						if (ActorName == "Rebel4New") IsARebel++;
						if (ActorName == "Rebel5New") IsARebel++;
						if (ActorName == "Rebel6New") IsARebel++;
						
						If (IsAPeasent > 0) LevelCheck /= 4;
						else
						{
							if (random(1,10) <= 1)
							{
								if (random(1,10) <= 1)
								{
									if (random(1,10) <= 1)
									{
										if (ActorName == "ClayDevilNew") LevelCheck += random(8,12);
										else if (ActorName == "Skeleton") LevelCheck += random(16,24);
										else LevelCheck += random(64,96);
									}
									else
									{
										if (ActorName == "ClayDevilNew") LevelCheck += random(2,3);
										else if (ActorName == "Skeleton") LevelCheck += random(4,6);
										else LevelCheck += random(16,24);
									}
								}
								else
								{
									if (ActorName == "ClayDevilNew") LevelCheck += randompick(0,0,0,0,0,1);
									else if (ActorName == "Skeleton") LevelCheck += random(0,2);
									else LevelCheck += random(4,6);
								}
							}
							if (extraflags & 1) 
							{
								if (ActorName == "ClayDevilNew") LevelCheck *= 1.5;
								else if (ActorName == "Skeleton") LevelCheck *= 2;
								else LevelCheck *= 4; 
							} 
							else 
							{ 
								if (random(1,64) == 1) 
								{
									if (ActorName == "ClayDevilNew") LevelCheck *= 1.5;
									else if (ActorName == "Skeleton") LevelCheck *= 2;
									else LevelCheck *= 4; 
								}
							}
							if (extraflags & 2) 
							{
								if (ActorName == "ClayDevilNew") LevelCheck *= 1.5;
								else if (ActorName == "Skeleton") LevelCheck *= 2;
								else LevelCheck *= 4;
							}
						}
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [peasent-checking]: %d, (IsAPeasent: %d)", LevelCheck, IsAPeasent);
						
						PreviousLevelCheck = LevelCheck;
						LevelCheck = clamp(LevelCheck, 0, 2000);
						if (debugstatcalc) Console.Printf("\ckMonsterLevel [final calc]: %d (Previous: %d)", LevelCheck, PreviousLevelCheck);
						user_monsterlevel = user_lastmonsterlevel = LevelCheck;
						
						AttackFactor = 0.0;
						if (LevelCheck > 0) AttackFactor += (LevelBaseMulti * (LevelCheck));
				
						DefenseFactor = 1.0 / (AttackFactor + 1.0); //(1.0 / (AttackFactor + 1.0)) - 1.0;
						DefenseFactor -= 1.0;
				
						SpeedFactor = AttackFactor / 4.0;
						if (ActorName == "ReaverNew") SpeedFactor *= 3.0;
				
						MaxHPFactor = AttackFactor / 1.25;
				
						BalanceFactor = AttackFactor / 1.25;
				
						if (debugstatcalc) Console.Printf("\cgAttackFactor [MonLevel]: %.8f, \cdDefenseFactor [MonLevel]: %.8f, \chSpeedFactor [MonLevel]: %.8f, \caMaxHPFactor [MonLevel]: %.8f, \cpBalanceFactor [MonLevel]: %.8f", AttackFactor, DefenseFactor, SpeedFactor, MaxHPFactor, BalanceFactor);
						
						SpeedFactor *= dvds_monsterspeedratio_levels;
						SpeedFactor = clamp(SpeedFactor, -basemaxratio, basemaxratio);
						MSpeed *= (1.0 + SpeedFactor);
						Speed = MSpeed;
					
						AttackFactor *= dvds_monsterattackratio_levels;
						AttackFactor = clamp(AttackFactor, -basemaxratio, basemaxratio);
						Attack *= (1.0 + AttackFactor);
						DamageMultiply = Attack;
					
						DefenseFactor *= dvds_monsterdefenseratio_levels;
						DefenseFactor = clamp(DefenseFactor, -basemaxratio, basemaxratio);
						Defense *= (1.0 + DefenseFactor);
						//DamageFactor = Defense; 
					
						MaxHPFactor *= dvds_monstermaxhpratio_levels;
						MaxHPFactor = clamp(MaxHPFactor, -basemaxratio, basemaxratio);
						MaxHP *= (1.0 + MaxHPFactor);
					
						BalanceFactor *= dvds_monsterbalanceratio_levels;
						BalanceFactor = clamp(BalanceFactor, -basemaxratio, basemaxratio);
						Balance *= (1.0 + BalanceFactor);
						Mass = Balance;
					
						Attack = clamp(Attack, 0.0025, 40.00);
						Defense = clamp(Defense, 0.0025, 40.00);
						Balance = clamp(Balance, 1, 5000000);
						MaxHP = clamp(MaxHP, 1, 2147483647);
					
						if (debugstatcalc)
						{
							Console.Printf("\chSpeedFactor [LEVELS]: %.8f, Speed After Levels: %.8f (%.8f)", (1.0 + SpeedFactor), MSpeed, PreMSpeed);
							Console.Printf("\cgAttackFactor [LEVELS]: %.8f, Attack After Levels: %.8f (%.8f)", (1.0 + AttackFactor), Attack, PreAttack);
							Console.Printf("\cdDefenseFactor [LEVELS]: %.8f, Defense After Levels: %.8f (%.8f)", (1.0 + DefenseFactor), Defense, PreDefense);
							Console.Printf("\caMaxHPFactor [LEVELS]: %.8f, MaxHP After Levels: %d (%d)", (1.0 + MaxHPFactor), MaxHP, PreMaxHP);
							Console.Printf("\cpBalanceFactor [LEVELS]: %.8f, Balance After Levels: %d (%d)", (1.0 + BalanceFactor), Balance, PreBalance);
						}
					}
					
					//**********************************************
					//** Calculates Stats Based on Varience/Error **
					//**********************************************
					int ErrorChecker = 1;
					if (ModType == 0)
					{
						if (dvds_monsterstatcalc_varience > 0) ErrorChecker = 1; else ErrorChecker = 0;
					}
					else ErrorChecker = 1;
				
					nonstatmonster = 0;
					if (MonsterFamily == "PracticeTarget") nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin <= 0) nonstatmonster = 1;
					if (ActorName == "DSBossBrain" && BossEyeCheck <= 0) nonstatmonster = 1;
					if (ErrorChecker == 1 && nonstatmonster == 0)
					{
						PreMSpeed = MSpeed;
						PreAttack = Attack; 
						PreDefense = Defense; 
						PreBalance = Balance; 
						PreMaxHP = MaxHP;
						// HP Error
						double MaxHPErrorRange = (MaxHP * dvds_monstermaxhpvarience);
						MaxHP += random(-MaxHPErrorRange,MaxHPErrorRange);
						MaxHP = clamp(MaxHP, 1, 2147483647);
					
						double SpeedErrorRange = (MSpeed * dvds_monsterspeedvarience);
						MSpeed += frandom(-SpeedErrorRange,SpeedErrorRange);
						actorbasespeed = self.Speed = MSpeed; //Set's Final Speed values
					
						double AttackErrorRange = (Attack * dvds_monsterattackvarience);
						Attack += frandom(-AttackErrorRange,AttackErrorRange);
						DamageMultiply = Attack;
					
						double DefenseErrorRange = (Defense * dvds_monsterdefensevarience);
						Defense += frandom(-DefenseErrorRange,DefenseErrorRange);
						
						if (debugstatcalc) Console.Printf("DamageFactor [old]: %.8f", DamageFactor);
						DamageFactor *= Defense;
						if (debugstatcalc) Console.Printf("DamageFactor [new]: %.8f", DamageFactor);
					
						double BalanceErrorRange = (Balance * dvds_monsterbalancevarience);
						Balance += random(-BalanceErrorRange,BalanceErrorRange);
						Mass = Balance; 
					
						if (debugstatcalc) 
						{
							Console.Printf("\caMaxHP Error Range: %d, \chSpeed Error Range: %.8f, \cgAttack Error Range: %.8f, \cdDefense Error Range: %.8f, \cpBalance Error Range: %.8f", MaxHPErrorRange, SpeedErrorRange, AttackErrorRange, DefenseErrorRange, BalanceErrorRange);
							Console.Printf("\chSpeedFactor [ERROR]: %.8f, Speed After Error: %.8f (%.8f)", (1.0 + SpeedFactor), MSpeed, PreMSpeed);
							Console.Printf("\cgAttackFactor [ERROR]: %.8f, Attack After Error: %.8f (%.8f)", (1.0 + AttackFactor), Attack, PreAttack);
							Console.Printf("\cdDefenseFactor [ERROR]: %.8f, Defense After Error: %.8f (%.8f)", (1.0 + DefenseFactor), Defense, PreDefense);
							Console.Printf("\caMaxHPFactor [ERROR]: %.8f, MaxHP After Error: %d (%d)", (1.0 + MaxHPFactor), MaxHP, PreMaxHP);
							Console.Printf("\cpBalanceFactor [ERROR]: %.8f, Balance After Error: %d (%d)", (1.0 + BalanceFactor), Balance, PreBalance);
						}
					}
					
					//****************************
					//** Specialized Situations **
					//****************************
					// Strife Rebels
					if (ActorName == "RebelNew" || ActorName == "Rebel1New" || ActorName == "Rebel2New" || ActorName == "Rebel3New" ||
							 ActorName == "Rebel4New" || ActorName == "Rebel5New" || ActorName == "Rebel6New") IsARebel++;
					if (IsARebel > 0)
					{
						int OldMaxHP = MaxHP;
						// Rebels get an HP boost dependant on the Player's "Stamina" stat in Strife [to reflect them having undergone the process as the player does to "keep up"] :V
						MaxHP *= floor(1.0 + (StrifeStaminaLevel * 0.1));
						if (debugstatcalc) Console.Printf("\caPre Stamina Max HP: %d, \caPost Stamina Max HP: %d, \cgPlayer's Stamina Level: %d", OldMaxHP, MaxHP, StrifeStaminaLevel);

						string StaminaUpgradeItem = "StaminaUpgrade";
						StaminaUpgradeItem.AppendFormat("%d", StrifeStaminaLevel);
						A_SetInventory(StaminaUpgradeItem,1);
					
						string AccuracyUpgradeItem = "AccuracyUpgrade";
						AccuracyUpgradeItem.AppendFormat("%d", StrifeAccuracyLevel);
						A_SetInventory(AccuracyUpgradeItem,1);
					}
					
					//*******************************************************************
					//** Specialized Boss Options [D'Sparil/Korax/Spectres/Entity/etc] **
					//*******************************************************************
					int OldMaxHP = MaxHP;
					// Doom2
					if (ActorName == "DSBossBrain" && dvds_improvediconofsin && BossEyeCheck > 0)
					{
						MaxHP *= 8;
						if (debugstatcalc) Console.Printf("\caMaxHP (Icon of Sin): %d (%d)", MaxHP, OldMaxHP);
					}
				
					// DUMP3
					if (ActorName == "AdolfHitlerDS")
					{
						MaxHP *= 5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Hitler [DUMP3]): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "Benellus1DS")
					{
						MaxHP *= 5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Benellus 1 [DUMP3]): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "Benellus2DS")
					{
						MaxHP *= 5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Benellus 2 [DUMP3]): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "Benellus3DS")
					{
						MaxHP *= 4;
						if (debugstatcalc) Console.Printf("\caMaxHP (Benellus 3 [DUMP3]): %d (%d)", MaxHP, OldMaxHP);
					}
					// KDIZD
					if (ActorName == "Magmantis")
					{
						MaxHP *= 7;
						if (debugstatcalc) Console.Printf("\caMaxHP (Magmantis): %d (%d)", MaxHP, OldMaxHP);
					}
					// Unloved
					if (ActorName == "AvatarNew")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Avatar): %d (%d)", MaxHP, OldMaxHP);
					}
					// Doom 64 Retribution
					if (ActorName == "DSMotherDemon64")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Mother Demon): %d (%d)", MaxHP, OldMaxHP);
					}
					// TCOTD:A
					if (ActorName == "ThamuzNew")
					{
						MaxHP *= 1.5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Thamuz): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "TchernobogNew")
					{
						MaxHP *= 1.5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Tchernobog): %d (%d)", MaxHP, OldMaxHP);
					}
					// HTC II
					if (ActorName == "PennywiseBoss")
					{
						MaxHP *= 1.5;
						if (debugstatcalc) Console.Printf("\caMaxHP (Pennywise): %d (%d)", MaxHP, OldMaxHP);
					}
					// Strange Aeons
					if (ActorName == "Nyarlathotep" || ActorName == "NyarlathotepLesser")
					{
						MaxHP = (MaxHP * random(6,7)) / 4;
						if (debugstatcalc) Console.Printf("\caMaxHP (Nyarlathotep): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "StarSpawn")
					{
						MaxHP = (MaxHP * random(6,8)) / 5;
						if (debugstatcalc) Console.Printf("\caMaxHP (StarSpawn): %d (%d)", MaxHP, OldMaxHP);
					}
					// TUTNT
					if (ActorName == "SourceGuardian")
					{
						MaxHP = (MaxHP * random(4,5)) / 4;
						if (debugstatcalc) Console.Printf("\caMaxHP (Source Guardian [TUTNT]): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "TheSource")
					{
						MaxHP *= 4;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Source of All Evil [TUTNT]): %d (%d)", MaxHP, OldMaxHP);
					}
				
					// Strife
					if (ActorName == "ProgrammerNew")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Programmer): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "StrifeBishopNew")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Bishop): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "OracleNew")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Oracle): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "Macil1New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Macil1): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "Macil2New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Macil2): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "LoremasterNew")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Loremaster): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre1New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Programmer's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre2New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Bishop's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre3New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Oracle's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre4New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Macil's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre5New")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Loremaster's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre1Model")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Programmer's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre2Model")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Bishop's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre3Model")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Oracle's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre4Model")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Macil's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "AlienSpectre5Model")
					{
						MaxHP *= 16;
						if (debugstatcalc) Console.Printf("\caMaxHP (Loremaster's Spectre): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "EntityBossNew")
					{
						MaxHP *= 24;
						if (debugstatcalc) Console.Printf("\caMaxHP (The Entity): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "EntitySecondNew")
					{
						MaxHP *= 24;
						if (debugstatcalc) Console.Printf("\caMaxHP (Mini Entity): %d (%d)", MaxHP, OldMaxHP);
					}
					if (ActorName == "EntityAscended")
					{
						MaxHP *= 24;
						if (debugstatcalc) Console.Printf("\caMaxHP (ASCENDED Entity): %d (%d)", MaxHP, OldMaxHP);
					}
					
					Attack = clamp(Attack, 0.005, 20.00);
					Defense = clamp(Defense, 0.005, 20.00);
					MaxHP = clamp(MaxHP, 1, 2147483647);
					
					// Hexen Class Bosses
					if (GetClassName() == "ClericBossNew" || GetClassName() == "FighterBossNew" || GetClassName() == "MageBossNew")
					{
						if (multiplayer && !deathmatch)
						{
							if (!special1)
							{
								MaxHP *= 5;
								special1 = true;
							}
						}
					}
					
					//** Set's Final MaxHP and Current HP values **
					self.health = MaxHP;
					if (debugstatcalc) Console.Printf("\chFinal Speed: %.8f, \cgFinal Attack: %.8f, \cdFinal Defense: %.8f, \caFinal Max HP: %d, \cpFinal Balance: %d, \ck[Actor-Check: %s]", MSpeed, Attack, Defense, MaxHP, Balance, ActorName);
					
					user_MaxHP = MaxHP; 
					if (ActorName == "HeresiarchNew") Score = MaxHP;
					
					// Sets the monster's "Buff" level. The level it must fall below in order to gain it's unique buffs
					RangeVar = 0.375;
					if (TrueGameSkill <= SKILL_VERY_EASY) RangeVar = 0.250; // 25.0%
					if (TrueGameSkill == SKILL_EASY) RangeVar = 0.313; // 31.3%
					if (TrueGameSkill == SKILL_NORMAL) RangeVar = 0.375; // 37.5%
					if (TrueGameSkill == SKILL_HARD) RangeVar = 0.437; // 43.7%
					if (TrueGameSkill == SKILL_VERY_HARD) RangeVar = 0.500; // 50.0%
					if (TrueGameSkill == SKILL_EXTREME) RangeVar = 0.563; // 56.3%
					if (TrueGameSkill == SKILL_HORRIBLE) RangeVar = 0.625; // 62.5%
					if (TrueGameSkill == SKILL_IMPOSSIBLE) RangeVar = 0.687; // 68.7%
					if (TrueGameSkill >= SKILL_OMEGA) RangeVar = 0.750; // 75%
					Temp = MaxHP * RangeVar;
					Temp = Temp + 1;
					if (Temp < 2) Temp = 2;
					user_HPBuffRange = Temp;
					if (debugstatcalc) Console.Printf("user_HPBuffRange [%s]: %d", ActorName, user_HPBuffRange);

					// Sets the monster's "Desperation Buff" level. The level it must fall below in order to gain it's unique buffs
					RangeVar = 0.375;
					if (TrueGameSkill <= SKILL_VERY_EASY) RangeVar = 0.250; // 25.0%
					if (TrueGameSkill == SKILL_EASY) RangeVar = 0.313; // 31.3%
					if (TrueGameSkill == SKILL_NORMAL) RangeVar = 0.375; // 37.5%
					if (TrueGameSkill == SKILL_HARD) RangeVar = 0.437; // 43.7%
					if (TrueGameSkill == SKILL_VERY_HARD) RangeVar = 0.500; // 50.0%
					if (TrueGameSkill == SKILL_EXTREME) RangeVar = 0.563; // 56.3%
					if (TrueGameSkill == SKILL_HORRIBLE) RangeVar = 0.625; // 62.5%
					if (TrueGameSkill == SKILL_IMPOSSIBLE) RangeVar = 0.687; // 68.7%
					if (TrueGameSkill >= SKILL_OMEGA) RangeVar = 0.750; // 75%
					RangeVar /= 3;
					Temp = MaxHP * RangeVar;
					Temp = Temp + 1;
					if (Temp < 2) Temp = 2;
					user_HPLowBuffRange = Temp;
					if (debugstatcalc) Console.Printf("user_HPLowBuffRange [%s]: %d", ActorName, user_HPLowBuffRange);
					
					// Sets the monster's "Low Range" of HP, meaning there is a 25% chance it will execute a "crisis" attack
					RangeVar = 0.160;
					if (TrueGameSkill <= SKILL_VERY_EASY) RangeVar = 0.080; // 8.0%
					if (TrueGameSkill == SKILL_EASY) RangeVar = 0.120; // 12.0%
					if (TrueGameSkill == SKILL_NORMAL) RangeVar = 0.160; // 16.0%
					if (TrueGameSkill == SKILL_HARD) RangeVar = 0.200; // 20.0%
					if (TrueGameSkill == SKILL_VERY_HARD) RangeVar = 0.240; // 24.0%
					if (TrueGameSkill == SKILL_EXTREME) RangeVar = 0.320; // 32.0%
					if (TrueGameSkill == SKILL_HORRIBLE) RangeVar = 0.400; // 40.0%
					if (TrueGameSkill == SKILL_IMPOSSIBLE) RangeVar = 0.450; // 45.0%
					if (TrueGameSkill >= SKILL_OMEGA) RangeVar = 0.500; // 50%
					Temp = MaxHP * RangeVar;
					Temp = Temp + 1;
					if (Temp < 2) Temp = 2;
					user_HPLowRange = Temp;
					if (ActorName == "HeresiarchNew") Accuracy = Temp;
					if (debugstatcalc) Console.Printf("user_HPLowRange [%s]: %d", ActorName, user_HPLowRange);
					
					// Sets the monster's "Critical Range" of HP, meaning there is a 100% chance it will execute a "crisis" attack
					RangeVar = 20;
					if (TrueGameSkill <= SKILL_VERY_EASY) RangeVar = 0.010; // 1.0%
					if (TrueGameSkill == SKILL_EASY) RangeVar = 0.015; // 1.5%
					if (TrueGameSkill == SKILL_NORMAL) RangeVar = 0.020; // 2.0%
					if (TrueGameSkill == SKILL_HARD) RangeVar = 0.025; // 2.5%
					if (TrueGameSkill == SKILL_VERY_HARD) RangeVar = 0.030; // 3.0%
					if (TrueGameSkill == SKILL_EXTREME) RangeVar = 0.040; // 4.0%
					if (TrueGameSkill == SKILL_HORRIBLE) RangeVar = 0.050; // 5.0%
					if (TrueGameSkill == SKILL_IMPOSSIBLE) RangeVar = 0.060; // 6.0%
					if (TrueGameSkill >= SKILL_OMEGA) RangeVar = 0.080; // 8.0%
					Temp = MaxHP * RangeVar;
					Temp = Temp + 1;
					if (Temp < 2) Temp = 2;
					user_HPCritRange = Temp;
					if (ActorName == "HeresiarchNew") Stamina = Temp;
					if (debugstatcalc) Console.Printf("user_HPCritRange [%s]: %d", ActorName, user_HPCritRange);
					
					// Sets the monster's "Extreme Death" range of HP, determining how much it takes to gib most monsters (or permenantly kill a Death Incarnate)
					Temp = MaxHP * -1; // -100.0%
					if (Temp > 0) Temp = 0;
					user_HPXDeathRange = Temp;
					if (GetClassName() == "BloodZombieNew") user_HPXDeathRange2 = user_HPXDeathRange / 2;

					// Reaction Time
					basereactiontime = reactiontime;
					if (dvds_monsterstatcalc_reactiontime)
					{
						double reactdivfactor = 0.5;
						if (TrueGameSkill >= 0 && TrueGameSkill <= 1) reactdivfactor = 0.375;
						if (TrueGameSkill >= 2 && TrueGameSkill <= 3) reactdivfactor = 0.3125;
						if (TrueGameSkill >= 4 && TrueGameSkill <= 5) reactdivfactor = 0.25;
						if (TrueGameSkill >= 6 && TrueGameSkill <= 7) reactdivfactor = 0.1875;
						if (TrueGameSkill >= 8 && TrueGameSkill <= 9) reactdivfactor = 0.125;
						maxreactiontime = basereactiontime * reactdivfactor;
						if (maxreactiontime < 1) maxreactiontime = 1;
						levelsperreacttic = 300 / (basereactiontime - maxreactiontime);
						if (levelsperreacttic < 1) levelsperreacttic = 1;
						reactiontime -= (user_monsterlevel / levelsperreacttic);
						if (reactiontime < maxreactiontime) reactiontime = maxreactiontime;
						if (debugstatcalc) Console.Printf("\cy(%s)\c- \cxReactionTime: %d\c-, basereactiontime: %d, maxreactiontime: %d, level: %d (/ %d), reactdivfactor: %.8f", GetClassName(), reactiontime, basereactiontime, maxreactiontime, user_monsterlevel, levelsperreacttic, reactdivfactor);
					}

					user_legendaryevolved = 0;

					// Excutes Lifebar-Related Code
					ActorDisplayDMG = true;
					//ACS_NamedExecuteAlways("DamageDisplays",0,0,0,0);
					
				
					ActorLevelCalcs = true;
					user_checkmapskill += 1;
					if (bFRIENDLY) 
					{
						if (!(IsAPeasent || IsARebel))
						{
							Thing_ChangeTID(0,1000);
							//Console.Printf("ActorName: %s: TID set to 1000", ActorName);
						}
					}
				}
			}
		}
		else
		{
			if (!ActorLevelCalcs) { }
			else
			{
				if (user_checkmapskill < 1) { }
				else
				{
					if (bFRIENDLY) Thing_ChangeTID(0,0);
					self.speed = user_basespeed;
					self.mass = user_basemass;

					// Reaction Time
					reactiontime = basereactiontime;
					if (debugstatcalc) Console.Printf("\cy(%s)\c- \cxReactionTime: %d\c-, basereactiontime: %d", GetClassName(), reactiontime, basereactiontime);
				
					ActorDisplayDMG = false;
					ActorLevelCalcs = false;
					user_monsterlevel = 0;
					user_checkmapskill = 0;
					user_isstealth = 0;
				}
			}
		}
	}
	
	void A_AetheriusStats(int type)
	{
		int debugstatcalc = dvdsdebug_showstatcalcstuff;
		// 0 = Set special stats
		// 1 = Unset special stats
		int flagsbaselevel;
		levelbehavior = dvds_monsterlevelbehavior;
		if (type == 0 && !ActorLevelCalcs) 
		{
			if (debugstatcalc) Console.Printf("StatCalc type %d!", type);
			A_MonsterStatsHP_ATK_DEF_SPD(type);
			if (levelbehavior)
			{
				if (debugstatcalc) Console.Printf("Level %d!", user_monsterlevel);
				if (user_monsterlevel > AggressionLevelThreshold3) { bMISSILEEVENMORE = true; bMISSILEMORE = true; }
				else if (user_monsterlevel > AggressionLevelThreshold2) { bMISSILEEVENMORE = true; bMISSILEMORE = false; }
				else if (user_monsterlevel > AggressionLevelThreshold1) { bMISSILEEVENMORE = false; bMISSILEMORE = true; }
			}
			timesrevivedamonster = 0;
		}

		if (type != 0 && ActorLevelCalcs) 
		{
			if (debugstatcalc) Console.Printf("StatCalc type %d!", type);
			A_MonsterStatsHP_ATK_DEF_SPD(type);
		}
	}

	void A_GiveGold(int basegold)
	{
		int goldamt = CountInv("Coin",AAPTR_DEFAULT);
		user_golddrop = basegold;
		if (goldamt < 1) user_golddrop += goldamt;
		
		int LDLMulti = 2; // 2 = 100%
		if (user_legendaryevolved) LDLMulti = random(4,6);
		user_golddrop = (user_golddrop * LDLMulti) / 2;
		
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
		int extragold;
		int extragold2;
		int deftbonus;
		int bonuspart1;
		int bonuspart2;
		int bonusgold;
		int bonusgold2;
		int basecoins = user_golddrop;

		AetheriusPlayerPawn playpawn;
		if (target) playpawn = AetheriusPlayerPawn(target);
		if (playpawn)
		{
			if (clearofmind > 0)
			{
				bonuspart1 = clearofmind * 6;
				bonuspart1 = (bonuspart1 * LDLMulti) / 4;
				bonusgold = (100 + bonuspart1);
				user_golddrop = user_golddrop * (bonusgold) / 100;

				bonuspart2 = ((clearofmind * 8) / 5);
				bonuspart2 = (bonuspart2 * LDLMulti) / 4;
				extragold = bonuspart2 - 5;
				if (extragold < 0) extragold = 0;
				user_golddrop += extragold;
			}
			
			deftbonus = PlayerDFT / 4;
			deftbonus = (deftbonus * LDLMulti) / 4;
			bonusgold2 = (100 + deftbonus);
			user_golddrop = user_golddrop * (bonusgold2) / 100;

			extragold2 = PlayerDFT / 32;
			if (extragold < 0) extragold2 = 0;
			extragold2 = (extragold2 * LDLMulti) / 4;

			user_golddrop += extragold2;
		}
		int lowcap = (basegold / random(2,3));
		if (user_golddrop < lowcap) user_golddrop = lowcap;

		A_GiveToTarget("Coin",user_golddrop);
		A_TakeInventory("Coin",goldamt,0,AAPTR_DEFAULT);

		if (playpawn) 
		{
			if (dvdsdebug_coindropdisplays) Console.Printf("Gained \cy%d\c- [lowcap: %d] Coins! [bonusdft%: %d, extra2: %d, bonus%: %d, extra: %d, base2: %d, base1: %d, LDLMulti: \cx%d\c- / 2]", user_golddrop, lowcap, bonusgold2, extragold2, bonusgold, extragold, basecoins, basegold, LDLMulti);
																else Console.Printf("Gained %d Coins!", user_golddrop);
		}
	}

	void A_GetAccuracySpreads()
	{
		Console.Printf("ACCURACY: XY-: %.4f, XY+: %.4f, Z-: %.4f, Z+: %.4f", user_shotaccuracy1, user_shotaccuracy2, user_shotzaccuracy1, user_shotzaccuracy2);
	}

	void A_FastChaseCalc(int base = 3, int leveldivisor = 24)
	{
		if (levelbehavior) { user_fastchaseextra = user_monsterlevel / leveldivisor; }
		user_fastchasechance = base + user_fastchaseextra + user_painfastchase;
		if (dvdsdebug_monsterspecialaidisplays) Console.Printf("Class: %s - \czFastChaseChance: %d (base: %d, leveldivisor: %d)\cz", GetClassName(), user_fastchasechance, base, leveldivisor); 
	}

	// Attempts to mitigate floating-monsters from drifting too out of control when fast-chasing or damaged [like if they get kicked backwards]
	// by slowing them down gradually and then stopping them at a certain interval that won't reset until they get hurt again or they attempt 
	// to fast-chase.
	void A_FloatLook(int time = 16)
	{
		A_Look();
		user_fastchasetimer = time;
		user_painreacttimer = time;
	}

	void A_FloatPain(int settime = 0, int settime2 = 8, int settime2chance = 64, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		A_DVDSPain(type,value1,value2,value3,value4,value5,value6);
		if (random(1,256) <= settime2chance) user_painreacttimer = settime2; else user_painreacttimer = settime;
	}

	void A_FloatSetFChaseT(int time = 0)
	{
		user_fastchasetimer = time;
	}

	void A_FloatChaseCheck(int time1 = 4, int time2 = 8, int time3 = 12, int time4 = 16, double decelrate1 = 0.5, double decelrate2 = 0.5)
	{
		user_painreacttimer++;
		if (user_painreacttimer == time1) { A_ScaleVelocity(decelrate1); }
		if (user_painreacttimer == time2) { A_ScaleVelocity(decelrate1); }
		if (user_painreacttimer == time3) { A_ScaleVelocity(decelrate1); }
		if (user_painreacttimer == time4) { A_ScaleVelocity(0); A_Stop(); }
		if (dvdsdebug_monsterspecialaidisplays) 
		{ 
			if (user_painreacttimer == time1 || user_painreacttimer == time2 || user_painreacttimer == time3 || user_painreacttimer == time4) Console.Printf("Class: %s - \cxFloatPain-painreacttimer: %d\c-", GetClassName(), user_painreacttimer); 
		}
		
		user_fastchasetimer++;
		if (user_fastchasetimer == time1) { A_ScaleVelocity(decelrate2); }
		if (user_fastchasetimer == time2) { A_ScaleVelocity(decelrate2);}
		if (user_fastchasetimer == time3) { A_ScaleVelocity(decelrate2); }
		if (user_fastchasetimer == time4) { A_ScaleVelocity(0); A_Stop(); }
		if (dvdsdebug_monsterspecialaidisplays) 
		{ 
			if (user_fastchasetimer == time1 || user_fastchasetimer == time2 || user_fastchasetimer == time3 || user_fastchasetimer == time4) Console.Printf("Class: %s - \cwFloatChase-fastchasetimer: %d\c-", GetClassName(), user_fastchasetimer);
		}
		
	}

	void A_MonsterCrisisCheck()
	{
		user_canusecrisisatk = 0;
		if (health <= user_HPLowRange) { if (health <= user_HPCritRange) { user_canusecrisisatk = 1; } else { if (random(1,4) == 4) { user_canusecrisisatk = 1; } } }
		if (dvds_monstercrisisattacks == 0) { user_canusecrisisatk = 0; }
	}

	void A_CrisisExplode (int damage = 128, int radius = 128, int flags = 1, bool alert = false, int fulldmgradius = 0, int nails = 0, int naildamage = 10, string pufftype = "BulletPuff", string damagetype = "none", bool playcrisissound = true)
	{
		if (user_canusecrisisatk == 1) 
		{
			damage *= CrisisMultiplier; 
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
		}
		A_Explode(damage,radius,flags,alert,fulldmgradius,nails,naildamage,pufftype,damagetype);
	}

	void A_CrisisMushroom (string missiletype, string crisismissiletype, int amount = 0, int flags = 0, float vrange = 4.0, float hrange = 0.5, bool playcrisissound = true)
	{
		string atktype = missiletype;
		if (user_canusecrisisatk == 1) 
		{
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
			atktype = crisismissiletype;
		}
		A_MushRoom(atktype,amount,flags,vrange,hrange);
	}

	void A_CrisisSpawnProjectile (string missiletype, string crisismissiletype, float spawnheight = 32.0, float spawnofs_xy = 0.0, double angle = 0.0, int flags = 0, double pitch = 0.0, int ptr = AAPTR_TARGET, bool playcrisissound = true)
	{
		string atktype = missiletype;
		if (user_canusecrisisatk == 1) 
		{
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
			atktype = crisismissiletype;
		}

		if (flags & CMF_OFFSETPITCH) { if (flags & CMF_BADPITCH) flags &= ~CMF_BADPITCH; }
		
		A_SpawnProjectile(atktype,spawnheight,spawnofs_xy,angle,flags,pitch,ptr);
	}

	void A_CrisisRailgun(int damage, int spawnofs_xy = 0, color ringcolor = 0, color corecolor = 0, int flags = 0, int aim = 0, double maxdiff = 0, string pufftype = "", double spread_xy = 0.0, double spread_z = 0.0, int range = 8192, int duration = 35, double sparsity = 1.0, double driftspeed = 1.0, string spawnclass = "", double spawnofs_z = 0.0, int spiraloffset = 270, int limit = 0, double veleffect = 3.0, bool playcrisissound = true)
	{
		if (user_canusecrisisatk == 1) 
		{
			damage *= CrisisMultiplier; 
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
		}
		A_CustomRailgun(damage,spawnofs_xy,ringcolor,corecolor,flags,aim,maxdiff,pufftype,spread_xy,spread_z,range,duration,sparsity,driftspeed,spawnclass,spawnofs_z,spiraloffset,limit,veleffect);
	}
 
	void A_CrisisComboAttack (string missiletype, string crisismissiletype, float spawnheight = 32.0, int meleedamage = 0, string meleesound = "imp/melee", string damagetype = "Melee", bool bleed = 1, bool playcrisissound = true)
	{
		string atktype = missiletype;
		if (user_canusecrisisatk == 1) 
		{
			meleedamage *= CrisisMultiplier; 
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); }
			atktype = crisismissiletype;
		}
		A_CustomComboAttack(atktype,spawnheight,meleedamage,meleesound,damagetype,bleed);
	}

	void A_CrisisMeleeAttack (int meleedamage, string meleesound = "", string misssound = "", string damagetype = "Melee", bool bleed = 1, bool playcrisissound = true)
	{
		A_MonsterCrisisCheck();
		if (user_canusecrisisatk == 1) 
		{
			meleedamage *= CrisisMultiplier;
			if (playcrisissound == 1) A_PlayCrisisAtkSound();
		}
		A_CustomMeleeAttack(meleedamage,meleesound,misssound,damagetype,bleed);
	}
	
	void A_CrisisSpawnItemEx (string type = "", string crisistype = "", float xofs = 0.0, float yofs = 0.0, float zofs = 0.0, float xvel = 0.0, float yvel = 0.0, float zvel = 0.0, float angle = 0.0, int flags = 0, int failchance = 0, int tid = 0, bool playcrisissound = true)
	{
		string spawntype = type;
		if (user_canusecrisisatk == 1) 
		{
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); }
			spawntype = crisistype;
		}
		A_SpawnItemEx(spawntype,xofs,yofs,zofs,xvel,yvel,zvel,angle,flags,failchance,tid);
	}
	
	// Shielding Blasted/Vel Factor (makes shielding enemies who've been blasted slow down and occasionally can clear the BLASTED flag)
	void A_ShieldBlastVelFactor(double xmul = 0.5, double ymul = 0.5, int maxunblastchance = 16, int unblastchance = 1)
	{
		xmul = clamp(xmul, 0.0, 1.0);
		ymul = clamp(ymul, 0.0, 1.0);
		if (bBLASTED && (vel.x != 0.0 || vel.y != 0.0))
		{
			vel.x *= xmul;
			vel.y *= ymul;
			if (random(1,maxunblastchance) <= unblastchance) 
			{
				bBLASTED = false;
			}
			else
			{
				if ((vel.x >= -0.125 && vel.x <= 0.125) && (vel.y >= -0.125 && vel.y <= 0.125)) bBLASTED = false;
			}
		}
	}
	
	// Shielding Imp Warlord
	void A_ImpWarShieldOff()
	{
		bNOBLOOD = 0; bNOPAIN = 0;
		A_SetInventory("ImpWarlordShieldDefend",0); // A_UnSetInvulnerable
		A_SetInventory("ImpWarlordShieldDefendExtra",0);
	}

	void A_ImpWarShieldOn()
	{
		bNOPAIN = 1; bNOBLOOD = 1;
		A_SetInventory("ImpWarlordShieldDefend",1); // A_SetInvulnerable
		A_SetInventory("ImpWarlordShieldDefendExtra",0);
		A_ShieldBlastVelFactor(0.8375,0.8375,24,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("ImpWarlordShieldDefendExtra",1); 
			A_ShieldBlastVelFactor(0.8375,0.8375,6,1);
		} 
	}

	// Shielding Death Knight
	void A_DeathKnightShieldOff()
	{
		user_defendtimer = 0; user_defendcycles = 0;
		bNOBLOOD = 0; bNOPAIN = 0; bREFLECTIVE = 0;
		A_SetInventory("DKnightShieldDefend",0); // A_UnSetInvulnerable
		A_SetInventory("DKnightShieldDefendExtra",0);
	}

	void A_DeathKnightShieldOn()
	{
		bNOBLOOD = 1; bNOPAIN = 1; bREFLECTIVE = 1;
		A_SetInventory("DKnightShieldDefend",1); // A_SetInvulnerable
		A_SetInventory("DKnightShieldDefendExtra",0);
		A_ShieldBlastVelFactor(0.6875,0.6875,20,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("DKnightShieldDefendExtra",1); 
			A_ShieldBlastVelFactor(0.6875,0.6875,5,1);
		} 
	}
	
	// Shielding Acolytes
	void A_AcolyteShieldOff()
	{
		bNOBLOOD = 0; bNOPAIN = 0;
		A_SetInventory("AcolyteShieldDefend",0); // A_UnSetInvulnerable
		A_SetInventory("AcolyteShieldDefendExtra",0);
	}

	void A_AcolyteShieldOn()
	{
		if (random(1,2) == 1) { bNOPAIN = 1; bNOBLOOD = 1; } else { bNOPAIN = 0; bNOBLOOD = 0; }
		A_SetInventory("AcolyteShieldDefend",1); // A_SetInvulnerable
		A_SetInventory("AcolyteShieldDefendExtra",0);
		A_ShieldBlastVelFactor(0.8375,0.8375,24,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("AcolyteShieldDefendExtra",1); 
			A_ShieldBlastVelFactor(0.8375,0.8375,6,1);
		}
	}
 
	// Shielding Centaur
	void A_CentaurShieldOff()
	{
		user_defendtimer = 0; user_defendcycles = 0;
		bNOBLOOD = 0; bNOPAIN = 0; bREFLECTIVE = 0;
		A_SetInventory("CentaurShieldDefend",0); // A_UnSetInvulnerable
		A_SetInventory("CentaurShieldDefendExtra",0);
	}

	void A_CentaurShieldOn()
	{
		bNOBLOOD = 1; bNOPAIN = 1; bREFLECTIVE = 1;
		A_SetInventory("CentaurShieldDefend",1); // A_SetInvulnerable
		A_SetInventory("CentaurShieldDefendExtra",0);
		A_ShieldBlastVelFactor(0.5,0.5,16,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("CentaurShieldDefendExtra",1); 
			A_ShieldBlastVelFactor(0.5,0.5,4,1);
		} 
	}

	// Shielding Slaughtaur
	void A_SlaughtaurShieldOff()
	{
		user_defendtimer = 0; user_defendcycles = 0;
		bNOBLOOD = 0; bNOPAIN = 0; bREFLECTIVE = 0;
		A_SetInventory("SlaughtaurShieldDefend",0); // A_UnSetInvulnerable
		A_SetInventory("SlaughtaurShieldDefendExtra",0);
	}

	void A_SlaughtaurShieldOn()
	{
		bNOBLOOD = 1; bNOPAIN = 1; bREFLECTIVE = 1;
		A_SetInventory("SlaughtaurShieldDefend",1); // A_SetInvulnerable
		A_SetInventory("SlaughtaurShieldDefendExtra",0);
		A_ShieldBlastVelFactor(0.5,0.5,16,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("SlaughtaurShieldDefendExtra",1); 
			A_ShieldBlastVelFactor(0.5,0.5,4,1);
		}
	}

	// Shielding Hell Warrior
	void A_HellWarShieldOff()
	{
		bNOBLOOD = 0; bNOPAIN = 0; bREFLECTIVE = 0;
		A_SetInventory("HWShieldDefense",0); // A_UnSetInvulnerable
		A_SetInventory("HWShieldDefenseExtra",0);
	}

	void A_HellWarShieldOn()
	{
		bNOBLOOD = 1; bNOPAIN = 1; bREFLECTIVE = 1;
		A_SetInventory("HWShieldDefense",1); // A_SetInvulnerable
		A_SetInventory("HWShieldDefenseExtra",0);
		A_ShieldBlastVelFactor(0.5,0.5,16,1);

		if (random(1,4) == 1) 
		{
			A_SetInventory("HWShieldDefenseExtra",1); 
			A_ShieldBlastVelFactor(0.5,0.5,4,1);
		}
	}

	// Nightmare Stuff
	void A_NightmarePhaseOut()
	{
		bSHOOTABLE = 0; bNORADIUSDMG = 1; bNOPAIN = 1; bNOBLOOD = 1; 
		A_UnSetShootable();
		A_SetInventory("NightmarePhaseOutDefense",1); // A_SetInvulnerable
	}

	void A_NightmarePhaseIn()
	{
		bSHOOTABLE = 1; bNORADIUSDMG = 0; bNOPAIN = 0; bNOBLOOD = 0; 
		A_SetShootable();
		A_SetInventory("NightmarePhaseOutDefense",0); // A_SetInvulnerable
	}

	int A_GetExpMultiFactor()
	{
		int debugexp = dvdsdebug_showexpdebugstuff;
		int PlayerLevel = CallACS("StatCheck",0);

		int ExpMultiFactor, MapCheck, Exp2;
		int deathkingsmapcalcmod = dvds_deathkingsmapcalcmod;
		int mapcalcfactorexact = 0;
		int mapcalcfactorpercent = 100;
		
		int mapdifficultytype = dvds_mapdifficultytype;

		int mapdifficultyinflationEXP = clamp(dvds_mapdifficultyinflationEXP, -50, 50);
		int mapdifficultyinflationOVERALL = clamp(dvds_mapdifficultyinflationOVERALL, -50, 50);
		int mapdifficultyinflationEXP2 = clamp(dvds_mapdifficultyinflationEXP2, 1, 5000);
		int mapdifficultyinflationOVERALL2 = clamp(dvds_mapdifficultyinflationOVERALL2, 1, 5000);

		// Gets the Experience Multiplication Factor [Part 1]
		ExpMultiFactor = randompick(15,25) * 5;
		double basemultiextra = 0.025;
		if (PlayerLevel < 50) ExpMultiFactor += (PlayerLevel * (1.0 + basemultiextra));
		else
		{
			if (PlayerLevel < 100) ExpMultiFactor += (PlayerLevel * (1.0 + (basemultiextra * 1.25)));
			else
			{
				if (PlayerLevel < 150) ExpMultiFactor += (PlayerLevel * (1.0 + (basemultiextra * 1.5)));
				else
				{
					ExpMultiFactor += (PlayerLevel * (1.0 + (basemultiextra * 2)));
				}
			}
		}
		
		// Gets the Experience Multiplication Factor [Part 2]
		MapCheck = level.levelnum;
		double TempExp2;
		double TempExp3;
		double MapCheckFactor = 1.0;
		if (ModType == 0) // Classic Doom 1/2 / Heretic / Hexen / Strife
		{
			if (ClassicDoomType == 1 || ClassicDoomType == 2) // Classic Doom 1 or Heretic
			{
				if (mapdifficultytype == 0) MapCheck = level.levelnum;
				else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
				
				if (MapCheck != 1000 || MapCheck != 1010)
				{
					if (CallACS("MiscVarCheckDECORATE",259) > 0) 
					{
						if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
						else MapCheck += deathkingsmapcalcmod;
					}
					MapCheck += mapdifficultyinflationEXP; // Map Inflation [EXP - Exact]
					MapCheck += mapdifficultyinflationOVERALL; // Map Inflation [Overall - Exact]
					MapCheck = MapCheck * mapdifficultyinflationEXP2 / 100; // Map Inflation [EXP - Percentile]
					MapCheck = MapCheck * mapdifficultyinflationOVERALL2 / 100; // Map Inflation [Overall - Percentile]
					MapCheck = clamp(MapCheck, 1, 100);
				}
				// Episode 1
				if (MapCheck <= 1) TempExp2 = 0.00; 
				if (MapCheck == 2) TempExp2 = 0.010;
				if (MapCheck == 3) TempExp2 = 0.020;
				if (MapCheck == 4) TempExp2 = 0.030;
				if (MapCheck == 5) TempExp2 = 0.040;
				if (MapCheck == 6) TempExp2 = 0.050;
				if (MapCheck == 7) TempExp2 = 0.060;
				if (MapCheck == 8) TempExp2 = 0.070;
				if (MapCheck == 9) TempExp2 = 0.080;
				if (MapCheck == 10) TempExp2 = 0.090;
				// Episode 2
				if (MapCheck == 11) TempExp2 = 0.1125;
				if (MapCheck == 12) TempExp2 = 0.125; 
				if (MapCheck == 13) TempExp2 = 0.1375;
				if (MapCheck == 14) TempExp2 = 0.150; 
				if (MapCheck == 15) TempExp2 = 0.1625;
				if (MapCheck == 16) TempExp2 = 0.175; 
				if (MapCheck == 17) TempExp2 = 0.1875;
				if (MapCheck == 18) TempExp2 = 0.200; 
				if (MapCheck == 19) TempExp2 = 0.2125;
				if (MapCheck == 20) TempExp2 = 0.25; 
				// Episode 3
				if (MapCheck == 21) TempExp2 = 0.275; 
				if (MapCheck == 22) TempExp2 = 0.300; 
				if (MapCheck == 23) TempExp2 = 0.325; 
				if (MapCheck == 24) TempExp2 = 0.350; 
				if (MapCheck == 25) TempExp2 = 0.375; 
				if (MapCheck == 26) TempExp2 = 0.400; 
				if (MapCheck == 27) TempExp2 = 0.425; 
				if (MapCheck == 28) TempExp2 = 0.450; 
				if (MapCheck == 29) TempExp2 = 0.475; 
				if (MapCheck == 30) TempExp2 = 0.500;
				// Episode 4
				if (MapCheck == 31) TempExp2 = 0.550;
				if (MapCheck == 32) TempExp2 = 0.600;
				if (MapCheck == 33) TempExp2 = 0.650;
				if (MapCheck == 34) TempExp2 = 0.700;
				if (MapCheck == 35) TempExp2 = 0.750;
				if (MapCheck == 36) TempExp2 = 0.800;
				if (MapCheck == 37) TempExp2 = 0.850;
				if (MapCheck == 38) TempExp2 = 0.900;
				if (MapCheck == 39) TempExp2 = 0.950;
				if (MapCheck == 40) TempExp2 = 1.000;
				// Episode 5
				if (MapCheck == 41) TempExp2 = 1.125;
				if (MapCheck == 42) TempExp2 = 1.200;
				if (MapCheck == 43) TempExp2 = 1.275;
				if (MapCheck == 44) TempExp2 = 1.350;
				if (MapCheck == 45) TempExp2 = 1.425;
				if (MapCheck == 46) TempExp2 = 1.500;
				if (MapCheck == 47) TempExp2 = 1.575;
				if (MapCheck == 48) TempExp2 = 1.650;
				if (MapCheck == 49) TempExp2 = 1.725;
				if (MapCheck == 50) TempExp2 = 1.850;
				// Episode 6
				if (MapCheck == 51) TempExp2 = 2.000;
				if (MapCheck == 52) TempExp2 = 2.100;
				if (MapCheck == 53) TempExp2 = 2.200;
				if (MapCheck == 54) TempExp2 = 2.800;
				if (MapCheck == 55) TempExp2 = 2.900;
				if (MapCheck == 56) TempExp2 = 2.300;
				if (MapCheck == 57) TempExp2 = 2.400;
				if (MapCheck == 58) TempExp2 = 2.500;
				if (MapCheck == 59) TempExp2 = 2.600;
				if (MapCheck == 60) TempExp2 = 2.700;
				// Episode 7
				if (MapCheck == 61) TempExp2 = 3.000;
				if (MapCheck == 62) TempExp2 = 3.125;
				if (MapCheck == 63) TempExp2 = 3.250;
				if (MapCheck == 64) TempExp2 = 3.375;
				if (MapCheck == 65) TempExp2 = 3.500;
				if (MapCheck == 66) TempExp2 = 3.625;
				if (MapCheck == 67) TempExp2 = 3.750;
				if (MapCheck == 68) TempExp2 = 3.875;
				if (MapCheck == 69) TempExp2 = 4.000;
				if (MapCheck == 70) TempExp2 = 4.125;
				// Episode 8
				if (MapCheck == 71) TempExp2 = 4.250;
				if (MapCheck == 72) TempExp2 = 4.400;
				if (MapCheck == 73) TempExp2 = 4.550;
				if (MapCheck == 74) TempExp2 = 4.700;
				if (MapCheck == 75) TempExp2 = 4.850;
				if (MapCheck == 76) TempExp2 = 5.000;
				if (MapCheck == 77) TempExp2 = 5.150;
				if (MapCheck == 78) TempExp2 = 5.300;
				if (MapCheck == 79) TempExp2 = 5.450;
				if (MapCheck == 80) TempExp2 = 5.600;
				// Episode 9
				if (MapCheck == 81) TempExp2 = 5.900;
				if (MapCheck == 82) TempExp2 = 6.075;
				if (MapCheck == 83) TempExp2 = 6.250;
				if (MapCheck == 84) TempExp2 = 6.425;
				if (MapCheck == 85) TempExp2 = 6.600;
				if (MapCheck == 86) TempExp2 = 6.775;
				if (MapCheck == 87) TempExp2 = 6.950;
				if (MapCheck == 88) TempExp2 = 7.125;
				if (MapCheck == 89) TempExp2 = 7.300;
				if (MapCheck == 90) TempExp2 = 7.475;
				// Episode 10
				if (MapCheck == 91) TempExp2 = 7.650;
				if (MapCheck == 92) TempExp2 = 7.850;
				if (MapCheck == 93) TempExp2 = 8.050;
				if (MapCheck == 94) TempExp2 = 8.250;
				if (MapCheck == 95) TempExp2 = 8.450;
				if (MapCheck == 96) TempExp2 = 8.650;
				if (MapCheck == 97) TempExp2 = 8.850;
				if (MapCheck == 98) TempExp2 = 9.050;
				if (MapCheck == 99) TempExp2 = 9.250;
				if (MapCheck >= 100) TempExp2 = 9.450;
				TempExp2 *= 1.0;
				MapCheckFactor = 1.0;
				Exp2 = (MapCheck * MapCheckFactor) * (1.0 + TempExp2);
				
							if (MapCheck == 9) TempExp3 = 0.50;
				else if (MapCheck == 19) TempExp3 = 0.75;
				else if (MapCheck == 29) TempExp3 = 1.00;
				else if (MapCheck == 39) TempExp3 = 1.25;
				else if (MapCheck == 49) TempExp3 = 1.50;
				else if (MapCheck == 59) TempExp3 = 1.75;
				else if (MapCheck == 69) TempExp3 = 2.00;
				else if (MapCheck == 79) TempExp3 = 2.25;
				else if (MapCheck == 89) TempExp3 = 2.50;
				else if (MapCheck == 99) TempExp3 = 2.75;
														else TempExp3 = 0.25;
				TempExp3 *= 1.0;
				Exp2 *= (1.0 + TempExp3);

				if (MapCheck == 1000) Exp2 = 0; // E1M0 [Classic Doom 1]
				if (MapCheck == 1010) Exp2 = 0; // E1MA [Heretic]
			}
			else // Classic Doom 2 / Hexen / Strife / Doom64 / PSXDoom
			{
				if (mapdifficultytype == 0) MapCheck = level.levelnum;
				else MapCheck = CallACS("MiscVarCheckDECORATE",1000);
				
				if (MapCheck != 1050 || MapCheck != 1020 || MapCheck != 1030 || MapCheck != 1036 || MapCheck != 1037 || MapCheck != 1038 || MapCheck != 1039)
				{
					if (CallACS("MiscVarCheckDECORATE",259) > 0) 
					{
						if (mapdifficultytype == 0) MapCheck += (40 + deathkingsmapcalcmod);
						else MapCheck += deathkingsmapcalcmod;
					}
					MapCheck += mapdifficultyinflationEXP; // Map Inflation [EXP - Exact]
					MapCheck += mapdifficultyinflationOVERALL; // Map Inflation [Overall - Exact]
					MapCheck = MapCheck * mapdifficultyinflationEXP2 / 100; // Map Inflation [EXP - Percentile]
					MapCheck = MapCheck * mapdifficultyinflationOVERALL2 / 100; // Map Inflation [Overall - Percentile]
					MapCheck = clamp(MapCheck, 1, 100);
				}
				// Main Game
				if (MapCheck <= 1) TempExp2 = 0.000;
				if (MapCheck == 2) TempExp2 = 0.0125;
				if (MapCheck == 3) TempExp2 = 0.025;
				if (MapCheck == 4) TempExp2 = 0.0375;
				if (MapCheck == 5) TempExp2 = 0.050;
		
				if (MapCheck == 6) TempExp2 = 0.069;
				if (MapCheck == 7) TempExp2 = 0.088;
				if (MapCheck == 8) TempExp2 = 0.107;
				if (MapCheck == 9) TempExp2 = 0.125;
				if (MapCheck == 10) TempExp2 = 0.144;
		
				if (MapCheck == 11) TempExp2 = 0.169;
				if (MapCheck == 12) TempExp2 = 0.194;
				if (MapCheck == 13) TempExp2 = 0.219;
				if (MapCheck == 14) TempExp2 = 0.244;
				if (MapCheck == 15) TempExp2 = 0.269;
		
				if (MapCheck == 31) TempExp2 = 0.519;
				if (MapCheck == 32) TempExp2 = 1.019;
		
				if (MapCheck == 16) TempExp2 = 0.300;
				if (MapCheck == 17) TempExp2 = 0.331;
				if (MapCheck == 18) TempExp2 = 0.363;
				if (MapCheck == 19) TempExp2 = 0.394;
				if (MapCheck == 20) TempExp2 = 0.425;
		
				if (MapCheck == 21) TempExp2 = 0.475;
				if (MapCheck == 22) TempExp2 = 0.525;
				if (MapCheck == 23) TempExp2 = 0.575;
				if (MapCheck == 24) TempExp2 = 0.625;
				if (MapCheck == 25) TempExp2 = 0.675;

				if (MapCheck == 26) TempExp2 = 0.743;
				if (MapCheck == 27) TempExp2 = 0.819;
				if (MapCheck == 28) TempExp2 = 0.900;
				if (MapCheck == 29) TempExp2 = 0.998;
				if (MapCheck == 30) TempExp2 = 1.688;

				if (MapCheck == 33) TempExp2 = 1.170;
				if (MapCheck == 34) TempExp2 = 1.270;
				if (MapCheck == 35) TempExp2 = 1.371;
				if (MapCheck == 36) TempExp2 = 1.473;
				if (MapCheck == 37) TempExp2 = 1.576;
				if (MapCheck == 38) TempExp2 = 1.680;
				if (MapCheck == 39) TempExp2 = 1.785;
				if (MapCheck == 40) TempExp2 = 1.891;

				if (MapCheck == 41) TempExp2 = 2.000;
				if (MapCheck == 42) TempExp2 = 2.102;
				if (MapCheck == 43) TempExp2 = 2.206;
				if (MapCheck == 44) TempExp2 = 2.312;
				if (MapCheck == 45) TempExp2 = 2.420;
				if (MapCheck == 46) TempExp2 = 2.530;
				if (MapCheck == 47) TempExp2 = 2.642;
				if (MapCheck == 48) TempExp2 = 2.756;
				if (MapCheck == 49) TempExp2 = 2.872;
				if (MapCheck == 50) TempExp2 = 2.992;

				if (MapCheck == 51) TempExp2 = 3.100;
				if (MapCheck == 52) TempExp2 = 3.204;
				if (MapCheck == 53) TempExp2 = 3.312;
				if (MapCheck == 54) TempExp2 = 3.424;
				if (MapCheck == 55) TempExp2 = 3.540;
				if (MapCheck == 56) TempExp2 = 3.660;
				if (MapCheck == 57) TempExp2 = 3.784;
				if (MapCheck == 58) TempExp2 = 3.902;
				if (MapCheck == 59) TempExp2 = 4.034;
				if (MapCheck == 60) TempExp2 = 4.170;

				if (MapCheck == 61) TempExp2 = 4.200;
				if (MapCheck == 62) TempExp2 = 4.304;
				if (MapCheck == 63) TempExp2 = 4.412;
				if (MapCheck == 64) TempExp2 = 4.524;
				if (MapCheck == 65) TempExp2 = 4.640;
				if (MapCheck == 66) TempExp2 = 4.760;
				if (MapCheck == 67) TempExp2 = 4.884;
				if (MapCheck == 68) TempExp2 = 5.002;
				if (MapCheck == 69) TempExp2 = 5.134;
				if (MapCheck == 70) TempExp2 = 5.270;

				if (MapCheck == 71) TempExp2 = 5.400;
				if (MapCheck == 72) TempExp2 = 5.504;
				if (MapCheck == 73) TempExp2 = 5.612;
				if (MapCheck == 74) TempExp2 = 5.724;
				if (MapCheck == 75) TempExp2 = 5.840;
				if (MapCheck == 76) TempExp2 = 5.960;
				if (MapCheck == 77) TempExp2 = 6.084;
				if (MapCheck == 78) TempExp2 = 6.212;
				if (MapCheck == 79) TempExp2 = 6.344;
				if (MapCheck == 80) TempExp2 = 6.480;

				if (MapCheck == 81) TempExp2 = 6.600;
				if (MapCheck == 82) TempExp2 = 6.744;
				if (MapCheck == 83) TempExp2 = 6.892;
				if (MapCheck == 84) TempExp2 = 7.044;
				if (MapCheck == 85) TempExp2 = 7.200;
				if (MapCheck == 86) TempExp2 = 7.360;
				if (MapCheck == 87) TempExp2 = 7.524;
				if (MapCheck == 88) TempExp2 = 7.692;
				if (MapCheck == 89) TempExp2 = 7.864;
				if (MapCheck == 90) TempExp2 = 8.040;

				if (MapCheck == 91) TempExp2 = 8.240;
				if (MapCheck == 92) TempExp2 = 8.424;
				if (MapCheck == 93) TempExp2 = 8.612;
				if (MapCheck == 94) TempExp2 = 8.804;
				if (MapCheck == 95) TempExp2 = 9.000;
				if (MapCheck == 96) TempExp2 = 9.200;
				if (MapCheck == 97) TempExp2 = 9.404;
				if (MapCheck == 98) TempExp2 = 9.612;
				if (MapCheck == 99) TempExp2 = 9.824;
				if (MapCheck >= 100) TempExp2 = 10.040;
				TempExp2 *= 1.0;
				MapCheckFactor = 1.0;
				Exp2 = (MapCheck * MapCheckFactor) * (1.0 + TempExp2);
	
						 if (MapCheck == 31) TempExp3 = 0.75; // [175%]
				else if (MapCheck == 32) TempExp3 = 0.25; // [225%]
														else TempExp3 = 0.25; // [125%]
				TempExp3 *= 1.0;
				Exp2 *= (1.0 + TempExp3);

				if (MapCheck == 1020) Exp2 = 0; // MAP0A [Hexen]
				if (MapCheck == 1030) Exp2 = 0; // MAPAA [Strife]
				if (MapCheck >= 1036 && MapCheck <= 1038) Exp2 = 0; // [Doom64]
				if (MapCheck == 1039) Exp2 = 0; // MAPP0 [PSXDoom]
				if (MapCheck == 1050) Exp2 = 0; // MAP00 [Classic Doom 2]
			}
		}
		else
		if (ModType == 1) // Deus Vult 1
		{
			MapCheck = clamp(MapCheck, 1101, 1104);

			if (MapCheck == 1101) TempExp2 = 0.00;
			if (MapCheck == 1102) TempExp2 = 0.20;
			if (MapCheck == 1103) TempExp2 = 0.44;
			if (MapCheck == 1104) TempExp2 = 0.92;

			TempExp2 *= 1.0;
			Exp2 = (MapCheck - 1100) * (1 + TempExp2);
		}
		else
		if (ModType == 2) // Deus Vult 2
		{
			MapCheck = clamp(MapCheck, 1201, 1212);

			// Zendaria Levels
			if (MapCheck == 1200) Exp2 = (MapCheck - 1200) * 1.04; // +4% Exp Bonus // Prolouge - The Mysterious Cave
			// Earth-type Levels
			if (MapCheck == 1201) TempExp2 = 0.00; // Monster Bonus // MAP01 - Entryway Pass
			if (MapCheck == 1202) TempExp2 = 0.06; // Monster Bonus // MAP02 - Mutagen
			if (MapCheck == 1203) TempExp2 = 0.12; // Monster Bonus // MAP03 - Crouching Demon, Hidden Archvile
			if (MapCheck == 1204) TempExp2 = 0.20; // Monster Bonus // MAP04 - Minas Morgul
			if (MapCheck == 1205) TempExp2 = 0.26; // Monster Bonus // MAP05 - Eagle's Nest
			if (MapCheck == 1206) TempExp2 = 0.34; // Monster Bonus // MAP05B - The Manliest Level Ever
			if (MapCheck == 1207) TempExp2 = 0.42; // Monster Bonus // MAP06 - Stargate
			if (MapCheck == 1208) TempExp2 = 0.50; // Monster Bonus // MAP07 - The Desert Temple
			// Hell Levels
			if (MapCheck == 1209) TempExp2 = 0.78; // Monster Bonus // MAP08 - The Unholy Cathedral
			if (MapCheck == 1210) TempExp2 = 0.10; // Monster Bonus // MAP09 - You Shall Not Pass!
			if (MapCheck == 1211) TempExp2 = 0.48; // Monster Bonus // MAP10 - Hell's Vendetta
			if (MapCheck == 1212) TempExp2 = 0.92; // Monster Bonus // MAP10B - attedneV s'lleH
			// Extra Levels
			if (MapCheck == 1214) TempExp2 = 0.40; // MAP12 - "The Wings of The Maiar" [DVI combined level remake]
			if (MapCheck == 1215) TempExp2 = 1.92; // MAP10C - attedneV s'lleH: The True End of All Things... [resurrected Sauron rematch] (if worser endings occur)

			TempExp2 *= 1.0;
			Exp2 = (MapCheck - 1200) * (1 + TempExp2);
			// Ending Levels
			if (MapCheck == 1213) Exp2 = 0; // NO Exp Bonus since it's Heaven, foo. :P // MAP11 - St. Peter's Gate
			if (MapCheck == 1216) Exp2 = 0; // NO Exp Bonus in ending levels // MAP13 - The Return Home
			if (MapCheck == 1217) Exp2 = 0; // NO Exp Bonus in ending levels // ENDMAP - Credits and Cast
		}
		ExpMultiFactor += Exp2;
		if (debugexp) Console.Printf("\cxGetExpMultiFactor\c- - ClassicDoomType: %d, ModType: %d, \czMapCheck: %d (%d)\c-, TempExp2: %.8f, TempExp3: %.8f, Exp2: %d, ExpMultiFactor: %d", ClassicDoomType, ModType, MapCheck, level.levelnum, TempExp2, TempExp3, Exp2, ExpMultiFactor);
		
		return ExpMultiFactor;
	}
	
	void A_UltraRareDropSnd(string itemname = "", string dropper = "")
	{
		double raredropsndpitch = frandompick(0.75,0.875,1.0,1.125,1.25);
		double raredropsndvol = frandom(1.75,2.25);
		int raredropsndchannel = randompick(193,194,224,225,266,267);
		string raredropsndname = "ultrarareitem/spawn";

		if (dvds_showdamagemessageactortags) dropper = GetTag(""); 

		A_StartSound(raredropsndname,raredropsndchannel,CHANF_OVERLAP|CHANF_NOPAUSE,raredropsndvol,ATTN_NONE,raredropsndpitch);
		if (dvdsdebug_raredropdisplays) Console.Printf("    \cf%s\c- was dropped by \cx%s!\c-", itemname, dropper);
	}
	
	void A_RareDropSnd(string itemname = "", string dropper = "")
	{
		double raredropsndpitch = frandompick(0.75,0.875,1.0,1.125,1.25);
		double raredropsndvol = frandom(1.75,2.25);
		int raredropsndchannel = randompick(191,192,222,223,264,265);
		string raredropsndname = "rareitem/spawn";

		if (dvds_showdamagemessageactortags) dropper = GetTag(""); 

		A_StartSound(raredropsndname,raredropsndchannel,CHANF_OVERLAP|CHANF_NOPAUSE,raredropsndvol,ATTN_NONE,raredropsndpitch);
		if (dvdsdebug_raredropdisplays) Console.Printf("    \cy%s\c- was dropped by \cx%s!\c-", itemname, dropper);
	}
	
	void A_DropSnd(string itemname = "", string dropper = "")
	{
		double dropsndpitch = frandompick(0.75,0.875,1.0,1.125,1.25);
		double dropsndvol = frandom(1.75,2.25);
		int dropsndchannel = randompick(189,190,220,221,262,263);
		string dropsndname = "misc/spawn";

		if (dvds_showdamagemessageactortags) dropper = GetTag(""); 

		A_StartSound(dropsndname,dropsndchannel,CHANF_OVERLAP|CHANF_NOPAUSE,dropsndvol,ATTN_NONE,dropsndpitch);
		if (dvdsdebug_raredropdisplays) Console.Printf("    \cx%s\c- was dropped by \cx%s!\c-", itemname, dropper);
	}
	
	int A_GetExperience(int RealExpGain, int ExpMultiFactor)
	{
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int clearofmindex = CallACS("MiscVarCheckDECORATE",10056);
		int debugexp = dvdsdebug_showexpdebugstuff;
		int PlayerAGL = CallACS("MiscVarCheckDECORATE",31);
		int PlayerDFT = CallACS("MiscVarCheckDECORATE",33);

		int DeftnessExpBase = dvds_deftnessexpbase;
		int ExpMultiplier = dvds_expmultiplier;
		if (debugexp) Console.Printf("\cxGetExperience\c- - Base: %d", RealExpGain);

		RealExpGain = RealExpGain * ExpMultiFactor / 100; // Randomizes some of the experience gained
		if (debugexp) Console.Printf("\cxGetExperience\c- - After Randomization: %d, [\cxExpMultiFactor: %d%\c-]", RealExpGain, ExpMultiFactor);

		RealExpGain = RealExpGain * (DeftnessExpBase + PlayerDFT) / DeftnessExpBase;
		if (debugexp) Console.Printf("\cxGetExperience\c- - Deftness: %d [\cxDeftBonus: %d%\c-]", RealExpGain, (DeftnessExpBase + PlayerDFT), DeftnessExpBase);

		RealExpGain = RealExpGain * ExpMultiplier / 100; // EXP Multiplier Option
		if (debugexp) Console.Printf("\cxGetExperience\c- - Multiplier: %d, [\cxExpMultiOption: %d%\c-]", RealExpGain, ExpMultiplier);
		
		double perkfactor;
		// "Cleared of Mind" Perk
		perkfactor = 1.00;
		if (clearofmind > 0)
		{
			if (clearofmind >= 1) perkfactor += 0.04;
			if (clearofmind >= 2) perkfactor += 0.05;
			if (clearofmind >= 3) perkfactor += 0.06;
			if (clearofmind >= 4) perkfactor += 0.07;
			if (clearofmind >= 5) perkfactor += 0.08;
			if (clearofmindex >= 1) perkfactor += 0.15;
			if (clearofmindex >= 2) perkfactor += 0.15;
			RealExpGain *= perkfactor;
		}
		if (debugexp) Console.Printf("\cxGetExperience\c- - Cleared of Mind: %d, [\cxperkfactor: %.8fx\c=]", RealExpGain, perkfactor);

		// "Higher Learning" Grand Mastery Perk
		if (CallACS("MiscVarCheckDECORATE",11001) == 1)
		{
			if (CharacterClass == 0 | CharacterClass == 1) RealExpGain *= 1.225; // EXP Multiplier Option [122.5%]
			if (CharacterClass == 2) RealExpGain *= 1.15; // EXP Multiplier Option [115%]
			if (debugexp) Console.Printf("\cxGetExperience\c- - Grand Mastery Perk [\cx1.15x\c-]: %d", RealExpGain);
		}
		if (CallACS("MiscVarCheckDECORATE",11001) == 2)
		{
			if (CharacterClass == 0 | CharacterClass == 1) RealExpGain *= 1.45; // EXP Multiplier Option [145%]
			if (CharacterClass == 2) RealExpGain *= 1.3; // EXP Multiplier Option [130%]
			if (debugexp) Console.Printf("\cxGetExperience\c- - Grand Mastery Perk [\cx1.3x\c-]: %d", RealExpGain);
		}

		if (TrueGameSkill <= SKILL_VERY_EASY) RealExpGain *= 1.5;
		else if (TrueGameSkill == SKILL_EASY) RealExpGain *= 1.25;
		else if (TrueGameSkill == SKILL_NORMAL) RealExpGain *= 1.0;
		else if (TrueGameSkill == SKILL_HARD) RealExpGain *= 0.834;
		else if (TrueGameSkill == SKILL_VERY_HARD) RealExpGain *= 0.75;
		else if (TrueGameSkill == SKILL_EXTREME) RealExpGain *= 0.67;
		else if (TrueGameSkill == SKILL_HORRIBLE) RealExpGain *= 0.625;
		else if (TrueGameSkill == SKILL_IMPOSSIBLE) RealExpGain *= 0.5;
		else if (TrueGameSkill >= SKILL_OMEGA) RealExpGain *= 0.4;
		if (debugexp) Console.Printf("\cxGetExperience\c- - Skill Level: %d", RealExpGain);

		double ArmorEXPMulti = 1.0;
		if (CharacterClass == 2)
		{
			if (CountInv("SafeTeaShoes", AAPTR_PLAYER1)) { if (random(1,100) < 6) { ArmorEXPMulti += 0.05; } else { ArmorEXPMulti += 0.025; } }
			if (CountInv("PearlyCorset", AAPTR_PLAYER1)) { if (random(1,100) < 6) { ArmorEXPMulti += 0.3; } else { ArmorEXPMulti += 0.2; } }
			if (CountInv("DoveRibbon", AAPTR_PLAYER1)) { if (random(1,100) < 6) { ArmorEXPMulti += 0.05; } else { ArmorEXPMulti += 0.025; } }
			RealExpGain *= ArmorEXPMulti;
		}
		if (debugexp) Console.Printf("\cxGetExperience\c- - Armor Items: %d, [\cxArmorEXPMulti: %.8fx\c-]", RealExpGain, ArmorEXPMulti);

		if (CallACS("GetBuffTimer",7) > 0) { if (random(1,100) > 67) { RealExpGain *= 1.1667; } else { RealExpGain *= 1.08333; } } // Divine Avatar [+8.333% EXP, (33% chance of +16.67% EXP instead]
		if (debugexp) Console.Printf("\cxGetExperience\c- - Final/NewEXP: %d", RealExpGain);
		
		return RealExpGain;
	}

	int GetDropMin(string nm, int dropmin, double basemultiplier = 1.00)
	{
		if (dvdsdebug_actordroptabledisplays) Console.Printf("\cf%s\c- dropmin - \cx%d\c-", nm, dropmin);
		return dropmin;
	}

	int GetDropMax(string nm, int dropmax, double basemultiplier = 1.00)
	{
		double multi = dvds_monsterdropratemulti;

		dropmax *= basemultiplier;
		if (multi < 0.01) multi = 0.01;
		if (multi > 100.00) multi = 100.00;
		dropmax *= multi;
		if (dropmax < 1) dropmax = 1;
		
		if (dvdsdebug_actordroptabledisplays) Console.Printf("\cf%s\c- dropmax - \cy%d\c-", nm, dropmax);
		return dropmax;
	}

	void A_AddEXP(int baseamount = -2, int flags = 0, int incrementcombo = 1, int expfactor = 100)
	{
		int randomitem;
		int randomitem2;
		int randomitem3;
		int clearofmind = CallACS("MiscVarCheckDECORATE",10055);
		int clearofmindex = CallACS("MiscVarCheckDECORATE",10056);
		int debugexp = dvdsdebug_showexpdebugstuff;
		int debuguncurse = dvdsdebug_shielduncursedisplay;
		int PlayerLevel = CallACS("StatCheck",0);
		int StrifeStaminaLevel = CallACS("MiscVarCheckDECORATE",317);
		int StrifeAccuracyLevel = CallACS("MiscVarCheckDECORATE",318);
		int PlayerAGL = CallACS("MiscVarCheckDECORATE",31);
		int PlayerDFT = CallACS("MiscVarCheckDECORATE",33);
		int terminate;

		int baseexp, finalexpamount, overkillhp, overkillhp2;
		int Exp1, Exp2, ExpMultiFactor, RealExpGain;
		int ComboMultiplier;
		double KillExpMultiplier;
		int KilledByPlayer = 1;
		int fakedeath;
		int random1;
		string ActorClass = GetClassName();
		string nm;
		double basedropmaxrate;

		if (expfactor == 0) expfactor = 100;
		if (flags & 2) fakedeath = 1;
		int MapValue = level.levelnum;
		//Console.Printf("MapNumber: %d", level.levelnum);
		int MonsterX = pos.x;
		int MonsterY = pos.y;
		int MonsterZ = pos.z;
		int DropTimes;
		int MaxDropTimes;
		double DropX, DropY, DropZ;
		double DropVels1, DropVels2;
		int maxdropval;
		int dropmin;
		int dropmax;

		double RandomArmorDropChance;
		double RandomArmorDropMulti;
		
		if (user_MaxHP <= 0) 
		{
			overkillhp = SpawnHealth() * -1; overkillhp2 = SpawnHealth() * -4; 
		} 
		else 
		{
			overkillhp = user_MaxHP * -1; overkillhp2 = user_MaxHP * -4; 
		}
		
		if (bBOSS) MaxDropTimes = (randompick(1,1,1,1,1,1,1,2,2,2) + (user_lastmonsterlevel / randompick(50,55,60,65,70)));
					else MaxDropTimes = (randompick(1,1,1,1,1,1,1,1,1,2) + (user_lastmonsterlevel / randompick(200,220,240,260,280)));
		If (user_legendaryevolved) 
		{
			if (bBOSS) MaxDropTimes *= random(5,7); 
						else MaxDropTimes *= 2;
		}
		
		for (DropTimes = 0; DropTimes < MaxDropTimes; DropTimes++)
		{
			DropX = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
			DropY = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
			DropZ = (DropTimes - 1) * frandompick(1.525,2.05,3.075);
			DropVels1 = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
			DropVels2 = (DropTimes - 1) * frandompick(1.386875,1.67375,2.3475);

			if (ClassicDoomType == 4) // Strife
			{
				nm = "DegninOrePickup"; MiscCheck = nm;
				// Enemies in the Degnin Mines or levels in the factory HUB can sometimes drop Degnin Ore depending on the area
				if (MapValue == 14) // Degnin Mines
				{
					if (random(1,768) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,384) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,192) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,96) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,72) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,48) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,24) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,12) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP14]", debugexp);
				}
				if (MapValue == 20) // Factory: Receiving
				{
					if (random(1,4096) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,1024) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,256) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,64) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP20]", debugexp);
				}
				if (MapValue == 21) // Factory: Manufacturing
				{
					if (random(1,4096) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,1024) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,256) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,64) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP21]", debugexp);
				}
				if (MapValue == 22) // Factory: Forge
				{
					if (random(1,192) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,160) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,128) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,96) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,64) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,32) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,16) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP22]", debugexp);
				}
				if (MapValue == 24) // Factory: Conversion Chapel
				{
					if (random(1,4096) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,1024) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,256) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,64) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP24]", debugexp);
				}
				if (MapValue == 26) // Proving Grounds
				{
					if (random(1,7168) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,1536) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,384) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,96) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP26]", debugexp);
				}
				if (MapValue == 27) // The Lab [Loremaster boss]
				{
					if (random(1,8192) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,2048) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,512) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,128) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [MAP27]", debugexp);
				}
				if (CountInv("QuestItem29", AAPTR_PLAYER1)) // Destroying the Transmitter allows any other enemy in the game to have a chance to drop Degnin Ore [any level]
				{
					if (random(1,16384) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,4096) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(1,1024) <= 1) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (debugexp) Console.Printf("\cxAddEXP\c- - Degnin Ore Drop Attempt [Post-Transmitter]", debugexp);
				}
			}
		}
		
		if (TrueGameSkill <= SKILL_VERY_EASY) RandomArmorDropMulti = 0.75;
		else if (TrueGameSkill == SKILL_EASY) RandomArmorDropMulti = 0.875;
		else if (TrueGameSkill == SKILL_NORMAL) RandomArmorDropMulti = 1.00;
		else if (TrueGameSkill == SKILL_HARD) RandomArmorDropMulti = 1.125;
		else if (TrueGameSkill == SKILL_VERY_HARD) RandomArmorDropMulti = 1.25;
		else if (TrueGameSkill == SKILL_EXTREME) RandomArmorDropMulti = 1.35;
		else if (TrueGameSkill == SKILL_HORRIBLE) RandomArmorDropMulti = 1.50;
		else if (TrueGameSkill == SKILL_IMPOSSIBLE) RandomArmorDropMulti = 1.65;
		else if (TrueGameSkill >= SKILL_OMEGA) RandomArmorDropMulti = 1.80;
		
		KilledByPlayer = 1;
		KillExpMultiplier = 1.0; // 20 = 100% [1 = 5%]
		string lastattackername; if (lastattacker) lastattackername = lastattacker.GetClassName();
		playeriskiller = AetheriusPlayerPawn(lastattacker);
		if (debugexp && lastattacker) Console.Printf("\cxAddEXP\c- - lastattacker: %s", lastattackername);
		if (debugexp && playeriskiller) Console.Printf("\cxAddEXP\c- - playeriskiller");
		if (!playeriskiller)
		{
			// TODO: Detect if a friendly monster/summon is the killer of the monster to give EXP credit to the player
			if (lastattacker && lastattacker.bFRIENDLY)
			{
				KilledByPlayer = 0;
				KillExpMultiplier = random(65,90) * 0.01; // [65 to 90%]
				double tempval1 = 0.5;
				double tempval2 = (1.0 - KillExpMultiplier) * tempval1;
				if (CountInv("AnubisCufflinks", AAPTR_PLAYER1)) KillExpMultiplier += 0.10;
				if (damagedbyplayer) KillExpMultiplier += tempval2; // If the player also directly contribued to damaging the monster, they gain 50% more share of the EXP than otherwise
				KillExpMultiplier = clamp(KillExpMultiplier, KillExpMultiplier, 1.0);
				if (debugexp) Console.Printf("\cxAddEXP\c- - Passed Player/Friendly-Monster Credit Check: YES, \cxDamagedByPlayer: %d (%.8f)\c-, \cxKillMultiplier: %.8f\c-", DamagedByPlayer, tempval2, KillExpMultiplier);
			}
			else
			{
				if (debugexp) Console.Printf("\cxAddEXP\c- - Passed Player/Friendly-Monster Credit Check: NO", debugexp);
				terminate = 1;
			}
		}
		
		if (debugexp)
		{
			if (KilledByPlayer == 1) Console.Printf("\cxAddEXP\c- - Passed Player/Friendly-Monster Credit Check: YES (PLAYER), \cxExpMultiplier: %.8f\c-", debugexp, KillExpMultiplier);
			else Console.Printf("\cxAddEXP\c- - Passed Player/Friendly-Monster Credit Check: YES (FRIENDLY ACTOR), \cxExpMultiplier: %.8f\c-", debugexp, KillExpMultiplier);
		}
		
		if (playeriskiller && playeriskiller.health <= 0)  
		{
			if (debugexp) Console.Printf("\cxAddEXP\c- - Passed Player-Alive Check: NO", debugexp);
			terminate = 1;
		}
		else
		{
			if (debugexp) Console.Printf("\cxAddEXP\c- - Passed Player-Alive Check: YES", debugexp);
		}
		
		if (bFRIENDLY) // Any "FRIENDLY" flagged monster who runs the script will not get beyond this point UNLESS they have bit 1 enabled.
		{
			if (flags & 1) { }
			else
			{
				if (debugexp) Console.Printf("\cxAddEXP\c- - Passed FRIENDLY Check: NO", debugexp);
				terminate = 1;
			}
		}
		else
		{
			if (debugexp) Console.Printf("\cxAddEXP\c- - Passed FRIENDLY Check: YES", debugexp);
		}
		
		if (!terminate)
		{
			int HellCoreRuinousDropChance = 16; // out of a max of 1024
			int HellcoreMaxDropRate = 1024;
			int hasahellcoresoul = 0;
			string soulname;
			string soulname2;
			HellCoreRuinousDropChance += ((CallACS("MiscVarCheckDECORATE",10033) * 6) + (CallACS("MiscVarCheckDECORATE",10034) * 15));
			HellCoreRuinousDropChance += ((clearofmindex * 4) + (clearofmindex * 10));
			HellCoreRuinousDropChance += (user_lastmonsterlevel / 11.25);
			if (CountInv("EvenstarNecklace", AAPTR_PLAYER1)) HellCoreRuinousDropChance += 12;
			if (CountInv("AnubisCufflinks", AAPTR_PLAYER1)) HellCoreRuinousDropChance += 4;
			if (CountInv("BalrogRing", AAPTR_PLAYER1)) HellCoreRuinousDropChance += 8;
			if (CountInv("RuinousShield", AAPTR_PLAYER1)) HellCoreRuinousDropChance *= 3; // Ruinous Shield triples drop rate
			if (CallACS("DVDSSpecialArrayCheckDECORATE",3) > 0 || CountInv("PlayingUnloved", AAPTR_PLAYER1)) HellCoreRuinousDropChance *= 4; // Playing Unloved sets this to drop 4x as often
			If (user_legendaryevolved) HellCoreRuinousDropChance *= 4; // Being a Legendary quadruples drop rate.
			if (CharacterClass != 2) HellCoreRuinousDropChance = 0;
			if (debugexp) Console.Printf("\cxAddEXP\c- - HellCoreRuinousDropChance [first]: %d / 1024", HellCoreRuinousDropChance);
			// Monster Unique Drop Rates [Hellcore weapons]
			if (ActorClass == "DSDoomImp")			{ hasahellcoresoul++; soulname = "ImpSoulCI"; }
			if (ActorClass == "ImpWarlordNew")	{ hasahellcoresoul++; soulname = "ImpSoulCI"; }
			if (ActorClass == "Devil")					{ hasahellcoresoul++; soulname = "ImpSoulCI"; }
			if (ActorClass == "DarkImp")				{ hasahellcoresoul++; soulname = "DarkImpSoulCI"; }
			if (ActorClass == "STDarkImp")			{ hasahellcoresoul++; soulname = "DarkImpSoulCI"; }
			if (ActorClass == "VoidDarkImp")		{ hasahellcoresoul++; soulname = "DarkImpSoulCI"; }
			if (ActorClass == "NetherDarkImp")	{ hasahellcoresoul++; soulname = "DarkImpSoulCI"; }
			if (ActorClass == "DSCacodemon")		{ hasahellcoresoul++; soulname = "CacodemonSoulCI"; }
			if (ActorClass == "Cacolantern")		{ hasahellcoresoul++; soulname = "CacolanternSoulCI"; }
			if (ActorClass == "Abaddon")				{ hasahellcoresoul++; soulname = "AbaddonSoulCI"; }
			if (ActorClass == "DSHellKnight")		{ hasahellcoresoul++; soulname = "KnightSoulCI"; }
			if (ActorClass == "DSBaronofHell")	{ hasahellcoresoul++; soulname = "BaronSoulCI"; }
			if (ActorClass == "Belphegor")			{ hasahellcoresoul++; soulname = "BelphegorSoulCI"; }
			if (ActorClass == "BruiserDemon")		{ hasahellcoresoul++; soulname = "BruiserSoulCI"; }
			if (ActorClass == "ArchonOfHell")		{ hasahellcoresoul++; soulname = "ArchonSoulCI"; }
			if (ActorClass == "PyroDemon")			{ hasahellcoresoul++; soulname = "PyroDemonSoulCI"; }
			if (ActorClass == "DeathIncarnate")	{ hasahellcoresoul++; soulname = "IncarnateSoulCI"; }
			if (ActorClass == "DSArchvile")			{ hasahellcoresoul++; soulname = "ArchvileSoulCI"; }
			if (ActorClass == "Diabloist")			{ hasahellcoresoul++; soulname = "DiabloistSoulCI"; }
			if (ActorClass == "FlyingBalrog")		{ hasahellcoresoul++; soulname = "BalrogSoulCI"; }
			if (ActorClass == "HadesElemental")	{ hasahellcoresoul++; soulname = "HElementalSoulCI"; }
			if (ActorClass == "HadesOverLord")	{ hasahellcoresoul++; soulname = "HOverlordSoulCI"; }
			if (hasahellcoresoul && HellCoreRuinousDropChance > 0)
			{
				soulname2 = soulname;
				soulname2.DeleteLastCharacter();
				soulname2.DeleteLastCharacter();
				if (debugexp) Console.Printf("soulname: %s, soulname2: %s", soulname, soulname2);
				bool founddrop = CheckProximity(soulname,65536.0,1,CPXF_NOZ,AAPTR_DEFAULT);
				int soulsheld = CountInv(soulname2, AAPTR_PLAYER1);
				HellCoreRuinousDropChance += (soulsheld * 4);
				if (debugexp) Console.Printf("\cxAddEXP\c- - HellCoreRuinousDropChance [soulcheck]: %d / 1024, (soulsheld: %d (%d))", HellCoreRuinousDropChance, soulsheld, (soulsheld * 4));
				
				if (!soulsheld && !founddrop) HellCoreRuinousDropChance *= 2.5;

				HellCoreRuinousDropChance = (HellCoreRuinousDropChance * dvds_helcdropmultiplier) / 100;
				if (debugexp && dvds_helcdropmultiplier != 100) Console.Printf("\cxAddEXP\c- - HellCoreRuinousDropChance [cheat-multi]: %d / 1024", HellCoreRuinousDropChance);

				if (random(1,HellcoreMaxDropRate) <= HellCoreRuinousDropChance) 
				{ 
					A_DropItem(soulname,1,256); 
					if (debugexp) Console.Printf("\cxAddEXP\c- - Soul Drop Successful!");
					droppedtheirsoul = true;
					cannotres = 1;
				}
				if (debugexp) Console.Printf("\cxAddEXP\c- - HellCoreRuinousDropChance [final]: %d / 1024, (soulsheld: %d, founddrop: %d)", HellCoreRuinousDropChance, soulsheld, founddrop);
			}

			
			double uncursethreshold;
			double uncursethreshold2;
			int uncursepts;
			// Ruinous Shield Checks
			int donotincreasekills = 0;
			if (playeriskiller)
			{
				if (CharacterClass == 2 && CountInv("RuinousShield", AAPTR_PLAYER1) > 0) // Flora
				{
					if (debugexp) Console.Printf("\cxAddEXP\c- - UncursePts: %d", CallACS("MiscVarCheckDECORATE",202));
					// Increase Ruinous Shield Counter by 1 or 2 pts [this allows the player to uncurse the shield slowly by killing enemies.
					uncursethreshold = 0.9375;
					uncursethreshold2 = 0.625;
					if (CountInv("DoveRibbon", AAPTR_PLAYER1))
					{
						uncursethreshold -= 0.0625;
						uncursethreshold2 -= 0.125;
					}
					if (CallACS("GetBuffTimer",7) > 0) 
					{
						uncursethreshold *= 0.834; 
						uncursethreshold2 *= 0.834; 
					}
					if (frandom(0.0001,1.0000) <= uncursethreshold)
					{
						if (frandom(0.0001,1.0000) <= uncursethreshold2) uncursepts = 1; else uncursepts = 2;
					}
					else
					{
						if (frandom(0.0001,1.0000) <= uncursethreshold2) uncursepts = 4; else uncursepts = 8;
					}
					if (CountInv("DoveRibbon", AAPTR_PLAYER1)) uncursepts *= (2 * random(1,2));
					if (KilledByPlayer != 1) uncursepts *= 0.25;
					uncursepts = clamp(uncursepts, 1, uncursepts);
					CallACS("MiscVarSetDECORATE",202,uncursepts,1); // Add
					
					if (debuguncurse) Console.Printf("Uncurse Pts: %d [+%d], Threshold1: %.8f, Threshold2: %.8f", CallACS("MiscVarCheckDECORATE",202), uncursepts, uncursethreshold, uncursethreshold2);
				}
				
				if (ActorClass == "DSBossBrain" || ActorClass == "ClayDevilNew") donotincreasekills = 1;
				if (donotincreasekills == 0) 
				{
					CallACS("MiscVarSetDECORATE",167,1,1); // Add // KillCounter += 1; // Increases Player's actual total kill count by 1
					if (debugexp) Console.Printf("\cxAddEXP\c- - Kills: %d", CallACS("MiscVarCheckDECORATE",167));
				}
			}
			
			if (fakedeath == 0) 
			{
				int maxarmordrops = 1;
				if (user_legendaryevolved) maxarmordrops += 2;
				for (int i = 0; i < maxarmordrops; i++)
				{
					A_DropItem("FloraRandomArmor",1,(256 * dvds_flora_armordropkcmnfactor));
					if (bBOSS)
					{
						A_DropItem("FloraRandomArmor",1,(256 * dvds_flora_armordropkcmnfactor));
						A_DropItem("FloraRandomArmor",1,(256 * dvds_flora_armordropkcmnfactor));
					}
				}
			}
			
			int KillCounter = CallACS("MiscVarCheckDECORATE",167);
			double KillCounterFactor = 1.0 * dvds_flora_armordropkcntfactor;
			int KillThreshold1 = 125 * KillCounterFactor;
			int KillThreshold2 = 500 * KillCounterFactor;
			int KillThreshold3 = 2000 * KillCounterFactor;
			int KillThreshold4 = 3500 * KillCounterFactor;
			int KillThreshold5 = 5000 * KillCounterFactor;
			int KillThreshold6 = 7000 * KillCounterFactor;
			int KillThreshold7 = 9000 * KillCounterFactor;
			int KillThreshold8 = 11500 * KillCounterFactor;
			int KillThreshold9 = 14000 * KillCounterFactor;
			int KillThreshold10 = 16500 * KillCounterFactor;
			int KillThreshold11 = 19000 * KillCounterFactor;
			int KillThreshold12 = 22000 * KillCounterFactor;
			int KillThreshold13 = 25000 * KillCounterFactor;
			int KillThreshold14 = 30000 * KillCounterFactor;
			if (debugexp) Console.Printf("\cxAddEXP\c- - KillCounterFactor: %.4f", KillCounterFactor);
			
			if (ModType == 0) // Classic Doom 1-2/Heretic/Hexen/Strife mode :P
			{
				if (CharacterClass == 2 && !donotincreasekills) // Flora
				{
					if (KillCounter == KillThreshold1 && CallACS("MiscVarCheckDECORATE",2601) == 0) // 
					{
						// 75% chance
						RandomArmorDropChance = 75.0 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2601,1);
					}
					if (KillCounter == KillThreshold2 && CallACS("MiscVarCheckDECORATE",2602) == 0)
					{
						// 50% chance
						RandomArmorDropChance = 50.0 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2602,1);
					}
					if (KillCounter == KillThreshold3 && CallACS("MiscVarCheckDECORATE",2603) == 0)
					{
						// 25% chance
						RandomArmorDropChance = 25.0 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2603,1);
					}
					if (KillCounter == KillThreshold4 && CallACS("MiscVarCheckDECORATE",2604) == 0)
					{
						// 25% chance
						RandomArmorDropChance = 25.0 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2604,1);
					}
					if (KillCounter == KillThreshold5 && CallACS("MiscVarCheckDECORATE",2605) == 0)
					{
						// 12.5% chance
						RandomArmorDropChance = 12.5 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2605,1);
					}
					if (KillCounter == KillThreshold6 && CallACS("MiscVarCheckDECORATE",2606) == 0)
					{
						// 12.5% chance
						RandomArmorDropChance = 12.5 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2606,1);
					}
					if (KillCounter == KillThreshold7 && CallACS("MiscVarCheckDECORATE",2607) == 0)
					{
						// 6.25% chance
						RandomArmorDropChance = 6.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2607,1);
					}
					if (KillCounter == KillThreshold8 && CallACS("MiscVarCheckDECORATE",2608) == 0)
					{
						// 6.25% chance
						RandomArmorDropChance = 6.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2608,1);
					}
					if (KillCounter == KillThreshold9 && CallACS("MiscVarCheckDECORATE",2609) == 0)
					{
						// 6.25% chance
						RandomArmorDropChance = 6.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2609,1);
					}
					if (KillCounter == KillThreshold10 && CallACS("MiscVarCheckDECORATE",2610) == 0)
					{
						// 6.25% chance
						RandomArmorDropChance = 6.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2610,1);
					}
					if (KillCounter == KillThreshold11 && CallACS("MiscVarCheckDECORATE",2611) == 0)
					{
						// 6.25% chance
						RandomArmorDropChance = 6.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2611,1);
					}
					if (KillCounter == KillThreshold12 && CallACS("MiscVarCheckDECORATE",2612) == 0)
					{
						// 36.25% chance
						RandomArmorDropChance = 36.25 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2612,1);
					}
					if (KillCounter == KillThreshold13 && CallACS("MiscVarCheckDECORATE",2613) == 0)
					{
						// 92.5% chance
						RandomArmorDropChance = 92.5 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2613,1);
					}
					if (KillCounter == KillThreshold14 && CallACS("MiscVarCheckDECORATE",2614) == 0)
					{
						// 100% chance
						RandomArmorDropChance = 100.0 * RandomArmorDropMulti;
						if (frandom(0.1,100.0) <= RandomArmorDropChance) A_SpawnItemEx("FloraRandomArmorAlwaysDrop",0.0,0.0,8.0,0.0,0.0,0.0,0.0,SXF_NOCHECKPOSITION,0);
						CallACS("MiscVarSetDECORATE",2614,1);
					}
				}
			}
			
			int randomdropsallowed = 1;

			double experiessencefactor = 1.0;
			experiessencefactor *= (1.0 + (PlayerDFT * 0.0104166666666667));
			experiessencefactor *= (1.0 + ((clearofmindex * 0.4) + (clearofmindex * 1.0)));

			double basedroprate = 1.0;
			basedroprate *= (1.0 + (PlayerDFT * 0.0104166666666667));
			basedroprate *= (1.0 + ((clearofmindex * 0.3) + (clearofmindex * 0.75)));

			// Drops
			if (bBOSS)
			{
				experiessencefactor *= randompick(8,10,12,14,16);
				basedroprate *= frandompick(1.5,1.75,2.0,2.25,2.5);
			}
			if (bFRIENDLY || 
					ActorClass == "DSBossBrain" || 
					ActorClass == "Skeleton" || 
					ActorClass == "ClayDevilNew" || 
					ActorClass == "FakeGoldLich" || 
					ActorClass == "FireDemonQueenClone" ||
					fakedeath > 0) 
			{ 
				randomdropsallowed = 0; 
				experiessencefactor = 0;
				basedroprate = 0;
			}
			
			if (randomdropsallowed > 0)
			{
				int specialchance1, specialchance2;
				if (debugexp) Console.Printf("\cxrandomdropsallowed\c- - basedroprate: %.8f (experiessencefactor: %.8f)", basedroprate, experiessencefactor);
				// Anything NOT meant to susceptible to LDL-altered drop rates goes here.
				nm = "TheOneRing"; MiscCheck = nm; 
				if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0 && dvds_theoneringdrops)
				{
					if (random(GetDropMin(nm,1),GetDropMax(nm,262144)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
				}

				// Anything meant to susceptible to LDL-altered drop rates goes here.
				for (DropTimes = 0; DropTimes < MaxDropTimes; DropTimes++)
				{
					DropX = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
					DropY = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
					DropZ = (DropTimes - 1) * frandompick(1.525,2.05,3.075);
					DropVels1 = (DropTimes - 1) * frandompick(1.13125,1.2625,1.525);
					DropVels2 = (DropTimes - 1) * frandompick(1.336875,1.67375,2.3475);

					nm = "VitalitySerum"; MiscCheck = nm;
					if (ModType == 0 && StrifeStaminaLevel < 10) // Classic Mode
					{
						if (ClassicDoomType != 4) // NOT Strife
						{
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
						}
					}

					nm = "CarrotusPotion"; MiscCheck = nm;
					if (ModType == 0 && StrifeAccuracyLevel < 10) // Classic Mode
					{
						if (ClassicDoomType != 4) // NOT Strife
						{
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
						}
					}

					nm = "GoldenApple"; MiscCheck = nm;
					if (ModType == 0 && (StrifeStaminaLevel < 10 && StrifeAccuracyLevel < 10)) // Classic Mode
					{
						if (ClassicDoomType != 4) // NOT Strife
						{
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
						}
					}

					if (ClassicDoomType != 4) // Non-Strife
					{
						if (CountInv("SigilPieces",AAPTR_PLAYER1) < 5)
						{
							nm = "SigilPickup"; MiscCheck = nm;
							if (ModType == 0) // Classic Mode
							{
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							}
						}
					}

					if (CountInv("UnmakerUpgrades",AAPTR_PLAYER1) < 3)
					{
						nm = "UnmakerDVDS"; MiscCheck = nm;
						if (ModType == 0) // Classic Mode
						{
							if (ClassicDoomType == 0 || ClassicDoomType == 1 || ClassicDoomType == 5 || ClassicDoomType == 6) // Doom 2, Doom 1, Doom64 or PSXDoom
							{
								if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0 && random(1,GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							}
							else
							{
								if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0 && random(1,GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,524288)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							}
						}
						else
						{
							if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0 && random(1,GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,262144)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_UltraRareDropSnd(nm, GetClassName()); }
						}
					}
					
					if (CharacterClass == 2)
					{
						nm = "PoisonNeedle"; MiscCheck = nm; 
						if (CallACS("MiscVarCheckDECORATE",7402) < CallACS("MiscVarCheckDECORATE",7502))
						{
							if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
							{
								specialchance1 = 1;
								specialchance2 = 1;
							}
							else
							{
								specialchance1 = 1;
								specialchance2 = 4;
							}
						}
						else
						{
							specialchance1 = 1;
							specialchance2 = 1;
						}
						if (random(1,specialchance2) <= specialchance1)
						{
							if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0 && random(1,GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						}
					}
					else
					{
						nm = "Berserk2"; MiscCheck = nm; 
						if (CountInv("AetheriusPowerStrength",AAPTR_PLAYER1) <= 0 && random(1,GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					}

					if (CharacterClass == 2) nm = "DimensionalBag"; 
															else nm = "BackPack2"; 
					MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,3072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,12288)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "Experiessence"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "LargeExperiessence"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "HugeExperiessence"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= (basedroprate * experiessencefactor)) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "ElfinElixir"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,262144)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "GreaterVimstone"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "LesserVimstone"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,131072)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "SageElixir"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "PaxaPunch"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "MercuryBandana"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "RandomSeedDropForcedAlways"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }

					nm = "YggdrasilDew"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					random1 = random(1,81);
					if (random1 >= 1 && random1 <= 10) nm = "SoulSphere2"; 
					if (random1 >= 11 && random1 <= 20) nm = "MegaSphere2";
					if (random1 >= 21 && random1 <= 30) nm = "InvulnerabilitySphere2";
					if (random1 >= 31 && random1 <= 40) nm = "BlurSphere2";
					if (random1 >= 41 && random1 <= 50) 
					{
						if (random(1,256) <= 16) nm = "SpreadSphere2";
																else nm = "SpreadSphere1";
					}
					if (random1 >= 51 && random1 <= 60) nm = "DoubleSphere";
					if (random1 >= 61 && random1 <= 70) nm = "GuardSphere";
					if (random1 >= 71 && random1 <= 80) nm = "TimeFreezeSphere";
					if (random1 == 81) nm = "DivinationSphere"; 
					MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) 
					{
						A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
						A_RareDropSnd(nm, GetClassName());
					}
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) 
					{
						A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
						A_RareDropSnd(nm, GetClassName());
					}
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) 
					{
						A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
						A_RareDropSnd(nm, GetClassName());
					}

					nm = "MiraclePotion"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					randomitem = randompick(1,1,1,2,2,3);
					if (randomitem == 1) nm = "MedicinalHerb";
					if (randomitem == 2) nm = "StrongMedicine";
					if (randomitem == 3) nm = "SpecialMedicine";
					MiscCheck = nm;
					if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					randomitem = randompick(1,1,1,2,2,3);
					if (randomitem == 1) nm = "MagicWater";
					if (randomitem == 2) nm = "SageElixir";
					if (randomitem == 3) nm = "ElfinElixir";
					MiscCheck = nm;
					if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					if (lastattacker && lastattacker.CountInv("CharmMonsterAttack") && lastattacker.CountInv("CharmMonsterDefense") && lastattacker.CountInv("CharmMonsterSpeed"))
					{
						nm = "MonsterMunchies"; MiscCheck = nm; 
						if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					}
					else
					{
						nm = "MonsterMunchies"; MiscCheck = nm; 
						if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					}

					nm = "RockBombShard"; MiscCheck = nm; 
					if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
					if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

					nm = "SapphireWandNew"; MiscCheck = nm; 
					if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
					{
						if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					}
					else
					if (CountInv("DualSapphireWandsNew",AAPTR_PLAYER1) <= 0)
					{
						if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					}

					if (ModType == 0) // Classic Mode
					{
						if (ClassicDoomType == 0 || ClassicDoomType == 1 || ClassicDoomType == 5 || ClassicDoomType == 6) // Doom 2, Doom 1, Doom64 or PSXDoom
						{
							// Circus 2 Drops
							if (CountInv("PlayingCircus2",AAPTR_PLAYER1))
							{
								nm = "ClownGrenadeNew"; MiscCheck = nm; 
								if (CallACS("MiscVarCheckDECORATE",7444) < CallACS("MiscVarCheckDECORATE",7544))
								{
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										specialchance1 = 1;
										specialchance2 = 32;
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										if (random(1,2) == 1) nm = "CGrenadeAmmo"; else nm = "ClownGrenadeNew";
										MiscCheck = nm; 
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
								}
								
								nm = "GoreBalloonNew"; MiscCheck = nm; 
								if (CallACS("MiscVarCheckDECORATE",7443) < CallACS("MiscVarCheckDECORATE",7543))
								{
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										specialchance1 = 1;
										specialchance2 = 32;
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									nm = "GoreBalloonNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										if (random(1,2) == 1) nm = "GoreBalloons"; else nm = "GoreBalloonNew";
										MiscCheck = nm; 
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
								}
								
								if (CallACS("MiscVarCheckDECORATE",7445) < CallACS("MiscVarCheckDECORATE",7545))
								{
									nm = "GutFlingerNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										nm = "GasRocketLauncherNew"; MiscCheck = nm; 
										if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
										{
											specialchance1 = 1;
											specialchance2 = 1;
										}
										else
										{
											specialchance1 = 1;
											specialchance2 = 32;
										}
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									nm = "GutFlingerNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										nm = "ClownSouls"; MiscCheck = nm;
										if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

										if (random(1,3) <= 1)
										{
											if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										}
									}
									
									nm = "GasRocketLauncherNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										nm = "ClownSouls"; MiscCheck = nm; 
										if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

										if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

										if (random(1,3) <= 1)
										{
											if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

											if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

											if (random(1,5) <= 1)
											{
												if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
												if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
												if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
		
												if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
												if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
												if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											}
										}
									}
								}
								
								nm = "PopcornGunNew"; MiscCheck = nm; 
								if (CallACS("MiscVarCheckDECORATE",7442) < CallACS("MiscVarCheckDECORATE",7542))
								{
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										specialchance1 = 1;
										specialchance2 = 32;
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									nm = "PopcornGunNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										specialchance1 = 1;
										specialchance2 = 32;
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									nm = "PopcornGunNew"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										nm = "PopcornPiece"; MiscCheck = nm; 
										if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

										if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

										if (random(1,3) <= 1)
										{
											if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

											if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
											if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										}
									}
								}
								
								if (CallACS("MiscVarCheckDECORATE",7446) < CallACS("MiscVarCheckDECORATE",7546))
								{
									nm = "CrazyBall2New"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										specialchance1 = 1;
										specialchance2 = 1;
									}
									else
									{
										specialchance1 = 1;
										specialchance2 = 32;
									}
								}
								else
								{
									specialchance1 = 1;
									specialchance2 = 1;
								}
								if (random(1,specialchance2) <= specialchance1)
								{
									nm = "CrazyBall2New"; MiscCheck = nm; 
									if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
									{
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
									else
									{
										nm = "CZBall"; MiscCheck = nm; 
										if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
										if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									}
								}
							}

							nm = "EvilWarriorShield"; MiscCheck = nm;
							DropX *= 5; DropY *= 5; DropZ *= 5; DropVels1 *= 5; DropVels2 *= 5;
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							DropX /= 5; DropY /= 5; DropZ /= 5; DropVels1 /= 5; DropVels2 /= 5;

							nm = "Berserk2"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "MiniBerserk"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "Medikit2"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "Stimpack2"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SeedofSkillForced"; MiscCheck = nm; 
							if (ActorClass == "HellCleric" && random(1,GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "FlyingBalrog" && random(1,GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "DSSpiderMastermind" && random(1,GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "Demolisher" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "DSCyberdemon" && random(1,GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "Annihilator" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }

							if (CharacterClass == 0 || CharacterClass == 1) // Deggaris & Illucia Specific Drops
							{
								nm = "DiamondSkinGA"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "StoneSkinGA"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "DiamondSkin"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "StoneSkin"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "BlueArmorDS"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "GreenArmorDS"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								nm = "ArmorBonus2"; MiscCheck = nm; 
								if (random(GetDropMin(nm,1),GetDropMax(nm,8)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

								if (random(GetDropMin(nm,1),GetDropMax(nm,16)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipBoxNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellBoxNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketBoxNew"; MiscCheck = nm; if (random1 == 7) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellPackNew"; MiscCheck = nm; if (random1 == 8) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
								if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipBoxNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3)  { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellBoxNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6)  { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketBoxNew"; MiscCheck = nm; if (random1 == 7)  { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellPackNew"; MiscCheck = nm; if (random1 == 8)  { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
								if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipBoxNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellBoxNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketBoxNew"; MiscCheck = nm; if (random1 == 7) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellPackNew"; MiscCheck = nm; if (random1 == 8) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
								if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketAmmoNew"; MiscCheck = nm; if (random1 == 7) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellNew"; MiscCheck = nm; if (random1 == 8) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
								if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketAmmoNew"; MiscCheck = nm; if (random1 == 7) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellNew"; MiscCheck = nm; if (random1 == 8) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
								if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate)
								{
									random1 = random(1,8);
									nm = "ClipNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "ShellNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "RocketAmmoNew"; MiscCheck = nm; if (random1 == 7) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
									nm = "CellNew"; MiscCheck = nm; if (random1 == 8) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								}
							}
						}
						if (ClassicDoomType == 2 || ClassicDoomType == 3) // BOTH Heretic AND Hexen
						{
							nm = "EvilWarriorShield"; MiscCheck = nm;
							DropX *= 5; DropY *= 5; DropZ *= 5; DropVels1 *= 5; DropVels2 *= 5;
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							DropX /= 5; DropY /= 5; DropZ /= 5; DropVels1 /= 5; DropVels2 /= 5;

							nm = "SapphireWandNew"; MiscCheck = nm; 
							if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
							{
								if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							}
							else
							if (CountInv("DualSapphireWandsNew",AAPTR_PLAYER1) <= 0)
							{
								if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							}

							nm = "ArtiSuperHealthNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "ArtiHealthNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "CrystalVialNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						}
						if (ClassicDoomType == 2) // Heretic Only
						{
							nm = "CrystalVialNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,65536)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "RockBombShard"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,32768)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SeedofSkillForced"; MiscCheck = nm; 
							if (ActorClass == "IronlichNew" && random(1,GetDropMax(nm,96)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "IceLich" && random(1,GetDropMax(nm,96)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "GoldLich" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "BloodLich" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "MaulotaurNew" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "DSparilMountedNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "DSparilUnmountedNew" && random(1,GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate)
							{
								nm = "RandomHereticWeapon2"; MiscCheck = nm; 
								random1 = random(1,214);
								if (random1 >= 1 && random1 <= 32) { nm = "GoldWandNew"; MiscCheck = nm; }
								if (random1 >= 33 && random1 <= 62) { nm = "CrossbowNew"; MiscCheck = nm; }
								if (random1 >= 63 && random1 <= 92) { nm = "SuperCrossbowNew"; MiscCheck = nm; }
								if (random1 >= 93 && random1 <= 122) { nm = "DragonClawNew"; MiscCheck = nm; }
								if (random1 >= 123 && random1 <= 152) { nm = "HellStaffNew"; MiscCheck = nm; }
								if (random1 >= 153 && random1 <= 182) { nm = "PhoenixRodNew"; MiscCheck = nm; }
								if (random1 >= 183 && random1 <= 212) { nm = "FiremaceNew"; MiscCheck = nm; }
								if (random1 >= 213) { nm = "DSparilStaff"; MiscCheck = nm; }
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0);
								A_RareDropSnd(nm, GetClassName());
							}
					
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate)
							{
								nm = "RandomHereticWeapon2"; MiscCheck = nm; 
								random1 = random(1,214);
								if (random1 >= 1 && random1 <= 32) { nm = "GoldWandNew"; MiscCheck = nm; }
								if (random1 >= 33 && random1 <= 62) { nm = "CrossbowNew"; MiscCheck = nm; }
								if (random1 >= 63 && random1 <= 92) { nm = "SuperCrossbowNew"; MiscCheck = nm; }
								if (random1 >= 93 && random1 <= 122) { nm = "DragonClawNew"; MiscCheck = nm; }
								if (random1 >= 123 && random1 <= 152) { nm = "HellStaffNew"; MiscCheck = nm; }
								if (random1 >= 153 && random1 <= 182) { nm = "PhoenixRodNew"; MiscCheck = nm; }
								if (random1 >= 183 && random1 <= 212) { nm = "FiremaceNew"; MiscCheck = nm; }
								if (random1 >= 213) { nm = "DSparilStaff"; MiscCheck = nm; }
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0);
								A_RareDropSnd(nm, GetClassName());
							}
					
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate)
							{
								nm = "RandomHereticWeapon2"; MiscCheck = nm; 
								random1 = random(1,214);
								if (random1 >= 1 && random1 <= 32) { nm = "GoldWandNew"; MiscCheck = nm; }
								if (random1 >= 33 && random1 <= 62) { nm = "CrossbowNew"; MiscCheck = nm; }
								if (random1 >= 63 && random1 <= 92) { nm = "SuperCrossbowNew"; MiscCheck = nm; }
								if (random1 >= 93 && random1 <= 122) { nm = "DragonClawNew"; MiscCheck = nm; }
								if (random1 >= 123 && random1 <= 152) { nm = "HellStaffNew"; MiscCheck = nm; }
								if (random1 >= 153 && random1 <= 182) { nm = "PhoenixRodNew"; MiscCheck = nm; }
								if (random1 >= 183 && random1 <= 212) { nm = "FiremaceNew"; MiscCheck = nm; }
								if (random1 >= 213) { nm = "DSparilStaff"; MiscCheck = nm; }
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
								A_RareDropSnd(nm, GetClassName());
							}
					
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandHeftyNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowHeftyNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterHeftyNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodHeftyNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodHeftyNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceHeftyNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandHeftyNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowHeftyNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterHeftyNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodHeftyNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodHeftyNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceHeftyNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandAmmoNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowAmmoNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterAmmoNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodAmmoNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodAmmoNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceAmmoNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandAmmoNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowAmmoNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterAmmoNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodAmmoNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodAmmoNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceAmmoNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandAmmoNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowAmmoNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterAmmoNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodAmmoNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodAmmoNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceAmmoNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate)
							{
								random1 = random(1,12);
								nm = "GoldWandHeftyNew"; MiscCheck = nm; if (random1 >= 1 && random1 <= 3) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "CrossbowHeftyNew"; MiscCheck = nm; if (random1 >= 4 && random1 <= 6) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "BlasterHeftyNew"; MiscCheck = nm; if (random1 >= 7 && random1 <= 9) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "PhoenixRodHeftyNew"; MiscCheck = nm; if (random1 == 10) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "SkullRodHeftyNew"; MiscCheck = nm; if (random1 == 11) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
								nm = "MaceHeftyNew"; MiscCheck = nm; if (random1 == 12) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							}
						}
						if (ClassicDoomType == 3) // Hexen Only
						{
							nm = "ArtiBoostManaNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "RockBombShard"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SeedofSkillForced"; MiscCheck = nm; 
							if (ActorClass == "DragonNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "HeresiarchNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "FighterBossNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "ClericBossNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "MageBossNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "KoraxNew" && random(1,GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						}
						if (ClassicDoomType == 4) // Strife
						{
							nm = "RandomSeedDropForcedAlways"; MiscCheck = nm;
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }

							nm = "ElfinElixir"; MiscCheck = nm;
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "PoisonBoltsNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SurgeryKitNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SapphireWandNew"; MiscCheck = nm; 
							if (CountInv(MiscCheck,AAPTR_PLAYER1) <= 0)
							{
								if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							}
							else
							if (CountInv("DualSapphireWandsNew",AAPTR_PLAYER1) <= 0)
							{
								if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
								if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate && CharacterClass == 2) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							}

							nm = "ElectricBoltsNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							random1 = random(1,81);
							if (random1 >= 1 && random1 <= 10) nm = "SoulSphere2"; 
							if (random1 >= 11 && random1 <= 20) nm = "MegaSphere2";
							if (random1 >= 21 && random1 <= 30) nm = "InvulnerabilitySphere2";
							if (random1 >= 31 && random1 <= 40) nm = "BlurSphere2";
							if (random1 >= 41 && random1 <= 50) 
							{
								if (random(1,256) <= 16) nm = "SpreadSphere2";
																		else nm = "SpreadSphere1";
							}
							if (random1 >= 51 && random1 <= 60) nm = "DoubleSphere";
							if (random1 >= 61 && random1 <= 70) nm = "GuardSphere";
							if (random1 >= 71 && random1 <= 80) nm = "TimeFreezeSphere";
							if (random1 == 81) nm = "DivinationSphere"; 
							MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate)
							{ 
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
								A_RareDropSnd(nm, GetClassName());
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate)
							{ 
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
								A_RareDropSnd(nm, GetClassName());
							}
							if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate)
							{ 
								A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); 
								A_RareDropSnd(nm, GetClassName());
							}

							nm = "SageElixir"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							randomitem = randompick(1,1,1,2,2,3);
							if (randomitem == 1) nm = "MedicinalHerb";
							if (randomitem == 2) nm = "StrongMedicine";
							if (randomitem == 3) nm = "SpecialMedicine";
							MiscCheck = nm;
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							randomitem = randompick(1,1,1,2,2,3);
							if (randomitem == 1) nm = "MedicinalHerb";
							if (randomitem == 2) nm = "StrongMedicine";
							if (randomitem == 3) nm = "SpecialMedicine";
							MiscCheck = nm;
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "MedicalKitNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "MedPatchNew"; MiscCheck = nm; 
							if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
							if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

							nm = "SeedofSkillForced"; MiscCheck = nm; 
							if (ActorClass == "ProgrammerNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "StrifeBishopNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "Macil2New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "LoreMasterNew" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "AlienSpectre1New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "AlienSpectre2New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "AlienSpectre3New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "AlienSpectre4New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "AlienSpectre5New" && random(1,GetDropMax(nm,32)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "EntityBossNew" && random(1,GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "EntitySecondNew" && random(1,GetDropMax(nm,16)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
							if (ActorClass == "EntityAscended" && random(1,GetDropMax(nm,8)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						}
					}
					else // DVI/DVII mode
					{
						nm = "Berserk2"; MiscCheck = nm; 
						if (random(GetDropMin(nm,1),GetDropMax(nm,8192)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,16384)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

						nm = "MiniBerserk"; MiscCheck = nm;
						if (random(GetDropMin(nm,1),GetDropMax(nm,2048)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,4096)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

						nm = "Medikit2"; MiscCheck = nm; 
						if (random(GetDropMin(nm,1),GetDropMax(nm,512)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,1024)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

						nm = "Stimpack2"; MiscCheck = nm; 
						if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }
						if (random(GetDropMin(nm,1),GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_DropSnd(nm, GetClassName()); }

						nm = "SeedofSkillForced"; MiscCheck = nm; 
						if (ActorClass == "HellCleric" && random(1,GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (ActorClass == "FlyingBalrog" && random(1,GetDropMax(nm,256)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (ActorClass == "DSSpiderMastermind" && random(1,GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (ActorClass == "Demolisher" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (ActorClass == "DSCyberdemon" && random(1,GetDropMax(nm,64)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
						if (ActorClass == "Annihilator" && random(1,GetDropMax(nm,48)) <= basedroprate) { A_SpawnItemEx(MiscCheck,frandom(-DropX,DropX),frandom(-DropY,DropY),frandom(-DropZ,DropZ),frandom(-DropVels1,DropVels1),frandom(-DropVels1,DropVels1),frandom(-DropVels2,DropVels2),0,SXF_NOCHECKPOSITION,0); A_RareDropSnd(nm, GetClassName()); }
					}
				}
			}
			
			//**********************
			//* START OF EXP GAINS *
			//**********************
			int EXPTimerIncrease;
			int ComboTimerDelayIncrease;
			if (ModType == 0 && dvds_expgains == 0) 
			{
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP Gains: STOPPED", debugexp);
			}
			else 
			if (CallACS("CheckPlayerIfDead") || CountInv("PlayerIsDead",AAPTR_PLAYER1))
			{
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP Gains: STOPPED [Player is Dead]", debugexp);
			}
			else
			{
				// Increment the kill combo timer
				if (dvds_expcombosystem == 1)
				{
					int ComboTimerDelay = CallACS("MiscVarCheckDECORATE",162);
					int EXPTimer = CallACS("MiscVarCheckDECORATE",157);
					if (incrementcombo == 1)
					{
						if (EXPTimer <= 0) // If not set, set to 4 seconds, if already set, add 1 second
						{
							EXPTimerIncrease = 2800; // 140 tics [20 units / tic]
							EXPTimerIncrease += (PlayerAGL * 16); // 1 point of Agility = 0.8 tics [or 16 units] [5 points = 4 tics (or 80 units)]
							EXPTimerIncrease += (PlayerDFT * 4); // 1 point of Deftness = 0.2 tics [or 4 units] [20 points = 4 tics (or 80 units)]
							ComboTimerDelayIncrease = randompick(2,4) * 8;
						}
						else
						{
							EXPTimerIncrease = 700; // 35 tics [20 units / tic]
							EXPTimerIncrease += (PlayerAGL * 4); // 1 point of Agility = 0.8 tics [or 16 units] [5 points = 4 tics (or 80 units)]
							EXPTimerIncrease += (PlayerDFT * 1); // 1 point of Deftness = 0.2 tics [or 4 units] [20 points = 4 tics (or 80 units)]
							ComboTimerDelayIncrease = randompick(2,4) * 2;
						}
						
						// "Legendary" Check
						if (user_legendaryevolved) { EXPTimerIncrease *= 2.5; ComboTimerDelayIncrease *= 2.5; }
						// BOSS Flag Check
						if (bBOSS) { EXPTimerIncrease *= 1.5; ComboTimerDelayIncrease *= 1.5; }
						// STEALTH Flag Check
						if (bSTEALTH) { EXPTimerIncrease *= 1.5; ComboTimerDelayIncrease *= 1.5; }
						// "Cleared of Mind" Perk
						if (clearofmind == 1) { EXPTimerIncrease *= 1.015; ComboTimerDelayIncrease *= 1.015; }
						if (clearofmind == 2) { EXPTimerIncrease *= 1.03; ComboTimerDelayIncrease *= 1.03; }
						if (clearofmind == 3) { EXPTimerIncrease *= 1.06; ComboTimerDelayIncrease *= 1.06; }
						if (clearofmind == 4) { EXPTimerIncrease *= 1.12; ComboTimerDelayIncrease *= 1.12; }
						if (clearofmind == 5) { EXPTimerIncrease *= 1.24; ComboTimerDelayIncrease *= 1.24; }
						// "Higher Learning" Grand Mastery Perk
						if (CallACS("MiscVarCheckDECORATE",11001) == 1) { EXPTimerIncrease *= 1.15; ComboTimerDelayIncrease *= 1.15; }
						if (CallACS("MiscVarCheckDECORATE",11001) == 2) { EXPTimerIncrease *= 1.30; ComboTimerDelayIncrease *= 1.30; }
					
						if (CallACS("GetBuffTimer",7) > 0) { EXPTimerIncrease *= 1.25; ComboTimerDelayIncrease *= 1.25; } // Divine Avatar
						if (CallACS("GetBuffTimer",12) > 0) { EXPTimerIncrease *= 1.25; ComboTimerDelayIncrease *= 1.25; } // Acceleratle
						if (CallACS("GetBuffTimer",15) > 0) { EXPTimerIncrease *= 0.8; ComboTimerDelayIncrease *= 0.8; } // Deceleratle
						EXPTimer += EXPTimerIncrease;
						ComboTimerDelay += ComboTimerDelayIncrease;

						if (CallACS("GetBuffTimer",7) > 0) EXPTimer = clamp(EXPTimer, EXPTimer, 7000); // Combo Timer maxes at 10 seconds.
																					else EXPTimer = clamp(EXPTimer, EXPTimer, 5600); // Combo Timer maxes at 8 seconds.

						CallACS("MiscVarSetDECORATE",157,EXPTimer,0);
						CallACS("MiscVarSetDECORATE",162,ComboTimerDelay,0);
						CallACS("MiscVarSetDECORATE",158,1,1); // combonumber += 1; // Increment Kill Combo Count by 1
					}
				}
				
				// Check Base Experience to see if it's a fixed amount or if it should be based on spawnhealth/user_MaxHP
				if (baseamount == -2) // Base on the menu option
				{
					if (dvds_monsterexpbase == 1)
					{
						if (user_MaxHP <= 0) baseexp = SpawnHealth(); else baseexp = user_MaxHP;
					}
					else
					{
						baseexp = SpawnHealth();
					}
				}
				else
				if (baseamount == -1) // ALWAYS use SpawnHealth and not user_MaxHP [if you always want it based only on their base HP and not their recalculated HP]
				{
					baseexp = SpawnHealth();
				}
				else
				if (baseamount == 0) // Checks for user_MaxHP first, but will use SpawnHealth if it's not been set
				{
					if (user_MaxHP <= 0) baseexp = SpawnHealth(); else baseexp = user_MaxHP;
				}
				else
				if (baseamount > 0) // Sets the EXP to the defined value as a fixed amount
				{
					baseexp = baseamount;
				}
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [Base EXP]", baseexp);
				double basemulti = (frandompick(0.175,0.20,0.225,0.25,0.275,0.30,0.325) * 2);
				double basemulti2 = ((PlayerLevel * 1.0) * (basemulti * 0.01));
				baseexp *= (basemulti + basemulti2);
				baseexp = clamp(baseexp, 1, baseexp);
				finalexpamount = baseexp;
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [POST-Base EXP], %.8f, %.8f", finalexpamount, basemulti, basemulti2);
				
				finalexpamount = (finalexpamount * expfactor) / 100; 
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxexpfactor: %d / 100\c-]", finalexpamount, expfactor);
				
				// Special Calls
				if (ActorClass == "ForgottenOne") finalexpamount *= 1.75;
				if (ActorClass == "DSBossBrain") finalexpamount *= frandom(2,3);

				if (ActorClass == "Banshee" || ActorClass == "DeathKnight")
				{
					finalexpamount *= frandom(1.25,1.75);
					if (random(GetDropMin(nm,1),GetDropMax(nm,8)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,128)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
				}
				if (ActorClass == "Bormereth" || ActorClass == "FireDemonQueen" || ActorClass == "EtherealChaosSerpentNew" || ActorClass == "DarkPatriarch")
				{
					finalexpamount *= frandom(1.75,2.25);
					if (random(GetDropMin(nm,1),GetDropMax(nm,2)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,8)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,32)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
				}
				if (ActorClass == "IceGolem" || ActorClass == "IceGolemGhost" || ActorClass == "FrostGolem" || ActorClass == "FrostGolemGhost" || ActorClass == "VampireDVDS")
				{
					finalexpamount *= frandom(1.0,1.5);
					if (random(GetDropMin(nm,1),GetDropMax(nm,48)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,192)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
					if (random(GetDropMin(nm,1),GetDropMax(nm,768)) <= basedroprate) A_DropItem("RandomSeedDropForcedAlways",1,256);
				}
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [Actor Check: %s]", finalexpamount, ActorClass);
				
				if (fakedeath > 0) // Fake deaths [Death Incarnate, etc] cut EXP gain by 75/87.5%
				{
					finalexpamount = finalexpamount * frandompick(0.125,0.25);
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxFake-Death (0.125/0.25x)\c-]", finalexpamount);
				}
				
				finalexpamount *= KillExpMultiplier;
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxMultiplier: %.8fx\c-]", finalexpamount, KillExpMultiplier);
				
				// Check for Fast Monsters setting
				if (sv_fastmonsters == 1)
				{
					finalexpamount *= 1.375; // [+37.5%]
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxFast Monsters On (1.375x)\c-]", finalexpamount);
				}
				
				// Check Proper Flags
				if (user_wasstealth)
				{
					if (CountInv("TheOneRing", AAPTR_PLAYER1)) finalexpamount *= 1.03125; // DV-DS Style Stealth = [+3.125%]
					else finalexpamount *= 1.21875;	// DV-DS Style Stealth = [+21.875%]
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [Was Stealth]", finalexpamount);
				}
				if (bSTEALTH) // ZDoom Style STEALTH = [+25%]
				{
					finalexpamount = finalexpamount * 1.25;
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxHas ZDoom(tm) Stealth (1.25x)\c-]", finalexpamount);
				}
				
				// If LEGENDARY [LDL Compatiblity]
				If (user_legendaryevolved)
				{
					finalexpamount *= 2.5;
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP: %d [\cxIs a 'Legendary' Monster? (LDL) (2.5x)\c-]", finalexpamount);
				}
				
 
				if (health <= overkillhp) // Overkilled [+12.5%]
				{
					finalexpamount *= 1.125;
					CallACS("MiscVarSetDECORATE",2022,1); // OVERKILL display color
					CallACS("MiscVarSetDECORATE",2023,39); // OVERKILL Timer Tics
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP4a: %d [\cxOVERKILL1 1.125x\c-]", finalexpamount);
				}
				if (health <= overkillhp2) // Super-Overkilled [+12.5%]
				{
					finalexpamount *= 1.125; 
					CallACS("MiscVarSetDECORATE",2022,2); // OVERKILL display color 
					CallACS("MiscVarSetDECORATE",2023,52); // OVERKILL Timer Tics 
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP4b: %d [\cxOVERKILL2 1.125x\c-]", finalexpamount);
				}
				
				finalexpamount = A_GetExperience(finalexpamount,A_GetExpMultiFactor()); // FUNCTION CALL
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP5: %d", finalexpamount);
				
				double levelcheck = 1.000 + (user_lastmonsterlevel * 0.0075); // Lvl 100 = +75% EXP (Lvl 200 = +150% EXP)
				levelcheck = clamp(levelcheck, 1.000, 16.000);
				finalexpamount = finalexpamount * levelcheck;
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP6: %d [\cxlevelcheck: %.8fx\c-] (MonsterLevel: %d)", finalexpamount, levelcheck, user_lastmonsterlevel);
				
				double expgainratio = 1.00;
				double expratiofloor = 1.00 / 32;
				double expratioceiling = 1.00 * 32;
				int leveldifference = user_lastmonsterlevel - PlayerLevel;
				double baseratio;
				// Level Differences
				if (dvds_expplayervsmonsterlevels > 0.0000)
				{
					if (leveldifference <= -101) baseratio = -7.160125;
					if (leveldifference >= -100 && leveldifference <= -76) baseratio = -4.0915;
					if (leveldifference >= -75 && leveldifference <= -51) baseratio = -2.04575;
					if (leveldifference >= -50 && leveldifference <= -36) baseratio = -1.169;
					if (leveldifference >= -35 && leveldifference <= -21) baseratio = -0.5845;
					if (leveldifference >= -20 && leveldifference <= -13) baseratio = -0.334;
					if (leveldifference >= -12 && leveldifference <= -5) baseratio = -0.167;
					if (leveldifference >= -4 && leveldifference <= 4) baseratio = 0.00;
					if (leveldifference >= 5 && leveldifference <= 12) baseratio = 0.167;
					if (leveldifference >= 13 && leveldifference <= 20) baseratio = 0.334;
					if (leveldifference >= 21 && leveldifference <= 35) baseratio = 0.5845;
					if (leveldifference >= 36 && leveldifference <= 50) baseratio = 1.169;
					if (leveldifference >= 51 && leveldifference <= 75) baseratio = 2.04575;
					if (leveldifference >= 76 && leveldifference <= 100) baseratio = 4.0915;
					if (leveldifference >= 101) baseratio = 7.160125;
					
					if (isamajorboss != 0) baseratio /= isamajorboss;
					
					expgainratio = 1.00 + (baseratio * dvds_expplayervsmonsterlevels);
					expgainratio = clamp(expgainratio, expratiofloor, expratioceiling);
					finalexpamount = finalexpamount * expgainratio;
					if (debugexp) Console.Printf("\cxAddEXP\c- - EXP?: %d [\cxexpgainratio: %.8fx\c-], MonsterLevel: %d, PlayerLevel: %d, EXPFloor: %.8fx, EXPCeiling: %.8fx, BaseRatio: %.8fx, LevelDifference: %d, isamajorboss: %d, ?: %f", finalexpamount, expgainratio, user_lastmonsterlevel, PlayerLevel, expratiofloor, expratioceiling, baseratio, leveldifference, isamajorboss, dvds_expplayervsmonsterlevels);
				}

				// Diffculty Level
				double SkillEXPMod;
				if (TrueGameSkill <= SKILL_VERY_EASY) SkillEXPMod = 1.175;
				if (TrueGameSkill == SKILL_EASY) SkillEXPMod = 1.075;
				if (TrueGameSkill == SKILL_NORMAL) SkillEXPMod = 1.0;
				if (TrueGameSkill == SKILL_HARD) SkillEXPMod = 0.9125;
				if (TrueGameSkill == SKILL_VERY_HARD) SkillEXPMod = 0.825;
				if (TrueGameSkill == SKILL_EXTREME) SkillEXPMod = 0.7375;
				if (TrueGameSkill == SKILL_HORRIBLE) SkillEXPMod = 0.65;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillEXPMod = 0.5625;
				if (TrueGameSkill == SKILL_OMEGA) SkillEXPMod = 0.475;
				finalexpamount = finalexpamount * SkillEXPMod;
				if (debugexp) Console.Printf("\cxAddEXP\c- - EXP?: %d [\cxSkillEXPMod: %.8fx\c-]", finalexpamount, SkillEXPMod);
				if (finalexpamount < 1) finalexpamount = 1;

				int PreComboEXP = finalexpamount;
				// EXP Combo Counter
				// [158] = number of enemies killed in current combo
				// [159] = current multiplier amount [xxx.xx% format]
				int combonumber = CallACS("MiscVarCheckDECORATE",158);
				double combomultiplieramt = CallACS("MiscVarCheckDECORATE",159);
				double basecombomulti = 1.334;
				if (combonumber > 1)
				{
					if (combonumber < 11)
					{
						combomultiplieramt = combonumber * (0.16 * basecombomulti);
						// Each enemy = +0.16% to the bonus multiplier [2-11 enemies killed]
					}
					else
					if (combonumber > 10 && combonumber < 21)
					{
						combomultiplieramt = combonumber * (0.17 * basecombomulti);
						// Each enemy = +0.17% to the bonus multiplier [11-20 enemies killed]
					}
					else
					if (combonumber > 20 && combonumber < 36)
					{
						combomultiplieramt = combonumber * (0.20 * basecombomulti);
						// Each enemy = +0.20% to the bonus multiplier [21-35 enemies killed]
					}
					else
					if (combonumber > 35 && combonumber < 61)
					{
						combomultiplieramt = combonumber * (0.24 * basecombomulti);
						// Each enemy = +0.24% to the bonus multiplier [36-60 enemies killed]
					}
					else
					if (combonumber > 60 && combonumber < 101)
					{
						combomultiplieramt = combonumber * (0.28 * basecombomulti);
						// Each enemy = +0.28% to the bonus multiplier [61-100 enemies killed]
					}
					else
					if (combonumber > 100 && combonumber < 201)
					{
						combomultiplieramt = combonumber * (0.34 * basecombomulti);
						// Each enemy = +0.34% to the bonus multiplier [101-200 enemies killed]
					}
					else
					if (combonumber > 200 && combonumber < 501)
					{
						combomultiplieramt = combonumber * (0.40 * basecombomulti);
						// Each enemy = +0.40% to the bonus multiplier [201-500 enemies killed]
					}
					else
					if (combonumber > 500)
					{
						combomultiplieramt = combonumber * (0.52 * basecombomulti);
						// Each enemy = +0.52% to the bonus multiplier [501+ enemies killed]
					}
					combomultiplieramt = combomultiplieramt * dvds_expcombobasemultiplier / 100;
					combomultiplieramt = clamp(combomultiplieramt, 0.01, combomultiplieramt);
					combomultiplieramt = combomultiplieramt + 100.00;
				
					finalexpamount = (finalexpamount * combomultiplieramt) / 100;
					int combomultiplieramt2 = combomultiplieramt * 100;
					CallACS("MiscVarSetDECORATE",159,combomultiplieramt2);
					if (debugexp) Console.Printf("\cxAddEXP\c- - Combo %: %3f, EXP7: %d", combomultiplieramt, finalexpamount);
				}
				
				if (finalexpamount < 1) finalexpamount = 1;
				CallACS("ExpCheat",finalexpamount,0,0);
				if (debugexp) Console.Printf("\cxAddEXP\c- - LstHPAmt: %d / OverkillHP: %d, BaseEXP: %d / FinalEXP: %d, 'Friendly' Multiplier: %.8f", health, overkillhp, baseexp, finalexpamount, KillExpMultiplier);
				
				CallACS("MiscVarSetDECORATE",2024,finalexpamount); // Total EXP for kill [for new HUD]
				CallACS("MiscVarSetDECORATE",2025,PreComboEXP); // Total EXP for kill [for new HUD]
				CallACS("MiscVarSetDECORATE",2026,78);
				
				if (dvds_expcombosystem == 1 && incrementcombo == 1) CallACS("MiscVarSetDECORATE",160,finalexpamount,1);
			}
		}
		user_legendaryevolved = 0;
	}

	// Stealth Calculations
	void A_RefreshStealthInfo(int type = 0)
	{
		/*
		STYLE_None (0)
		STYLE_Normal (1)
		STYLE_Fuzzy (2)
		STYLE_SoulTrans (3)
		STYLE_OptFuzzy (4)
		STYLE_Stencil (5)
		STYLE_Translucent (6)
		STYLE_Add (7)
		STYLE_Shaded (8)
		STYLE_TranslucentStencil (9)
		STYLE_Shadow (10)
		STYLE_Subtract (11)
		STYLE_AddStencil (12)
		STYLE_AddShaded (13)
		*/
		int dvdsdebug_evolvestealthstuff = dvdsdebug_evolvestealthstuff;
		double TempAlpha;

		if (!bSTEALTH)
		{
			if (type == 0) // nothing special
			{
				if (user_isstealth > 0)
				{
					A_SetRenderStyle(InitAlpha,6); // Set to "Translucent"
					TempAlpha = InitAlpha;
					if (dvds_rnd_stealthlevel <= 0) TempAlpha *= 0.5;
					if (dvds_rnd_stealthlevel == 1) TempAlpha *= 0.25;
					if (dvds_rnd_stealthlevel == 2) TempAlpha *= 0.125;
					if (dvds_rnd_stealthlevel == 3) TempAlpha *= 0.0625;
					if (dvds_rnd_stealthlevel >= 4) TempAlpha *= 0.03125;
					if (InitRenderType == 4) TempAlpha *= 0.5;
					if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Base - Normal]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);

					// The One Ring - Quarters Stealth Cloaking
					if (CountInv("TheOneRing",AAPTR_PLAYER1)) 
					{
						TempAlpha = 1.0 - ((1.0 - TempAlpha) * 0.25);
						if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Ring - Normal]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);
					}

					// Night-Vision - Halves Stealth Cloaking
					if (CallACS("GetBuffTimer",0) > 0)
					{
						TempAlpha = 1.0 - ((1.0 - TempAlpha) * 0.5);
						if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Night Vision - Normal]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);
					}

					Alpha = TempAlpha;
				}
				else
				{
					A_SetRenderStyle(InitAlpha,InitRenderType);
					Alpha = InitAlpha;
				}
			}

			if (type == 1) // attacking
			{
				if (user_isstealth > 0)
				{
					A_SetRenderStyle(InitAlpha,6); // Set to "Translucent"
					TempAlpha = InitAlpha;
					if (dvds_rnd_stealthlevel <= 0) TempAlpha *= 0.8334;
					if (dvds_rnd_stealthlevel == 1) TempAlpha *= 0.75;
					if (dvds_rnd_stealthlevel == 2) TempAlpha *= 0.7084;
					if (dvds_rnd_stealthlevel == 3) TempAlpha *= 0.6875;
					if (dvds_rnd_stealthlevel >= 4) TempAlpha *= 0.677083;
					if (InitRenderType == 4) TempAlpha *= 0.5;
					if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Base - Attacking]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);

					// The One Ring - Quarters Stealth Cloaking
					if (CountInv("TheOneRing",AAPTR_PLAYER1)) 
					{
						TempAlpha = 1.0 - ((1.0 - TempAlpha) * 0.25);
						if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Ring - Attacking]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);
					}

					// Night-Vision - Halves Stealth Cloaking
					if (CallACS("GetBuffTimer",0) > 0)
					{
						TempAlpha = 1.0 - ((1.0 - TempAlpha) * 0.5);
						if (dvdsdebug_evolvestealthstuff) Console.Printf("TempAlpha [Night Vision - Attacking]: %.8f (Name: %s) (InitAlpha: %.8f)", TempAlpha, GetClassName(), InitAlpha);
					}

					Alpha = TempAlpha;
				}
				else
				{
					A_SetRenderStyle(InitAlpha,InitRenderType);
					Alpha = InitAlpha;
				}
			}

			if (type == 2) // dying
			{
				A_SetRenderStyle(InitAlpha,InitRenderType);
				Alpha = InitAlpha;
			}
		}
	}

	// Ice Death
	void A_DVDSIceDeath(int baseamount = -2, int flags = 0, int incrementcombo = 1, int expfactor = 100)
	{
		A_AddEXP(baseamount, flags, incrementcombo, expfactor);
		if (bBOSS) A_DVDSBossDeath();
		bCANTSEEK = TRUE; // Prevents seeking missiles from going after frozen enemies
		bICECORPSE = TRUE; // Prevents Frost spell missiles from impacting on frozen enemies
	}

	// Death
	void A_DVDSNormalDeath(int baseamount = -2, int flags = 0, int incrementcombo = 1, int expfactor = 100)
	{
		A_AddEXP(baseamount, flags, incrementcombo, expfactor);
	}
	
	// Diabloist Gravity Attack
	void A_DiabloistGravityCheck()
	{
		gravitypulsetimer = 0;
		Actor targ = target;
		if (targ)
		{
			if (random(1,8) <= 3) user_gravitytype = 3;
											 else user_gravitytype = random(1,2);

			Actor playertarg = AetheriusPlayerPawn(target);
			if (!playertarg && user_gravitytype != 0) user_gravitytype = 1;
			//Console.Printf("user_gravitytype: %d", user_gravitytype);

			targ.A_StartSound("diabloistgravitystart", CHAN_7);
			bNOTARGETSWITCH = true;
			if (random(1,256) <= (85.334 + (user_monsterlevel/4.5))) bNOPAIN = true;
			bQUICKTORETALIATE = false;
		}
	}
	
	void A_DiabloistSpawnGravityNodes()
	{
		gravitypulsetimer = 0;
		if (user_gravitytype == 1 || user_gravitytype == 3) 
		{
			//A_Log("HP Targetter");
			if (levelbehavior && user_monsterlevel > 240) { A_VileTarget("DiabloistGravityHPTargeter3"); }
			else if (levelbehavior && user_monsterlevel > 120) { A_VileTarget("DiabloistGravityHPTargeter2"); }
			else { A_VileTarget("DiabloistGravityHPTargeter"); }
		}
		if (user_gravitytype == 2 || user_gravitytype == 3)
		{
			//A_Log("MP Targetter");
			if (levelbehavior && user_monsterlevel > 240) { A_VileTarget("DiabloistGravityManaTargeter3"); }
			else if (levelbehavior && user_monsterlevel > 120) { A_VileTarget("DiabloistGravityManaTargeter2"); }
			else { A_VileTarget("DiabloistGravityManaTargeter"); }
		}
		bNOTARGETSWITCH = true;
		bQUICKTORETALIATE = false;
	}
	
	void A_DiabloistGravityPulse(double speed)
	{
		gravitypulsetimer += speed;
		
		if ((level.time % 3) == 0)
		{
			if (bNOPAIN)
			{
				if (random (1,256) <= (32+(user_monsterlevel/100)))
				{
					if (random (1,256) <= (256+(user_monsterlevel/12.5))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (213.334+(user_monsterlevel/15))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (170.667+(user_monsterlevel/18.75))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (128+(user_monsterlevel/25))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (85.334+(user_monsterlevel/37.5))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (42.667+(user_monsterlevel/50))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
				}
			}
			else
			{
				if (random (1,256) <= (128+(user_monsterlevel/25)))
				{
					if (random (1,256) <= (256+(user_monsterlevel/12.5))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (213.334+(user_monsterlevel/15))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (170.667+(user_monsterlevel/18.75))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (128+(user_monsterlevel/25))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (85.334+(user_monsterlevel/37.5))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
					if (random (1,256) <= (42.667+(user_monsterlevel/50))) A_DVDSChase(null,null, CHF_FASTCHASE,1,3,1,1);
				}
			}
		}
		
		if (gravitypulsetimer > 22.5)
		{
			gravitypulsetimer -= 22.5;
			A_StartSound("diabloistgravitypulse", CHAN_7);
		}
	}
	
	void A_DiabloistGravity(int gravitytype)
	{
		int PlayerTHE = CallACS("MiscVarCheckDECORATE",36);
		gravitypulsetimer = 0;
		double GravityEffectFactor, FinalGravityFactor;
		int PropertyValue, TherapeusisFactor, LevelFactor;
		int basedmgratio;
		int AffectedStat, MultFactor, THEEffect;
		int InvulnerabilityTimer = CallACS("GetBuffTimer",4);
		int PrevHealth, PrevMana, PrevInvulnTimer;
		int healthdiff;
		int ptemp1, ptemp2;

		Actor targ = target;
		if (targ && targ.health > 0)
		{
			AetheriusPlayerPawn playertarg;
			playertarg = AetheriusPlayerPawn(target);
			AetheriusMonsterZSC actortarg;
			actortarg = AetheriusMonsterZSC(target);
			AetheriusPlayerPawn playerculprit;
			playerculprit = AetheriusPlayerPawn(self);
			AetheriusMonsterZSC actorculprit;
			actorculprit = AetheriusMonsterZSC(self);

			gravitytype -= 1;
			if (!playertarg && gravitytype != 0) gravitytype = 0;

			A_FaceTarget();
			if (!CheckSight(targ, 0)) return;
			if (playertarg && playertarg.CountInv("PlayerDashing")) return;

			targ.A_StartSound("diabloistgravityend", CHAN_7);

			if (playertarg)
			{
				if (InvulnerabilityTimer > 0)
				{
					//Console.Printf("gravitytype: %d [Invulnerable]", gravitytype);

					if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.0625;  
					if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.1250;  
					if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.2500;  
					if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.3750;  
					if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.4375;  
					if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.450;  
					if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.4625;  
					if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.475;  
					if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.490;
					if (gravitytype == 2) GravityEffectFactor *= 2;
					if (random(1,16) == 16) GravityEffectFactor *= 2;

					// SeedTHE Levels
					// Deggaris = 300 Needed to max out
					// Illucia = 200 Needed to max out
					// Flora = 150 Needed to max out
					if (CharacterClass == 0)
					{
						TherapeusisFactor = 300 - PlayerTHE;
						TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
						GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 300;
					}
					if (CharacterClass == 1)
					{
						TherapeusisFactor = 200 - PlayerTHE;
						TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
						GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 200;
					}
					if (CharacterClass == 2)
					{
						TherapeusisFactor = 150 - PlayerTHE;
						TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
						GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 150;
					}
					if (CharacterClass == 8)
					{
						TherapeusisFactor = 175 - PlayerTHE;
						TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
						GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 175;
					}
					if (CharacterClass == 9)
					{
						TherapeusisFactor = 225 - PlayerTHE;
						TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
						GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 225;
					}
					FinalGravityFactor = 1.000 - GravityEffectFactor;
					GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
					if (GravityEffectFactor > 0.000)
					{
						double PrevInvulnTime = InvulnerabilityTimer;
						PropertyValue = InvulnerabilityTimer;
						PropertyValue = PropertyValue * FinalGravityFactor;
						
						if (PropertyValue < 1) PropertyValue = 1;
						CallACS("GetBuffTimer",4,1,PropertyValue);
						if (playertarg) playertarg.A_SetBlend("C0 C0 C0",1.25,random(39,40));
						PrevInvulnTime -= PropertyValue;
						PrevInvulnTime /= 35;
						if (playertarg) playertarg.A_Print(String.Format("%1f second[s] of your invulnerablity were sapped!", PrevInvulnTime));
					}
				}
				else
				{
					//Console.Printf("gravitytype: %d", gravitytype);

					if (gravitytype == 0) // HP only
					{
						if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.125;  
						if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.250;  
						if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.500;  
						if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.750;  
						if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.875;  
						if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.900;  
						if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.925;  
						if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.950;  
						if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.980;
						// SeedTHE Levels
						// Deggaris = 300 Needed to max out
						// Illucia = 200 Needed to max out
						// Flora = 150 Needed to max out
						if (CharacterClass == 0)
						{
							TherapeusisFactor = 300 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 300;
						}
						if (CharacterClass == 1)
						{
							TherapeusisFactor = 200 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 200;
						}
						if (CharacterClass == 2)
						{
							TherapeusisFactor = 150 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 150;
						}
						if (CharacterClass == 8)
						{
							TherapeusisFactor = 175 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 175;
						}
						if (CharacterClass == 9)
						{
							TherapeusisFactor = 225 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 225;
						}
						FinalGravityFactor = 1.000 - GravityEffectFactor;
						GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
						if (GravityEffectFactor > 0.000)
						{
							PrevHealth = targ.health;
							PropertyValue = PrevHealth;
							PropertyValue = PropertyValue * FinalGravityFactor;
							
							ptemp1 = (630*FinalGravityFactor);
							if (dvdsdebug_regenpenaltydisplay) Console.Printf("HPPenaltyTimeAdd: %d", ptemp1);
							CallACS("MiscVarSetDECORATE",92,ptemp1,2); // HPRegenBonPenTimer
							
							if (PropertyValue < 1) PropertyValue = 1;
							targ.health = PropertyValue;
							healthdiff = (PrevHealth - PropertyValue);
							if (playertarg) playertarg.A_SetBlend("C0 00 00",1.25,random(39,40));
						}
					}
					else
					if (gravitytype == 1) // Mana only
					{
						if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.125;  
						if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.250;  
						if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.500;  
						if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.750;  
						if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.875;  
						if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.900;  
						if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.925;  
						if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.950;  
						if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.980;
						// SeedTHE Levels
						// Deggaris = 300 Needed to max out
						// Illucia = 200 Needed to max out
						// Flora = 150 Needed to max out
						if (CharacterClass == 0)
						{
							TherapeusisFactor = 300 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 300;
						}
						if (CharacterClass == 1)
						{
							TherapeusisFactor = 200 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 200;
						}
						if (CharacterClass == 2)
						{
							TherapeusisFactor = 150 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 150;
						}
						if (CharacterClass == 8)
						{
							TherapeusisFactor = 175 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 175;
						}
						if (CharacterClass == 9)
						{
							TherapeusisFactor = 225 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 225;
						}
						FinalGravityFactor = 1.000 - GravityEffectFactor;
						GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
						if (GravityEffectFactor > 0.000)
						{
							PropertyValue = CallACS("StatCheck",14);
							PropertyValue = PropertyValue * FinalGravityFactor;
							
							ptemp1 = (630*FinalGravityFactor);
							if (dvdsdebug_regenpenaltydisplay) Console.Printf("MPPenaltyTimeAdd: %d", ptemp1);
							CallACS("MiscVarSetDECORATE",93,ptemp1,2); // MPRegenBonPenTimer
							
							if (PropertyValue < 1) PropertyValue = 1;
							CallACS("OtherVarSetDECORATE",2,PropertyValue);
							if (playertarg) playertarg.A_SetBlend("00 00 C0",1.25,random(39,40));
						}
					}
					else
					if (gravitytype == 2) // HP & Mana
					{
						// HP Damage
						if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.125;  
						if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.250;  
						if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.500;  
						if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.750;  
						if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.875;  
						if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.900;  
						if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.925;  
						if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.950;  
						if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.980;
						// SeedTHE Levels
						// Deggaris = 300 Needed to max out
						// Illucia = 200 Needed to max out
						// Flora = 150 Needed to max out
						if (CharacterClass == 0)
						{
							TherapeusisFactor = 300 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 300;
						}
						if (CharacterClass == 1)
						{
							TherapeusisFactor = 200 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 200;
						}
						if (CharacterClass == 2)
						{
							TherapeusisFactor = 150 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 150;
						}
						if (CharacterClass == 8)
						{
							TherapeusisFactor = 175 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 175;
						}
						if (CharacterClass == 9)
						{
							TherapeusisFactor = 225 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 225;
						}
						FinalGravityFactor = 1.000 - GravityEffectFactor;
						GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
						if (GravityEffectFactor > 0.000)
						{
							PrevHealth = targ.health;
							PropertyValue = PrevHealth;
							PropertyValue = PropertyValue * FinalGravityFactor;
							
							ptemp1 = (420*FinalGravityFactor);
							if (dvdsdebug_regenpenaltydisplay) Console.Printf("HPPenaltyTimeAdd: %d", ptemp1);
							CallACS("MiscVarSetDECORATE",92,ptemp1,2); // HPRegenBonPenTimer
							
							if (PropertyValue < 1) PropertyValue = 1;
							targ.health = PropertyValue;
							healthdiff = (PrevHealth - PropertyValue);
						}
						
						// MP Damage
						if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.125;  
						if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.250;  
						if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.500;  
						if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.750;  
						if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.875;  
						if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.900;  
						if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.925;  
						if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.950;  
						if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.980;
						if (random(1,16) != 16) GravityEffectFactor /= 2;
						// SeedTHE Levels
						// Deggaris = 300 Needed to max out
						// Illucia = 200 Needed to max out
						// Flora = 150 Needed to max out
						if (CharacterClass == 0)
						{
							TherapeusisFactor = 300 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 300;
						}
						if (CharacterClass == 1)
						{
							TherapeusisFactor = 200 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 200;
						}
						if (CharacterClass == 2)
						{
							TherapeusisFactor = 150 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 150;
						}
						if (CharacterClass == 8)
						{
							TherapeusisFactor = 175 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 175;
						}
						if (CharacterClass == 9)
						{
							TherapeusisFactor = 225 - PlayerTHE;
							TherapeusisFactor = clamp(TherapeusisFactor, 0, TherapeusisFactor);
							GravityEffectFactor = GravityEffectFactor * TherapeusisFactor / 225;
						}
						FinalGravityFactor = 1.000 - GravityEffectFactor;
						GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
						if (GravityEffectFactor > 0.000)
						{
							PropertyValue = CallACS("StatCheck",14);
							PropertyValue = PropertyValue * FinalGravityFactor;
							
							ptemp1 = (420*FinalGravityFactor);
							if (dvdsdebug_regenpenaltydisplay) Console.Printf("MPPenaltyTimeAdd: %d", ptemp1);
							CallACS("MiscVarSetDECORATE",93,ptemp1,2); // MPRegenBonPenTimer
							
							if (PropertyValue < 1) PropertyValue = 1;
							CallACS("OtherVarSetDECORATE",2,PropertyValue);
						}
						if (playertarg) playertarg.A_SetBlend("C0 00 C0",1.25,random(39,40));
					}
					
					// Inflict Possible Blindness
					if (playertarg && random(1,32) <= 1) ACS_NamedExecuteAlways("BuffTimer",0,8,19,random(17,51));
				}
			}
			else
			{
				if (TrueGameSkill <= SKILL_VERY_EASY) GravityEffectFactor = 0.125;  
				if (TrueGameSkill == SKILL_EASY) GravityEffectFactor = 0.250;  
				if (TrueGameSkill == SKILL_NORMAL) GravityEffectFactor = 0.500;  
				if (TrueGameSkill == SKILL_HARD) GravityEffectFactor = 0.750;  
				if (TrueGameSkill == SKILL_VERY_HARD) GravityEffectFactor = 0.875;  
				if (TrueGameSkill == SKILL_EXTREME) GravityEffectFactor = 0.900;  
				if (TrueGameSkill == SKILL_HORRIBLE) GravityEffectFactor = 0.925;  
				if (TrueGameSkill == SKILL_IMPOSSIBLE) GravityEffectFactor = 0.950;  
				if (TrueGameSkill >= SKILL_OMEGA) GravityEffectFactor = 0.980;

				LevelFactor = 512 - user_monsterlevel;
				GravityEffectFactor = GravityEffectFactor * LevelFactor / 512;

				FinalGravityFactor = 1.000 - GravityEffectFactor;
				GravityEffectFactor = clamp(GravityEffectFactor, 0.000, GravityEffectFactor);
				if (GravityEffectFactor > 0.000)
				{
					PrevHealth = targ.health;
					PropertyValue = PrevHealth;
					PropertyValue *= FinalGravityFactor;
				
					if (PropertyValue < 1) PropertyValue = 1;
					targ.health = PropertyValue;
					healthdiff = (PrevHealth - PropertyValue);
				}
			}
			
			// Print Outs
			if (healthdiff)
			{
				string culprit = GetClassName();
				string victim;
				
				string friendmsg = " \cn(F)\c-";
				string charmmsg = " \cx(C)\c-";
				
				if ((playertarg && (dvds_showdamagemessages & 1)) || (actortarg && (dvds_showdamagemessages & 2)))
				{
					if (playertarg) victim = playertarg.GetClassName();
					if (actortarg) victim = actortarg.GetClassName();
					if (dvds_showdamagemessageactortags)
					{
						culprit = GetTag("");
						if (playertarg) victim = playertarg.GetTag("");
						if (actortarg) victim = actortarg.GetTag("");
					}
					string DamageMessage = " \c[white]* ";
					DamageMessage.AppendFormat("\cy%d\c- ", healthdiff);
					DamageMessage.AppendFormat("\c[purple]Gravity\c- ");
					DamageMessage.AppendFormat("\c[red]Damage\c-");
					DamageMessage.AppendFormat(" dealt to \cx%s\c-", victim);
					if (actortarg)
					{
						if (actortarg.health > 0) DamageMessage.AppendFormat(" \cx[L%d]\c-", actortarg.user_monsterlevel);
																 else DamageMessage.AppendFormat(" \cx[L%d]\c-", actortarg.user_lastmonsterlevel);
					}
					if (actortarg && actortarg.bFRIENDLY) 
					{
						if (actortarg && actortarg.user_charmed) DamageMessage.AppendFormat(charmmsg);
																								else DamageMessage.AppendFormat(friendmsg);
					}
					DamageMessage.AppendFormat(" by \cw%s's\c-", culprit);
					if (actorculprit && actorculprit.user_monsterlevel >= 0) DamageMessage.AppendFormat(" \cw[L%d]\c-", actorculprit.user_monsterlevel);
					if (actorculprit && actorculprit.bFRIENDLY)
					{
						if (actorculprit && actorculprit.user_charmed) DamageMessage.AppendFormat(charmmsg);
																											else DamageMessage.AppendFormat(friendmsg);
					}
					DamageMessage.AppendFormat(" \czGraviton Glare\c-!");
					if (dvds_showdamagemessagedebug) DamageMessage.AppendFormat(" (%d)", gametic);
					
					Console.Printf("%s", DamageMessage);
				}
			}
		}
		bQUICKTORETALIATE = true;
		bNOPAIN = false;
		bNOTARGETSWITCH = false;
	}
	
	//**************************
	//*HERETIC-UNIQUE FUNCTIONS*
	//**************************
	// Gargoyle
	void A_ImpMsAttack()
	{
		if (!target || random[ImpMSAtk]() > 64)
		{
			SetState (SeeState);
			return;
		}
		A_SkullAttack(12);
	}

	void A_ImpExplode()
	{
		Actor chunk;

		bNoGravity = false;

		chunk = Spawn("HereticImpChunk1", pos, ALLOW_REPLACE);
		if (chunk != null)
		{
			chunk.vel.x = random2[ImpExplode]() / 64.;
			chunk.vel.y = random2[ImpExplode]() / 64.;
			chunk.vel.z = 9;
		}

		chunk = Spawn("HereticImpChunk2", pos, ALLOW_REPLACE);
		if (chunk != null)
		{
			chunk.vel.x = random2[ImpExplode]() / 64.;
			chunk.vel.y = random2[ImpExplode]() / 64.;
			chunk.vel.z = 9;
		}
		
		if (extremecrash)
		{
			SetStateLabel ("XCrash");
		}
	}

 	void A_ImpDeath()
	{
		bSolid = false;
		bFloorClip = true;
	}

	void A_ImpXDeath1()
	{
		bSolid = false;
		bFloorClip = true;
		bNoGravity = true;
		extremecrash = true;
	}

	// Knight
	void A_KnightAttack ()
	{
		if (!target) return;
		if (CheckMeleeRange ())
		{
			int damage = random[KnightAttack](1, 8) * 3;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			A_StartSound("hknight/melee", CHAN_BODY);
			return;
		}
		// Throw axe
		A_StartSound(AttackSound, CHAN_BODY);
		if (self.bShadow || random[KnightAttack]() < 40)
		{
			// Red axe
			SpawnMissileZ (pos.Z + 36, target, "RedAxe");
		}
		else
		{
			// Green axe
			SpawnMissileZ (pos.Z + 36, target, "KnightAxe");
		}
	}

	// Disciple
	void A_GhostOff ()
	{
		A_SetRenderStyle(1.0, STYLE_Normal);
		bGhost = false;
	}

	void A_WizAtk1 ()
	{
		A_FaceTarget ();
		A_GhostOff();
	}

	void A_WizAtk2 ()
	{
		A_FaceTarget ();
		A_SetRenderStyle(HR_SHADOW, STYLE_Translucent);
		bGhost = true;
	}

	// Disciple Shot [Heretic]
	void A_WizAtk3 (string missiletype = "WizardFX1New", string crisismissiletype = "WizardFX1Crisis", int meleedamage = 4, bool playcrisissound = 1)
	{
		A_GhostOff();
		if (!target) return;
		A_StartSound(AttackSound, CHAN_WEAPON);
		if (CheckMeleeRange())
		{
			if (user_canusecrisisatk == 1) { meleedamage *= CrisisMultiplier; if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } }
			int damage = meleedamage;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			return;
		}

		if (user_canusecrisisatk == 1) 
		{
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
			Actor mo = SpawnMissile (target, crisismissiletype);
			if (mo != null)
			{
				SpawnMissileAngle(crisismissiletype, mo.Angle - 45. / 8, mo.Vel.Z);
				SpawnMissileAngle(crisismissiletype, mo.Angle + 45. / 8, mo.Vel.Z);
			}
		}
		else
		{
			Actor mo = SpawnMissile (target, missiletype);
			if (mo != null)
			{
				SpawnMissileAngle(missiletype, mo.Angle - 45. / 8, mo.Vel.Z);
				SpawnMissileAngle(missiletype, mo.Angle + 45. / 8, mo.Vel.Z);
			}
		}
	}

	// Iron Lich
	void A_LichAttack (int fireshots = 5, int tornados = 1, int meleedamage = 6, string icemissile = "HeadFX1New", string icemissilecrisis = "HeadFX1Crisis", string firemissile = "HeadFX3New", string firemissilecrisis = "HeadFX3Crisis", string twistermissile = "WhirlwindNew", string twistermissilecrisis = "WhirlwindCrisis", bool playcrisissound = 1)
	{
		static const int atkResolve1[] = { 50, 150 };
		static const int atkResolve2[] = { 150, 200 };

		// Ice ball		(close 20% : far 60%)
		// Fire column	(close 40% : far 20%)
		// Whirlwind	(close 40% : far 20%)
		// Distance threshold = 8 cells

		if (target == null)
		{
			return;
		}
		A_FaceTarget ();
		if (CheckMeleeRange ())
		{
			A_MonsterCrisisCheck(); // LichAttack - Melee
			if (user_canusecrisisatk == 1) 
			{ 
				if (playcrisissound == 1) { A_PlayCrisisAtkSound(); } 
				meleedamage *= CrisisMultiplier; 
			}
			int damage = meleedamage;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			return;
		}
		int dist = Distance2D(target) > 8 * 64;
		int randAttack = random[LichAttack]();
		if (randAttack < atkResolve1[dist])
		{
			// Ice ball
			A_MonsterCrisisCheck(); // LichAttack - Ice Ball
			if (user_canusecrisisatk == 1) 
			{
				if (playcrisissound == 1) { A_PlayCrisisAtkSound(); }
				SpawnMissile (target, icemissilecrisis); 
			}
			else 
			{
				SpawnMissile (target, icemissile); 
			}
			A_StartSound("ironlich/attack2", CHAN_BODY);
		}
		else if (randAttack < atkResolve2[dist])
		{
			// Fire column
			string firetype = firemissile;
			A_MonsterCrisisCheck(); // LichAttack - Fire Wall/Column
			if (user_canusecrisisatk == 1) { firetype = firemissilecrisis; }
			Actor baseFire = SpawnMissile (target, firetype);
			if (baseFire != null)
			{
				baseFire.SetStateLabel("NoGrow");
				for (int i = 0; i < fireshots; i++)
				{
					Actor fire = Spawn(firetype, baseFire.Pos, ALLOW_REPLACE);
					if (i == 0)
					{
						A_StartSound("ironlich/attack1", CHAN_BODY);
					}
					if (fire != null)
					{
						fire.target = baseFire.target;
						fire.angle = baseFire.angle;
						fire.Vel = baseFire.Vel;
						fire.SetDamage(0);
						fire.health = (i+1) * 2;
						fire.CheckMissileSpawn (radius);
					}
				}
			}
		}
		else
		{
			// Whirlwind
			for (int i = 0; i < tornados; i++)
			{
				string twistertype = twistermissile;
				A_MonsterCrisisCheck(); // LichAttack - Whirlwind
				if (user_canusecrisisatk == 1) { twistertype = twistermissilecrisis; }
				Actor mo = SpawnMissile (target, twistertype);
				if (mo != null)
				{
					mo.AddZ(-32+(i*16));
					mo.tracer = target;
					mo.health = 20*TICRATE; // Duration
					A_StartSound("ironlich/attack3", CHAN_BODY);
				}
			}
		}
	}

	//************************
	//*HEXEN-UNIQUE FUNCTIONS*
	//************************
	// Centaur
	void A_CentaurDefend()
	{
		A_FaceTarget ();
		if (CheckMeleeRange() && random[CentaurDefend]() < 32)
		{
			// This should unset REFLECTIVE as well
			// (unless you want the Centaur to reflect projectiles forever!)
			bReflective = false;
			bInvulnerable = false;
			SetState(MeleeState);
		}
	}

    // Afrit
	private void A_FiredSpawnRock ()
	{
		Actor mo;
		class<Actor> rtype;

		switch (random[FireDemonRock](0, 4))
		{
			case 0:
				rtype = "FireDemonRock1";
				break;
			case 1:
				rtype = "FireDemonRock2";
				break;
			case 2:
				rtype = "FireDemonRock3";
				break;
			case 3:
				rtype = "FireDemonRock4";
				break;
			case 4:
			default:
				rtype = "FireDemonRock5";
				break;
		}

		double xo = (random[FireDemonRock]() - 128) / 16.;
		double yo = (random[FireDemonRock]() - 128) / 16.;
		double zo = random[FireDemonRock]() / 32.;
		mo = Spawn (rtype, Vec3Offset(xo, yo, zo), ALLOW_REPLACE);
		if (mo)
		{
			mo.target = self;
			mo.Vel.X = (random[FireDemonRock]() - 128) / 64.;
			mo.Vel.Y = (random[FireDemonRock]() - 128) / 64.;
			mo.Vel.Z = (random[FireDemonRock]() / 64.);
			mo.special1 = 2;		// Number bounces
		}

		// Initialize fire demon
		fdstrafecount = 0;
		bJustAttacked = false;
	}

	void A_FiredRocks()
	{
		A_FiredSpawnRock ();
		A_FiredSpawnRock ();
		A_FiredSpawnRock ();
		A_FiredSpawnRock ();
		A_FiredSpawnRock ();
	}

	void A_FiredAttack()
	{
		if (target == null)	return;
		Actor mo = SpawnMissile (target, "FireDemonMissile");
		if (mo) A_StartSound("FireDemonAttack", CHAN_BODY);
	}

	void A_FireDChase(int minheight = 64, int strafecnt = 3, int strafechance = 30, int atkchance = 20, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
			if (value6) value6 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap
			if (value6 <= 0) value6 = 8; // move/thrust strength

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_FireDChase]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}
		
		int weaveindex = special1;
		double ang;
		double dist;

		if (reactiontime) reactiontime--;
		if (threshold) threshold--;

		// Float up and down
		AddZ(BobSin(weaveindex));
		special1 = (weaveindex + 2) & 63;

		// Ensure it stays above certain height
		if (pos.Z < floorz + minheight)
		{
			AddZ(2);
		}

		if (!target || !target.bShootable)
		{
			// Invalid target
			LookForPlayers (true);
			return;
		}

		// Strafe
		if (fdstrafecount > 0)
		{
			fdstrafecount--;
		}
		else
		{
			fdstrafecount = 0;
			Vel.X = Vel.Y = 0;
			dist = Distance2D(target);
			if (dist < FIREDEMON_ATTACK_RANGE)
			{
				if (random[FiredChase]() < strafechance)
				{
					ang = AngleTo(target);
					if (random[FiredChase]() < 128)
						ang += 90;
					else
						ang -= 90;
					Thrust(value6, ang); // value6 = thrust [8]
					fdstrafecount = strafecnt;	// strafe time
				}
			}
		}

		FaceMovementDirection ();

		// Normal movement
		if (!fdstrafecount)
		{
			if ((movecount -= 1) < 0 || !MonsterMove ())
			{
				NewChaseDir ();
			}
		}

		// Do missile attack
		if (!bJustAttacked)
		{
			if (CheckMissileRange () && (random[FiredChase]() < 20))
			{
				if (!target || !target.bShootable || target.health < 1)
				{
					// Invalid target
					LookForPlayers (true);
					return;
				}
				else
				{
					SetState (MissileState);
					bJustAttacked = true;
					return;
				}
			}
		}
		else
		{
			bJustAttacked = false;
		}

		// make active sound
		if (random[FiredChase]() < 3)
		{
			PlayActiveSound ();
		}
	}

	void A_FiredSplotch()
	{
		Actor mo;

		mo = Spawn ("FireDemonSplotch1", Pos, ALLOW_REPLACE);
		if (mo)
		{
			mo.Vel.X = (random[FireDemonSplotch]() - 128) / 32.;
			mo.Vel.Y = (random[FireDemonSplotch]() - 128) / 32.;
			mo.Vel.Z = (random[FireDemonSplotch]() / 64.) + 3;
		}
		mo = Spawn ("FireDemonSplotch2", Pos, ALLOW_REPLACE);
		if (mo)
		{
			mo.Vel.X = (random[FireDemonSplotch]() - 128) / 32.;
			mo.Vel.Y = (random[FireDemonSplotch]() - 128) / 32.;
			mo.Vel.Z = (random[FireDemonSplotch]() / 64.) + 3;
		}
	}
	
	// Bishop
	void A_BishopAttack(int meleedmg = 4, int missilenum = 5)
	{
		if (!target)
		{
			return;
		}
		A_StartSound(AttackSound, CHAN_BODY);
		if (CheckMeleeRange())
		{
			A_MonsterCrisisCheck(); // A_BishopAttack - Melee
			if (user_canusecrisisatk == 1) 
			{
				meleedmg *= CrisisMultiplier;
				A_PlayCrisisAtkSound();
			}
			int damage = meleedmg;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			return;
		}
		missilecount = missilenum;
	}

	void A_BishopAttack2(string missiletype = "BishopFX", string crisismissiletype = "BishopFXCrisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // BishopAttack2 - Missiles
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; }

		if (!target || !missilecount)
		{
			missilecount = 0;
			SetState (SeeState);
			return;
		}
		Actor mo = SpawnMissile (target, atktype);
		if (mo != null)
		{
			mo.tracer = target;
			if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound();
		}
		missilecount--;
		return;
	}
	
	void A_BishopDecide()
	{
		if (!target) { return; }

		if (random[BishopDecide]() >= 220)
		{
			SetStateLabel ("Blur");
		}
	}

	void A_BishopDoBlur(int blurrand = 3, int blurnum = 3, double thrustamt = 11.0)
	{
		if (!target) { return; }

		missilecount = (random[BishopDoBlur]() & blurrand) + blurnum; // Random number of blurs
		if (random[BishopDoBlur]() <= 224)
		{
			if (random(1,2) == 1)
			{
				Thrust(thrustamt, Angle + 90);
			}
			else
			{
				Thrust(thrustamt, Angle - 90);
			}
		}
		else
		{
			if (random(1,2) == 1)
			{
				// Thrust Backwards
				Thrust(thrustamt, Angle - 180);
			}
			else
			{
				// Thrust forward
				Thrust(thrustamt, Angle + 0);
			}
		}
		A_StartSound("BishopBlur", CHAN_BODY);
	}

	void A_BishopSpawnBlur(int seestatechance = 96)
	{
		if (!--missilecount)
		{
			Vel.XY = (0,0);// = Vel.Y = 0;
			if (random[BishopSpawnBlur]() > seestatechance)
			{
				SetState (SeeState);
			}
			else
			{
				SetState (MissileState);
			}
		}
		Actor mo = Spawn ("BishopBlur", Pos, ALLOW_REPLACE);
		if (mo)
		{
			mo.angle = angle;
		}
	}

	void A_BishopChase(int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
			if (value6) value6 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_BishopChase]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}

		double newz = pos.z - BobSin(bobstate) / 2.;
		bobstate = (bobstate + 4) & 63;
		newz += BobSin(bobstate) / 2.;
		SetZ(newz);
	}

	void A_BishopPainBlur(int chance = 64, double xveldiv = 16.0, double yveldiv = 16.0, double zveldiv = 32.0)
	{
		if (random[BishopPainBlur]() <= chance)
		{
			SetStateLabel ("Blur");
			return;
		}
		double xo = random2[BishopPainBlur]() / xveldiv;
		double yo = random2[BishopPainBlur]() / yveldiv;
		double zo = random2[BishopPainBlur]() / zveldiv;
		Actor mo = Spawn ("BishopPainBlur", Vec3Offset(xo, yo, zo), ALLOW_REPLACE);
		if (mo)
		{
			mo.angle = angle;
		}
	}

	// Stalker
	void A_SerpentUnHide()
	{
		bInvisible = false;
		Floorclip = 24;
	}
	void A_SerpentHide()
	{
		bInvisible = true;
		Floorclip = 0;
	}

	void A_SerpentRaiseHump()
	{
		Floorclip -= 4;
	}
	void A_SerpentLowerHump()
	{
		Floorclip += 4;
	}
	void A_SerpentHumpDecide()
	{
		if (MissileState != NULL)
		{
			if (random[SerpentHump]() > 30)
			{
				return;
			}
			else if (random[SerpentHump]() < 40)
			{
				// Missile attack
				SetState (MeleeState);
				return;
			}
		}
		else if (random[SerpentHump]() > 3)
		{
			return;
		}
		if (!CheckMeleeRange ())
		{
			// The hump shouldn't occur when within melee range
			if (MissileState != NULL && random[SerpentHump]() < 128)
			{
				SetState (MeleeState);
			}
			else
			{
				SetStateLabel("Hump");
				A_StartSound("SerpentActive", CHAN_BODY);
			}
		}
	}
	
	void A_SerpentCheckForAttack()
	{
		if (!target)
		{
			return;
		}
		if (MissileState != NULL)
		{
			if (!CheckMeleeRange ())
			{
				SetStateLabel ("Attack");
				return;
			}
		}
		if (CheckMeleeRange2 ())
		{
			SetStateLabel ("Walk");
		}
		else if (CheckMeleeRange ())
		{
			if (random[SerpentAttack]() < 32)
			{
				SetStateLabel ("Walk");
			}
			else
			{
				SetStateLabel ("Attack");
			}
		}
	}

	void A_SerpentChooseAttack()
	{
		if (!target || CheckMeleeRange())
		{
			return;
		}
		if (MissileState != NULL)
		{
			SetState (MissileState);
		}
	}

	void A_SerpentMeleeAttack()
	{
		if (!target)
		{
			return;
		}
		if (CheckMeleeRange ())
		{
			int damage = random[SerpentAttack](1, 8) * 5;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			A_StartSound("SerpentMeleeHit", CHAN_BODY);
		}
		if (random[SerpentAttack]() < 96)
		{
			A_SerpentCheckForAttack();
		}
	}

	void A_SerpentSpawnGibs()
	{
		static const class<Actor> GibTypes[] =
		{
			"SerpentGib3",
			"SerpentGib2",
			"SerpentGib1"
		};

		for (int i = 2; i >= 0; --i)
		{
			double x = (random[SerpentGibs]() - 128) / 16.;
			double y = (random[SerpentGibs]() - 128) / 16.;

			Actor mo = Spawn (GibTypes[i], Vec2OffsetZ(x, y, floorz + 1), ALLOW_REPLACE);
			if (mo)
			{
				mo.Vel.X = (random[SerpentGibs]() - 128) / 1024.f;
				mo.Vel.Y = (random[SerpentGibs]() - 128) / 1024.f;
				mo.Floorclip = 6;
			}
		}
	}

    // Reiver
	void A_WraithInit()
	{
		AddZ(48);

		// [RH] Make sure the wraith didn't go into the ceiling
		if (pos.z + height > ceilingz)
		{
			SetZ(ceilingz - Height);
		}

		WeaveIndexZ = 0;			// index into floatbob
	}

	void A_WraithChase(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_WraithChase]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}
		
		int weaveindex = WeaveIndexZ;
		AddZ(BobSin(weaveindex));
		WeaveIndexZ = (weaveindex + 2) & 63;
		A_Chase(melee,missile,flags);
		A_WraithFX4 ();
	}

	void A_WraithFX3()
	{
		int numdropped = random[WraithFX3](0,14);

		while (numdropped-- > 0)
		{
			double xo = (random[WraithFX3]() - 128) / 32.;
			double yo = (random[WraithFX3]() - 128) / 32.;
			double zo = random[WraithFX3]() / 64.;

			Actor mo = Spawn("WraithFX3", Vec3Offset(xo, yo, zo), ALLOW_REPLACE);
			if (mo)
			{
				mo.floorz = floorz;
				mo.ceilingz = ceilingz;
				mo.target = self;
			}
		}
	}

	void A_WraithFX4 ()
	{
		int chance = random[WraithFX4]();
		bool spawn4, spawn5;

		if (chance < 10)
		{
			spawn4 = true;
			spawn5 = false;
		}
		else if (chance < 20)
		{
			spawn4 = false;
			spawn5 = true;
		}
		else if (chance < 25)
		{
			spawn4 = true;
			spawn5 = true;
		}
		else
		{
			spawn4 = false;
			spawn5 = false;
		}

		if (spawn4)
		{
			double xo = (random[WraithFX4]() - 128) / 16.;
			double yo = (random[WraithFX4]() - 128) / 16.;
			double zo = (random[WraithFX4]() / 64.);

			Actor mo = Spawn ("WraithFX4", Vec3Offset(xo, yo, zo), ALLOW_REPLACE);
			if (mo)
			{
				mo.floorz = floorz;
				mo.ceilingz = ceilingz;
				mo.target = self;
			}
		}
		if (spawn5)
		{
			double xo = (random[WraithFX4]() - 128) / 32.;
			double yo = (random[WraithFX4]() - 128) / 32.;
			double zo = (random[WraithFX4]() / 64.);

			Actor mo = Spawn ("WraithFX5", Vec3Offset(xo, yo, zo), ALLOW_REPLACE);
			if (mo)
			{
				mo.floorz = floorz;
				mo.ceilingz = ceilingz;
				mo.target = self;
			}
		}
	}
	
	void A_WraithMelee(int drainamount)
	{
		int maxdrain;
		if (drainamount == 0) drainamount = random[StealHealth](1,8)*2;

		if (user_MaxHP <= 0) maxdrain = spawnhealth(); else maxdrain = user_MaxHP;
		// Steal health from target and give to self
		if (CheckMeleeRange() && (random[StealHealth]() < maxdrain))
		{
			A_MonsterCrisisCheck(); // WraithMelee - Life Drain
			if (user_canusecrisisatk == 1) 
			{
				drainamount *= CrisisMultiplier;
				A_PlayCrisisAtkSound(); 
			}
			int amount = drainamount;
			amount = target.DamageMobj (self, self, amount, 'Melee');
			if (health < maxdrain && target.bINVULNERABLE == 0)
			{
				health += (amount * frandom(0.45,0.65));
				health = clamp(health, health, maxdrain);
			}
		}
	}

	void A_WraithRaiseInit()
	{
		bInvisible = false;
		bNonShootable = false;
		bDontBlast = false;
		bShootable = true;
		bSolid = true;
		Floorclip = Height;
	}

	void A_WraithRaise()
	{
		if (RaiseMobj (2))
		{
			// Reached it's target height
			// [RH] Once a buried wraith is fully raised, it should be
			// morphable, right?
			bDontMorph = false;
			bSpecialFloorClip = false;
			SetStateLabel ("Chase");
			// [RH] Reset PainChance to a normal wraith's.
			PainChance = GetDefaultByType("Wraith").PainChance;
		}

		SpawnDirt (radius);
	}

	// Wendigo
	private void SpawnWisp()
	{
		static const class<Actor> WispTypes[] = { "IceGuyWisp1", "IceGuyWisp2" };

		double dist = (random[IceGuyLook]() - 128) * radius / 128.;
		double an = angle + 90;
		Actor mo = Spawn(WispTypes[random[IceGuyLook]() & 1], Vec3Angle(dist, an, 60.), ALLOW_REPLACE);
		if (mo)
		{
			mo.Vel = Vel;
			mo.target = self;
		}
	}

	void A_IceGuyLook()
	{
		A_Look();
		if (random[IceGuyLook]() < 64) SpawnWisp();
	}

	void A_IceGuyChase(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		if (type == 0)
		{
			if (value1) value1 = 0;
			if (value2) value2 = 0;
			if (value3) value3 = 0;
			if (value4) value4 = 0;
			if (value5) value5 = 0;
		}
		if (type == 1)
		{
			if (value1 <= 0) value1 = 3; // ticdecrement
			if (value2 <= 0) value2 = 1; // speedtimerdecrement
			if (value3 <= 0) value3 = 1; // lowcap

			if (specialspeed1)
			{
				specialspeed1 -= value2;
				tics -= value1;
				if (tics < value3) tics = value3;
				if (dvdsdebug_showactormoveinformation) Console.Printf("\cx(%s) (gametic: %d) [A_IceGuyChase]\c- specialspeed1: %d, ticdecrement: %d, speedtimerdecrement: %d, lowcap: %d \cytics: %d\c-", GetClassName(), gametic, specialspeed1, value1, value2, value3, tics);
			}
		}
		
		A_Chase(melee,missile,flags);
		if (random[IceGuyLook]() < 128) SpawnWisp();
	}

	void A_IceGuyAttack(string missiletype = "IceGuyFXNew", string crisismissiletype = "IceGuyFXCrisis", bool playcrisissound = 1)
	{
		if (!target) 
		{
			return;
		}
		string specialmissile = missiletype;

		A_MonsterCrisisCheck(); // IceGuyAttack
		if (user_canusecrisisatk == 1)
		{
			if (playcrisissound == 1) { A_PlayCrisisAtkSound(); A_PlayCrisisAtkSound(); } 
			specialmissile = crisismissiletype;
		}

		SpawnMissileXYZ(Vec3Angle(radius / 2, angle + 90, 40.), target, specialmissile);
		SpawnMissileXYZ(Vec3Angle(radius / 2, angle - 90, 40.), target, specialmissile);
		A_StartSound(AttackSound, CHAN_WEAPON);
	}
	
    // Death Wyvern
	private void DragonSeek (double thresh, double turnMax, int meleedamage, string missiletype = "DragonFireball", string crisismissiletype = "DragonFireballCrisis")
	{
		double dist;
		double delta;
		Actor targ;
		int i;
		double bestAngle;
		double angleToSpot, angleToTarget;
		Actor mo;

		targ = tracer;
		if (targ == null)
		{
			return;
		}

		double diff = deltaangle(angle, AngleTo(targ));
		delta = abs(diff);

		if (delta > thresh)
		{
			delta /= 2;
			if (delta > turnMax)
			{
				delta = turnMax;
			}
		}
		if (diff > 0)
		{
			// Turn clockwise
			angle = angle + delta;
		}
		else
		{
			// Turn counter clockwise
			angle = angle - delta;
		}
		VelFromAngle();

		dist = DistanceBySpeed(targ, Speed);
		if (pos.z + height < targ.pos.z || targ.pos.z + targ.height < pos.z)
		{
			Vel.Z = (targ.pos.z - pos.z) / dist;
		}
		if (targ.bShootable && random[DragonSeek]() < 64)
		{
			// attack the destination mobj if it's attackable
			Actor oldTarget;
			
			if (absangle(angle, AngleTo(targ)) < 22.5)
			{
				oldTarget = target;
				target = targ;
				if (CheckMeleeRange ())
				{
					A_MonsterCrisisCheck(); // DragonSeek - Melee
					int basedmg = meleedamage;
					if (user_canusecrisisatk == 1) 
					{
						basedmg *= CrisisMultiplier;	
						A_PlayCrisisAtkSound();
					}

					int damage = basedmg;
					int newdam = target.DamageMobj (self, self, damage, 'Melee');
					target.TraceBleed (newdam > 0 ? newdam : damage, self);
					A_StartSound(AttackSound, CHAN_WEAPON);
				}
				else if (random[DragonSeek]() < 128 && CheckMissileRange())
				{
					string atktype = missiletype;
					A_MonsterCrisisCheck(); // DragonSeek - Missile
					if (user_canusecrisisatk == 1)
					{
						A_PlayCrisisAtkSound();
						atktype = crisismissiletype;
					}
					SpawnMissile(targ, atktype);		
					A_StartSound(AttackSound, CHAN_WEAPON);
				}
				target = oldTarget;
			}
		}
		if (dist < 4)
		{
			// Hit the target thing
			if (target && random[DragonSeek]() < 200)
			{
				Actor bestActor = null;
				bestAngle = 360.;
				angleToTarget = AngleTo(target);
				for (i = 0; i < 5; i++)
				{
					if (!targ.args[i])
					{
						continue;
					}
					ActorIterator iter = Level.CreateActorIterator(targ.args[i]);
					mo = iter.Next ();
					if (mo == null)
					{
						continue;
					}
					angleToSpot = AngleTo(mo);
					double diff = absangle(angleToSpot, angleToTarget);
					if (diff < bestAngle)
					{
						bestAngle = diff;
						bestActor = mo;
					}
				}
				if (bestActor != null)
				{
					tracer = bestActor;
				}
			}
			else
			{
				// [RH] Don't lock up if the dragon doesn't have any
				// targs defined
				for (i = 0; i < 5; ++i)
				{
					if (targ.args[i] != 0)
					{
						break;
					}
				}
				if (i < 5)
				{
					do
					{
						i = (random[DragonSeek]() >> 2) % 5;
					} while(!targ.args[i]);
					ActorIterator iter = Level.CreateActorIterator(targ.args[i]);
					tracer = iter.Next ();
				}
			}
		}
	}

	void A_DragonInitFlight()
	{
		ActorIterator iter = Level.CreateActorIterator(tid);

		do
		{
			// find the first tid identical to the dragon's tid
			tracer = iter.Next ();
			if (tracer == null)
			{
				SetState (SpawnState);
				return;
			}
		} while (tracer == self);
		RemoveFromHash ();
	}

	void A_DragonFlight(double thresh = 4., double turnMax = 8., int meleedamage = 10, string missiletype = "DragonFireball", string crisismissiletype = "DragonFireballCrisis")
	{
		double ang;

		DragonSeek (thresh, turnMax, meleedamage, missiletype, crisismissiletype);
		if (target)
		{
			if (!target.bShootable)
			{
				// target died
				target = null;
				return;
			}
			ang = absangle(angle, AngleTo(target));
			if (ang <22.5 && CheckMeleeRange())
			{
				int basedmg = meleedamage;
				A_MonsterCrisisCheck(); // DragonFlight - Melee
				if (user_canusecrisisatk == 1) 
				{
					basedmg *= CrisisMultiplier;	
					A_PlayCrisisAtkSound();
				}

				int damage = basedmg;
				int newdam = target.DamageMobj (self, self, damage, 'Melee');
				target.TraceBleed (newdam > 0 ? newdam : damage, self);
				A_StartSound(AttackSound, CHAN_WEAPON);
			}
			else if (ang <= 20)
			{
				SetState (MissileState);
				A_StartSound(AttackSound, CHAN_WEAPON);
			}
		}
		else
		{
			LookForPlayers (true);
		}
	}

	void A_DragonFlap(double thresh = 4., double turnMax = 8., int meleedamage = 10, string missiletype = "DragonFireball", string crisismissiletype = "DragonFireballCrisis")
	{
		A_DragonFlight(thresh,turnMax,meleedamage,missiletype,crisismissiletype);
		if (random[DragonFlight]() < 240)
		{
			A_StartSound("DragonWingflap", CHAN_BODY);
		}
		else
		{
			PlayActiveSound ();
		}
	}

	void A_DragonAttack(string missiletype = "DragonFireball", string crisismissiletype = "DragonFireballCrisis", double angle = 0.0)
	{
		string atktype = missiletype;
		if (user_canusecrisisatk == 1)
		{
			A_PlayCrisisAtkSound();
			atktype = crisismissiletype;
		}
		Actor mo = SpawnMissile (target, atktype);
		if (mo != null && user_monsterlevel > 180)
		{
			SpawnMissileAngle(atktype, mo.Angle - 45. / 8, mo.Vel.Z);
			SpawnMissileAngle(atktype, mo.Angle + 45. / 8, mo.Vel.Z);
		}
	}

	void A_DragonPain()
	{
		A_Pain();
		if (!tracer)
		{
			// no destination spot yet
			SetState (SeeState);
		}
	}

	void A_DragonCheckCrash()
	{
		if (pos.z <= floorz)
		{
			SetStateLabel ("Crash");
		}
	}
	
	// Traductus
	void A_ClericAttack(string missiletype = "HolyMissile", string crisismissiletype = "HolyMissileCrisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Cleric Attack - Projectile
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; A_PlayCrisisAtkSound(); }

		if (!target) return;

		Actor missile = SpawnMissileZ (pos.z + 40., target, atktype);
		if (missile != null) missile.tracer = null;	// No initial target
		A_StartSound("HolySymbolFire", CHAN_WEAPON);
	}

    // Menelkir	
	void MStaffSpawn2 (double angle, string missiletype = "MageStaffFX2", string crisismissiletype = "MageStaffFX2Crisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Magic Attack - Projectile
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; A_PlayCrisisAtkSound(); }

		Actor mo = SpawnMissileAngleZ (pos.z + 40, atktype, angle, 0.);
		if (mo)
		{
			mo.target = self;
			mo.tracer = RoughMonsterSearch(10, true, true);
		}
	}
	void A_MageAttack(string missiletype = "MageStaffFX2", string crisismissiletype = "MageStaffFX2Crisis")
	{
		if (target == NULL)
		{
			return;
		}
		MStaffSpawn2(angle,missiletype,crisismissiletype);
		MStaffSpawn2(angle-5,missiletype,crisismissiletype);
		MStaffSpawn2(angle+5,missiletype,crisismissiletype);
		A_StartSound("MageStaffFire", CHAN_WEAPON);
	}

	// Zedek
	void A_FighterAttack(string missiletype = "FSwordMissile", string crisismissiletype = "FSwordMissileCrisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Fighter Attack - Projectile
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; A_PlayCrisisAtkSound(); }

		if (!target) return;

		SpawnMissileAngle(atktype, Angle + (45. / 4), 0);
		SpawnMissileAngle(atktype, Angle + (45. / 8), 0);
		SpawnMissileAngle(atktype, Angle, 0);
		SpawnMissileAngle(atktype, Angle - (45. / 8), 0);
		SpawnMissileAngle(atktype, Angle - (45. / 4), 0);
		A_StartSound("FighterSwordFire", CHAN_WEAPON);
	}



	//*************************
	//*STRIFE-UNIQUE FUNCTIONS*
	//*************************
	// Acolyte
	void A_AcolyteDie ()
	{
		// [RH] Disable translucency here.
		A_SetRenderStyle(1, STYLE_Normal);

		// Only the Blue Acolyte does extra stuff on death.
		if (self is "AcolyteBlue")
		{
			int i;
			// Make sure somebody is still alive
			for (i = 0; i < MAXPLAYERS; ++i)
			{
				if (playeringame[i] && players[i].health > 0)
					break;
			}
			if (i == MAXPLAYERS)
				return;

			// Make sure all the other blue acolytes are dead, but do this only once in case of simultaneous kills.
			if (CheckBossDeath() && !players[i].mo.FindInventory("QuestItem7"))
			{
				players[i].mo.GiveInventoryType ("QuestItem7");
				players[i].SetLogNumber (14);
				A_StopSound (CHAN_VOICE);
				A_StartSound("svox/voc14", CHAN_VOICE);
			}
		}
	}

	void A_BeShadowy()
	{
		A_SetRenderStyle(HR_SHADOW, STYLE_Translucent);
	}

	void A_BeShadowyFoe()
	{
		A_SetRenderStyle(HR_SHADOW, STYLE_Translucent);
		if (bFriendly) bFriendly = false;
	}

	void A_AcolyteBits()
	{
		if (SpawnFlags & MTF_SHADOW)
		{
			A_BeShadowy();
		}
		if (SpawnFlags & MTF_ALTSHADOW)
		{
			if (bShadow)
			{
				// I dunno.
			}
			else
			{
				A_SetRenderStyle(0, STYLE_None);
			}
		}
	}
	
	// Templar
	void A_TemplarAttack()
	{
		if (target != null)
		{
			A_StartSound("templar/shoot", CHAN_WEAPON);
			A_FaceTarget ();
			double pitch = AimLineAttack (angle, MISSILERANGE);

			for (int i = 0; i < 10; ++i)
			{
				int damage = (random[Templar]() & 4) * 2;
				double ang = angle + random2[Templar]() * (11.25 / 256);
				LineAttack (ang, MISSILERANGE+64., pitch + random2[Templar]() * (7.097 / 256), damage, 'Hitscan', "MaulerPuff");
			}
		}
	}

	// Inquisitor
	void A_InquisitorWalk(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		A_StartSound("inquisitor/walk", CHAN_BODY);
		A_Chase(melee,missile,flags);
	}

	private bool InquisitorCheckDistance ()
	{
		if (reactiontime == 0 && CheckSight (target))
		{
			return Distance2D (target) < 264.;
		}
		return false;
	}

	void A_InquisitorDecide ()
	{
		if (target == null)
			return;

		A_FaceTarget ();
		if (!InquisitorCheckDistance ())
		{
			SetStateLabel("Grenade");
		}
		if (target.pos.z != pos.z)
		{
			if (pos.z + height + 54 < ceilingz)
			{
				SetStateLabel("Jump");
			}
		}
	}

	void A_InquisitorAttack (string missiletype = "InquisitorShot", string crisismissiletype = "InquisitorShotCrisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Inquisitor Attack - Projectile
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; A_PlayCrisisAtkSound(); }

		if (target == null)
			return;

		A_FaceTarget ();

		AddZ(32);
		angle -= 45./32;
		Actor proj = SpawnMissileZAimed (pos.z, target, atktype);
		if (proj != null)
		{
			proj.Vel.Z += 9;
		}
		angle += 45./16;
		proj = SpawnMissileZAimed (pos.z, target, atktype);
		if (proj != null)
		{
			proj.Vel.Z += 16;
		}
		AddZ(-32);
	}

	void A_InquisitorJump ()
	{
		if (target == null)
			return;

		A_StartSound ("inquisitor/jump", CHAN_ITEM, 1, true);
		AddZ(64);
		A_FaceTarget ();
		let localspeed = Speed * (2./3);
		VelFromAngle(localspeed);
		double dist = DistanceBySpeed(target, localspeed);
		Vel.Z = (target.pos.z - pos.z) / dist;
		reactiontime = 60;
		bNoGravity = true;
	}

	void A_InquisitorCheckLand ()
	{
		reactiontime--;
		if (reactiontime < 0 ||
			Vel.X == 0 ||
			Vel.Y == 0 ||
			pos.z <= floorz)
		{
			SetState (SeeState);
			reactiontime = 0;
			bNoGravity = false;
			A_StopSound (CHAN_ITEM);
			return;
		}
		A_StartSound ("inquisitor/jump", CHAN_ITEM, 1, true);
	}

	void A_TossArm ()
	{
		Actor foo = Spawn("InquisitorArm", Pos + (0,0,24), ALLOW_REPLACE);
		if (foo != null)
		{
			foo.angle = angle - 90. + Random2[Inquisitor]() * (360./1024.);
			foo.VelFromAngle(foo.Speed / 8);
			foo.Vel.Z = random[Inquisitor]() / 64.;
		}
	}
	
	// Reaver
	void A_ReaverRanged ()
	{
		if (target != null)
		{
			A_FaceTarget ();
			A_StartSound("reaver/attack", CHAN_WEAPON);
			double bangle = Angle;
			double pitch = AimLineAttack (bangle, MISSILERANGE);

			for (int i = 0; i < 3; ++i)
			{
				double ang = bangle + Random2[ReaverAttack]() * (22.5 / 256);
				int damage = ((random[ReaverAttack]() & 7) + 1) * 3;
				LineAttack (ang, MISSILERANGE, pitch, damage, 'Hitscan', "StrifePuff");
			}
		}
	}

	// Crusader
	private bool CrusaderCheckRange ()
	{
		if (reactiontime == 0 && CheckSight (target))
		{
			return Distance2D (target) < 264.;
		}
		return false;
	}

	void A_CrusaderChoose (string firemissile = "FastFlameMissile", string crisisfiremissile = "FastFlameMissileCrisis", string rockmissile = "CrusaderMissile", string crisisrockmissile = "CrusaderMissileCrisis")
	{
		string fireatktype = firemissile;
		string missileatktype = rockmissile;
		A_MonsterCrisisCheck(); // Crusader Attack - Projectiles
		if (user_canusecrisisatk == 1) { fireatktype = crisisfiremissile; missileatktype = crisisrockmissile; A_PlayCrisisAtkSound(); }

		if (target == null)
			return;

		if (CrusaderCheckRange ())
		{
			A_FaceTarget ();
			angle -= 180./16;
			SpawnMissileZAimed (pos.z + 40, target, fireatktype);
		}
		else
		{
			if (CheckMissileRange ())
			{
				A_FaceTarget ();
				SpawnMissileZAimed (pos.z + 56, target, missileatktype);
				angle -= 45./32;
				SpawnMissileZAimed (pos.z + 40, target, missileatktype);
				angle += 45./16;
				SpawnMissileZAimed (pos.z + 40, target, missileatktype);
				angle -= 45./16;
				reactiontime += 15;
			}
			SetState (SeeState);
		}
	}

	void A_CrusaderSweepLeft (string firemissile = "FastFlameMissile", string crisisfiremissile = "FastFlameMissileCrisis")
	{
		string fireatktype = firemissile;
		A_MonsterCrisisCheck(); // Inquisitor Attack - Fire [Leftward Sweep]
		if (user_canusecrisisatk == 1) { fireatktype = crisisfiremissile; A_PlayCrisisAtkSound(); }

		angle += 90./16;
		Actor misl = SpawnMissileZAimed (pos.z + 48, target, fireatktype);
		if (misl != null)
		{
			misl.Vel.Z += 1;
		}
	}

	void A_CrusaderSweepRight (string firemissile = "FastFlameMissile", string crisisfiremissile = "FastFlameMissileCrisis")
	{
		string fireatktype = firemissile;
		A_MonsterCrisisCheck(); // Inquisitor Attack - Fire [Rightward Sweep]
		if (user_canusecrisisatk == 1) { fireatktype = crisisfiremissile; A_PlayCrisisAtkSound(); }

		angle -= 90./16;
		Actor misl = SpawnMissileZAimed (pos.z + 48, target, fireatktype);
		if (misl != null)
		{
			misl.Vel.Z += 1;
		}
	}

	void A_CrusaderRefire ()
	{
		if (target == null ||
			target.health <= 0 ||
			!CheckSight (target))
		{
			SetState (SeeState);
		}
	}

	void A_CrusaderDeath ()
	{
		if (CheckBossDeath ())
		{
			Floor_LowerToLowest(667, 8);
		}
	}

    // Sentinel
	void A_SentinelAttack (string missiletype = "SentinelFX2", string crisismissiletype = "SentinelFX2Crisis", string trailtype = "SentinelFX1", int trailsize = 8)
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Sentinel Attack - Projectile
		if (user_canusecrisisatk == 1) { atktype = crisismissiletype; A_PlayCrisisAtkSound(); }
		
		// [BB] Without a target the P_SpawnMissileZAimed call will crash.
		if (!target)
		{
			return;
		}

		double zvar = 32.0;
		if (GetClassName() == "OStalkerNew" && bNOGRAVITY) zvar = -32.0;
		Actor missile = SpawnMissileZAimed (pos.z + zvar, target, atktype);

		if (missile != NULL && (missile.Vel.X != 0 || missile.Vel.Y != 0))
		{
			for (int i = trailsize; i > 1; --i)
			{
				Actor trail = Spawn(trailtype, Vec3Angle(missile.radius*i, missile.angle, 32 + missile.Vel.Z / 4 * i), ALLOW_REPLACE);
				if (trail != NULL)
				{
					trail.target = self;
					trail.Vel = missile.Vel;
					trail.CheckMissileSpawn (radius);
				}
			}
			missile.AddZ(missile.Vel.Z / 4);
		}
	}

	// Stalker
	void A_StalkerChaseDecide ()
	{
		if (!bNoGravity)
		{
			SetStateLabel("SeeFloor");
		}
		else if (ceilingz > pos.z + height)
		{
			SetStateLabel("Drop");
		}
	}

	void A_StalkerLookInit ()
	{
		State st;
		if (bNoGravity)
		{
			st = FindState("LookCeiling");
		}
		else
		{
			st = FindState("LookFloor");
		}
		if (st != CurState.NextState)
		{
			SetState (st);
		}
	}

	void A_StalkerDrop ()
	{
		bNoVerticalMeleeRange = false;
		bNoGravity = false;
	}

	void A_StalkerAttack(int dmg = 2)
	{
		if (bNoGravity)
		{
			SetStateLabel("Drop");
		}
		else if (target != null)
		{
			A_FaceTarget ();
			if (CheckMeleeRange ())
			{
				A_MonsterCrisisCheck(); // [Order] Stalker Attack - Melee
				if (user_canusecrisisatk == 1) { dmg *= CrisisMultiplier; A_PlayCrisisAtkSound(); }

				int damage = dmg;
				int newdam = target.DamageMobj (self, self, damage, 'Melee');
				target.TraceBleed (newdam > 0 ? newdam : damage, self);
			}
		}
	}

	void A_StalkerWalk(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		A_StartSound("stalker/walk", CHAN_BODY);
		A_Chase(melee,missile,flags);
	}
	
	// Programmer
	void A_ProgrammerMelee (int dmg = 6)
	{
		A_MonsterCrisisCheck(); // Programmer Attack - Melee
		if (user_canusecrisisatk == 1) { dmg *= CrisisMultiplier; A_PlayCrisisAtkSound(); }

		if (target == null)
			return;

		A_FaceTarget ();

		if (!CheckMeleeRange ())
			return;

		A_StartSound("programmer/clank", CHAN_WEAPON);

		int damage = dmg;
		int newdam = target.DamageMobj (self, self, damage, 'Melee');
		target.TraceBleed (newdam > 0 ? newdam : damage, self);
	}

	void A_SpawnProgrammerBase ()
	{
		Actor foo = Spawn("ProgrammerBase", Pos + (0,0,24), ALLOW_REPLACE);
		if (foo != null)
		{
			foo.Angle = Angle + 180. + Random2[Programmer]() * (360. / 1024.);
			foo.VelFromAngle();
			foo.Vel.Z = random[Programmer]() / 128.;
		}
	}

	void A_ProgrammerDeath ()
	{
		if (!CheckBossDeath ())
			return;

		for (int i = 0; i < MAXPLAYERS; ++i)
		{
			if (playeringame[i] && players[i].health > 0)
			{
				players[i].mo.GiveInventoryType ("ProgLevelEnder");
				break;
			}
		}
		// the sky change scripts are now done as special actions in MAPINFO
		bossdeathactivate++;
		A_BossDeath();
	}

	void A_SpotLightning(string missiletype = "SpectralLightningSpot", string crisismissiletype = "SpectralLightningSpotCrisis")
	{
		string atktype = missiletype;
		A_MonsterCrisisCheck(); // Spectres/Entity - Spot Lightning
		if (user_canusecrisisatk == 1) 
		{
			atktype = crisismissiletype;
			A_PlayCrisisAtkSound(); 
		}

		if (target == null) return;

		Actor spot = Spawn(atktype, (target.pos.xy, target.floorz), ALLOW_REPLACE);
		if (spot != null)
		{
			spot.threshold = 25;
			spot.target = self;
			spot.FriendPlayer = 0;
			spot.tracer = target;
		}
	}

	// Oracle
	void A_WakeOracleSpectre (Class<Actor> spawntype)
	{
		ThinkerIterator it = ThinkerIterator.Create(spawntype);
		Actor spectre = Actor(it.Next());

		if (spectre != NULL && spectre.health > 0 && self.target != spectre)
		{
			spectre.CurSector.SoundTarget = spectre.LastHeard = self.LastHeard;
			spectre.target = self.target;
			spectre.SetState (spectre.SeeState);
		}
	}
	
	void A_DropFire(string missiletype = "FireDroplet", int expdmg = 64, int exprad = 64, int expflags = XF_NOSPLASH, string type = "Fire")
	{
		Actor drop = Spawn(missiletype, pos + (0,0,24), ALLOW_REPLACE);
		if (drop != null)
		{
			drop.Vel.Z = -1.;
		}
		A_Explode(expdmg, exprad, expflags, damagetype: type);
	}	

	private static void BrainishExplosion(vector3 pos)
	{
		Actor boom = Actor.Spawn("Rocket", pos, NO_REPLACE);
		if (boom)
		{
			boom.DeathSound = "misc/brainexplode";
			boom.Vel.z = random[BrainScream](0, 255)/128.;

			boom.SetStateLabel ("Brainexplode");
			boom.bRocketTrail = false;
			boom.SetDamage(0);	// disables collision detection which is not wanted here
			boom.tics -= random[BrainScream](0, 7);
			boom.tics = clamp(boom.tics, 1, boom.tics);
		}
	}
	void A_BrainScream(string dthsound = "brain/death")
	{
		for (double x = -196; x < +320; x += 8)
		{
			// (1 / 512.) is actually what the original value of 128 did, even though it probably meant 128 map units.
			BrainishExplosion(Vec2OffsetZ(x, -320, (1 / 512.) + random[BrainExplode](0, 255) * 2));
		}
		A_StartSound(dthsound, CHAN_VOICE, CHANF_DEFAULT, 1., ATTN_NONE);
	}

	void A_BrainSpit(class<Actor> spawntype = null)
	{
		SpotState spstate = Level.GetSpotState();
		Actor targ;
		Actor spit;
		bool isdefault = false;

		// shoot a cube at current target
		targ = spstate.GetNextInList("BossTarget", G_SkillPropertyInt(SKILLP_EasyBossBrain));

		if (targ)
		{
			if (spawntype == null) 
			{
				spawntype = "SpawnShot";
				isdefault = true;
			}

			// spawn brain missile
			spit = SpawnMissile (targ, spawntype);

			if (spit)
			{
				// Boss cubes should move freely to their destination so it's
				// probably best to disable all collision detection for them.
				spit.bNoInteraction = spit.bNoClip;
		
				spit.target = targ;
				spit.master = self;
				// [RH] Do this correctly for any trajectory. Doom would divide by 0
				// if the target had the same y coordinate as the spitter.
				if (spit.Vel.xy == (0, 0))
				{
					spit.special2 = 0;
				}
				else if (abs(spit.Vel.y) > abs(spit.Vel.x))
				{
					spit.special2 = int((targ.pos.y - pos.y) / spit.Vel.y);
				}
				else
				{
					spit.special2 = int((targ.pos.x - pos.x) / spit.Vel.x);
				}
				// [GZ] Calculates when the projectile will have reached destination
				spit.special2 += level.maptime;
				spit.bBossCube = true;
			}

			if (!isdefault)
			{
				A_StartSound(self.AttackSound, CHAN_VOICE, CHANF_DEFAULT, 1., ATTN_NONE);
			}
			else
			{
				// compatibility fallback
				A_StartSound("brain/spit", CHAN_VOICE, CHANF_DEFAULT, 1., ATTN_NONE);
			}
		}
	}

	double XSpread;
	double YSpread;
	void A_ActorGetHitScanXSpread(int type = 0)
	{
		double spread = 0.0;
		double spreadfactor = 1.0;
		int BulletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10019);
		int BulletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10020);
		int PelletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10021);
		int PelletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10022);
		int PlasmaAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10023);
		int PlasmaAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10024);
		int DemolitionsExpertPerkLevel = CallACS("MiscVarCheckDECORATE",10025);
		int DemolitionsExpertEXPerkLevel = CallACS("MiscVarCheckDECORATE",10026);
		int StrifeAccuracyLevel = CallACS("MiscVarCheckDECORATE",318);
		int accuracydebug = dvdsdebug_accuracyspreadisplay;

		// Special
		if (type == 101) // Strife Rebel Shots [checking player's accuracy to set their own] :V
		{
			spread = 8.0;
			spreadfactor = 1.0 - (StrifeAccuracyLevel * 0.1);
		}
		
		spread *= spreadfactor;
		if (accuracydebug) Console.Printf("XSpread: %.8f, XSpreadFactor %.8f" ,spread, spreadfactor);
		XSpread = spread;
	}
	
	void A_ActorGetHitScanYSpread(int type = 0)
	{
		double spread = 0.0;
		double spreadfactor = 1.0;
		int BulletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10019);
		int BulletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10020);
		int PelletAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10021);
		int PelletAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10022);
		int PlasmaAccuracyPerkLevel = CallACS("MiscVarCheckDECORATE",10023);
		int PlasmaAccuracyEXPerkLevel = CallACS("MiscVarCheckDECORATE",10024);
		int DemolitionsExpertPerkLevel = CallACS("MiscVarCheckDECORATE",10025);
		int DemolitionsExpertEXPerkLevel = CallACS("MiscVarCheckDECORATE",10026);
		int StrifeAccuracyLevel = CallACS("MiscVarCheckDECORATE",318);
		int accuracydebug = dvdsdebug_accuracyspreadisplay;

		// Special
		if (type == 101) // Strife Rebel Shots [checking player's accuracy to set their own] :V
		{
			spread = 0.0;
			spreadfactor = 1.0 - (StrifeAccuracyLevel * 0.1);
		}
		
		spread *= spreadfactor;
		if (accuracydebug) Console.Printf("YSpread: %.8f, YSpreadFactor %.8f" ,spread, spreadfactor);
		YSpread = spread;
	}
	
	// Cacodemons' Shadow Split
	void A_ActorStartShadowSplit()
	{
		A_Stop();
		A_StartSound("caco/shadowsplit", CHAN_7, CHANF_DEFAULT, 1, ATTN_NONE, frandom(1.2,1.4));
		A_FaceTarget();
		bSHOOTABLE = 0;
		
		int nonsolidchance = 1;
		if (GetClassName() == "DSCacodemon") nonsolidchance += (user_monsterlevel / 180);
		if (GetClassName() == "Cacolantern") nonsolidchance += (user_monsterlevel / 135);
		if (GetClassName() == "Abaddon") nonsolidchance += (user_monsterlevel / 90);
		if (GetClassName() == "DSPainElemental") nonsolidchance += (user_monsterlevel / 90);
		if (random(1,4) <= nonsolidchance) bSOLID = 0;
	}
	void A_ActorEndShadowSplit()
	{
		A_GiveInventory("ShadowSplitCooldown", 1);
		A_Stop();
		bSHOOTABLE = 1;
		if (!bSOLID) bSOLID = 1;
	}
	
	void A_HadesTeleport(int minlevel = 90, int minchance = 64)
	{
		int splittype = 0; // 0;
		int splittype2 = 0; // 0;
		if (user_legendaryevolved) minchance *= frandompick(1.25,1.5,1.75,2.0);

		int RandRoll = random(1,1024);
		if (levelbehavior)
		{
			A_StopSound (CHAN_WEAPON);
			if (!CountInv("HadesTeleportCooldown")) 
			{
				if (user_monsterlevel >= (minlevel*9))
				{
					if (RandRoll <= (minchance*4)) splittype2 = 2;
				}
				else
				if (user_monsterlevel >= (minlevel*4))
				{
					if (RandRoll <= (minchance*2)) splittype2 = random(1,2);
				}
				else
				if (user_monsterlevel >= minlevel)
				{
					if (RandRoll <= minchance) splittype2 = randompick(1,1,1,1,1,1,1,2);
				}
				else
				if (user_monsterlevel >= (minlevel/2))
				{
					if (RandRoll <= minchance) splittype2 = 1;
				}
			}
		}
		
		if (splittype2 == 1)
		{
			SetStateLabel("Teleport");
		}
		else
		if (splittype2 == 2)
		{
			SetStateLabel("Teleport2");
		}
		if (dvdsdebug_monsterspecialaidisplays) Console.Printf("Class: %s - \cuHades Teleport --- (Level / RequiredLvl: %d / %d) splittype2: %d, splittype: %d\c-", GetClassName(), user_monsterlevel, minlevel, splittype2, splittype);
	}
	void A_HadesTeleportChoose(int minlevel = 90)
	{
		int splittype = 0; // 0;
		int splittype2 = 0; // 0;

		if (levelbehavior)
		{
			if (!CountInv("HadesTeleportCooldown")) 
			{
				if (user_monsterlevel >= (minlevel*9))
				{
					splittype2 = 2;
				}
				else
				if (user_monsterlevel >= (minlevel*4))
				{
					splittype2 = random(1,2);
				}
				else
				if (user_monsterlevel >= minlevel)
				{
					randompick(1,1,1,1,1,1,1,2);
				}
				else
				if (user_monsterlevel >= (minlevel/2))
				{
					splittype2 = 1;
				}
			}
		}
		
		if (splittype2 == 1)
		{
			SetStateLabel("Teleport");
		}
		else
		if (splittype2 == 2)
		{
			SetStateLabel("Teleport2");
		}
		if (dvdsdebug_monsterspecialaidisplays) Console.Printf("Class: %s - \cuHades Teleport --- (Level / RequiredLvl: %d / %d) splittype2: %d, splittype: %d\c-", GetClassName(), user_monsterlevel, minlevel, splittype2, splittype);
	}
	
	void A_ActorShadowSplit(int minlevel = 60, int minchance = 256)
	{
		if (user_legendaryevolved) minchance *= frandompick(1.25,1.5,1.75,2.0);

		int splittype = 0; // 0;
		int splittype2 = 0; // 0;
		int RandRoll = random(1,1024);
		if (levelbehavior)
		{
			A_StopSound (CHAN_WEAPON);
			if (!CountInv("ShadowSplitCooldown")) 
			{
				if (user_monsterlevel >= (minlevel*9))
				{
					if (RandRoll <= (minchance*4)) splittype2 = 2;
				}
				else
				if (user_monsterlevel >= (minlevel*4))
				{
					if (RandRoll <= (minchance*2)) splittype2 = random(1,2);
				}
				else
				if (user_monsterlevel >= minlevel)
				{
					if (RandRoll <= minchance) splittype2 = randompick(1,1,1,1,1,1,1,2);
				}
				else
				if (user_monsterlevel >= (minlevel/2))
				{
					if (RandRoll <= (minchance/4)) splittype2 = randompick(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2);
				}
			}
		}

		if (splittype2 == 0)
		{
		}
		else
		if (splittype2 == 1)
		{
			splittype = random(1,4);
			if (splittype == 1) { SetStateLabel("Shadowsplit1"); }
			if (splittype == 2) { SetStateLabel("Shadowsplit2"); }
			if (splittype == 3) { SetStateLabel("Shadowsplit3"); }
			if (splittype == 4) { SetStateLabel("Shadowsplit4"); }
		}
		else
		if (splittype2 == 2)
		{
			splittype = random(1,4);
			if (splittype == 1) { SetStateLabel("Shadowsplit1a"); }
			if (splittype == 2) { SetStateLabel("Shadowsplit2a"); }
			if (splittype == 3) { SetStateLabel("Shadowsplit3a"); }
			if (splittype == 4) { SetStateLabel("Shadowsplit4a"); }
		}
		if (dvdsdebug_monsterspecialaidisplays) Console.Printf("Class: %s - \cuCacos' ShadowSplit --- (Level / RequiredLvl: %d / %d) splittype2: %d, splittype: %d\c-", GetClassName(), user_monsterlevel, minlevel, splittype2, splittype);
	}
	
	void A_GargDashCheck()
	{
		if (!target) { SetStateLabel("See"); }
	}
	
	void A_GargDashCheck2()
	{
		if (!target) 
		{ 
			SetStateLabel("See"); 
		}
		else
		{
			if (levelbehavior && user_monsterlevel > 45) 
			{
				if (!A_JumpIfTargetInLOS("See", frandom(77.5,82.5)))
				{
					A_Stop();
					SetStateLabel("See"); 
				}
			}
			else
			{
				if (random(1,8) <= 1)
				{
					if (!A_JumpIfTargetInLOS("See", frandom(77.5,82.5)))
					{
						A_Stop();
						SetStateLabel("See"); 
					}
				}
			}
		}
	}
	
	int A_EnemyRailgunDamage(int base = 0)
	{
		int damage = base;
		int charge = CountInv("RailgunCharge");
		double chargefactor = (((charge * 2) + (charge * 0.3334)) * (0.10 + (charge * 0.01)));
		damage *= chargefactor;
		if (damage < (base * 0.5)) damage = (base * 0.5);

		if (dvdsdebug_showmiscdmginformation) Console.Printf("Damage: %d, [Base: %d], [Charge: %d% / ChargeFactor: %d%", damage, base, charge, chargefactor);
		return damage;
	}
	
	void A_DVDSHealThing(int healvalue = 0, int healtarget = 0, int silentheal = 0)
	{
		if (healvalue > 0)
		{
			health += healvalue;
			if (health > healtarget) health = healtarget;
		}
		if (silentheal)
		{
			if (CountInv("DamageTracker")) A_SetInventory("SilentHeal",1);
		}
	}
	
	States
	{
		Pain.PoisonNeedle: 
			TNT1 A 0 
			{ 
				if (random(1,2) == 1)
				{
					SetStateLabel("Pain.Kick");
				}
				else
				{
					SetStateLabel("Pain.Fist");
				}
			}
		Pain.Chainsaw: 
			TNT1 A 0 
			{ 
				if (random(1,4) == 1)
				{
					SetStateLabel("Pain.Kick");
				}
				else
				{
					if (random(1,2) == 1)
					{
						SetStateLabel("Pain.Fist");
					}
					else
					{
						SetStateLabel("Pain");
					}
				}
			}
		Pain.Charm: 
			TNT1 A 0 
			{
				if (user_charmchance <= 0) { user_charmchance = 256; }
				if (random(1,256) <= user_charmchance)
				{
					if (!bFRIENDLY)
					{
						ClearCounters();
						bFRIENDLY = true;
						if (dvdsdebug_charmdisplays) Console.Printf("(%s) FRIENDLY = %d", GetClassName(), bFRIENDLY);
						if (bFRIENDLY)
						{
							bCOUNTKILL = false; 
							if (dvdsdebug_charmdisplays) Console.Printf("(%s) COUNTKILL = %d", GetClassName(), bCOUNTKILL);
							if (!bCOUNTKILL)
							{
								health = user_MaxHP * frandompick(1.0,1.25,1.5,1.75,2.0);
								if (CountInv("CharmMonsterAttack") <= 0) A_SetInventory("CharmMonsterAttack",1);
								if (CountInv("CharmMonsterDefense") <= 0) A_SetInventory("CharmMonsterDefense",1);
								if (user_charmed <= 0) user_charmed = 1;
								if ((dvds_showdamagemessages & 2)) A_PrintCharmMessage();
								ChangeTID(1000);
								A_StartSound("Munchies/Charmed");
							}
						}
					}
				}
				SetStateLabel("See");
			}
		/*
		Pain.Heal1: 
			TNT1 A 0 
			{
				CallACS("Healing_Actor",0,0); 
				SetStateLabel("See");
			}
		Pain.Heal2: 
			TNT1 A 0 
			{
				CallACS("Healing_Actor",0,1); 
				SetStateLabel("See");
			}
		Pain.Heal3: 
			TNT1 A 0 
			{
				CallACS("Healing_Actor",0,2); 
				SetStateLabel("See");
			}
		Pain.Heal4: 
			TNT1 A 0 
			{
				CallACS("Healing_Actor",0,3); 
				SetStateLabel("See");
			}
		*/
	}
	
	void A_HETeleport(statelabel tele = "TeleportChoose")
	{
		if (!CountInv("HadesTeleportCooldown") && target && CheckIfTargetInLOS(0, JLOSF_DEADNOJUMP))
		{
			if (levelbehavior && user_monsterlevel > 180) { if (random(1,256) <= 144) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 120) { if (random(1,256) <= 120) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 60) { if (random(1,256) <= 96) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel <= 60) { if (random(1,256) <= 72) { SetStateLabel(tele); } }
			else { if (random(1,256) <= 72) { SetStateLabel(tele); } }
		}
	}

	void A_HOTeleport(statelabel tele = "TeleportChoose")
	{
		if (!CountInv("HadesTeleportCooldown") && target && CheckIfTargetInLOS(0, JLOSF_DEADNOJUMP))
		{
			if (levelbehavior && user_monsterlevel > 180) { if (random(1,256) <= 68) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 120) { if (random(1,256) <= 56) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 60) { if (random(1,256) <= 44) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel <= 60) { if (random(1,256) <= 32) { SetStateLabel(tele); } }
			else { if (random(1,256) <= 32) { SetStateLabel(tele); } }
		}
	}

	void A_HadesSphereTeleport(statelabel tele = "Teleport", int chance = 128, int chancemax = 1024)
	{
		if (!CountInv("HSphereTeleportCooldown") && target && CheckIfTargetInLOS(0, JLOSF_DEADNOJUMP))
		{
			if (random(1,chancemax) <= chance) { SetStateLabel(tele); }
			if (dvdsdebug_monsterspecialaidisplays) Console.Printf("HSTele: Target - %s (%d / %d)", target.GetClassName(), chance, chancemax);
		}
	}
	
	void A_GDTeleport(statelabel tele = "Blur")
	{
		if (target && CheckIfTargetInLOS(0, JLOSF_DEADNOJUMP))
		{
			if (levelbehavior && user_monsterlevel > 180) { if (random(1,1024) <= 640) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 120) { if (random(1,1024) <= randompick(533,533,534)) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel > 60) { if (random(1,1024) <= randompick(426,426,427)) { SetStateLabel(tele); } }
			else if (levelbehavior && user_monsterlevel <= 60) { if (random(1,1024) <= 320) { SetStateLabel(tele); } }
			else { if (random(1,1024) <= 320) { SetStateLabel(tele); } }
		}
	}

	void A_GetHSHealthPreExp()
	{
		hsexphealth = health;
	}
	
	void A_LostSoulChargeWeakness()
	{
		if (GetClassName() == "DSLostSoul" || GetClassName() == "FLostSoul1") A_SetInventory("DMGWeakness100Percent",1);
		if (GetClassName() == "DSLostSoul2" || GetClassName() == "FLostSoul2") A_SetInventory("DMGWeakness50Percent",1);
		if (GetClassName() == "ForgottenOne" || GetClassName() == "FForgottenOne") A_SetInventory("DMGWeakness20Percent",1);
	}

	void A_UnSetDmgWeaknesses()
	{
		A_SetInventory("DMGWeakness100Percent",0);
		A_SetInventory("DMGWeakness75Percent",0);
		A_SetInventory("DMGWeakness50Percent",0);
		A_SetInventory("DMGWeakness20Percent",0);
	}
	
	void A_CheckIfTargetDead(statelabel statel = null)
	{
		if (!target)
		{
			if (dvdsdebug_monsterspecialaidisplays) Console.Printf("NoTarget");
			SetStateLabel(statel);
		}
		else
		{
			if (target.health <= 0)
			{
				if (dvdsdebug_monsterspecialaidisplays) Console.Printf("TargetDead");
				target = null;
				SetStateLabel(statel);
			}
		}
	}

	action void A_UCIIHealSpark(actor DVDSActor, string sparkname = "Heal1SparkAlly", double xscal = 1.0, double yscal = 1.0, string glittertype = "HealGlitter1", int glitterspawns = 0, double gxscal = 1.0, double gyscal = 1.0, double gspeed = 1.0)
	{
		Vector3 healpos = (DVDSActor.pos.x, DVDSActor.pos.y, DVDSActor.pos.z);
		Vector3 healpos2 = (DVDSActor.pos.x, DVDSActor.pos.y, (DVDSActor.pos.z)+(DVDSActor.height/2));
		Actor healspark = Spawn("Heal1SparkAlly", healpos, ALLOW_REPLACE); 
		CustomHealSpark iscustomspark;
		if (healspark != null)
		{
			iscustomspark = CustomHealSpark(healspark);
			healspark.SetOrigin(healpos2,false);
			healspark.target = DVDSActor;
			healspark.scale.x = xscal;
			healspark.scale.y = yscal;
			if (iscustomspark != null)
			{
				iscustomspark.glittertype = glittertype;
				iscustomspark.glitterspawns = glitterspawns;
				iscustomspark.glitterxscale = gxscal;
				iscustomspark.glitteryscale = gyscal;
				iscustomspark.glitterxspeed = gspeed;
				iscustomspark.glitteryspeed = gspeed;
				iscustomspark.glitterzspeed = gspeed;
			}
		}
	}
}

class AetheriusBossZSC : AetheriusMonsterZSC
{
}

class MaulotaurBase : AetheriusMonsterZSC
{
 const MAULATORTICS = 25 * TICRATE;
 const MNTR_CHARGE_SPEED =13.;
 const MINOTAUR_LOOK_DIST = 16*54.;
	
	void MinotaurSlam (Actor target)
	{
		double ang = AngleTo(target);
		double thrust = 16 + random[MinotaurSlam]() / 64.;
		target.VelFromAngle(ang, thrust);
		int damage = random[MinotaurSlam](1, 8) * (bSummonedMonster? 4 : 6);
		int newdam = target.DamageMobj (null, null, damage, 'Melee');
		target.TraceBleedAngle (newdam > 0 ? newdam : damage, ang, 0.);
		if (target.player)
		{
			target.reactiontime = random[MinotaurSlam](14, 21);
		}
	}

	override void Tick ()
	{
		Super.Tick ();
		
		// The unfriendly Minotaur (Heretic's) is invulnerable while charging
		if (!bSummonedMonster)
		{
			bInvulnerable = bSkullFly;
		}
	}

	override bool Slam (Actor thing)
	{
		// Slamming minotaurs shouldn't move non-creatures
		if (!thing.bIsMonster && !thing.player)
		{
			return false;
		}
		return Super.Slam (thing);
	}

	override int DoSpecialDamage (Actor target, int damage, Name damagetype)
	{
		damage = Super.DoSpecialDamage (target, damage, damagetype);
		if (damage != -1 && bSkullFly)
		{
			// Slam only when in charge mode
			MinotaurSlam (target);
			return -1;
		}
		return damage;
	}

	void A_MinotaurAtk1(int atkdamage = 4, int squishamount = -16)
	{
		A_MonsterCrisisCheck(); // Maulotaur Attack - Hammer Smash [Melee]
		if (user_canusecrisisatk == 1) atkdamage *= CrisisMultiplier;

		if (!target)
		{
			return;
		}
		A_StartSound("minotaur/melee", CHAN_WEAPON);
		if (CheckMeleeRange())
		{
			if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound(); 
			int damage = atkdamage;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			PlayerInfo player = target.player;
			if (player != null && player.mo == target)
			{
				// Squish the player
				player.deltaviewheight = squishamount;
			}
		}
	}

	void A_MinotaurDecide()
	{
		bool friendly = bSummonedMonster;

		if (!target)
		{
			return;
		}
		if (!friendly)
		{
			A_StartSound("minotaur/sight", CHAN_WEAPON);
		}
		double dist = Distance2D(target);
		if (target.pos.z + target.height > pos.z
			&& target.pos.z + target.height < pos.z + height
			&& dist < (friendly ? 16*64. : 8*64.)
			&& dist > 1*64.
			&& random[MinotaurDecide]() < 150)
		{
			// Charge attack
			// Don't call the state function right away
			SetStateLabel("Charge", true);
			bSkullFly = true;
			if (!friendly)
			{
				// Heretic's Minotaur is invulnerable during charge attack
				// bInvulnerable = true;
				A_SetInventory("MaulotaurChargeDefense",1);
				bNoPain = true;
				bNoBlood = true;
			}
			A_FaceTarget ();
			VelFromAngle(MNTR_CHARGE_SPEED);
			special1 = TICRATE/2; // Charge duration
		}
		else if (target.pos.z == target.floorz
				&& dist < 9*64.
				&& random[MinotaurDecide]() < (friendly ? 100 : 220))
		{
			// Floor fire attack
			SetStateLabel("Hammer");
			special2 = 0;
		}
		else
		{
			// Swing attack
			A_FaceTarget ();
			// Don't need to call P_SetMobjState because the current state
			// falls through to the swing attack
		}
	}
	
	void A_MinotaurCharge()
	{
		if (target == null)
		{
			return;
		}
		if (special1 > 0)
		{
			Class<Actor> type;

			if (gameinfo.gametype == GAME_Heretic)
			{
				type = "PhoenixPuff";
			}
			else
			{
				type = "PunchPuff";
			}
			Actor puff = Spawn (type, Pos, ALLOW_REPLACE);
			if (puff != null) puff.Vel.Z = 2;
			special1--;
		}
		else
		{
			bSkullFly = false;
			bInvulnerable = false;
			A_SetInventory("MaulotaurChargeDefense",0);
			bNoPain = false;
			bNoBlood = false;
			SetState (SeeState);
		}
	}

	void A_MinotaurAtk2(string missiletype = "MinotaurFX1", string crisismissiletype = "MinotaurFX1Crisis", int meleedamage = 5, int friendlymeleedamage = 3)
	{
		bool friendly = bSummonedMonster;

		int actualmeleedmg = meleedamage;
		if (friendly == 1) actualmeleedmg = friendlymeleedamage;
		string actualmissile = missiletype;

		A_MonsterCrisisCheck(); // Maulotaur Attack2 - Hammer Smash Projectile
		if (user_canusecrisisatk == 1) 
		{
			actualmeleedmg *= CrisisMultiplier;
			actualmissile = crisismissiletype;
		}
		

		if (target == null)
		{
			return;
		}
		A_StartSound("minotaur/attack2", CHAN_WEAPON);
		if (CheckMeleeRange())
		{
			if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound(); 
			int damage = actualmeleedmg;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			return;
		}
		double z = pos.z + 40;
		Class<Actor> fx = actualmissile;
		Actor mo = SpawnMissileZ (z, target, fx);
		if (mo != null)
		{
			//S_Sound (mo, CHAN_WEAPON, "minotaur/attack2", 1, ATTN_NORM);
			if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound(); 
			double vz = mo.Vel.Z;
			double ang = mo.angle;
			SpawnMissileAngleZ (z, fx, ang-(45./8), vz);
			SpawnMissileAngleZ (z, fx, ang+(45./8), vz);
			SpawnMissileAngleZ (z, fx, ang-(45./16), vz);
			SpawnMissileAngleZ (z, fx, ang+(45./16), vz);
		}
	}

	void A_MinotaurAtk3(int atkdamage = 4, int squishamount = -16, string missiletype = "MinotaurFX2New", string crisismissiletype = "MinotaurFX2Crisis")
	{
		A_MonsterCrisisCheck(); // Maulotaur Attack3 - Hammer Side-Swing Spread Shot
		string attacktype = missiletype;
		if (user_canusecrisisatk == 1) 
		{
			attacktype = crisismissiletype;
			atkdamage *= CrisisMultiplier;
		}

		if (!target)
		{
			return;
		}
		A_StartSound("minotaur/attack3", CHAN_VOICE);
		if (CheckMeleeRange())
		{
			if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound(); 
			int damage = atkdamage;
			int newdam = target.DamageMobj (self, self, damage, 'Melee');
			target.TraceBleed (newdam > 0 ? newdam : damage, self);
			PlayerInfo player = target.player;
			if (player != null && player.mo == target)
			{
				// Squish the player
				player.deltaviewheight = squishamount;
			}
		}
		else
		{
			if (Floorclip > 0 && compat_minotaur)
			{
				// only play the sound. 
				A_StartSound("minotaur/fx2hit", CHAN_WEAPON);
			}
			else
			{
				if (user_canusecrisisatk == 1) A_PlayCrisisAtkSound(); 
				Actor mo = SpawnMissile (target, attacktype);
				if (mo != null)
				{
					mo.A_StartSound("minotaur/attack1", CHAN_WEAPON);
				}
			}
		}
		if (random[MinotaurAtk3]() < 192 && special2 == 0)
		{
			SetStateLabel ("HammerLoop");
			special2 = 1;
		}
	}

	void A_MinotaurDeath()
	{
		if (Wads.CheckNumForName ("MNTRF1", Wads.ns_sprites) < 0 &&
			Wads.CheckNumForName ("MNTRF0", Wads.ns_sprites) < 0)
			SetStateLabel("FadeOut");
	}

	void A_MinotaurRoam()
	{
		// In case pain caused him to skip his fade in.
		A_SetRenderStyle(1, STYLE_Normal);

		let mf = MinotaurFriend(self);
		if (mf)
		{
			if (mf.StartTime >= 0 && (level.maptime - mf.StartTime) >= MAULATORTICS)
			{
				DamageMobj (null, null, TELEFRAG_DAMAGE, 'None', 0, 0.0);
				return;
			}
		}

		if (random[MinotaurRoam]() < 30)
			A_MinotaurLook();		// adjust to closest target

		if (random[MinotaurRoam]() < 6)
		{
			//Choose new direction
			movedir = random[MinotaurRoam]() % 8;
			FaceMovementDirection ();
		}
		if (!MonsterMove())
		{
			// Turn
			if (random[MinotaurRoam]() & 1)
				movedir = (movedir + 1) % 8;
			else
				movedir = (movedir + 7) % 8;
			FaceMovementDirection ();
		}
	}

	void A_MinotaurLook()
	{
		if (!(self is "MinotaurFriend"))
		{
			A_Look();
			return;
		}

		Actor mo = null;
		PlayerInfo player;
		double dist;
		Actor master = tracer;

		target = null;
		if (deathmatch)					// Quick search for players
		{
			for (int i = 0; i < MAXPLAYERS; i++)
			{
				if (!playeringame[i]) continue;
				player = players[i];
				mo = player.mo;
				if (mo == master) continue;
				if (mo.health <= 0) continue;
				dist = Distance2D(mo);
				if (dist > MINOTAUR_LOOK_DIST) continue;
				target = mo;
				break;
			}
		}

		if (!target)				// Near player monster search
		{
			if (master && (master.health > 0) && (master.player))
				mo = master.RoughMonsterSearch(20);
			else
				mo = RoughMonsterSearch(20);
			target = mo;
		}

		if (!target)				// Normal monster search
		{
			ThinkerIterator it = ThinkerIterator.Create("Actor");

			while ((mo = Actor(it.Next())) != null)
			{
				if (!mo.bIsMonster) continue;
				if (mo.health <= 0) continue;
				if (!mo.bShootable) continue;
				dist = Distance2D(mo);
				if (dist > MINOTAUR_LOOK_DIST) continue;
				if (mo == master || mo == self) continue;
				if (mo.bSummonedMonster && mo.tracer == master) continue;
				target = mo;
				break;			// Found actor to attack
			}
		}

		if (target)
		{
			SetState (SeeState, true);
		}
		else
		{
			SetStateLabel ("Roam", true);
		}
	}

	void A_MinotaurChase(statelabel melee = '_a_chase_default', statelabel missile = '_a_chase_default', int flags = 0, int type = 0, int value1 = 0, int value2 = 0, int value3 = 0, int value4 = 0, int value5 = 0, int value6 = 0)
	{
		let mf = MinotaurFriend(self);
		if (!mf)
		{
			A_DVDSChase(melee,missile,flags,type,value1,value2,value3,value4,value5,value6);
			return;
		}


		// In case pain caused him to skip his fade in.
		A_SetRenderStyle(1, STYLE_Normal);

		if (mf.StartTime >= 0 && (level.maptime - mf.StartTime) >= MAULATORTICS)
		{
			DamageMobj (null, null, TELEFRAG_DAMAGE, 'None', 0, 0.0);
			return;
		}

		if (random[MinotaurChase]() < 30)
			A_MinotaurLook();		// adjust to closest target

		if (!target || (target.health <= 0) || !target.bShootable)
		{
			// look for a new target
			SetIdle();
			return;
		}

		FaceMovementDirection ();
		reactiontime = 0;

		// Melee attack
		if (MeleeState && CheckMeleeRange ())
		{
			if (AttackSound)
			{
				A_StartSound(AttackSound, CHAN_WEAPON);
			}
			SetState (MeleeState);
			return;
		}

		// Missile attack
		if (MissileState && CheckMissileRange())
		{
			SetState (MissileState);
			return;
		}

		// chase towards target
		if (!MonsterMove ())
		{
			NewChaseDir ();
			FaceMovementDirection ();
		}

		// Active sound
		if (random[MinotaurChase]() < 6)
		{
			PlayActiveSound ();
		}
	}
}

class AetheriusMorphedMonster : AetheriusMonsterZSC
{
	default
	{
		Monster;
		-COUNTKILL;
		+FLOORCLIP;
	}
}

//********************************
//** ACTUAL Boss Definitions V: **
//********************************


// Sauron makes one final effort to kill your ass with a Cyberdemon-like avatar. [DVI-DS]
class Sauravatar : AetheriusBossZSC //32201
{
	default
	{
		//$Angled
		//$Color 12
		//$Category "DV-DS Monsters/Boss Type"
		Tag "Greater Sauravatar";

		health 243000; // His BASE health, but not his actual maximum. [revised from 162000]
		radius 29;
		height 77;
		Scale 0.75;
		mass 208000; // Revised from 78000
		speed 32;
		MeleeRange 135;
		DamageFactor 0.25;
		DamageFactor "Explosive", 1.0;
		RadiusDamageFactor 1.0;
		DamageFactor "Gauntlets", 20;
		DamageFactor "Sceptre", 10;
		DamageFactor "Magic", 9.332;
		DamageFactor "Crush", 0.7; // 5.6
		DamageFactor "Holy", 12; // Sauron-Class = +300% Holy Damage
		DamageFactor "Eldritch", 4; // Sauron-Class = +300% Holy Damage
		Painchance "Holy", 120;
		Painchance "Eldritch", 40;
		Painchance "Sceptre", 100;
		Painchance "Magic", 93;
		Painchance "Explosive", 20;
		Painchance 2;
		Painchance "Gauntlets", 255;
		species "Sauron";
		Monster;
		MinMissileChance 160;
		+BOSS
		+MISSILEMORE
		+FLOORCLIP
		+DONTMORPH
		+BOSSDEATH
		+AVOIDMELEE
		+DONTHARMSPECIES
		+DROPOFF;
		+FLOORHUGGER;
		+NOBLOCKMONST;
		+MISSILEEVENMORE;
		+NOTARGETSWITCH;
		+NOINFIGHTING;
		+NOTARGET;
		+NOTELEFRAG;
		+NOTIMEFREEZE;
		+SHADOW;
		+LOOKALLAROUND;
		-NORADIUSDMG;
		seesound "SauronSight";
		painsound "null";
		deathsound "SauronDeath";
		activesound "null";
		obituary "%o was obliterated by an avatar of the Almighty Sauron.";
		translation "64:79=88:103", "48:63=103:88", "144:151=88:103", "32:47=224:231", "168:191=224:231", "224:231=[255, 255, 255]:[128, 255, 128]", "208:223=112:127";
		dropitem "NoItemSpawn", 1;
	}
	
	
	void A_SetSauravatarHealth()
	{
		int debugstatcalc = dvdsdebug_showstatcalcstuff;
		int PlayerLevel = CallACS("StatCheck",0);
		double MonstKillHealthMulti;
		int MonsterKillHealth;
		double SkillMulti;
		int basehealth;
		int finalhealth;

		if (TrueGameSkill <= SKILL_VERY_EASY) basehealth = 111375; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_EASY) basehealth = 141750; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_NORMAL) basehealth = 162000; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_HARD) basehealth = 182250; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_VERY_HARD) basehealth = 212625; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_EXTREME) basehealth = 243000; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_HORRIBLE) basehealth = 263250; // Sauravatar [DVI-DS]
		if (TrueGameSkill == SKILL_IMPOSSIBLE) basehealth = 263250; // Sauravatar [DVI-DS]
		if (TrueGameSkill >= SKILL_OMEGA) basehealth = 283500; // Sauravatar [DVI-DS]
		finalhealth = basehealth;
		if (debugstatcalc) Console.Printf("Phase1 - First Value: %d", finalhealth);

		if (TrueGameSkill <= SKILL_VERY_EASY) SkillMulti = 0.30;
		else if (TrueGameSkill == SKILL_EASY) SkillMulti = 0.35;
		else if (TrueGameSkill == SKILL_NORMAL) SkillMulti = 0.40;
		else if (TrueGameSkill == SKILL_HARD) SkillMulti = 0.45;
		else if (TrueGameSkill == SKILL_VERY_HARD) SkillMulti = 0.50;
		else if (TrueGameSkill == SKILL_EXTREME) SkillMulti = 0.55;
		else if (TrueGameSkill == SKILL_HORRIBLE) SkillMulti = 0.60;
		else if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillMulti = 0.65;
		else if (TrueGameSkill >= SKILL_OMEGA) SkillMulti = 0.70;
		int SkillHealthAdd = (finalhealth * SkillMulti);
		finalhealth += SkillHealthAdd;
		if (debugstatcalc) Console.Printf("Phase2 - Difficulty Add: %d, SkillHealthAdd: %d", finalhealth, SkillHealthAdd);

		if (modtype == 1)
		{
			MonsterKillHealth = (CallACS("ArrayVarSetDECORATE",0,1101,0,-1) * 192);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",1,1101,0,-1) * 24);
			if (debugstatcalc) Console.Printf("Phase3 - MonsterKillHealth [1101]: %d", MonsterKillHealth);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",0,1102,0,-1) * 160);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",1,1102,0,-1) * 36);
			if (debugstatcalc) Console.Printf("Phase3 - MonsterKillHealth [1102]: %d", MonsterKillHealth);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",0,1103,0,-1) * 128);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",1,1103,0,-1) * 48);
			if (debugstatcalc) Console.Printf("Phase3 - MonsterKillHealth [1103]: %d", MonsterKillHealth);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",0,1104,0,-1) * 96);
			MonsterKillHealth += (CallACS("ArrayVarSetDECORATE",1,1104,0,-1) * 60);
			if (debugstatcalc) Console.Printf("Phase3 - MonsterKillHealth [1104]: %d", MonsterKillHealth);

			if (TrueGameSkill <= SKILL_VERY_EASY) MonstKillHealthMulti = 0.70;
			else if (TrueGameSkill == SKILL_EASY) MonstKillHealthMulti = 0.88;
			else if (TrueGameSkill == SKILL_NORMAL) MonstKillHealthMulti = 1.00;
			else if (TrueGameSkill == SKILL_HARD) MonstKillHealthMulti = 1.12;
			else if (TrueGameSkill == SKILL_VERY_HARD) MonstKillHealthMulti = 1.24;
			else if (TrueGameSkill == SKILL_EXTREME) MonstKillHealthMulti = 1.36;
			else if (TrueGameSkill == SKILL_HORRIBLE) MonstKillHealthMulti = 1.48;
			else if (TrueGameSkill == SKILL_IMPOSSIBLE) MonstKillHealthMulti = 1.60;
			else if (TrueGameSkill >= SKILL_OMEGA) MonstKillHealthMulti = 1.72;
		
			finalhealth += (MonsterKillHealth * MonstKillHealthMulti);
			if (debugstatcalc) Console.Printf("Phase3 - Level Kills Add: %d, MonsterKillHealth: %d, MonstKillHealthMulti: %.8f", finalhealth, MonsterKillHealth, MonstKillHealthMulti);

			double SecretsFoundHealth;
			SecretsFoundHealth = CallACS("ArrayVarSetDECORATE",2,1101,0,-1);
			SecretsFoundHealth -= CallACS("ArrayVarSetDECORATE",2,1102,0,-1);
			SecretsFoundHealth -= CallACS("ArrayVarSetDECORATE",2,1103,0,-1);
			SecretsFoundHealth -= CallACS("ArrayVarSetDECORATE",2,1104,0,-1);
			if (TrueGameSkill <= SKILL_VERY_EASY) SecretsFoundHealth *= 1.5; // 150%
			else if (TrueGameSkill == SKILL_EASY) SecretsFoundHealth *= 1.25; // 125%
			else if (TrueGameSkill == SKILL_NORMAL) SecretsFoundHealth *= 1.0;  // 100%
			else if (TrueGameSkill == SKILL_HARD) SecretsFoundHealth *= 0.75; // 75%
			else if (TrueGameSkill == SKILL_VERY_HARD) SecretsFoundHealth *= 0.5;  // 50%
			else if (TrueGameSkill == SKILL_EXTREME) SecretsFoundHealth *= 0.3334;  // 33%
			else if (TrueGameSkill == SKILL_HORRIBLE) SecretsFoundHealth *= 0.2;  // 20%
			else if (TrueGameSkill == SKILL_IMPOSSIBLE) SecretsFoundHealth *= 0.1667;  // 16.6%
			else if (TrueGameSkill >= SKILL_OMEGA) SecretsFoundHealth *= 0.125;  // 12.5%
		
			int SecrFoundHealthMulti = 100;
			SecrFoundHealthMulti -= SecretsFoundHealth;
			finalhealth = finalhealth * SecrFoundHealthMulti / 100;
			if (debugstatcalc) Console.Printf("Phase4 - SecretsFound Add: %d, SecretsFoundHealth: %d, SecrFoundHealthMulti: %d", finalhealth, SecretsFoundHealth, SecrFoundHealthMulti);
		}
		
		double PLevelHealthMulti = PlayerLevel * 0.09;
		PLevelHealthMulti += 1.0;
		finalhealth *= PLevelHealthMulti;
		if (debugstatcalc) Console.Printf("Phase5 - PlayerLevel Add: %d, PLevelHealthMulti: %.8f", finalhealth, PLevelHealthMulti);
		

		if (CountInv("SauronHelmet",AAPTR_PLAYER1))
		{
			finalhealth *= 1.25; 
			if (debugstatcalc) Console.Printf("Phase6 - SauronItems Add: Found Helmet: %d", finalhealth);
		}
		if (CountInv("SauronGauntletsItem",AAPTR_PLAYER1))
		{
			finalhealth *= 1.25; 
			if (debugstatcalc) Console.Printf("Phase6 - SauronItems Add: Found Gauntlets: %d", finalhealth);
		}
		if (CountInv("TheOneRing",AAPTR_PLAYER1))
		{
			finalhealth *= 2;
			if (debugstatcalc) Console.Printf("Phase6 - SauronItems Add: Found Ring: %d", finalhealth);
		}
		if (debugstatcalc) Console.Printf("Phase6 - SauronItems Add: %d", finalhealth);

		health = finalhealth;
		user_MaxHP = finalhealth;

		if (modtype == 1) Thing_Damage(666, 9999999, 1000);
	}

	void A_SauravatarRegenMode()
	{
		SauravatarFirstDMG = user_MaxHP * 0.6667;
		SauravatarSecondDMG = user_MaxHP * 0.3334;

		int SkillHealthAdd;
		double SkillMulti;
		int regendebug = dvdsdebug_actorregendisplays;

		int RegenBaseTics = 49;
		if (TrueGameSkill <= SKILL_VERY_EASY) RegenBaseTics *= 1.24;
		else if (TrueGameSkill == SKILL_EASY) RegenBaseTics *= 1.12;
		else if (TrueGameSkill == SKILL_NORMAL) RegenBaseTics *= 1.00;
		else if (TrueGameSkill == SKILL_HARD) RegenBaseTics *= 0.94;
		else if (TrueGameSkill == SKILL_VERY_HARD) RegenBaseTics *= 0.88;
		else if (TrueGameSkill == SKILL_EXTREME) RegenBaseTics *= 0.76;
		else if (TrueGameSkill == SKILL_HORRIBLE) RegenBaseTics *= 0.64;
		else if (TrueGameSkill == SKILL_IMPOSSIBLE) RegenBaseTics *= 0.46;
		else if (TrueGameSkill >= SKILL_OMEGA) RegenBaseTics *= 0.28;
		if (health <= SauravatarFirstDMG) RegenBaseTics *= 0.667;
		if (health <= SauravatarSecondDMG) RegenBaseTics *= 0.667;
		
		if (SauravatarRegenState == 4) GetAge() % RegenBaseTics * 27;
		else if (SauravatarRegenState == 3) SauravatarRegenTic = GetAge() % RegenBaseTics * 9;
		else if (SauravatarRegenState == 2) SauravatarRegenTic = GetAge() % RegenBaseTics * 3;
		else SauravatarRegenTic = GetAge() % RegenBaseTics;
		if (regendebug) Console.Printf("SauravatarRegenTic: %d, RegenState: %d", SauravatarRegenTic, SauravatarRegenState);
		
		if (SauravatarRegenTic == 0)
		{
			if (health < user_MaxHP)
			{
				if (TrueGameSkill <= SKILL_VERY_EASY) SkillMulti = 6;
				if (TrueGameSkill == SKILL_EASY) SkillMulti = 7;
				if (TrueGameSkill == SKILL_NORMAL) SkillMulti = 8;
				if (TrueGameSkill == SKILL_HARD) SkillMulti = 9;
				if (TrueGameSkill == SKILL_VERY_HARD) SkillMulti = 10;
				if (TrueGameSkill == SKILL_EXTREME) SkillMulti = 11;
				if (TrueGameSkill == SKILL_HORRIBLE) SkillMulti = 12;
				if (TrueGameSkill == SKILL_IMPOSSIBLE) SkillMulti = 13;
				if (TrueGameSkill >= SKILL_OMEGA) SkillMulti = 14;

				if (SauravatarRegenState == 0) SkillMulti *= 1;
				if (SauravatarRegenState == 1) SkillMulti *= 4;
				if (SauravatarRegenState == 2) SkillMulti *= 0.25;
				if (SauravatarRegenState == 3) SkillMulti *= 0.0625;
				if (SauravatarRegenState == 4) SkillMulti *= 0.0;
				
				if (health <= SauravatarFirstDMG)
				{
					if (health <= SauravatarSecondDMG) SkillMulti *= 5.0; 
					else SkillMulti *= 3.0;
				}
				SkillHealthAdd = user_MaxHP * SkillMulti / randompick(262144,131072,131072,131072,131072,131072,131072,131072,131072,131072,131072,65536);
				if (health <= SauravatarSecondDMG) SkillHealthAdd += random((-7-TrueGameSkill),(7+TrueGameSkill));
				if (health <= SauravatarFirstDMG) SkillHealthAdd += random((-5-TrueGameSkill),(5+TrueGameSkill));
				SkillHealthAdd += random((-4-TrueGameSkill),(4+TrueGameSkill));

				SkillHealthAdd = clamp(SkillHealthAdd, TrueGameSkill, SkillHealthAdd);
				health += SkillHealthAdd;
				health = clamp(health, health, user_MaxHP);
				if (regendebug) Console.Printf("SkillHealthAdd: %d, SkillMulti: %d, RegenState: %d", SkillHealthAdd, SkillMulti, SauravatarRegenState);
			}
		}
		
		if (health <= SauravatarFirstDMG)
		{
			if (health <= SauravatarSecondDMG) SauravatarAtkType = 2;
			else SauravatarAtkType = 1;
		}
		else SauravatarAtkType = 0;
		if (regendebug) Console.Printf("SauravatarAtkType: %d, (1st: %d, 2nd: %d)", SauravatarAtkType, SauravatarFirstDMG, SauravatarSecondDMG);
	}

	override void Tick()
	{
		if (self.health > 0 && !ActorLevelCalcs && !bDORMANT) 
		{
			A_SetSauravatarHealth();
			A_AetheriusStats(0); 
		}
		if (self.health > 0 && ActorLevelCalcs && !bDORMANT) A_SauravatarRegenMode();

		AetheriusBossZSC.Tick();
	}

	States
	{
		Pain.Charm: goto See;
		Spawn:
			CYBS A 0 NoDelay
			{
				Thing_ChangeTID(0,1124);
				Thing_SetTranslation(1124,16);
			}
			CYBS A 1;
			goto Idle;
		Idle:
			CYBR AB 3
			{
				A_Look();
				SauravatarRegenState = 1;
			}
			loop;

		See:
			CYBR A 0
			{
				A_QuakeEx(random(1,2),random(1,2),random(2,3),random(14,17),0,random(960,1088));
				user_random1 = random(1,4);
				if (user_random1 == 1) { A_StartSound("SauronStomp1",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 2) { A_StartSound("SauronStomp2",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 3) { A_StartSound("SauronStomp3",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 4) { A_StartSound("SauronStomp4",101,CHANF_DEFAULT,1); }
	
				if (random(1,8) == 1)
				{
					user_random1 = random(1,4);
					if (user_random1 == 1) { A_StartSound("SauronActive1",102,CHANF_DEFAULT,1); }
					else if (user_random1 == 2) { A_StartSound("SauronActive2",102,CHANF_DEFAULT,1); }
					else if (user_random1 == 3) { A_StartSound("SauronActive3",102,CHANF_DEFAULT,1); }
					else if (user_random1 == 4) { A_StartSound("SauronActive4",102,CHANF_DEFAULT,1); }
				}
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			CYBR AAB 3
			{
				A_DVDSChase("Melee","Missile",0);
				SauravatarRegenState = 0;
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			CYBR B 3
			{
				A_DVDSChase(null,"Missile",CHF_FASTCHASE);
				SauravatarRegenState = 0;
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			CYBR CCD 3
			{
				A_DVDSChase("Melee","Missile",0);
				SauravatarRegenState = 0;
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			CYBR D 3
			{
				A_DVDSChase(null,"Missile",CHF_FASTCHASE);
				SauravatarRegenState = 0;
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			loop;
		MissileHealthLow:
			CYBR E 4 
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 9
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,45);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,-45);
				SauravatarRegenState = 2;
			}
			CYBR E 9
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 9
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				SauravatarRegenState = 2;
			}
			CYBR E 9
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 9
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,60);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,-60);
				SauravatarRegenState = 2;
			}
			goto See;
		MissileHealthMod:
			CYBR E 5
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 11
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,22.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,0);
				SauravatarRegenState = 2;
			}
			CYBR E 11
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 11
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,-22.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,0);
				SauravatarRegenState = 2;
			}
			CYBR E 11
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 11
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,-11.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,11.25);
				SauravatarRegenState = 2;
			}
			goto See;

		Melee:
		Missile:
			TNT1 A 0 A_JumpIfCloser(135, "Stomp");
			CYBR A 0 A_JumpIf(SauravatarAtkType >= 2,"MissileHealthLow");
			CYBR A 0 A_JumpIf(SauravatarAtkType == 1,"MissileHealthMod");
			CYBR E 6
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 12
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				SauravatarRegenState = 2;
			}
			CYBR E 12
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 12
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				SauravatarRegenState = 2;
			}
			CYBR E 12
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 12
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				SauravatarRegenState = 2;
			}
			goto See;

		Stomp:
			CYBR Z 5
			{
				if (levelbehavior && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior && user_monsterlevel > 60) { A_SetTics(4); }
	
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYMA A 7
			{
				if (levelbehavior && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYMA B 7
			{
				if (levelbehavior && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget();
				
				A_MonsterCrisisCheck(); // Single Projectile
				A_CrisisSpawnProjectile("SauravatarStomp","SauravatarStompCrisis",10,0,0,0);
				if (user_canusecrisisatk == 1) { A_Quake(5,21,0,512,"nosound/silent"); }
				else { A_Quake(2,21,0,512,"nosound/silent"); }
				SauravatarRegenState = 2;
			}
			CYMA B 7
			{
				if (levelbehavior && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior && user_monsterlevel > 60) { A_SetTics(6); }
				SauravatarRegenState = 2;
			}
			CYMA B 0 A_Jump(64,2);
			CYMA B 0 A_JumpIfCloser(135, "Stomp");
			CYMA B 0
			{
				SauravatarRegenState = 2;
			}
			Goto See;

		Pain:
			CYBR G 0
			{
				SauravatarRegenState = 3;
			}
			CYBR G 10
			{
				user_random1 = random(1,4);
				if (user_random1 == 1) { A_StartSound("SauronPain1",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 2) { A_StartSound("SauronPain2",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 3) { A_StartSound("SauronPain3",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 4) { A_StartSound("SauronPain4",101,CHANF_DEFAULT,1); }
				SauravatarRegenState = 3;
			}
			goto See;
		PainCounterHealthLow:
			CYBR G 10
			{
				A_SetTranslucent(0.50, 0);
				SauravatarRegenState = 2;
			}
			CYBR E 2 
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 4 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,3);
				A_SpawnProjectile("SauronBFGBall3",45,0,9);
				A_SpawnProjectile("SauronBFGBall3",45,0,15);
				A_SpawnProjectile("SauronBFGBall3",45,0,21);
				A_SpawnProjectile("SauronBFGBall3",45,0,27);
				A_SpawnProjectile("SauronBFGBall3",45,0,33);
				A_SpawnProjectile("SauronBFGBall3",45,0,39);
				A_SpawnProjectile("SauronBFGBall3",45,0,45);
				A_SpawnProjectile("SauronBFGBall3",45,0,51);
				A_SpawnProjectile("SauronBFGBall3",45,0,57);
				A_SpawnProjectile("SauronBFGBall3",45,0,63);
				A_SpawnProjectile("SauronBFGBall3",45,0,69);
				A_SpawnProjectile("SauronBFGBall3",45,0,75);
				A_SpawnProjectile("SauronBFGBall3",45,0,81);
				A_SpawnProjectile("SauronBFGBall3",45,0,87);
				A_SpawnProjectile("SauronBFGBall3",45,0,-42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-36);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				A_SpawnProjectile("SauronBFGBall3",45,0,-24);
				A_SpawnProjectile("SauronBFGBall3",45,0,-18);
				A_SpawnProjectile("SauronBFGBall3",45,0,-12);
				A_SpawnProjectile("SauronBFGBall3",45,0,-6);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,6);
				A_SpawnProjectile("SauronBFGBall3",45,0,12);
				A_SpawnProjectile("SauronBFGBall3",45,0,18);
				A_SpawnProjectile("SauronBFGBall3",45,0,24);
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,36);
				A_SpawnProjectile("SauronBFGBall3",45,0,42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-87);
				A_SpawnProjectile("SauronBFGBall3",45,0,-81);
				A_SpawnProjectile("SauronBFGBall3",45,0,-75);
				A_SpawnProjectile("SauronBFGBall3",45,0,-69);
				A_SpawnProjectile("SauronBFGBall3",45,0,-63);
				A_SpawnProjectile("SauronBFGBall3",45,0,-57);
				A_SpawnProjectile("SauronBFGBall3",45,0,-51);
				A_SpawnProjectile("SauronBFGBall3",45,0,-45);
				A_SpawnProjectile("SauronBFGBall3",45,0,-39);
				A_SpawnProjectile("SauronBFGBall3",45,0,-33);
				A_SpawnProjectile("SauronBFGBall3",45,0,-27);
				A_SpawnProjectile("SauronBFGBall3",45,0,-21);
				A_SpawnProjectile("SauronBFGBall3",45,0,-15);
				A_SpawnProjectile("SauronBFGBall3",45,0,-9);
				A_SpawnProjectile("SauronBFGBall3",45,0,-3);
				SauravatarRegenState = 2;
			}
			CYBR E 5
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 4 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,-12);
				A_SpawnProjectile("SauronBFGBall3",45,0,-6);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,6);
				A_SpawnProjectile("SauronBFGBall3",45,0,12);
				A_SpawnProjectile("SauronBFGBall3",45,0,18);
				A_SpawnProjectile("SauronBFGBall3",45,0,24);
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,36);
				A_SpawnProjectile("SauronBFGBall3",45,0,42);
				A_SpawnProjectile("SauronBFGBall3",45,0,48);
				A_SpawnProjectile("SauronBFGBall3",45,0,54);
				A_SpawnProjectile("SauronBFGBall3",45,0,60);
				A_SpawnProjectile("SauronBFGBall3",45,0,66);
				A_SpawnProjectile("SauronBFGBall3",45,0,72);
				A_SpawnProjectile("SauronBFGBall3",45,0,-42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-36);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				A_SpawnProjectile("SauronBFGBall3",45,0,-24);
				A_SpawnProjectile("SauronBFGBall3",45,0,-18);
				A_SpawnProjectile("SauronBFGBall3",45,0,-12);
				A_SpawnProjectile("SauronBFGBall3",45,0,-6);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,6);
				A_SpawnProjectile("SauronBFGBall3",45,0,12);
				A_SpawnProjectile("SauronBFGBall3",45,0,18);
				A_SpawnProjectile("SauronBFGBall3",45,0,24);
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,36);
				A_SpawnProjectile("SauronBFGBall3",45,0,42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-72);
				A_SpawnProjectile("SauronBFGBall3",45,0,-66);
				A_SpawnProjectile("SauronBFGBall3",45,0,-60);
				A_SpawnProjectile("SauronBFGBall3",45,0,-54);
				A_SpawnProjectile("SauronBFGBall3",45,0,-48);
				A_SpawnProjectile("SauronBFGBall3",45,0,-42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-36);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				A_SpawnProjectile("SauronBFGBall3",45,0,-24);
				A_SpawnProjectile("SauronBFGBall3",45,0,-18);
				A_SpawnProjectile("SauronBFGBall3",45,0,-12);
				A_SpawnProjectile("SauronBFGBall3",45,0,-6);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,6);
				A_SpawnProjectile("SauronBFGBall3",45,0,12);
				SauravatarRegenState = 2;
			}
			CYBR E 5
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 4 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall3",45,0,18);
				A_SpawnProjectile("SauronBFGBall3",45,0,24);
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,36);
				A_SpawnProjectile("SauronBFGBall3",45,0,42);
				A_SpawnProjectile("SauronBFGBall3",45,0,48);
				A_SpawnProjectile("SauronBFGBall3",45,0,54);
				A_SpawnProjectile("SauronBFGBall3",45,0,60);
				A_SpawnProjectile("SauronBFGBall3",45,0,66);
				A_SpawnProjectile("SauronBFGBall3",45,0,72);
				A_SpawnProjectile("SauronBFGBall3",45,0,78);
				A_SpawnProjectile("SauronBFGBall3",45,0,84);
				A_SpawnProjectile("SauronBFGBall3",45,0,90);
				A_SpawnProjectile("SauronBFGBall3",45,0,96);
				A_SpawnProjectile("SauronBFGBall3",45,0,102);
				A_SpawnProjectile("SauronBFGBall3",45,0,-42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-36);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				A_SpawnProjectile("SauronBFGBall3",45,0,-24);
				A_SpawnProjectile("SauronBFGBall3",45,0,-18);
				A_SpawnProjectile("SauronBFGBall3",45,0,-12);
				A_SpawnProjectile("SauronBFGBall3",45,0,-6);
				A_SpawnProjectile("SauronBFGBall3",45,0,0);
				A_SpawnProjectile("SauronBFGBall3",45,0,6);
				A_SpawnProjectile("SauronBFGBall3",45,0,12);
				A_SpawnProjectile("SauronBFGBall3",45,0,18);
				A_SpawnProjectile("SauronBFGBall3",45,0,24);
				A_SpawnProjectile("SauronBFGBall3",45,0,30);
				A_SpawnProjectile("SauronBFGBall3",45,0,36);
				A_SpawnProjectile("SauronBFGBall3",45,0,42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-102);
				A_SpawnProjectile("SauronBFGBall3",45,0,-96);
				A_SpawnProjectile("SauronBFGBall3",45,0,-90);
				A_SpawnProjectile("SauronBFGBall3",45,0,-84);
				A_SpawnProjectile("SauronBFGBall3",45,0,-78);
				A_SpawnProjectile("SauronBFGBall3",45,0,-72);
				A_SpawnProjectile("SauronBFGBall3",45,0,-66);
				A_SpawnProjectile("SauronBFGBall3",45,0,-60);
				A_SpawnProjectile("SauronBFGBall3",45,0,-54);
				A_SpawnProjectile("SauronBFGBall3",45,0,-48);
				A_SpawnProjectile("SauronBFGBall3",45,0,-42);
				A_SpawnProjectile("SauronBFGBall3",45,0,-36);
				A_SpawnProjectile("SauronBFGBall3",45,0,-30);
				A_SpawnProjectile("SauronBFGBall3",45,0,-24);
				A_SpawnProjectile("SauronBFGBall3",45,0,-18);
				SauravatarRegenState = 2;
			}
			goto PainGauntEnd;

		PainCounterHealthMod:
			CYBR G 10
			{
				A_SetTranslucent(0.50, 0);
				SauravatarRegenState = 2;
			}
			CYBR E 2 
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 5 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,-19.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-13.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-7.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-1.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,4.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,10.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,16.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,22.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,28.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,34.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,40.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,46.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,52.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,58.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,64.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-42);
				A_SpawnProjectile("SauronBFGBall2",45,0,-36);
				A_SpawnProjectile("SauronBFGBall2",45,0,-30);
				A_SpawnProjectile("SauronBFGBall2",45,0,-24);
				A_SpawnProjectile("SauronBFGBall2",45,0,-18);
				A_SpawnProjectile("SauronBFGBall2",45,0,-12);
				A_SpawnProjectile("SauronBFGBall2",45,0,-6);
				A_SpawnProjectile("SauronBFGBall2",45,0,0);
				A_SpawnProjectile("SauronBFGBall2",45,0,6);
				A_SpawnProjectile("SauronBFGBall2",45,0,12);
				A_SpawnProjectile("SauronBFGBall2",45,0,18);
				A_SpawnProjectile("SauronBFGBall2",45,0,24);
				A_SpawnProjectile("SauronBFGBall2",45,0,30);
				A_SpawnProjectile("SauronBFGBall2",45,0,36);
				A_SpawnProjectile("SauronBFGBall2",45,0,42);
				SauravatarRegenState = 2;
			}
			CYBR E 6
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 5 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,-42);
				A_SpawnProjectile("SauronBFGBall2",45,0,-36);
				A_SpawnProjectile("SauronBFGBall2",45,0,-30);
				A_SpawnProjectile("SauronBFGBall2",45,0,-24);
				A_SpawnProjectile("SauronBFGBall2",45,0,-18);
				A_SpawnProjectile("SauronBFGBall2",45,0,-12);
				A_SpawnProjectile("SauronBFGBall2",45,0,-6);
				A_SpawnProjectile("SauronBFGBall2",45,0,0);
				A_SpawnProjectile("SauronBFGBall2",45,0,6);
				A_SpawnProjectile("SauronBFGBall2",45,0,12);
				A_SpawnProjectile("SauronBFGBall2",45,0,18);
				A_SpawnProjectile("SauronBFGBall2",45,0,24);
				A_SpawnProjectile("SauronBFGBall2",45,0,30);
				A_SpawnProjectile("SauronBFGBall2",45,0,36);
				A_SpawnProjectile("SauronBFGBall2",45,0,42);
				A_SpawnProjectile("SauronBFGBall2",45,0,-64.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-58.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-52.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-46.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-40.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-34.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-28.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-22.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-16.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-10.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,-4.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,1.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,7.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,13.5);
				A_SpawnProjectile("SauronBFGBall2",45,0,19.5);
			}
			CYBR E 6
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 5 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall2",45,0,-30.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,-24.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,-18.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,-12.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,-6.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,-0.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,5.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,11.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,17.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,23.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,29.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,35.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,41.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,47.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,53.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-53.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-47.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-41.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-35.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-29.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-23.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-17.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-11.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,-5.25);
				A_SpawnProjectile("SauronBFGBall2",45,0,0.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,6.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,12.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,18.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,24.75);
				A_SpawnProjectile("SauronBFGBall2",45,0,30.75);
				SauravatarRegenState = 2;
			}
			goto PainGauntEnd;
		PainCounter:
			CYBR G 10
			{
				A_SetTranslucent(0.50, 0);
				SauravatarRegenState = 2;
			}
			CYBR E 3 
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 6 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,-42);
				A_SpawnProjectile("SauronBFGBall",45,0,-36);
				A_SpawnProjectile("SauronBFGBall",45,0,-30);
				A_SpawnProjectile("SauronBFGBall",45,0,-24);
				A_SpawnProjectile("SauronBFGBall",45,0,-18);
				A_SpawnProjectile("SauronBFGBall",45,0,-12);
				A_SpawnProjectile("SauronBFGBall",45,0,-6);
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				A_SpawnProjectile("SauronBFGBall",45,0,6);
				A_SpawnProjectile("SauronBFGBall",45,0,12);
				A_SpawnProjectile("SauronBFGBall",45,0,18);
				A_SpawnProjectile("SauronBFGBall",45,0,24);
				A_SpawnProjectile("SauronBFGBall",45,0,30);
				A_SpawnProjectile("SauronBFGBall",45,0,36);
				A_SpawnProjectile("SauronBFGBall",45,0,42);
				SauravatarRegenState = 2;
			}
			CYBR E 6
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 6 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,-42);
				A_SpawnProjectile("SauronBFGBall",45,0,-36);
				A_SpawnProjectile("SauronBFGBall",45,0,-30);
				A_SpawnProjectile("SauronBFGBall",45,0,-24);
				A_SpawnProjectile("SauronBFGBall",45,0,-18);
				A_SpawnProjectile("SauronBFGBall",45,0,-12);
				A_SpawnProjectile("SauronBFGBall",45,0,-6);
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				A_SpawnProjectile("SauronBFGBall",45,0,6);
				A_SpawnProjectile("SauronBFGBall",45,0,12);
				A_SpawnProjectile("SauronBFGBall",45,0,18);
				A_SpawnProjectile("SauronBFGBall",45,0,24);
				A_SpawnProjectile("SauronBFGBall",45,0,30);
				A_SpawnProjectile("SauronBFGBall",45,0,36);
				A_SpawnProjectile("SauronBFGBall",45,0,42);
				SauravatarRegenState = 2;
			}
			CYBR E 6
			{
				A_FaceTarget();
				SauravatarRegenState = 2;
			}
			CYBR F 6 
			{
				A_StartSound("weapons/bfgf");
				A_SpawnProjectile("SauronBFGBall",45,0,-42);
				A_SpawnProjectile("SauronBFGBall",45,0,-36);
				A_SpawnProjectile("SauronBFGBall",45,0,-30);
				A_SpawnProjectile("SauronBFGBall",45,0,-24);
				A_SpawnProjectile("SauronBFGBall",45,0,-18);
				A_SpawnProjectile("SauronBFGBall",45,0,-12);
				A_SpawnProjectile("SauronBFGBall",45,0,-6);
				A_SpawnProjectile("SauronBFGBall",45,0,0);
				A_SpawnProjectile("SauronBFGBall",45,0,6);
				A_SpawnProjectile("SauronBFGBall",45,0,12);
				A_SpawnProjectile("SauronBFGBall",45,0,18);
				A_SpawnProjectile("SauronBFGBall",45,0,24);
				A_SpawnProjectile("SauronBFGBall",45,0,30);
				A_SpawnProjectile("SauronBFGBall",45,0,36);
				A_SpawnProjectile("SauronBFGBall",45,0,42);
				SauravatarRegenState = 2;
			}
			goto PainGauntEnd;

		Pain.Sceptre:
			CYBR G 0 { SauravatarRegenState = 3; }
			CYBR G 10
			{
				user_random1 = random(1,4);
				if (user_random1 == 1) { A_StartSound("SauronPain1",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 2) { A_StartSound("SauronPain2",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 3) { A_StartSound("SauronPain3",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 4) { A_StartSound("SauronPain4",101,CHANF_DEFAULT,1); }
				SauravatarRegenState = 3;
				A_SetTics(random(8,12));
			}
			CYBR GGGG 10 A_SetTics(random(8,12));
			goto See;

		Pain.Gauntlets:
			CYBR G 1
			{
				user_random1 = random(1,4);
				if (user_random1 == 1) { A_StartSound("SauronPain1",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 2) { A_StartSound("SauronPain2",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 3) { A_StartSound("SauronPain3",101,CHANF_DEFAULT,1); }
				else if (user_random1 == 4) { A_StartSound("SauronPain4",101,CHANF_DEFAULT,1); }
				SauravatarRegenState = 4;
				A_SetTics(random(0,1));
			}
			CYBR G 0 A_SetReflectiveInvulnerable;
			CYBR G 0 A_UnSetShootable;
			CYBR G 10 
			{
				A_SetTranslucent (0.50, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.33, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.50, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.33, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.50, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.33, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.50, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 10
			{
				A_SetTranslucent (0.33, 0);
				SauravatarRegenState = 4;
			}
			CYBR G 0 A_SetShootable;
			CYBR G 0 A_UnSetReflectiveInvulnerable;
			CYBR G 0 
			{
				A_SetInventory("SauravatarGauntResist",1);
				bNOPAIN = true;
			}
			CYBR A 0 A_JumpIf(SauravatarAtkType >= 2,"PainCounterHealthLow");
			CYBR A 0 A_JumpIf(SauravatarAtkType == 1,"PainCounterHealthMod");
			CYBR A 0 A_JumpIf(SauravatarAtkType <= 0,"PainCounter");
			goto PainCounter;
		PainGauntEnd:
			CYBR G 0 
			{
				A_SetTranslucent (1.0, 0);
				A_SetInventory("SauravatarGauntResist",0);
				bNOPAIN = false;
			}
			goto See;
		XDeath:
		Death:
			CYBR G 0 { SauravatarRegenState = 4; }
			TNT1 A 0 A_DVDSNormalDeath((864000+user_MaxHP),0,1);
			CYBR H 5 A_SetTranslucent (0.9775, 0);
			CYBR H 5 A_SetTranslucent (0.955, 0);
			CYBR I 0 ACS_NamedExecute("SauravatarDeath",0,0,0,0);
			CYBR I 0 A_StartSound("SauronDeath",101,CHANF_DEFAULT,2);
			CYBR I 5 A_SetTranslucent (0.9325, 0);
			CYBR I 5 A_SetTranslucent (0.91, 0);
			CYBR J 5 A_SetTranslucent (0.8875, 0);
			CYBR J 5 A_SetTranslucent (0.865, 0);
			CYBR K 5 A_SetTranslucent (0.8425, 0);
			CYBR K 5 A_SetTranslucent (0.82, 0);
			CYBR L 5 A_SetTranslucent (0.7975, 0);
			CYBR L 5 A_SetTranslucent (0.775, 0);
			CYBR M 0 A_NoBlocking;
			CYBR M 5 A_SetTranslucent (0.7525, 0);
			CYBR M 5 A_SetTranslucent (0.73, 0);
			CYBR N 5 A_SetTranslucent (0.7075, 0);
			CYBR N 5 A_SetTranslucent (0.685, 0);
			CYBR O 5 A_SetTranslucent (0.6625, 0);
			CYBR O 5 A_SetTranslucent (0.64, 0);
			CYBR P 5 A_SetTranslucent (0.6175, 0);
			CYBR P 5 A_SetTranslucent (0.595, 0);
			CYBR P 5 A_SetTranslucent (0.5725, 0);
			CYBR P 5 A_SetTranslucent (0.55, 0);
			CYBR P 5 A_SetTranslucent (0.5275, 0);
			CYBR P 5 A_SetTranslucent (0.505, 0);
			CYBR P 5 A_SetTranslucent (0.4825, 0);
			CYBR P 5 A_SetTranslucent (0.46, 0);
			CYBR P 5 A_SetTranslucent (0.4375, 0);
			CYBR P 5 A_SetTranslucent (0.415, 0);
			CYBR P 5 A_SetTranslucent (0.3925, 0);
			CYBR P 5 A_SetTranslucent (0.37, 0);
			CYBR P 5 A_SetTranslucent (0.3475, 0);
			CYBR P 5 A_SetTranslucent (0.325, 0);
			CYBR P 5 A_SetTranslucent (0.3025, 0);
			CYBR P 5 A_SetTranslucent (0.28, 0);
			CYBR P 5 A_SetTranslucent (0.2575, 0);
			CYBR P 5 A_SetTranslucent (0.235, 0);
			CYBR P 5 A_SetTranslucent (0.2125, 0);
			CYBR P 5 A_SetTranslucent (0.19, 0);
			CYBR P 5 A_SetTranslucent (0.1675, 0);
			CYBR P 5 A_SetTranslucent (0.145, 0);
			CYBR P 5 A_SetTranslucent (0.1225, 0);
			CYBR P 5 A_SetTranslucent (0.10, 0);
			CYBR P 5 A_SetTranslucent (0.0775, 0);
			CYBR P 5 A_SetTranslucent (0.055, 0);
			CYBR P 0 
			{
				if (ModType == 1) { A_StartSound("SauronDeathS",102,CHANF_DEFAULT,2); }
			}
			CYBR P 5 A_SetTranslucent (0.0325, 0);
			CYBR P 5 A_SetTranslucent (0.01, 0);
			CYBR P 875
			{
				if (ModType != 1) { A_SetTics(0); }
			}
			// 1095 total time
			CYBR P -1 
			{
				if (ModType == 1) { A_BrainDie(); } else { A_SetTics(0); }
			}
			stop;
	}
}

// Sauravatar "Still"
class SauravatarStill : Sauravatar
{
	default
	{
		mass 50000000;
		species "Sauron";
		-SHOOTABLE;
		-ISMONSTER;
	}

	States
	{
		Spawn:
			CYBS A 0 NoDelay
			{
				Thing_ChangeTID(0,1124);
				Thing_SetTranslation(1124,16);
				Thing_ChangeTID(1124,1124);
			}
			goto Idle;
		Idle:
			CYBR ABCD 35;
			loop;
	}
}

// TODO - Lesser Sauravatar [BOSS]

//***********************************
//** ACTUAL Monster Definitions V: **
//***********************************
// Practice Target
class PracticeTarget : AetheriusMonsterZSC //21333
{
	default
	{
		Tag "Practicing Target";
		AetheriusMonsterZSC.ActorFamily "PracticeTarget";
		//$Angled
		//$Color 6
		//$Category DV-DS Monsters
		Radius 16;
		Height 48;
		Health 10000000;
		Mass 275000000;
		PainChance 255;
		
		Scale 0.4325; // 0.25
		
		+ISMONSTER;
		+SHOOTABLE;
		+NOBLOOD;
		+FORCEYBILLBOARD;
		+NEVERTARGET;
		+NOPAIN;
		-SOLID;
		-COUNTKILL;
	}
		
	States
	{
		Spawn:
				PRDU A 0 NoDelay Bright;
		See:
			PRDU A 1 
			{
				if (targetdummyhitcooldown > 0) targetdummyhitcooldown--;
				if (targetdummyhitcooldown == 0) { A_DVDSHealThing(10000000, user_MaxHP, 1); }
			}
			Loop;
		Death:
			TNT1 A -1 A_SpawnItemEx("PracticeTarget", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
			Stop;

		Pain: goto See;
		Pain.Charm: goto See;
		Pain.Heal1: goto See;
		Pain.Heal2: goto See;
		Pain.Heal3: goto See;
		Pain.Heal4: goto See;
		Pain.Sceptre: goto See;
		Death.Sceptre: Goto Death;
		Pain.Gauntlets: goto See;
		Death.Gauntlets: Goto Death;
	}
}

class PracticeTarget2 : AetheriusMonsterZSC //21334
{
	default
	{
		Tag "Practicing Target";
		AetheriusMonsterZSC.ActorFamily "PracticeTarget";
		//$Angled
		//$Color 6
		//$Category DV-DS Monsters
		Radius 16;
		Height 48;
		Health 10000000;
		Mass 275000000;
		PainChance 255;
		
		Scale 0.4325; // 0.25
		
		+ISMONSTER;
		+SHOOTABLE;
		+NOBLOOD;
		+FORCEYBILLBOARD;
		+NEVERTARGET;
		+SOLID;
		+NOPAIN;
		-COUNTKILL;
	}
	
	States
	{
		Spawn:
			PRDU A 0 NoDelay Bright;
		See:
			PRDU A 1
			{
				if (targetdummyhitcooldown > 0) targetdummyhitcooldown--;
				if (targetdummyhitcooldown == 0) { A_DVDSHealThing(10000000, user_MaxHP, 1); }
			}
			Loop;
		Death:
			TNT1 A -1 A_SpawnItemEx("PracticeTarget2", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION);
			Stop;
		Pain: goto See;
		Pain.Charm: goto See;
		Pain.Heal1: goto See;
		Pain.Heal2: goto See;
		Pain.Heal3: goto See;
		Pain.Heal4: goto See;
		Pain.Sceptre: goto See;
		Death.Sceptre: Goto Death;
		Pain.Gauntlets: goto See;
		Death.Gauntlets: Goto Death;
	}
}

// BOSSES
class SauronEyeWeak : AetheriusBossZSC
{
	default
	{
		health 8400; // 5600
		radius 32;
		height 32;
		mass 50000000;
		gravity 0.0;
		obituary "%o was erased from life by one of Sauron's lesser 'eyes'.";
		species "Sauron";
		painchance 255;
		Tag "Sauron's Lesser Eye";

		DamageFactor 0.25;
		DamageFactor "Gauntlets", 20;
		DamageFactor "Sceptre", 10;
		DamageFactor "Magic", 13.332;
		DamageFactor "Explosive", 1.6;
		RadiusDamageFactor 1.6;

		seesound "SauronLaugh1";
		painsound "SauronEPain";
		deathsound "SauronEDeath";
		activesound "null";
		
		+AMBUSH;
		+NOGRAVITY;
		+SHOOTABLE;
		+LOOKALLAROUND;
		+NOTARGETSWITCH;
		+INVISIBLE;
		+NOBLOOD;
		+DONTFALL;
		+NOTARGET;
		+NOFEAR;
		+NOINFIGHTING;
		+CANTSEEK;
		+DONTMORPH;
		+DONTSQUASH;
		+NOTELEOTHER;
		-ISMONSTER;
		-COUNTKILL;
		+FULLVOLACTIVE;
		+FULLVOLDEATH;
		+BOSS;
		+THRUSPECIES;
		+NOTONAUTOMAP;
		-NORADIUSDMG;

		DamageFactor "Holy", 3; // Sauron-Class = +300% Holy Damage
		Painchance "Holy", 255; // Sauron-Class = +600% Pain Chance
		Painchance 255;
	}


	States
	{
		Pain.Charm: goto See;
		Spawn:
			SOUL A 0 NoDelay;
			SOUL A 1 A_Look();
			goto Spawn+1;
		See:
			SOUL A 0 A_Jump (256, "85sec", "8sec", "95sec", "9sec");
			SOUL A 1;
			loop;

		MissileHealthLow:
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		EyebeamHealthLow:
			SOUL A 0 A_FaceTarget();
			SOUL A 0 A_SpawnProjectile("SauronEyePlasma",20,-30,0,8);
			SOUL A 0 A_SpawnProjectile("SauronEyePlasma",20,0,0,8);
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma",20,30,0,8);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==20,"EndEyeBeamHealthLow");
			Loop;
		EndEyeBeamHealthLow:
			SOUL A 0 A_FaceTarget();
			goto See+1;
		Missile:
			SOUL A 0 A_JumpIfHealthLower(1400,"MissileHealthLow");
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma",20);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==20,"EndEyeBeam");
			Loop;
		EndEyeBeam:
			SOUL A 0 A_FaceTarget();
			goto See+1;
		8sec:
			SOUL AAAAAAAA 35 A_FaceTarget();
			goto Missile;
		85sec:
			SOUL AAAAAAAA 35 A_FaceTarget();
			SOUL A 17 A_FaceTarget();
			goto Missile;
		9sec:
			SOUL AAAAAAAAA 35 A_FaceTarget();
			goto Missile;
		95sec:
			SOUL AAAAAAAAA 35 A_FaceTarget();
			SOUL A 17 A_FaceTarget();
			goto Missile;
		Pain:
			SOUL A 0 A_StartSound("SauronEPain",CHAN_VOICE,1.0,ATTN_NONE);
			SOUL A 1 A_Jump (96, "Missile");
			goto See;
		XDeath:
		Death:
			TNT1 A 0 A_DVDSNormalDeath(15840,0,1);
			SOUL A 0 ACS_NamedExecute("DVI-M02EyeDead",0,0,0,0);
			SOUL A 0 A_StopSound(CHAN_VOICE);
			SOUL A 0 A_StopSound(CHAN_BODY);
			SOUL A 0 A_StopSound(CHAN_AUTO);
			SOUL A 1 A_StartSound("SauronEDeath",CHAN_VOICE,1.0,ATTN_NONE);
			SOUL A 1;
			Stop;
	}
}

class SauronEyeStrong1 : SauronEyeWeak
{
	default
	{
		health 14400; // 9600
		DamageFactor 0.25;
		DamageFactor "Gauntlets", 20;
		DamageFactor "Sceptre", 10;
		DamageFactor "Magic", 13.332;
		DamageFactor "Explosive", 1.4;
		RadiusDamageFactor 1.4;
		obituary "%o couldn't keep Sauron's left eye off of %h.";
		Tag "Sauron's Left Eye";

		DamageFactor "Holy", 3; // Sauron-Class = +300% Holy Damage
		Painchance "Holy", 255; // Sauron-Class = +600% Pain Chance

		Painchance 255;
		-NORADIUSDMG;
	}

	states
	{
		MissileHealthLow:
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		EyebeamHealthLow:
			SOUL A 2 
			{
				A_FaceTarget();
				A_SpawnProjectile("SauronEyePlasma2",20,-30,0,8);
				A_SpawnProjectile("SauronEyePlasma2",20,0,0,8);
				A_SpawnProjectile("SauronEyePlasma2",20,30,0,8);
			}
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==20,"EyeBeam1to2HealthLow");
			Loop;
		Eyebeam1to2HealthLow:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam2HealthLow:
			SOUL A 2 
			{
				A_FaceTarget();
				A_SpawnProjectile("SauronEyePlasma",10,-30,0,8);
				A_SpawnProjectile("SauronEyePlasma",10,0,0,8);
				A_SpawnProjectile("SauronEyePlasma",10,30,0,8);
			}
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==10,"EndEyeBeamHealthLow");
			Loop;
		EndEyeBeamHealthLow:
			SOUL A 0 A_FaceTarget();
			goto See+1;
		Missile:
			SOUL A 0 A_JumpIfHealthLower(2400,"MissileHealthLow");
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma2",20);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==20,"EyeBeam1to2");
			Loop;
		Eyebeam1to2:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam2:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma",10);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==10,"EndEyeBeam");
			Loop;
		EndEyeBeam:
			SOUL A 0 A_FaceTarget();
			goto See+1;

		8sec:
			SOUL AAAAAAAA 24 A_FaceTarget();
			goto Missile;
		85sec:
			SOUL AAAAAAAA 24 A_FaceTarget();
			SOUL A 12 A_FaceTarget();
			goto Missile;
		9sec:
			SOUL AAAAAAAAA 24 A_FaceTarget();
			goto Missile;
		95sec:
			SOUL AAAAAAAAA 24 A_FaceTarget();
			SOUL A 12 A_FaceTarget();
			goto Missile;
		Pain:
			SOUL A 0 A_StartSound("SauronEPain",CHAN_VOICE,1.0,ATTN_NONE);
			SOUL A 1 A_Jump (144, "Missile");
			goto See;
		XDeath:
		Death:
			TNT1 A 0 A_DVDSNormalDeath(35200,0,1);
			SOUL A 1 
			{
				ACS_NamedExecute("DV1-M04Eye1Dead",0,0,0,0);
				A_StopSound(CHAN_VOICE);
				A_StopSound(CHAN_BODY);
				A_StopSound(CHAN_AUTO);
				A_StartSound("SauronEDeath",CHAN_VOICE,1.0,ATTN_NONE);
			}
			SOUL A 1;
			Stop;
	}
}

class SauronEyeStrong2 : SauronEyeStrong1
{
	default
	{
		health 14400;
		obituary "%o couldn't keep Sauron's right eye off of %h.";
		Tag "Sauron's Right Eye";
	
		DamageFactor 0.25;
		DamageFactor "Gauntlets", 20;
		DamageFactor "Sceptre", 10;
		DamageFactor "Magic", 12;
		DamageFactor "Explosive", 1.4;
		RadiusDamageFactor 1.4;
	
		DamageFactor "Holy", 3; // Sauron-Class = +300% Holy Damage
		Painchance "Holy", 255; // Sauron-Class = +600% Pain Chance
	
		Painchance 255;
		-NORADIUSDMG;
	}

	states
	{
		XDeath:
		Death:
			TNT1 A 0 A_DVDSNormalDeath(35200,0,1);
			SOUL A 1 
			{
				ACS_NamedExecute("DV1-M04Eye2Dead",0,0,0,0);
				A_StopSound(CHAN_VOICE);
				A_StopSound(CHAN_BODY);
				A_StopSound(CHAN_AUTO);
				A_StartSound("SauronEDeath",CHAN_VOICE,1.0,ATTN_NONE);
			}
			Stop;
	}
}

class Sauron_BossEye : BossEye
{
	default
	{
		Height 32;
		+NOBLOCKMAP;
		+NOSECTOR;
	}
	
	States
	{
		Spawn:
			SSWV A 10 A_Look();
			Loop;
		See:
			SSWV A 181 A_StartSound("SauronBossEye",CHAN_AUTO,1,0,ATTN_NONE);
			SSWV A 150 A_BrainSpit(); // See SpawnShot
			Wait;
	}
}

class SauronEyeMain : SauronEyeWeak
{
	default
	{
		health 43200; // 28800
		mass 50000000;
		species "Sauron";
		Tag "Sauron's Ultimate Eye of Power";

		DamageFactor 0.25;
		DamageFactor "Gauntlets", 20;
		DamageFactor "Sceptre", 10;
		DamageFactor "Magic", 10.664;
		DamageFactor "Explosive", 1.2;
		RadiusDamageFactor 1.2;
		obituary "%o bowed to the might of Sauron's ultimate eye of power.";

		DamageFactor "Holy", 3; // Sauron-Class = +300% Holy Damage
		Painchance "Holy", 255; // Sauron-Class = +600% Pain Chance

		Painchance 255;

		+AMBUSH;
		+NOGRAVITY;
		+SHOOTABLE;
		+LOOKALLAROUND;
		+NOTARGETSWITCH;
		+INVISIBLE;
		+NOBLOOD;
		+DONTFALL;
		+NOTARGET;
		+NOFEAR;
		+NOINFIGHTING;
		+CANTSEEK;
		+DONTMORPH;
		+DONTSQUASH;
		+NOTELEOTHER;
		-ISMONSTER;
		-COUNTKILL;
		+FULLVOLACTIVE;
		+FULLVOLDEATH;
		+BOSS;
		+THRUSPECIES;
		+NOTONAUTOMAP;
		+NODAMAGETHRUST;
		-NORADIUSDMG;
	}

	States
	{
		Pain.Charm: goto See;
		Spawn:
			SOUL A 0;
			SOUL A 0 Thing_ChangeTID(0,1123);
			SOUL A 0 Thing_SetTranslation(1123,16);
			SOUL A 0 Thing_ChangeTID(1123,1123);
			SOUL A 1 A_Look();
			loop;
		See:
			SOUL A 0 ACS_NamedExecuteAlways("DV1M04-Music1",0,0,0,0);
			SOUL A 0 A_Jump (256, "85sec", "8sec", "95sec", "9sec");
			SOUL A 1;
			loop;

		MissileHealthLow:
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		EyebeamHealthLow:
			SOUL A 2 
			{
				A_FaceTarget();
				A_SpawnProjectile("SauronEyePlasma3",20,-30,0,8);
				A_SpawnProjectile("SauronEyePlasma3",20,0,0,8);
				A_SpawnProjectile("SauronEyePlasma3",20,30,0,8);
			}
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==24,"EyeBeam1to2HealthLow");
			Loop;
		Eyebeam1to2HealthLow:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam2HealthLow:
			SOUL A 2 
			{
				A_FaceTarget();
				A_SpawnProjectile("SauronEyePlasma2",20,-30,0,8);
				A_SpawnProjectile("SauronEyePlasma2",20,0,0,8);
				A_SpawnProjectile("SauronEyePlasma2",20,30,0,8);
			}
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==12,"EyeBeam2to3HealthLow");
			Loop;
		Eyebeam2to3HealthLow:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam3HealthLow:
			SOUL A 2 
			{
				A_FaceTarget();
				A_SpawnProjectile("SauronEyePlasma",20,-30,0,8);
				A_SpawnProjectile("SauronEyePlasma",20,0,0,8);
				A_SpawnProjectile("SauronEyePlasma",20,30,0,8);
			}
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==6,"EndEyeBeamHealthLow");
			Loop;
		EndEyeBeamHealthLow:
			SOUL A 0 A_FaceTarget();
			goto See+1;
		Missile:
			SOUL A 0 A_JumpIfHealthLower(7200,"MissileHealthLow");
			SOUL A 0 A_FaceTarget();
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma3",20);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==20,"EyeBeam1to2");
			Loop;
		Eyebeam1to2:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam2:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma2",10);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==10,"EyeBeam2to3");
			Loop;
		Eyebeam2to3:
			SOUL A 0 { user_attackpoint = 0; }
		Eyebeam3:
			SOUL A 0 A_FaceTarget();
			SOUL A 2 A_SpawnProjectile("SauronEyePlasma",10);
			SOUL G 0 { user_attackpoint += 1; }
			SOUL G 0 A_JumpIf(user_attackpoint==5,"EndEyeBeam");
			Loop;
		EndEyeBeam:
			SOUL A 0 A_FaceTarget();
			goto See+4;
		8sec:
			SOUL AAAAAAAA 12 A_FaceTarget();
			goto Missile;
		85sec:
			SOUL AAAAAAAA 12 A_FaceTarget();
			SOUL A 6 A_FaceTarget();
			goto Missile;
		9sec:
			SOUL AAAAAAAAA 12 A_FaceTarget();
			goto Missile;
		95sec:
			SOUL AAAAAAAAA 12 A_FaceTarget();
			SOUL A 6 A_FaceTarget();
			goto Missile;

		Pain:
			SOUL A 0 A_StartSound("SauronEPain",CHAN_VOICE,1.0,ATTN_NONE);
			SOUL A 1 A_Jump (208, "Missile");
			goto See+4;
		XDeath:
		Death:
			TNT1 A 0 
			{
				A_DVDSNormalDeath(80000,0,1);
				ACS_NamedExecute("DVI-MainEyeDeath1",0,0,0,0);
				A_StopSound(CHAN_VOICE);
				A_StopSound(CHAN_BODY);
				A_StopSound(CHAN_AUTO);
			}
			SOUL A 100 A_StartSound("SauronEDeath",CHAN_VOICE,1.0,ATTN_NONE);
			SOUL AA 15;
			SOUL A 0 ACS_NamedExecute("DVI-MainEyeDeath2",0,0,0,0);
			Stop;
	}
}

// Spawn to go to the cast
class GoToCast : Sauravatar
{
	default
	{
		Health 1;
		Radius 3;
		Height 8;
		Scale 0.075;
	}
	
	States
	{
		Spawn:
			CYBR A 0 A_BrainDie();
			CYBR A 1 A_BrainDie();
		See:
			CYBR A 0 A_BrainDie();
			CYBR A 1 A_BrainDie();
		Death:
			CYBR P -1 A_BrainDie();
	}
}
